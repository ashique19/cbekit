var __extends,GcSpread;(function(e){!function(e){function t(e,t){var o,n;for("string"==typeof e?o=(t||document).querySelectorAll(e):e&&(o=e instanceof Array||e instanceof HTMLCollection?e:[e]),this.elements=[],n=0;o&&n<o.length;n++)this.elements.push(o[n])}e.GC$=function(e,o){return new t(e,o)},e.GC$.prototype={elements:[],getElement:function(e){return this.elements[e]},getAllElements:function(){return this.elements},length:function(){return this.elements.length},bind:function(t,o,n){return void 0===n&&(n=o,o=void 0),this.elements.forEach(function(r,i){var a,s,l=e.GC$._data(r,"events");l||(l={},e.GC$._data(r,"events",l));var u=t.split("."),c=u[0],h=u[1]||"_nonamespace",p=l[h];p||(p=l[h]={}),(a=function(e){void 0!==o&&(e.data=o);var t=n.apply(r,arguments);e.result=t,!1===t&&(e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1))}).original=n,(s=p[c])||(s=p[c]=[]),s.push(a),r.addEventListener(c,a)}),this},unbind:function(t,o){return this.elements.forEach(function(n,r){var i,a,s,l,u=t.split("."),c=u[0],h=u[1]||"_nonamespace",p=e.GC$._data(n,"events"),d=p&&p[h];if(o){if(d&&c&&(a=d[c]))for(s=0,l=a.length;s<l;s++)if(a[s].original===o){n.removeEventListener(c,a[s]),a.splice(s,1);break}}else if(d)if(c){if(a=d[c])for(s=0,l=a.length;s<l;s++)n.removeEventListener(c,a[s]);d[c]=void 0}else{for(i in d)if(a=d[i])for(s=0,l=a.length;s<l;s++)n.removeEventListener(i,a[s]);p[h]=void 0}}),this},trigger:function(t,o){return this.elements.forEach(function(n,r){var i,a,s,l,u,c=e.GC$._data(n,"events");if(c){var h=t.split("."),p=h[0];h[1];for(i in c)if(s=(a=c[i])&&a[p])for(l=0,u=s.length;l<u;l++)s[l].apply(n,[{type:p},o])}}),this},css:function(t,o){var n,r,i,a=this.elements;if(1===arguments.length){if("object"!=typeof t)return n=this.getElement(0),(r=e.GC$.cssHooks[t])&&"get"in r?r.get(n):(i=getComputedStyle(n))&&i[t];a.forEach(function(o,n){for(var r in t)o.style[r]=e.GC$._fixCssValue(r,t[r])})}else 2===arguments.length&&(o=e.GC$._fixCssValue(t,o),a.forEach(function(e,n){e.style[t]=o}));return this},width:function(e){var t,o=this,n="border-box"===o.css("box-sizing");return 0===arguments.length?(t=Math.round(parseFloat(o.css("width")))||0,n&&(t-=parseFloat(o.css("padding-left"))+parseFloat(o.css("padding-right"))+parseFloat(o.css("border-left-width"))+parseFloat(o.css("border-right-width"))),t):(o.css("width",e),o)},height:function(e){var t,o=this,n="border-box"===o.css("box-sizing");return 0===arguments.length?(t=Math.round(parseFloat(o.css("height")))||0,n&&(t-=parseFloat(o.css("padding-top"))+parseFloat(o.css("padding-bottom"))+parseFloat(o.css("border-top-width"))+parseFloat(o.css("border-bottom-width"))),t):(o.css("height",e),o)},innerWidth:function(){return this.width()+parseFloat(this.css("padding-left"))+parseFloat(this.css("padding-right"))},innerHeight:function(){return this.height()+parseFloat(this.css("padding-top"))+parseFloat(this.css("padding-bottom"))},outerWidth:function(e){var t=this.innerWidth();return t+=parseFloat(this.css("border-left-width"))+parseFloat(this.css("border-right-width")),e&&(t+=parseFloat(this.css("margin-left"))+parseFloat(this.css("margin-right"))),t},outerHeight:function(e){var t=this.innerHeight();return t+=parseFloat(this.css("border-top-width"))+parseFloat(this.css("border-bottom-width")),e&&(t+=parseFloat(this.css("margin-top"))+parseFloat(this.css("margin-bottom"))),t},append:function(t){var o,n=[t];return t instanceof e.GC$&&(n=t.getAllElements()),this,o=this.getElement(0),n.forEach(function(e,t){e&&o.appendChild(e)}),this},appendTo:function(t){var o=t;return t instanceof e.GC$&&(o=t.getElement(0)),this,this.elements.forEach(function(e,t){o.appendChild(e)}),this},prepend:function(e){var t=this.getElement(0);return t.insertBefore(e,t.firstChild),this},insertBefore:function(e){var t=e.parentElement;return this.elements.forEach(function(o,n){t.insertBefore(o,e)}),this},addClass:function(t){for(var o,n,r,i,a=0,s=this.elements.length,l=/[\t\r\n]/g,u=(t||"").match(/\S+/g)||[];a<s;a++)if(n=1===(o=this.elements[a]).nodeType&&(o.className?(" "+o.className+" ").replace(l," "):" ")){for(i=0;r=u[i++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");o.className=e.GC$.trim(n)}return this},removeClass:function(t){for(var o,n,r,i,a=0,s=this.elements.length,l=/[\t\r\n]/g,u=(t||"").match(/\S+/g)||[];a<s;a++)if(n=1===(o=this.elements[a]).nodeType&&(o.className?(" "+o.className+" ").replace(l," "):"")){for(i=0;r=u[i++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");o.className=t?e.GC$.trim(n):""}return this},hasClass:function(e){e=" "+e+" ";for(var t,o=0,n=this.elements.length,r=/[\t\r\n]/g;o<n;o++)if(1===(t=this.elements[o]).nodeType&&(" "+t.className+" ").replace(r," ").indexOf(e)>=0)return!0;return!1},toggle:function(){return"none"===this.getElement(0).style.display?this.show():this.hide(),this},show:function(e){return this.elements.forEach(function(t,o){t.style.display="block",e&&e.apply(t)}),this},hide:function(){return this.elements.forEach(function(e,t){e.style.display="none"}),this},attr:function(e,t){var o=this.elements;if(1===arguments.length){if("object"!=typeof e)return this.getElement(0).getAttribute(e);o.forEach(function(t,o){for(var n in e)t.setAttribute(n,e[n])})}else 2===arguments.length&&o.forEach(function(o,n){o.setAttribute(e,t)});return this},removeAttr:function(e){return this.elements.forEach(function(t,o){t.removeAttribute(e)}),this},prop:function(t,o){var n=this.elements;if(1===arguments.length){if("object"!=typeof t)return e.GC$.internalProp(this.getElement(0),t);n.forEach(function(o,n){for(var r in t)e.GC$.internalProp(o,r,t[r])})}else 2===arguments.length&&n.forEach(function(n,r){e.GC$.internalProp(n,t,o)});return this},removeProp:function(t){t=e.GC$.propFix[t]||t;return this.elements.forEach(function(e,o){try{e[t]=void 0,delete e[t]}catch(e){}}),this},text:function(e){var t=this.elements;return 0===arguments.length?this.getElement(0).textContent:(t.forEach(function(t,o){t.textContent=e}),this)},val:function(t){var o,n,r,i;return arguments.length?(i=e.GC$.isFunction(t),this.elements.forEach(function(n,r){var a;1===n.nodeType&&(null==(a=i?t.call(n,r,e.GC$(n).val()):t)?a="":"number"==typeof a?a+="":e.GC$.isArray(a)&&(a=e.GC$.map(a,function(e){return null==e?"":e+""})),(o=e.GC$.valHooks[n.type]||e.GC$.valHooks[n.nodeName.toLowerCase()])&&"set"in o&&void 0!==o.set(n,a,"value")||(n.value=a))}),this):(n=this.getElement(0))?(o=e.GC$.valHooks[n.type]||e.GC$.valHooks[n.nodeName.toLowerCase()])&&"get"in o&&void 0!==(r=o.get(n,"value"))?r:"string"==typeof(r=n.value)?r.replace(/\r/g,""):null==r?"":r:void 0},position:function(){var t,o,n,r,i=this.getElement(0);if(i)return o={top:0,left:0},"fixed"===e.GC$(i).css("position")?t=i.getBoundingClientRect():(n=this.offsetParent(),t=this.offset(),r=n.getElement(0),e.GC$.nodeName(r,"html")||((o=n.offset()).left-=r.scrollLeft,o.top-=r.scrollTop),o.top+=parseFloat(e.GC$(r).css("borderTopWidth")),o.left+=parseFloat(e.GC$(r).css("borderLeftWidth"))),{top:t.top-o.top-parseFloat(e.GC$(i).css("marginTop")),left:t.left-o.left-parseFloat(e.GC$(i).css("marginLeft"))}},offsetParent:function(){var t=e.GC$.map(this.elements,function(t,o){for(var n=t.offsetParent||document.documentElement;n&&!e.GC$.nodeName(n,"html")&&"static"===e.GC$(n).css("position");)n=n.offsetParent;return n||document.documentElement});return e.GC$(t)},offset:function(){var t,o,n={top:0,left:0},r=this.getElement(0),i=r&&r.ownerDocument;if(i)return t=i.documentElement,void 0!==r.getBoundingClientRect&&(n=r.getBoundingClientRect()),o=e.GC$.getWindow(i),{top:n.top+(o.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(o.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}},scrollLeft:function(t){var o=this.getElement(0),n=e.GC$.getWindow(o);return void 0===t?n?"pageXOffset"in n?n.pageXOffset:n.document.documentElement.scrollLeft:o.scrollLeft:(n?n.scrollTo(t,e.GC$(n).scrollTop()):o.scrollLeft=t,this)},scrollTop:function(t){var o=this.getElement(0),n=e.GC$.getWindow(o);return void 0===t?n?"pageYOffset"in n?n.pageYOffset:n.document.documentElement.scrollTop:o.scrollTop:(n?n.scrollTo(e.GC$(n).scrollLeft(),t):o.scrollTop=t,this)},html:function(e){var t=this.elements;return 0===arguments.length?this.getElement(0).innerHTML:(t.forEach(function(t,o){t.innerHTML=e}),this)},remove:function(){this.elements.forEach(function(t,o){var n=t.parentElement;n&&(n.removeChild(t),e.GC$.cleanData([t]))})},empty:function(){return this.elements.forEach(function(t,o){e.GC$(t.children).remove()}),this},find:function(t){var o=[];return"string"==typeof t&&this.elements.forEach(function(n,r){var i=n.querySelectorAll(t);e.GC$.merge(o,i)}),e.GC$(o)},parent:function(){var t=[];return this.elements.forEach(function(e,o){e.parentElement&&t.push(e.parentElement)}),e.GC$(t)},index:function(t){var o=this.getElement(0);return t?"string"==typeof t?e.GC$.inArray(o,e.GC$(t).getAllElements()):e.GC$.inArray(t,this.elements):o&&o.parentElement?e.GC$.inArray(o,o.parentElement.children):-1},focus:function(){var e=this.getElement(0);return e!==document.activeElement&&e.focus&&e.focus(),this},isVisible:function(){var e=0;return this.elements.forEach(function(t,o){var n=getComputedStyle(t);"hidden"!==n.visibility&&"none"!==n.display&&e++}),e>0},data:function(t,o){var n=this;return e.GC$.each(this.elements,function(r,i){var a=e.GC$.internalData(i,t,o);if(void 0===o)return n=a,!1}),n},removeData:function(t){return e.GC$.each(this.elements,function(o,n){e.GC$.internalRemoveData(n,t)}),this}},e.GC$.each=function(t,o){var n,r,i;if(e.GC$.isArraylike(t))for(n=0,r=t.length;n<r&&!1!==o.call(t[n],n,t[n]);n++);else for(i in t)if(!1===o.call(t[i],i,t[i]))break;return t},e.GC$.isEmptyObject=function(e){for(var t in e)return!1;return!0},e.GC$.isFunction=function(t){return"function"===e.GC$.getType(t)},e.GC$.isArray=function(t){return Array.isArray?Array.isArray(t):"array"===e.GC$.getType(t)},e.GC$.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.GC$.getType=function(e){var t,o;return null==e?String(e):(t={},"Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(function(e,o){t["[object "+e+"]"]=e.toLowerCase()}),o=t.toString,"object"==typeof e||"function"==typeof e?t[o.call(e)]||"object":typeof e)},e.GC$.inArray=function(e,t,o){var n,r;if(t){if(r=[].indexOf)return r.call(t,e,o);for(n=t.length,o=o?o<0?Math.max(0,n+o):o:0;o<n;o++)if(o in t&&t[o]===e)return o}return-1},e.GC$.trim=function(e){if(e.trim)return e.trim();return null==e?"":(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},e.GC$.merge=function(e,t){var o=t.length,n=e.length,r=0;if("number"==typeof o)for(;r<o;r++)e[n++]=t[r];else for(;void 0!==t[r];)e[n++]=t[r++];return e.length=n,e},e.GC$.map=function(t,o,n){var r,i=0,a=t.length,s=[];if(e.GC$.isArraylike(t))for(;i<a;i++)null!=(r=o(t[i],i,n))&&(s[s.length]=r);else for(i in t)null!=(r=o(t[i],i,n))&&(s[s.length]=r);return[].concat.apply([],s)},e.GC$.extend=function(){for(var t=[],o=0;o<arguments.length-0;o++)t[o]=arguments[o+0];var n,r,i,a,s,l,u=arguments[0]||{},c=1,h=arguments.length,p=!1;for("boolean"==typeof u&&(p=u,u=arguments[1]||{},c=2),"object"==typeof u||e.GC$.isFunction(u)||(u={}),h===c&&(u=this,--c);c<h;c++)if(null!=(s=arguments[c]))for(a in s)n=u[a],u!==(i=s[a])&&(p&&i&&(e.GC$.isPlainObject(i)||(r=e.GC$.isArray(i)))?(r?(r=!1,l=n&&e.GC$.isArray(n)?n:[]):l=n&&e.GC$.isPlainObject(n)?n:{},u[a]=e.GC$.extend(p,l,i)):void 0!==i&&(u[a]=i));return u},e.GC$.isPlainObject=function(t){var o,n;if(!t||"object"!==e.GC$.getType(t)||t.nodeType||e.GC$.isWindow(t))return!1;o={}.hasOwnProperty;try{if(t.constructor&&!o.call(t,"constructor")&&!o.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(n in t);return void 0===n||o.call(t,n)},e.GC$.isArraylike=function(t){var o=t.length,n=e.GC$.getType(t);return!e.GC$.isWindow(t)&&(!(1!==t.nodeType||!o)||("array"===n||"function"!==n&&(0===o||"number"==typeof o&&o>0&&o-1 in t)))},e.GC$.isWindow=function(e){return null!=e&&e==e.window},e.GC$.getWindow=function(t){return e.GC$.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)},e.GC$.nodeName=function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},e.GC$.makeArray=function(t,o){var n=o||[];return null!=t&&(e.GC$.isArraylike(Object(t))?e.GC$.merge(n,"string"==typeof t?[t]:t):[].push.call(n,t)),n},e.GC$._fixCssValue=function(e,t){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(e)>=0&&isFinite(t)?("width height".split(" ").indexOf(e)>=0&&t<0&&(t=0),t+"px"):t},e.GC$.cssHooks={},["height","width"].forEach(function(t,o){e.GC$.cssHooks[t]={get:function(e){var o,n,r,i,a=getComputedStyle(e),s=e.style,l={position:"absolute",visibility:"hidden",display:"block"},u={position:s.position,visibility:s.visibility,display:s.display},c=0===e.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(a.display);if(c)for(n in l)s[n]=l[n];if(o=a&&a[t],c)for(n in u)s[n]=u[n];if(""===o){for(r=e.parentElement,i=document.body;r&&r!==i;)r=r.parentElement;r!==i&&(o=s[t])}return o}}}),e.GC$.propFix={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},e.GC$.propHooks={tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):/^(?:input|select|textarea|button|object)$/i.test(e.nodeName)||/^(?:a|area)$/i.test(e.nodeName)&&e.href?0:void 0}}},e.GC$.internalProp=function(t,o,n){var r,i,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return 1!==a&&(o=e.GC$.propFix[o]||o,i=e.GC$.propHooks[o]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,o))?r:t[o]=n:i&&"get"in i&&null!==(r=i.get(t,o))?r:t[o]},e.GC$.valHooks={option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(t){for(var o,n,r=t.options,i=t.selectedIndex,a="select-one"===t.type||i<0,s=a?null:[],l=a?i+1:r.length,u=i<0?l:a?i:0;u<l;u++)if(((n=r[u]).selected||u===i)&&!n.disabled&&(!n.parentNode.disabled||!e.GC$.nodeName(n.parentNode,"optgroup"))){if(o=e.GC$(n).val(),a)return o;s.push(o)}return s},set:function(t,o){var n=e.GC$.makeArray(o);return e.GC$(t).find("option").getAllElements().forEach(function(t,o){t.selected=e.GC$.inArray(e.GC$(t).val(),n)>=0}),n.length||(t.selectedIndex=-1),n}}},e.GC$.cache={},e.GC$.expando="GC$"+(""+Math.random()).replace(/\D/g,""),e.GC$.guid=1,e.GC$.noData={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},e.GC$.acceptData=function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var o=t.nodeName&&e.GC$.noData[t.nodeName.toLowerCase()];return!o||!0!==o&&t.getAttribute("classid")===o},e.GC$.noop=function(){},e.GC$.camelCase=function(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})},e.GC$.internalData=function(t,o,n,r){if(e.GC$.acceptData(t)){var i,a,s=e.GC$.expando,l="string"==typeof o,u=t.nodeType,c=u?e.GC$.cache:t,h=u?t[s]:t[s]&&s;if(h&&c[h]&&(r||c[h].data)||!l||void 0!==n)return h||(u?t[s]=h=e.GC$.guid++:h=s),c[h]||(c[h]={},u||(c[h].toJSON=e.GC$.noop)),("object"==typeof o||"function"==typeof o)&&(r?c[h]=e.GC$.extend(c[h],o):c[h].data=e.GC$.extend(c[h].data,o)),i=c[h],r||(i.data||(i.data={}),i=i.data),void 0!==n&&(i[e.GC$.camelCase(o)]=n),l?null==(a=i[o])&&(a=i[e.GC$.camelCase(o)]):a=i,a}},e.GC$.internalRemoveData=function(t,o,n){if(e.GC$.acceptData(t)){var r,i,a,s=function(t){for(var o in t)if(("data"!==o||!e.GC$.isEmptyObject(t[o]))&&"toJSON"!==o)return!1;return!0},l=t.nodeType,u=l?e.GC$.cache:t,c=l?t[e.GC$.expando]:e.GC$.expando;if(u[c]){if(o&&(a=n?u[c]:u[c].data)){for((e.GC$.isArray(o)?o=o.concat(e.GC$.map(o,e.GC$.camelCase)):o in a?o=[o]:o=(o=e.GC$.camelCase(o))in a?[o]:o.split(" "),r=0,i=o.length);r<i;r++)delete a[o[r]];if(!(n?s:e.GC$.isEmptyObject)(a))return}(n||(delete u[c].data,s(u[c])))&&(l?e.GC$.cleanData([t],!0):u!=u.window?delete u[c]:u[c]=null)}}},e.GC$.cleanData=function(t,o){for(var n,r,i,a,s,l,u,c,h,p,d=0,f=e.GC$.expando,g=e.GC$.cache;null!=(n=t[d]);d++)if((o||e.GC$.acceptData(n))&&(i=(r=n[f])&&g[r])){if(a=i.events)for(s in a)if(l=a[s])for(u in l)if(c=l[u])for(h=0,p=c.length;h<p;h++)n.removeEventListener(s,c[h]);g[r]&&(delete g[r],delete n[f])}},e.GC$._data=function(t,o,n){return e.GC$.internalData(t,o,n,!0)},e.GC$._removeData=function(t,o){return e.GC$.internalRemoveData(t,o,!0)},t.prototype=e.GC$.prototype}(e.Sheets||(e.Sheets={}));e.Sheets})(GcSpread||(GcSpread={})),function(e){!function(e){var t=function(){function t(e,t,o){this.prop=e,this.getter=t,this.setter=o}return t.parse=function(o){var n,r,i;if(null!=o&&o.length>0){n=o.split("."),r=null;do{i=new t(n.shift(),function(){return this.base?this.base.getter()[this.prop]:e.features[this.prop]},function(t){var o,n=this;n.base?(null==(o=n.base.getter())&&n.base.setter(o={}),o[n.prop]=t):e.features[n.prop]=t}),r&&(i.base=r),r=i}while(n.length>0);return r}return null},t.ensure=function(e){var o=t.parse(e);o&&o.setter(!0)},t.check=function(o){var n=!0;return e.GC$.each(o,function(e,o){var r=t.parse(o);return!(r&&!r.getter())||(n=!1)}),n},t}();e.feature=function(e,o){if(t.ensure(e),o&&o.length>0&&!t.check(o)){var n=window.console;n&&n.error&&n.error("["+e+"]: One or more dependency in ["+o+"] are not found!")}},e.features=e.features||{core:{stringResource:!1,common:!1,imageLoader:!1,theme:!1,globalize:!1,spreadpanelex:!1,basecelltype:!1,sheet_model:!1,sheet_action:!1,sheet_event:!1,sheet_border:!1,sheet_render:!1,sheet_ui:!1,sheet:!1,spread:!1,spread_ui:!1,cultureInfo:!1},calc:{common:!1,functions:!1,functions_db:!1,functions_eng:!1,functions_fin:!1,functions_lookup:!1,functions_stat:!1},filter:!1,filter_ui:!1,sparkline:!1,table:!1,binding:!1,group:!1,celltype:!1,conditionalFormat:!1,dataValidator:!1,fill:!1,fill_ui:!1,formatter:!1,search:!1,touch:!1,floatingObject:!1,comment:!1,sparklineEx:!1,formulatextbox:!1,formulatextbox_resource:!1,basedialog:!1,slicer:!1,tableSlicer:!1,print:!1}}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){t.feature("core.stringResource");var o=function(){function t(){}return t.getHelpFuncs=function(){var t=e.Sheets.FormulaTextBoxResource_EN;return t?t.Functions:null},t.getHelpTableFuncs=function(){var t=e.Sheets.FormulaTextBoxResource_EN;return t?t.Table_Functions:null},t.Exp_InvalidArgument="Invalid argument",t.Exp_InvalidCast="InvalidCastException",t.Exp_NotSupport="NotSupportException",t.Exp_FormulaInvalid="The formula you typed contains an invalid char: '{0}' at index on {1}.",t.Exp_InvalidTokenAt="invalid token at {0}.",t.Exp_InvalidArrayAt="Invalid array at {0}.",t.Exp_InvalidCellReference="Invalid cell reference or name at {0}.",t.Exp_InvalidFunctionName="Invalid function name",t.Exp_InvalidOverrideFunction="Cannot override built-in function",t.Exp_OverrideNotAllowed="Attempt to override function while override is not allowed",t.Exp_NoSyntax="no syntax '{0}' to match the syntax '{1}'.",t.Exp_IsValid="'{0}' is invalid.",t.Exp_InvalidArray="Invalid array",t.Exp_InvalidParameters="Invalid function parameters at {0}.",t.Exp_InvalidArrayColumns="The length of array columns are unequal at {0}.",t.Exp_ExprIsNull="The argument 'expr' is null",t.Exp_RuleIsNull="The argument 'rule' is null",t.CopyCells="Copy Cells",t.FillSeries="Fill Series",t.FillFormattingOnly="Fill Formatting Only",t.FillWithoutFormatting="Fill Without Formatting",t.Exp_NumberOnly="Only works for Numbers",t.Exp_RangeContainsMergedCell="Range should not have merged cell.",t.Exp_ChangeMergedCell="Cannot change part of merged cell.",t.Exp_TargetContainsMergedCells="Target range should not have merged cells.",t.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",t.SortAscending="Sort Ascending",t.SortDescending="Sort Descending",t.OK="OK",t.Cancel="Cancel",t.Search="Search",t.CheckAll="Check all",t.UncheckAll="Uncheck all",t.Blanks="(Blanks)",t.ls=["","506f776572656420627920477261706543697479205370726561642e53686565747320547269616c2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],t.Exp_FilterItemIsNull="FilterItem is null.",t.Exp_InvalidColumnIndex="Invalid column index.",t.Exp_TokenIsNull="token is null",t.Exp_InvalidBackslash="the '\\' cannot be evaluated",t.Exp_FormatIllegal="format is illegal.",t.Exp_ValueIsNull="value is null",t.Exp_PartIsNull="part is null",t.Exp_DuplicatedDescriptor="The type of descriptor was added.",t.Exp_TokenIllegal="token is illegal.",t.Exp_ValueIllegal="value is illegal.",t.Exp_StringIllegal="string is illegal.",t.Exp_InvalidNull="InvalidNullException",t.Exp_InvalidOperation="InvalidOperationException",t.Exp_ArgumentNull="ArgumentNullException",t.Exp_CriteriaIsNull="criteria is null",t.Exp_InvalidString="Invalid string",t.Exp_InvalidDateFormat="Invalid date format pattern",t.Exp_InvalidExponentFormat="invalid exponent format",t.Exp_InvalidSemicolons="invalid format: too many semicolons",t.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9.",t.Exp_BadFormatSpecifier="Bad Format Specifier",t.Exp_InvalidNumberFormat="Invalid number format pattern",t.Exp_InvalidIndex="Invalid index",t.Exp_InvalidCount="Invalid count",t.Exp_InvalidLevel="Invalid level",t.Exp_GroupInfoIsNull="groupInfo is null",t.Exp_SheetIsNull="sheet is null.",t.Exp_DestSheetIsNull="destSheet is null",t.Exp_PasteExtentIsNull="pasteExtent is null",t.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",t.Exp_ChangePartOfArray="Cannot change part of an array.",t.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",t.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",t.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",t.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",t.Exp_FillCellsReadOnly="The cells you are trying to fill is protected and therefore read-only.",t.Exp_OverlappingSpans="This operation will cause overlapping spans.",t.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",t.Exp_SrcIsNull="The argument 'src' is null",t.Exp_DestIsNull="The argument 'dest' is null",t.Exp_InvalidCustomFunction="invalid custom function",t.Exp_InvalidCustomName="invalid custom name",t.Exp_IndexOutOfRange="Index is out of range!",t.Exp_InvalidRange="Invalid range",t.Exp_RangeIsNull="range is null",t.Exp_NotAFunction="{0}is not a function",t.Exp_Format="Format",t.Exp_BraceMismatch="format: brace mis-match",t.Exp_InvalidFormat="invalid format",t.Exp_ArgumentOutOfRange="ArgumentOutOfRange",t.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",t.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",t.Exp_TableEmptyNameError="The table name cannot be empty.",t.Exp_TableInvalidRow="Invalid row index or row count.",t.Exp_TableInvalidColumn="Invalid column index or column count.",t.Exp_TableIntersectError="The tables cannot be intersected.",t.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",t.Exp_TableDataSourceNullError="Table datasource cannot be null.",t.Exp_TableStyleAddCustomStyleError="The style with the same name already exists in the styles.",t.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",t.Exp_TableResizeOutOfRange="The invalid row count, column count and table cannot be resize out of the sheet.",t.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",t.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",t.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",t.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",t.Tip_Row="Row: ",t.Tip_Column="Column: ",t.Tip_Height="Height: {0} pixels",t.Tip_Width="Width: {0} pixels",t.NewTab="New...",t.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",t.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",t.Exp_FloatingObjectNameEmptyError="Floating object must have name",t.ToolStrip_PasteText="Paste",t.ToolStrip_CutText="Cut",t.ToolStrip_CopyText="Copy",t.ToolStrip_AutoFillText="AutoFill",t.Exp_ArrayFromulaPart="You cannot change part of an array.",t.Exp_ArrayFromulaSpan="Array formulas are not valid in merged cells.",t.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",t.Fbx_Summary="Summary",t.Fbx_TableName_Description="Table name for ",t.Fbx_CustomName_Description="Custom name for ",t.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",t.Blank="(blank)",t.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info.",t.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",t.Exp_SlicerNameInvalid="The slicer name is not valid.",t.Exp_SlicerNameExist="The slicer name is already in use,please enter an unique name.",t}();t._ENStringResource=o,t.SR=o}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){function o(e){if(r.browser.safari)return e.font;var t="",o="normal";return e.fontStyle!==o&&(t=e.fontStyle),e.fontVariant!==o&&(t+=(t?" ":"")+e.fontVariant),e.fontWeight!==o&&"400"!==e.fontWeight&&(t+=(t?" ":"")+e.fontWeight),t+=(t?" ":"")+e.fontSize,e.lineHeight!==o&&(t+="/"+e.lineHeight),t+" "+e.fontFamily}var n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O;t.feature("core.common",["core.stringResource"]);var P,L,H,k,V,B,z,G,W,j,U,Y,X,K,J,Z,q,$,Q,ee,te,oe,ne,re,ie,ae,se,le,ue,ce,he,pe,de,fe,ge,me,_e,ye,Ce,we,ve,Se,xe,Re,be,Te,Ae,Ie,De,Fe,Me,Ee,Ne,Oe,Pe,Le,He,ke,Ve,Be,ze,Ge,We,je="undefined",Ue=void 0,Ye=null,Xe=Math.abs,Ke=Math.floor,Je=Math.ceil,Ze=Math.min,qe=Math.max,$e=function(){function e(){}return e.productVersion="9.40.20161.0",e}();t.productInfo=$e,t.DefaultFontSize="11pt",n=function(){function e(){}return e.ResizeCol="col-Resize",e.ResizeRow="row-resize",e.ResizeHiddenCol="w-resize",e.ResizeHiddenRow="n-resize",e}(),t.CursorResource=n,t.getTypeFromString=function(e){var t,o,n,r=!1,i=window;if("string"==typeof e){for(o=0,n=(t=e.split(".")).length;o<n&&i;o++)i=i[t[o]];i&&o===n&&n>0&&(r=!0)}return r?i:Ue},t.findControl=function(e){return t.GC$(e).data("spread")},r=function(){function e(){}return e.createEventHandler=function(e,t){return function(){return t.apply(e,arguments)}},e.cancelDefault=function(e){return e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1),!1},e.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},e._isStandardCanvas=function(){return typeof e.canvasApiFound===je&&(e.canvasApiFound=typeof document.createElement("canvas").getContext!==je),e.canvasApiFound},e._isSilverlightCanvas=function(){return!!e._isStandardCanvas()||(typeof e.slCanvasApiFound===je&&(e.slCanvasApiFound=typeof window.slcanvas!==je),e.slCanvasApiFound)},e._useDoubleBuffer=function(){var t=e;return t._isStandardCanvas()||t._isSilverlightCanvas()},e.getHAlignByValueType=function(e,o,n){if(3===e){var r=t.GC$.getType(o);e=n&&"@"===n?0:"boolean"===r?1:"number"===r||"date"===r?2:0}return e},e.inArray=function(e,t,o){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e,o);var n=t.length;for(o=o?o<0?qe(0,n+o):o:0;o<n;o++)if(o in t&&t[o]===e)return o}return-1},e.parseColorString=function(o){var n,r,i,a=function(e){return e.indexOf("%")>0?2.55*parseFloat(e):0|e},s=(e._isStandardCanvas()?function(e){if(!i){var t=window.document.createElement("canvas");t&&t.getContext&&(i=t.getContext("2d"))}return i?(i.fillStyle=e,i.fillStyle):e}:function(e){return typeof r===je&&(r=t.GC$(document.createElement("span"))),r.css("color",e),r.css("color")})(o),u=RegExp;return/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.test(s)?l.map([u.$1,u.$2,u.$3],function(e){return parseInt(e,16)}):/^rgba\(([\s\d]*),([\s\d]*),([\s\d]*),([\s\d]*)\)$/i.test(s)?((n=l.map([u.$1,u.$2,u.$3],a)).splice(0,0,255*parseFloat(u.$4)),n):/^rgb\(([\s\d]*),([\s\d]*),([\s\d]*)\)$/i.test(s)?l.map([u.$1,u.$2,u.$3],a):/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(s)?l.map([u.$1,u.$2,u.$3],function(e){return parseInt(e+e,16)}):Ye},e.hasCalc=function(){return t.features.calc&&t.features.calc.common},e.toString=function(e){return e===Ye||e===Ue?"":"boolean"===t.GC$.getType(e)?e.toString().toUpperCase():"date"===t.GC$.getType(e)?0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?new t._DateTimeHelper(e).format("M/d/yyyy"):new t._DateTimeHelper(e).format("M/d/yyyy h:mm:ss"):e.toString()},e._applyBackgroundImageLayout=function(e,o,n,r,i,a){var s,l,u=t.GC$(e),c=o,h=n,p="background-position",d="background-size";switch(a){case 0:u.css(p,"0% 0%").css(d,"100% 100%");break;case 1:s="50%",l="50%",r>c&&(s="0%"),i>h&&(l="0%"),u.css(p,s+" "+l).css(d,"auto auto");break;case 2:var f=0,g=0,m=c,_=h;h>0&&i>0&&c/h>r/i?f=f+c/2-(m=r/i*h)/2:c>0&&r>0&&h/c>i/r&&(g=g+h/2-(_=i/r*c)/2),u.css(p,f+"px "+g+"px").css(d,m+"px "+_+"px");break;case 3:u.css(p,"0% 0%").css(d,"auto auto")}},e.device=function(){var e,t,o,n=navigator.userAgent,r=n.match(/iPad/i);return r&&((e=r[0])&&(t="ipad"===e.toLowerCase())),(r=n.match(/iPhone/i))&&((e=r[0])&&(o="iphone"===e.toLowerCase())),(r=n.match(/android/i))&&((e=r[0])&&(o="android"===e.toLowerCase())),{ipad:t,iphone:o,android:void 0}},e.isMacOS=function(){var e=navigator.platform;return e&&e.indexOf("Mac")>-1},e.initPaint=function(o){var n,r,i,a;e._isStandardCanvas()||(n=document.getElementById(o),(r=t.GC$(n).data("spread"))&&(r._initPaintTimeout!==Ue&&r._initPaintTimeout!==Ye&&window.clearTimeout(r._initPaintTimeout),(i=r.canvas.firstChild)&&i.loaded?(a=i.Content.SpreadsheetObject,r.attachSpreadsheetObject(a)):r._initPaintTimeout=window.setTimeout(function(){e.initPaint(o)},10)))},e.isType=function(e,t){var o;if(e===Ue||e===Ye)return"null"===t;if(!t)return!1;if(typeof e===t||"function"===t&&/^\s*\bfunction\b/.test(""+e)||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase())return!0;if(e&&e._classNames){for(o=0;o<e._classNames.length;o++)if(e._classNames[o]===t)return!0;return!1}return e!==Ue&&e!==Ye&&("DateTime"===t||"TimeSpan"===t?e instanceof Date:!("string"==typeof t&&"undefined number boolean string".indexOf(t)>-1)&&e instanceof t)},e.isCustomType=function(e,t){var o;if(e===Ue||e===Ye)return"null"===t;if(!t)return!1;if(e&&e._classNames){for(o=0;o<e._classNames.length;o++)if(e._classNames[o]===t)return!0;return!1}return"DateTime"===t||"TimeSpan"===t?e instanceof Date:!("function"!==t||!/^\s*\bfunction\b/.test(""+e))||(Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()||e instanceof t)},e.asCustomType=function(t,o){var n;if(t&&t._classNames){for(n=0;n<t._classNames.length;n++)if(t._classNames[n]===o)return t;return Ye}return e.isType(t,o)?t:Ye},e.isStringNumber=function(e){if(e===Ue||e===Ye)return!1;var t=e.toString();return!isNaN(Number(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t)},e.parseText2Value=function(e,o,n,r){var i,a,s,l=Ye;if(e&&(e.formatter?"string"==typeof(l=e.formatter)&&(l=new t.GeneralFormatter(l)):l=e._autoFormatter),l&&!(l instanceof t.AutoFormatter)){i=Ye;try{if("number"==typeof(i=l.Parse(o)))return i}catch(e){}return i===Ue||i===Ye?o:i}if(n){a={},s=Ye;try{s=(new t.GeneralFormatter).GetPreferredDisplayFormatter(o,a)}catch(e){}return r&&(r.value=s),a.hasOwnProperty("value")&&a.value!==Ue&&a.value!==Ye?a.value:o}return o},e.getPreferredZIndex=function(e){for(var o,n,r=e;r&&r.parentElement&&r.parentElement!==document.body;)r=r.parentElement;return o=1e3,r&&r.parentElement===document.body&&(n=parseInt(t.GC$(r).css("z-index")),isNaN(n)||(o+=n)),o},e.getLinearGradientColors=function(e){var t,o,n;if(!e)return[];var r=e.indexOf("("),i=e.lastIndexOf(")"),a=e.substring(r+1,i);if(!a)return[];for(var s=[],l=0,u="",c=0,h=0;h<a.length;)c=a.indexOf("rgb",l),-1===(h=a.indexOf("rgb",l+1))&&(h=a.length),u=a.substring(c,h),s.push(u),l=c=h;for(t=[],o=0,n=s.length;o<n;o++){var p=s[o],d=p.indexOf(")"),f=p.substring(0,d+1),g=parseFloat(p.substring(d+1,p.length));isNaN(g)&&(o===n-1?g=100:o<=1&&(g=0)),(f||0!==o)&&(g/=100,t.push({color:f,point:g}))}return t},e.getColumnAutoFitValue=function(t,o,n,r){var i,a,s,l,u,c,h=o._render,p=0,d=[n];for(1==r&&(3==n?d.push(1):2==n&&d.push(0)),i=0;i<d.length;i++)for(var f=0,g=(n=d[i],o.getRowCount(n));f>=0&&f<g;)if((a=o._getSpanModel(n).find(f,t))&&(a.col<t||a.colCount>1||a.row<f))f=a.row+a.rowCount;else{if(o.getRowHeight(f,n)>0){var m=o.getActualStyle(f,t,n),_=0,y=m.cellType||o.getDefaultCellType(n);if(y){s=m.font||h._getDefaultFont(n),m.font=h._getZoomFont(s),(l=!(!o.rowFilter()||!o.rowFilter().isFilterHeader(f,t,n)))||3!==n||(u=o.findTable(f,t))&&u.showHeader()&&u.headerIndex()===f&&u.rowFilter()&&u.filterButtonVisible(t-u.range().col)&&(l=!0);var C=m.formatter?m.formatter:m._autoFormatter,w={sheet:o,row:f,col:t,sheetArea:n},v=o.getValue(f,t,n),S=y.format(v,C,w);_=y.getAutoFitWidth(v,S,m,o._zoomFactor,w),l&&(c=Ze(o._zoomFactor,1),_+=parseInt((o.defaults.rowHeight*c).toString(),10))}_>p&&(p=_)}3===n?f=e._nextAutoFitRow(f,t,o,n):f++}return 0===p?p=o.defaults.colWidth:p+=Je(3/o._zoomFactor),p},e._nextAutoFitRow=function(e,t,o,n){for(var r,i=-1,a=o.getRowCount(n),s=e+1;s<a;s++){if(o.getText(s,t,n)){i=s;break}if((r=o.getActualStyle(s,t,n))&&r.cellType){i=s;break}}return i},e.getRowAutoFitValue=function(t,o,n,r){var i,a,s,l,u,c,h,p,d=o._render,f=0,g=[n];for(1==r&&(3==n?g.push(2):1==n&&g.push(0)),i=0;i<g.length;i++)for(n=g[i],a=0,s=o.getColumnCount(n);a>=0&&a<s;)if((l=o._getSpanModel(n).find(t,a))&&(l.row<t||l.rowCount>1||l.col<a))a=l.col+l.colCount;else{if(o.getColumnWidth(a,n)>0){if(c=(u=o.getActualStyle(t,a,n)).font||d._getDefaultFont(n),u.font=d._getZoomFont(c),h=0,p=o.getCellType(t,a,n)){var m=o.getText(t,a,n),_=o.getValue(t,a,n),y={sheet:o,row:t,col:a,sheetArea:n};h=p.getAutoFitHeight(_,m,u,o._zoomFactor,y)}h>f&&(f=h)}3===n?a=e._nextAutoFitColumn(t,a,o,n):a++}return 0===f?f=o.defaults.rowHeight:f+=Je(3/o._zoomFactor),f},e._nextAutoFitColumn=function(e,t,o,n){for(var r,i=1===n,a=o._nextNonNullColumn(e,t,i),s=-1,l=o.getColumnCount(n),u=t+1;u<l;u++)if((r=o.getActualStyle(e,u,n))&&r.cellType){s=u;break}return a>=0&&s>=0?Ze(a,s):a>=0?a:s>=0?s:-1},e.formatValue2Text=function(o,n,r){var i;if(r){var a=r._activeRowIndex,s=r._activeColIndex,l=o.formatter?o.formatter:o._autoFormatter;if(t.features.formatter&&n!==Ye&&n!==Ue)if(l instanceof t.AutoFormatter&&l._innerFormatter instanceof t.GeneralFormatter)n=l._innerFormatter.GetPreferredEditingFormatter(n).Format(n);else if("string"==typeof l&&(l=new t.GeneralFormatter(l)),l)try{2===l.GetFormatType(n)?((i=t.Calc.Convert.DT(n))&&(n=i),l=0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?new t.GeneralFormatter(t.DefaultTokens.DateTimeFormatInfo().shortDatePattern):new t.GeneralFormatter(t.DefaultTokens.DateTimeFormatInfo().shortDatePattern+" "+t.DefaultTokens.DateTimeFormatInfo().longTimePattern),r._editingTimeValue=!0,n=l.Format(n)):"number"==typeof n&&(n=t._NumberHelper.replaceNormalToCultureSymble(n.toString(),l.NumberFormatInfo()))}catch(e){n=r.getText(a,s)}else n=r.getText(a,s)}return n!==Ye&&n!==Ue&&(n=e.toString(n)),n},e.browser=(i=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}(navigator.userAgent),a={},i.browser&&(a[i.browser]=!0,a.version=i.version),a.chrome?a.webkit=!0:a.webkit&&(a.safari=!0),(o=navigator.userAgent.toLowerCase()).indexOf("compatible")<0&&null!==/(trident)(?:.*? rv ([\w.]+)|)/.exec(o)&&a&&(a.mozilla=void 0,a.msie=!0),null!==(n=/Edge\/\d+/.exec(navigator.userAgent))&&n.length>0&&a&&(a.webkit=void 0,a.chrome=void 0,a.msie=!0,a.version=n[0].substr(n[0].indexOf("/")+1)),r=function(){var e=null,t=null;try{new ActiveXObject("")}catch(t){e=t.name}try{t=!!new ActiveXObject("htmlfile")}catch(e){t=!1}return!(t="ReferenceError"==e||0!=t)},a.msie&&r()&&(a.metroMode=!0),a),e;var o,n,r,i,a}(),t.util=r,i=function(){function e(){}return e.showSelection=function(t){e._showSelectionImp(t)},e.hideSelection=function(t){e._hideSelectionImp(t)},e.isActiveElement=function(t){return e.getActiveElement()===t},e.getActiveElement=function(){return window.gcGlobal.activeElement},e.setActiveElement=function(t,o){var n=e.getActiveElement();e._setActiveElementImp(t),t===n||o||(n&&(n.endEdit(),e._hideSelectionImp(n)),e._showSelectionImp(t))},e._setActiveElementImp=function(e){window.gcGlobal.activeElement=e},e._showSelectionImp=function(e){e&&e._render.repaintSelection()},e._hideSelectionImp=function(t){var o,n,r,i;if(t&&!e.isActiveElement(t)&&t.parent&&t.parent.hideSelection()){var a,s,l=t._getSheetLayout(),u=t._render,c=u._getCtx(),h=t.getSelections();for(o=0,n=h.length;o<n;o++)a=h[o],(s=t._getRangeRect2(a)).width>=0&&s.height>=0&&(s.x-=9,s.y-=9,s.width+=18,s.height+=30,u.copyDoubleBufferRect(s));for(s=l.headerCornerRect(),t._dirty=!0,u.paintBody(c,s),r=0;r<=2;r++)(s=l.rowHeaderRect(r))&&0!==s.width&&0!==s.height&&(t._dirty=!0,u.paintBody(c,s));for(i=0;i<=2;i++)(s=l.colHeaderRect(i))&&0!==s.width&&0!==s.height&&(t._dirty=!0,u.paintBody(c,s))}},e}(),t.FocusHelper=i,a=function(){function e(){this._eventSuspended=0,typeof window.gcGlobal==je&&this._init()}return e.prototype._isIELessThan9=function(e){return r.browser.msie&&(typeof e===je||e<9)},e.prototype._createDummyObjects=function(){var t=e.prototype;t.getDummyHeader(),t.getDummyContent(),t.getDummyHover(),t.getDummyHighlight()},e.prototype.createSpan=function(e,t){var o=document.createElement("span");return o.className=e,t&&(o.id=t),o.style.display="none",document.body.insertBefore(o,Ye),o},e.prototype.getDummyHeader=function(){var o=e.prototype,n="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",r="span."+n.split(" ").join(".");return o._dummyHeader?t.GC$(document).find(r).length()<=0&&document.body.insertBefore(o._dummyHeader,Ye):o._dummyHeader=o.createSpan(n),o._dummyHeader},e.prototype.getDummyContent=function(){var o=e.prototype,n="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",r="span."+n.split(" ").join(".");return o._dummyContent?t.GC$(document).find(r).length()<=0&&document.body.insertBefore(o._dummyContent,Ye):o._dummyContent=o.createSpan(n),o._dummyContent},e.prototype.getDummyHover=function(){var o=e.prototype,n="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",r="span."+n.split(" ").join(".");return o._dummyHover?t.GC$(document).find(r).length()<=0&&document.body.insertBefore(o._dummyHover,Ye):o._dummyHover=o.createSpan(n),o._dummyHover},e.prototype.getDummyHighlight=function(){var o=e.prototype,n="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",r="span."+n.split(" ").join(".");return o._dummyHighlight?t.GC$(document).find(r).length()<=0&&document.body.insertBefore(o._dummyHighlight,Ye):o._dummyHighlight=o.createSpan(n),o._dummyHighlight},e.prototype.getDummyElement=function(){var o=e.prototype,n="gcDummyElement";return o._dummyElement?t.GC$(document).find("#"+n).length()<=0&&document.body.insertBefore(o._dummyElement,Ye):o._dummyElement=o.createSpan("gc-theme-version",n),o._dummyElement},e.prototype._init=function(){window.gcGlobal=this,this._eventSuspended=0;var o=e.prototype;window.addEventListener&&(window.addEventListener("keydown",o.keyDown,!0),window.addEventListener("keyup",o.keyUp,!0),window.addEventListener("compositionstart",o.compositionStart,!0),document.addEventListener("selectstart",o.docSelectStart,!0)),"mousedown touchstart MSPointerDown pointerdown".split(" ").forEach(function(e,n){t.GC$(document).bind(e,function(e){var t,n,a,s,l,u=i.getActiveElement();u&&(n=(t=o.getUIElement(e.target))&&"gcAttachedFormulaTextBox"===t.getAttribute("gcUIElement"),t||!u.endEdit||n||((a=O.formulatextboxAcrossSheetInstance)&&a.dom&&(a.sheet,u._formulaTextBox&&(u._formulaTextBox.destroy(),u._formulaTextBox=Ye,a.clear())),u.endEdit(),((s=r.device()).ipad||s.iphone)&&((l=u._eventHandler)&&l.setFocusToReadonlyFocusElem&&l.setFocusToReadonlyFocusElem())),!t&&u._disposeValidationUI&&u._disposeValidationUI(),t||i.setActiveElement(Ye))})}),t.GC$(document).bind("DOMContentLoaded",function(){e.prototype._createDummyObjects()})},e.prototype.keyDown=function(e){var o,n;window.gcGlobal._eventSuspended>0||(n=(o=i.getActiveElement())&&o._validationSelect)&&t.GC$(n).isVisible()||o&&o.doKeyDown&&(o.doKeyDown(e),o.isEditing()||(90!==e.keyCode&&89!==e.keyCode||!e.ctrlKey||e.altKey?86===e.keyCode&&e.ctrlKey&&!e.altKey&&e.stopPropagation&&e.stopPropagation():r.cancelDefault(e)))},e.prototype.keyUp=function(e){var t;window.gcGlobal._eventSuspended>0||(t=i.getActiveElement())&&t.doKeyUp&&t.doKeyUp(e)},e.prototype.compositionStart=function(e){var t;window.gcGlobal._eventSuspended>0||(t=i.getActiveElement())&&t.doCompositionStart&&t.doCompositionStart(e)},e.prototype.docSelectStart=function(e){return document.all===Ue&&i.getActiveElement()&&r.cancelDefault(e),!1},e.prototype.getUIElement=function(e){for(var t,o=e;o&&"BODY"!==o.tagName&&"function"==typeof o.getAttribute;){if((t=o.getAttribute("gcUIElement"))||(t=o.gcUIElement),t)return o;o=o.parentNode}return Ye},e.prototype.getExternalThemeStyle=function(o,n){var r,i,a,s,l=e.prototype,u=l.getDummyHeader();return 1===o||2===o?u=l.getDummyHighlight():4===o&&(u=l.getDummyHover()),r=u.className,t.GC$(u).removeClass(r).addClass(n),i=u.currentStyle,document.defaultView&&document.defaultView.getComputedStyle&&(i=document.defaultView.getComputedStyle(u,"")),a={backgroundColor:i.backgroundColor,backgroundImage:i.backgroundImage},t.GC$(u).addClass(r),document.defaultView&&document.defaultView.getComputedStyle&&(i=document.defaultView.getComputedStyle(u,"")),(s={backgroundColor:i.backgroundColor,backgroundImage:i.backgroundImage,color:i.color,zIndex:i.zIndex}).borderLeftColor=i.borderLeftColor,s.borderRightColor=i.borderRightColor,s.borderBottomColor=i.borderBottomColor,s.borderBottomWidth=i.borderBottomWidth,s.borderTopColor=i.borderTopColor,s.borderRightWidth=i.borderRightWidth,s.backgroundImage===a.backgroundImage&&s.backgroundColor!==a.backgroundColor&&(s.backgroundImage=Ue),t.GC$(u).removeClass(n),s},e.prototype.getStyleByCssClass=function(o){var n=e.prototype.getDummyElement(),r=n.currentStyle;return t.GC$(n).removeClass(n.className).addClass("gc-theme-version "+o),document.defaultView&&document.defaultView.getComputedStyle&&(r=document.defaultView.getComputedStyle(n,"")),t.GC$.extend({},r)},e.prototype.getThemeContentStyle=function(o){var n=e.prototype.getDummyContent(),r=n.currentStyle;return t.GC$(n).removeClass(n.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+o),document.defaultView&&document.defaultView.getComputedStyle&&(r=document.defaultView.getComputedStyle(n,"")),t.GC$.extend({},r)},e.prototype.suspendEvent=function(){window.gcGlobal._eventSuspended++},e.prototype.resumeEvent=function(){var e=window.gcGlobal;e._eventSuspended--,e._eventSuspended<0&&(e._eventSuspended=0)},e}(),t.Global=a,window.gcGlobal=new a,s=function(){function e(){}return e.getVisualStateThemeStyle=function(t,o){var n=f[t]+o,r=e.styleCache;return r[n]||(r[n]=a.prototype.getExternalThemeStyle(t,o)),r[n]},e.getCssClassThemeStyle=function(t){var o=t,n=e.styleCache;return n[o]||(n[o]=a.prototype.getStyleByCssClass(t)),n[o]},e.getContentThemeStyle=function(t){var o="content"+t,n=e.styleCache;return n[o]||(n[o]=a.prototype.getThemeContentStyle(t)),n[o]},e.clearCache=function(){e.styleCache={}},e.styleCache={},e}(),t.ThemeStyleHelper=s,l=function(){function e(){}return e.insert=function(e,t,o){e.splice(t,0,o)},e.add=function(e,t){e[e.length]=t},e.contains=function(e,t){for(var o=0;o<e.length;o++)if(e[o]===t)return!0;return!1},e.remove=function(e,t){for(var o=0;o<e.length;o++)if(e[o]===t)return void e.splice(o,1)},e.removeByIndex=function(e,t){return e.slice(0,t).concat(e.slice(t+1))},e.indexOf=function(e,t,o){if(typeof t===je)return-1;for(var n=o=o||0;n<e.length;n++)if(e[n]===t)return n;return-1},e.map=function(e,o,n){var r,i,a,s,l,u,c;if(!Array.prototype.map){if(l=(s=window.Object(e)).length>>>0,"function"!=typeof o)throw new TypeError(t._StringHelper.format(t.SR.Exp_NotAFunction,[o]));for(n&&(r=n),i=new Array(l),a=0;a<l;)a in s&&(u=s[a],c=o.call(r,u,a,s),i[a]=c),a++;return i}return e.map(o,n)},e.clear=function(e,t,o){var n,r;if(!(t<0))for(n=0,r=0;n<o&&r<e.length;r++)e[t+r]=Ye,n++},e.nextNonEmptyIndex=function(e,t){var o;for(t<0&&(t=-1),o=t+1;o<e.length;o++)if(e[o]!==Ue&&e[o]!==Ye)return o;return-1},e.isEquals=function(e,t){var o,n,r;if(null==e&&null==t)return!0;if(null==e&&null!=t||null!=e&&null==t||null!=e&&null!=t&&(!(e instanceof Array)||!(t instanceof Array))||e.length!==t.length)return!1;for(o=[],n=0,r=e.length;n<r;n++)o[e[n]]=!0;for(n=0,r=t.length;n<r;n++)if(!o[t[n]])return!1;return!0},e}(),t.ArrayHelper=l,(P=t.Key||(t.Key={}))[P.left=37]="left",P[P.right=39]="right",P[P.up=38]="up",P[P.down=40]="down",P[P.tab=9]="tab",P[P.enter=13]="enter",P[P.shift=16]="shift",P[P.ctrl=17]="ctrl",P[P.space=32]="space",P[P.altkey=18]="altkey",P[P.home=36]="home",P[P.end=35]="end",P[P.pup=33]="pup",P[P.pdn=34]="pdn",P[P.backspace=8]="backspace",P[P.del=46]="del",P[P.esc=27]="esc",P[P.a=65]="a",P[P.c=67]="c",P[P.v=86]="v",P[P.x=88]="x",P[P.z=90]="z",P[P.y=89]="y",t.Key,u=function(){return function(e,t,o,n,r,i){var a=this;a.key=e,a.ctrl=t,a.shift=o,a.alt=n,a.meta=i&&r||!1,a.action=i||r}}(),t.KeyMap=u,c=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e}(),t.Point=c,h=function(){function e(e,t,o,n){this.x=e,this.y=t,this.width=o,this.height=n}return e.prototype.intersect=function(e,t,o,n){var r=this;return e<r.x+r.width&&r.x<e+o&&t<r.y+r.height&&r.y<t+n},e.prototype.intersectRect=function(e){var t=this;return e.x<t.x+t.width&&t.x<e.x+e.width&&e.y<t.y+t.height&&t.y<e.y+e.height},e.prototype.contains=function(e,t){var o=this;return e<o.x+o.width&&o.x<e&&t<o.y+o.height&&o.y<t},e.prototype.containsRect=function(e){var t=this;return t.x<e.x&&e.x+e.width<t.x+t.width&&t.y<e.y&&e.y+e.height<t.y+t.height},e.prototype.getIntersectRect=function(e){return this.getIntersect(e.x,e.y,e.width,e.height)},e.prototype.getIntersect=function(t,o,n,r){var i=this,a=i.x,s=i.y,l=i.x+i.width,u=i.y+i.height,c=o,h=t+n,p=o+r,d=qe(a,t),f=qe(s,c),g=Ze(l,h)-d,m=Ze(u,p)-f;return g>0&&m>0?new e(d,f,g,m):Ye},e.prototype.round=function(){var e=this;e.x=Ke(e.x),e.y=Ke(e.y),e.width=Je(e.width),e.height=Je(e.height)},e.empty=function(){return new e(0,0,0,0)},e}(),t.Rect=h,p=function(){function e(e,t,o,n){this.row=e,this.rowCount=o,this.col=t,this.colCount=n}return e.prototype.intersect=function(e,t,o,n){var r=this;return(-1===e||-1===r.row||r.row<e+o&&e<r.row+r.rowCount)&&(-1===t||-1===r.col||r.col<t+n&&t<r.col+r.colCount)},e.prototype.getIntersect=function(t,o,n){var r;if(t==Ye||!(r=this).intersect(t.row,t.col,t.rowCount,t.colCount))return Ye;var i=-1==r.col?n:r.col+r.colCount-1,a=-1==t.col?n:t.col+t.colCount-1,s=-1==r.row?o:r.row+r.rowCount-1,l=-1==t.row?o:t.row+t.rowCount-1,u=qe(r.col,t.col),c=Ze(i,a),h=qe(r.row,t.row),p=Ze(s,l);return new e(h,u,-1==h?-1:p-h+1,-1==u?-1:c-u+1)},e.prototype.contains=function(t,o,n,r){var i=this;return 2===arguments.length?(-1===i.row||i.row<=t&&t<i.row+i.rowCount)&&(-1===i.col||i.col<=o&&o<i.col+i.colCount):4===arguments.length&&i.containsRange(new e(t,o,n,r))},e.prototype.containsRange=function(e){var t=this;return(-1===t.row||t.row<=e.row&&e.row+e.rowCount<=t.row+t.rowCount)&&(-1===t.col||t.col<=e.col&&e.col+e.colCount<=t.col+t.colCount)},e.prototype.offset=function(t,o){var n=this,r=n.col,i=n.row;return-1!==n.col&&(r+=t),-1!==n.row&&(i+=o),new e(i,r,n.rowCount,n.colCount)},e.prototype.union=function(t){var o=this,n=Ze(o.row,t.row),r=Ze(o.col,t.col);return new e(n,r,qe(o.row+o.rowCount-1,t.row+t.rowCount-1)-n+1,qe(o.col+o.colCount-1,t.col+t.colCount-1)-r+1)},e.prototype.equals=function(t){return t instanceof e&&(this.row===t.row&&this.col===t.col&&this.rowCount===t.rowCount&&this.colCount===t.colCount)},e}(),t.Range=p,d=function(){return function(e,t){this.row=e,this.col=t}}(),t.CellPosition=d,(L=t.RangeChangedAction||(t.RangeChangedAction={}))[L.DragDrop=0]="DragDrop",L[L.DragFill=1]="DragFill",L[L.Clear=2]="Clear",L[L.Paste=3]="Paste",L[L.Sort=4]="Sort",L[L.SetArrayFormula=5]="SetArrayFormula",L[L.EvaluateFormula=6]="EvaluateFormula",t.RangeChangedAction,(H=t.Direction||(t.Direction={}))[H.up=1]="up",H[H.down=2]="down",H[H.left=3]="left",H[H.right=4]="right",H[H.first=5]="first",H[H.last=6]="last",t.Direction,(k=t.HorizontalAlign||(t.HorizontalAlign={}))[k.left=0]="left",k[k.center=1]="center",k[k.right=2]="right",k[k.general=3]="general",t.HorizontalAlign,(V=t.VerticalAlign||(t.VerticalAlign={}))[V.top=0]="top",V[V.center=1]="center",V[V.bottom=2]="bottom",t.VerticalAlign,(B=t.HorizontalPosition||(t.HorizontalPosition={}))[B.left=0]="left",B[B.center=1]="center",B[B.right=2]="right",B[B.nearest=3]="nearest",t.HorizontalPosition,(z=t.VerticalPosition||(t.VerticalPosition={}))[z.top=0]="top",z[z.center=1]="center",z[z.bottom=2]="bottom",z[z.nearest=3]="nearest",t.VerticalPosition,(G=t.HeaderAutoText||(t.HeaderAutoText={}))[G.blank=0]="blank",G[G.numbers=1]="numbers",G[G.letters=2]="letters",t.HeaderAutoText,(W=t.ClipboardPasteOptions||(t.ClipboardPasteOptions={}))[W.All=0]="All",W[W.Values=1]="Values",W[W.Formatting=2]="Formatting",W[W.Formulas=3]="Formulas",t.ClipboardPasteOptions,(j=t.TextFileOpenFlags||(t.TextFileOpenFlags={}))[j.None=0]="None",j[j.IncludeRowHeader=1]="IncludeRowHeader",j[j.IncludeColumnHeader=2]="IncludeColumnHeader",j[j.UnFormatted=8]="UnFormatted",j[j.ImportFormula=16]="ImportFormula",t.TextFileOpenFlags,(U=t.VisualState||(t.VisualState={}))[U.Normal=0]="Normal",U[U.Highlight=1]="Highlight",U[U.Selected=2]="Selected",U[U.Active=3]="Active",U[U.Hover=4]="Hover",f=t.VisualState,(Y=t.ReferenceStyle||(t.ReferenceStyle={}))[Y.A1=0]="A1",Y[Y.R1C1=1]="R1C1",t.ReferenceStyle,(X=t.LineStyle||(t.LineStyle={}))[X.empty=0]="empty",X[X.thin=1]="thin",X[X.medium=2]="medium",X[X.dashed=3]="dashed",X[X.dotted=4]="dotted",X[X.thick=5]="thick",X[X.double=6]="double",X[X.hair=7]="hair",X[X.mediumDashed=8]="mediumDashed",X[X.dashDot=9]="dashDot",X[X.mediumDashDot=10]="mediumDashDot",X[X.dashDotDot=11]="dashDotDot",X[X.mediumDashDotDot=12]="mediumDashDotDot",X[X.slantedDashDot=13]="slantedDashDot",g=t.LineStyle,(K=t.SheetArea||(t.SheetArea={}))[K.corner=0]="corner",K[K.colHeader=1]="colHeader",K[K.rowHeader=2]="rowHeader",K[K.viewport=3]="viewport",t.SheetArea,(J=t.CopyToOption||(t.CopyToOption={}))[J.Value=1]="Value",J[J.Formula=2]="Formula",J[J.Comment=4]="Comment",J[J.RangeGroup=8]="RangeGroup",J[J.Sparkline=16]="Sparkline",J[J.Span=32]="Span",J[J.Style=64]="Style",J[J.Tag=128]="Tag",J[J.BindingPath=256]="BindingPath",J[J.ConditionalFormat=512]="ConditionalFormat",J[J.All=1023]="All",t.CopyToOption,(Z=t.SelectionPolicy||(t.SelectionPolicy={}))[Z.Single=0]="Single",Z[Z.Range=1]="Range",Z[Z.MultiRange=2]="MultiRange",t.SelectionPolicy,(q=t.SelectionUnit||(t.SelectionUnit={}))[q.Cell=0]="Cell",q[q.Row=1]="Row",q[q.Column=2]="Column",t.SelectionUnit,($=t.AutoFillType||(t.AutoFillType={}))[$.CopyCells=0]="CopyCells",$[$.FillSeries=1]="FillSeries",$[$.FillFormattingOnly=2]="FillFormattingOnly",$[$.FillWithoutFormatting=3]="FillWithoutFormatting",$[$.ClearValues=4]="ClearValues",$[$.Auto=5]="Auto",t.AutoFillType,(Q=t.FillDirection||(t.FillDirection={}))[Q.Left=0]="Left",Q[Q.Right=1]="Right",Q[Q.Up=2]="Up",Q[Q.Down=3]="Down",t.FillDirection,(ee=t.FillSeries||(t.FillSeries={}))[ee.Column=0]="Column",ee[ee.Row=1]="Row",t.FillSeries,(te=t.StorageType||(t.StorageType={}))[te.Data=1]="Data",te[te.Style=2]="Style",te[te.Comment=4]="Comment",te[te.Tag=8]="Tag",te[te.Sparkline=16]="Sparkline",te[te.Axis=32]="Axis",te[te.BindingPath=64]="BindingPath",t.StorageType,(oe=t.DragFillDirection||(t.DragFillDirection={}))[oe.Left=0]="Left",oe[oe.Right=1]="Right",oe[oe.Up=2]="Up",oe[oe.Down=3]="Down",oe[oe.LeftClear=4]="LeftClear",oe[oe.UpClear=5]="UpClear",t.DragFillDirection,(ne=t.EditorStatus||(t.EditorStatus={}))[ne.Ready=0]="Ready",ne[ne.Enter=1]="Enter",ne[ne.Edit=2]="Edit",t.EditorStatus,(re=t.CriteriaType||(t.CriteriaType={}))[re.AnyValue=0]="AnyValue",re[re.WholeNumber=1]="WholeNumber",re[re.DecimalValues=2]="DecimalValues",re[re.List=3]="List",re[re.Date=4]="Date",re[re.Time=5]="Time",re[re.TextLength=6]="TextLength",re[re.Custom=7]="Custom",t.CriteriaType,(ie=t.DataValidationResult||(t.DataValidationResult={}))[ie.ForceApply=0]="ForceApply",ie[ie.Discard=1]="Discard",ie[ie.Retry=2]="Retry",t.DataValidationResult,(ae=t.ErrorStyle||(t.ErrorStyle={}))[ae.Stop=0]="Stop",ae[ae.Warning=1]="Warning",ae[ae.Information=2]="Information",t.ErrorStyle,(se=t.GeneralCompareType||(t.GeneralCompareType={}))[se.EqualsTo=0]="EqualsTo",se[se.NotEqualsTo=1]="NotEqualsTo",se[se.GreaterThan=2]="GreaterThan",se[se.GreaterThanOrEqualsTo=3]="GreaterThanOrEqualsTo",se[se.LessThan=4]="LessThan",se[se.LessThanOrEqualsTo=5]="LessThanOrEqualsTo",t.GeneralCompareType,(le=t.RelationCompareType||(t.RelationCompareType={}))[le.Or=0]="Or",le[le.And=1]="And",t.RelationCompareType,(ue=t.ComparisonOperator||(t.ComparisonOperator={}))[ue.EqualsTo=0]="EqualsTo",ue[ue.NotEqualsTo=1]="NotEqualsTo",ue[ue.GreaterThan=2]="GreaterThan",ue[ue.GreaterThanOrEqualsTo=3]="GreaterThanOrEqualsTo",ue[ue.LessThan=4]="LessThan",ue[ue.LessThanOrEqualsTo=5]="LessThanOrEqualsTo",ue[ue.Between=6]="Between",ue[ue.NotBetween=7]="NotBetween",t.ComparisonOperator,(ce=t.TextComparisonOperator||(t.TextComparisonOperator={}))[ce.Contains=0]="Contains",ce[ce.DoesNotContain=1]="DoesNotContain",ce[ce.BeginsWith=2]="BeginsWith",ce[ce.EndsWith=3]="EndsWith",t.TextComparisonOperator,(he=t.TextCompareType||(t.TextCompareType={}))[he.EqualsTo=0]="EqualsTo",he[he.NotEqualsTo=1]="NotEqualsTo",he[he.BeginsWith=2]="BeginsWith",he[he.DoesNotBeginWith=3]="DoesNotBeginWith",he[he.EndsWith=4]="EndsWith",he[he.DoesNotEndWith=5]="DoesNotEndWith",he[he.Contains=6]="Contains",he[he.DoesNotContain=7]="DoesNotContain",t.TextCompareType,(pe=t.ColorCompareType||(t.ColorCompareType={}))[pe.BackgroundColor=0]="BackgroundColor",pe[pe.ForegroundColor=1]="ForegroundColor",t.ColorCompareType,(de=t.CustomValueType||(t.CustomValueType={}))[de.Empty=0]="Empty",de[de.NonEmpty=1]="NonEmpty",de[de.Error=2]="Error",de[de.NonError=3]="NonError",de[de.Formula=4]="Formula",t.CustomValueType,(fe=t.DateCompareType||(t.DateCompareType={}))[fe.EqualsTo=0]="EqualsTo",fe[fe.NotEqualsTo=1]="NotEqualsTo",fe[fe.Before=2]="Before",fe[fe.BeforeEqualsTo=3]="BeforeEqualsTo",fe[fe.After=4]="After",fe[fe.AfterEqualsTo=5]="AfterEqualsTo",t.DateCompareType,(ge=t.Top10ConditionType||(t.Top10ConditionType={}))[ge.Top=0]="Top",ge[ge.Bottom=1]="Bottom",t.Top10ConditionType,(me=t.DateOccurringType||(t.DateOccurringType={}))[me.Today=0]="Today",me[me.Yesterday=1]="Yesterday",me[me.Tomorrow=2]="Tomorrow",me[me.Last7Days=3]="Last7Days",me[me.ThisMonth=4]="ThisMonth",me[me.LastMonth=5]="LastMonth",me[me.NextMonth=6]="NextMonth",me[me.ThisWeek=7]="ThisWeek",me[me.LastWeek=8]="LastWeek",me[me.NextWeek=9]="NextWeek",t.DateOccurringType,(_e=t.QuarterType||(t.QuarterType={}))[_e.Quarter1=0]="Quarter1",_e[_e.Quarter2=1]="Quarter2",_e[_e.Quarter3=2]="Quarter3",_e[_e.Quarter4=3]="Quarter4",t.QuarterType,(ye=t.SortState||(t.SortState={}))[ye.None=0]="None",ye[ye.Ascending=1]="Ascending",ye[ye.Descending=2]="Descending",t.SortState,(Ce=t.AverageConditionType||(t.AverageConditionType={}))[Ce.Above=0]="Above",Ce[Ce.Below=1]="Below",Ce[Ce.EqualOrAbove=2]="EqualOrAbove",Ce[Ce.EqualOrBelow=3]="EqualOrBelow",Ce[Ce.Above1StdDev=4]="Above1StdDev",Ce[Ce.Below1StdDev=5]="Below1StdDev",Ce[Ce.Above2StdDev=6]="Above2StdDev",Ce[Ce.Below2StdDev=7]="Below2StdDev",Ce[Ce.Above3StdDev=8]="Above3StdDev",Ce[Ce.Below3StdDev=9]="Below3StdDev",t.AverageConditionType,(we=t.ScaleValueType||(t.ScaleValueType={}))[we.Number=0]="Number",we[we.LowestValue=1]="LowestValue",we[we.HighestValue=2]="HighestValue",we[we.Percent=3]="Percent",we[we.Percentile=4]="Percentile",we[we.Automin=5]="Automin",we[we.Formula=6]="Formula",we[we.Automax=7]="Automax",t.ScaleValueType,(ve=t.BarDirection||(t.BarDirection={}))[ve.LeftToRight=0]="LeftToRight",ve[ve.RightToLeft=1]="RightToLeft",t.BarDirection,(Se=t.DataBarAxisPosition||(t.DataBarAxisPosition={}))[Se.Automatic=0]="Automatic",Se[Se.CellMidPoint=1]="CellMidPoint",Se[Se.None=2]="None",t.DataBarAxisPosition,(xe=t.IconSetType||(t.IconSetType={}))[xe.ThreeArrowsColored=0]="ThreeArrowsColored",xe[xe.ThreeArrowsGray=1]="ThreeArrowsGray",xe[xe.ThreeTriangles=2]="ThreeTriangles",xe[xe.ThreeStars=3]="ThreeStars",xe[xe.ThreeFlags=4]="ThreeFlags",xe[xe.ThreeTrafficLightsUnrimmed=5]="ThreeTrafficLightsUnrimmed",xe[xe.ThreeTrafficLightsRimmed=6]="ThreeTrafficLightsRimmed",xe[xe.ThreeSigns=7]="ThreeSigns",xe[xe.ThreeSymbolsCircled=8]="ThreeSymbolsCircled",xe[xe.ThreeSymbolsUncircled=9]="ThreeSymbolsUncircled",xe[xe.FourArrowsColored=10]="FourArrowsColored",xe[xe.FourArrowsGray=11]="FourArrowsGray",xe[xe.FourRedToBlack=12]="FourRedToBlack",xe[xe.FourRatings=13]="FourRatings",xe[xe.FourTrafficLights=14]="FourTrafficLights",xe[xe.FiveArrowsColored=15]="FiveArrowsColored",xe[xe.FiveArrowsGray=16]="FiveArrowsGray",xe[xe.FiveRatings=17]="FiveRatings",xe[xe.FiveQuarters=18]="FiveQuarters",xe[xe.FiveBoxes=19]="FiveBoxes",t.IconSetType,(Re=t.IconValueType||(t.IconValueType={}))[Re.Number=1]="Number",Re[Re.Percent=4]="Percent",Re[Re.Formula=7]="Formula",Re[Re.Percentile=5]="Percentile",t.IconValueType,(be=t.RangeGroupDirection||(t.RangeGroupDirection={}))[be.Backward=0]="Backward",be[be.Forward=1]="Forward",t.RangeGroupDirection,(Te=t.ShowResizeTip||(t.ShowResizeTip={}))[Te.None=0]="None",Te[Te.Column=1]="Column",Te[Te.Row=2]="Row",Te[Te.Both=3]="Both",t.ShowResizeTip,(Ae=t.ShowScrollTip||(t.ShowScrollTip={}))[Ae.None=0]="None",Ae[Ae.Horizontal=1]="Horizontal",Ae[Ae.Vertical=2]="Vertical",Ae[Ae.Both=3]="Both",t.ShowScrollTip,(Ie=t.AutoFitType||(t.AutoFitType={}))[Ie.Cell=0]="Cell",Ie[Ie.CellWithHeader=1]="CellWithHeader",t.AutoFitType,(De=t.ImageLayout||(t.ImageLayout={}))[De.Stretch=0]="Stretch",De[De.Center=1]="Center",De[De.Zoom=2]="Zoom",De[De.None=3]="None",t.ImageLayout,(Fe=t.InvalidOperationType||(t.InvalidOperationType={}))[Fe.SetFormula=0]="SetFormula",Fe[Fe.CopyPaste=1]="CopyPaste",Fe[Fe.DragFill=2]="DragFill",Fe[Fe.DragDrop=3]="DragDrop",Fe[Fe.ChangePartOfArrayFormula=4]="ChangePartOfArrayFormula",Fe[Fe.ChangeSheetName=5]="ChangeSheetName",t.InvalidOperationType,(Me=t.StringComparison||(t.StringComparison={}))[Me.CurrentCulture=0]="CurrentCulture",Me[Me.CurrentCultureIgnoreCase=1]="CurrentCultureIgnoreCase",Me[Me.InvariantCulture=2]="InvariantCulture",Me[Me.InvariantCultureIgnoreCase=3]="InvariantCultureIgnoreCase",Me[Me.Ordinal=4]="Ordinal",Me[Me.OrdinalIgnoreCase=5]="OrdinalIgnoreCase",t.StringComparison,(Ee=t.TextDecorationType||(t.TextDecorationType={}))[Ee.Underline=1]="Underline",Ee[Ee.LineThrough=2]="LineThrough",Ee[Ee.Overline=4]="Overline",Ee[Ee.None=0]="None",t.TextDecorationType,(Ne=t.FilterActionType||(t.FilterActionType={}))[Ne.Filter=0]="Filter",Ne[Ne.Unfilter=1]="Unfilter",t.FilterActionType,(Oe=t.ImeMode||(t.ImeMode={}))[Oe.Auto=1]="Auto",Oe[Oe.Active=2]="Active",Oe[Oe.Inactive=4]="Inactive",Oe[Oe.Disabled=0]="Disabled",t.ImeMode,(Pe=t.CommentState||(t.CommentState={}))[Pe.Active=1]="Active",Pe[Pe.Edit=2]="Edit",Pe[Pe.Normal=3]="Normal",t.CommentState,(Le=t.SlicerDataChangeReason||(t.SlicerDataChangeReason={}))[Le.DataModified=0]="DataModified",Le[Le.DataAdded=1]="DataAdded",Le[Le.DataRemoved=2]="DataRemoved",t.SlicerDataChangeReason,(He=t.ResizeZeroIndicator||(t.ResizeZeroIndicator={}))[He.Default=0]="Default",He[He.Enhanced=1]="Enhanced",t.ResizeZeroIndicator,m=function(){function e(e,t){this.color=e||"black",this.style=t||0}return e.prototype.width=function(e){if(e&&e.style)switch(e.style){case 9:case 1:case 3:case 4:case 7:case 11:return 1;case 2:case 10:case 12:case 8:case 13:return 2;case 5:case 6:return 3}return 0},e.getLineWeight=function(t){var o=e._styleWeightCache;return o||(o=[],e._styleWeightCache=o,g,o[9]=100,o[3]=100,o[4]=100,o[11]=100,o[7]=100,o[1]=101,o[13]=198,o[8]=198,o[10]=198,o[12]=198,o[2]=199,o[5]=300,o[6]=90,o[0]=0),o[t]},e.prototype.toJSON=function(){var e={};return"black"!==this.color&&(e.color=this.color),0!==this.style&&(e.style=this.style),t.GC$.isEmptyObject(e)?Ue:e},e.prototype.fromJSON=function(e,t){e&&(e.color!==Ue&&(this.color=e.color),e.style!==Ue&&(this.style=e.style))},e}(),t.LineBorder=m,_={"font-style":function(e,o){e&&t.GC$(o).css("fontStyle",e)},"font-variant":function(e,o){e&&t.GC$(o).css("fontVariant",e)},"font-weight":function(e,o){e&&t.GC$(o).css("fontWeight",e)},"font-size":function(e,o){e&&t.GC$(o).css("fontSize",e)},"line-height":function(e,o){e&&t.GC$(o).css("lineHeight",e)},"font-family":function(e,o){e&&t.GC$(o).css("fontFamily",e)}},y=function(){function e(e){this._sheet=e}return e.prototype.buildFont=function(e,n){var r,i,a,s="";if(e){this._sheet,a=document.createElement("span"),t.GC$(a).css("visibility","hidden").css("top","-10000px").css("left","-10000px").css("position","absolute").css("lineHeight","normal").attr("className","gcFontDetectSpanStyle").attr("gcUIElement","gcFontDetectSpan"),document.body.insertBefore(a,Ye),r={span:a,dispose:function(){document.body.removeChild(a),delete this.span}};try{n&&t.GC$(r.span).css("font",n),t.GC$.each(_,function(t,o){o(e.hasOwnProperty(t)?e[t]:Ye,r.span)})}finally{i=r.span.currentStyle,document.defaultView&&document.defaultView.getComputedStyle&&(i=document.defaultView.getComputedStyle(r.span,"")),s=o(i),r.dispose()}}return s},e}(),t.FontFactory=y,(ke=t.CellTypeKind||(t.CellTypeKind={}))[ke.BaseCellType=0]="BaseCellType",ke[ke.TextCellType=1]="TextCellType",ke[ke.ColumnHeaderCellType=2]="ColumnHeaderCellType",ke[ke.RowHeaderCellType=3]="RowHeaderCellType",ke[ke.CornerCellType=4]="CornerCellType",ke[ke.CheckBoxCellType=5]="CheckBoxCellType",ke[ke.ButtonCellType=6]="ButtonCellType",ke[ke.ComboBoxCellType=7]="ComboBoxCellType",ke[ke.HyperLinkCellType=8]="HyperLinkCellType",t.CellTypeKind,(Ve=t.FocusPolicy||(t.FocusPolicy={}))[Ve.Never=0]="Never",Ve[Ve.Always=1]="Always",Ve[Ve.Auto=2]="Auto",t.FocusPolicy,(Be=t.ThemeVersion||(t.ThemeVersion={}))[Be.Excel2007=2007]="Excel2007",Be[Be.Excel2013=2013]="Excel2013",Be[Be.Excel2016=2016]="Excel2016",t.ThemeVersion,C=function(){function o(e,t,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R){if(this._id=o._styleId++,0!==arguments.length){var b=this;b.backgroundImage=m,b.backgroundImageLayout=y,b.backColor=e,b.foreColor=t,b.hAlign=n,b.vAlign=r,b.font=i,b.themeFont=a,b.formatter=s,b.borderLeft=l,b.borderTop=u,b.borderRight=c,b.borderBottom=h,b.locked=p,b.textIndent=d,b.wordWrap=f,b.shrinkToFit=g,b.validator=Ue,b.cellType=_,b.tabStop=C,b.textDecoration=w,b.imeMode=v,b.name=S,b.parentName=x,b.watermark=R}}return o.prototype._initDefault=function(){var e=this;e.backgroundImage=Ue,e.backgroundImageLayout=Ue,e.backColor=Ue,e.foreColor=Ue,e.hAlign=Ue,e.vAlign=Ue,e.font=Ue,e.themeFont=Ue,e.formatter=Ue,e.validator=Ue,e.borderLeft=Ue,e.borderTop=Ue,e.borderRight=Ue,e.borderBottom=Ue,e.locked=Ue,e.textIndent=Ue,e.wordWrap=Ue,e.shrinkToFit=Ue,e.cellType=Ue,e.name=Ue,e.parentName=Ue,e.tabStop=Ue,e.textDecoration=Ue,e.imeMode=Ue,e.watermark=Ue},o.prototype.copyFrom=function(e){this.fromJSON(e.toJSON()),e._autoFormatter&&(this._autoFormatter=e._autoFormatter)},o.prototype._copyFormat=function(o){var n,r,i=o;return t.features.formatter&&i&&i.constructor===Object&&((n=o.typeName)?(r=e.Sheets.getTypeFromString(n))&&(i=new r).fromJSON(o):i=new t.GeneralFormatter(o.formatCached,o.formatModeType,o.customerCultureName)),i},o.prototype._cloneLineBorder=function(e){return e&&e instanceof m?new m(e.color,e.style):e},o.prototype.compose=function(e,t){var o,n,r,i,a=this,s=a._cloneLineBorder;t?(a._autoFormatter=e._autoFormatter,a.backgroundImage=e.backgroundImage,a.backgroundImageLayout=e.backgroundImageLayout,a.backColor=e.backColor,a.foreColor=e.foreColor,a.hAlign=e.hAlign,a.vAlign=e.vAlign,a.font=e.font,a.themeFont=e.themeFont,a.formatter=e.formatter,o=e.borderLeft,a.borderLeft=o&&s(o)||o,n=e.borderTop,a.borderTop=n&&s(n)||n,r=e.borderRight,a.borderRight=r&&s(r)||r,i=e.borderBottom,a.borderBottom=i&&s(i)||i,a.locked=e.locked,a.textIndent=e.textIndent,a.wordWrap=e.wordWrap,a.shrinkToFit=e.shrinkToFit,a.validator=e.validator,a.cellType=e.cellType,a.name=e.name,a.parentName=e.parentName,a.tabStop=e.tabStop,a.textDecoration=e.textDecoration,a.imeMode=e.imeMode,a.watermark=e.watermark):(a.backgroundImage===Ue&&(a.backgroundImage=e.backgroundImage),a.backgroundImageLayout===Ue&&(a.backgroundImageLayout=e.backgroundImageLayout),a.backColor===Ue&&(a.backColor=e.backColor),a.foreColor===Ue&&(a.foreColor=e.foreColor),a.hAlign===Ue&&(a.hAlign=e.hAlign),a.vAlign===Ue&&(a.vAlign=e.vAlign),a.themeFont===Ue&&a.font===Ue?(a.themeFont=e.themeFont,a.font=e.font):a.themeFont!==Ue&&a.font===Ue&&(a.font=e.font),a.formatter===Ue&&(a.formatter=e.formatter),a.validator===Ue&&(a.validator=e.validator),a._autoFormatter===Ue&&(a._autoFormatter=e._autoFormatter),a.borderLeft===Ue&&(o=e.borderLeft,a.borderLeft=o&&s(o)||o),a.borderTop===Ue&&(n=e.borderTop,a.borderTop=n&&s(n)||n),a.borderRight===Ue&&(r=e.borderRight,a.borderRight=r&&s(r)||r),a.borderBottom===Ue&&(i=e.borderBottom,a.borderBottom=i&&s(i)||i),a.locked===Ue&&(a.locked=e.locked),a.textIndent===Ue&&(a.textIndent=e.textIndent),a.wordWrap===Ue&&(a.wordWrap=e.wordWrap),a.shrinkToFit===Ue&&(a.shrinkToFit=e.shrinkToFit),a.cellType===Ue&&(a.cellType=e.cellType),a.tabStop===Ue&&(a.tabStop=e.tabStop),a.textDecoration===Ue&&(a.textDecoration=e.textDecoration),a.imeMode===Ue&&(a.imeMode=e.imeMode),a.name===Ue&&(a.name=e.name),a.parentName===Ue&&(a.parentName=e.parentName),a.watermark===Ue&&(a.watermark=e.watermark))},o.prototype.clear=function(e){0!==arguments.length?("dataValidator"===e&&(e="validator"),this[e]=Ue):this._initDefault()},o.prototype.clone=function(e){var t=this,n=t._cloneLineBorder,r=new o(t.backColor,t.foreColor,t.hAlign,t.vAlign,t.font,t.themeFont,t.formatter,t.borderLeft&&!e&&n(t.borderLeft)||t.borderLeft,t.borderTop&&!e&&n(t.borderTop)||t.borderTop,t.borderRight&&!e&&n(t.borderRight)||t.borderRight,t.borderBottom&&!e&&n(t.borderBottom)||t.borderBottom,t.locked,t.textIndent,t.wordWrap,t.shrinkToFit,t.backgroundImage,t.cellType,t.backgroundImageLayout,t.tabStop,t.textDecoration,t.imeMode,t.name,t.parentName,t.watermark);return r._autoFormatter=t._autoFormatter,t.validator&&t.validator.clone&&(r.validator=t.validator.clone()),r},o.prototype._normalize=function(e){var t,o,n,r,i,a=this;if(e&&e.getColor)for((t=a.foreColor)&&((t=e.getColor(t))&&(a.foreColor=t)),(t=a.backColor)&&((t=e.getColor(t))&&(a.backColor=t)),n=0,r=(o=[a.borderLeft,a.borderTop,a.borderRight,a.borderBottom]).length;n<r;n++)(i=o[n])&&i.color&&((t=e.getColor(i.color))&&(i.color=t));return e&&e.getFont&&(a.themeFont?a.font=w.composeFont(a.font,e.getFont(a.themeFont)):a.font||(a.font=w.composeFont(a.font,e.bodyFont()))),a},o.prototype._getCellTypeKinds=function(){var o={};return o[0]=e.Sheets.BaseCellType,o[1]=e.Sheets.TextCellType,o[2]=e.Sheets.ColumnHeaderCellType,o[3]=e.Sheets.RowHeaderCellType,o[4]=e.Sheets.CornerCellType,t.features.celltype&&(o[5]=e.Sheets.CheckBoxCellType,o[6]=e.Sheets.ButtonCellType,o[7]=e.Sheets.ComboBoxCellType,o[8]=e.Sheets.HyperLinkCellType),o},o.prototype.toJSON=function(e,o){var n,r,i=this,a={backgroundImage:i.backgroundImage,backgroundImageLayout:i.backgroundImageLayout,backColor:i.backColor,foreColor:i.foreColor,hAlign:i.hAlign,vAlign:i.vAlign,font:i.font,themeFont:i.themeFont,formatter:i.formatter,locked:i.locked,textIndent:i.textIndent,wordWrap:i.wordWrap,shrinkToFit:i.shrinkToFit,validator:i.validator?i.validator.toJSON():Ue,cellType:i.cellType?i.cellType.toJSON():Ue,name:i.name,parentName:i.parentName,tabStop:i.tabStop,textDecoration:i.textDecoration,imeMode:i.imeMode,borderLeft:i.borderLeft?i.borderLeft.toJSON():Ue,borderRight:i.borderRight?i.borderRight.toJSON():Ue,borderTop:i.borderTop?i.borderTop.toJSON():Ue,borderBottom:i.borderBottom?i.borderBottom.toJSON():Ue,watermark:i.watermark,autoFormatter:i._autoFormatter?i._autoFormatter.toJSON():Ue},s={};for(n in a)(r=a[n])===Ue||o&&i._isDefaultValue(n,r,e)||(s[n]=r);return t.GC$.isEmptyObject(s)?Ue:s},o.prototype._isDefaultValue=function(e,t,o){switch(e){case"hAlign":return 2===o?1===t:1===o?1===t:3===t;case"vAlign":return 2===o?1===t:1===o?1===t:0===t;case"imeMode":return 1===t;case"autoFormatter":return t===Ue}},o.prototype.fromJSON=function(o,n){var r,i,a,s,l,u,c,h;if(o){if(r=this,o.backgroundImage!==Ue&&(r.backgroundImage=o.backgroundImage),o.backgroundImageLayout!==Ue&&(r.backgroundImageLayout=o.backgroundImageLayout),o.backColor!==Ue&&(r.backColor=o.backColor),o.foreColor!==Ue&&(r.foreColor=o.foreColor),o.hAlign!==Ue&&(r.hAlign=o.hAlign),o.vAlign!==Ue&&(r.vAlign=o.vAlign),o.font!==Ue&&(r.font=o.font),o.themeFont!==Ue&&(r.themeFont=o.themeFont),o.formatter!==Ue&&(r.formatter=this._copyFormat(o.formatter)),o.locked!==Ue&&(r.locked=o.locked),o.textIndent!==Ue&&(r.textIndent=o.textIndent),o.wordWrap!==Ue&&(r.wordWrap=o.wordWrap),o.shrinkToFit!==Ue&&(r.shrinkToFit=o.shrinkToFit),o.validator!==Ue&&((i=new e.Sheets.DefaultDataValidator).fromJSON(o.validator),r.validator=i),(a=o.cellType)!==Ue){var p,d=r._getCellTypeKinds(),f=a.type,g=a.typeName,_=d[f];_||(_=d[g]),_||(_=e.Sheets.getTypeFromString(g)),_&&(p=new _).fromJSON(a,n),r.cellType=p}o.name!==Ue&&(r.name=o.name),o.parentName!==Ue&&(r.parentName=o.parentName),o.tabStop!==Ue&&(r.tabStop=o.tabStop),o.textDecoration!==Ue&&(r.textDecoration=o.textDecoration),o.imeMode!==Ue&&(r.imeMode=o.imeMode),o.borderLeft!==Ue&&((s=new m).fromJSON(o.borderLeft,n),r.borderLeft=s),o.borderRight!==Ue&&((l=new m).fromJSON(o.borderRight,n),r.borderRight=l),o.borderTop!==Ue&&((u=new m).fromJSON(o.borderTop,n),r.borderTop=u),o.borderBottom!==Ue&&((c=new m).fromJSON(o.borderBottom,n),r.borderBottom=c),o.watermark!==Ue&&(r.watermark=o.watermark),o.autoFormatter!==Ue&&((h=new t.AutoFormatter(Ye)).fromJSON(o.autoFormatter),r._autoFormatter=h)}},o._styleId=0,o}(),t.Style=C,w=function(){function e(){}return e.composeFont=function(t,o){return o?e.normalizeFont(t,o):t},e.splitFont=function(e){return e?((t=document.createElement("div")).style.font=e,{fontFamily:(o=t.style).fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight}):{};var t,o},e.normalizeFont=function(n,r){var i,a,s,l,u;if(!n&&!r)return n;if((i=e).measureSpan?i._resetMeasureSpan():i._createMeasureSpan(),a=i.measureSpan,n){if(s=r?n+"+"+r:n,l=i._fontStringCatch[s])return l;t.GC$(a).css("font",n)}else{if(s=r,l=i._fontStringCatch[s])return l;t.GC$(a).css("fontSize",t.DefaultFontSize)}return r&&t.GC$(a).css("fontFamily",r),u=a.currentStyle,document.defaultView&&document.defaultView.getComputedStyle&&(u=document.defaultView.getComputedStyle(a,"")),l=o(u),i._fontStringCatch[s]=l,i._fontStringCatch[l]=l,l},e._scaleFont=function(t,o,n,r){var i,a,s,l,u,c,h,p,d=e,f=d.scaleFontInfoCache[o];if(!r)if(f){if(i=f[t])return i}else f=d.scaleFontInfoCache[o]={};return d.measureSpan?d._resetMeasureSpan():d._createMeasureSpan(),(a=d.measureSpan).style.font=t,s=a.currentStyle,(l=document.defaultView)&&l.getComputedStyle&&(s=l.getComputedStyle(a,"")),c="px",-1!==(u=s.fontSize).indexOf(c)&&(h=qe(1,Ke(parseFloat(u.replace(c,""))*o)),n&&1===h&&(n.value=!0),u=h+c),-1!==(p=s.lineHeight).indexOf(c)&&(p=qe(1,Ke(parseFloat(p.replace(c,""))*o))+c),1===o?i={font:t,fontSize:h}:(a.style.fontSize=u,a.style.lineHeight=p,i={font:a.style.font,fontSize:h}),r||(f[t]=i),i},e.composeTextDecoration=function(e){if(e<=0)return"none";var t="";return(1|e)===e&&(t+="underline "),(2|e)===e&&(t+="line-through "),(4|e)===e&&(t+="overline "),t.trim()},e._createMeasureSpan=function(){var e=document.createElement("span"),t=e.style;t.visibility="hidden",t.top="-10000px",t.left="-10000px",t.lineHeight="normal",t.position="absolute",document.body.insertBefore(e,Ye),this.measureSpan=e,this.measureSpanOriginalStyleText=t.cssText},e._resetMeasureSpan=function(){this.measureSpan.style.cssText=this.measureSpanOriginalStyleText},e._disposeMeasureSpan=function(){var e=this.measureSpan;e&&(t.GC$(e).remove(),this.measureSpan=Ue,this.measureSpanOriginalStyleText=Ue)},e.setStringFont=function(t,o){var n,r,i;if(!t)return"";for(i in(n=e).measureSpan?n._resetMeasureSpan():n._createMeasureSpan(),(r=n.measureSpan).style.font=t,o)o.hasOwnProperty(i)&&(r.style[i]=o[i]);return r.style.font},e._fontStringCatch={},e.scaleFontInfoCache={},e}(),t.StyleHelper=w,v=function(){function e(e,t,o,n){this._name=e,this._baseRow=o,this._baseColumn=n,this._expr=t}return e.prototype.getName=function(){return this._name},e.prototype.getRow=function(){return this._baseRow},e.prototype.getColumn=function(){return this._baseColumn},e.prototype.getExpression=function(){return this._expr},e.prototype.setExpression=function(e){this._expr=e},e}(),t.NameInfo=v,S=function(){function e(){}return e.getColor=function(e,t){if(e&&t){var o=e._currentTheme;if(o)return o.getColor(t)}return t},e.getFont=function(e,t){if(e&&t){var o=e._currentTheme;return o?o.getFont(t):t}return Ye},e}(),t._ThemeContext=S,x=function(){function e(e){var t=this;t.host=e,t.interval=Ye,t.action=Ye,t.intervalId=Ye,t.result=Ye,t.working=!1,t._needIncrease=!1}return e.prototype.setAction=function(e){"function"==typeof e&&(this.action=e)},e.prototype.setInterval=function(e){var t,o=this;isNaN(e)||0===e?o.stop():(o._needIncrease=e>0,e=Xe(e),t=o.interval,o.interval=e,t!==e&&o.start())},e.prototype.start=function(){var e=this;e.clear(),isNaN(e.interval)||(e.intervalId=setInterval(function(){e.run()},e.interval))},e.prototype.run=function(){var e=this;e.working=!0,"function"==typeof e.action&&(e.result=e.action.call(e.host,e._needIncrease))},e.prototype.stop=function(){var e=this;e.clear(),e.interval=Ye,e.intervalId=Ye,e.result=Ye,e.working=!1},e.prototype.clear=function(){this.intervalId&&clearInterval(this.intervalId)},e.prototype._dispose=function(){this.stop()},e}(),t.Timer=x,R=function(){function e(){}return e.ValidationError="ValidationError",e.CellClick="CellClick",e.CellDoubleClick="CellDoubleClick",e.EnterCell="EnterCell",e.LeaveCell="LeaveCell",e.ValueChanged="ValueChanged",e.TopRowChanged="TopRowChanged",e.LeftColumnChanged="LeftColumnChanged",e.InvalidOperation="InvalidOperation",e.RangeFiltering="RangeFiltering",e.RangeFiltered="RangeFiltered",e.TableFiltering="TableFiltering",e.TableFiltered="TableFiltered",e.RangeSorting="RangeSorting",e.RangeSorted="RangeSorted",e.ClipboardChanging="ClipboardChanging",e.ClipboardChanged="ClipboardChanged",e.ClipboardPasting="ClipboardPasting",e.ClipboardPasted="ClipboardPasted",e.ColumnWidthChanging="ColumnWidthChanging",e.ColumnWidthChanged="ColumnWidthChanged",e.RowHeightChanging="RowHeightChanging",e.RowHeightChanged="RowHeightChanged",e.DragDropBlock="DragDropBlock",e.DragDropBlockCompleted="DragDropBlockCompleted",e.DragFillBlock="DragFillBlock",e.DragFillBlockCompleted="DragFillBlockCompleted",e.EditStarting="EditStarting",e.EditStarted="EditStarted",e.EditChange="EditChange",e.EditEnding="EditEnding",e.EditEnd="EditEnd",e.EditEnded="EditEnded",e.RangeGroupStateChanging="RangeGroupStateChanging",e.RangeGroupStateChanged="RangeGroupStateChanged",e.SelectionChanging="SelectionChanging",e.SelectionChanged="SelectionChanged",e.SheetTabClick="SheetTabClick",e.SheetTabDoubleClick="SheetTabDoubleClick",e.SheetNameChanging="SheetNameChanging",e.SheetNameChanged="SheetNameChanged",e.UserZooming="UserZooming",e.UserFormulaEntered="UserFormulaEntered",e.CellChanged="CellChanged",e.ColumnChanged="ColumnChanged",e.RowChanged="RowChanged",e.ActiveSheetChanging="ActiveSheetChanging",e.ActiveSheetChanged="ActiveSheetChanged",e.SparklineChanged="SparklineChanged",e.RangeChanged="RangeChanged",e.ButtonClicked="ButtonClicked",e.EditorStatusChanged="EditorStatusChanged",e.CultureChanged="SpreadJSCultureChanged",e.FloatingObjectChanged="FloatingObjectChanged",e.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",e.PictureChanged="PictureChanged",e.FloatingObjectRemoving="FloatingObjectRemoving",e.FloatingObjectRemoved="FloatingObjectRemoved",e.PictureSelectionChanged="PictureSelectionChanged",e.CustomFloatingObjectLoaded="CustomFloatingObjectLoaded",e.TouchToolStripOpening="TouchToolStripOpening",e.CommentChanged="CommentChanged",e.CommentRemoving="CommentRemoving",e.CommentRemoved="CommentRemoved",e.SlicerChanged="SlicerChanged",e}(),t.Events=R,b=function(){function e(){return Array.apply(this,arguments),[]}return e.prototype.pop=function(){return Ye},e.prototype.push=function(e){return 0},e.prototype.splice=function(e,t){for(var o=[],n=0;n<arguments.length-2;n++)o[n]=arguments[n+2];return Ye},e.prototype.slice=function(e,t){return null},e}(),t._XArray=b,b.prototype=[],T=function(){function e(e){this._sheet=e}return e.prototype.getCellOverflowBuilder=function(e,t,o){var n,r=this._cellOverflowBuilderCache,i=e<<4+t;return r?((n=r[i])||(n=o(),r[i]=n),n):o()},e.prototype.getConditionalFormat=function(e,t){var o,n=this._conditionalFormatCache;return n?(o=n[e])?o[t]:null:null},e.prototype.setConditionalFormat=function(e,t,o,n){var r,i=this._conditionalFormatCache;i&&((r=i[e])||(r={},i[e]=r),r[t]={d:o,i:n})},e.prototype.getValue=function(e,t,o){var n,r,i,a=this._valueCache;return a?(void 0===o&&(o=3),(n=a[o])||(n={},a[o]=n),(r=n[e])||(r={},n[e]=r),void 0===(i=r[t])&&(i=this._sheet.getValue(e,t,o),r[t]=i),i):this._sheet.getValue(e,t,o)},e.prototype.getActualStyle=function(e,t,o){var n,r,i,a=this._styleCache;return a?(void 0===o&&(o=3),(n=a[o])||(n={},a[o]=n),(r=n[e])||(r={},n[e]=r),(i=r[t])||(i=this._sheet.getActualStyle(e,t,o,!1,!0),r[t]=i),i.clone(!0)):this._sheet.getActualStyle(e,t,o,!1,!1)},e.prototype.getZoomRowHeight=function(e){var t,o=this._rowHeightCache;return o?(void 0===(t=o[e])&&(t=o[e]=this._sheet._getZoomRowHeight(e)),t):this._sheet._getZoomRowHeight(e)},e.prototype.getZoomColWidth=function(e){var t,o=this._colWidthCache;return o?(void 0===(t=o[e])&&(t=o[e]=this._sheet._getZoomColumnWidth(e)),t):this._sheet._getZoomColumnWidth(e)},e.prototype.getRowGroups=function(e){return this._valueCache?(this._rowGroups||(this._rowGroups=e()),this._rowGroups):e()},e.prototype.getColGroups=function(e){return this._valueCache?(this._colGroups||(this._colGroups=e()),this._colGroups):e()},e.prototype.startCacheBeforPan=function(){var e=this;e._isCaching=!0,e._cellOverflowBuilderCache={},e._conditionalFormatCache={},e._valueCache={},e._styleCache={},e._rowHeightCache={},e._colWidthCache={}},e.prototype.endCache=function(){this._isCaching=!1},e.prototype.clearCacheEndPan=function(){var e=this;e._isCaching=!1,e._cellOverflowBuilderCache=null,e._conditionalFormatCache=null,e._valueCache=null,e._styleCache=null,e._colWidthCache=null,e._rowHeightCache=null,e._rowGroups=null,e._colGroups=null},e.prototype.isCaching=function(){return this._isCaching},e}(),t._CachePool=T,A=function(){function e(){}return e.startCache=function(t,o,n,r,i){var a,s,l,u=e;if(u._cached=!0,t.getRowCount(),t._hasTable(o,n,r-o+1,i-n+1))for(a=-1,s=u._visibleRowIndexCache=[],l=0;l<=r;l++)t.getRowVisible(l)?(a++,s[l]=a):s[l]=-1},e.clearCache=function(){e._visibleRowIndexCache=null,e._cached=!1},e.getFormatter=function(o){var n=e,r=n._formatterCache[o];return r||(r=new t.GeneralFormatter(o),n._formatterCache[o]=r),r},e.getFormattedText=function(o,n,r){var i,a,s,l=e,u=l._formattedTextCache;if(t.features.formatter){if((i=u[n])||(i={},u[n]=i),a=i[o])return r&&(r.value=a.color),a.text;s=Ye,(s=l._formatterCache[n])||(s=new t.GeneralFormatter(n),l._formatterCache[n]=s);var c={},h=s.Format(o,c),p=i[o]={};return p.text=h,p.color=c.value,r&&(r.value=c.value),h}return o.toString()},e.getFormattedTextByStyle=function(e,t,o,n){var r=t.cellType||e.getDefaultCellType(),i=t.formatter||t._autoFormatter;return r.format(o,i,n,Ye)},e.clearFormatCache=function(){e._formatterCache={},e._formattedTextCache={}},e._cached=!1,e._formatterCache={},e._formattedTextCache={},e}(),t._CacheMgr=A,I=function(){function e(){}return e.setStyle=function(t,o,n,r){var i,a;t&&((i=e).removeDataValidator(o,n,r),(a=t.validator&&t.validator.condition)&&a.getFormulas&&a.getFormulas().length>0&&i.addDataValidator(t.validator,o,n,r))},e.addDataValidator=function(t,o,n,r){var i,a,s=o._id,l=e._cache,u=l[t.id];u||(u=l[t.id]={validator:t,sheet:o}),(i=u[s])||(i=u[s]={}),i[a=n+"_"+r]||(i[a]=!0)},e.removeDataValidator=function(t,o,n){var r,i,a,s,l,u=t._id,c=e._cache;for(r in c)if((i=c[r])&&((a=i[u])||(a=i[u]={}),a[s=o+"_"+n])){for(l in delete a[s],a)return;for(l in delete i[u],i)return;return void delete c[r]}},e.removeSheet=function(t){var o,n,r,i=e._cache;for(o in i)if((n=i[o])[t]){for(r in delete n[t],n)return;delete i[o]}},e.getAllValidators=function(){var t=[],o=e._cache;for(var n in o)t.push(o[n]);return t},e.clear=function(){this._cache={}},e._cache={},e}(),t._DataValidatorCache=I,D=function(){function e(){}return e.addElements=function(e,t,o,n){var r,i,a,s,l;if(e&&0<=o&&o<t){for(r=[],a=o;a<t;a++)void 0!==e[a]&&r.push(a);for(i=r.length,a=0;a<i;a++)l=e[s=r[i-a-1]],e[s]=null,e[Math.floor(s)+n]=l}},e.deleteElements=function(e,t,o,n){var r,i,a,s,l,u;if(e&&0<=o&&o<t){for(r=[],a=o+n,s=o;s<t;s++)void 0!==e[s]&&(o<=s&&s<a?e[s]=null:s>=a&&r.push(s));for(i=r.length,s=0;s<i;s++)u=e[l=r[s]],e[l]=null,e[Math.floor(l)-n]=u}},e}(),t._ModelHelper=D,(ze=t._DataSourceType||(t._DataSourceType={}))[ze.None=0]="None",ze[ze.Normal=1]="Normal",ze[ze.Knockout=2]="Knockout",ze[ze.DataView=3]="DataView",ze[ze.CellBinding=4]="CellBinding",t._DataSourceType,(Ge=t.EndEditType||(t.EndEditType={}))[Ge.normal=0]="normal",Ge[Ge.arrayFormula=1]="arrayFormula",Ge[Ge.sharedFormula=2]="sharedFormula",t.EndEditType,F=function(){return function(){}}(),t.FormulaInformation=F,M=function(){function e(){}return e.getReg=function(t){var o=e.regDict[t];return o||(o=e.regDict[t]=new RegExp(t,"g")),o.lastIndex=0,o},e.getRegIgnoreCase=function(t){var o=e.regDictIgnoreCase[t];return o||(o=e.regDictIgnoreCase[t]=new RegExp(t,"gi")),o.lastIndex=0,o},e.getWildcardCriteria=function(t){if(e.wildcardParseRecord[t])return e.wildcardParseResultBuffer[t];if(e.getReg("[~?*]+").test(t)){var o=t,n=e.getReplaceSymbol("asterisk",o),r=e.getReplaceSymbol("question",o),i=e.getReplaceSymbol("tilde",o);return o=E.replace(o,"~~",i),o=E.replace(o,"~*",n),o=(o=E.replace(o,"~?",r)).replace(e.getReg("([.+$^\\[\\](){}|/])"),"\\$1"),o=E.replace(o,"*",".*"),o=E.replace(o,"?","."),o=E.replace(o,n,"\\*"),o=E.replace(o,r,"\\?"),o=E.replace(o,i,"~"),e.wildcardParseResultBuffer[t]=o,e.wildcardParseRecord[t]=!0,o}return Ye},e.getWildcardCriteriaFullMatch=function(t){var o=e.getWildcardCriteria(t);return o&&(o="^"+o+"$"),o},e.getReplaceSymbol=function(e,t){for(var o="#"+e+"0#",n=1;n<1e4;n++){if(!(t.indexOf(o)>0))return o;o=E.replace(o,"#"+e+(n-1)+"#","#"+e+n+"#")}},e.regDict={},e.regDictIgnoreCase={},e.wildcardParseRecord={},e.wildcardParseResultBuffer={},e}(),t.RegUtil=M,E=function(){function e(){}return e.replace=function(e,t,o){return e.split(t).join(o)},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){var o=e.length-t.length;return o>=0&&e.indexOf(t,o)===o},e.leftBefore=function(e,t){var o=e.indexOf(t);return o<0||o>=e.length?e:e.substr(0,o)},e.contains=function(e,t){return e.indexOf(t)>=0},e.count=function(e,t){for(var o=0,n=e.indexOf(t);n>=0;)o+=1,n=e.indexOf(t,n+1);return o},e.escapeHtml=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},o=M.getReg("(?:&|<|>|\"|'|`)");return o.test(e)?e.replace(o,function(e){return t[e]}):e},e.unescapeHtml=function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},o=M.getReg("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return o.test(e)?e.replace(o,function(e){return t[e]}):e},e}(),t.StringUtil=E,N=function(){function e(){}return e.getDevicePixel=function(){var e=window.devicePixelRatio||window.screen.deviceXDPI&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,t=20*e,o=Math.round(t);return Math.round(t)-t>.82?o/20:Math.round(100*e)/100},e.adjustDevicePixel=function(t,o,n,r){var i,a,s,l,u,c,h,p=e;if(p.setScaleX(t,t.getContext("2d"),1),p.setScaleY(t,t.getContext("2d"),1),1===(i=p.getDevicePixel())&&1===p.dpr);else if(p.dpr=i,a=o||n&&n.parent){for(s=p._spreadConvasCaches,h=0;h<s.length;h++)if(a===s[h].spread){l=s[h];break}if(l||(l={spread:a,sheets:[],canvases:[]},s.push(l)),o)l.canvases.push(t);else{for(c=l.sheets,h=0;h<c.length;h++)if(c[h].sheet===n){u=c[h];break}u||(u={sheet:n,canvases:[]},c.push(u)),u.canvases.push(t)}}},e.getScaleX=function(e){return e&&e._gcDPIScaleX||1},e.getScaleY=function(e){return e&&e._gcDPIScaleY||1},e.setScaleX=function(e,t,o){e&&(e._gcDPIScaleX=o,t._gcDPIScaleX=o)},e.setScaleY=function(e,t,o){e&&(e._gcDPIScaleY=o,t._gcDPIScaleY=o)},e.getLogicWidth=function(e){return e._gcLogicWidth},e.getLogicHeight=function(e){return e._gcLogicHeight},e.setLogicWidth=function(e,t){e._gcLogicWidth=t},e.setLogicHeight=function(e,t){e._gcLogicHeight=t},e.setSize=function(t,o,n){var i,a,s,l=e,u=l.dpr,c=l.getScaleX(t),h=l.getScaleY(t);l.setLogicWidth(t,o),l.setLogicHeight(t,n),1===u&&1===c&&1===h?(t.width=o,t.height=n):((i=t.getContext("2d")).scale(1/c,1/h),r.browser.mozilla?(t.width=Math.ceil(o*u),t.height=Math.ceil(n*u)):(t.width=Math.round(o*u),t.height=Math.round(n*u)),t.style.width=o+"px",t.style.height=n+"px",a=t.width/o,s=t.height/n,(a!==c||s!==h)&&(l.setScaleX(t,i,a),l.setScaleY(t,i,s)),i.scale(a,s))},e.disposeCanvasForSheet=function(t,o){for(var n,r,i,a,s=e._spreadConvasCaches,l=t.parent,u=0;u<s.length;u++)if(!l||s[u].spread===l)for(i=s[u].sheets,n=0;n<i.length;n++)if(i[n].sheet===t){for(a=i[n].canvases,r=0;r<a.length;r++)if(a[r]===o){a.splice(r,1);break}break}},e.disposeCanvasForSpread=function(t,o){for(var n,r,i=e._spreadConvasCaches,a=0;a<i.length;a++)if(i[a].spread===t)for(r=i[a].canvases,n=0;n<r.length;n++)if(r[n]===o){r.splice(n,1);break}},e.disposeSheet=function(t){for(var o,n,r=e._spreadConvasCaches,i=t.parent,a=0;a<r.length;a++)if(!i||r[a].spread===i){for(n=r[a].sheets,o=0;o<n.length;o++)n[o].sheet===t&&n.splice(o,1);return}},e.disposeSpread=function(t){for(var o=e._spreadConvasCaches,n=0;n<o.length;n++)if(o[n].spread===t)return void o.splice(n,1)},e.updateDPI=function(t,o){var n,r,i,a,s,l,u,c=e,h=c.getDevicePixel();if(c.dpr!=h)for(n=c._spreadConvasCaches,c.dpr=h,s=0;s<n.length;s++){for(i=n[s],u=0;u<i.canvases.length;u++)a=i.canvases[u],c.setSize(a,c.getLogicWidth(a),c.getLogicHeight(a));for(r=i.sheets,l=0;l<r.length;l++)for(u=0;u<r[l].canvases.length;u++)a=r[l].canvases[u],c.setSize(a,c.getLogicWidth(a),c.getLogicHeight(a))}},e.dpr=1,e._spreadConvasCaches=[],e}(),t.DPIHelper=N,O=function(){function e(){}return e.handleFormulatextboxAcrossSheetBeforeTabChange=function(e,t){},e.handleFormulatextboxAcrossSheetAfterTabChange=function(e,t){},e}(),t.IFormulatextboxAcrossSheetSingleton=O,(We=t.ExpressionType||(t.ExpressionType={}))[We.Cell=0]="Cell",We[We.ExternalCell=1]="ExternalCell",We[We.Range=2]="Range",We[We.ExternalRange=3]="ExternalRange",We[We.Double=4]="Double",We[We.String=5]="String",We[We.Boolean=6]="Boolean",We[We.Function=7]="Function",We[We.Name=8]="Name",We[We.ExternalName=9]="ExternalName",We[We.BinaryOperator=10]="BinaryOperator",We[We.UnaryOperator=11]="UnaryOperator",We[We.Error=12]="Error",We[We.ExternalError=13]="ExternalError",We[We.Parentheses=14]="Parentheses",We[We.Array=15]="Array",We[We.SheetRange=16]="SheetRange",We[We.StructReference=17]="StructReference",We[We.BangName=18]="BangName",We[We.SheetRangeError=19]="SheetRangeError",We[We.BangError=20]="BangError",We[We.MissingArgument=21]="MissingArgument",We[We.BangCell=22]="BangCell",We[We.BangRange=23]="BangRange",We[We.Expand=24]="Expand",We[We.NameIdentity=25]="NameIdentity",We[We.ExternalNameIdentity=26]="ExternalNameIdentity",t.ExpressionType}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){e.feature("core.imageLoader",["core.common"]);var t=function(){function t(e){this._imageCount=0,this._loadedCount=0,this.onLoadedComplete=e}return t.prototype.dispose=function(){this.onLoadedComplete=null},t.prototype.addImage=function(t){var o,n,r=this,i=r._imgs;i||(i=r._imgs={}),(o=i[t])||(o={},(n=e.GC$(document.createElement("img"))).bind("load",function(){r.imageLoaded(t)}),n.bind("error",function(){r.imageLoaded(t)}),n.bind("abort",function(){r.imageLoaded(t)}),r._imageCount++,o.state=!1,o.img=n,i[t]=o,n.getElement(0).src=t)},t.prototype.getImage=function(e){return this._imgs[e].img.getElement(0)},t.prototype.getState=function(e){var t=this._imgs,o=t&&t[e];return!!o&&o.state},t.prototype.imageLoaded=function(e){var t=this;t._loadedCount++,t._imgs[e].state=!0,t.isAllImagesLoaded()&&t.onLoadedComplete&&t.onLoadedComplete()},t.prototype.isAllImagesLoaded=function(){return this._loadedCount>=this._imageCount},t}();e._GcImageLoader=t}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){var t,o,n,r,i;(t=e.Sheets||(e.Sheets={})).feature("core.cultureInfo"),o=function(){this.currencyDecimalDigits=2,this.currencyDecimalSeparator=".",this.currencyGroupSeparator=",",this.currencyGroupSizes=[3],this.currencyNegativePattern=0,this.currencyPositivePattern=0,this.currencySymbol="¤",this.digitSubstitution=1,this.isReadOnly=!0,this.nanSymbol="NaN",this.nativeDigits=["0","1","2","3","4","5","6","7","8","9"],this.negativeInfinitySymbol="-Infinity",this.negativeSign="-",this.numberDecimalDigits=2,this.numberDecimalSeparator=".",this.numberGroupSeparator=",",this.numberGroupSizes=[3],this.numberNegativePattern=1,this.percentDecimalDigits=2,this.percentDecimalSeparator=".",this.percentGroupSeparator=",",this.percentGroupSizes=[3],this.percentNegativePattern=0,this.percentPositivePattern=0,this.percentSymbol="%",this.perMilleSymbol="‰",this.positiveInfinitySymbol="Infinity",this.positiveSign="+",this.abbreviatedDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.abbreviatedMonthGenitiveNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],this.abbreviatedMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],this.amDesignator="AM",this.calendarIsReadOnly=!0,this.calendarWeekRule=0,this.dateSeparator="/",this.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.firstDayOfWeek=0,this.fullDateTimePattern="dddd, dd MMMM yyyy HH:mm:ss",this.longDatePattern="dddd, dd MMMM yyyy",this.longTimePattern="HH:mm:ss",this.monthDayPattern="MMMM dd",this.monthGenitiveNames=["January","February","March","April","May","June","July","August","September","October","November","December",""],this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December",""],this.nativeCalendarName="Gregorian Calendar",this.pmDesignator="PM",this.rfc1123Pattern="ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",this.shortDatePattern="MM/dd/yyyy",this.shortestDayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],this.shortTimePattern="HH:mm",this.sortableDateTimePattern="yyyy'-'MM'-'dd'T'HH':'mm':'ss",this.timeSeparator=":",this.universalSortableDateTimePattern="yyyy'-'MM'-'dd HH':'mm':'ss'Z'",this.yearMonthPattern="yyyy MMMM",this.listSeparator=",",this.arrayListSeparator=",",this.arrayGroupSeparator=";"},t.CultureInfo=o,n=function(e){function t(){e.apply(this,arguments),this.currencySymbol="$",this.isReadOnly=!1,this.fullDateTimePattern="dddd, MMMM dd, yyyy h:mm:ss tt",this.longDatePattern="dddd, MMMM dd, yyyy",this.longTimePattern="h:mm:ss tt",this.shortDatePattern="M/d/yyyy",this.shortTimePattern="h:mm tt",this.yearMonthPattern="MMMM, yyyy",this.calendarIsReadOnly=!1}return __extends(t,e),t}(o),t._ENCultureInfo=n,r=function(e){function t(){e.apply(this,arguments),this.currencyDecimalDigits=0,this.currencyNegativePattern=1,this.currencySymbol="￥",this.isReadOnly=!1,this.nanSymbol="NaN (非数値)",this.negativeInfinitySymbol="-∞",this.percentNegativePattern=1,this.percentPositivePattern=1,this.positiveInfinitySymbol="+∞",this.abbreviatedDayNames=["日","月","火","水","木","金","土"],this.abbreviatedMonthGenitiveNames=["1","2","3","4","5","6","7","8","9","10","11","12",""],this.abbreviatedMonthNames=["1","2","3","4","5","6","7","8","9","10","11","12",""],this.amDesignator="午前",this.calendarIsReadOnly=!1,this.dayNames=["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],this.fullDateTimePattern="yyyy'年'M'月'd'日' H:mm:ss",this.longDatePattern="yyyy'年'M'月'd'日'",this.longTimePattern="H:mm:ss",this.monthDayPattern="M'月'd'日'",this.monthGenitiveNames=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],this.monthNames=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],this.nativeCalendarName="西暦 (日本語)",this.pmDesignator="午後",this.shortDatePattern="yyyy/MM/dd",this.shortestDayNames=["日","月","火","水","木","金","土"],this.shortTimePattern="H:mm",this.yearMonthPattern="yyyy'年'M'月'"}return __extends(t,e),t}(o),t._JACultureInfo=r,i=function(e){function t(){e.apply(this,arguments),this.currencyNegativePattern=2,this.currencySymbol="￥",this.isReadOnly=!1,this.nanSymbol="非数字",this.negativeInfinitySymbol="负无穷大",this.percentNegativePattern=1,this.percentPositivePattern=1,this.positiveInfinitySymbol="正无穷大",this.abbreviatedDayNames=["周日","周一","周二","周三","周四","周五","周六"],this.abbreviatedMonthGenitiveNames=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],this.abbreviatedMonthNames=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],this.amDesignator="上午",this.calendarIsReadOnly=!1,this.dayNames=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],this.firstDayOfWeek=1,this.fullDateTimePattern="yyyy'年'M'月'd'日' H:mm:ss",this.longDatePattern="yyyy'年'M'月'd'日'",this.longTimePattern="H:mm:ss",this.monthDayPattern="M'月'd'日'",this.monthGenitiveNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""],this.monthNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""],this.nativeCalendarName="公历",this.pmDesignator="下午",this.shortDatePattern="yyyy/M/d",this.shortestDayNames=["日","一","二","三","四","五","六"],this.shortTimePattern="H:mm",this.yearMonthPattern="yyyy'年'M'月'"}return __extends(t,e),t}(o),t._ZHCultureInfo=i,t.cultureInfoDict={"":new o,"en-us":new n,"ja-jp":new r,"zh-cn":new i},t.CR=t.cultureInfoDict["en-us"],t.dateTimeFormats=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d","hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","MM/dd/yyyy hh:mm:ss","MM/dd/yyyy hh:mm:s","MM/dd/yyyy hh:m:ss","MM/dd/yyyy hh:m:s","MM/dd/yyyy hh:mm:ss","MM/dd/yyyy h:mm:s","MM/dd/yyyy h:m:ss","MM/dd/yyyy h:m:s","MM/dd/yyyy hh:mm:ss tt","MM/dd/yyyy hh:mm:s tt","MM/dd/yyyy hh:m:ss tt","MM/dd/yyyy hh:m:s tt","MM/dd/yyyy h:mm:ss tt","MM/dd/yyyy h:mm:s tt","MM/dd/yyyy h:m:ss tt","MM/dd/yyyy h:m:s tt","MM/d/yyyy hh:mm:ss","MM/d/yyyy hh:mm:s","MM/d/yyyy hh:m:ss","MM/d/yyyy hh:m:s","MM/d/yyyy hh:mm:ss","MM/d/yyyy h:mm:s","MM/d/yyyy h:m:ss","MM/d/yyyy h:m:s","MM/d/yyyy hh:mm:ss tt","MM/d/yyyy hh:mm:s tt","MM/d/yyyy hh:m:ss tt","MM/d/yyyy hh:m:s tt","MM/d/yyyy h:mm:ss tt","MM/d/yyyy h:mm:s tt","MM/d/yyyy h:m:ss tt","MM/d/yyyy h:m:s tt","M/dd/yyyy hh:mm:ss","M/dd/yyyy hh:mm:s","M/dd/yyyy hh:m:ss","M/dd/yyyy hh:m:s","M/dd/yyyy hh:mm:ss","M/dd/yyyy h:mm:s","M/dd/yyyy h:m:ss","M/dd/yyyy h:m:s","M/dd/yyyy hh:mm:ss tt","M/dd/yyyy hh:mm:s tt","M/dd/yyyy hh:m:ss tt","M/dd/yyyy hh:m:s tt","M/dd/yyyy h:mm:ss tt","M/dd/yyyy h:mm:s tt","M/dd/yyyy h:m:ss tt","M/dd/yyyy h:m:s tt","M/d/yyyy hh:mm:ss","M/d/yyyy hh:mm:s","M/d/yyyy hh:m:ss","M/d/yyyy hh:m:s","M/d/yyyy hh:mm:ss","M/d/yyyy h:mm:s","M/d/yyyy h:m:ss","M/d/yyyy h:m:s","M/d/yyyy hh:mm:ss tt","M/d/yyyy hh:mm:s tt","M/d/yyyy hh:m:ss tt","M/d/yyyy hh:m:s tt","M/d/yyyy h:mm:ss tt","M/d/yyyy h:mm:s tt","M/d/yyyy h:m:ss tt","M/d/yyyy h:m:s tt","yy/MM/dd hh:mm:ss","yy/MM/dd hh:mm:s","yy/MM/dd hh:m:ss","yy/MM/dd hh:m:s","yy/MM/dd h:mm:ss","yy/MM/dd h:mm:s","yy/MM/dd h:m:ss","yy/MM/dd h:m:s","yy/MM/dd hh:mm:ss tt","yy/MM/dd hh:mm:s tt","yy/MM/dd hh:m:ss tt","yy/MM/dd hh:m:s tt","yy/MM/dd h:mm:ss tt","yy/MM/dd h:mm:s tt","yy/MM/dd h:m:ss tt","yy/MM/dd h:m:s tt","yy/MM/d hh:mm:ss","yy/MM/d hh:mm:s","yy/MM/d hh:m:ss","yy/MM/d hh:m:s","yy/MM/d hh:mm:ss","yy/MM/d h:mm:s","yy/MM/d h:m:ss","yy/MM/d h:m:s","yy/MM/d hh:mm:ss tt","yy/MM/d hh:mm:s tt","yy/MM/d hh:m:ss tt","yy/MM/d hh:m:s tt","yy/MM/d h:mm:ss tt","yy/MM/d h:mm:s tt","yy/MM/d h:m:ss tt","yy/MM/d h:m:s tt","yy/M/dd hh:mm:ss","yy/M/dd hh:mm:s","yy/M/dd hh:m:ss","yy/M/dd hh:m:s","yy/M/dd hh:mm:ss","yy/M/dd h:mm:s","yy/M/dd h:m:ss","yy/M/dd h:m:s","yy/M/dd hh:mm:ss tt","yy/M/dd hh:mm:s tt","yy/M/dd hh:m:ss tt","yy/M/dd hh:m:s tt","yy/M/dd h:mm:ss tt","yy/M/dd h:mm:s tt","yy/M/dd h:m:ss tt","yy/M/dd h:m:s tt","yy/M/d hh:mm:ss","yy/M/d hh:mm:s","yy/M/d hh:m:ss","yy/M/d hh:m:s","yy/M/d hh:mm:ss","yy/M/d h:mm:s","yy/M/d h:m:ss","yy/M/d h:m:s","yy/M/d hh:mm:ss tt","yy/M/d hh:mm:s tt","yy/M/d hh:m:ss tt","yy/M/d hh:m:s tt","yy/M/d h:mm:ss tt","yy/M/d h:mm:s tt","yy/M/d h:m:ss tt","yy/M/d h:m:s tt","yyyy/MM/dd hh:mm:ss","yyyy/MM/dd hh:mm:s","yyyy/MM/dd hh:m:ss","yyyy/MM/dd hh:m:s","yyyy/MM/dd hh:mm:ss","yyyy/MM/dd h:mm:s","yyyy/MM/dd h:m:ss","yyyy/MM/dd h:m:s","yyyy/MM/dd hh:mm:ss tt","yyyy/MM/dd hh:mm:s tt","yyyy/MM/dd hh:m:ss tt","yyyy/MM/dd hh:m:s tt","yyyy/MM/dd h:mm:ss tt","yyyy/MM/dd h:mm:s tt","yyyy/MM/dd h:m:ss tt","yyyy/MM/dd h:m:s tt","yyyy/MM/d hh:mm:ss","yyyy/MM/d hh:mm:s","yyyy/MM/d hh:m:ss","yyyy/MM/d hh:m:s","yyyy/MM/d hh:mm:ss","yyyy/MM/d h:mm:s","yyyy/MM/d h:m:ss","yyyy/MM/d h:m:s","yyyy/MM/d hh:mm:ss tt","yyyy/MM/d hh:mm:s tt","yyyy/MM/d hh:m:ss tt","yyyy/MM/d hh:m:s tt","yyyy/MM/d h:mm:ss tt","yyyy/MM/d h:mm:s tt","yyyy/MM/d h:m:ss tt","yyyy/MM/d h:m:s tt","yyyy/M/dd hh:mm:ss","yyyy/M/dd hh:mm:s","yyyy/M/dd hh:m:ss","yyyy/M/dd hh:m:s","yyyy/M/dd hh:mm:ss","yyyy/M/dd h:mm:s","yyyy/M/dd h:m:ss","yyyy/M/dd h:m:s","yyyy/M/dd hh:mm:ss tt","yyyy/M/dd hh:mm:s tt","yyyy/M/dd hh:m:ss tt","yyyy/M/dd hh:m:s tt","yyyy/M/dd h:mm:ss tt","yyyy/M/dd h:mm:s tt","yyyy/M/dd h:m:ss tt","yyyy/M/dd h:m:s tt","yyyy/M/d hh:mm:ss","yyyy/M/d hh:mm:s","yyyy/M/d hh:m:ss","yyyy/M/d hh:m:s","yyyy/M/d hh:mm:ss","yyyy/M/d h:mm:s","yyyy/M/d h:m:ss","yyyy/M/d h:m:s","yyyy/M/d hh:mm:ss tt","yyyy/M/d hh:mm:s tt","yyyy/M/d hh:m:ss tt","yyyy/M/d hh:m:s tt","yyyy/M/d h:mm:ss tt","yyyy/M/d h:mm:s tt","yyyy/M/d h:m:ss tt","yyyy/M/d h:m:s tt","MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","MM-dd-yyyy hh:mm:s","MM-dd-yyyy hh:m:ss","MM-dd-yyyy hh:m:s","MM-dd-yyyy hh:mm:ss","MM-dd-yyyy h:mm:s","MM-dd-yyyy h:m:ss","MM-dd-yyyy h:m:s","MM-dd-yyyy hh:mm:ss tt","MM-dd-yyyy hh:mm:s tt","MM-dd-yyyy hh:m:ss tt","MM-dd-yyyy hh:m:s tt","MM-dd-yyyy h:mm:ss tt","MM-dd-yyyy h:mm:s tt","MM-dd-yyyy h:m:ss tt","MM-dd-yyyy h:m:s tt","MM-d-yyyy hh:mm:ss","MM-d-yyyy hh:mm:s","MM-d-yyyy hh:m:ss","MM-d-yyyy hh:m:s","MM-d-yyyy hh:mm:ss","MM-d-yyyy h:mm:s","MM-d-yyyy h:m:ss","MM-d-yyyy h:m:s","MM-d-yyyy hh:mm:ss tt","MM-d-yyyy hh:mm:s tt","MM-d-yyyy hh:m:ss tt","MM-d-yyyy hh:m:s tt","MM-d-yyyy h:mm:ss tt","MM-d-yyyy h:mm:s tt","MM-d-yyyy h:m:ss tt","MM-d-yyyy h:m:s tt","M-dd-yyyy hh:mm:ss","M-dd-yyyy hh:mm:s","M-dd-yyyy hh:m:ss","M-dd-yyyy hh:m:s","M-dd-yyyy hh:mm:ss","M-dd-yyyy h:mm:s","M-dd-yyyy h:m:ss","M-dd-yyyy h:m:s","M-dd-yyyy hh:mm:ss tt","M-dd-yyyy hh:mm:s tt","M-dd-yyyy hh:m:ss tt","M-dd-yyyy hh:m:s tt","M-dd-yyyy h:mm:ss tt","M-dd-yyyy h:mm:s tt","M-dd-yyyy h:m:ss tt","M-dd-yyyy h:m:s tt","M-d-yyyy hh:mm:ss","M-d-yyyy hh:mm:s","M-d-yyyy hh:m:ss","M-d-yyyy hh:m:s","M-d-yyyy hh:mm:ss","M-d-yyyy h:mm:s","M-d-yyyy h:m:ss","M-d-yyyy h:m:s","M-d-yyyy hh:mm:ss tt","M-d-yyyy hh:mm:s tt","M-d-yyyy hh:m:ss tt","M-d-yyyy hh:m:s tt","M-d-yyyy h:mm:ss tt","M-d-yyyy h:mm:s tt","M-d-yyyy h:m:ss tt","M-d-yyyy h:m:s tt","yy-MM-dd hh:mm:ss","yy-MM-dd hh:mm:s","yy-MM-dd hh:m:ss","yy-MM-dd hh:m:s","yy-MM-dd h:mm:ss","yy-MM-dd h:mm:s","yy-MM-dd h:m:ss","yy-MM-dd h:m:s","yy-MM-dd hh:mm:ss tt","yy-MM-dd hh:mm:s tt","yy-MM-dd hh:m:ss tt","yy-MM-dd hh:m:s tt","yy-MM-dd h:mm:ss tt","yy-MM-dd h:mm:s tt","yy-MM-dd h:m:ss tt","yy-MM-dd h:m:s tt","yy-MM-d hh:mm:ss","yy-MM-d hh:mm:s","yy-MM-d hh:m:ss","yy-MM-d hh:m:s","yy-MM-d hh:mm:ss","yy-MM-d h:mm:s","yy-MM-d h:m:ss","yy-MM-d h:m:s","yy-MM-d hh:mm:ss tt","yy-MM-d hh:mm:s tt","yy-MM-d hh:m:ss tt","yy-MM-d hh:m:s tt","yy-MM-d h:mm:ss tt","yy-MM-d h:mm:s tt","yy-MM-d h:m:ss tt","yy-MM-d h:m:s tt","yy-M-dd hh:mm:ss","yy-M-dd hh:mm:s","yy-M-dd hh:m:ss","yy-M-dd hh:m:s","yy-M-dd hh:mm:ss","yy-M-dd h:mm:s","yy-M-dd h:m:ss","yy-M-dd h:m:s","yy-M-dd hh:mm:ss tt","yy-M-dd hh:mm:s tt","yy-M-dd hh:m:ss tt","yy-M-dd hh:m:s tt","yy-M-dd h:mm:ss tt","yy-M-dd h:mm:s tt","yy-M-dd h:m:ss tt","yy-M-dd h:m:s tt","yy-M-d hh:mm:ss","yy-M-d hh:mm:s","yy-M-d hh:m:ss","yy-M-d hh:m:s","yy-M-d hh:mm:ss","yy-M-d h:mm:s","yy-M-d h:m:ss","yy-M-d h:m:s","yy-M-d hh:mm:ss tt","yy-M-d hh:mm:s tt","yy-M-d hh:m:ss tt","yy-M-d hh:m:s tt","yy-M-d h:mm:ss tt","yy-M-d h:mm:s tt","yy-M-d h:m:ss tt","yy-M-d h:m:s tt","yyyy-MM-dd hh:mm:ss","yyyy-MM-dd hh:mm:s","yyyy-MM-dd hh:m:ss","yyyy-MM-dd hh:m:s","yyyy-MM-dd hh:mm:ss","yyyy-MM-dd h:mm:s","yyyy-MM-dd h:m:ss","yyyy-MM-dd h:m:s","yyyy-MM-dd hh:mm:ss tt","yyyy-MM-dd hh:mm:s tt","yyyy-MM-dd hh:m:ss tt","yyyy-MM-dd hh:m:s tt","yyyy-MM-dd h:mm:ss tt","yyyy-MM-dd h:mm:s tt","yyyy-MM-dd h:m:ss tt","yyyy-MM-dd h:m:s tt","yyyy-MM-d hh:mm:ss","yyyy-MM-d hh:mm:s","yyyy-MM-d hh:m:ss","yyyy-MM-d hh:m:s","yyyy-MM-d hh:mm:ss","yyyy-MM-d h:mm:s","yyyy-MM-d h:m:ss","yyyy-MM-d h:m:s","yyyy-MM-d hh:mm:ss tt","yyyy-MM-d hh:mm:s tt","yyyy-MM-d hh:m:ss tt","yyyy-MM-d hh:m:s tt","yyyy-MM-d h:mm:ss tt","yyyy-MM-d h:mm:s tt","yyyy-MM-d h:m:ss tt","yyyy-MM-d h:m:s tt","yyyy-M-dd hh:mm:ss","yyyy-M-dd hh:mm:s","yyyy-M-dd hh:m:ss","yyyy-M-dd hh:m:s","yyyy-M-dd hh:mm:ss","yyyy-M-dd h:mm:s","yyyy-M-dd h:m:ss","yyyy-M-dd h:m:s","yyyy-M-dd hh:mm:ss tt","yyyy-M-dd hh:mm:s tt","yyyy-M-dd hh:m:ss tt","yyyy-M-dd hh:m:s tt","yyyy-M-dd h:mm:ss tt","yyyy-M-dd h:mm:s tt","yyyy-M-dd h:m:ss tt","yyyy-M-dd h:m:s tt","yyyy-M-d hh:mm:ss","yyyy-M-d hh:mm:s","yyyy-M-d hh:m:ss","yyyy-M-d hh:m:s","yyyy-M-d hh:mm:ss","yyyy-M-d h:mm:s","yyyy-M-d h:m:ss","yyyy-M-d h:m:s","yyyy-M-d hh:mm:ss tt","yyyy-M-d hh:mm:s tt","yyyy-M-d hh:m:ss tt","yyyy-M-d hh:m:s tt","yyyy-M-d h:mm:ss tt","yyyy-M-d h:mm:s tt","yyyy-M-d h:m:ss tt","yyyy-M-d h:m:s tt"];e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){function t(e){return e.split(" ").join(" ").toUpperCase()}function o(e){for(var o=[],n=0,r=e.length;n<r;n++)o[n]=t(e[n]);return o}function n(o,n,r){var i=t(o),a=e.ArrayHelper.indexOf(n,i);return-1===a&&(a=e.ArrayHelper.indexOf(r,i)),a}function r(t){if(0===arguments.length)return e._currentCulture;var o;typeof t!==x&&t!==m&&t.toLowerCase()!==e._currentCulture&&(e.switchCulture(t),e._CacheMgr.clearFormatCache(),o=t,e.GC$("div[gcUIElement='gcSpread']").trigger(e.Events.CultureChanged,[{CultureInfo:o}]))}function i(t){t=t.toLowerCase();var o=e.cultureInfoDict[t];return o||(o=e.cultureInfoDict[""]),o}var a,s,l,u,c,h,p,d,f,g;e.feature("core.globalize",["core.stringResource","core.cultureInfo"]);var m=null,_=void 0,y=(Math.max,Math.min),C=Math.ceil,w=Math.floor,v=Math.abs,S=Math.pow,x="undefined",R=function(){function e(e){this._value={},this._len=0,this._init(e)}return e.prototype._init=function(e){this._parts=typeof e!==x&&e!==m&&""!==e?[e.toString()]:[],this._value={},this._len=0},e.prototype._insert=function(e){this._parts.splice(0,0,e)},e.prototype.insert=function(e,t){var o,n,r;(t===_||t===m)&&(t=0),0!==t?t>=(o=this.toString()).length?this.append(e):(n=o.substring(0,t),r=o.substr(t),this._init(n+e+r)):this._insert(e)},e.prototype.append=function(e){this._parts[this._parts.length]=e},e.prototype.appendLine=function(e){this._parts[this._parts.length]=typeof e===x||e===m||""===e?"\r\n":e+"\r\n"},e.prototype.clear=function(){this._init()},e.prototype.isEmpty=function(){return 0===this._parts.length||""===this.toString()},e.prototype.toString=function(e){var t,o,n,r=this;if(e=e||"",t=r._parts,r._len!==t.length&&(r._value={},r._len=t.length),typeof(o=r._value)[e]===x){if(""!==e)for(n=0;n<t.length;)typeof t[n]===x||""===t[n]||t[n]===m?t.splice(n,1):n++;o[e]=r._parts.join(e)}return o[e]},e}();e._StringBuilder=R,a=function(){return function(){var t=this,o=e._currentCultureResouce;t.currencyDecimalDigits=o.currencyDecimalDigits,t.currencyDecimalSeparator=o.currencyDecimalSeparator,t.currencyPositivePattern=o.currencyPositivePattern,t.currencyGroupSeparator=o.currencyGroupSeparator,t.currencySymbol=o.currencySymbol,t.currencyGroupSizes=o.currencyGroupSizes,t.currencyNegativePattern=o.currencyNegativePattern,t.digitSubstitution=o.digitSubstitution,t.isReadOnly=o.isReadOnly,t.numberGroupSizes=o.numberGroupSizes,t.nanSymbol=o.nanSymbol,t.nativeDigits=o.nativeDigits,t.numberNegativePattern=o.numberNegativePattern,t.negativeInfinitySymbol=o.negativeInfinitySymbol,t.negativeSign=o.negativeSign,t.numberDecimalDigits=o.numberDecimalDigits,t.numberDecimalSeparator=o.numberDecimalSeparator,t.numberGroupSeparator=o.numberGroupSeparator,t.positiveInfinitySymbol=o.positiveInfinitySymbol,t.positiveSign=o.positiveSign,t.percentDecimalDigits=o.percentDecimalDigits,t.percentDecimalSeparator=o.percentDecimalSeparator,t.percentGroupSeparator=o.percentGroupSeparator,t.percentSymbol=o.percentSymbol,t.perMilleSymbol=o.perMilleSymbol,t.percentPositivePattern=o.percentPositivePattern,t.percentNegativePattern=o.percentNegativePattern,t.percentGroupSizes=o.percentGroupSizes}}(),e._NumberFormatInfo=a,s=function(){return function(){var e=this;e.MinSupportedDateTime="@-62135568000000@",e.MaxSupportedDateTime="@253402300799999@",e.AlgorithmType=1,e.CalendarType=1,e.Eras=[1],e.TwoDigitYearMax=2029,e.isReadOnly=!0}}(),e._Calendar=s,l=function(){return function(){var t=this,o=e._currentCultureResouce;t.amDesignator=o.amDesignator,t.abbreviatedMonthNames=o.abbreviatedMonthNames,t.abbreviatedDayNames=o.abbreviatedDayNames,t.abbreviatedMonthGenitiveNames=o.abbreviatedMonthGenitiveNames,t.Calendar=new s,t.calendarWeekRule=o.calendarWeekRule,t.dateSeparator=o.dateSeparator,t.dayNames=o.dayNames,t.firstDayOfWeek=o.firstDayOfWeek,t.fullDateTimePattern=o.fullDateTimePattern,t.isReadOnly=o.isReadOnly,t.longDatePattern=o.longDatePattern,t.longTimePattern=o.longTimePattern,t.monthDayPattern=o.monthDayPattern,t.monthNames=o.monthNames,t.monthGenitiveNames=o.monthGenitiveNames,t.nativeCalendarName=o.nativeCalendarName,t.pmDesignator=o.pmDesignator,t.rfc1123Pattern=o.rfc1123Pattern,t.shortDatePattern=o.shortDatePattern,t.shortTimePattern=o.shortTimePattern,t.sortableDateTimePattern=o.sortableDateTimePattern,t.shortestDayNames=o.shortestDayNames,t.timeSeparator=o.timeSeparator,t.universalSortableDateTimePattern=o.universalSortableDateTimePattern,t.yearMonthPattern=o.yearMonthPattern,t.Calendar.isReadOnly=o.calendarIsReadOnly}}(),e._DateTimeFormatInfo=l,u=function(){function e(){}return e.isValidEraDate=function(e){return!(e<this.getEraMin()||e>this.getEraMax())},e.getEraDates=function(){var e,t,o,n=window.spreadJSEras;if(n!=_){for(e=[],t=0;t<n.length;t++)o=new Date(n[t].startDate.replace(/-/g,"/")),e[t]=o;return e}return this.EraDates},e.getEraNames=function(){var e,t=window.spreadJSEras,o=[];if(t!=_){for(e=0;e<t.length;e++)o[e]=t[e].name;return o}for(e=0;e<this.EraCount;e++)o[e]=this.EraNames[e+2*this.EraCount];return o},e.getEraSymbols=function(){var e,t=window.spreadJSEras,o=[];if(t!=_){for(e=0;e<t.length;e++)o[e]=t[e].symbol;return o}for(e=0;e<this.EraCount;e++)o[e]=this.EraNames[e];return o},e.getEraAbbreviations=function(){var e,t=window.spreadJSEras,o=[];if(t!=_){for(e=0;e<t.length;e++)o[e]=t[e].abbreviation;return o}for(e=0;e<this.EraCount;e++)o[e]=this.EraNames[e+this.EraCount];return o},e.getEraShortcuts=function(){var e,t=window.spreadJSEras,o=[];if(t!=_){for(e=0;e<t.length;e++)o[e]=t[e].shortcuts.split(",")[0];return o}for(e=0;e<this.EraCount;e++)o[e]=this.EraKeys[e];return o},e.getEraMax=function(){var e,t=window.spreadJSEras;return t!=_&&t.length>0?((e=new Date(t[t.length-1].startDate.replace(/-/g,"/"))).setFullYear(e.getFullYear()+99),e):this.EraMax},e.getEraMin=function(){var e=window.spreadJSEras;return e!=_&&e.length>0?new Date(e[0].startDate.replace(/-/g,"/")):this.EraMin},e.getEraCount=function(){var e=window.spreadJSEras;return e!=_?e.length:this.EraCount},e.getEraYears=function(){var e,t,o,n,r=window.spreadJSEras;if(r!=_){for(e=[],t=1;t<r.length;t++)o=new Date(r[t-1].startDate.replace(/-/g,"/")),n=new Date(r[t].startDate.replace(/-/g,"/")),e[t-1]=n.getFullYear()-o.getFullYear()+1;return e[t-1]=99,e}return this.EraYears},e.getEraDate=function(e){var t,o,n={};if(n.era=-1,n.eraYear=-1,!(t=this).isValidEraDate(e))return n;for(o=0;o<t.getEraCount();o++)if(e<(o+1!=t.getEraCount()?t.getEraDates()[o+1]:t.addMilliseconds(t.getEraMax(),1))){n.era=o,n.eraYear=e.getFullYear()-t.getEraDates()[o].getFullYear()+1;break}return n},e.addMilliseconds=function(e,t){var o=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return o.setMilliseconds(o.getMilliseconds()+t),new Date(o.valueOf())},e.getYearFromEra=function(t,o){return e.getEraDates()[t].getFullYear()+o-1},e.parseEraPart=function(t,o){var n,r,i,a,s;switch(o=o.toUpperCase(),n=e,t){case"g":for(r=n.getEraSymbols(),s=0;s<r.length;s++)if(r[s]===o)return s;break;case"gg":for(i=n.getEraAbbreviations(),s=0;s<i.length;s++)if(i[s]===o)return s;break;case"ggg":for(a=n.getEraNames(),s=0;s<a.length;s++)if(a[s]===o)return s}return-1},e.formatEraPart=function(t,o){var n,r=e,i=r.getEraDate(o);switch(t){case"g":if(i.era<0)break;return r.getEraSymbols()[i.era];case"gg":if(i.era<0)break;return r.getEraAbbreviations()[i.era];case"ggg":if(i.era<0)break;return r.getEraNames()[i.era];case"ee":if(i.eraYear<0)break;return 1===(n=i.eraYear.toString()).length&&(n="0"+n),n;case"e":if(i.eraYear<0)break;return i.eraYear.toString()}return""},e.EraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],e.EraCount=4,e.EraYears=[45,15,64,99],e.EraMax=new Date(2087,11,31,23,59,59),e.EraMin=new Date(1868,8,8),e.EraKeys=["1","2","3","4","m","t","s","h"],e.EraIndices=[0,1,2,3,0,1,2,3],e.EraNames=["M","T","S","H","明","大","昭","平","明治","大正","昭和","平成"],e.EraYearMax=99,e}(),e._EraHelper=u,c=function(){function r(t){t=t||"",this.name=t,e._currentCultureResouce=i(t),this.numberFormat=new a,this.dateTimeFormat=new l}return r.prototype.Name=function(){return this.name},r.prototype.NumberFormat=function(){return this.numberFormat},r.prototype.DateTimeFormat=function(){return this.dateTimeFormat},r.prototype._getDateTimeFormats=function(){return this._dateTimeFormats||(this._dateTimeFormats=e.dateTimeFormats),this._dateTimeFormats},r.prototype._getMonthIndex=function(e){var t=this;return t._upperMonths||(t._upperMonths=o(t.dateTimeFormat.monthNames),t._upperMonthsGenitive=o(t.dateTimeFormat.monthGenitiveNames)),n(e,t._upperMonths,t._upperMonthsGenitive)},r.prototype._getAbbrMonthIndex=function(e){var t=this;return t._upperAbbrMonths||(t._upperAbbrMonths=o(t.dateTimeFormat.abbreviatedMonthNames),t._upperAbbrMonthsGenitive=o(t.dateTimeFormat.abbreviatedMonthGenitiveNames)),n(e,t._upperAbbrMonths,t._upperAbbrMonthsGenitive)},r.prototype._getDayIndex=function(n){return this._upperDays||(this._upperDays=o(this.dateTimeFormat.dayNames)),e.ArrayHelper.indexOf(this._upperDays,t(n))},r.prototype._getAbbrDayIndex=function(n){return this._upperAbbrDays||(this._upperAbbrDays=o(this.dateTimeFormat.abbreviatedDayNames)),e.ArrayHelper.indexOf(this._upperAbbrDays,t(n))},r.invariantCulture=function(){var e=r;return e._invariantCulture||(e._invariantCulture=new r("")),e._invariantCulture},r.currentCulture=function(e){if(void 0===e)return r._currentCulture;var t=r;return t._currentCulture=t.getCulture(e),t._currentCulture},r.enCulture=function(){var e=r;return e._enCulture||(e._enCulture=new r("en-US")),e._enCulture},r.jaCulture=function(){var e,t=r;return t._jaCulture||((e=new r("ja-JP")).dateTimeFormat.eras=u,t._jaCulture=e),t._jaCulture},r.zhCulture=function(){var e=r;return e._zhCulture||(e._zhCulture=new r("zh-CN")),e._zhCulture},r.customCulture=function(e){var t,o=r;return o._customCulture&&o._customCulture.Name()===e||(t=new r(e),o._customCulture=t),o._customCulture},r.getCulture=function(t){switch(t=(t=t||"").toLowerCase(),e._currentCultureResouce=i(t),t){case"ja-jp":return r.jaCulture();case"en-us":return r.enCulture();case"zh-cn":return r.zhCulture();default:return r.customCulture(t)}},r}(),e._CultureInfo=c,h=function(){function t(e){this._str=e}return t.__toFormattedString=function(t,o){for(var n,r,i,a,s="",l=o[0],u=0;;){if(n=l.indexOf("{",u),r=l.indexOf("}",u),n<0&&r<0){s+=l.slice(u);break}if(r>0&&(r<n||n<0)){if("}"!==l.charAt(r+1))throw new Error(e.SR.Exp_BraceMismatch);s+=l.slice(u,r+1),u=r+2}else if(s+=l.slice(u,n),u=n+1,"{"!==l.charAt(u)){if(r<0)throw new Error(e.SR.Exp_BraceMismatch);var c=l.substring(u,r),h=c.indexOf(":"),p=parseInt(h<0?c:c.substring(0,h),10)+1;if(isNaN(p))throw new Error(e.SR.Exp_InvalidFormat);i=h<0?"":c.substring(h+1),(typeof(a=o[p])===x||a===m)&&(a=""),s+=a.toFormattedString?a.toFormattedString(i):t&&a.localeFormat?a.localeFormat(i):a.format?a.format(i):a.toString(),u=r+1}else s+="{",u++}return s},t.prototype.startsWith=function(e){return this._str.substr(0,e.length)===e},t.prototype.endsWith=function(e){return-1!==this._str.indexOf(e,this._str.length-e.length)},t.prototype.trim=function(){return this._str.replace(/^\s+|\s+$/g,"")},t.prototype.trimEnd=function(){return this._str.replace(/\s+$/,"")},t.prototype.trimStart=function(){return this._str.replace(/^\s+/,"")},t.format=function(e,o){var n,r=[];for(r.push(e),n=0;n<o.length;n++)r.push(o[n]);return t.__toFormattedString(!1,r)},t}(),e._StringHelper=h,p=function(){function e(){}return e.Contains=function(e,t){return""===t||e.indexOf(t)>=0},e.IndexOf=function(e,t,o){if(o){if(1===o){var n=e.toLowerCase(),r=t.toLowerCase();return n.indexOf(r)}return e.indexOf(t)}return e.indexOf(t)},e.TrimStart=function(e,t){if(!t)return e;for(var o=e;o.substr(0,t.length)===t;)o=o.substr(t.length);return o},e.TrimEnd=function(e,t){if(!t)return e;for(var o=e;o.substr(o.length-t.length,t.length)===t;)o=o.substr(0,o.length-t.length);return o},e.Trim=function(t,o){var n=o;return o||(n=" "),t=e.TrimStart(t,n),e.TrimEnd(t,n)},e.Insert=function(e,t,o){if(t<0||t>e.length||o===m||o===_)throw new Error;return e.substr(0,t)+o+e.substr(t,e.length-t)},e.Remove=function(e,t,o){if((o===_||o===m)&&(o=e.length-t),t<0||o<0||t+o>e.length)throw new Error;return e.substr(0,t)+e.substr(t+o,e.length-t-o)},e.StartsWith=function(e,t,o){if(!t)throw new Error;if(""===t)return!0;if(t.length>e.length)return!1;var n=e,r=t;return 1===o&&(n=n.toLowerCase(),r=r.toLowerCase()),n.search(new RegExp("^"+r))>-1},e.EndsWith=function(e,t,o){var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n},e.Replace=function(e,t,o){if(!t||""===t)throw new Error;o=(""+o).replace(/\$/g,"$$$$");var n=new RegExp(t,"g");return e.replace(n,o)},e}(),e.StringHelper=p,d=function(){function t(e){this._date=e}return t.prototype.Hour=function(){return this._date.getHours()},t.prototype.Minute=function(){return this._date.getMinutes()},t.prototype.Second=function(){return this._date.getSeconds()},t.prototype.Millisecond=function(){return this._date.getMilliseconds()},t.prototype.TotalDays=function(){return w(this.toOADate())},t.prototype.toOADate=function(){return t.___toOADate(this._date)},t.prototype.format=function(e){return this._toFormattedString(e,c._currentCulture)},t.prototype.customCultureFormat=function(e,t){return t||(t=c._currentCulture),this._toFormattedString(e,t)},t.prototype.localeFormat=function(e,t){return t||(t=c._currentCulture),this._toFormattedString(e,t)},t.prototype._toFormattedString=function(o,n){function r(){return c||h?c:(c=p.test(o),h=!0,c)}function i(e,t){if(g)return g[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate()}}var a,s,l,u,c,h,p,d,f,g,m,_=this,y=n.DateTimeFormat(),C=y.Calendar.convert;if(!o||!o.length||"i"===o)return n&&n.Name().length?C?_._toFormattedString(y.fullDateTimePattern,n):_._date.toLocaleString():_._date.toString();a=y.eras,s="s"===o,o=t.__expandFormat(y,o),l="",p=/([^d]|^)(d|dd)([^d]|$)/g,d=0,f=t.__getTokenRegExp(),!s&&C&&(g=C.fromGregorian(_._date));var S=-2,x=-2,R={value:""};for(m=0;;m++){var b=f.lastIndex,T=f.exec(o),A=o.slice(b,T?T.index:o.length);if(R.value="",d+=t.__appendPreOrPostMatch(A,R),l+=R.value,!T)break;if(d%2!=1)switch(T[0]){case"dddd":l+=y.dayNames[_._date.getDay()];break;case"ddd":l+=y.abbreviatedDayNames[_._date.getDay()];break;case"dd":c=!0,l+=t.___addLeadingZero(i(_._date,2));break;case"d":c=!0,l+=i(_._date,2);break;case"MMMM":l+=y.monthGenitiveNames&&r()?y.monthGenitiveNames[i(_._date,1)]:y.monthNames[i(_._date,1)];break;case"MMM":l+=y.abbreviatedMonthGenitiveNames&&r()?y.abbreviatedMonthGenitiveNames[i(_._date,1)]:y.abbreviatedMonthNames[i(_._date,1)];break;case"MM":l+=t.___addLeadingZero(i(_._date,1)+1);break;case"M":l+=i(_._date,1)+1;break;case"yyyy":case"yyy":l+=S>=0?a.formatEraPart("ee",_._date):t.___padYear(g?g[0]:_._date.getFullYear());break;case"yy":l+=S>=0?a.formatEraPart("ee",_._date):t.___addLeadingZero((g?g[0]:_._date.getFullYear())%100);break;case"y":l+=S>=0?a.formatEraPart("e",_._date):((g?g[0]:_._date.getFullYear())%100).toString();break;case"hh":0===(u=_._date.getHours()%12)&&(u=12),l+=t.___addLeadingZero(u);break;case"h":0===(u=_._date.getHours()%12)&&(u=12),l+=u;break;case"HH":l+=t.___addLeadingZero(_._date.getHours());break;case"H":l+=_._date.getHours().toString();break;case"mm":l+=t.___addLeadingZero(_._date.getMinutes());break;case"m":l+=_._date.getMinutes().toString();break;case"ss":l+=t.___addLeadingZero(_._date.getSeconds());break;case"s":l+=_._date.getSeconds().toString();break;case"tt":l+=_._date.getHours()<12?y.amDesignator:y.pmDesignator;break;case"t":l+=(_._date.getHours()<12?y.amDesignator:y.pmDesignator).charAt(0);break;case"f":l+=t.___addLeadingZeros(_._date.getMilliseconds()).charAt(0);break;case"ff":l+=t.___addLeadingZeros(_._date.getMilliseconds()).substr(0,2);break;case"fff":l+=t.___addLeadingZeros(_._date.getMilliseconds());break;case"z":l+=((u=_._date.getTimezoneOffset()/60)<=0?"+":"-")+w(v(u));break;case"zz":l+=((u=_._date.getTimezoneOffset()/60)<=0?"+":"-")+t.___addLeadingZero(w(v(u)));break;case"zzz":l+=((u=_._date.getTimezoneOffset()/60)<=0?"+":"-")+t.___addLeadingZero(w(v(u)))+":"+t.___addLeadingZero(v(_._date.getTimezoneOffset()%60));break;case"g":case"gg":case"ggg":if(!a)break;if(S===m-1){S=m;break}l+=a.formatEraPart(T[0],_._date),S=m;break;case"e":case"ee":if(!a){l+=t.___padYear(g?g[0]:_._date.getFullYear());break}if(x===m-1){x=m;break}l+=a.formatEraPart(T[0],_._date),x=m;break;case"/":l+=y.dateSeparator;break;case"[h]":l+="[h]";break;case"[hh]":l+="[hh]";break;case"[mm]":l+="[mm]";break;case"[ss]":l+="[ss]";break;default:throw new Error(e.SR.Exp_InvalidDateFormat)}else l+=T[0]}return l.toString()},t.parseLocale=function(e,o,n){var r;return r=o?[e,o]:[e],n||(n=c._currentCulture),t._parseDate(e,n,r)},t.parseInvariant=function(e,o){return t._parseDate(e,c.invariantCulture(),[e,o])},t.__appendPreOrPostMatch=function(e,t){for(var o,n=0,r=!1,i=0,a=e.length;i<a;i++)switch(o=e.charAt(i)){case"'":case'"':r?t.value+="'":n++,r=!1;break;case"\\":r&&(t.value+="\\"),r=!r;break;default:t.value+=o,r=!1}return n},t.__expandFormat=function(t,o){o||(o="F");var n=o.length;if(1===n)switch(o){case"d":return t.shortDatePattern;case"D":return t.longDatePattern;case"t":return t.shortTimePattern;case"T":return t.longTimePattern;case"f":return t.longDatePattern+" "+t.shortTimePattern;case"F":return t.fullDateTimePattern;case"M":case"m":return t.monthDayPattern;case"s":return t.sortableDateTimePattern;case"Y":case"y":return t.yearMonthPattern;case"g":return t.shortDatePattern+" "+t.shortTimePattern;case"G":return t.shortDatePattern+" "+t.longTimePattern;case"e":return o;case"R":case"r":return t.rfc1123Pattern;case"u":return t.universalSortableDateTimePattern;case"U":return t.fullDateTimePattern;case"o":case"O":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffff";default:throw new Error(e.SR.Exp_InvalidString)}else 2===n&&"%"===o.charAt(0)&&(o=o.charAt(1));return o},t.__expandYear=function(e,t){var o,n=new Date,r=e.DateTimeFormat().eras;return r&&t<100&&((t+=(o=r.getEraDate(n).eraYear)-o%100)>e.DateTimeFormat().Calendar.TwoDigitYearMax&&(t-=100)),t},t.__getTokenRegExp=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|ggg|gg|g|ee|e|\[h\]|\[hh\]|\[mm\]|\[ss\]/g},t.__getParseRegExp=function(o,n){var r,i,a,s;if(o._parseRegExp){if(o._parseRegExp[n])return o._parseRegExp[n]}else o._parseRegExp={};r=(r=(r=t.__expandFormat(o,n)).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var l,u="^",c={value:""},h=[],p=0,d=0,f=t.__getTokenRegExp();(l=f.exec(r))!==m;)if(c.value="",i=r.slice(p,l.index),p=f.lastIndex,d+=t.__appendPreOrPostMatch(i,c),u+=c.value,d%2!=1){switch(l[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":u+="(\\D+)";break;case"tt":case"t":u+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":u+="(\\d\\d?)";break;case"yyy":case"yyyy":u+="(\\d{2}|\\d{4})";break;case"fff":u+="(\\d{3})";break;case"ff":u+="(\\d{2})";break;case"f":u+="(\\d)";break;case"zzz":u+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":u+="([+-]?\\d\\d?)";break;case"/":u+="(\\"+o.dateSeparator+")";break;default:throw new Error(e.SR.Exp_InvalidDateFormat)}e.ArrayHelper.add(h,l[0])}else u+=l[0];return c.value="",t.__appendPreOrPostMatch(r.slice(p),c),u+=c.value,s={regExp:a=(u+="$").toString().replace(/\s+/g,"\\s+"),groups:h,exp:new RegExp(a)},o._parseRegExp[n]=s,s},t._parseDateExact=function(o,n,r){var i,a,s,l,u,c,p,d;o=e.GC$.trim(o);var f=r.DateTimeFormat(),g=t.__getParseRegExp(f,n),_=g.exp.exec(o);if(_===m)return m;var y,C=g.groups,w=m,v=m,S=m,x=m,R=m,b=0,T=0,A=0,I=0,D=m,F=!1;for(i=0,a=C.length;i<a;i++)if(s=_[i+1])switch(C[i]){case"dd":case"d":if(!1,(x=parseInt(s,10))<1||x>31)return m;break;case"MMMM":if(!1,(S=r._getMonthIndex(s))<0||S>11)return m;break;case"MMM":if(!1,(S=r._getAbbrMonthIndex(s))<0||S>11)return m;break;case"M":case"MM":case"%M":if(!1,(S=parseInt(s,10)-1)<0||S>11)return m;break;case"e":case"ee":if(!1,(v=t.__expandYear(r,parseInt(s,10)))<0||v>9999)return m;break;case"y":case"yy":case"yyy":case"yyyy":if(!1,(v=parseInt(s,10))<0||v>9999)return m;break;case"h":case"hh":case"H":case"HH":if((b=parseInt(s,10))<0)return m;break;case"m":case"mm":if((T=parseInt(s,10))<0||T>59)return m;break;case"s":case"ss":if((A=parseInt(s,10))<0||A>59)return m;break;case"tt":case"t":if(!(F=(l=s.toUpperCase())===f.pmDesignator.toUpperCase())&&l!==f.amDesignator.toUpperCase())return m;break;case"f":if((I=100*parseInt(s,10))<0||I>999)return m;break;case"ff":if((I=10*parseInt(s,10))<0||I>999)return m;break;case"fff":if((I=parseInt(s,10))<0||I>999)return m;break;case"dddd":if(!1,(R=r._getDayIndex(s))<0||R>6)return m;break;case"ddd":if(!1,(R=r._getAbbrDayIndex(s))<0||R>6)return m;break;case"zzz":if(2!==(u=s.split(/:/)).length||((y=parseInt(u[0],10))<-12||y>13)||((c=parseInt(u[1],10))<0||c>59))return m;D=60*y+(new h(s).startsWith("-")?-c:c);break;case"z":case"zz":if((y=parseInt(s,10))<-12||y>13)return m;D=60*y;break;case"g":case"gg":case"ggg":if(!(p=s)||!f.eras||(w=f.eras.parseEraPart(C[i],p))<0)return m}var M,E=/^(\d|\d\d):/.test(o)?new Date(1899,11,30):new Date,N=f.Calendar.convert;if(N&&(M=N.fromGregorian(E)),N||(M=[E.getFullYear(),E.getMonth(),E.getDate()]),v===m?v=M[0]:v<100&&(f.eras?v=f.eras.getYearFromEra(w||0,v):v+=v>=30?1900:2e3),S===m&&(S=M[1]),x===m&&(x=M[2]),N){if((E=N.toGregorian(v,S,x))===m)return m}else if(E.setFullYear(v,S,x),E.getDate()!==x||R!==m&&E.getDay()!==R)return m;return F&&b<12&&(b+=12),E.setHours(b,T,A,I),D!==m&&(d=E.getMinutes()-(D+E.getTimezoneOffset()),E.setHours(E.getHours()+d/60,d%60)),E},t.___addLeadingZero=function(e){return e<10?"0"+e:e.toString()},t.___addLeadingZeros=function(e){return e<10?"00"+e:e<100?"0"+e:e.toString()},t.___padYear=function(e){return e<10?"000"+e:e<100?"00"+e:e<1e3?"0"+e:e.toString()},t._parseDate=function(e,o,n){for(var r,i,a,s=!1,l=1,u=n.length;l<u;l++)if((i=n[l])&&(s=!0,r=t._parseDateExact(e,i,o)))return r;if(!s)for(l=0,u=(a=o._getDateTimeFormats()).length;l<u;l++)if(r=t._parseDateExact(e,a[l],o))return r;return m},t.___toOADate=function(e){return e===_||e===m?0:("number"==typeof e&&(e=new Date(e)),(1440*e.getTime()+3181192704e6-864e5*e.getTimezoneOffset())/124416e6)},t._fromOADate=function(e){var t=e-25569,o=new Date(864e5*t);return new Date((124416e6*e+(t>=0?1:-1)-3181192704e6+864e5*o.getTimezoneOffset())/1440)},t.parseExact=t._parseDateExact,t.fromOADate=t._fromOADate,t}(),e._DateTimeHelper=d;var b=function(){return function(e,t,o){this.normal=e,this.negative=t,this.zero=o}}(),T=function(){return function(){var e=this;e.intPart=m,e.decPart=m,e.group=!1,e.scale=0,e.percent=0,e.permile=0,e.exponent=m}}(),A=function(){function t(e){this._num=e}return t.prototype.format=function(e){return this._toFormattedString(e,c.invariantCulture())},t.prototype.localeFormat=function(e,t){return t||(t=c._currentCulture),this._toFormattedString(e,t)},t.prototype.customCultureFormat=function(e,t){return t||(t=c._currentCulture),this._toFormattedString(e,t)},t.prototype._toFormattedString=function(e,o){return e&&0!==e.length&&"i"!==e?t.__getStandardTokenRegExp().test(e)?this._toStandardFormattedString(e,o.NumberFormat()):this._toCustomFormattedString(e,o.NumberFormat()):o&&o.Name().length>0?this._num.toLocaleString():this._num.toString()},t.prototype._toStandardFormattedString=function(o,n){var r,i,a,s,l,u,c,h,p=this,d=v(p._num).toString();switch(o||(o="D"),r=-1,o.length>1&&(r=parseInt(o.slice(1),10)),o.charAt(0)){case"d":case"D":i="n",-1!==r&&(d=t.___zeroPad(""+d,r,!0)),p._num<0&&(d="-"+d);break;case"c":case"C":i=p._num<0?t.___currencyNegativePattern[n.currencyNegativePattern]:t.___currencyPositivePattern[n.currencyPositivePattern],-1===r&&(r=n.currencyDecimalDigits),d=t.___expandNumber(v(p._num),r,n.currencyGroupSizes,n.currencyGroupSeparator,n.currencyDecimalSeparator,n.negativeSign);break;case"n":case"N":i=p._num<0?t.___numberNegativePattern[n.numberNegativePattern]:"n",-1===r&&(r=n.numberDecimalDigits),d=t.___expandNumber(v(p._num),r,n.numberGroupSizes,n.numberGroupSeparator,n.numberDecimalSeparator,n.negativeSign);break;case"p":case"P":i=p._num<0?t.___percentNegativePattern[n.percentNegativePattern]:t.___percentPositivePattern[n.percentPositivePattern],-1===r&&(r=n.percentDecimalDigits),d=t.___expandNumber(100*v(p._num),r,n.percentGroupSizes,n.percentGroupSeparator,n.percentDecimalSeparator,n.negativeSign);break;case"F":case"f":d=(a=p._toFixedPoint(d,i,o,r,n))[0],i=a[1];break;case"e":case"E":d=(a=p._toScientificNotation(d,i,o,r,n))[0],i=a[1];break;case"x":case"X":i="n",d=t.___toHexString(p._num,"x"===o.charAt(0),-1===r?0:r);break;case"g":case"G":a=[],d=(a=-1===(s=p._num.toString()).indexOf("e")&&-1===s.indexOf("E")?p._toFixedPoint(d,i,o,r,n):p._toScientificNotation(d,i,o.replace("g","e").replace("G","E"),r,n))[0],i=a[1];break;default:throw new Error(e.SR.Exp_BadFormatSpecifier)}for(l=/n|\$|-|%/g,u="";c=l.lastIndex,h=l.exec(i),u+=i.slice(c,h?h.index:i.length),h;)switch(h[0]){case"n":u+=d;break;case"$":u+=n.currencySymbol;break;case"-":/[1-9]/.test(d)&&(u+=n.negativeSign);break;case"%":u+=n.percentSymbol;break;default:throw new Error(e.SR.Exp_InvalidNumberFormat)}return u},t.prototype._toScientificNotation=function(e,o,n,r,i){return"n",e=t.___toScientific(v(this._num),n.charAt(0),-1===r?6:r,i.numberGroupSizes,",",".",i.negativeSign),this._num<0&&(e="-"+e),[e,"n"]},t.prototype._toFixedPoint=function(e,o,n,r,i){o=this._num<0?t.___numberNegativePattern[i.numberNegativePattern]:"n",-1===r&&(r=2);var a=parseFloat(e),s=w(a),l=a-s;return[e=""+(s+(+(e=t.___expandNumber(l,r,i.numberGroupSizes,",",".",i.negativeSign))>=1?1:0))+e.substring(1),o]},t.prototype._toCustomFormattedString=function(e,o){var n,r=t.___parseCustomNumberFormatter(e),i=m;return 0===this._num?i=r.zero:this._num<0&&(i=r.negative),i||(i=r.normal),1===(n=t.___formatNumber(this._num,i,o)+"").indexOf(o.negativeSign)&&0===n.indexOf(o.currencySymbol)&&(n=n[1]+n[0]+n.substring(2)),n},t.parseLocale=function(e){return t.__parseNumber(e,c._currentCulture)},t.parseInvariant=function(e){return t.__parseNumber(e,c.invariantCulture())},t.__getStandardTokenRegExp=function(){return/^(C|c|D|d|E|e|F|f|G|g|N|n|P|p|R|r|X|x)(\d*)$/g},t.___getDigitLength=function(e,t){for(var o=w(v(e)),n={integer:1,decimal:0};o>=10;)o/=10,n.integer++;var r,i=e.toString(),a=i.search(/e/gi),s=i.indexOf(t);if(-1!==a){var l=i.substr(0,a),u=i.substr(a+1),c=0;-1!==s&&(c=l.substr(s+1).length),(r=c-parseFloat(u))<0&&(r=0),n.decimal=r}else r=0,-1!==s&&(r=i.substr(s+1).length),n.decimal=r;return n},t.___parseExponentFormat=function(t){for(var o={symbol:t.charAt(0),sign:0,exp:0},n="",r=1;r<t.length;r++)if("+"===(n=t.charAt(r)))o.sign=1;else{if("-"!==n){if("0"===n){o.exp=t.length-r;break}throw new Error(e.SR.Exp_InvalidExponentFormat)}o.sign=-1}return o},t.___parseCustomNumberFormatter=function(o){for(var n,r,i,a,s=m,l=m,u=m,c=new T,h="",p=!1,d=!1,f=!1,g=!1,y=!1,C=!1,w=!1,v=m,S=m,x=[],R=0;R<o.length;R++)if(v=o.charAt(R),p)"'"!==v?h+=v:(x.push(h),h="",p=!1),S=v;else if(d)'"'!==v?h+=v:(x.push(h),h="",d=!1),S=v;else{if(f){if("E"===S||"e"===S){if("+"===v||"-"===v||"0"===v){h+=v;continue}f=!1}else if("+"===S||"-"===S){if("0"===v){h+=v;continue}f=!1,x.push(h),h=""}else if("0"===S){if("0"===v){h+=v;continue}f=!1,C||(C=!0,c.exponent=t.___parseExponentFormat(h)),x.push(h),h=""}}else if("0"===v||"#"===v){if(w=!0,"0"===S||"#"===S){h+=v,S=v;continue}""!==h&&(x.push(h),h="")}else("0"===S||"#"===S)&&"0"!==v&&"#"!==v&&(x.push(h),h="");if(";"===v){if(""!==h&&(f&&!C&&(c.exponent=t.___parseExponentFormat(h)),x.push(h),h=""),g?c.decPart=v:c.intPart=x,x=[],s===_||s===m)s=c;else if(l===_||l===m)l=c;else{if(u!==_&&u!==m)throw new Error(e.SR.Exp_InvalidSemicolons);u=c}g=!1,w=!1,y&&(c.group=!0,y=!1),c=new T}else if(g||"."!==v)if("'"===v)p=!0;else if('"'===v)d=!0;else if("%"===v)c.percent++,""!==h&&(x.push(h),h=""),x.push(v);else if(v===e.CR.perMilleSymbol)c.permile++,x.push(v);else if("0"===v||"#"===v)h+=v;else if(","===v)if(g)""!==h&&(x.push(h),h="");else{if(""!==h&&(x.push(h),h=""),!w)continue;for(n=!0,r="",i=R+1;i<o.length;i++)if(a=o.charAt(i),""===r)if("'"===a||'"'===a)r=a;else{if("0"===a||"#"===a){n=!1;break}if("."===a||";"===a)break}else("'"===a||'"'===a)&&(r="");n?c.scale++:y=!0}else"E"===v||"e"===v?(f=!0,""!==h&&x.push(h),h=v):h+=v;else"#"!==S&&"0"!==S&&(x.push(h),h="#"),""!==h&&(x.push(h),h=""),c.intPart=x,x=[],g=!0,w=!1,y&&(c.group=!0,y=!1);S=v}return""!==h&&(f&&!C&&(c.exponent=t.___parseExponentFormat(h)),x.push(h)),y&&(c.group=!0),g?c.decPart=x:c.intPart=x,s===_||s===m?s=c:l===_||l===m?l=c:(u===_||u===m)&&(u=c),new b(s,l,u)},t.___zeroPad=function(e,t,o){for(var n=e.length;n<t;n++)e=o?"0"+e:e+"0";return e},t.__insertGroupSeparator=function(t,o,n,r){for(var i=o[0],a=1,s=t.length-1,l=new R(""),u=0,c=!1;s>=0;){if(i<1||i>9)throw new Error(e.SR.Exp_InvalidNumberGroupSize);/\d/gi.test(t[s])?(c&&(l.insert(n,0),c=!1),u++):u=0,l.insert(t[s],0),u===i&&(c=!0,u=0,a<o.length&&(i=o[a],a++)),s--}return l.toString()},t.___expandNumber=function(e,o,n,r,i,a,s){var l,u,c,h,p=t.round10(e,-o);return isFinite(p)||(p=e),l=(h=(l=(e=p).toString()).split(/e/i))[0],c=h.length>1?parseInt(h[1],10):0,l=(h=l.split("."))[0],u=h.length>1?h[1]:"",c>0?(l+=(u=t.___zeroPad(u,c,!1)).slice(0,c),u=u.substr(c)):c<0&&(c=-c,u=(l=e<0?a+t.___zeroPad(l.replace(a,""),c+1,!0):t.___zeroPad(l,c+1,!0)).slice(-c,l.length)+u,l=l.slice(0,-c)),o>0?u=i+(u=u.length>o?u.slice(0,o):t.___zeroPad(u,o,!1)):u="",!0===s?l+u:t.__insertGroupSeparator(l,n,r,a)+u},t.___formatNumber=function(e,o,n){var r,i,a,s,l,u,c,h,p,d,f,g,_,y,C,w,x,b,T,A,I,D,F,M,E,N,O,P,L=new R("");if(e*=S(100,o.percent),e*=S(1e3,o.permile),e/=S(10,3*o.scale),r=o.intPart,i=o.decPart,!r&&!i)return"";if(a=m,s=m,r)for(a="",l=0;l<r.length;l++)u=r[l],/^(0|#)+/g.test(u)&&(a+=u);if(i)for(s="",c=0;c<i.length;c++)h=i[c],/^(0|#)+/g.test(h)&&(s+=h);if(!a&&!s)return(r?r.join(""):"")+(i?i.join(""):"");if(s||(s=""),d=0,f=t.___getDigitLength(e,"."),o.exponent)if(g=v(e),_=a?a.length:1,g>=1)f.integer>_?(f.integer-=_,f.decimal+=_,e/=S(10,f.integer),d=f.integer):(f.integer,d=0),-1===o.exponent.sign&&(o.exponent.sign=0);else if(g<1&&g>0){for(o.exponent.sign=-1,f.integer=_,f.decimal-=_,y=S(10,_);10*g<y;)g*=10,d++;e*=S(10,d)}var H=s.lastIndexOf("0"),k=s.lastIndexOf("#"),V=f.decimal;if(H>=0&&(V=H+1),k>H&&k<f.decimal&&(V=k+1),i||(V=0),""===(C=t.___expandNumber(e,V,n.numberGroupSizes,",",".",n.negativeSign,!0)))return(r?r.join(""):"")+(i?i.join(""):"");if(w=!1,r){(b=(x=C.split(".")[0]).substr(0,1))===n.negativeSign&&(x=x.substr(1));var B=0,z="",G=a.indexOf("0"),W=-1===G?x.length:a.length-G;for(l=r.length-1;l>=0;l--)if(u=r[l],/^(0|#)+/g.test(u))if((z=u+z)!==a){for(T=u.length,A=x.length-B-1;A>=0&&T>0;A--)I=x.charAt(A),L._insert(I),T--,B++;B>=x.length&&B<W&&T>0&&(L._insert(new Array(T+1).join("0")),B+=T)}else D=x.substr(0,x.length-B),G>=0&&G<a.length-B-D.length&&(D=new Array(a.length-B-G-D.length+1).join("0")+D),L._insert(D);else o.exponent&&!w&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(u)?(w=!0,p="",p+=o.exponent.symbol,p+=t.___signs[o.exponent.sign],p+=t.___zeroPad(d.toString(),o.exponent.exp,!0),L._insert(p)):L._insert(u);b===n.negativeSign&&L._insert(b),!0===o.group&&(F=t.__insertGroupSeparator(L.toString(),n.numberGroupSizes,n.numberGroupSeparator,n.negativeSign),L=new R(F))}if(i)for(M="",V>0?-1!==(E=C.indexOf("."))&&(M=C.substring(E+1),""===a&&L.append(C.substr(0,E)),L.append(n.numberDecimalSeparator)):/^(#+)$/gi.test(s)&&i.join("").length===s.length||(H<=0&&C.indexOf(".")<0&&a===t.GeneralNumberInt&&s===t.GeneralNumberDec||L.append("."),H>0&&(M=new Array(H+1).join("0"))),N=0,c=0;c<i.length;c++)h=i[c],/^(0|#)+/g.test(h)?(L.append(M.substr(N,h.length)),N+=h.length):o.exponent&&!w&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(h)?(w=!0,p="",p+=o.exponent.symbol,p+=t.___signs[o.exponent.sign],p+=t.___zeroPad(d.toString(),o.exponent.exp,!0),L.append(p)):L.append(h);return 0===(P=(O=L.toString()).indexOf("0."))&&(P+2==O.length&&0===f.decimal?O=O.replace("0.","."):P+2<O.length&&(/[0-9]+/g.test(O.charAt(P+2))||(O=O.replace("0.",".")))),O},t.__parseNumberNegativePattern=function(e,t,o){var n=t.negativeSign,r=t.positiveSign,i=new h(e);if((4===o||2===o)&&(n=" "+n,r=" "+r),4===o||3===o){if(i.endsWith(n))return["-",e.substr(0,e.length-n.length)];if(i.endsWith(r))return["+",e.substr(0,e.length-r.length)]}else if(2===o||1===o){if(i.startsWith(n))return["-",e.substr(n.length)];if(i.startsWith(r))return["+",e.substr(r.length)]}else{if(0!==o)throw new Error("");if(i.startsWith("(")&&i.endsWith(")"))return["-",e.substr(1,e.length-2)]}return["",e]},t.__parseNumber=function(e,o){var n,r,i,a,s,l,u,c,p,d,f;if((e=e!==_&&e!==m?new h(e).trim():"").match(/^[+-]?infinity$/i))return parseFloat(e);if(e.match(/^0x[a-f0-9]+$/i))return parseInt(e,10);var g=o.numberFormat,y=t.__parseNumberNegativePattern(e,g,g.numberNegativePattern),C=y[0],w=y[1];return""===C&&1!==g.numberNegativePattern&&(C=(y=t.__parseNumberNegativePattern(e,g,1))[0],w=y[1]),""===C&&(C="+"),w[0]===g.currencySymbol&&(w=w.substr(1)),(i=w.indexOf("e"))<0&&(i=w.indexOf("E")),i<0?(r=w,n=m):(r=w.substr(0,i),n=w.substr(i+1)),(l=r.indexOf("."))<0?(a=r,s=m):(a=r.substr(0,l),s=r.substr(l+1)),a=a.split(",").join(""),","!==(u=",".replace(/\u00A0/g," "))&&(a=a.split(u).join("")),c=C+a,s!==m&&(c+="."+s),c[c.length-1]===g.percentSymbol&&(c=c.substr(0,c.length-1),-1===(p=(c=new h(c).trimEnd()).indexOf("."))&&(p=c.length),(d=new R("")).append(c.substr(0,p-2)),d.append("."),d.append(c.substr(p-2,2)),d.append(c.substr(p+1)),c=d.toString()),n!==m&&(""===(f=t.__parseNumberNegativePattern(n,g,1))[0]&&(f[0]="+"),c+="e"+f[0]+f[1]),c.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?parseFloat(c):NaN},t.___toHexString=function(o,n,r){if(0!==v(w(o)-o))throw new Error(e.SR.Exp_BadFormatSpecifier);var i=o>=0?o.toString(16):(t.___maxInt32+o+1).toString(16);return i=n?i.toLowerCase():i.toUpperCase(),r!==_&&r!==m&&i.length<r?t.___zeroPad(i,r,!0):i},t.___toScientific=function(e,o,n,r,i,a,s){for(var l,u=0,c=e>=1||0===e;u<1e3&&(l=S(10,u),!(c&&e/l<10||!c&&e*l>=1));)u++;return e=c?v(e)/S(10,u):v(e)*S(10,u),t.___expandNumber(e,n,r,i,a,s)+(o+(c?"+":"-"))+t.___zeroPad(u.toString(),3,!0)},t.removeCultureSymbolInNum=function(e){if(e===_||e===m)return e;var t=e.toString();return(t=t.replace(new RegExp("[,]","g"),"")).replace(new RegExp("[.]","g"),".")},t.replaceCultureSymbolToNormal=function(t,o){if("string"!=typeof t)return t;var n=o?o.numberDecimalSeparator:e.CR.numberDecimalSeparator,r=o?o.numberGroupSeparator:e.CR.numberGroupSeparator;return"."!==n&&(t=t.replace(e.RegUtil.getReg("["+n+"]"),"#dot#")),","!==r&&(t=t.replace(e.RegUtil.getReg("["+r+"]"),"#group#")),"."!==n&&(t=t.replace(e.RegUtil.getReg("#dot#"),".")),","!==r&&(t=t.replace(e.RegUtil.getReg("#group#"),",")),t},t.replaceNormalToCultureSymble=function(t,o){if("string"!=typeof t)return t;var n=o?o.numberDecimalSeparator:e.CR.numberDecimalSeparator,r=o?o.numberGroupSeparator:e.CR.numberGroupSeparator;return"."!==n&&(t=t.replace(e.RegUtil.getReg("[.]"),"#dot#")),","!==r&&(t=t.replace(e.RegUtil.getReg("[,]"),"#group#")),"."!==n&&(t=t.replace(e.RegUtil.getReg("#dot#"),n)),","!==r&&(t=t.replace(e.RegUtil.getReg("#group#"),r)),t},t.round10=function(e,t){return typeof t===_||0==+t?Math.round(e):(e=+e,t=+t,isNaN(e)||"number"!=typeof t||t%1!=0?NaN:(e=e.toString().split("e"),+((e=(e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]+t:t))))},t.GeneralNumberInt="##################0",t.GeneralNumberDec="################",t.___signs={1:"+",0:"","-1":"-"},t.___maxInt32=4294967295,t.___percentPositivePattern=["n %","n%","%n","% n"],t.___percentNegativePattern=["-n %","-n%","-%n","%-n","%n-","n-%","n%-","-% n","n %-","% n-","% -n","n- %"],t.___numberNegativePattern=["(n)","-n","- n","n-","n -"],t.___currencyPositivePattern=["$n","n$","$ n","n $"],t.___currencyNegativePattern=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],t}();e._NumberHelper=A,e._currentCulture="",e._currentCultureResouce,e.Culture=r,e.switchCulture=function(t){var o,n,r=t.toLowerCase();if(e._currentCulture!==r){switch(e._currentCultureResouce=i(r),e.CR=e._currentCultureResouce,r){case"ja-jp":(o=e._JAStringResource)&&(e.SR=o),c.currentCulture("ja-jp");break;case"en-us":e.SR=e._ENStringResource,c.currentCulture("en-us");break;case"zh-cn":(n=e._ZHStringResource)&&(e.SR=n),c.currentCulture("zh-cn");break;default:e.SR=e._ENStringResource,c.currentCulture(r)}e._currentCulture=r}},r("en-us"),e.addCultureInfo=function(t,o){var n=o.numberDecimalSeparator,r=o.arrayGroupSeparator,i=o.arrayListSeparator;if(n===o.listSeparator||n===i||i===r)throw e.SR.Exp_Separator;e.cultureInfoDict[t.toLowerCase()]=o},e.getCultureInfo=function(t){var o=i(t),n=new e.CultureInfo;return e.GC$.extend(n,o),n},e.getCultureInfoCore=i,f=function(){function e(){}return e._getCtx=function(){if(!e._ctx){var t=document.createElement("canvas");t.getContext&&(e._ctx=t.getContext("2d"))}return e._ctx},e._getWrapInfo=function(t,o,n){var r,i,a,s,l,u,c,h,p,d=[];if(0===t.length||!(r=e._getCtx()))return d;if(r.font=n,o<=0){for(i=-1,a=!0,s=0;s<t.length;s++)" "===(l=t.charAt(s))||a?" "!==l&&a&&(i=r.measureText(l).width,a=!1):i=y(i,r.measureText(l).width);o=i}for(u=t.split(/\r\n|\r|\n/),c=0;c<u.length;c++)if(h=e._getWrapInfoByWord(u[c],o))if(0===h.length)d.push("");else for(p=0;p<h.length;p++)d.push(h[p]);return d},e._getTextWords=function(e){for(var t,o,n=[],r=0,i=0;i<e.length;i++)n[r]===_&&(n[r]=""),t=e.charAt(i),o="",i+1<e.length&&(o=e.charAt(i+1))," "===t&&" "!==o?(n[r]+=t,r++):n[r]+=t;return n},e._measureText=function(t,o){var n=e._getCtx();return n?(n.font!==o&&(n.font=o),n.measureText(t).width):0},e._measureTextWithoutEndSpaces=function(t,o){var n,r=e._getCtx();return r?(o&&(r.font=o),n=e._removeEndSpace(t),r.measureText(n).width):0},e._removeEndSpace=function(e){for(var t=e.length-1;" "===e.charAt(t);)t--;return t!==e.length-1&&(e=e.substring(0,t+1)),e},e._getWrapInfoByCharacter=function(t,o){var n,r,i,a,s,l=[],u=e._getCtx();if(!u)return l;var c=u.measureText(t).width,h=c/t.length,p=C(o/h);if(c>o)for(n=!1;;){if(r=t.substring(0,p),(i=u.measureText(r).width)==o||n&&i<o)return l.push(r),l.push(t.substring(r.length)),l;if(i>o){if(1===r.length)return a=t.substring(r.length),0!==e._measureTextWithoutEndSpaces(a)?(l.push(r),l.push(a)):l.push(t),l;p-=1,n=!0}else p+=s=(s=(o-i)/h)>=1?s:1}else t!=m&&t.length>0&&l.push(t);return l},e._getWrapInfoByWord=function(t,o){var n,r,i,a,s=[],l=e._getTextWords(t),u=e._getCtx();if(!u)return s;for(var c=u.measureText(t).width/t.length,h=parseInt(o/c+"",10),p=0,d=0,f=0,g=0,m=[],_=!1;g<l.length;){if(!1===_){if(n=l[g],m.push(n),(d+=n.length)<h){g++;continue}f=d,d=0}(r=e._measureTextWithoutEndSpaces(m.join("")))>o?(i=m.pop(),0===m.length?(a=e._getWrapInfoByCharacter(i,o),m.push(a[0]),2===a.length?l[g]=a[1]:g++,s[p++]=m.join(""),_=!1,m=[]):(_=!0,g--)):r<o&&!0===_||r===o?(_=!1,s[p++]=e._removeEndSpace(m.join("")),m=[],g++):r<o&&(g++,d=f)}return 0!==m.length&&(s[p]=e._removeEndSpace(m.join(""))),s},e}(),e._WordWrapHelper=f,g=function(){function t(){}return t.IsNumber=function(t,o){return t&&e.util.isType(t,"string")&&o&&(t=A.replaceCultureSymbolToNormal(t,o)),e.util.isType(t,"number")||e.util.isType(t,"DateTime")||e.util.isType(t,"TimeSpan")||t&&!e.util.isType(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(t.length>=2&&"0"===t[0]&&"x"===t[1])},t.ToDouble=function(t){return t===m||t===_||""===t?0:e.util.isType(t,"number")?t:e.util.isType(t,"string")&&!isNaN(t)?A.parseLocale(t):e.util.isType(t,"boolean")?t?1:0:e.util.isType(t,"DateTime")?new d(t).toOADate():e.util.isType(t,"TimeSpan")?new d(t).TotalDays():parseFloat(t)},t.toString=function(e){try{return e===m||e===_?"":"boolean"==typeof e?e?"TRUE":"FALSE":"string"==typeof e?e:e.toString()}catch(e){return""}},t}(),e.FormatConverter=g}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){function t(t){var o;if(t instanceof c)return t;var n=0,r=0,i=0,a=0;return t&&""!==t&&((o=e.util.parseColorString(t))&&(3===o.length?(n=255,r=o[0],i=o[1],a=o[2]):4===o.length&&(n=o[0],r=o[1],i=o[2],a=o[3]))),new c(n,r,i,a)}var o,n,r,i;e.feature("core.theme",["core.common"]);var a=null,s=void 0,l=Math.min,u=Math.max,c=function(){function e(e,t,o,n){this.a=e,this.r=t,this.g=o,this.b=n}return e.prototype.toString=function(){var e=this;return 255===e.a?"#"+e.getColorUnitString(e.r)+e.getColorUnitString(e.g)+e.getColorUnitString(e.b):"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},e.prototype.getBrightness=function(){return(299*this.r+587*this.g+114*this.b)/1e3},e.prototype.getColorUnitString=function(e){var t=e.toString(16);return 1===t.length&&(t="0"+t),t},e.hueToRGB=function(e,t,o){return o<0&&(o+=240),o>240&&(o-=240),o<40?e+((t-e)*o+20)/40:o<120?t:o<160?e+((t-e)*(160-o)+20)/40:e},e.fromHLS=function(t,o,n){var r,i,a,s,l;return 0===n?r=i=a=parseInt(255*o/240,10):(s=2*o-(l=o<=120?(o*(240+n)+120)/240:o+n-(o*n+120)/240),r=parseInt((255*e.hueToRGB(s,l,t+80)+120)/240,10),i=parseInt((255*e.hueToRGB(s,l,t)+120)/240,10),a=parseInt((255*e.hueToRGB(s,l,t-80)+120)/240,10)),new e(255,r,i,a)},e.parse=function(e){return t(e)},e.isTwoColorSimilar=function(e,t){var o=255-Math.abs(e.r-t.r),n=255-Math.abs(e.g-t.g),r=255-Math.abs(e.b-t.b),i=Math.abs(e.a-t.a);return((o/=255)+(n/=255)+(r/=255))/3>=.9&&i<=.05},e.invertColor=function(t){var o=255^t.r,n=255^t.g,r=255^t.b;return new e(t.a,o,n,r).toString()},e}();e._Color=c,o=function(){function e(e){var t,o=this,n=e.r,r=e.g,i=e.b,a=u(u(n,r),i),s=l(l(n,r),i),c=a+s;if(o.luminosity=parseInt((240*c+255)/510,10),0===(t=a-s))o.saturation=0,o.hue=160;else{o.saturation=o.luminosity<=120?parseInt((240*t+c/2)/c,10):parseInt((240*t+(510-c)/2)/(510-c),10);var h=(40*(a-n)+t/2)/t,p=(40*(a-r)+t/2)/t,d=(40*(a-i)+t/2)/t;o.hue=n===a?parseInt(d-p,10):r===a?parseInt(80+h-d,10):parseInt(160+p-h,10),o.hue<0&&(o.hue+=240),o.hue>240&&(o.hue-=240)}}return e.prototype.toColor=function(){return c.fromHLS(this.hue,this.luminosity,this.saturation)},e.prototype.getLighterColor=function(e){var t=this,o=t.luminosity,n=t.newLuma(t.luminosity,500,!0);return c.fromHLS(t.hue,o+(n-o)*e,t.saturation)},e.prototype.getDrakerColor=function(e){var t=this.newLuma(this.luminosity,-333,!0);return c.fromHLS(this.hue,t*(1-e),this.saturation)},e.prototype.newLuma=function(e,t,o){return 0===t?e:o?t>0?(e*(1e3-t)+241*t)/1e3:e*(t+1e3)/1e3:((e+=240*t/1e3)<0&&(e=0),e>240&&(e=240),e)},e}(),e.HLSColor=o;var h=function(){function e(e,o,n,r,i,a,s,l,u,c,h,p,d){this._name=e,this._colorList=[t(r),t(i),t(o),t(n),t(a),t(s),t(l),t(u),t(c),t(h),t(p),t(d)]}return e.prototype.name=function(e){return 0===arguments.length?this._name:(this._name=e,this)},e.prototype.background1=function(e){return this._property(0,0===arguments.length,e)},e.prototype.background2=function(e){return this._property(1,0===arguments.length,e)},e.prototype.textColor1=function(e){return this._property(2,0===arguments.length,e)},e.prototype.textColor2=function(e){return this._property(3,0===arguments.length,e)},e.prototype.accent1=function(e){return this._property(4,0===arguments.length,e)},e.prototype.accent2=function(e){return this._property(5,0===arguments.length,e)},e.prototype.accent3=function(e){return this._property(6,0===arguments.length,e)},e.prototype.accent4=function(e){return this._property(7,0===arguments.length,e)},e.prototype.accent5=function(e){return this._property(8,0===arguments.length,e)},e.prototype.accent6=function(e){return this._property(9,0===arguments.length,e)},e.prototype.hyperline=function(e){return this._property(10,0===arguments.length,e)},e.prototype.followedHyperline=function(e){return this._property(11,0===arguments.length,e)},e.prototype._property=function(e,o,n){return o?this._colorList[e]:(this._colorList[e]=t(n),this)},e.prototype.getColor=function(e){var t,n,r,i,a;if(e&&(t=e.split(" "))){if(n=-1,(r=t.length)>1){if(!t[0])return e;"background"===(i=t[0].toLowerCase())?n=parseInt(t[1],10)-1:"text"===i?n=parseInt(t[1],10)+1:"accent"===i&&(n=parseInt(t[1],10)+3)}else 1===r&&("hyperlink"===(i=t[0].toLowerCase())?n=10:"followedhyperlink"===i&&(n=11));if(n>=0&&n<=11)return r>2?(a=parseInt(t[2],10)/100,function(e,t){if(0===t)return e;var n=new o(e),r=parseInt(t>0?(240-n.luminosity)*t:n.luminosity*t,10);return c.fromHLS(n.hue,n.luminosity+r,n.saturation)}(this._colorList[n],a).toString()):this._colorList[n].toString()}return e},e.prototype.toJSON=function(){var e=this._colorList;return{name:this._name,background1:e[0],background2:e[1],text1:e[2],text2:e[3],accent1:e[4],accent2:e[5],accent3:e[6],accent4:e[7],accent5:e[8],accent6:e[9],hyperlink:e[10],followedHyperlink:e[11]}},e.prototype.fromJSON=function(e,t){var o,n,r;if(e)if(o=this,t){if((n=e.name?e.name:e._name)!==s&&n!==a&&(o._name=n),(r=e.colorList?e.colorList:e._colorList)!==s&&r!==a){var i=r[0],l=r[1],u=r[2],h=r[3],p=r[4],d=r[5],f=r[6],g=r[7],m=r[8],_=r[9],y=r[10],C=r[11];i!==s&&i!==a&&(o._colorList[0]=new c(i.a,i.r,i.g,i.b)),l!==s&&l!==a&&(o._colorList[1]=new c(l.a,l.r,l.g,l.b)),u!==s&&u!==a&&(o._colorList[2]=new c(u.a,u.r,u.g,u.b)),h!==s&&h!==a&&(o._colorList[3]=new c(h.a,h.r,h.g,h.b)),p!==s&&p!==a&&(o._colorList[4]=new c(p.a,p.r,p.g,p.b)),d!==s&&d!==a&&(o._colorList[5]=new c(d.a,d.r,d.g,d.b)),f!==s&&f!==a&&(o._colorList[6]=new c(f.a,f.r,f.g,f.b)),g!==s&&g!==a&&(o._colorList[7]=new c(g.a,g.r,g.g,g.b)),m!==s&&m!==a&&(o._colorList[8]=new c(m.a,m.r,m.g,m.b)),_!==s&&_!==a&&(o._colorList[9]=new c(_.a,_.r,_.g,_.b)),y!==s&&y!==a&&(o._colorList[10]=new c(y.a,y.r,y.g,y.b)),C!==s&&C!==a&&(o._colorList[11]=new c(C.a,C.r,C.g,C.b))}}else{e.name!==s&&e.name!==a&&(o._name=e.name);i=e.background1,l=e.background2,u=e.text1,h=e.text2,p=e.accent1,d=e.accent2,f=e.accent3,g=e.accent4,m=e.accent5,_=e.accent6,y=e.hyperlink,C=e.followedHyperlink;i!==s&&i!==a&&(o._colorList[0]=new c(i.a,i.r,i.g,i.b)),l!==s&&l!==a&&(o._colorList[1]=new c(l.a,l.r,l.g,l.b)),u!==s&&u!==a&&(o._colorList[2]=new c(u.a,u.r,u.g,u.b)),h!==s&&h!==a&&(o._colorList[3]=new c(h.a,h.r,h.g,h.b)),p!==s&&p!==a&&(o._colorList[4]=new c(p.a,p.r,p.g,p.b)),d!==s&&d!==a&&(o._colorList[5]=new c(d.a,d.r,d.g,d.b)),f!==s&&f!==a&&(o._colorList[6]=new c(f.a,f.r,f.g,f.b)),g!==s&&g!==a&&(o._colorList[7]=new c(g.a,g.r,g.g,g.b)),m!==s&&m!==a&&(o._colorList[8]=new c(m.a,m.r,m.g,m.b)),_!==s&&_!==a&&(o._colorList[9]=new c(_.a,_.r,_.g,_.b)),y!==s&&y!==a&&(o._colorList[10]=new c(y.a,y.r,y.g,y.b)),C!==s&&C!==a&&(o._colorList[11]=new c(C.a,C.r,C.g,C.b))}},e}();e.ThemeColor=h,n=function(){function e(){}return e.Default=new h("Default","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),e.Office2007=new h("Office2007","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),e.Office=new h("Office","#000000","#44546A","#FFFFFF","#E7E6E6","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),e.Apex=new h("Apex","#000000","#69676D","#FFFFFF","#C9C2D1","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),e.Aspect=new h("Aspect","#000000","#323232","#FFFFFF","#E3DED1","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),e.Concourse=new h("Concourse","#000000","#464646","#FFFFFF","#DEF5FA","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),e.Civic=new h("Civic","#000000","#646B86","#FFFFFF","#C5D1D7","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),e.Oriel=new h("Oriel","#000000","#575F6D","#FFFFFF","#FFF39D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),e.Origin=new h("Origin","#000000","#464653","#FFFFFF","#DDE9EC","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),e.Paper=new h("Paper","#000000","#444D26","#FFFFFF","#FEFAC9","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),e.Solstice=new h("Solstice","#000000","#4F271C","#FFFFFF","#E7DEC9","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),e.Technic=new h("Technic","#000000","#3B3B3B","#FFFFFF","#D4D2D0","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),e.Trek=new h("Trek","#000000","#4E3B30","#FFFFFF","#FBEEC9","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),e.Urban=new h("Urban","#000000","#424456","#FFFFFF","#DEDEDE","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),e.Verve=new h("Verve","#000000","#666666","#FFFFFF","#D2D2D2","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),e.Equity=new h("Equity","#000000","#696464","#FFFFFF","#E9E5DC","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),e.Flow=new h("Flow","#000000","#04617B","#FFFFFF","#DBF5F9","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),e.Foundry=new h("Foundry","#000000","#676A55","#FFFFFF","#EAEBDE","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),e.Median=new h("Median","#000000","#775F55","#FFFFFF","#EBDDC3","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),e.Metro=new h("Metro","#000000","#4E5B6F","#FFFFFF","#D6ECFF","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),e.Module=new h("Module","#000000","#5A6378","#FFFFFF","#D4D4D6","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),e.Opulent=new h("Opulent","#000000","#B13F9A","#FFFFFF","#F4E7ED","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),e}(),e.ThemeColors=n,r=function(){function e(e,t,o,n){this._name=e,this._themeColor=t||new h(e),this._headingFont=o,this._bodyFont=n}return e.prototype.name=function(e){return 0===arguments.length?this._name:(this._name=e,this)},e.prototype.colors=function(e){return 0===arguments.length?this._themeColor:(this._themeColor=e,this)},e.prototype.headerFont=function(e){return 0===arguments.length?this._headingFont:(this._headingFont=e,this)},e.prototype.bodyFont=function(e){return 0===arguments.length?this._bodyFont:(this._bodyFont=e,this)},e.prototype.getColor=function(e){return this._themeColor.getColor(e)},e.prototype.getFont=function(e){return"Body"===e?this.bodyFont():"Headings"===e?this.headerFont():e},e.prototype.toJSON=function(){var e=this,t=e._name;return i[t]?t:{name:t,themeColor:e._themeColor?e._themeColor.toJSON():void 0,headingFont:e._headingFont,bodyFont:e._bodyFont}},e}(),e.SpreadTheme=r,i=function(){function e(){}return e.Default=new r("Default",n.Default,"Cambria","Calibri"),e.Office=new r("Office",n.Office,"Calibri Light","Calibri"),e.Office2007=new r("Office2007",n.Office2007,"Cambria","Calibri"),e.Apex=new r("Apex",n.Apex,"Lucida Sans","Book Antiqua"),e.Aspect=new r("Aspect",n.Aspect,"Verdana","Verdana"),e.Concourse=new r("Concourse",n.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),e.Civic=new r("Civic",n.Civic,"Georgia","Georgia"),e.Oriel=new r("Oriel",n.Oriel,"Century Schoolbook","Century Schoolbook"),e.Origin=new r("Origin",n.Origin,"Bookman Old Style","Gill Sans MT"),e.Paper=new r("Paper",n.Paper,"Constantia","Constantia"),e.Solstice=new r("Solstice",n.Solstice,"Gill Sans MT","Gill Sans MT"),e.Technic=new r("Technic",n.Technic,"Franklin Gothic Book","Arial"),e.Trek=new r("Trek",n.Trek,"Franklin Gothic Medium","Franklin Gothic Book"),e.Urban=new r("Urban",n.Urban,"Trebuchet MS","Georgia"),e.Verve=new r("Verve",n.Verve,"Century Gothic","Century Gothic"),e.Equity=new r("Equity",n.Equity,"Franklin Gothic Book","Perpetua"),e.Flow=new r("Flow",n.Flow,"Calibri","Constantia"),e.Foundry=new r("Foundry",n.Foundry,"Rockwell","Rockwell"),e.Median=new r("Median",n.Median,"Tw Cen MT","Tw Cen MT"),e.Metro=new r("Metro",n.Metro,"Consolas","Corbel"),e.Module=new r("Module",n.Module,"Corbel","Corbel"),e.Opulent=new r("Opulent",n.Opulent,"Trebuchet MS","Trebuchet MS"),e}(),e.SpreadThemes=i}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){var o,n,r;t.feature("core.spreadpanelex",["core.common"]);var i,a,s,l=null,u="undefined",c="scroll-arrow",h="scrollbar-wrapper",p="no-user-select",d="width",f="height",g="left",m="top",_=".gcScrollbar",y="mousedown"+_,C="mouseup"+_,w="mousemove"+_,v="mouseover"+_,S="mousewheel",x="DOMMouseScroll",R="mouseout"+_,b="scroll"+_,T=function(e,t,o){e.addEventListener&&e.addEventListener(t,o,!1)},A=function(e,t,o){e.removeEventListener&&e.removeEventListener(t,o,!1)};(i=t.ScrollType||(t.ScrollType={}))[i.pixels=0]="pixels",i[i.continuous=1]="continuous",o=t.ScrollType,(a=t.ScrollOrientation||(t.ScrollOrientation={}))[a.horizontalScroll=0]="horizontalScroll",a[a.verticalScroll=1]="verticalScroll",t.ScrollOrientation,(s=t.ScrollEventType||(t.ScrollEventType={}))[s.smallDecrement=0]="smallDecrement",s[s.smallIncrement=1]="smallIncrement",s[s.largeDecrement=2]="largeDecrement",s[s.largeIncrement=3]="largeIncrement",s[s.thumbPosition=4]="thumbPosition",s[s.thumbTrack=5]="thumbTrack",s[s.endScroll=6]="endScroll",t.ScrollEventType,n=function(){function e(e,t){var o=this;o._showHorizontalScrollbar=!0,o._showVerticalScrollbar=!0,o._hSmallChange=10,o._vSmallChange=10,o._defaultScrollbarSize=18,o._superPanel=e,o._content=t,o.refreshLayout(!0)}return e.prototype.content=function(e){var t=this;return 0===arguments.length?t._content:(e instanceof HTMLElement&&t._content!==e&&(t._content=e,t.refreshLayout(!0)),t)},e.prototype.superPanel=function(e){var t=this;return 0===arguments.length?t._superPanel:(e instanceof HTMLElement&&t._superPanel!==e&&(t._superPanel=e,t.refreshLayout(!0)),t)},e.prototype.horizontalSmallChange=function(e){return 0===arguments.length?this._hSmallChange:("number"==typeof e&&this._hSmallChange!==e&&(this._hSmallChange=e),this)},e.prototype.verticalSmallChange=function(e){return 0===arguments.length?this._vSmallChange:("number"==typeof e&&this._vSmallChange!==e&&(this._vSmallChange=e),this)},e.prototype.showHorizontalScrollbar=function(){return this._showHorizontalScrollbar},e.prototype.showVerticalScrollbar=function(){return this._showVerticalScrollbar},e.prototype.refreshLayout=function(e){var o,n,i,a,s,l,u,c,h,p,d,f=this;if(f._superPanel&&f._content){var g=t.GC$(f._superPanel),m=t.GC$(f._content),_=f._defaultScrollbarSize,y=m.width(),C=m.height(),w=g.width(),v=g.height(),S=w-_,x=v-_,R=!1;f._container||(f._container=document.createElement("div"),t.GC$(f._container).css({position:"relative",left:0,top:0,overflow:"hidden",border:"none",padding:0,margin:0}),R=!0),(o=t.GC$(f._container)).css({width:w,height:v}),f._contentWrapper||(f._contentWrapper=document.createElement("div"),t.GC$(f._contentWrapper).css({position:"absolute",left:0,top:0,display:"inline-block",overflow:"hidden",border:"none",padding:0,margin:0}),o.append(f._contentWrapper)),n=t.GC$(f._contentWrapper),f._tempContentWrapper||(f._tempContentWrapper=document.createElement("div"),t.GC$(f._tempContentWrapper).css({position:"relative"}),n.append(f._tempContentWrapper)),i=t.GC$(f._tempContentWrapper),e&&i.append(f._content).css({top:0,left:0}),t.util.browser.chrome&&(y=Math.round(y),C=Math.round(C),w=Math.ceil(w),v=Math.ceil(v));var T=f._isNeedScrollbars(y,C,w,v),A=T.isNeedVScroll,I=T.isNeedHScroll;I?(A||(S+=_),f._hScrollbar||(f._hScrollbar=new r(!0),a=f._hScrollbar.getScrollbar(),f._hbarContainer=document.createElement("div"),(s=t.GC$(f._hbarContainer)).css({position:"absolute",left:0,bottom:0,border:"none",padding:0,margin:0}),s.append(a),o.append(f._hbarContainer)),t.GC$(f._hbarContainer).css({width:S,height:_}),l=f._hScrollbar,u=t.GC$(f._hScrollbar.getScrollbar()),l.width(S),l.height(_),l.minimum(0),l.maximum(y-S),l.pageValue(S),l.smallChange(f.horizontalSmallChange()),l.largeChange(S),l.refreshLayout(),u.bind(b,function(e,t){i.css("left",0-t.newValue)}),t.GC$(f._hbarContainer).show(),f._showHorizontalScrollbar=!0):(f._hbarContainer&&t.GC$(f._hbarContainer).hide(),f._showHorizontalScrollbar=!1),A?(I||(x+=_),f._vScrollbar||(f._vScrollbar=new r(!1),c=f._vScrollbar.getScrollbar(),f._vbarContainer=document.createElement("div"),(h=t.GC$(f._vbarContainer)).css({position:"absolute",right:0,top:0,border:"none",padding:0,margin:0}),h.append(c),o.append(f._vbarContainer)),t.GC$(f._vbarContainer).css({width:_,height:x}),p=f._vScrollbar,d=t.GC$(f._vScrollbar.getScrollbar()),p.width(_),p.height(x),p.minimum(0),p.maximum(C-x),p.pageValue(x),p.smallChange(f.verticalSmallChange()),p.largeChange(x),p.refreshLayout(),d.bind(b,function(e,t){i.css("top",0-t.newValue)}),t.GC$(f._vbarContainer).show(),f._showVerticalScrollbar=!0):(f._vbarContainer&&t.GC$(f._vbarContainer).hide(),f._showVerticalScrollbar=!1),I||A||(S+=_,x+=_),f._pageWidth=S,f._pageHeight=x,n.css({width:S,height:x}),R&&(g.append(f._container),f._initEvent())}},e.prototype.scrollChildIntoView=function(e){var t=this,o=t._getScrollOffset(e),n=o.left,r=o.top;n!==l&&t._hScrollbar&&t.hScrollTo(n),r!==l&&t._vScrollbar&&t.vScrollTo(r)},e.prototype.hScrollTo=function(e){var o,n;this._hScrollbar.value(e),o=this._pageWidth,n=t.GC$(this._content).width(),e>=0&&e<=n-o&&t.GC$(this._tempContentWrapper).css(g,0-e)},e.prototype.vScrollTo=function(e){var o,n;this._vScrollbar.value(e),o=this._pageHeight,n=t.GC$(this._content).height(),e>=0&&e<=n-o&&t.GC$(this._tempContentWrapper).css(m,0-e)},e.prototype._isNeedScrollbars=function(e,t,o,n){var r=this._defaultScrollbarSize,i=o-r,a=n-r,s={isNeedHScroll:!1,isNeedVScroll:!1};return e>o&&(s.isNeedHScroll=!0,s.isNeedVScroll=t>a),t>n&&(s.isNeedVScroll=!0,s.isNeedHScroll=e>i),s},e.prototype._getScrollOffset=function(e){var o,n,r,i,a,s,u,c=t.GC$(e),h=t.GC$(this._contentWrapper),p=t.GC$(this._tempContentWrapper),d={left:l,top:l};return e?(o=c.offset(),n=p.offset(),r=h.offset(),o.leftWidth=o.left+c.outerWidth(),o.topHeight=o.top+c.outerHeight(),r.leftWidth=r.left+h.outerWidth(),r.topHeight=r.top+h.outerHeight(),i=o.left-n.left,o.left<r.left?d.left=i:o.leftWidth>r.leftWidth&&(a=o.leftWidth-n.left-h.innerWidth(),d.left=i<a?i:a),s=o.top-n.top,o.top<r.top?d.top=s:o.topHeight>r.topHeight&&(u=o.topHeight-n.top-h.innerHeight(),d.top=s<u?s:u),d):d},e.prototype._initEvent=function(){var e=this;this._tempContentWrapper&&(e._mousewheelHandler=function(t){e._contentContainerMousewheel(t)},T(e._tempContentWrapper,S,e._mousewheelHandler),T(e._tempContentWrapper,x,e._mousewheelHandler))},e.prototype._contentContainerMousewheel=function(e){var o,n=this;(typeof e.wheelDelta===u||e.wheelDelta===l)&&(typeof e.detail===u||e.detail===l)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail);var r=e.detail?e.detail:e.wheelDelta/-40,i=n._vScrollbar,a=parseInt(t.GC$(n._tempContentWrapper).css(m)),s=n._pageHeight,c=t.GC$(n._content).height();c<s&&(c=s),isNaN(a)&&(a=0),(o=a-r*n.verticalSmallChange())>=0&&(o=0),o<0&&0-o>c-s&&(o=0-(c-s)),o!==a&&(t.GC$(n._tempContentWrapper).css(m,o),n._showVerticalScrollbar&&i.value(0-o)),t.util.cancelDefault(e)},e.prototype.dispose=function(){var e=this;e._container&&(e._hScrollbar&&e._hScrollbar.dispose(),e._vScrollbar&&e._vScrollbar.dispose(),e._tempContentWrapper&&e._mousewheelHandler&&(A(e._tempContentWrapper,S,e._mousewheelHandler),A(e._tempContentWrapper,x,e._mousewheelHandler)),t.GC$(e._container).remove())},e}(),t.ScrollablePanel=n,r=function(){function n(e,t,o,n,r,i,a){var s=this;s._pageValue=10,s._maximum=100,s._minimum=0,s._value=0,s._largeChange=10,s._smallChange=1,s._scrollType=1,s._scrollPosition=0,s._isMousedownInScrollbar=!1,s._isMousedownInArrowButton=!1,s._scrollTimeOutArrow=l,s._scrollTimeOutContainer=l,s._initialDelay=300,s._trackClickPepeatFreq=70,s._isHorizontalScroll=e,s._width="number"==typeof t?t:0,s._height="number"==typeof o?o:0,s._pageValue="number"==typeof n?n:0,s._maximum="number"==typeof r?r:0,s._minimum="number"==typeof i?i:0,s._scrollType="number"==typeof a?a:1,s._isMouseCapture=!1,s._scrollPosition=0,s._value=s._minimum,s.refreshLayout()}return n.prototype.getScrollbar=function(){return this._scrollContainerDiv},n.prototype.smallChange=function(e){return 0===arguments.length?this._smallChange:("number"==typeof e&&this._smallChange!==e&&(this._smallChange=e),this)},n.prototype.largeChange=function(e){return 0===arguments.length?this._largeChange:("number"==typeof e&&this._largeChange!==e&&(this._largeChange=e),this)},n.prototype.pageValue=function(e){return 0===arguments.length?this._pageValue:("number"==typeof e&&this._pageValue!==e&&(e<=0&&(e=1),this._pageValue=e),this)},n.prototype.maximum=function(e){return 0===arguments.length?this._maximum:("number"==typeof e&&this._maximum!==e&&(e<=0&&(e=0),this._maximum=e),this)},n.prototype.minimum=function(e){return 0===arguments.length?this._minimum:("number"==typeof e&&this._minimum!==e&&(e<=0&&(e=0),this._minimum=e),this)},n.prototype.value=function(e){var t,o=this;return 0===arguments.length?o._value:("number"==typeof e&&e<=o._maximum&&e>=o._minimum&&(o._value=e,t=(e-o._minimum)*o._scrollUnit,o.scrollTo(t,!0)),o)},n.prototype.width=function(e){return 0===arguments.length?this._width:("number"==typeof e&&this._width!==e&&(this._width=e),this)},n.prototype.height=function(e){return 0===arguments.length?this._height:("number"==typeof e&&this._height!==e&&(this._height=e),this)},n.prototype.scrollType=function(e){return 0===arguments.length?this._scrollType:(typeof o[e]!==u&&this._scrollType!==e&&(this._scrollType=e),this)},n.prototype.refreshLayout=function(){var e,o,n,r,i,a=this,s=a._height,l=a._width,u=s,_=l-2*s,y=u,C=g,w="right",v=0,S=0,x=!1,R="scroll-arrowLeft",b="scroll-arrowRight",T="scrollbar-horizontal",A="margin-left",I="ui-state-default ui-corner-bl btn btn-default",D="ui-icon ui-icon-triangle-1-w",F="scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",M="ui-icon ui-icon-grip-solid-vertical",E="ui-state-default ui-corner-br btn btn-default",N="ui-icon ui-icon-triangle-1-e";a._isHorizontalScroll?a._scrollSize=_:(_=u=l,y=s-2*l,C=m,w="bottom",a._scrollSize=y,R="scroll-arrowUp",b="scroll-arrowDown",T="scrollbar-vertical",A="margin-top",I="ui-state-default ui-corner-tr btn btn-default",D="ui-icon ui-icon-triangle-1-n",F="scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",M="ui-icon ui-icon-grip-solid-horizontal",E="ui-state-default ui-corner-br btn btn-default",N="ui-icon ui-icon-triangle-1-s"),e=a._scrollSize,o=a._maximum-a._minimum,a._scrollbarSize=a._pageValue*e/(o+a._pageValue),a._scrollbarSize>e&&(a._scrollbarSize=e),a._scrollbarSize<10&&(a._scrollbarSize=10),n=a._scrollbarSize,a._scrollUnit=0!==o?(e-n)/o:1,a._isHorizontalScroll?(v=n,S=u):(v=u,S=n),a._scrollContainerDiv||(x=!0,a._scrollContainerDiv=document.createElement("div"),t.GC$(a._scrollContainerDiv).css({position:"relative",left:0,top:0,overflow:"hidden",outline:"none",border:"none",padding:0,margin:0}).addClass("scroll-container scroll-corner-all ui-widget ui-corner-all")),(r=t.GC$(a._scrollContainerDiv)).css(d,l).css(f,s),a._arrowStartDiv||(a._arrowStartDiv=document.createElement("div"),t.GC$(a._arrowStartDiv).css({position:"absolute",display:"inline-block",borderWidth:"1px",padding:0,margin:0,boxSizing:"content-box"}).addClass(c+" "+I),a._arrowStartSpan=document.createElement("span"),t.GC$(a._arrowStartSpan).css({display:"block",border:"none",padding:0,margin:0}),t.GC$(a._arrowStartSpan).addClass(R+" "+D),t.GC$(a._arrowStartDiv).append(a._arrowStartSpan),r.append(a._arrowStartDiv)),t.GC$(a._arrowStartDiv).css(C,0).css(d,u-2).css(f,u-2),t.GC$(a._arrowStartSpan).css({width:"100%",height:"100%"}),a._scrollbarWrapperDiv||(a._scrollbarWrapperDiv=document.createElement("div"),t.GC$(a._scrollbarWrapperDiv).css({position:"absolute",display:"inline-block",boxSizing:"content-box",border:"none",padding:0,margin:0}).addClass(h+" "+h),r.append(a._scrollbarWrapperDiv)),(i=t.GC$(a._scrollbarWrapperDiv)).css(C,u).css(d,_).css(f,y),a._scrollbarDiv||(a._scrollbarDiv=document.createElement("div"),t.GC$(a._scrollbarDiv).css({position:"absolute",borderWidth:"1px",padding:0,margin:0,boxSizing:"content-box"}).attr("unselectable","on").addClass("scroll-bar "+p+" "+F),a._scrollbarSpan=document.createElement("span"),t.GC$(a._scrollbarSpan).css({display:"block",border:"none",padding:0,margin:0}),t.GC$(a._scrollbarSpan).addClass(T+" "+M),t.GC$(a._scrollbarDiv).append(a._scrollbarSpan),i.append(a._scrollbarDiv)),t.GC$(a._scrollbarDiv).css(C,a._scrollPosition).css(d,Math.round(v-2)).css(f,Math.round(S-2)),t.GC$(a._scrollbarSpan).css({width:u-2,height:u-2}),t.GC$(a._scrollbarSpan).css(A,Math.floor((a._scrollbarSize-u)/2)),a._arrowEndDiv||(a._arrowEndDiv=document.createElement("div"),t.GC$(a._arrowEndDiv).css({position:"absolute",display:"inline-block",borderWidth:"1px",padding:0,margin:0,boxSizing:"content-box"}).addClass(c+" "+E),a._arrowEndSpan=document.createElement("span"),t.GC$(a._arrowEndSpan).css({display:"block",border:"none",padding:0,margin:0}),t.GC$(a._arrowEndSpan).addClass(b+" "+N),t.GC$(a._arrowEndDiv).append(a._arrowEndSpan),r.append(a._arrowEndDiv)),t.GC$(a._arrowEndDiv).css(w,0).css(d,u-2).css(f,u-2),t.GC$(a._arrowEndSpan).css({width:"100%",height:"100%"}),x&&a._initEvents()},n.prototype._initEvents=function(){var o=this;t.GC$(o._arrowStartDiv).bind(y,function(e){o._arrowMousedown(e,!0)}).bind(C,function(e){o._arrowMouseup(e,!0)}).bind(v,function(e){o._arrowMouseover(e,!0)}).bind(R,function(e){o._arrowMouseout(e,!0)}),t.GC$(o._arrowEndDiv).bind(y,function(e){o._arrowMousedown(e,!1)}).bind(C,function(e){o._arrowMouseup(e,!1)}).bind(v,function(e){o._arrowMouseover(e,!1)}).bind(R,function(e){o._arrowMouseout(e,!1)}),t.GC$(o._scrollbarDiv).bind(y,function(e){o._scrollbarMousedown(e)}).bind(w,function(e){o._scrollbarMousemove(e)}).bind(C,function(e){o._scrollbarMouseup(e)}).bind(v,function(e){o._scrollbarMouseover(e)}).bind(R,function(e){o._scrollbarMouseout(e)}),t.GC$(o._scrollbarWrapperDiv).bind(y,function(e){var n,r;t.util.browser&&t.util.browser.mozilla&&(n=(new Date).valueOf(),r=o._lastMouseDownTime,o._lastMouseDownTime=n,r&&n-r<100)||o._scrollbarContainerMousedown(e)}).bind(C,function(e){o._scrollbarContainerMouseup(e)}),o._mousewheelHandler=function(e){o._scrollContainerMousewheel(e)},T(o._scrollContainerDiv,S,o._mousewheelHandler),T(o._scrollContainerDiv,x,o._mousewheelHandler),t.features.touch&&(o._simulateMouseEvents=new e.Sheets._SimulateMouseEvents,o._simulateMouseEvents.bindUnBindTouchEvents(o._scrollContainerDiv,!0,_))},n.prototype.dispose=function(){var e=this,o=e._scrollContainerDiv;e._arrowEndDiv&&t.GC$(e._arrowEndDiv).unbind(_),e._scrollbarDiv&&t.GC$(e._scrollbarDiv).unbind(_),e._arrowStartDiv&&t.GC$(e._arrowStartDiv).unbind(_),e._scrollbarWrapperDiv&&t.GC$(e._scrollbarWrapperDiv).unbind(_),o&&(e._mousewheelHandler&&(A(o,S,e._mousewheelHandler),A(o,x,e._mousewheelHandler)),e._simulateMouseEvents&&e._simulateMouseEvents.bindUnBindTouchEvents(e._scrollContainerDiv,!1,_),t.GC$(o).unbind(_).remove())},n.prototype._handleDocumentMouseMove=function(){var e=this;e._isMouseCapture||(t.GC$(document).bind(w,function(t){e._scrollbarMousemove(t)}).bind(C,function(t){e._scrollbarMouseup(t)}),e._isMouseCapture=!0)},n.prototype._unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,t.GC$(document).unbind(w).unbind(C))},n.prototype._arrowMousedown=function(e,o){var n,r=0,i=this,a=!0;i._isMousedownInArrowButton=!0,null===i._scrollTimeOutArrow&&(o?(t.GC$(i._arrowStartDiv).addClass("scrollbar-stateActive ui-state-active"),r=0-i._smallChange,i._scrollEventType=0):(t.GC$(i._arrowEndDiv).addClass("scrollbar-stateActive ui-state-active"),r=i._smallChange,i._scrollEventType=1),(n=function(){i.scrollTo(i._scrollPosition+r*i._scrollUnit,!1),1===i._scrollType&&(i._scrollTimeOutArrow=setTimeout(n,a?i._initialDelay:i._trackClickPepeatFreq)),a=!1})(),t.util.preventDefault(e))},n.prototype._arrowMouseup=function(e,o){var n=t.GC$(this._arrowStartDiv);o||(n=t.GC$(this._arrowEndDiv)),n.removeClass("scrollbar-stateActive ui-state-active"),this._endArrowScroll(),t.util.preventDefault(e)},n.prototype._arrowMouseover=function(e,o){var n=t.GC$(this._arrowStartDiv);o||(n=t.GC$(this._arrowEndDiv)),n.addClass("scroll-arrow-hover ui-state-hover"),t.util.preventDefault(e)},n.prototype._arrowMouseout=function(e,o){var n=t.GC$(this._arrowStartDiv);o||(n=t.GC$(this._arrowEndDiv)),n.removeClass("scroll-arrow-hover scrollbar-stateActive ui-state-hover ui-state-active"),this._endArrowScroll(),t.util.preventDefault(e)},n.prototype._scrollbarMousedown=function(e){var o=this;if(0===e.button){o._isMousedownInScrollbar=!0,o._oldPosition={x:e.pageX,y:e.pageY},o._handleDocumentMouseMove(),t.GC$(o._scrollbarDiv).addClass("scrollbar-stateActive ui-state-active");var n=t.GC$(o._scrollbarDiv).offset(),r=t.GC$(o._scrollbarDiv).outerWidth(!0),i=t.GC$(o._scrollbarDiv).outerHeight(!0),a=t.GC$(o._scrollbarWrapperDiv).offset(),s=t.GC$(o._scrollbarWrapperDiv).outerWidth(!0),l=t.GC$(o._scrollbarWrapperDiv).outerHeight(!0);o._edgePosition={isBeyondEdge:!1,startEdgePosition:{x:a.left+e.pageX-n.left,y:a.top+e.pageY-n.top},endEdgePosition:{x:a.left+s-(r-e.pageX+n.left),y:a.top+l-(i-e.pageY+n.top)}}}t.util.preventDefault(e)},n.prototype._scrollbarMousemove=function(e){var o=this;o._isMousedownInScrollbar&&(o._currentPosition={x:e.pageX,y:e.pageY},o._scrollbarDrag(),o._oldPosition=o._currentPosition,t.GC$(document.body).attr("unselectable","on").addClass(p)),t.util.preventDefault(e)},n.prototype._scrollbarMouseup=function(e){var o,n=this;n._isMousedownInScrollbar=!1,n._scrollEventType=4,n._edgePosition=null,o={newValue:n._value,oldValue:n._value,scrollOrientation:n._isHorizontalScroll?0:1,scrollEventType:n._scrollEventType},t.GC$(n._scrollContainerDiv).trigger(b,o);var r=(n._value-n._minimum)*n._scrollUnit,i="left";n._isHorizontalScroll||(i="top"),n._scrollPosition=r,t.GC$(n._scrollbarDiv).css(i,r),n._unhandleDocumentMouseMove(),t.GC$(document.body).removeClass(p),t.GC$(document.body).attr("unselectable")&&t.GC$(document.body).removeAttr("unselectable"),t.GC$(n._scrollbarDiv).removeClass("scrollbar-stateActive ui-state-active"),n._scrollEventType=6,o={newValue:n._value,oldValue:n._value,scrollOrientation:n._isHorizontalScroll?0:1,scrollEventType:n._scrollEventType},t.GC$(n._scrollContainerDiv).trigger(b,o),t.util.preventDefault(e)},n.prototype._scrollbarMouseover=function(e){t.GC$(this._scrollbarDiv).addClass("scrollbar-stateHover ui-state-hover"),t.util.preventDefault(e)},n.prototype._scrollbarMouseout=function(e){t.GC$(this._scrollbarDiv).removeClass("scrollbar-stateHover ui-state-hover"),t.util.preventDefault(e)},n.prototype._scrollContainerMousewheel=function(e){var o,n,r=this;(typeof e.wheelDelta===u||e.wheelDelta===l)&&(typeof e.detail===u||e.detail===l)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),o=(e.detail?e.detail:e.wheelDelta/-40)/3*r._smallChange*r._scrollUnit,r._scrollEventType=o>=0?1:0,r.scrollTo(r._scrollPosition+o,!1),r._scrollEventType=6,n={newValue:r._value,oldValue:r._value,scrollOrientation:r._isHorizontalScroll?0:1,scrollEventType:r._scrollEventType},t.GC$(r._scrollContainerDiv).trigger(b,n),t.util.preventDefault(e)},n.prototype._scrollbarContainerMousedown=function(e){var o,n=this,r=!0,i=e.pageX,a=e.pageY,s=0,l=t.GC$(n._scrollbarWrapperDiv).offset(),u=n._largeChange;null===n._scrollTimeOutContainer&&(s=n._isHorizontalScroll?i-l.left-n._scrollPosition:a-l.top-n._scrollPosition,(o=function(){var e,l=t.GC$(n._scrollbarWrapperDiv).offset(),c=n._scrollPosition;if((e=n._isHorizontalScroll?i-l.left-c:a-l.top-c)*s<0||e>=0&&e<n._scrollbarSize)n._endContainerScroll();else{if(s<0)n._scrollEventType=2,n.scrollTo(c-u*n._scrollUnit,!1);else{if(!(s>0))return void n._endContainerScroll();n._scrollEventType=3,n.scrollTo(c+u*n._scrollUnit,!1)}1===n._scrollType&&(n._scrollTimeOutContainer=setTimeout(o,r?n._initialDelay:n._trackClickPepeatFreq)),r=!1}})(),t.util.preventDefault(e))},n.prototype._scrollbarContainerMouseup=function(e){this._endContainerScroll(),t.util.preventDefault(e)},n.prototype._endContainerScroll=function(){var e,o=this;o._scrollTimeOutContainer&&clearTimeout(o._scrollTimeOutContainer),o._scrollTimeOutContainer=l,o._scrollEventType=6,e={newValue:o._value,oldValue:o._value,scrollOrientation:o._isHorizontalScroll?0:1,scrollEventType:o._scrollEventType},t.GC$(o._scrollContainerDiv).trigger(b,e)},n.prototype._endArrowScroll=function(){var e,o=this;o._isMousedownInArrowButton&&(o._isMousedownInArrowButton=!1,o._scrollTimeOutArrow&&clearTimeout(o._scrollTimeOutArrow),o._scrollTimeOutArrow=l,o._scrollEventType=6,e={newValue:o._value,oldValue:o._value,scrollOrientation:o._isHorizontalScroll?0:1,scrollEventType:o._scrollEventType},t.GC$(o._scrollContainerDiv).trigger(b,e))},n.prototype._scrollbarDrag=function(){var e=this,t=0,o=e._scrollPosition,n=e._currentPosition,r=e._edgePosition;if(e._isHorizontalScroll){if(r&&r.isBeyondEdge){var i=r.startEdgePosition.x,a=r.endEdgePosition.x,s=n.x<i,l=n.x>a;if(s||l)return;e._oldPosition.x<i&&(e._oldPosition.x=i),e._oldPosition.x>a&&(e._oldPosition.x=a)}t=o+(n.x-e._oldPosition.x)}else{if(r&&r.isBeyondEdge){var u=r.startEdgePosition.y,c=r.endEdgePosition.y;s=n.y<u,l=n.y>c;if(s||l)return}e._oldPosition.y<u&&(e._oldPosition.y=u),e._oldPosition.y>c&&(e._oldPosition.y=c),t=o+(n.y-e._oldPosition.y)}t!==o&&(e._scrollEventType=5,e.scrollTo(t,!1))},n.prototype.scrollTo=function(e,o){var n,r,i=this,a=m,s=i._scrollSize-i._scrollbarSize;i._scrollPosition,t.ScrollOrientation;i._isHorizontalScroll&&(a=g),n=!1,e>s&&(e=s,n=!0),e<0&&(e=0,n=!0),i._edgePosition&&(i._edgePosition.isBeyondEdge=n);var l=Math.round(e/i._scrollUnit)+i._minimum,u=i._value,c=!1;o||(r={newValue:l,oldValue:u,scrollOrientation:i._isHorizontalScroll?0:1,scrollEventType:i._scrollEventType},t.GC$(i._scrollContainerDiv).trigger(b,r),c=r.ignoreUpdatePosition,r.newValue>i._maximum&&(r.newValue=i._maximum),l=r.newValue),i._value=l,5!==i._scrollEventType&&(e=(l-i._minimum)*i._scrollUnit),i._scrollPosition=e,c||t.GC$(i._scrollbarDiv).css(a,e)},n}(),t.Scrollbar=r}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){var o,n,r,i,a,s;t.feature("core.basecelltype",["core.common","core.globalize","core.theme"]);var l=window.document,u="position",c="absolute",h="font",p="left",d="right",f="top",g="alphabetic",m="center",_="gcUIElement",y="none",C=".gcEditingInput",w="width",v="height",S="padding",x="text-align",R="hidden",b="word-wrap",T="overflow",A="normal",I="break-word",D="overflow-y",F="background-color",M="ime-mode",E="undefined",N=void 0,O=null,P=Math.floor,L=Math.ceil,H=Math.min,k=Math.max,V=function(){function e(){}return e.getAutoFitWidth=function(o,n,r,i,a){var s,l,u,c=0,h=a&&a.sheet;if(h&&"string"==typeof n&&""!==n){if(r.wordWrap)for(0,(s=r.textIndent)>0&&8*s,l=n.split(/\r\n|\r|\n/),u=0;u<l.length;u++)c=k(c,t._WordWrapHelper._measureTextWithoutEndSpaces(l[u],r.font)/i);else c=h._getStringWidthByCanvas(n,r.font)/i;1!==r.hAlign&&r.textIndent>0&&(c+=8*r.textIndent/i),0===r.hAlign&&e.hasIconSet(h,a.row,a.col,a.sheetArea)&&(c+=16)}return c},e.getAutoFitHeight=function(e,o,n,r,i){var a,s,l,u,c=0,h=i&&i.sheet;if(h&&"string"==typeof o&&""!==o)if(a=h._getFontHeight(n.font)/r,n.wordWrap){s=0,(l=n.textIndent)>0&&(s=8*l);var p=i.row,d=i.col,f=i.sheetArea,g=0,m=h._getSpanModel(f).find(p,d);if(m){if(!(m.row<p||m.rowCount>1||m.col<d||d!=m.col||(g=h.getColumnWidth(d),!(m.colCount>1))))for(u=d+1;u<d+m.colCount;u++)g+=h.getColumnWidth(u)}else g=h.getColumnWidth(d);c=t._WordWrapHelper._getWrapInfo(o,g-3-s,n.font).length*a}else c=a;return c},e.paintBackground=function(t,o,n,r,i,a,s,l,u){(a||s)&&(t.save(),t.beginPath(),a&&(t.fillStyle!==a&&(t.fillStyle=a),t.fillRect(o,n,r,i)),e.paintBackgroundImage(t,o,n,r,i,s,l,u),t.restore())},e.paintBackgroundImage=function(e,t,o,n,r,i,a,s){if(i&&i!==y&&s)try{if(s.getState(i)){var l=s.getImage(i),u=l.width,c=l.height,h=u,p=c,d=n,f=r,g=t,m=o;switch(a){case 0:break;case 1:h=n>=u?u:n,p=r>=c?c:r,g=n>u&&u>0?L(t+n/2-u/2):t,m=r>c&&c>0?L(o+r/2-c/2):o,d=h,f=p;break;case 2:r>0&&c>0&&n/r>u/c?g=t+n/2-(d=u/c*r)/2:n>0&&u>0&&r/n>c/u&&(m=o+r/2-(f=c/u*n)/2);break;case 3:d=h=n>=u?u:n,f=p=r>=c?c:r}e.drawImage(l,0,0,h,p,g,m,d,f)}else s.addImage(i)}catch(e){}},e.paintConditionalFormats=function(e,o,n,r,i,a,s,l){var u,c,h,p=l.conditionalFormats;if(p&&!(p.count()<=0)){var d,f,g=l.sheet,m=l.row,_=l.col,y=g._cachePool.getConditionalFormat(m,_);if(y){if(d=y.i,f=y.d,!d&&!f)return!1}else{if((c=(u=p.getRules(m,_)).length)<=0)return g._cachePool.setConditionalFormat(m,_,f,d),!1;var C=!1,w=!1,v=O,S=O,x=O,R=O;for(u.sort(function(e,t){return e.priority()-t.priority()}),h=0;h<c&&!((x=u[h])&&(!v&&x instanceof t.DataBarRule?v=x:!S&&x instanceof t.IconSetRule&&(S=x),x.stopIfTrue()&&(R=x.evaluate(g,m,_,o),R)));h++);v&&(f=v.evaluate(g,m,_,o)),S&&(d=S.evaluate(g,m,_,o)),g._cachePool.setConditionalFormat(m,_,f,d)}return e.save(),e.beginPath(),f&&(t.DataBarRule.paintDataBar(e,f,n,r,i,a),C=f.showBarOnly),d&&((i<16||a<16)&&(e.rect(n,r,i,a),e.clip(),e.beginPath()),t.IconSetRule.paintIconSet(e,d,n,r,i,a,s,l.imageLoader),w=d.showIconOnly),e.restore(),C||w}},e.paintSparkline=function(e,t,o,n,r,i){i&&i.paintSparkline(e,t,o,n,r)},e.paintSparklineEx=function(e,o,n,r,i,a,s){var l,u;return!!(t.features.sparklineEx&&o instanceof t.SparklineExValue&&(l=s&&s.parent,l&&(u=l.getSparklineEx(o.name),u)))&&(u._paintSparkline(e,o.value,n,r,i,a,s),!0)},e.hasIconSet=function(e,o,n,r){var i,a,s,l;if((r===O||r===N||3===r)&&(i=e._conditionalFormats))for(s=0,l=(a=i.getRules(o,n)).length;s<l;s++)if(a[s]instanceof t.IconSetRule)return!0;return!1},e.adjustRectForIconSet=function(t,o,n,r,i,a){0===t&&e.hasIconSet(o,n,r,i)&&(a.x+=16,a.width-=16)},e}();t.CellTypeContext=V,o=function(){function e(){this.allowOverflow=!1,this.typeName="0"}return e.prototype.paintValue=function(e,t,o,n,r,i,a,s){var l,u={value:O};(l=this.format(t,a.formatter||a._autoFormatter,u))&&this.paintText(e,t,o,n,r,i,a,s,l,u)},e.prototype.paintText=function(e,o,n,r,i,a,s,l,u,c,h){var f,_,y,C,w,v,S,x,R;e.save(),e.beginPath(),f=s.foreColor,_=s.font,c.value&&(f=c.value),typeof h!==E&&((y=t._Color.parse(f)).a=h,f=y.toString()),f&&e.fillStyle!==f&&(e.fillStyle=f),_&&e.font!==_&&(e.font=_);var b=0,T=s.textIndent,A=s.wordWrap,I=s.hAlign,D=s.vAlign,F=s.textDecoration,M=p,N=g,O=2,L=2,H=0,k=l.lineHeight,V=[],B=0,z=l.fontInfo.fontSize;T>0&&(b=8*T),3===I&&(I=t.util.getHAlignByValueType(I,o,s.formatter)),O+=b,1===I?(O=i/2,M=m):2===I&&(O=i-3,O-=b,M=d),e.textAlign!==M&&(e.textAlign=M),A&&((B=(V=t._WordWrapHelper._getWrapInfo(u,i-3-b,_)).length)>1&&0!==D&&(H=(B-1)*k)),L+=k-(w=k/2-z/2+(C=z>8?P((z-8)/5+2):1)-1),1===D?L=(a-H)/2+k/2-w:2===D&&(L=a-H-2-w),e.textBaseline!==N&&(e.textBaseline=N);var G={x:n+1,y:r+1,width:i-2,height:a-2},W=l.cellOverflowLayout,j=W&&W.layout;if(j&&(G={x:j.x,y:j.y,width:j.width,height:j.height}),A)for(e.rect(G.x,G.y,G.width,G.height),e.clip(),e.beginPath(),v=r+L,S=0;S<B;S++)e.fillText(V[S],n+O,v),F&&(x=e.measureText(V[S]).width,this._renderTextDecoration(e,F,n+O,v,x,z,C)),v+=k;else{var U=e.measureText(u).width,Y=G.width,X=G.height,K=U>Y||k>X;K||(1===I?W&&(((R=U/2)>W.backgroundLeftWidth||R>W.backgroundRightWidth)&&(K=!0)):U+b>Y&&(K=!0)),K&&(e.rect(G.x,G.y,Y,X),e.clip(),e.beginPath()),e.fillText(u,n+O,r+L),F&&this._renderTextDecoration(e,F,n+O,r+L,U,z,C)}e.restore()},e.prototype.paint=function(e,t,o,n,r,i,a,s){},e.prototype.createEditorElement=function(e){return O},e.prototype._getLocator=function(){var e=l.createElement("span");return t.GC$(e).css(u,c).css("visibility",R).css(F,"#68E").css("margin","0").css(S,"2px").css(h,"normal 12px Arial").css("color","white").css("border-width","0").attr("class","gc-input-locator").attr(_,"gcEditingLocator"),e},e.prototype.getEditorValue=function(e,t){return O},e.prototype._formatEditorValue=function(e,t,o,n){return o},e.prototype.setEditorValue=function(e,t,o){},e.prototype.getEditingElement=function(){return O},e.prototype.parse=function(e,o,n){var r=typeof e===E||e===O;if(typeof o===E||o===O||r)return r?"":e.toString();try{return t.features.formatter?("string"==typeof o?new t.GeneralFormatter(o):o).Parse(e):e.toString()}catch(t){return e.toString()}},e.prototype.format=function(e,o,n,r){var i;if(e===N||e===O||""===e)return"";if("string"==typeof o&&"object"!=typeof e)return t._CacheMgr.getFormattedText(e,o,n);if(!o)return"boolean"==typeof e||e instanceof Boolean?e.toString().toUpperCase():e instanceof Date?(i=t._CultureInfo.currentCulture().DateTimeFormat(),new t._DateTimeHelper(e).localeFormat(i.shortDatePattern+" H:mm:ss")):("number"==typeof e&&(e=t._NumberHelper.replaceNormalToCultureSymble(e.toString())),e.toString());try{return t.features.formatter?(O,("string"==typeof o?t._CacheMgr.getFormatter(o):o).Format(e,n)):e.toString()}catch(t){return e.toString()}},e.prototype.focus=function(e,t){e&&e.focus&&e.focus()},e.prototype.getThemeStyle=function(e,o){return t.ThemeStyleHelper.getVisualStateThemeStyle(e,o)},e.prototype.activateEditor=function(e,t,o,n){},e.prototype.deactivateEditor=function(e,t){},e.prototype.selectAll=function(e,t){e&&e.select&&e.select()},e.prototype.updateEditor=function(e,t,o,n){},e.prototype.setImeMode=function(e,o,n){this.isImeAware(n)?this.updateImeMode(e,o,n):e&&t.GC$(e).css(M,this._getImeModeString(0))},e.prototype.updateImeMode=function(e,o,n){e&&t.GC$(e).css(M,this._getImeModeString(o))},e.prototype._getImeModeString=function(e){var t="";switch(e===N&&(e=1),e){case 1:t="auto";break;case 2:t="active";break;case 4:t="inactive";break;case 0:t="disabled"}return t},e.prototype._updateEditorLocator=function(e,o){var n,r,i=e&&o&&o.sheet;i&&i.isEditing()&&i.showEditingLocator&&(n=e._editingLocator,r=t.GC$(e),n&&t.GC$(n).css(f,parseInt(r.css(f),10)-18).css(p,parseInt(r.css(p),10)))},e.prototype.getHitInfo=function(e,t,o,n,r){return O},e.prototype.processMouseDown=function(e){return!1},e.prototype.processMouseMove=function(e){return!1},e.prototype.processMouseUp=function(e){return!1},e.prototype.processMouseEnter=function(e){},e.prototype.processMouseLeave=function(e){},e.prototype.isReservedKey=function(e,t){return!1},e.prototype.isEditingValueChanged=function(e,t,o){return e!==t},e.prototype.processKeyDown=function(e,t){return!1},e.prototype.processKeyUp=function(e,t){return!1},e.prototype.getAutoFitWidth=function(e,t,o,n,r){return 0},e.prototype.getAutoFitHeight=function(e,t,o,n,r){return 0},e.prototype._renderTextDecoration=function(e,t,o,n,r,i,a){e.strokeStyle=e.fillStyle;var s,l=0,u=.5;s=P(((i<=12?12:i)-12)/21+1),e.lineWidth=s,0==(1&s)&&(u=0),e.textAlign===m?o-=r/2:e.textAlign===d&&(o-=r),e.beginPath(),4==(4&t)&&(l=L(n+a-i-1)-u,e.moveTo(o,l),e.lineTo(o+r,l)),2==(2&t)&&(l=L(n+a-i/2)-u,e.moveTo(o,l),e.lineTo(o+r,l)),1==(1&t)&&(l=L(n+a-1)-u,e.moveTo(o,l),e.lineTo(o+r,l)),e.stroke()},e.prototype._setEditStatusTextDecoration=function(e,t){var o="";4==(4&t)&&(o="overline"),2==(2&t)&&(o+=" line-through"),1==(1&t)&&(o+=" underline"),e.css("text-decoration",o)},e.prototype.isImeAware=function(e){return!1},e.prototype.isEditting=function(){return!1},e.prototype.toJSON=function(){return{typeName:this.typeName}},e.prototype.fromJSON=function(e,t){},e}(),t.BaseCellType=o,n=function(o){function n(){o.call(this),this.allowOverflow=!0,this.typeName="1"}return __extends(n,o),n.prototype.paint=function(e,o,n,r,i,a,s,l){var u,c,h;e&&(l&&l.parentBackColor&&l.parentBackColor===s.backColor||V.paintBackground(e,n,r,i,a,s.backColor,s.backgroundImage,s.backgroundImageLayout,l.imageLoader),u=V.paintConditionalFormats(e,o,n,r,i,a,s,l),l.showBarIconOnly=u,V.paintSparkline(e,n,r,i,a,l.sparkline),c=V.paintSparklineEx(e,o,n,r,i,a,l.sheet),l.cellOverflowLayout||u||c||(h=new t.Rect(n,r,i,a),V.adjustRectForIconSet(s.hAlign,l.sheet,l.row,l.col,l.sheetArea,h),this.paintValue(e,o,h.x,h.y,h.width,h.height,s,l)))},n.prototype.getText=function(e,t){return e},n.prototype.paintValue=function(e,t,o,n,r,i,a,s){var l,u;t=this.getText(t,s),l={value:O},u=this.format(t,a.formatter||a._autoFormatter,l),!a.watermark||u?u&&this.paintText(e,t,o,n,r,i,a,s,u,l):this.paintText(e,a.watermark,o,n,r,i,a,s,a.watermark,l,.337)},n.prototype.createEditorElement=function(e){var o=t.GC$(l.createElement("textarea"));o.css("margin","0").css(S,"1px").css("box-sizing","content-box").css(h,"normal 11pt calibri").css(b,"normal").css(T,R).css("resize",y).css("border","2px #5292f7 solid").css("outline",y).css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("min-height","0px").attr("tabindex",-1).attr("autocomplete","off").attr(_,"gcEditingInput");var n=l.createElement("div"),r=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,i=t.util.getPreferredZIndex(r)+1e3;return t.GC$(n).css(u,c).css("z-index",i).append(o),n},n.prototype.getEditorValue=function(e,t){var o,n=e&&e.children[0];return n&&((o=n.value)!==N&&o!==O&&o.length>0)?o:O},n.prototype.setEditorValue=function(e,o,n){var r,i=e&&e.children[0];i&&(r=(!t.util.browser.msie||parseFloat(t.util.browser.version)<11)&&!!(n&&n.sheet&&n.sheet._startEditByKeydown),i.value=o===O||o===N||r?"":o,i.selectionStart=i.selectionEnd=i.value.length)},n.prototype.focus=function(e,t){if(e){var o=e.children[0];this.isImeAware()&&o?(o.focus(),o.selectionStart=o.value.length):e.focus()}},n.prototype._formatEditorValue=function(e,o,n,r){var i=e&&r&&r.sheet;return t.util.formatValue2Text(o,n,i)},n.prototype.activateEditor=function(e,o,n,r){var i,a,s,l,u,c,h=e&&r&&r.sheet;h&&(i=t.GC$(e),a=h.getBounds(),s=r.canvasOffset?r.canvasOffset:h._eventHandler._getCanvasPosition(),i.css(f,s.top+a.y+n.y-2).css(p,s.left+a.x+n.x-2),l=this,(u=e.children[0])&&(c=t.GC$(u),l._editingElement=c.getElement(0),c.bind("keydown.gcEditingInput",function(i){if(229===i.keyCode||0===i.keyCode||l._isImeInputing||l._updateEditorImp(e,o,n,i,r,!0),!l._processEditingWrap(i,r)){var a=0===u.selectionStart&&37===i.keyCode&&!i.ctrlKey&&!i.shiftKey&&!i.altKey,s=u.selectionStart===u.value.length&&39===i.keyCode&&!i.ctrlKey&&!i.shiftKey&&!i.altKey;u.selectionStart===u.selectionEnd&&(a||s)&&2===h._editorStatus&&t.util.cancelDefault(i)}}),c.bind("keyup.gcEditingInput",function(t){(46===t.keyCode||8===t.keyCode||(90===t.keyCode||89===t.keyCode)&&t.ctrlKey&&!t.altKey)&&l._updateEditorImp(e,o,n,t,r),(13!==t.keyCode&&9!==t.keyCode||t.ctrlKey||t.altKey)&&h.triggerEditChange({sheet:h,sheetName:h._name,row:h._activeRowIndex,col:h._activeColIndex,editingText:l.getEditorValue(e,r)})}),c.bind("paste.gcEditingInput",function(t){l._pasteInputSizingToken=window.setTimeout(function(){l._updateEditorImp(e,o,n,t,r),l._pasteInputSizingToken&&(window.clearTimeout(l._pasteInputSizingToken),delete l._pasteInputSizingToken)},10)}),c.bind("mousedown.gcEditingInput",function(e){1===h._editorStatus&&(h._editorStatus=2,h.triggerEditorStatusChanged({sheet:h,sheetName:h._name,oldStatus:1,newStatus:2}))}),c.bind("compositionstart.gcEditingInput",function(e){l._isImeInputing=!0,l._oldValueBeforeImeInputting=c.val()}),c.bind("compositionupdate.gcEditingInput",function(t){l._updateEditorImp(e,o,n,t||O,r,!0)}),c.bind("compositionend.gcEditingInput",function(t){l._updateEditorImp(e,o,n,t||O,r),l._isImeInputing=!1})))},n.prototype.deactivateEditor=function(e,o){var n,r,i;e&&((n=e.children[0])&&t.GC$(n).unbind(C),(r=e._editingLocator)&&((i=o&&o.sheet&&o.sheet._getHost())&&i.removeChild(r))),this._editingElement=O},n.prototype.getEditingElement=function(){return this._editingElement},n.prototype.selectAll=function(e,t){var o=e&&e.children[0];o&&o.select&&o.select()},n.prototype._updateEditorImp=function(e,o,n,r,i,a){var s,l,u,c,g,_,y,C,S,M,E,P,V,B,z,G,W=i&&i.sheet;if(W&&n&&(s=i.canvasOffset?i.canvasOffset:W._eventHandler._getCanvasPosition(),l=W.getBounds(),t.GC$(e).css(f,s.top+l.y+n.y-2).css(p,s.left+l.x+n.x-2)),u=e&&e.children[0],W=i&&i.sheet,u&&W){var j=t.GC$(u),U=W._render;if(W.isEditing()){var Y=O,X=p,K=O;if(o&&(1===(Y=t.util.getHAlignByValueType(o.hAlign,e._originalValue))?X=m:2===Y&&(X=d),j.css(x,X),o.backColor&&j.css(F,o.backColor),o.foreColor&&j.css("color",o.foreColor),(K=o.font||U._getDefaultFont())&&(W._zoomFactor>1&&(K=U._getZoomFont(K)),j.css(h,K)),o.textDecoration&&this._setEditStatusTextDecoration(j,o.textDecoration)),n){t.GC$(e).width(n.width).height(n.height);var J=W._getSheetLayout(),Z=1,q=1;Z=Z+parseInt(j.css("padding-left"),10)+parseInt(j.css("padding-right"),10),q=q+parseInt(j.css("padding-top"),10)+parseInt(j.css("padding-bottom"),10),B=n.width,n.x+n.width>J.width&&(B=J.width-n.x),j.css(w,B-Z).css(v,n.height-q),Y===N||Y===O||0===Y?u.maxWidth=J.width-n.x-Z:1===Y?u.maxWidth=2*k(0,H(J.width-n.x-n.width-Z,n.x-J.rowHeaderWidth-Z))+n.width:2===Y&&(u.maxWidth=n.x+n.width-J.rowHeaderWidth-Z),u.maxHeight=J.height-n.y-q,u.minWidth=parseInt(u.style.width,10),u.minHeight=parseInt(u.style.height,10)}try{a=(a=a&&r&&r.keyCode&&W._eventHandler.allowEnterEditing(r)&&0===u.selectionStart&&u.selectionEnd===u.value.length)||!!(i&&i.sheet&&i.sheet._startEditByKeydown)}catch(e){}if(c=a?"":u.value,(K=u.style.font)||(K=U._getZoomFont(U._getDefaultFont())),g=W._getFontHeight(K),!a&&r){if(W._eventHandler.allowEnterEditing(r)){var $=u.selectionStart,Q=c.substr(0,$),ee=c.substr($,c.length-$);c=Q+String.fromCharCode(r.keyCode)+ee}this._isImeInputing&&(c=t.util.browser.msie?j.val():this._oldValueBeforeImeInputting+r.data)}if([],S=(_=o&&o.wordWrap?t._WordWrapHelper._getWrapInfo(c,j.width(),K):c.split(/\r\n|\r|\n/)).length,u.minWidth=H(u.minWidth,u.maxWidth),u.minHeight=H(u.minHeight,u.maxHeight),o&&o.wordWrap||S>0){if(M=S*g,o&&o.wordWrap)j.css(b,I).css(T,R);else{for(E=0,P=[],y=0;y<S;y++)V=_[y],C=W._getStringWidth(V,K),P.push(C),E=k(E,C);if(E<=u.minWidth)j.css(w,u.minWidth).css(b,A).css(T,R);else if(E>u.minWidth&&E<=u.maxWidth)j.css(w,E).css(b,A).css(T,R);else if(E>u.maxWidth)for(j.css(w,u.maxWidth).css(b,I).css(T,R),M=0,y=0;y<P.length;y++)(C=P[y])<=u.maxWidth?M+=g:C>u.maxWidth&&(M+=g*L(C/u.maxWidth))}M<=u.minHeight?j.css(v,u.minHeight):M>u.minHeight&&M<=u.maxHeight?j.css(v,M):M>u.maxHeight&&j.css(v,u.maxHeight).css(D,"scroll")}else(B=W._getStringWidth(c,K))>u.minWidth&&B<=u.maxWidth?j.css(w,B).css(v,u.minHeight).css(b,A).css(T,R):B<=u.minWidth?j.css(w,u.minWidth).css(v,u.minHeight).css(b,A).css(T,R):B>u.maxWidth&&(j.css(w,u.maxWidth).css(b,I),(z=g*L(B/u.maxWidth))<=u.minHeight?j.css(v,u.minHeight).css(T,R):z<=u.maxHeight?j.css(v,z).css(T,R):z>u.maxHeight&&j.css(v,u.maxHeight).css(D,"scroll"));Y=j.css(x),G=j.width()-u.minWidth,Y!==N&&Y!==O&&Y!==p&&(Y===m?j.css(p,u.originalLeft-G/2):Y===d&&j.css(p,u.originalLeft-G)),this._updateEditorLocator(e,i)}}},n.prototype.updateEditor=function(e,o,n,r){if(this._updateEditorImp(e,o,n,O,r),t.util.browser.msie&&e){var i=t.GC$(e.children[0]),a=i.width();i.width(a+1).width(a)}},n.prototype.updateImeMode=function(e,o,n){if(this.isImeAware()){var r=e&&e.children[0];r&&t.GC$(r).css(M,this._getImeModeString(o))}},n.prototype.isReservedKey=function(e,t){var o=e.srcElement||e.target;return!!(o&&t&&t.isEditing&&"gcEditingInput"===o.getAttribute(_))&&(13===e.keyCode&&(e.ctrlKey&&!e.shiftKey||e.altKey)||90===e.keyCode&&e.ctrlKey&&!e.altKey||89===e.keyCode&&e.ctrlKey&&!e.altKey)},n.prototype._processEditingWrap=function(o,n){var r,i,a=o.srcElement||o.target;if(a&&"gcEditingInput"===a.getAttribute(_)&&13===o.keyCode&&(o.ctrlKey||o.altKey)){var s=a.selectionStart,l=a.value,u=l.substr(0,s),c=l.substr(s,l.length-s);return a.value=u+"\n"+c,a.selectionStart=s+1,a.selectionEnd=s+1,(r=t.FocusHelper.getActiveElement())instanceof e.Sheets.Sheet&&((i=r.getCellType(r._activeRowIndex,r._activeColIndex))&&i.updateEditor(r._editor,O,O,n)),t.util.cancelDefault(o),!0}return!1},n.prototype.getAutoFitWidth=function(e,t,o,n,r){return V.getAutoFitWidth(e,t,o,n,r)},n.prototype.getAutoFitHeight=function(e,t,o,n,r){return V.getAutoFitHeight(e,t,o,n,r)},n.prototype.isImeAware=function(e){return!0},n}(o),t.TextCellType=n,r=function(e){function o(){e.apply(this,arguments)}return __extends(o,e),o.prototype._paint=function(e,o,n,r,i,a,s,l,u,c){var h,p;e&&(this,h=0,l.visualState!==N&&(h=l.visualState),p=this.getThemeStyle(l.visualState,"gc-"+u+"-"+t.VisualState[h].toLowerCase()),this._paintBackground(e,n,r,i,a,s,l,h,p),this._paintText(e,o,n,r,i,a,s,l,c,p),this._paintGridline(e,n,r,i,a,s,u,p,c))},o.prototype._paintBackground=function(e,o,n,r,i,a,s,l,u){var c,h,p,d,f,g,m,_,C;if(typeof l!==E){if(e.save(),e.beginPath(),0===l&&a.backColor)c=a.backColor,e.fillStyle!==c&&(e.fillStyle=c),e.fillRect(o+1,n+1,r-1,i-1);else try{if(h=u&&u.backgroundColor,(p=u&&u.backgroundImage)&&-1!==p.indexOf("linear-gradient")){for(d=t.util.getLinearGradientColors(p),c=e.createLinearGradient(o+r/2,n,o+r/2,n+i),f=0,g=d.length;f<g;f++)m=d[f],c.addColorStop(m.point,m.color);e.fillStyle=c,e.fillRect(o+1,n+1,r-1,i-1)}else h?(e.fillStyle=h,e.fillRect(o+1,n+1,r-1,i-1)):p&&p!==y&&(_=new Image,C=(C=(C=p).replace('url("',"")).replace('")',""),_.src=C,e.drawImage(_,o+1,n+1,r-1,i-1))}catch(e){}V.paintBackgroundImage(e,o,n,r,i,a.backgroundImage,a.backgroundImageLayout,s.imageLoader),e.restore()}},o.prototype._paintText=function(e,o,n,r,i,a,s,l,u,c){var h,f,_,y,C,w,v,S,x,R,b,T,A=this.format(o,s.formatter),I=l.sheet;if(A){e.save(),e.beginPath();var D=I._render,F=I.rowFilter();!!(F&&F.isFilterHeader(l.row,l.col,u)&&F.filterButtonVisible(l.col))&&(i-=D._getFilterButtonRect(new t.Rect(n,r,i,a),u).width),h={x:n,y:r,width:i,height:a},(f=s.foreColor)||(f=c.color),f&&e.fillStyle!==f&&(e.fillStyle=f),_=this._getFontByVisualStatus(s.font||e.font,e.fillStyle,l,u,c),e.font=_.font,e.fillStyle=_.fillStyle,y=0,(C=s.textIndent)>0&&(y=8*C);var M=s.hAlign,E=s.vAlign,N=p,O=2;O+=y,1===M?(O=i/2,N=m):2===M&&(O=i-1,O-=y,N=d),e.textAlign!==N&&(e.textAlign=N);var L=0,H=g,k=2,V=s.wordWrap,B=l.lineHeight,z=l.fontInfo.fontSize,G=[],W=0;if(V&&((W=(G=t._WordWrapHelper._getWrapInfo(A,i-3-y,e.font)).length)>1&&0!==E&&(L=(W-1)*B)),k+=B-(v=B/2-z/2+(w=z>8?P((z-8)/5+2):1)-1),1===E?k=(a-L)/2+B/2-v:2===E&&(k=a-L-2-v),e.textBaseline!==H&&(e.textBaseline=H),S=s.textDecoration,s.wordWrap)for(e.rect(h.x,h.y,h.width,h.height),e.clip(),e.beginPath(),x=r+k,R=0;R<W;R++)e.fillText(G[R],n+O,x),S&&(b=e.measureText(G[R]).width,this._renderTextDecoration(e,S,n+O,x,b,z,w)),x+=l.lineHeight;else((T=e.measureText(A).width)>h.width||B>h.height)&&(e.rect(h.x,h.y,h.width,h.height),e.clip(),e.beginPath()),e.fillText(A,n+O,r+k),S&&this._renderTextDecoration(e,S,n+O,r+k,T,z,w);e.restore()}},o.prototype._getFontByVisualStatus=function(e,o,n,r,i){var a,s={font:e,fillStyle:o},l=n.sheet;return 0!==n.visualState&&parseInt(i.zIndex)>2007&&l._isSelected(n.row,n.col,r)&&(a=l._isAllSelected(n.row,n.col,r)?this.getThemeStyle(n.visualState,"gc-columnHeader-selected"):this.getThemeStyle(n.visualState,"gc-columnHeader-highlight"),s.fillStyle=a.color,s.font=t.StyleHelper.setStringFont(s.font,{fontWeight:"bold"})),s},o.prototype._paintGridline=function(e,t,o,n,r,i,a,s,l){var u;1===l?(e.beginPath(),(u=e.createLinearGradient(t,o+1,t,o+r-2)).addColorStop(0,s.borderLeftColor),u.addColorStop(1,s.borderRightColor),e.strokeStyle=u,i.borderLeft||(e.moveTo(t+.5,o),e.lineTo(t+.5,o+r)),i.borderRight||(e.moveTo(t+n-.5,o),e.lineTo(t+n-.5,o+r)),e.stroke(),s.borderBottomWidth&&!i.borderBottom&&(e.beginPath(),e.strokeStyle=s.borderBottomColor,e.moveTo(t+1,o+r-.5),e.lineTo(t+n,o+r-.5),e.stroke())):(e.beginPath(),(u=e.createLinearGradient(t,o,t+n-2,o)).addColorStop(0,s.borderTopColor),u.addColorStop(1,s.borderBottomColor),e.strokeStyle=u,i.borderTop||(e.moveTo(t,o+.5),e.lineTo(t+n,o+.5)),i.borderBottom||(e.moveTo(t,o+r-.5),e.lineTo(t+n,o+r-.5)),e.stroke(),s.borderRightWidth&&!i.borderRight&&(e.beginPath(),e.strokeStyle=s.borderRightColor,e.moveTo(t+n-.5,o+1),e.lineTo(t+n-.5,o+r),e.stroke()))},o.prototype.getAutoFitWidth=function(e,t,o,n,r){return V.getAutoFitWidth(e,t,o,n,r)},o.prototype.getAutoFitHeight=function(e,t,o,n,r){return V.getAutoFitHeight(e,t,o,n,r)},o}(o),t.HeaderCellType=r,i=function(e){function t(){e.call(this),this.typeName="2"}return __extends(t,e),t.prototype.paint=function(t,o,n,r,i,a,s,l){e.prototype._paint.call(this,t,o,n,r,i,a,s,l,"columnHeader",1)},t}(r),t.ColumnHeaderCellType=i,a=function(e){function t(){e.call(this),this.typeName="3"}return __extends(t,e),t.prototype.paint=function(t,o,n,r,i,a,s,l){e.prototype._paint.call(this,t,o,n,r,i,a,s,l,"rowHeader",2)},t}(r),t.RowHeaderCellType=a,s=function(e){function o(){e.call(this),this.typeName="4"}return __extends(o,e),o.prototype.paint=function(e,o,n,r,i,a,s,l){var u,c,h,p,d,f,g,m,_,C;if(e){if(e.save(),e.rect(n,r,i,a),e.clip(),e.beginPath(),u=0,l.visualState!==N&&(u=l.visualState),typeof u!==E){try{var w=this.getThemeStyle(l.visualState,"gc-corner-"+t.VisualState[u].toLowerCase()),v=w&&w.backgroundColor,S=w&&w.backgroundImage;v?(e.fillStyle=v,e.fillRect(n,r,i,a)):S&&S!==y&&(c=new Image,h=(h=(h=S).replace('url("',"")).replace('")',""),c.src=h,e.drawImage(c,n,r,i,a))}catch(e){}var x=this.getThemeStyle(4,"gc-corner-triangle-"+t.VisualState[u].toLowerCase()),R=(S=x&&x.backgroundImage,x&&x.backgroundColor),b=e.createLinearGradient(n+i/2,r,n+i/2,r+a);if(S&&-1!==S.indexOf("linear-gradient")){for(d=0,f=(p=t.util.getLinearGradientColors(S)).length;d<f;d++)g=p[d],b.addColorStop(g.point,g.color);e.fillStyle=b}else R&&(b.addColorStop(.125,"#f6fafb"),b.addColorStop(1,R),e.fillStyle=b);(m=e.createLinearGradient(n+i,r+1,n+i,r+a-2)).addColorStop(0,x.borderLeftColor),m.addColorStop(1,x.borderRightColor),e.beginPath(),e.strokeStyle=m,e.moveTo(n+i-.5,r),e.lineTo(n+i-.5,r+a),e.stroke(),(_=e.createLinearGradient(n,r,n+i-2,r)).addColorStop(0,x.borderTopColor),_.addColorStop(1,x.borderBottomColor),e.beginPath(),e.strokeStyle=_,e.moveTo(n,r+a-.5),e.lineTo(n+i,r+a-.5),e.stroke(),e.beginPath(),3,C=a,i<a&&(C=i),e.moveTo(n+i-C+3,r+a-3),e.lineTo(n+i-3,r+a-3),e.lineTo(n+i-3,r+a-C+3),e.fill()}e.restore()}},o.prototype.getAutoFitWidth=function(e,t,o,n,r){return V.getAutoFitWidth(e,t,o,n,r)},o.prototype.getAutoFitHeight=function(e,t,o,n,r){return V.getAutoFitHeight(e,t,o,n,r)},o}(o),t.CornerCellType=s}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){e.feature("basedialog",["core.common"]);var t=function(){function t(e,t){var o=this;o.host=e,o._wijpopupClass="wijspread-popup",o._overlayClass="wijspread-overlay",t=t||0,o.defaultOverlayCSS={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:t,backgroundColor:"rgba(0,0,0,0)"},o.defaultContainerCSS={position:"absolute",padding:0,margin:0,height:"auto",zIndex:t+1,outline:"none"},o._init()}return t.prototype._init=function(){var t=this;t._hasTargetContainer(t._name)?t.container=e.GC$("#"+t._name):(t._name=t._generateName(),t.container=e.GC$(document.createElement("div")).addClass(t._wijpopupClass+" ui-widget").attr({id:t._name,tabIndex:-1}).css(t.defaultContainerCSS))},t.prototype._generateName=function(){for(var e=0;this._hasTargetContainer("dialog"+e);)e++;return"dialog"+e},t.prototype.getContainer=function(){if(this.container)return this.container},t.prototype.getHost=function(){return this.host?this.host:document.body},t.prototype.show=function(t){var o=this,n=(arguments.length,o.container);o._hasOverlay()||o._createOverlay(),window.gcGlobal.suspendEvent(),o._hasTargetContainer(o._name)||(e.GC$(o.getHost()).append(n),o.resetDialogPosition(),n.css("display","none")),n.show(t)},t.prototype.close=function(){var t=this;t._hasTargetContainer(t._name)&&t.container.remove(),e.GC$("."+t._wijpopupClass).isVisible()||t.closeOverlay(),window.gcGlobal.resumeEvent()},t.prototype.closeOverlay=function(){e.GC$("."+this._overlayClass).remove()},t.prototype.resetDialogPosition=function(){var t=this.container,o=this.getHost();if(0!==t.length()){var n=e.GC$(o).offset(),r=parseInt(t.css("left"))+n.left,i=parseInt(t.css("top"))+n.top,a=t.width(),s=t.height();if(!(isNaN(r)||isNaN(i)||isNaN(a)||isNaN(s))){var l=0,u=0,c=document.documentElement.clientWidth,h=document.documentElement.clientHeight,p=t.getElement(0).getBoundingClientRect();p.left+a>c&&(u=p.left+a-c),p.top+s>h&&(l=p.top+s-h),(r<0||i<0||l>0||u>0)&&((r-=u)<0&&(r=0),(i-=l)<0&&(i=0),t.css({left:r-n.left+"px",top:i-n.top+"px"}))}}},t.prototype._hasTargetContainer=function(t){return e.GC$("#"+t).length()>0},t.prototype._createOverlay=function(){var t,o,n,r=this,i=e.GC$(document.createElement("div")).addClass(r._overlayClass);i.css(r.defaultOverlayCSS),e.GC$(r.host).append(i),t=e.util.browser&&e.util.browser.mozilla,o=e.util.browser&&e.util.browser.qtMode,(t||o)&&(n=(new Date).valueOf()),i.bind("mousedown",function(i){if((t||o)&&(new Date).valueOf()-n<100)return;r.close(),(t||o)&&r._delayCloseTimeout&&window.clearTimeout(r._delayCloseTimeout),e.util.cancelDefault(i)}),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(n,a){i.bind(n,function(n){t||o?r._delayCloseTimeout=setTimeout(function(){r.close()},100):r.close(),e.util.cancelDefault(n)})})},t.prototype._hasOverlay=function(){return e.GC$("."+this._overlayClass).length()>0},t}();e.BaseDialog=t}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n,r,i,a,s,l,u,c;e.feature("core.sheet_model",["core.common","core.stringResource"]);var h=null,p=void 0,d=Math.min,f=(Math.floor,function(){function o(e,o){this._sheet=e,this._dataModel=new l,this._dataModel.name=this._name=o,this._rowHeaderModel=new l(this._dataModel.rowCount,1),this._colHeaderModel=new l(1,this._dataModel.colCount),this._colFooterModel=new l(1,this._dataModel.colCount,this._name+"cf"),this._rowInfos=new c,this._colInfos=new c,this._colHeaderRowInfos=new c,this._rowHeaderColInfos=new c,this._spanModel=new t,this._colHeaderSpanModel=new t,this._rowHeaderSpanModel=new t}return o.prototype.name=function(e){if(!e)return this._name;this._name=e,this._dataModel.name=name},o.prototype.dataModel=function(){return this._dataModel},o.prototype.rowHeaderModel=function(){return this._rowHeaderModel},o.prototype.colHeaderModel=function(){return this._colHeaderModel},o.prototype.colFooterModel=function(){return this._colFooterModel},o.prototype.getDataModel=function(t){e.SheetArea;return 3===t||t===p||null===t?this._dataModel:2===t?this._rowHeaderModel:1===t?this._colHeaderModel:null},o.prototype.getRowInfos=function(e){return 1===e||0===e?this._colHeaderRowInfos:this._rowInfos},o.prototype.getColInfos=function(e){return 2===e||0===e?this._rowHeaderColInfos:this._colInfos},o.prototype.getSpanModel=function(e){return null==e||3===e?this._spanModel:1===e?this._colHeaderSpanModel:2===e?this._rowHeaderSpanModel:void 0},o}());e.SheetModelManager=f,t=function(t){function n(){t.call(this),this._lastNonNullColumn=-1,this._lastNonNullRow=-1}return __extends(n,t),n.prototype.find=function(e,t){for(var o,n=this.length,r=0;r<n;r++)if((o=this[r])&&o.contains(e,t))return o;return h},n.prototype.remove=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return void this.splice(t,1)},n.prototype._setLastNonNullRowAndColumn=function(e){var t=e.row+e.rowCount-1,o=e.col+e.colCount-1;t>this._lastNonNullRow&&(this._lastNonNullRow=t),o>this._lastNonNullColumn&&(this._lastNonNullColumn=o)},n.prototype.addSpan=function(e){this._setLastNonNullRowAndColumn(e),this.push(e)},n.prototype.removeSpan=function(e,t){this.splice(e,t)},n.prototype.copy=function(t,o,n,r,i,a){var s,l,u,c,h=this,p=h.length;if(-1===t){for(c=[],u=0;u<p;u++)o<=(s=h[u]).col&&s.col<o+a?(c.push(new e.Range(s.row,r+s.col-o,s.rowCount,s.colCount)),!0):r<=s.col&&s.col<r+a&&(h.splice(u,1),u--,p--,!0);for(u=0;u<c.length;u++){if(l=c[u],!h.isValid(h,0,h.length,l))throw new Error(e.SR.Exp_OverlappingSpans);h.addSpan(l)}}else if(-1===o){for(c=[],u=0;u<p;u++)t<=(s=h[u]).row&&s.row<t+i?(c.push(new e.Range(n+s.row-t,s.col,s.rowCount,s.colCount)),!0):n<=s.row&&s.row<n+i&&(h.splice(u,1),u--,p--,!0);for(u=0;u<c.length;u++){if(l=c[u],!h.isValid(h,0,h.length,l))throw new Error(e.SR.Exp_OverlappingSpans);h.addSpan(l)}}else{for(c=[],u=0;u<p;u++)t<=(s=h[u]).row&&s.row<t+i&&o<=s.col&&s.col<o+a?(c.push(new e.Range(n+s.row-t,r+s.col-o,s.rowCount,s.colCount)),!0):n<=s.row&&s.row<n+i&&r<=s.col&&s.col<r+a&&(h.splice(u,1),u--,p--,!0);for(u=0;u<c.length;u++){if(l=c[u],!h.isValid(h,0,h.length,l))throw new Error(e.SR.Exp_OverlappingSpans);h.addSpan(l)}}},n.prototype.isValid=function(e,t,o,n){for(var r=t;r<o&&r<e.length;r++)if(e[r].intersect(n.row,n.col,n.rowCount,n.colCount))return!1;return!0},n.prototype.getEnumerator=function(e,t,n,r){return new o(this,e,t,n,r)},n.prototype.getSpans=function(e){var t,o,n;if(!e)return this.slice(0);for(t=[],o=0;o<this.length;o++)n=this[o],(!e||n.intersect(e.row,e.col,e.rowCount,e.colCount))&&t.push(n);return t},n.prototype.hasPartSpans=function(e,t,o,n){for(var r,i=0;i<this.length;i++)if((r=this[i]).intersect(e,t,o,n)&&(r.row<e||r.row+r.rowCount>e+o||r.col<t||r.col+r.colCount>t+n))return!0;return!1},n.prototype.hasSpans=function(e,t,o,n){return this.getEnumerator(e,t,o,n).moveNext()},n.prototype.clear=function(e,t,o,n){for(var r,i=0;i<this.length;i++)r=this[i],(-1===e||e<=r.row&&r.row<e+o)&&(-1===t||t<=r.col&&r.col<t+n)&&this.splice(i--,1)},n.prototype.move=function(t,o,r,i,a,s){var l,u,c,h=this,p=!1,d=new n,f=[],g=h.length;if(-1===t)for(u=0;u<g;u++)o<=(l=h[u]).col&&l.col<o+s?(c=new e.Range(l.row,i+l.col-o,l.rowCount,l.colCount),f.push(c),p=!0):i<l.col&&l.col<i+s?p=!0:d.push(l);else if(-1===o)for(u=0;u<g;u++)t<=(l=h[u]).row&&l.row<t+a?(c=new e.Range(r+l.row-t,l.col,l.rowCount,l.colCount),f.push(c),p=!0):r<=l.row&&l.row<r+a?p=!0:d.push(l);else for(u=0;u<g;u++)t<=(l=h[u]).row&&l.row<t+a&&o<=l.col&&l.col<o+s?(c=new e.Range(r+l.row-t,i+l.col-o,l.rowCount,l.colCount),f.push(c),p=!0):r<=l.row&&l.row<r+a&&i<=l.col&&l.col<i+s?p=!0:d.push(l);if(p){if(f.length>0)for(u=0;u<f.length;u++){if(c=f[u],!h.isValid(d,0,d.length,c))throw new Error(e.SR.Exp_OverlappingSpans);d.push(c)}for(h.length=0,u=0;u<d.length;u++)h.addSpan(d[u])}},n.prototype.isEmpty=function(){return this.length<=0},n.prototype.addRows=function(t,o){for(var n,r=this,i=r.length,a=0;a<i;a++)(n=r[a]).row>=t?(r[a]=new e.Range(n.row+o,n.col,n.rowCount,n.colCount),r._setLastNonNullRowAndColumn(r[a]),!0):n.row<t&&t<n.row+n.rowCount&&(r[a]=new e.Range(n.row,n.col,n.rowCount+o,n.colCount),r._setLastNonNullRowAndColumn(r[a]),!0)},n.prototype.addColumns=function(t,o){for(var n,r=this,i=r.length,a=0;a<i;a++)(n=r[a]).col>=t?(r[a]=new e.Range(n.row,n.col+o,n.rowCount,n.colCount),r._setLastNonNullRowAndColumn(r[a]),!0):n.col<t&&t<n.col+n.colCount&&(r[a]=new e.Range(n.row,n.col,n.rowCount,n.colCount+o),r._setLastNonNullRowAndColumn(r[a]),!0)},n.prototype.removeRows=function(t,o){for(var n,r,i=this,a=[],s=i.length,l=0;l<s;l++)(n=i[l]).row>=t?n.row<t+o?(a.push(l),!0):(i[l]=new e.Range(n.row-o,n.col,n.rowCount,n.colCount),!0):n.row<t&&t<n.row+n.rowCount&&(i[l]=new e.Range(n.row,n.col,n.rowCount-d(n.row+n.rowCount-t,o),n.colCount),1===i[l].rowCount&&1===i[l].colCount&&a.push(l),!0);for(l=a.length-1;l>=0;l--)r=a[l],i.splice(r,1)},n.prototype.removeColumns=function(t,o){for(var n,r,i=this,a=[],s=i.length,l=0;l<s;l++)(n=i[l]).col>=t?n.col<t+o?(a.push(l),!0):(i[l]=new e.Range(n.row,n.col-o,n.rowCount,n.colCount),!0):n.col<t&&t<n.col+n.colCount&&(i[l]=new e.Range(n.row,n.col,n.rowCount,n.colCount-d(n.col+n.colCount-t,o)),1===i[l].rowCount&&1===i[l].colCount&&a.push(l),!0);for(l=a.length-1;l>=0;l--)r=a[l],i.splice(r,1)},n.prototype.toJSON=function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return 0===e.length?p:e},n.prototype.fromJSON=function(t,o){var n,r,i;if(t)for(n=t,r=0;r<n.length;r++)i=n[r],this.addSpan(new e.Range(i.row,i.col,i.rowCount,i.colCount))},n}(e._XArray),e._SpanModel=t,o=function(){function e(e,t,o,n,r){var i=this;i.model=e,i.row=t,i.column=o,i.rowCount=n,i.columnCount=r,i.currentIndex=-1,-1===t&&-1===o&&(i.all=!0)}return e.prototype.current=function(){var e=this;return 0<=e.currentIndex&&e.currentIndex<e.model.length?e.model[e.currentIndex]:h},e.prototype.moveNext=function(){var e=this;if(e.currentIndex++,!e.all)for(;e.currentIndex<e.model.length&&!e.model[e.currentIndex].intersect(e.row,e.column,e.rowCount,e.columnCount);)e.currentIndex++;return e.currentIndex<e.model.length},e.prototype.reset=function(){this.currentIndex=-1},e}(),e._SpanEnumerator=o,n=function(e){function t(){e.call(this),this.headingOverflowlayout=h,this.trailingOverflowLayout=h}return __extends(t,e),t.prototype.find=function(e){var t,o,n=this.length;if(n>0)for(o=0;o<n;o++)if((t=this[o]).contains(e))return t;return h},t}(e._XArray),e._CellOverflowLayoutModel=n,r=function(){function e(e,t,o,n,r,i,a,s){var l=this;l.column=e,l.startColumn=t,l.endColumn=o,l.valueWidth=n,l.columnWidth=r,l.backgroundWidth=i,l.backgroundLeftWidth=a,l.backgroundRightWidth=s}return e.prototype.contains=function(e){return e>=this.startColumn&&e<=this.endColumn},e}(),e._CellOverflowLayout=r,i=function(t){function o(){t.call(this),this.selectionPolicy=2,this.selectionUnit=0}return __extends(o,t),o.prototype.find=function(e,t){var o,n,r=this.length;if(r>0)for(n=0;n<r;n++)if((o=this[n]).contains(e,t))return o;return h},o.prototype.clear=function(){this.splice(0,this.length),this.activeSelectedRangeIndex=-1},o.prototype.add=function(t,o,n,r){var i,a=this;0===a.selectionPolicy?(n=d(n,1),r=d(r,1),a.clear()):1===a.selectionPolicy&&a.clear(),1===a.selectionUnit?(o=-1,r=-1):2===a.selectionUnit&&(t=-1,n=-1),i=new e.Range(t,o,n,r),a.push(i),a.activeSelectedRangeIndex=a.length-1},o.prototype.toArray=function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},o.prototype.fromArray=function(e){this.splice(0,this.length);for(var t=0;t<e.length;t++)this.push(e[t])},o.prototype._isDefaultValue=function(e,t){switch(e){case"selectionPolicy":return 2===t;case"selectionUnit":case"activeSelectedRangeIndex":return 0===t;case"length":return 1===t;default:return!1}},o.prototype.toJSON=function(){var t=this,o={};for(var n in t)!t._isDefaultValue(n,t[n])&&t.hasOwnProperty(n)&&(o[n]=t[n]);return e.GC$.isEmptyObject(o)?p:o},o.prototype.fromJSON=function(t,o){var n,r,i;if(t){var a=t,s=t.length;for(s===p&&(s=1),n=0;n<s;n++)(r=a[n])===p&&(r={row:0,col:0,rowCount:1,colCount:1}),this.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));(i=t.activeSelectedRangeIndex)===p&&(i=0),this.activeSelectedRangeIndex=i,t.selectionPolicy!==p&&(this.selectionPolicy=t.selectionPolicy),t.selectionUnit!==p&&(this.selectionUnit=t.selectionUnit)}},o}(e._XArray),e._SelectionModel=i,a=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.findCell=function(e,t){var o,n,r=this.length;if(r>0)for(n=0;n<r;n++)if((o=this[n]).contains(e,t))return o;return h},t.prototype.findRow=function(e){var t,o,n=this.length;if(n>0)for(o=0;o<n;o++)if((t=this[o]).row===e)return t;return h},t.prototype.findCol=function(e){var t,o,n=this.length;if(n>0)for(o=0;o<n;o++)if((t=this[o]).col===e)return t;return h},t.prototype.findX=function(e){var t,o,n=this.length;if(n>0)for(o=0;o<n;o++)if((t=this[o]).containsX(e))return t;return h},t.prototype.findY=function(e){var t,o,n=this.length;if(n>0)for(o=0;o<n;o++)if((t=this[o]).containsY(e))return t;return h},t.prototype.findNearX=function(e){var t=h,o=this.length;return o>0&&((t=this.findX(e))||(t=e<this[0].x?this[0]:this[o-1])),t},t.prototype.findNearY=function(e){var t=h,o=this.length;return o>0&&((t=this.findY(e))||(t=e<this[0].y?this[0]:this[o-1])),t},t}(e._XArray),e._LayoutModel=a,s=function(){function e(e,t,o,n,r,i,a,s){this.rowCount=a,this.colCount=s,this.row=e,this.col=t,this.x=o,this.y=n,this.width=r,this.height=i}return e.prototype.contains=function(e,t){return e<this.row+this.rowCount&&this.row<=e&&t<this.col+this.colCount&&this.col<=t},e.prototype.intersect=function(e){return(this.x<0||e.x<this.x+this.width&&this.x<e.x+e.width)&&(this.y<0||e.y<this.y+this.height&&this.y<e.y+e.height)},e.prototype.containsX=function(e){return this.x<=e&&e<this.x+this.width},e.prototype.containsY=function(e){return this.y<=e&&e<this.y+this.height},e}(),e._Layout=s,l=function(){function t(e,t,o){this._isSuspendDirty=!1;var n=this;n.rowCount=e!==h&&e!==p?e:200,n.colCount=t!==h&&t!==p?t:20,n.name=o,n.dataTable={},n._rowDataArray=[],n._columnDataArray=[],n._defaultDataNode=h,n.dirtyNodes={},n._lastNonNullColumn=-1,n._lastNonNullRow=-1}return t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getColumnCount=function(){return this.colCount},t.prototype.setRowCount=function(e){this.rowCount=e},t.prototype.setColumnCount=function(e){this.colCount=e},t.prototype._updateDirty=function(e,t,o){if(!this._isSuspendDirty&&e>=0&&t>=0){this.dirtyNodes[e]||(this.dirtyNodes[e]={});var n=this.dirtyNodes[e];"n"!==n.rs&&(n.rs="e"),o.originalItem!==p&&(n.originalItem=o.originalItem),n[t]||(n[t]={}),o.oldValue!==p&&(n[t].oldValue=o.oldValue)}},t.prototype._suspendDirty=function(){this._isSuspendDirty=!0},t.prototype._resumeDirty=function(){this._isSuspendDirty=!1},t.prototype.getValue=function(e,t){var o=this.getNode(e,t);return o&&o.value!==p&&o.value!==h?o.value:h},t.prototype.setValue=function(e,t,o){var n,r=this.getNode(e,t,!0);r.value!==o&&(n=r.value,r.value=o,this._updateDirty(e,t,{oldValue:n}))},t.prototype.getBindingPath=function(e,t){var o=this.getNode(e,t);return o&&o.bindingPath!==p&&o.bindingPath!==h?o.bindingPath:h},t.prototype.setBindingPath=function(e,t,o){var n=this.getNode(e,t,!0);n.bindingPath!==o&&(n.bindingPath=o)},t.prototype.getSparkline=function(e,t){if(e<0||t<0)return h;var o=this.dataTable[e],n=o&&o[t];return n&&n.sparkline||h},t.prototype.setSparkline=function(e,t,o){var n=this.getNode(e,t,!0);n.sparkline!==o&&(n.sparkline=o)},t.prototype.getStyle=function(e,t){var o=this.getNode(e,t);return o&&o.style},t.prototype.setStyle=function(e,t,o){var n=this.getNode(e,t,!0);n&&n.style!==o&&(n.style=o)},t.prototype.getComment=function(e,t){var o=this.getNode(e,t);return o&&o.comment},t.prototype.setComment=function(e,t,o){var n=this.getNode(e,t,!0);n&&n.comment!==o&&(n.comment=o)},t.prototype.setTag=function(e,t,o){var n=this.getNode(e,t,!0);n&&n.tag!=o&&(n.tag=o)},t.prototype.getTag=function(e,t){var o=this.getNode(e,t);return o&&o.tag!==p&&o.tag!==h?o.tag:h},t.prototype.getVisualState=function(e,t){var o=this.getNode(e,t);return o&&o.visualState},t.prototype.setVisualState=function(e,t,o){var n=this.getNode(e,t,!0);n.visualState!==o&&(n.visualState=o)},t.prototype.addRows=function(t,o){var n,r=this;if(!(t<0||t>r.rowCount||o<0))for(e._ModelHelper.addElements(r.dataTable,r.rowCount,t,o),e._ModelHelper.addElements(r._rowDataArray,r.rowCount,t,o),e._ModelHelper.addElements(r.dirtyNodes,r.rowCount,t,o),this.rowCount+=o,n=0;n<o;n++)r.dataTable[t+n]={rs:"n"},r.dirtyNodes[t+n]=r.dataTable[t+n]},t.prototype.deleteRows=function(t,o){var n=this.rowCount;t<0||t>=n||o<=0||(t+o>n&&(o=n-t),e._ModelHelper.deleteElements(this.dataTable,n,t,o),e._ModelHelper.deleteElements(this._rowDataArray,n,t,o),e._ModelHelper.deleteElements(this.dirtyNodes,n,t,o),this.rowCount-=o)},t.prototype.addColumns=function(t,o){var n,r;if(!(t<0||t>this.colCount||o<0)){for(n=0;n<this.rowCount;n++)(r=this.dataTable[n])&&t<this.colCount&&e._ModelHelper.addElements(r,this.colCount,t,o);e._ModelHelper.addElements(this._columnDataArray,this.colCount,t,o),this.colCount+=o}},t.prototype.deleteColumns=function(t,o){var n,r,i=this.colCount;if(!(t<0||t>=i||o<0)){for(n=0;n<this.rowCount;n++)(r=this.dataTable[n])&&t<this.colCount&&e._ModelHelper.deleteElements(r,this.colCount,t,o);e._ModelHelper.deleteElements(this._columnDataArray,this.colCount,t,o),t+o>i&&(o=i-t),this.colCount-=o}},t.prototype.getNode=function(e,t,o){var n,r,i=this;return e>=i.rowCount||t>=i.colCount?h:(n=h,e>=0&&t>=0?(r=i.dataTable[e],o&&!r&&(r=i.dataTable[e]={},e>i._lastNonNullRow&&(i._lastNonNullRow=e)),r&&(n=r[t],o&&!n&&(n=r[t]={},t>i._lastNonNullColumn&&(i._lastNonNullColumn=t)))):-1===e&&t>=0?(n=i._columnDataArray[t],o&&!n&&(n=i._columnDataArray[t]={},t>i._lastNonNullColumn&&(i._lastNonNullColumn=t))):e>=0&&-1===t?(n=i._rowDataArray[e],o&&!n&&(n=i._rowDataArray[e]={},t>i._lastNonNullColumn&&(i._lastNonNullColumn=t))):-1===e&&-1===t&&(n=i._defaultDataNode,o&&!n&&(n=i._defaultDataNode={})),n)},t.prototype._setNode4Swap=function(e,t,o,n,r){var i;o>=0&&n>=0?((i=this.dataTable[o])||(i=this.dataTable[o]={}),i[n]=r,r&&r.calc&&delete r.calc):o>=0&&-1===n&&e>=0&&-1===t?this._rowDataArray[o]=r:n>=0&&-1===o&&t>=0&&-1===e&&(this._columnDataArray[n]=r)},t.prototype.swapNode=function(e,t,o,n){var r=this.getNode(e,t),i=this.getNode(o,n);r?this._setNode4Swap(e,t,o,n,r):i&&this._setNode4Swap(e,t,o,n,h),i?this._setNode4Swap(o,n,e,t,i):r&&this._setNode4Swap(o,n,e,t,h)},t.prototype.getDataRowIndex=function(e){return e},t.prototype.nextNonNullRow=function(e){e++;for(var t=this.rowCount,o=this.dataTable;e>=0&&e<t&&!o[e];)e++;return e<t?e:-1},t.prototype.nextNonNullColumn=function(e,t){var o=h,n=this.colCount;if(e>=0&&e<this.rowCount&&(o=this.dataTable[e]),!o)return-1;for(t++;t>=0&&t<n&&!o[t];)t++;return t<n?t:-1},t.prototype.clear=function(t,o,n,r,i,a){var s,l,u,c=this,p=[];if(t>=0&&o>=0){if(t+n>c.rowCount&&(n=c.rowCount-t),n<=0)return;if(o+r>c.colCount&&(r=c.colCount-o),r<=0)return;for(u=t;u<t+n;u++)if(!(a&&e.ArrayHelper.indexOf(a,u)>=0))for(l=o;l<o+r;l++)(s=c.getNode(u,l))&&(p.push(s),(1&i)>0&&s.value&&s.value!==h&&c._updateDirty(u,l,{oldValue:s.value}))}else if(t>=0&&-1===o){if(t+n>c.rowCount&&(n=c.rowCount-t),n<=0)return;for(u=t;u<t+n;u++)(s=c.getNode(u,-1))&&p.push(s)}else if(-1===t&&o>=0){if(o+r>c.colCount&&(r=c.colCount-o),r<=0)return;for(l=o;l<o+r;l++)(s=c.getNode(-1,l))&&p.push(s)}else-1===t&&-1===o&&((s=c._defaultDataNode)&&p.push(s));c.clearCore(p,i)},t.prototype.clearCore=function(e,t){for(var o=0;o<e.length;o++)e[o]&&((8&t)>0&&(e[o].tag=h),(2&t)>0&&(e[o].style=h),(1&t)>0&&(e[o].value=h),(16&t)>0&&(e[o].sparkline=h),(64&t)>0&&(e[o].bindingPath=h),(4&t)>0&&(e[o].comment=h))},t.prototype.toJSON=function(t){for(var o,n,r,i,a,s,l,u,c,h,p,d=this,f={},g={},m=d.nextNonNullRow(-1);m>=0;){for(o={},c=d.nextNonNullColumn(m,-1);c>=0;)(n=d.getNode(m,c))&&(r=d._toJSONNode(n),e.GC$.isEmptyObject(r)||(o[c]=r)),c=d.nextNonNullColumn(m,c);e.GC$.isEmptyObject(o)||(g[m]=o),m=d.nextNonNullRow(m)}for(e.GC$.isEmptyObject(g)||(f.dataTable=g),i=[],a=d._rowDataArray,m=0;m<d.rowCount;m++)a.hasOwnProperty(m)&&a[m]&&(s=d._toJSONNode(a[m]),e.GC$.isEmptyObject(s)||(i[m]=s));for(i.length>0&&(f.rowDataArray=i),l=[],u=d._columnDataArray,c=0;c<d.colCount;c++)u.hasOwnProperty(c)&&u[c]&&(h=d._toJSONNode(u[c]),e.GC$.isEmptyObject(h)||(l[c]=h));return l.length>0&&(f.columnDataArray=l),p=d._toJSONNode(d._defaultDataNode,t,!0),e.GC$.isEmptyObject(p)||(f.defaultDataNode=p),f},t.prototype.fromJSON=function(e,t){var o,n,r,i,a,s,l,u,c,h,d;if(e){if(this,o=e,this._suspendDirty(),o.name!==p&&(this.name=o.name),n=o.dataTable)for(a=this.rowCount,s=this.colCount,u=0;u<a;u++)if(r=n[u])for(h=0;h<s;h++)(i=r[h])&&this._copyFromJSONNode(u,h,i,t);if(l=o.rowDataArray?o.rowDataArray:o._rowDataArray)for(u=0;u<this.rowCount;u++)l.hasOwnProperty(u)&&l[u]&&this._copyFromJSONNode(u,-1,l[u],t);if(c=o.columnDataArray?o.columnDataArray:o._columnDataArray)for(h=0;h<this.colCount;h++)c.hasOwnProperty(h)&&c[h]&&this._copyFromJSONNode(-1,h,c[h],t);(d=o.defaultDataNode?o.defaultDataNode:o._defaultDataNode)&&this._copyFromJSONNode(-1,-1,d,t),this._resumeDirty()}},t.prototype._toJSONNode=function(t,o,n){var r,i,a;return t?(r={},t.value!==p&&t.value!==h&&(r.value=t.value),"string"==typeof(i=t.style)?r.style=i:i&&(a=i.toJSON(o,n),e.GC$.isEmptyObject(a)||(r.style=a,i.font&&(r.style.font=e.StyleHelper.normalizeFont(i.font)),r.style.name=p)),t.bindingPath!==p&&t.bindingPath!==h&&(r.bindingPath=t.bindingPath),t.tag!==h&&t.tag!==p&&(r.tag=t.tag),r):h},t.prototype._copyFromJSONNode=function(t,o,n,r){var i,a,s,l,u;if(n){var c=t,d=o,f=this.getNode(c,d,!0);n.value!==p&&(n.value!=h&&(n.value._calcError||n.value._error&&n.value._code)&&((i=e.Calc.CalcError._parseCore(n.value._calcError||n.value._error))!==p&&(n.value=i)),f.value=n.value),n.style!==p&&(a=h,"string"==typeof n.style?a=n.style:n.style&&((a=new e.Style).fromJSON(n.style,r),a.name=p),f.style=a),n.visualState!==p&&(f.visualState=n.visualState),n.bindingPath!==p&&(f.bindingPath=n.bindingPath),(s=n.tag)!==p&&("string"==typeof(l=s.typeName)&&((u=e.getTypeFromString(l))&&((s=new u).fromJSON&&s.fromJSON(n.tag))),f.tag=s)}},t}(),e._GcSheetModel=l,u=function(){function e(e,t,o){this.changed=h;this._context=e,parseInt(t.toString(),10)<0&&(t=2147483647),this._maxLength=t,this._allowUndo=o,this._undoStack=[],this._redoStack=[]}return e.prototype.context=function(){return this._context},e.prototype.canUndo=function(){return this._undoStack.length>0},e.prototype.canRedo=function(){return this._redoStack.length>0},e.prototype._shrinkUndoStack=function(e){for(var t=0;t<e;t++)this._undoStack.shift()},e.prototype._raiseChanged=function(){this.changed&&"function"==typeof this.changed&&this.changed(this)},e.prototype.doAction=function(e){var t,o;if(!e||!e.execute||(t=this,!e.canExecute(t._context)))return!1;o=!0;try{e.execute(t._context)}catch(e){o=!1}return t._allowUndo&&o&&e.canUndo()&&e.undo&&(t._maxLength>0&&t._undoStack.length>=t._maxLength&&t._shrinkUndoStack(t._undoStack.length-t._maxLength+1),t._undoStack.push(e),t._redoStack=[],t._raiseChanged()),o},e.prototype.undo=function(){var e,t=!0;if(this._allowUndo&&this.canUndo()){e=this._undoStack[this._undoStack.length-1];try{e&&e.canUndo&&e.canUndo()&&e.undo&&(t=e.undo(this._context))}catch(e){t=!1}t&&(this._redoStack.push(this._undoStack.pop()),this._raiseChanged())}return t},e.prototype.redo=function(){var e,t=!0;if(this._allowUndo&&this.canRedo()){e=this._redoStack[this._redoStack.length-1];try{e&&e.execute&&e.execute(this._context)}catch(e){t=!1}t&&(this._undoStack.push(this._redoStack.pop()),this._raiseChanged())}return t},e.prototype.getUndoList=function(){return this._undoStack.slice(0)},e.prototype.getRedoList=function(){return this._redoStack.slice(0)},e.prototype.clear=function(){this._undoStack=[],this._redoStack=[]},e}(),e._UndoManager=u,c=function(){function t(){this._infos=[]}return t.prototype.addItems=function(t,o){t<0||t>this.length||o<0||(e._ModelHelper.addElements(this._infos,this.length,t,o),this.length+=o)},t.prototype.deleteItems=function(t,o){var n=this.length;t<0||t>=n||o<=0||(t+o>n&&(o=n-t),t,e._ModelHelper.deleteElements(this._infos,n,t,o),this.length-=o)},t.prototype.reset=function(e){this._infos.length>e&&(this._infos[e]=null)},t.prototype._getItems=function(){return this._infos},t.prototype._setItems=function(e){this._infos=e,this.length=e.length},t.prototype._getItem=function(e){return this._infos[e]},t.prototype._setItem=function(e,t){this._infos[e]=t,this.length=this._infos.length},t.prototype.getSize=function(e){var t=this._infos[e];return t?!1===t.visible?0:Math.floor(t.size):null},t.prototype.getActualSize=function(e){var t=this._infos[e];return t?Math.floor(t.size):null},t.prototype.setSize=function(e,t){var o=this._infos[e];o||(this._infos[e]=o={},this.length=this._infos.length),o.size!==t&&(o.size=t)},t.prototype.getVisible=function(e){var t=!0,o=this._infos[e];return o&&o.visible!==p&&o.visible!==h&&(t=o.visible),t},t.prototype.setVisible=function(e,t){var o=this._infos[e];o||(this._infos[e]=o={},this.length=this._infos.length),o.visible!==t&&(o.visible=t)},t.prototype.getResizeable=function(e){var t=!0,o=this._infos[e];return o&&o.resizable!==p&&o.resizable!==h&&(t=o.resizable),t},t.prototype.setResizeable=function(e,t){var o=this._infos[e];o||(this._infos[e]=o={},this.length=this._infos.length),o.resizable!=t&&(o.resizable=t)},t.prototype.getPageBreak=function(e){var t=!1,o=this._infos[e];return o&&o.pageBreak!==p&&o.pageBreak!==h&&(t=o.pageBreak),t},t.prototype.setPageBreak=function(e,t){var o=this._infos[e];o||(this._infos[e]=o={},this.length=this._infos.length),o.pageBreak!=t&&(o.pageBreak=t)},t}(),e._AxieModel=c}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){function o(e,t){if(e){if(2===e._editorStatus)return!1;var o=e._formulaTextBox;return o&&o.canAppendRange()?(e._moveFormulaTextBoxCell(t,!1),!0):(o&&(e=a.handleFormulaTextboxAcrossSheet(e)),e.moveActiveCell(t,!1),!0)}return!1}function n(e,t,o,n){if(e){if(2===e._editorStatus)return!1;var r=e._formulaTextBox;return r&&r.canAppendRange()?(e._moveFormulaTextBoxCell(t,!1,o,n),!0):(r&&(e=a.handleFormulaTextboxAcrossSheet(e)),e.moveActiveCell(t,!1,o,n),!0)}return!1}function r(e,t,o){if(e){if(2===e._editorStatus)return!1;var n=e._formulaTextBox;return n&&n.canAppendRange()?(e._changeFormulaTextBoxActiveRange(t,o),!0):(n&&(e=a.handleFormulaTextboxAcrossSheet(e)),!!e.endEdit()&&(e._changeActiveSelectedRange(t,o),!0))}return!1}var i,a;t.feature("core.sheet_action",["core.common","core.sheet_model"]),i=null,a=function(){function a(){}return a.navigationLeft=function(){return o(this,3)},a.navigationRight=function(){return o(this,4)},a.navigationUp=function(){return o(this,1)},a.navigationDown=function(){return o(this,2)},a.commitArrayFormula=function(){return a.handleFormulaTextboxAcrossSheet(this).commitArrayFormula(),!0},a.commitInputNavigationDown=function(){return a.handleFormulaTextboxAcrossSheet(this).moveActiveCell(2,!1),!0},a.commitInputNavigationUp=function(){return a.handleFormulaTextboxAcrossSheet(this).moveActiveCell(1,!1),!0},a.handleFormulaTextboxAcrossSheet=function(e){var o=e,n=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance;return t.features.formulatextbox&&n&&n.text&&(o=n.sheet,a.changeSheetForFormulaTextboxAcrossSheet(o)),o},a.changeSheetForFormulaTextboxAcrossSheet=function(e,o){void 0===o&&(o=!0);var n=e.parent,r=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance;t.features.formulatextbox&&r&&r.text&&n._changeSheetForFormulaAcrossSheet(e,o)},a.navigationHome=function(){return n(this,4,i,this.frozenColCount?this.frozenColCount-1:-1)},a.navigationHome2=function(){return n(this,4,i,-1)},a.navigationEnd=function(){return n(this,3,i,this.getColumnCount()-this._frozenTrailingColCount)},a.navigationEnd2=function(){return n(this,3,i,this.getColumnCount())},a.navigationTop=function(){return n(this,2,-1,i)},a.navigationBottom=function(){return n(this,1,this.getRowCount(),i)},a.navigationPageUp=function(){var e,o,n,r,s,l,u=this;return!(!u||2===u._editorStatus)&&((e=u._getPrevPageTopRow())===i||e===u._scrollTopRow||(o=u._getRowLayout(1,3),(n=u._getNextVisualRow(u._activeRowIndex-o.length))<e&&(n=e),(r=u._formulaTextBox)&&r.canAppendRange()?((s=u._getKeyboardAppendingInfo()).anchorRow=n,s.leadingRow=n,(l=u._eventHandler.rangeToString(new t.Range(s.anchorRow,s.anchorCol,1,1)))&&r.appendRange(l,!1,!0),u._setTopRow(e),!0):(r&&(u=a.handleFormulaTextboxAcrossSheet(u)),!!u.endEdit()&&(u.canSelect(n,u.getActiveColumnIndex())&&(u._setActiveCellCore(n,i),u._leadingCellRow=n,u.moveActiveCell()),u._setTopRow(e),!0))))},a.navigationPageDown=function(){var e,o,n,r,s,l,u=this;return!(!u||2===u._editorStatus)&&((e=u._getNextPageTopRow())===i||e===u._scrollTopRow||(o=u._getRowLayout(1,3),(n=u._getPrevVisualRow(u._activeRowIndex+o.length))<e&&(n=e),(r=u._formulaTextBox)&&r.canAppendRange()?((s=u._getKeyboardAppendingInfo()).anchorRow=n,s.leadingRow=n,(l=u._eventHandler.rangeToString(new t.Range(s.anchorRow,s.anchorCol,1,1)))&&r.appendRange(l,!1,!0),u._setTopRow(e),!0):(r&&(u=a.handleFormulaTextboxAcrossSheet(u)),!!u.endEdit()&&(u.canSelect(n,u.getActiveColumnIndex())&&(u._setActiveCellCore(n,i),u._leadingCellRow=n,u.moveActiveCell()),u._setTopRow(e),!0))))},a.navigationNextSheet=function(){var t,o,n=this.parent,r=e.Sheets;(n||n instanceof r.Spread)&&(t=n.getSheetCount(),(o=n.getActiveSheetIndex())<t-1&&(o++,n._setActiveSheetIndexImp(o,1),n.repaint()))},a.navigationPreviousSheet=function(){var t,o=this.parent,n=e.Sheets;(o||o instanceof n.Spread)&&((t=o.getActiveSheetIndex())>0&&(t--,o._setActiveSheetIndexImp(t,1),o.repaint()))},a.navigationPrevious=function(){},a.navigationNext=function(){},a.navigationFirst=function(){var e,t=this;if(!t||2===t._editorStatus)return!1;t.frozenColCount&&t.frozenColCount,t.frozenRowCount&&t.frozenRowCount;var o=t._formulaTextBox,n=t._activeRowIndex,r=t._activeColIndex;return o&&o.canAppendRange()?(e=t._eventHandler,o.isAppending?e._formulaRangeAppendingInfo:e._formulaRangeAppendingInfo={anchorRow:n,anchorCol:r,leadingRow:t._leadingCellRow,leadingCol:t._leadingCellCol},t._moveFormulaTextBoxCell(5,!1,n,r),!0):(o&&(t=a.handleFormulaTextboxAcrossSheet(t)),t.moveActiveCell(5,!1,n,r),!0)},a.navigationLast=function(){var e,t=this;if(!t||2===t._editorStatus)return!1;var o=t._formulaTextBox,n=t._activeRowIndex,r=t._activeColIndex;return o&&o.canAppendRange()?(e=t._eventHandler,o.isAppending?e._formulaRangeAppendingInfo:e._formulaRangeAppendingInfo={anchorRow:n,anchorCol:r,leadingRow:t._leadingCellRow,leadingCol:t._leadingCellCol},t._moveFormulaTextBoxCell(6,!1,n,r),!0):(o&&(t=a.handleFormulaTextboxAcrossSheet(t)),t.moveActiveCell(6,!1,n,r),!0)},a.commitInputNavigationTabNext=function(){var e=a.handleFormulaTextboxAcrossSheet(this);e._isTabNavigation=!0,e._isNavigateInSelection?e._moveActiveCellInSelection(4):e.moveActiveCell(4,!0),e._isTabNavigation=!1},a.commitInputNavigationTabPrevious=function(){var e=a.handleFormulaTextboxAcrossSheet(this);e._isTabNavigation=!0,e._isNavigateInSelection?e._moveActiveCellInSelection(3):e.moveActiveCell(3,!0),e._isTabNavigation=!1},a.selectNextControl=function(){var e,o,n,r;return!!this.endEdit()&&((e=this._eventHandler).clearRepeatKeyDownTimeout(),e.resetMetaKeyState(),t.FocusHelper.setActiveElement(i),o=!1,(n=this.parent)&&((r=n.nextControl())&&r.focus?(r.focus(),o=!0):n.focusTabFocusElement()),o)},a.selectPreviousControl=function(){var e,o,n,r;if(this.endEdit())return(e=this._eventHandler).clearRepeatKeyDownTimeout(),e.resetMetaKeyState(),t.FocusHelper.setActiveElement(i),o=!1,(n=this.parent)&&((r=n.previousControl())&&r.focus?(r.focus(),o=!0):n.focusTabFocusElement()),o},a.moveToNextCell=function(){return a.commitInputNavigationTabNext.apply(this),!0},a.moveToPreviousCell=function(){return a.commitInputNavigationTabPrevious.apply(this),!0},a.moveToNextCellThenControl=function(){var e,t=this._leadingCellRow;return this._isTabNavigation=!0,e=this._getMoveRightCell(this.getActiveRowIndex(),this.getActiveColumnIndex(),!0,t),this._isTabNavigation=!1,!e||e.leadingCellRow<t?a.selectNextControl.apply(this):a.moveToNextCell.apply(this)},a.moveToPreviousCellThenControl=function(){var e,t=this._leadingCellRow;return this._isTabNavigation=!0,e=this._getMoveLeftCell(this.getActiveRowIndex(),this.getActiveColumnIndex(),!0,t),this._isTabNavigation=!1,!e||e.leadingCellRow>t?a.selectPreviousControl.apply(this):a.moveToPreviousCell.apply(this)},a.cancelInput=function(){var e,o,n,r,i,s,l,u,c=this,h=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance;if(t.features.formulatextbox&&h&&h.text&&(c=h.sheet,e=h.rowIndex,o=h.columnIndex,a.changeSheetForFormulaTextboxAcrossSheet(c,!1),c._detachFormulaTextBox(),c._setActiveCellAndSelection(e,o,void 0,void 0,1)),c.isEditing())return n=c.getValue(c._activeRowIndex,c._activeColIndex,3),!!c.endEdit(!0)&&(c.setValue(c._activeRowIndex,c._activeColIndex,n,3,!0),!0);if((r=c.parent)&&r.sheets)for(s=0,l=(i=r.sheets).length;s<l;s++)(u=i[s])&&u._cutCopyIndicatorManager.cancelIndicator()},a.clear=function(){var e,o;this.isEditing()||(e=this.getSelections(),(o=new t.UndoRedo.ClearValueUndoAction(this,e)).canExecute(this)&&this._doCommand(o))},a.clearAndEditing=function(){return!this.isEditing()&&(t.util.isMacOS()?(a.clear.call(this),!0):(this.startEdit(!0,""),!0))},a.copy=function(){this._doCopy()},a.cut=function(){this._doCut()},a.paste=function(){this._doPaste()},a.selectionLeft=function(){return r(this,37)},a.selectionRight=function(){return r(this,39)},a.selectionUp=function(){return r(this,38)},a.selectionDown=function(){return r(this,40)},a.selectionHome=function(){return r(this,37,!0)},a.selectionEnd=function(){return r(this,39,!0)},a.selectionPageUp=function(){return r(this,33)},a.selectionPageDown=function(){return r(this,34)},a.selectionTop=function(){return r(this,38,!0)},a.selectionBottom=function(){return r(this,40,!0)},a.selectionFirst=function(){return r(this,36,!0)},a.selectionLast=function(){return r(this,35,!0)},a.unSelectAllFloatingObjects=function(){this._hasFloatingObjectsSelected()&&(this._suspendInvalidate(),this.unSelectAllFloatingObjects(),this._loadAndSetSheetSelections(),this._resumeInvalidate())},a.selectAllFloatingObjects=function(){var e,t,o;if(this._hasFloatingObjectsSelected()){for(this._suspendInvalidate(),e=0,t=this._floatingObjectArray.length;e<t;e++)(o=this._floatingObjectArray[e]).isSelected()||o.isSelected(!0);this._resumeInvalidate()}},a.deleteFloatingObject=function(){var e,o,n=function(e){for(var t,o=[],n=0,r=e._floatingObjectArray.length;n<r;n++)(t=e._floatingObjectArray[n]).isSelected()&&o.push(t.name());return o}(this);n.length>0&&(e={names:n},o=new t.UndoRedo.DeleteFloatingObjectUndoAction(this,e),this._doCommand(o))},a.navigationNextFloatingObject=function(){var e,t,o;if(this._hasFloatingObjectsSelected()){for(this._suspendInvalidate(),o=0,e=0,t=this._floatingObjectArray.length;e<t;e++)this._floatingObjectArray[e].isSelected()&&(o=e);return this.unSelectAllFloatingObjects(),(o+=1)==this._floatingObjectArray.length&&(o=0),this._floatingObjectArray[o].isSelected(!0),this._resumeInvalidate(),!0}return!1},a.navigationPreviousFloatingObject=function(){var e,t,o;if(this._hasFloatingObjectsSelected()){for(this._suspendInvalidate(),o=0,e=0,t=this._floatingObjectArray.length;e<t;e++)this._floatingObjectArray[e].isSelected()&&(o=e);return this.unSelectAllFloatingObjects(),(o-=1)<0&&(o=this._floatingObjectArray.length-1),this._floatingObjectArray[o].isSelected(!0),this._resumeInvalidate(),!0}return!1},a.clipboardCutFloatingObject=function(){this._doFloatingObjectCut()},a.clipboardCopyFloatingObject=function(){this._doFloatingObjectCopy()},a.clipboardPasteFloatingObject=function(){this._doFloatingObjectPaste()},a.moveFloatingObjectUp=function(){for(var e,o,n=[],r=0,i=this._floatingObjectArray.length;r<i;r++)(e=this._floatingObjectArray[r]).isSelected()&&n.push(e.name());o=new t.UndoRedo.MovingFloatingObjectUndoAction(this,{names:n},{offsetX:0,offsetY:-1}),this._doCommand(o)},a.moveFloatingObjectDown=function(){for(var e,o,n=[],r=0,i=this._floatingObjectArray.length;r<i;r++)(e=this._floatingObjectArray[r]).isSelected()&&n.push(e.name());o=new t.UndoRedo.MovingFloatingObjectUndoAction(this,{names:n},{offsetX:0,offsetY:1}),this._doCommand(o)},a.moveFloatingObjectLeft=function(){for(var e,o,n=[],r=0,i=this._floatingObjectArray.length;r<i;r++)(e=this._floatingObjectArray[r]).isSelected()&&n.push(e.name());o=new t.UndoRedo.MovingFloatingObjectUndoAction(this,{names:n},{offsetX:-1,offsetY:0}),this._doCommand(o)},a.moveFloatingObjectRight=function(){for(var e,o,n=[],r=0,i=this._floatingObjectArray.length;r<i;r++)(e=this._floatingObjectArray[r]).isSelected()&&n.push(e.name());o=new t.UndoRedo.MovingFloatingObjectUndoAction(this,{names:n},{offsetX:1,offsetY:0}),this._doCommand(o)},a.unfilterSlicer=function(){var e,o,n,r=this&&this._slicerCollection,i=r&&r.getSelectedSlicers();1===i.length&&(o=(e=i[0]).getSlicerData())&&(n=o.getFilteredIndexes(e.columnName()),this._doCommand(new t.UndoRedo.SlicerDataUnFilterUndoAction(this,o,e.columnName(),n)))},a.deleteComment=function(){var e,o=this._commentManager.getActiveComment();o&&(e=new t.UndoRedo.CommentDeleteUndoAction(this,o),this._doCommand(e))},a.deactivateComment=function(){this._commentManager.deactivateComment(),this._loadAndSetSheetSelections(),this.repaint()},a.moveCommentUp=function(){var e,o=this._commentManager.getActiveComment();o&&(e=new t.UndoRedo.CommentPropertyUndoAction(this,o,o.location().clone(),new t.Point(o.location().x,o.location().y-1),"location"),this._doCommand(e))},a.moveCommentDown=function(){var e,o=this._commentManager.getActiveComment();o&&(e=new t.UndoRedo.CommentPropertyUndoAction(this,o,o.location().clone(),new t.Point(o.location().x,o.location().y+1),"location"),this._doCommand(e))},a.moveCommentLeft=function(){var e,o=this._commentManager.getActiveComment();o&&(e=new t.UndoRedo.CommentPropertyUndoAction(this,o,o.location().clone(),new t.Point(o.location().x-1,o.location().y),"location"),this._doCommand(e))},a.moveCommentRight=function(){var e,o=this._commentManager.getActiveComment();o&&(e=new t.UndoRedo.CommentPropertyUndoAction(this,o,o.location().clone(),new t.Point(o.location().x+1,o.location().y),"location"),this._doCommand(e))},a.changeFormulaReference=function(){var e;if(this&&this._formulaTextBox&&(e=this._eventHandler)){this._suspendInvalidate();try{e.changeFormulaReference()}finally{this._resumeInvalidate()}}},a.undo=function(){var e=this.undoManager();e.canUndo()&&e.undo()},a.redo=function(){var e=this.undoManager();e.canRedo()&&e.redo()},a}(),t.SpreadActions=a}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){var o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O,P,L,H,k,V,B,z,G,W,j,U,Y,X,K,J,Z,q,$,Q,ee,te,oe,ne,re,ie,ae,se,le,ue,ce;o=t.UndoRedo||(t.UndoRedo={}),ie=null,ae=void 0,se=Math.min,le=Math.max,Math.ceil,ue=Math.floor,ce=function(){return function(e,t,o){this.row=e,this.column=t,this.value=o}}(),o.CellData=ce,n=function(){function e(e,t,o){this.sheet=e,this.range=t,this.dataType=o,this.cellsHasData=[],this.changedCells=[],this.initCellsHasData()}return e.prototype.initCellsHasData=function(){var e,t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_=this,y=_.range,C=_.sheet;if(C&&y){var w=_.dataType,v=y.row,S=y.col,x=y.rowCount,R=y.colCount,b=_.cellsHasData,T=!1;if(-1===v&&(T=!0,v=0,x=C.getRowCount()),-1===S&&(T=!0,S=0,R=C.getColumnCount()),C.getDefaultStyle(),t=[],(64&w)>0)for(i=0;i<R;i++)t[i]=C.getStyleObject(-1,i)||ie;for(n=0;n<x;n++)for(r=v+n,(64&w)>0&&(e=C.getStyleObject(r,-1)||ie),i=0;i<R;i++){if(s=S+i,(2&w)>0&&(a=C.getFormulaInformation(r,s)).hasFormula)if(a.isArrayFormula){if((l=a.baseRange).row===r&&l.col===s)for(u=l.row,c=l.row+l.rowCount;u<c;u++)for(h=l.col,p=l.col+l.colCount;h<p;h++)_.setCellDatas(b,u-v,h-S,a,2)}else _.setCellDatas(b,n,i,a.formula,2);(1&w)>0&&(!a||!a.hasFormula)&&_.setCellDatas(b,n,i,C.getValue(r,s,3),1),(16&w)>0&&(d=C.getSparkline(r,s),f=ie,d&&(f=d.data()),d&&f&&_.setCellDatas(b,n,i,d,16)),(64&w)>0&&(T?g=C.getActualStyle(r,s,3):(o=C.getStyleObject(r,s)||ie,g=C.getCompositeStyle(r,s,3,o,e,t[i])),m=ae,g&&g.toJSON&&(m=JSON.stringify(g.toJSON(3,!0))),_.setCellDatas(b,n,i,m,64)),(4&w)>0&&_.setCellDatas(b,n,i,C.getComment(r,s),4),(128&w)>0&&_.setCellDatas(b,n,i,C.getTag(r,s,3),128),(256&w)>0&&_.setCellDatas(b,n,i,C.getBindingPath(r,s,3),256)}}},e.prototype.getCellsHasData=function(){return this.cellsHasData},e.prototype.setCellDatas=function(e,o,n,r,i){r!==ae&&r!==ie&&e&&(e[o]===ae&&(e[o]=[]),e[o][n]===ae&&(e[o][n]={}),e[o][n][t.CopyToOption[i]]=r)},e.prototype.mergeCellsHasDiffData=function(e){var t,o,n,r,i,a,s,l;if(e)for(t=this.cellsHasData,o=0,n=e.length;o<n;o++)if(r=e[o])for(i=0,a=r.length;i<a;i++)(s=r[i])&&(t[o]||(t[o]=[]),(l=t[o][i])?this.isDataEqual(s,l)&&(t[o][i]=ae):t[o][i]=s)},e.prototype.isDataEqual=function(e,o){var n,r,i,a=this.dataType,s=[];for(256&a&&s.push(t.CopyToOption[256]),4&a&&s.push(t.CopyToOption[4]),2&a&&s.push(t.CopyToOption[2]),16&a&&s.push(t.CopyToOption[16]),64&a&&s.push(t.CopyToOption[64]),128&a&&s.push(t.CopyToOption[128]),1&a&&s.push(t.CopyToOption[1]),n=0,r=s.length;n<r;n++)if(e[i=s[n]]!==o[i])return!1;return!0},e.prototype.getChangedCells=function(){var e,o,n,r,i,a=[],s=this.range.row,l=this.range.col,u=this.cellsHasData;if(this.changedCells&&this.changedCells.length>0)return this.changedCells;for(s=-1===s?0:s,l=-1===l?0:l,e=0,o=u.length;e<o;e++)if(n=u[e])for(r=0,i=n.length;r<i;r++)n[r]&&a.push(new t.CellPosition(e+s,r+l));return this.changedCells=a,a},e}(),o.ChangedCells=n,r=function(){function e(){}return e.prototype.saveDefaultStyle=function(e){this._defaultStyle=e,this._defaultStyleSaved=!0},e.prototype.getDefaultStyle=function(){return this._defaultStyle},e.prototype.saveDefaultColumnWidth=function(e){this._defaultColumnWidth=e,this._defaultColumnWidthSaved=!0},e.prototype.getDefaultColumnWidth=function(){return this._defaultColumnWidth},e.prototype.saveDefaultRowHeight=function(e){this._defaultRowHeight=e,this._defaultRowHeightSaved=!0},e.prototype.getDefaultRowHeight=function(){return this._defaultRowHeight},e.prototype.getTag=function(){return this._tag},e.prototype.saveColumnHeaderDefaultStyle=function(e){this._columnHeaderDefaultStyle=e,this._columnHeaderDefaultStyleSaved=!0},e.prototype.getColumnHeaderDefaultStyle=function(){return this._columnHeaderDefaultStyle},e.prototype.saveColumnHeaderDefaultRowHeight=function(e){this._columnHeaderDefaultRowHeight=e,this._columnHeaderDefaultRowHeightSaved=!0},e.prototype.getColumnHeaderDefaultRowHeight=function(){return this._columnHeaderDefaultRowHeight},e.prototype.saveRowHeaderDefaultStyle=function(e){this._rowHeaderDefaultStyle=e,this._rowHeaderDefaultStyleSaved=!0},e.prototype.getRowHeaderDefaultStyle=function(){return this._rowHeaderDefaultStyle},e.prototype.saveRowHeaderDefaultColumnWidth=function(e){this._rowHeaderDefaultColumnWidth=e,this._rowHeaderDefaultColumnWidthSaved=!0},e.prototype.getRowHeaderDefaultColumnWidth=function(){return this._rowHeaderDefaultColumnWidth},e.prototype.saveCommentManager=function(e){this._commentManager=e,this._commentManagerSaved=!0},e.prototype.saveTag=function(e){this._tag=e,this._tagSaved=!0},e.prototype.isDefaultStyleSaved=function(){return this._defaultStyleSaved},e.prototype.isDefaultColumnWidthSaved=function(){return this._defaultColumnWidthSaved},e.prototype.isDefaultRowHeightSaved=function(){return this._defaultRowHeightSaved},e.prototype.isColumnHeaderDefaultStyleSaved=function(){return this._columnHeaderDefaultStyleSaved},e.prototype.isColumnHeaderDefaultRowHeightSaved=function(){return this._columnHeaderDefaultRowHeightSaved},e.prototype.isRowHeaderDefaultStyleSaved=function(){return this._rowHeaderDefaultStyleSaved},e.prototype.isRowHeaderDefaultColumnWidthSaved=function(){return this._rowHeaderDefaultColumnWidthSaved},e.prototype.isCommentManagerSaved=function(){return this._commentManagerSaved},e.prototype.isTagSaved=function(){return this._tagSaved},e}(),o.CopyMoveSheetInfo=r,i=function(){function e(e,t){this._rowCount=e,this._columnCount=t,this._init()}return e.prototype._init=function(){var e=this;e._values=[],e._formulas=[],e._sparklines=[],e._styles=[],e._comments=[],e._tags=[],e._bindingPaths=[],e._spans=ie,e._arrayFormulas=[],e._valueSaved=!1,e._formulaSaved=!1,e._sparklineSaved=!1,e._styleSaved=!1,e._commentSaved=!1,e._tagSaved=!1,e._spanSaved=!1,e._arrayFormulaSaved=!1,e._bindingPathSaved=!1},e.prototype.saveValue=function(e,t,o){o!==ae&&o!==ie&&this._values.push(new ce(e,t,o)),this._valueSaved=!0},e.prototype.getValues=function(){return this._values},e.prototype.saveFormula=function(e,t,o){o&&""!==o&&this._formulas.push(new ce(e,t,o)),this._formulaSaved=!0},e.prototype.getFormulas=function(){return this._formulas},e.prototype.saveArrayFormula=function(e){this._arrayFormulas.push(e),this._arrayFormulaSaved=!0},e.prototype.getArrayFormula=function(){return this._arrayFormulas},e.prototype.saveSparkline=function(e,t,o){o&&this._sparklines.push(new ce(e,t,o)),this._sparklineSaved=!0},e.prototype.getSparklines=function(){return this._sparklines},e.prototype.saveStyle=function(e,t,o){o&&this._styles.push(new ce(e,t,o)),this._styleSaved=!0},e.prototype.getStyles=function(){return this._styles},e.prototype.saveComment=function(e,t,o){o&&this._comments.push(new ce(e,t,o)),this._commentSaved=!0},e.prototype.getComments=function(){return this._comments},e.prototype.saveTag=function(e,t,o){o!==ae&&o!==ie&&this._tags.push(new ce(e,t,o)),this._tagSaved=!0},e.prototype.getTags=function(){return this._tags},e.prototype.saveBindingPath=function(e,t,o){o!==ae&&o!==ie&&this._bindingPaths.push(new ce(e,t,o)),this._bindingPathSaved=!0},e.prototype.getBindingPaths=function(){return this._bindingPaths},e.prototype.saveSpan=function(e){this._spans||(this._spans=[]),this._spans.push(e),this._spanSaved=!0},e.prototype.isValueOrFormulaSaved=function(){return this._valueSaved||this._formulaSaved||this._arrayFormulaSaved},e.prototype.isValueSaved=function(){return this._valueSaved},e.prototype.isFormulaSaved=function(){return this._formulaSaved},e.prototype.isArrayFormulaSaved=function(){return this._arrayFormulaSaved},e.prototype.isSparklineSaved=function(){return this._sparklineSaved},e.prototype.isStyleSaved=function(){return this._styleSaved},e.prototype.isCommentSaved=function(){return this._commentSaved},e.prototype.isTagSaved=function(){return this._tagSaved},e.prototype.isSpanSaved=function(){return this._spanSaved},e.prototype.isBindingPathSaved=function(){return this._bindingPathSaved},e}(),o.CopyMoveCellsInfo=i,a=function(){function e(e){this._columnCount=e,this._init()}return e.prototype._init=function(){var e=this;e._widths={},e._visibles={},e._resizables={},e._tags={},e._viewportColumnStyles={},e._headerColumnStyles={},e._levels={},e._collapsed={},e._bindingFields={},e._widthSaved=!1,e._visibleSaved=!1,e._resizableSaved=!1,e._tagSaved=!1,e._viewportColumnStyleSaved=!1,e._headerColumnStyleSaved=!1,e._rangeGroupSaved=!1,e._bindingFieldSaved=!1},e.prototype.saveWidth=function(e,t){this._widths[e]!==ie?this._widths[e]=t<0?ie:t:t>=0&&(this._widths[e]=t),this._widthSaved=!0},e.prototype.getWidth=function(e){return this._widths[e]!==ie?this._widths[e]:-1},e.prototype.saveVisible=function(e,t){this._visibles[e]!==ie?this._visibles[e]=t?ie:t:t||(this._visibles[e]=t),this._visibleSaved=!0},e.prototype.getVisible=function(e){return this._visibles[e]===ie||this._visibles[e]},e.prototype.saveResizable=function(e,t){this._resizables[e]!==ie?this._resizables[e]=t?ie:t:t||(this._resizables[e]=t),this._resizableSaved=!0},e.prototype.getResizable=function(e){return this._resizables[e]===ie||this._resizables[e]},e.prototype.saveTag=function(e,t){this._tags[e]=t!==ae&&t!==ie?t:ie,this._tagSaved=!0},e.prototype.getTag=function(e){return this._tags[e]},e.prototype.saveViewportColumnStyle=function(e,t){this._viewportColumnStyles[e]?this._viewportColumnStyles[e]=t||ie:t&&(this._viewportColumnStyles[e]=t),this._viewportColumnStyleSaved=!0},e.prototype.getViewportColumnStyle=function(e){return this._viewportColumnStyles[e]?this._viewportColumnStyles[e]:ie},e.prototype.saveHeaderColumnStyle=function(e,t){this._headerColumnStyles[e]?this._headerColumnStyles[e]=t||ie:t&&(this._headerColumnStyles[e]=t),this._headerColumnStyleSaved=!0},e.prototype.getHeaderColumnStyle=function(e){return this._headerColumnStyles[e]?this._headerColumnStyles[e]:ie},e.prototype.saveRangeGroup=function(e,t,o){this._levels[e]!==ie?this._levels[e]=t<0?ie:t:t>=0&&(this._levels[e]=t),this._collapsed[e]!==ie?this._collapsed[e]=o||ie:o&&(this._collapsed[e]=o),this._rangeGroupSaved=!0},e.prototype.getRangeGroup=function(e,t){t.level=-1,t.collapsed=!1,this._levels[e]!==ie&&(t.level=this._levels[e]),this._collapsed[e]!==ie&&(t.collapsed=this._collapsed[e])},e.prototype.saveBindingField=function(e,t){this._bindingFields[e]=t,this._bindingFieldSaved=!0},e.prototype.getBindingField=function(e,t){return t.fieldName=ie,this._bindingFields[e]!==ie&&(t.fieldName=this._bindingFields[e],!0)},e.prototype.isWidthSaved=function(){return this._widthSaved},e.prototype.isVisibleSaved=function(){return this._visibleSaved},e.prototype.isResizableSaved=function(){return this._resizableSaved},e.prototype.isTagSaved=function(){return this._tagSaved},e.prototype.isViewportColumnStyleSaved=function(){return this._viewportColumnStyleSaved},e.prototype.isHeaderColumnStyleSaved=function(){return this._headerColumnStyleSaved},e.prototype.isRangeGroupSaved=function(){return this._rangeGroupSaved},e.prototype.isBindingFieldSaved=function(){return this._bindingFieldSaved},e}(),o.CopyMoveColumnsInfo=a,s=function(){function e(e){this._rowCount=e,this._init()}return e.prototype._init=function(){var e=this;e._heights={},e._visibles={},e._resizables={},e._tags={},e._viewportRowStyles={},e._headerRowStyles={},e._levels={},e._collapsed={},e._heightSaved=!1,e._visibleSaved=!1,e._resizableSaved=!1,e._tagSaved=!1,e._viewportRowStyleSaved=!1,e._headerRowStyleSaved=!1,e._rangeGroupSaved=!1},e.prototype.saveHeight=function(e,t){this._heights[e]!==ie?this._heights[e]=t<0?ie:t:t>=0&&(this._heights[e]=t),this._heightSaved=!0},e.prototype.getHeight=function(e){return this._heights[e]!==ie?this._heights[e]:-1},e.prototype.saveVisible=function(e,t){this._visibles[e]!==ie?this._visibles[e]=t?ie:t:t||(this._visibles[e]=t),this._visibleSaved=!0},e.prototype.getVisible=function(e){return this._visibles[e]===ie||this._visibles[e]},e.prototype.saveResizable=function(e,t){this._resizables[e]!==ie?this._resizables[e]=t?ie:t:t||(this._resizables[e]=t),this._resizableSaved=!0},e.prototype.getResizable=function(e){return this._resizables[e]===ie||this._resizables[e]},e.prototype.saveTag=function(e,t){this._tags[e]=t!==ae&&t!==ie?t:ie,this._tagSaved=!0},e.prototype.getTag=function(e){return this._tags[e]},e.prototype.saveViewportRowStyle=function(e,t){this._viewportRowStyles[e]?this._viewportRowStyles[e]=t||ie:t&&(this._viewportRowStyles[e]=t),this._viewportRowStyleSaved=!0},e.prototype.getViewportRowStyle=function(e){return this._viewportRowStyles[e]?this._viewportRowStyles[e]:ie},e.prototype.saveHeaderRowStyle=function(e,t){this._headerRowStyles[e]?this._headerRowStyles[e]=t||ie:t&&(this._headerRowStyles[e]=t),this._headerRowStyleSaved=!0},e.prototype.getHeaderRowStyle=function(e){return this._headerRowStyles[e]?this._headerRowStyles[e]:ie},e.prototype.saveRangeGroup=function(e,t,o){this._levels[e]!==ie?this._levels[e]=t<0?ie:t:t>=0&&(this._levels[e]=t),this._collapsed[e]!==ie?this._collapsed[e]=o||ie:o&&(this._collapsed[e]=o),this._rangeGroupSaved=!0},e.prototype.getRangeGroup=function(e,t){t.level=-1,t.collapsed=!1,this._levels[e]!==ie&&(t.level=this._levels[e]),this._collapsed[e]!==ie&&(t.collapsed=this._collapsed[e])},e.prototype.isHeightSaved=function(){return this._heightSaved},e.prototype.isVisibleSaved=function(){return this._visibleSaved},e.prototype.isResizableSaved=function(){return this._resizableSaved},e.prototype.isTagSaved=function(){return this._tagSaved},e.prototype.isViewportRowStyleSaved=function(){return this._viewportRowStyleSaved},e.prototype.isHeaderRowStyleSaved=function(){return this._headerRowStyleSaved},e.prototype.isRangeGroupSaved=function(){return this._rangeGroupSaved},e}(),o.CopyMoveRowsInfo=s,l=function(){function e(){}return e.getStyleObject=function(e,t,o,n){return e.getStyleObject(t,o,n)},e.setStyleObject=function(e,t,o,n,r){e.setStyleObject(t,o,r,n)},e.getComment=function(e,t,o){return e.getComment(t,o)},e.setComment=function(e,t,o,n){e.setComment(t,o,n)},e.saveSheetInfo=function(e,t,o){(64&o)>0&&(t.saveDefaultStyle(e.getDefaultStyle()),t.saveColumnHeaderDefaultStyle(e.getDefaultStyle(1)),t.saveRowHeaderDefaultStyle(e.getDefaultStyle(2))),(128&o)>0&&t.saveTag(e.tag()),t.saveDefaultColumnWidth(e.defaults.colWidth),t.saveDefaultRowHeight(e.defaults.rowHeight),t.saveColumnHeaderDefaultRowHeight(e.defaults.colHeaderRowHeight),t.saveRowHeaderDefaultColumnWidth(e.defaults.rowHeaderColWidth)},e.saveColumnHeaderInfo=function(t,o,n,r,i){for(var a,s,l,u,c=o._rowCount,h=o._columnCount,p=0;p<c;p++)for(a=0;a<h;a++)(1&i)>0&&(s=t._getModel(1).getValue(p,r+a),o.saveValue(p,a,s)),(64&i)>0&&o.saveStyle(p,a,e.getStyleObject(t,p,r+a,1)),(128&i)>0&&o.saveTag(p,a,t.getTag(p,r+a,1));if((1&i)>0)for(a=0;a<h;a++)t.isColumnBound(r+a)&&n.saveBindingField(a,t.getDataColumnName(r+a));if((32&i)>0)for(l=t._getSpanModel(1).getEnumerator(0,r,c,h);l.moveNext();)o.saveSpan(l.current());for(h=n._columnCount,a=0;a<h;a++)n.saveWidth(a,t._getActualColumnWidth(r+a)),n.saveVisible(a,t.getColumnVisible(r+a)),n.saveResizable(a,t.getColumnResizable(r+a));if((128&i)>0)for(a=0;a<h;a++)n.saveTag(a,t.getTag(-1,r+a));if((64&i)>0)for(a=0;a<h;a++)n.saveViewportColumnStyle(a,e.getStyleObject(t,-1,r+a,3)),n.saveHeaderColumnStyle(a,e.getStyleObject(t,-1,r+a,1));if((8&i)>0&&(u=t.colRangeGroup)&&!u._isEmpty())for(a=0;a<h;a++)n.saveRangeGroup(a,u.getLevel(r+a),u.getCollapsed(r+a))},e.saveRowHeaderInfo=function(t,o,n,r,i){var a,s,l,u,c,h,p;if(!((1023&i)<=0)){for(a=o._rowCount,s=o._columnCount,l=0;l<a;l++)for(u=0;u<s;u++)(1&i)>0&&(c=t._getModel(2).getValue(r+l,u),o.saveValue(l,u,c)),(64&i)>0&&o.saveStyle(l,u,e.getStyleObject(t,r+l,u,2)),(128&i)>0&&o.saveTag(l,u,t.getTag(r+l,u,2));if((32&i)>0)for(h=t._getSpanModel(2).getEnumerator(r,0,a,s);h.moveNext();)o.saveSpan(h.current());for(a=n._rowCount,l=0;l<a;l++)n.saveHeight(l,t._getActualRowHeight(r+l)),n.saveVisible(l,t.getRowVisible(r+l)),n.saveResizable(l,t.getRowResizable(r+l));if((128&i)>0)for(l=0;l<a;l++)n.saveTag(l,t.getTag(r+l,-1));if((64&i)>0)for(l=0;l<a;l++)n.saveViewportRowStyle(l,e.getStyleObject(t,r+l,-1,3)),n.saveHeaderRowStyle(l,e.getStyleObject(t,r+l,-1,2));if((8&i)>0&&(p=t.rowRangeGroup)&&!p._isEmpty())for(l=0;l<a;l++)n.saveRangeGroup(l,p.getLevel(r+l),p.getCollapsed(r+l))}},e.saveViewportInfo=function(t,o,n,r,i){var a,s,l,u,c,h;if(!((1023&i)<=0)){for(a=o._rowCount,s=o._columnCount,l=0;l<a;l++)for(u=0;u<s;u++){if((2&i)>0&&((c=t.getFormulaInformation(n+l,r+u)).hasFormula?c.isArrayFormula?c.baseRange.row===n+l&&c.baseRange.col===r+u&&o.saveArrayFormula(c):o.saveFormula(l,u,c.formula):o.saveFormula(l,u,ie)),(1&i)>0&&(!c||!c.hasFormula)&&o.saveValue(l,u,t.getValue(n+l,r+u,3)),(16&i)>0){var p=t.getSparkline(n+l,r+u),d=ie;p&&(d=p.data(),p.dateAxisData()),p&&d?o.saveSparkline(l,u,p.clone()):o.saveSparkline(l,u,ie)}(64&i)>0&&o.saveStyle(l,u,e.getStyleObject(t,n+l,r+u,3)),(4&i)>0&&o.saveComment(l,u,e.getComment(t,n+l,r+u)),(128&i)>0&&o.saveTag(l,u,t.getTag(n+l,r+u,3)),(256&i)>0&&o.saveBindingPath(l,u,t.getBindingPath(n+l,r+u,3))}if((32&i)>0)for(h=t._getSpanModel().getEnumerator(n,r,a,s);h.moveNext();)o.saveSpan(h.current())}},e.saveTableInfo=function(e,t,o){var n,r,i,a,s=e.getTables();if(s)for(n=0,r=s.length;n<r;n++)i=s[n],o.containsRange(i.range())&&((a=i.clone()).copyDataSource(i),t.push(a))},e.undoCellsInfo=function(t,o,n,r,i){var a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O,P,L=o._rowCount,H=o._columnCount;t.suspendCalcService(),t.suspendEvent();try{for(p=0;p<L;p++)for(d=0;d<H;d++)o.isBindingPathSaved()&&t.setBindingPath(n+p,r+d,ie,i),o.isFormulaSaved()&&3===i&&t.setFormula(n+p,r+d,ie),o.isSparklineSaved()&&3===i&&t.removeSparkline(n+p,r+d),o.isValueSaved()&&t.setValue(n+p,r+d,ie,i),o.isStyleSaved()&&e.setStyleObject(t,n+p,r+d,i,ie),o.isCommentSaved()&&e.setComment(t,n+p,r+d,ie),o.isTagSaved()&&t.setTag(n+p,r+d,ie,i);if(o.isBindingPathSaved())for(f=o.getBindingPaths(),a=0;a<f.length;a++)g=f[a],t.setBindingPath(n+g.row,r+g.column,g.value,i);if(o.isValueSaved())for(m=o.getValues(),a=0;a<m.length;a++)_=m[a],t.setValue(n+_.row,r+_.column,_.value,i);if(o.isFormulaSaved()&&3===i)for(y=o.getFormulas(),a=0;a<y.length;a++)u=y[a],t.setFormula(n+u.row,r+u.column,u.value);if(o.isSparklineSaved()&&3===i)for(C=o.getSparklines(),w=0;w<C.length;w++)(v=(F=C[w]).value)?v.dateAxisData()?t.setSparkline(n+F.row,r+F.column,v.data(),v.dataOrientation(),v.sparklineType(),v.setting(),v.dateAxisData(),v.dateAxisOrientation()):t.setSparkline(n+F.row,r+F.column,v.data(),v.dataOrientation(),v.sparklineType(),v.setting()):t.removeSparkline(n+F.row,r+F.column);if(o.isStyleSaved())for(S=o.getStyles(),a=0;a<S.length;a++)x=S[a],e.setStyleObject(t,n+x.row,r+x.column,i,x.value);if(o.isCommentSaved())for(R=o.getComments(),a=0;a<R.length;a++)T=(b=R[a]).value,e.setComment(t,n+b.row,r+b.column,T);if(o.isTagSaved())for(I=(A=o.getTags()).length,D=0;D<I;D++)F=A[D],t.setTag(n+F.row,r+F.column,F.value,i);if(o.isArrayFormulaSaved()&&3===i){if((M=t._getsArrayFormulas(n,r,L,H))&&M.length>0)for(c=M.getLength(0),h=0;h<c;h++)l=M[h][0],t.setArrayFormula(l.row,l.col,l.rowCount,l.colCount,ie);if((M=o.getArrayFormula())&&M.length>0)for(c=M.length,h=0;h<c;h++)E=M[h],t.setArrayFormula(E.baseRange.row,E.baseRange.col,E.baseRange.rowCount,E.baseRange.colCount,E.formula)}}finally{t.resumeCalcService(),t.resumeEvent()}if((N=t._getSpanModel(i))&&N.length>0){for(O=[],P=N.getEnumerator(n,r,L,H);P.moveNext();)(s=P.current())&&O.push(s);for(a=0;a<O.length;a++)s=O[a],N.remove(s)}if(o.isSpanSaved()&&N)for(a=0;a<o._spans.length;a++)s=o._spans[a],N.addSpan(s)},e.undoColumnsInfo=function(t,o,n){var r,i,a,s,l=o._columnCount;if(o.isBindingFieldSaved())for(i={fieldName:ie},r=0;r<l;r++)o.getBindingField(r,i)&&t.bindColumn(n+r,i.fieldName);if(o.isWidthSaved())for(r=0;r<l;r++)t.setColumnWidth(n+r,o.getWidth(r),3);if(o.isVisibleSaved())for(r=0;r<l;r++)t.setColumnVisible(n+r,o.getVisible(r),3);if(o.isResizableSaved())for(r=0;r<l;r++)t.setColumnResizable(n+r,o.getResizable(r),3);if(o.isTagSaved())for(r=0;r<l;r++)t.setTag(-1,n+r,o.getTag(r),3);if(o.isViewportColumnStyleSaved())for(r=0;r<l;r++)e.setStyleObject(t,-1,n+r,3,o.getViewportColumnStyle(r));if(o.isHeaderColumnStyleSaved())for(r=0;r<l;r++)e.setStyleObject(t,-1,n+r,1,o.getHeaderColumnStyle(r));if(o.isRangeGroupSaved()&&(a=t.colRangeGroup))for(s={level:ie,collapsed:ie},r=0;r<l;r++)o.getRangeGroup(r,s),a._setLevel(n+r,s.level),a.setCollapsed(n+r,s.collapsed)},e.undoRowsInfo=function(t,o,n){var r,i,a,s=o._rowCount;if(o.isHeightSaved())for(r=0;r<s;r++)t.setRowHeight(n+r,o.getHeight(r),3);if(o.isVisibleSaved())for(r=0;r<s;r++)t.setRowVisible(n+r,o.getVisible(r),3);if(o.isResizableSaved())for(r=0;r<s;r++)t.setRowResizable(n+r,o.getResizable(r),3);if(o.isTagSaved())for(r=0;r<s;r++)t.setTag(n+r,-1,o.getTag(r),3);if(o.isViewportRowStyleSaved())for(r=0;r<s;r++)e.setStyleObject(t,n+r,-1,3,o.getViewportRowStyle(r));if(o.isHeaderRowStyleSaved())for(r=0;r<s;r++)e.setStyleObject(t,n+r,-1,2,o.getHeaderRowStyle(r));if(o.isRangeGroupSaved()&&(i=t.rowRangeGroup))for(a={level:ie,collapsed:ie},r=0;r<s;r++)o.getRangeGroup(r,a),i._setLevel(n+r,a.level),i.setCollapsed(n+r,a.collapsed)},e.undoSheetInfo=function(e,t){t.isDefaultStyleSaved()&&e.setDefaultStyle(t.getDefaultStyle()),t.isDefaultColumnWidthSaved()&&(e.defaults.colWidth=t.getDefaultColumnWidth()),t.isDefaultRowHeightSaved()&&(e.defaults.rowHeight=t.getDefaultRowHeight()),t.isTagSaved()&&e.tag(t.getTag()),t.isColumnHeaderDefaultStyleSaved()&&e.setDefaultStyle(t.getColumnHeaderDefaultStyle(),1),t.isColumnHeaderDefaultRowHeightSaved()&&(e.defaults.colHeaderRowHeight=t.getColumnHeaderDefaultRowHeight()),t.isRowHeaderDefaultStyleSaved()&&e.setDefaultStyle(t.getRowHeaderDefaultStyle(),2),t.isRowHeaderDefaultColumnWidthSaved()&&(e.defaults.rowHeaderColWidth=t.getRowHeaderDefaultColumnWidth())},e.undoTableInfo=function(e,t,o){var n,r,i,a=t.length;if(a>0)for(r=0;r<a;r++)i=t[r],e._tableManager.add(i);else if(n=e.getTables())for(r=0,a=n.length;r<a;r++)i=n[r],o.containsRange(i.range())&&e._tableManager.remove(i,!1)},e.getValues=function(e,t,o,n,r){var i,a,s,l;for(t<0&&(t=0,n=e.getRowCount()),o<0&&(o=0,r=e.getColumnCount()),i=[],a=0;a<n;a++)for(s=0;s<r;s++)(l=e.getValue(t+a,o+s))!==ae&&l!==ie&&i.push(new ce(a,s,l));return i},e.raiseRangeDataChanged=function(e,t,o,n,r,i,a,s){e&&(t<0&&(t=0,n=e.getRowCount()),o<0&&(o=0,r=e.getColumnCount()),e._raiseRangeDataChanged(t,o,n,r,i,a))},e.convertToKey=function(e,t){var o=0;return o=e,(o<<=32)|t},e.remove=function(e,t,o){var n,r=ie,i=-1,a=e.length;if(a>0)for(n=0;n<a;n++)if(e[n].row===t&&e[n].column===o){i=n;break}return-1!==i&&(r=e[i],e.splice(i,1)),r},e.clearFormula=function(e,t,o,n,r){e._getCalcModel().clear(t,o,n,r)},e}(),o.CopyMoveHelper=l,u=function(){function e(){this.canExecuteChanged=ie}return e.prototype.execute=function(e){},e.prototype.canExecute=function(e){return!0},e.prototype.canUndo=function(){return!0},e.prototype.saveState=function(){},e.prototype.undo=function(e){return!0},e.prototype._raiseCanExecuteChanged=function(){this.canExecuteChanged&&"function"==typeof this.canExecuteChanged&&this.canExecuteChanged(this)},e.prototype._suspendInvalidate=function(e){e&&e._suspendInvalidate&&e._suspendInvalidate()},e.prototype._resumeInvalidate=function(e){return!(!e||!e._resumeInvalidate)&&e._resumeInvalidate()},e}(),o.ActionBase=u,c=function(e){function t(t,o,n,r){e.call(this),this._sheet=t,this._columns=o,this._size=n,this._rowHeader=r,this._oldSizes=[],this._oldVisibles=[]}return __extends(t,e),t.prototype.canExecute=function(e){return!0},t.prototype.execute=function(e){var t,o,n,r,i,a,s,l,u=this,c=u._sheet,h=u._columns,p=h&&h.length,d=Number.MAX_VALUE;if(c&&p>0){if(u._suspendInvalidate(e),t=u._getColumnsReiszed(h),o={sheet:c,sheetName:c._name,colList:t,header:u._rowHeader,cancel:!1},c.triggerColumnWidthChanging(o),o&&!0===o.cancel)return u._canUndo=!1,void u._resumeInvalidate(e);u._canUndo=!0,u.saveState(),n=c.isPaintSuspended(),c.isPaintSuspended(!0),c.suspendEvent();try{var f=u._rowHeader,g=f?c.getColumnCount(2):c.getColumnCount(3),m=c._scrollLeftCol,_=m;for(r=m-1;r>=c.frozenColCount&&!(c.getColumnVisible(r)&&c._getZoomColumnWidth(r)>0);r--)c.getColumnResizable(r)&&(_=r);for(i=d,a=u._size,s=0;s<p;s++){var y=h[s],C=y.firstCol,w=y.lastCol;for(l=C;l<=w;l++)0<=l&&l<g&&(f&&c.getColumnResizable(l,2)&&a!==c._getActualColumnWidth(l,2)?c.setColumnWidth(l,a,2):!f&&c.getColumnResizable(l,3)&&a!==c._getActualColumnWidth(l,3)&&c.setColumnWidth(l,a,3),i=se(l,i))}i!==d&&i<=m&&_!==m&&(c._scrollLeftCol=_)}finally{c.resumeEvent(),c.isPaintSuspended(n),u._resumeInvalidate(e)||(c.invalidateLayout(),c.repaint())}c.triggerColumnWidthChanged({sheet:c,sheetName:c._name,colList:t,header:u._rowHeader}),c._syncHScollbarPosition()}},t.prototype.saveState=function(){var e,t,o=[],n=[],r=this._sheet,i=this._columns,a=i&&i.length;if(r&&a>0){var s=this._rowHeader,l=s?2:3,u=r.getColumnCount(l),c=s?r.defaults.rowHeaderColWidth:r.defaults.colWidth,h=r._sheetModelManager.getColInfos();for(e=0;e<a;e++){var p,d,f=i[e],g=f.firstCol,m=f.lastCol;for(o[e]=[],n[e]=[],t=g;t<=m;t++)p=t-g,0<=t&&t<u?(d=h.getActualSize(t),d=isNaN(d)||null===d?c:ue(d),o[e][p]=d,n[e][p]=h.getVisible(t)):(o[e][p]=-1,n[e][p]=!1)}}this._oldSizes=o,this._oldVisibles=n},t.prototype.undo=function(e){var t,o,n,r,i,a=this,s=!1,l=a._sheet,u=a._columns,c=u&&u.length;if(l&&c>0){if(a._suspendInvalidate(e),t=a._getColumnsReiszed(u),o={sheet:l,sheetName:l._name,colList:t,header:a._rowHeader,cancel:!1},l.triggerColumnWidthChanging(o),o&&!0===o.cancel)return a._resumeInvalidate(e),!1;n=l.isPaintSuspended(),l.isPaintSuspended(!0),l.suspendEvent();try{var h,p,d=a._rowHeader,f=d?l.getColumnCount(2):l.getColumnCount(3);for(r=0;r<c;r++){var g=u[r],m=g.firstCol,_=g.lastCol;for(i=m;i<=_;i++)h=a._oldSizes[r][i-g.firstCol],p=a._oldVisibles[r][i-g.firstCol],0<=i&&i<f&&-1!==h&&(d&&l.getColumnResizable(i,2)?(l.setColumnWidth(i,h,2),s=!0):!d&&l.getColumnResizable(i,3)&&(l.setColumnWidth(i,h,3),s=!0),d&&l.getColumnVisible(i,2)!==p?(l.setColumnVisible(i,p,2),s=!0):d||l.getColumnVisible(i,3)===p||(l.setColumnVisible(i,p,3),s=!0))}}finally{l.resumeEvent(),l.isPaintSuspended(n),a._resumeInvalidate(e)||(l.invalidateLayout(),l.repaint())}l.triggerColumnWidthChanged({sheet:l,sheetName:l._name,colList:t,header:a._rowHeader})}return s},t.prototype._getColumnsReiszed=function(e){for(var t,o=[],n=0,r=e.length;n<r;n++){var i=e[n],a=i.firstCol,s=i.lastCol;for(t=a;t<=s;t++)o.push(t)}return o},t.prototype.canUndo=function(){return this._canUndo},t}(u),o.ColumnResizeUndoAction=c,h=function(e){function t(t,o,n,r){e.call(this),this._sheet=t,this._rows=o,this._size=n,this._columnHeader=r,this._oldSizes=[],this._oldVisibles=[]}return __extends(t,e),t.prototype.canExecute=function(e){return!0},t.prototype.execute=function(e){var t,o,n,r,i,a,s,l,u=this,c=u._sheet,h=u._rows,p=h&&h.length,d=Number.MAX_VALUE;if(c&&p>0){if(u._suspendInvalidate(e),t=u._getRowsReiszed(h),o={sheet:c,sheetName:c._name,rowList:t,header:u._columnHeader,cancel:!1},c.triggerRowHeightChanging(o),o&&!0===o.cancel)return u._canUndo=!1,void u._resumeInvalidate(e);u._canUndo=!0,u.saveState(),n=c.isPaintSuspended(),c.isPaintSuspended(!0),c.suspendEvent(),c.suspendCalcService();try{var f=u._columnHeader,g=f?c.getRowCount(1):c.getRowCount(3),m=c._scrollTopRow,_=m;for(r=m-1;r>=c.frozenRowCount&&!(c.getRowVisible(r)&&c._getZoomRowHeight(r)>0);r--)c.getRowResizable(r)&&(_=r);for(i=d,a=u._size,s=0;s<p;s++){var y=h[s],C=y.firstRow,w=y.lastRow;for(l=C;l<=w;l++)0<=l&&l<g&&(f&&c.getRowResizable(l,1)&&a!==c._getActualRowHeight(l,1)?c.setRowHeight(l,a,1):!f&&c.getRowResizable(l,3)&&a!==c._getActualRowHeight(l,3)&&c.setRowHeight(l,a,3),i=se(l,i))}i!==d&&i<=m&&_!==m&&(c._scrollTopRow=_)}finally{c.resumeCalcService(!1),c.resumeEvent(),c.isPaintSuspended(n),u._resumeInvalidate(e)||(c.invalidateLayout(),c.repaint())}c.triggerRowHeightChanged({sheet:c,sheetName:c._name,rowList:t,header:u._columnHeader}),c._syncVScrollbarPosition()}},t.prototype.saveState=function(){var e,t,o=[],n=[],r=this._sheet,i=this._rows,a=i&&i.length;if(r&&a>0){var s=this._columnHeader,l=s?1:3,u=r.getRowCount(l),c=s?r.defaults.colHeaderRowHeight:r.defaults.rowHeight,h=r._sheetModelManager.getRowInfos();for(e=0;e<a;e++){var p,d,f=i[e],g=f.firstRow,m=f.lastRow;for(o[e]=[],n[e]=[],t=g;t<=m;t++)p=t-g,0<=t&&t<u?(d=h.getActualSize(t),d=isNaN(d)||null===d?c:ue(d),o[e][p]=d,n[e][p]=h.getVisible(t)):(o[e][p]=-1,n[e][p]=!1)}}this._oldVisibles=n,this._oldSizes=o},t.prototype.undo=function(e){var t,o,n,r,i,a=this,s=!1,l=a._sheet,u=a._rows,c=u&&u.length;if(l&&c>0){if(a._suspendInvalidate(e),t=a._getRowsReiszed(u),o={sheet:l,sheetName:l._name,rowList:t,header:a._columnHeader,cancel:!1},l.triggerRowHeightChanging(o),o&&!0===o.cancel)return a._resumeInvalidate(e),!1;n=l.isPaintSuspended(),l.isPaintSuspended(!0),l.suspendEvent(),l.suspendCalcService();try{var h,p,d=a._columnHeader,f=d?l.getRowCount(1):l.getRowCount(3),g=a._oldSizes,m=a._oldVisibles;for(r=0;r<c;r++){var _=u[r],y=_.firstRow,C=_.lastRow;for(i=y;i<=C;i++)h=g[r][i-y],p=m[r][i-y],0<=i&&i<f&&-1!==h&&(d&&l.getRowResizable(i,1)?(l.setRowHeight(i,h,1),s=!0):!d&&l.getRowResizable(i,3)&&(l.setRowHeight(i,h,3),s=!0),d&&l.getRowVisible(i,1)!==p?(l.setRowVisible(i,p,1),s=!0):d||l.getRowVisible(i,3)===p||(l.setRowVisible(i,p,3),s=!0))}}finally{l.resumeCalcService(!1),l.resumeEvent(),l.isPaintSuspended(n),a._resumeInvalidate(e)||(l.invalidateLayout(),l.repaint())}l.triggerRowHeightChanged({sheet:l,sheetName:l._name,rowList:t,header:a._columnHeader})}return s},t.prototype._getRowsReiszed=function(e){for(var t,o=[],n=0,r=e.length;n<r;n++){var i=e[n],a=i.firstRow,s=i.lastRow;for(t=a;t<=s;t++)o.push(t)}return o},t.prototype.canUndo=function(){return this._canUndo},t}(u),o.RowResizeUndoAction=h,p=function(e){function o(t,o,n,r){e.call(this),this._sheet=t,this._columns=o,this._sheetArea=n?2:3,3===arguments.length&&(r=t._getAutoFitType()),this._autofitType=r,this._oldSizes=[],this._oldVisibles=[]}return __extends(o,e),o.prototype.canExecute=function(e){return this._sheet&&this._columns&&this._columns.length>0},o.prototype.execute=function(e){var o,n,r,i,a,s,l,u=this;if(u.canExecute(e)){o=u._sheet,n=u._sheetArea,u._suspendInvalidate(e);var c=u._getColumnsReiszed(u._columns),h=2===n,p={sheet:o,sheetName:o._name,colList:c,header:h,cancel:!1};if(o.triggerColumnWidthChanging(p),p&&!0===p.cancel)return u._canUndo=!1,void u._resumeInvalidate(e);u._canUndo=!0,u.saveState();var d,f=o.getColumnCount(n),g=f-1,m=0;for(a=0,s=u._columns.length;a<s;a++)g=g>(d=u._columns[a].col)?d:g,m=m<d?d:m;t._CacheMgr.startCache(o,0,g,o.getRowCount()-1,m),r=o.isPaintSuspended(),o.isPaintSuspended(!0),o.suspendEvent();try{for(a=0,s=u._columns.length;a<s;a++)0<=(l=u._columns[a]).col&&l.col<f&&o.getColumnResizable(l.col,n)&&(i=u._getColumnAutoFitValue(l.col))!==o.getColumnWidth(l.col,n)&&o.setColumnWidth(l.col,i,n)}finally{t._CacheMgr.clearCache(),o.resumeEvent(),o.isPaintSuspended(r),u._resumeInvalidate(e)||(o.invalidateLayout(),o.repaint())}o.triggerColumnWidthChanged({sheet:o,sheetName:o._name,colList:c,header:h})}},o.prototype.saveState=function(){var e,t,o,n,r=this,i=ie,a=ie,s=r._sheet,l=r._sheetArea;if(s&&r._columns&&r._columns.length>0)for(e=s.getColumnCount(l),i=[r._columns.length],a=[r._columns.length],t=0,o=r._columns.length;t<o;t++)0<=(n=r._columns[t]).col&&n.col<e?(i[t]=s.getColumnWidth(n.col,l),a[t]=s.getColumnVisible(n.col,l)):(i[t]=-1,a[t]=!1);r._oldSizes=i,r._oldVisibles=a},o.prototype.undo=function(e){var t,o,n,r,i,a,s,l,u,c,h=this,p=!1,d=h._sheetArea;if(h._sheet&&h._columns&&h._columns.length>0){if(t=2===d,o=h._sheet,h._suspendInvalidate(e),n=h._getColumnsReiszed(h._columns),r={sheet:o,sheetName:o._name,colList:n,header:t,cancel:!1},o.triggerColumnWidthChanging(r),r&&!0===r.cancel)return h._resumeInvalidate(e),!1;i=o.isPaintSuspended(),o.isPaintSuspended(!0),o.suspendEvent();try{for(a=o.getColumnCount(d),u=0;u<h._columns.length;u++)c=h._columns[u],s=h._oldSizes[u],l=h._oldVisibles[u],0<=u&&u<a&&-1!==s&&o.getColumnResizable(c.col,d)&&(o.setColumnWidth(c.col,s,d),o.setColumnVisible(c.col,l,d),p=!0)}finally{o.resumeEvent(),o.isPaintSuspended(i),h._resumeInvalidate(e)||(o.invalidateLayout(),o.repaint())}o.triggerColumnWidthChanged({sheet:o,sheetName:o._name,colList:n,header:t})}return p},o.prototype._getColumnsReiszed=function(e){for(var t,o=[],n=0;n<e.length;n++)t=e[n],o.push(t.col);return o},o.prototype._getColumnAutoFitValue=function(e){return t.util.getColumnAutoFitValue(e,this._sheet,this._sheetArea,this._autofitType)},o.prototype.canUndo=function(){return this._canUndo},o}(u),o.ColumnAutoFitUndoAction=p,d=function(e){function o(t,o,n,r){e.call(this),this._sheet=t,this._rows=o,this._sheetArea=n?1:3,3===arguments.length&&(r=t._getAutoFitType()),this._autofitType=r,this._oldSizes=[],this._oldVisibles=[]}return __extends(o,e),o.prototype.canExecute=function(e){return this._sheet&&this._rows&&this._rows.length>0},o.prototype.execute=function(e){var t,o,n,r,i,a,s,l=this;if(l.canExecute(e)){t=l._sheet,l._suspendInvalidate(e);var u=l._getRowsResized(l._rows),c=l._sheetArea,h=1===l._sheetArea,p={sheet:t,sheetName:t._name,rowList:u,header:h,cancel:!1};if(t.triggerRowHeightChanging(p),p&&!0===p.cancel)return l._canUndo=!1,void l._resumeInvalidate(e);l._canUndo=!0,l.saveState(),o=t.isPaintSuspended(),t.isPaintSuspended(!0),t.suspendEvent(),t.suspendCalcService();try{for(n=t.getRowCount(c),i=0,a=l._rows.length;i<a;i++)0<=(s=l._rows[i]).row&&s.row<n&&t.getRowResizable(s.row,c)&&(r=l._getRowAutoFitValue(s.row))!==t.getRowHeight(s.row,c)&&t.setRowHeight(s.row,r,c)}finally{t.resumeCalcService(!1),t.resumeEvent(),t.isPaintSuspended(o),l._resumeInvalidate(e)||(t.invalidateLayout(),t.repaint())}t.triggerRowHeightChanged({sheet:t,sheetName:t._name,rowList:u,header:h})}},o.prototype.saveState=function(){var e,t,o,n,r=this,i=ie,a=ie,s=r._sheet,l=r._sheetArea;if(s&&r._rows&&r._rows.length>0)for(i=[r._rows.length],a=[r._rows.length],e=s.getRowCount(l),t=0,o=r._rows.length;t<o;t++)0<=(n=r._rows[t]).row&&n.row<e?(i[t]=s.getRowHeight(n.row,l),a[t]=s.getRowVisible(n.row,l)):(i[t]=-1,a[t]=!1);r._oldSizes=i,r._oldVisibles=a},o.prototype.undo=function(e){var t,o,n,r,i,a,s,l,u,c=this,h=!1,p=c._sheet,d=c._sheetArea,f=1===c._sheetArea;if(p&&c._rows&&c._rows.length>0){if(c._suspendInvalidate(e),t=c._getRowsResized(c._rows),o={sheet:p,sheetName:p._name,rowList:t,header:f,cancel:!1},p.triggerRowHeightChanging(o),o&&!0===o.cancel)return c._resumeInvalidate(e),!1;n=p.isPaintSuspended(),p.isPaintSuspended(!0),p.suspendEvent(),p.suspendCalcService();try{for(a=p.getRowCount(d),s=0,l=c._rows.length;s<l;s++)u=c._rows[s],r=c._oldSizes[s],i=c._oldVisibles[s],0<=s&&s<a&&-1!==r&&p.getRowResizable(u.row,d)&&(p.setRowHeight(u.row,r,d),p.setRowVisible(u.row,i,d),h=!0)}finally{p.resumeCalcService(!1),p.resumeEvent(),p.isPaintSuspended(n),c._resumeInvalidate(e)||(p.invalidateLayout(),p.repaint())}p.triggerRowHeightChanged({sheet:p,sheetName:p._name,rowList:t,header:f})}return h},o.prototype._getRowsResized=function(e){for(var t,o=[],n=0,r=e.length;n<r;n++)t=e[n],o.push(t.row);return o},o.prototype._getRowAutoFitValue=function(e){return t.util.getRowAutoFitValue(e,this._sheet,this._sheetArea,this._autofitType)},o.prototype.canUndo=function(){return this._canUndo},o}(u),o.RowAutoFitUndoAction=d,f=function(e,t){this.index=e,this.count=t},o.GroupExtent=f,g=function(e){function o(t,o){e.call(this),this._sheet=t,this._columnGroupExtent=o,this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(e){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;t.features.group&&r&&this._columnGroupExtent&&r.colRangeGroup&&(this._suspendInvalidate(e),o=this._columnGroupExtent.index,n=this._columnGroupExtent.count,r.colRangeGroup.group(o,n),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint()),this._canUndo=!0)},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){},o.prototype.undo=function(e){var o,n,r=!1,i=this._sheet;return t.features.group&&i&&this._columnGroupExtent&&i.colRangeGroup&&(this._suspendInvalidate(e),o=this._columnGroupExtent.index,n=this._columnGroupExtent.count,i.colRangeGroup.ungroupRange(o,n),r=!0,this._resumeInvalidate(e)||(i.invalidateLayout(),i.repaint())),r},o}(u),o.ColumnGroupUndoAction=g,m=function(e){function o(t,o){e.call(this),this._sheet=t,this._columnUngroupExtent=o,this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(e){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;t.features.group&&r&&this._columnUngroupExtent&&r.colRangeGroup&&(o=this._columnUngroupExtent.index,n=this._columnUngroupExtent.count,r.colRangeGroup.getLevel(o)>=0||r.colRangeGroup.getLevel(o+n-1)>=0?(this._suspendInvalidate(e),this._canUndo=!0,r.colRangeGroup.ungroupRange(o,n),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint())):this._canUndo=!1)},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){},o.prototype.undo=function(e){var o,n,r=!1,i=this._sheet;return t.features.group&&!0===this._canUndo&&i&&this._columnUngroupExtent&&i.colRangeGroup&&(this._suspendInvalidate(e),o=this._columnUngroupExtent.index,n=this._columnUngroupExtent.count,i.colRangeGroup.group(o,n),r=!0,this._resumeInvalidate(e)||(i.invalidateLayout(),i.repaint())),r},o}(u),o.ColumnUngroupUndoAction=m,_=function(e){function o(t,o){e.call(this),this._sheet=t,this._rowGroupExtent=o,this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(e){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;t.features.group&&r&&this._rowGroupExtent&&r.rowRangeGroup&&(this._suspendInvalidate(e),o=this._rowGroupExtent.index,n=this._rowGroupExtent.count,r.rowRangeGroup.group(o,n),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint()),this._canUndo=!0)},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){},o.prototype.undo=function(e){var o,n,r=!1,i=this._sheet;return t.features.group&&i&&this._rowGroupExtent&&i.rowRangeGroup&&(this._suspendInvalidate(e),o=this._rowGroupExtent.index,n=this._rowGroupExtent.count,i.rowRangeGroup.ungroupRange(o,n),r=!0,this._resumeInvalidate(e)||(i.invalidateLayout(),i.repaint())),r},o}(u),o.RowGroupUndoAction=_,y=function(e){function o(t,o){e.call(this),this._sheet=t,this._rowUngroupExtent=o,this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(e){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;t.features.group&&r&&this._rowUngroupExtent&&r.rowRangeGroup&&(o=this._rowUngroupExtent.index,n=this._rowUngroupExtent.count,r.rowRangeGroup.getLevel(o)>=0||r.rowRangeGroup.getLevel(o+n-1)>=0?(this._suspendInvalidate(e),this._canUndo=!0,r.rowRangeGroup.ungroupRange(o,n),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint())):this._canUndo=!1)},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){},o.prototype.undo=function(e){var o,n,r=!1,i=this._sheet;return t.features.group&&!0===this._canUndo&&i&&this._rowUngroupExtent&&i.rowRangeGroup&&(this._suspendInvalidate(e),o=this._rowUngroupExtent.index,n=this._rowUngroupExtent.count,i.rowRangeGroup.group(o,n),r=!0,this._resumeInvalidate(e)||(i.invalidateLayout(),i.repaint())),r},o}(u),o.RowUngroupUndoAction=y,C=function(e,t,o){this.index=e,this.level=t,this.collapsed=o},o.GroupExpandExtent=C,w=function(e){function o(t,o){e.call(this),this._sheet=t,this._columnExpandExtent=o,this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;t.features.group&&r&&this._columnExpandExtent&&r.colRangeGroup&&(this._suspendInvalidate(e),o=this._columnExpandExtent.index,n=this._columnExpandExtent.collapsed,r.colRangeGroup.setCollapsed(o,n),this._showColumnRangeGroup(n),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint()),this._canUndo=!0)},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){},o.prototype.undo=function(e){var o,n,r=!1,i=this._sheet;return t.features.group&&i&&this._columnExpandExtent&&i.colRangeGroup&&(this._suspendInvalidate(e),o=this._columnExpandExtent.index,n=this._columnExpandExtent.collapsed,i.colRangeGroup.setCollapsed(o,!n),r=!0,this._showColumnRangeGroup(!n),this._resumeInvalidate(e)||(i.invalidateLayout(),i.repaint())),r},o.prototype._showColumnRangeGroup=function(e){var t,o,n,r,i,a,s,l,u=this,c=u._sheet,h=u._columnExpandExtent.index;if(!(h<0||h>=c.getColumnCount())){if(1===c.colRangeGroup.direction){if(!(t=c.colRangeGroup.find(h-1,u._columnExpandExtent.level)))return;o=t.start,n=h,r=1,e?o=h:o<c.frozenColCount&&(o=c.frozenColCount),o<(i=c.getViewportLeftColumn(r))&&(i=o),a=c.getViewportWidth(r),(s=u._getColsTotalWidth(c,i,n))>a&&(i=u._getNewLeftColumn(c,i,s-a)),c._scrollLeftCol=u._tryGetNextScrollableCol(c,i)}else{if(!(t=c.colRangeGroup.find(h+1,u._columnExpandExtent.level)))return;o=h,n=t.end,r=1,e?n=h:n>=(l=c.getColumnCount())&&(n=l-1),o<(i=c.getViewportLeftColumn(r))?c._scrollLeftCol=u._tryGetNextScrollableCol(c,o):(a=c.getViewportWidth(r),(s=u._getColsTotalWidth(c,i,n))>a&&(i=u._getNewLeftColumn(c,i,s-a),c._scrollLeftCol=u._tryGetNextScrollableCol(c,se(o,i))))}c._syncHScollbarPosition()}},o.prototype._getColsTotalWidth=function(e,t,o){for(var n=0,r=e.getColumnCount(),i=t;i<=o&&i<r;i++)n+=e.getColumnWidth(i)*e._zoomFactor;return n},o.prototype._getNewLeftColumn=function(e,t,o){for(var n=0,r=e.getColumnCount(),i=t;i<r&&n<o;i++)t++,n+=e.getColumnWidth(i)*e._zoomFactor;return t>=r?r-1:t},o.prototype._tryGetNextScrollableCol=function(e,t){var o,n=e.frozenColCount,r=e.getColumnCount()-1;if(t<n)return n;if(t>r)return r;for(o=t;o<=r;o++)if(e.getColumnWidth(o)>0)return o;return-1},o}(u),o.ColumnGroupExpandUndoAction=w,v=function(e){function o(t,o){e.call(this),this._sheet=t,this._rowExpandExtent=o,this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;t.features.group&&r&&this._rowExpandExtent&&r.rowRangeGroup&&(this._suspendInvalidate(e),o=this._rowExpandExtent.index,n=this._rowExpandExtent.collapsed,r.rowRangeGroup.setCollapsed(o,n),this._showRowRangeGroup(n),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint()),this._canUndo=!0)},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){},o.prototype.undo=function(e){var o,n,r=!1,i=this._sheet;return t.features.group&&i&&this._rowExpandExtent&&i.rowRangeGroup&&(this._suspendInvalidate(e),o=this._rowExpandExtent.index,n=this._rowExpandExtent.collapsed,i.rowRangeGroup.setCollapsed(o,!n),r=!0,this._showRowRangeGroup(!n),this._resumeInvalidate(e)||(i.invalidateLayout(),i.repaint())),r},o.prototype._showRowRangeGroup=function(e){var t,o,n,r,i,a,s,l,u=this,c=u._sheet,h=u._rowExpandExtent.index;if(!(h<0||h>=c.getRowCount())){if(1===c.rowRangeGroup.direction){if(!(t=c.rowRangeGroup.find(h-1,u._rowExpandExtent.level)))return;o=t.start,n=h,r=1,e?o=h:o<c.frozenRowCount&&(o=c.frozenRowCount),o<(i=c.getViewportTopRow(r))&&(i=o),a=c.getViewportHeight(r),(s=u._getRowsTotalHeight(c,i,n))>a&&(i=u._getNewTopRow(c,i,s-a)),c._scrollTopRow=u._tryGetNextScrollableRow(c,i)}else{if(!(t=c.rowRangeGroup.find(h+1,u._rowExpandExtent.level)))return;o=h,n=t.end,r=1,e?n=h:n>=(l=c.getRowCount())&&(n=l-1),o<(i=c.getViewportTopRow(r))?c._scrollTopRow=u._tryGetNextScrollableRow(c,o):(a=c.getViewportHeight(r),(s=u._getRowsTotalHeight(c,i,n))>a&&(i=u._getNewTopRow(c,i,s-a),c._scrollTopRow=u._tryGetNextScrollableRow(c,se(o,i))))}c._syncVScrollbarPosition()}},o.prototype._getRowsTotalHeight=function(e,t,o){for(var n=0,r=e.getRowCount(),i=t;i<=o&&i<r;i++)n+=e.getRowHeight(i)*e._zoomFactor;return n},o.prototype._getNewTopRow=function(e,t,o){for(var n=0,r=e.getRowCount(),i=t;i<=r&&n<o;i++)t++,n+=e.getRowHeight(i)*e._zoomFactor;return t>=r?r-1:t},o.prototype._tryGetNextScrollableRow=function(e,t){var o,n=e.frozenRowCount,r=e.getRowCount()-1;if(t<n)return n;if(t>r)return r;for(o=t;o<=r;o++)if(e.getRowHeight(o)>0)return o;return-1},o}(u),o.RowGroupExpandUndoAction=v,S=function(e){this.level=e},o.GroupHeaderExpandExtent=S,x=function(e){function o(t,o){e.call(this),this._sheet=t,this._columnGroupHeaderExpandExtent=o,this._oldStatus={},this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;if(t.features.group&&r&&this._columnGroupHeaderExpandExtent&&r.colRangeGroup){for(this._suspendInvalidate(e),this.saveState(),o=this._columnGroupHeaderExpandExtent.level,n=0;n<o;n++)r.colRangeGroup.expand(n,!0);r.colRangeGroup.expand(o,!1),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint()),this._canUndo=!0}},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){var e,t,o,n,r,i=ie,a=this._sheet;if(a&&this._columnGroupHeaderExpandExtent&&a.colRangeGroup)for(e=this._columnGroupHeaderExpandExtent.level,i={},t=0;t<=e;t++)for(var s=0,l=a.getColumnCount(),u=a.colRangeGroup.direction;s<l;){if(o=a.colRangeGroup.find(s,t)){switch(n=-1,u){case 0:n=o.start-1;break;case 1:n=o.end+1}r=1===o.getState(),i[n]||(i[n]=r),s+=o.end-o.start+1}s++}this._oldStatus=i},o.prototype.undo=function(e){var o,n=!1,r=this._sheet;if(t.features.group&&r&&this._oldStatus&&r.colRangeGroup){for(o in this._suspendInvalidate(e),this._oldStatus)o&&(r.colRangeGroup.setCollapsed(o,this._oldStatus[o]),n=!0);this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint())}return n},o}(u),o.ColumnGroupHeaderExpandUndoAction=x,R=function(e){function o(t,o){e.call(this),this._sheet=t,this._rowGroupHeaderExpandExtent=o,this._oldStatus={},this._canUndo=!1}return __extends(o,e),o.prototype.canExecute=function(){return!0},o.prototype.execute=function(e){var o,n,r=this._sheet;if(t.features.group&&r&&this._rowGroupHeaderExpandExtent&&r.rowRangeGroup){for(this._suspendInvalidate(e),this.saveState(),o=this._rowGroupHeaderExpandExtent.level,n=0;n<o;n++)r.rowRangeGroup.expand(n,!0);r.rowRangeGroup.expand(o,!1),this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint()),this._canUndo=!0}},o.prototype.canUndo=function(){return this._canUndo},o.prototype.saveState=function(){var e,t,o,n,r,i=ie,a=this._sheet;if(a&&this._rowGroupHeaderExpandExtent&&a.rowRangeGroup)for(e=this._rowGroupHeaderExpandExtent.level,i={},t=0;t<=e;t++)for(var s=0,l=a.getRowCount(),u=a.rowRangeGroup.direction;s<l;){if(o=a.rowRangeGroup.find(s,t)){switch(n=-1,u){case 0:n=o.start-1;break;case 1:n=o.end+1}r=1===o.getState(),i[n]||(i[n]=r),s+=o.end-o.start+1}s++}this._oldStatus=i},o.prototype.undo=function(e){var o,n=!1,r=this._sheet;if(t.features.group&&r&&this._oldStatus&&r.rowRangeGroup){for(o in this._suspendInvalidate(e),this._oldStatus)o&&(r.rowRangeGroup.setCollapsed(o,this._oldStatus[o]),n=!0);this._resumeInvalidate(e)||(r.invalidateLayout(),r.repaint())}return n},o}(u),o.RowGroupHeaderExpandUndoAction=R,b=function(e,t,o,n,r,i){this.fromRow=e,this.fromColumn=t,this.toRow=o,this.toColumn=n,this.rowCount=r,this.columnCount=i},o.DragDropExtent=b,T=function(e){function o(t,o,n,r,i){e.call(this),this._sheet=t,this._dragDropExtent=o,this._copy=n,this._insert=r,this._option=i}return __extends(o,e),o.prototype.canExecute=function(e){var o=this._sheet,n=this._dragDropExtent;return!!o._isValidRange(n.fromRow,n.fromColumn,n.rowCount,n.columnCount,this._sheet.getRowCount(),this._sheet.getColumnCount())&&!(!this._insert&&!o._isValidRange(n.toRow,n.toColumn,n.rowCount,n.columnCount,this._sheet.getRowCount(),this._sheet.getColumnCount()))&&!(o.isProtected&&o._isAnyCellInRangeLocked(new t.Range(n.toRow,n.toColumn,n.rowCount,n.columnCount)))&&o._checkArrayFormula(n.toRow,n.toColumn,n.rowCount,n.columnCount)&&!(o.isProtected&&o._isAnyCellInRangeLocked(new t.Range(n.fromRow,n.fromColumn,n.rowCount,n.columnCount)))&&o._checkArrayFormula(n.fromRow,n.fromColumn,n.rowCount,n.columnCount)},o.prototype.execute=function(e){var o,r,i,a,s,u,c,h,p,d,f,g=this,m=g._sheet;if(g.saveState(),g._insert){if(u=g._dragDropExtent.fromRow,g._dragDropExtent.fromColumn>=0&&u<0){o=g._dragDropExtent.fromColumn,r=g._dragDropExtent.toColumn,i=g._dragDropExtent.columnCount,c=g._dragDropExtent.toColumn,g._suspendInvalidate(e),p=m.isPaintSuspended(),m.isPaintSuspended(!0);try{g._sheet.addColumns(r,i),g._copy?g._sheet.copyTo(-1,r<=o?o+i:o,-1,r,-1,i,g._option):(g._sheet.moveTo(-1,r<=o?o+i:o,-1,r,-1,i,g._option),g._sheet.deleteColumns(r<=o?o+i:o,i),o<r&&(c=r-i)),m&&(a=m.getSelections(),m._clearSelectionImp(),m.addSelection(-1,c,m.getRowCount(),i),s=m.getSelections(),m.triggerSelectionChanging({sheet:m,sheetName:m._name,oldSelections:a,newSelections:s}),m.triggerSelectionChanged({sheet:m,sheetName:m._name}),m._setActiveCellImp(m._getFirstVisualRow(),c,m.activeRowViewportIndex,m.activeColViewportIndex))}finally{m._dragRect={},m.isPaintSuspended(p),g._resumeInvalidate(e)||(m.invalidateLayout(),m.repaint())}}else if(g._dragDropExtent.fromRow>=0&&g._dragDropExtent.fromColumn<0){o=g._dragDropExtent.fromRow,r=g._dragDropExtent.toRow,i=g._dragDropExtent.rowCount,h=g._dragDropExtent.toRow,g._suspendInvalidate(e),p=m.isPaintSuspended(),m.isPaintSuspended(!0);try{g._sheet.addRows(r,i),g._copy?g._sheet.copyTo(r<=o?o+i:o,-1,r,-1,i,-1,g._option):(g._sheet.moveTo(r<=o?o+i:o,-1,r,-1,i,-1,g._option),g._sheet.deleteRows(r<=o?o+i:o,i),o<r&&(h=r-i)),m&&(a=m.getSelections(),m._clearSelectionImp(),m.addSelection(h,-1,i,m.getColumnCount()),s=m.getSelections(),m.triggerSelectionChanging({sheet:m,sheetName:m._name,oldSelections:a,newSelections:s}),m.triggerSelectionChanged({sheet:m,sheetName:m._name}),m._setActiveCellImp(h,m._getFirstVisualColumn(),m.activeRowViewportIndex,m.activeColViewportIndex))}finally{m._dragRect={},m.isPaintSuspended(p),g._resumeInvalidate(e)||(m.invalidateLayout(),m.repaint())}}}else{var _=g._dragDropExtent.fromRow,y=g._dragDropExtent.fromColumn,C=g._dragDropExtent.toRow,w=g._dragDropExtent.toColumn,v=g._dragDropExtent.rowCount,S=g._dragDropExtent.columnCount;g._suspendInvalidate(e),p=m.isPaintSuspended(),m.isPaintSuspended(!0);try{g._copy?m.copyTo(_,y,C,w,v,S,g._option):m.moveTo(_,y,C,w,v,S,g._option),m&&(a=m.getSelections(),m._clearSelectionImp(),m.addSelection(C,w,v,S),s=m.getSelections(),m.triggerSelectionChanging({sheet:m,sheetName:m._name,oldSelections:a,newSelections:s}),m.triggerSelectionChanged({sheet:m,sheetName:m._name}),m._setActiveCellImp(le(m._getFirstVisualRow(),C),le(m._getFirstVisualColumn(),w),m.activeRowViewportIndex,m.activeColViewportIndex),d=g._savedFromViewportCells,!g._copy&&d&&d.isValueOrFormulaSaved()&&(g._savedFromAfterPastedChangedCells=new n(g._sheet,new t.Range(_,y,v,S),g._option),g._savedFromAfterPastedChangedCells.mergeCellsHasDiffData(g._savedFromBeforePastedChangedCells.getCellsHasData()),l.raiseRangeDataChanged(m,_,y,v,S,g._savedFromAfterPastedChangedCells.getChangedCells(),0,d.getValues())),(f=g._savedToViewportCells)&&f.isValueOrFormulaSaved()&&(g._savedToAfterPastedChangedCells=new n(g._sheet,new t.Range(C,w,v,S),g._option),g._savedToAfterPastedChangedCells.mergeCellsHasDiffData(g._savedToBeforePastedChangedCells.getCellsHasData()),l.raiseRangeDataChanged(m,C,w,v,S,g._savedToAfterPastedChangedCells.getChangedCells(),0,f.getValues())))}finally{m._dragRect={},m.isPaintSuspended(p),g._resumeInvalidate(e)||(m.invalidateLayout(),m.repaint())}}},o.prototype.saveState=function(){var e,o,r,u,c,h,p,d,f,g,m,_,y=this;y.initSaveState();var C=y._dragDropExtent.fromRow<0?0:y._dragDropExtent.fromRow,w=y._dragDropExtent.fromColumn<0?0:y._dragDropExtent.fromColumn,v=y._dragDropExtent.toRow<0?0:y._dragDropExtent.toRow,S=y._dragDropExtent.toColumn<0?0:y._dragDropExtent.toColumn,x=y._dragDropExtent.fromRow<0?y._sheet.getRowCount():y._dragDropExtent.rowCount,R=y._dragDropExtent.fromColumn<0?y._sheet.getColumnCount():y._dragDropExtent.columnCount;y._insert?y._dragDropExtent.fromColumn>=0&&y._dragDropExtent.fromRow>=0||y._dragDropExtent.fromColumn>=0||y._dragDropExtent.fromRow>=0&&(y._copy||y._sheet._hasTable(v,-1,1,-1)&&(g=new i(x,y._sheet.getColumnCount(2)),m=new s(x),l.saveRowHeaderInfo(y._sheet,g,m,C,y._option),y._savedFromRowHeaderCells=g,y._savedFromRows=m,_=new i(x,R),l.saveViewportInfo(y._sheet,_,C,w,y._option),y._savedFromViewportCells=_)):(y._dragDropExtent.fromRow<0&&(e=new i(y._sheet.getRowCount(1),R),o=new a(R),l.saveColumnHeaderInfo(y._sheet,e,o,S,y._option),y._savedToColumnHeaderCells=e,y._savedToColumns=o,y._copy||(r=new i(y._sheet.getRowCount(1),R),u=new a(R),l.saveColumnHeaderInfo(y._sheet,r,u,w,y._option),y._savedFromColumnHeaderCells=r,y._savedFromColumns=u)),y._dragDropExtent.fromColumn<0&&(c=new i(x,y._sheet.getColumnCount(2)),h=new s(x),l.saveRowHeaderInfo(y._sheet,c,h,v,y._option),y._savedToRowHeaderCells=c,y._savedToRows=h,y._copy||(g=new i(x,y._sheet.getColumnCount(2)),m=new s(x),l.saveRowHeaderInfo(y._sheet,g,m,C,y._option),y._savedFromRowHeaderCells=g,y._savedFromRows=m)),p=new i(x,R),l.saveViewportInfo(y._sheet,p,v,S,y._option),y._savedToViewportCells=p,d=[],l.saveTableInfo(y._sheet,d,new t.Range(v,S,x,R)),y._savedToTables=d,y._copy||(_=new i(x,R),l.saveViewportInfo(y._sheet,_,C,w,y._option),y._savedFromViewportCells=_,f=[],l.saveTableInfo(y._sheet,f,new t.Range(C,w,x,R)),y._savedFromTables=f,y._savedFromBeforePastedChangedCells=new n(y._sheet,new t.Range(C,w,x,R),y._option)),y._savedToBeforePastedChangedCells=new n(y._sheet,new t.Range(v,S,x,R),y._option)),y._savedAcitveRowViewportIndex=y._sheet.activeRowViewportIndex,y._savedAcitveColumnViewportIndex=y._sheet.activeColViewportIndex,y._savedActiveRow=y._sheet._activeRowIndex,y._savedActiveColumn=y._sheet._activeColIndex},o.prototype.initSaveState=function(){var e=this;e._savedFromColumnHeaderCells=ie,e._savedFromColumns=ie,e._savedFromViewportCells=ie,e._savedFromRowHeaderCells=ie,e._savedFromRows=ie,e._savedToColumnHeaderCells=ie,e._savedToColumns=ie,e._savedToViewportCells=ie,e._savedToRowHeaderCells=ie,e._savedToRows=ie,e._savedAcitveRowViewportIndex=-2,e._savedAcitveColumnViewportIndex=-2,e._savedActiveRow=-1,e._savedActiveColumn=-1},o.prototype.undo=function(e){var o,n,r,i,a,s,u,c,h,p,d,f=this,g=f._sheet;if(!g._isValidRange(f._dragDropExtent.fromRow,f._dragDropExtent.fromColumn,f._dragDropExtent.rowCount,f._dragDropExtent.columnCount,f._sheet.getRowCount(),f._sheet.getColumnCount())||!f._insert&&!g._isValidRange(f._dragDropExtent.toRow,f._dragDropExtent.toColumn,f._dragDropExtent.rowCount,f._dragDropExtent.columnCount,f._sheet.getRowCount(),f._sheet.getColumnCount()))return!1;if(o=!1,f._insert){if(!(f._dragDropExtent.fromColumn>=0&&f._dragDropExtent.fromRow>=0))if(f._dragDropExtent.fromColumn>=0){u=f._dragDropExtent.fromColumn,i=f._dragDropExtent.columnCount,f._suspendInvalidate(e),p=g.isPaintSuspended(),g.isPaintSuspended(!0);try{f._copy?f._sheet.deleteColumns(f._dragDropExtent.toColumn,i):(a=f._dragDropExtent.toColumn,s=f._dragDropExtent.fromColumn,f._dragDropExtent.fromColumn<f._dragDropExtent.toColumn?a=f._dragDropExtent.toColumn-i:s=f._dragDropExtent.fromColumn+i,f._sheet.addColumns(s,i),f._sheet.copyTo(-1,s<=a?a+i:a,-1,s,-1,i,f._option),f._sheet.deleteColumns(s<=a?a+i:a,i),a<s&&(u=s-i)),g&&(n=g.getSelections(),g._clearSelectionImp(),g.addSelection(-1,u,g.getRowCount(),i),r=g.getSelections(),g.triggerSelectionChanging({sheet:g,sheetName:g._name,oldSelections:n,newSelections:r}),g.triggerSelectionChanged({sheet:g,sheetName:g._name}))}finally{g.isPaintSuspended(p),f._resumeInvalidate(e)||(g.invalidateLayout(),g.repaint())}o=!0}else if(f._dragDropExtent.fromRow>=0){i=f._dragDropExtent.rowCount,c=f._dragDropExtent.fromRow,f._suspendInvalidate(e),p=g.isPaintSuspended(),g.isPaintSuspended(!0);try{f._copy?f._sheet.deleteRows(f._dragDropExtent.toRow,i):(a=f._dragDropExtent.toRow,s=f._dragDropExtent.fromRow,f._dragDropExtent.fromRow<f._dragDropExtent.toRow?a=f._dragDropExtent.toRow-i:s=f._dragDropExtent.fromRow+i,f._sheet.addRows(s,i),f._savedFromViewportCells&&(l.undoCellsInfo(f._sheet,f._savedFromViewportCells,s,0,3),o=!0),f._savedFromRowHeaderCells&&(l.undoCellsInfo(f._sheet,f._savedFromRowHeaderCells,s,0,2),o=!0),f._savedFromRows&&(l.undoRowsInfo(f._sheet,f._savedFromRows,s),o=!0),o||f._sheet.copyTo(s<=a?a+i:a,-1,s,-1,i,-1,f._option),f._sheet.deleteRows(s<=a?a+i:a,i),a<s&&(c=s-i)),g&&(n=g.getSelections(),g._clearSelectionImp(),g.addSelection(c,-1,i,g.getColumnCount()),r=g.getSelections(),g.triggerSelectionChanging({sheet:g,sheetName:g._name,oldSelections:n,newSelections:r}),g.triggerSelectionChanged({sheet:g,sheetName:g._name}))}finally{g.isPaintSuspended(p),f._resumeInvalidate(e)||(g.invalidateLayout(),g.repaint())}o=!0}}else{var m=f._dragDropExtent.fromRow<0?0:f._dragDropExtent.fromRow,_=f._dragDropExtent.fromColumn<0?0:f._dragDropExtent.fromColumn,y=f._dragDropExtent.toRow<0?0:f._dragDropExtent.toRow,C=f._dragDropExtent.toColumn<0?0:f._dragDropExtent.toColumn,w=f._dragDropExtent.fromRow<0?f._sheet.getRowCount():f._dragDropExtent.rowCount,v=f._dragDropExtent.fromColumn<0?f._sheet.getColumnCount():f._dragDropExtent.columnCount;l.clearFormula(g,y,C,w,v);var S=ie,x=ie,R=f._savedFromViewportCells;!f._copy&&R&&R.isValueOrFormulaSaved()&&(x=l.getValues(f._sheet,m,_,w,v)),(h=f._savedToViewportCells)&&h.isValueOrFormulaSaved()&&(S=l.getValues(f._sheet,y,C,w,v)),f._suspendInvalidate(e),p=g.isPaintSuspended(),g.isPaintSuspended(!0);try{f._savedToTables&&l.undoTableInfo(f._sheet,f._savedToTables,new t.Range(y,C,w,v)),f._savedToColumnHeaderCells&&(l.undoCellsInfo(f._sheet,f._savedToColumnHeaderCells,0,C,1),o=!0),f._savedToColumns&&(l.undoColumnsInfo(f._sheet,f._savedToColumns,C),o=!0),h&&(l.undoCellsInfo(f._sheet,h,y,C,3),o=!0),f._savedToRowHeaderCells&&(l.undoCellsInfo(f._sheet,f._savedToRowHeaderCells,y,0,2),o=!0),f._savedToRows&&(l.undoRowsInfo(f._sheet,f._savedToRows,y),o=!0),f._savedFromTables&&l.undoTableInfo(f._sheet,f._savedFromTables,new t.Range(m,_,w,v)),f._savedFromColumnHeaderCells&&(l.undoCellsInfo(f._sheet,f._savedFromColumnHeaderCells,0,_,1),o=!0),f._savedFromColumns&&(l.undoColumnsInfo(f._sheet,f._savedFromColumns,_),o=!0),R&&(l.undoCellsInfo(f._sheet,R,m,_,3),o=!0),f._savedFromRowHeaderCells&&(l.undoCellsInfo(f._sheet,f._savedFromRowHeaderCells,m,0,2),o=!0),f._savedFromRows&&(l.undoRowsInfo(f._sheet,f._savedFromRows,m),o=!0),o&&g&&(n=g.getSelections(),g._clearSelectionImp(),g.addSelection(f._dragDropExtent.fromRow,f._dragDropExtent.fromColumn,f._dragDropExtent.rowCount,f._dragDropExtent.columnCount),r=g.getSelections(),g.triggerSelectionChanging({sheet:g,sheetName:g._name,oldSelections:n,newSelections:r}),g.triggerSelectionChanged({sheet:g,sheetName:g._name}),S&&l.raiseRangeDataChanged(g,y,C,w,v,f._savedToAfterPastedChangedCells.getChangedCells(),0,S),x&&l.raiseRangeDataChanged(g,m,_,w,v,f._savedFromAfterPastedChangedCells.getChangedCells(),0,x))}finally{g.isPaintSuspended(p),f._resumeInvalidate(e)}}return o&&g&&(-1!==f._savedActiveRow&&-1!==f._savedActiveColumn&&((d=g.getSelections()[0]).contains(f._savedActiveRow,f._savedActiveColumn)?g._setActiveCellImp(f._savedActiveRow,f._savedActiveColumn):g._setActiveCellImp(le(g._getFirstVisualRow(),d.row),le(g._getFirstVisualColumn(),d.col))),-2!==f._savedAcitveRowViewportIndex&&-2!==f._savedAcitveColumnViewportIndex&&-1!==f._savedActiveRow&&-1!==f._savedActiveColumn&&g.showCell(f._savedActiveRow,f._savedActiveColumn,3,3),g.invalidateLayout(),g.repaint()),o},o}(u),o.DragDropUndoAction=T,A=function(o){function n(e,t){var n,r;o.call(this),this._oldValueCatch={},this._oldValueIsFormulaCatch={},this._eventNS=".cellEditaction",this._sheet=e,this._cellEditInfo=t,this._canUndo=!1,t.ranges&&1===t.endEditType&&(-1===(n=t.ranges[0]).row&&(n.row=0,n.rowCount=e.getRowCount()),-1===n.col&&(n.col=0,n.colCount=e.getColumnCount()),1===n.rowCount&&1===n.colCount&&(r=e._getsArrayFormulas(n.row,n.col,1,1))&&r.ranges&&r.ranges.length>0&&(t.ranges=[r.ranges[0]]))}return __extends(n,o),n.prototype.canExecute=function(e){var o,n,r=this;if(r._cellEditInfo.ranges){for(o=0;o<r._cellEditInfo.ranges.length;o++)if(n=r._cellEditInfo.ranges[o],r._sheet.isProtected&&r._sheet._isAnyCellInRangeLocked(n)||!r._sheet._checkArrayFormula(n.row,n.col,n.rowCount,n.colCount))return!1}else if(!r._sheet._checkArrayFormula(r._cellEditInfo.row,r._cellEditInfo.col,1,1)||r._sheet.isProtected&&r._sheet._isAnyCellInRangeLocked(new t.Range(r._cellEditInfo.row,r._cellEditInfo.col,1,1)))return!1;return!0},n.prototype.saveState=function(){var e=this;e.iteration(function(t,o){var n=e._sheet.getFormulaInformation(t,o),r=e._positionToString(t,o);n.hasFormula?!n.isArrayFormula||n.baseRange.row===t&&n.baseRange.col===o?(e._oldValueCatch[r]=n.formula,e._oldValueIsFormulaCatch[r]=n):e._oldValueIsFormulaCatch[r]=!1:e._oldValueCatch[r]=e._sheet.getValue(e._cellEditInfo.row,e._cellEditInfo.col)})},n.prototype.iteration=function(e){var t,o,n,r;if(this._cellEditInfo.ranges)for(t=0;t<this._cellEditInfo.ranges.length;t++)for(n=(o=this._cellEditInfo.ranges[t]).row;n<o.row+o.rowCount;n++)for(r=o.col;r<o.col+o.colCount;r++)e(n,r);else e(this._cellEditInfo.row,this._cellEditInfo.col)},n.prototype.saveCellState=function(e,t){},n.prototype.undo=function(e){var o,n,r=this,i=r._sheet,a=(r._cellEditInfo.row,r._cellEditInfo.col,i._paintSuspended);try{i._paintSuspended=!0,i._bind(t.Events.CellChanged+r._eventNS,function(e,t){"value"===t.propertyName&&i._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),r.iteration(function(e,t){var o,n=r._positionToString(e,t),a=r._oldValueIsFormulaCatch[n];!1!==a&&(a?a.isArrayFormula?i.setArrayFormula(e,t,a.baseRange.rowCount,a.baseRange.colCount,a.formula):i.setFormula(e,t,r._oldValueCatch[n]):((o=i.getFormula(e,t))===ie||""===o||i.setFormula(e,t,ie),i.setValue(e,t,r._oldValueCatch[n])))})}catch(e){return!1}finally{i._unbind(t.Events.CellChanged+r._eventNS),i._paintSuspended=a}return o=i._getSheetLayout(),n=new t.Rect(o.frozenX,o.frozenY,o.width-o.frozenX,o.height-o.frozenY),i.repaint(n),!0},n.prototype.execute=function(e){var o,n,r,i;this.saveState(),n=(o=this._sheet)._paintSuspended;try{o._paintSuspended=!0,o._bind(t.Events.CellChanged+this._eventNS,function(e,t){"value"===t.propertyName&&o._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),this.applyResult=this._applyEditing(e)}finally{this._sheet._unbind(t.Events.CellChanged+this._eventNS),o._paintSuspended=n}r=o._getSheetLayout(),i=new t.Rect(r.frozenX,r.frozenY,r.width-r.frozenX,r.height-r.frozenY),o.repaint(i),this._canUndo=0===this.applyResult},n.prototype._positionToString=function(e,t){return e+"_"+t},n.prototype._stringToPosition=function(e){var t=e.split("_");return{row:parseInt(t[0],10),col:parseInt(t[1],10)}},n.prototype._validateEditingValue=function(){var e,t,o,n,r,i=0,a=this._cellEditInfo.row,s=this._cellEditInfo.col,l=this._sheet,u=this._cellEditInfo.newValue,c=!this._cellEditInfo.hasOwnProperty("autoFormat")||this._cellEditInfo.autoFormat;return u&&u.length>0&&"="===u[0]?l.getDataValidator(a,s)&&""!==(e=u.substring(1))&&e!==l.getFormula(a,s)&&(t=l.getCalcService())&&(o=t.parse(l._getSheetSource(),e,a>=0?a:0,s>=0?s:0))&&(n=t.evaluateParsedFormula(l._getSheetSource(),o,a,s),l.isValid(a,s,n)||(i=l._validationError(a,s,n))):(r=this._getValueFromEditing(a,s,u,c),l.isValid(a,s,r)||(i=l._validationError(a,s,u),l._eventHandler._forceCancelSelectiong=!0)),i},n.prototype._applyEditing=function(o){var n,r,i,a,s,l,u,c,h,p,d,f=this,g=f._sheet,m=f._cellEditInfo.newValue,_=f._validateEditingValue();if(1===_||2===_)return _;if(r=!f._cellEditInfo.hasOwnProperty("autoFormat")||f._cellEditInfo.autoFormat,t.util.hasCalc())if(i=!g.parent||g.parent.canUserEditFormula(),a=(a=f._cellEditInfo.row)>=0?a:0,s=(s=f._cellEditInfo.col)>=0?s:0,l=e.Sheets.Calc.Parser.getParserOption(),u={numberDecimalSeparator:e.Sheets.CR.numberDecimalSeparator,arrayListSeparator:e.Sheets.CR.arrayListSeparator,arrayGroupSeparator:e.Sheets.CR.arrayGroupSeparator,listSeparator:e.Sheets.CR.listSeparator},e.Sheets.Calc.Parser.setParserOption(u),c=g.getCalcService(),i&&c&&m&&m.length>0&&"="===m[0])try{if(f._cellEditInfo.ranges&&1===f._cellEditInfo.endEditType)return p=f._cellEditInfo.ranges[0],g.setArrayFormula(p.row,p.col,p.rowCount,p.colCount,m.substring(1)),e.Sheets.Calc.Parser.setParserOption(l),_;h=c.parse(g._getSheetSource(),m.substring(1),a,s)}catch(e){throw g._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}else f._cellEditInfo.ranges&&1===f._cellEditInfo.endEditType&&(p=f._cellEditInfo.ranges[0],g.clear(p.row,p.col,p.rowCount,p.colCount,3,1));return h||(d=!1,/^('=)/gi.test(m)&&(m=m.substring(1),d=!0),(n===ae||n===ie||d)&&(n=f._getValueFromEditing(a,s,m,r))),f.iteration(function(e,t){if(h)try{e==a&&t==s?g.setFormula(e,t,c.unparse(g._getSheetSource(),h,e,t)):g.setFormula(e,t,c.unparseWithoutCulture(g._getSheetSource(),h,e,t)),g.triggerUserFormulaEntered({sheet:g,sheetName:g._name,row:e,col:t,formula:m.substring(1).toUpperCase()})}catch(e){throw g._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}else{try{g.hasFormula(e,t)&&g.setFormula(e,t,ie)}catch(e){throw g._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}try{g._setValueInternal(e,t,n)}catch(o){g.setValue(e,t,m)}}}),t.util.hasCalc()&&e.Sheets.Calc.Parser.setParserOption(l),_},n.prototype.canUndo=function(){return this._canUndo},n.prototype._getValueFromEditing=function(e,o,n,r){var i,a,s,l;if(!t.features.formatter)return n;var u=this._sheet.getActualStyle(e,o),c={},h=t.util.parseText2Value(u,n,r,c),p=c.value;return r&&c.value&&(i=ie,r&&p&&(h!==ie&&"General"!==p.FormatString()||!u._autoFormatter)&&(i=new t.AutoFormatter(p)),i&&(s="string"==typeof(a=this._sheet.getStyleObject(e,o)),(!a||s)&&(l=new t.Style,s&&(l.parentName=a),a=l),a._autoFormatter=i,this._sheet.setStyle(e,o,a))),h},n}(u),o.CellEditUndoAction=A,I=function(e){function t(t,o){e.call(this),this._sheet=t,this._newName=o,this._oldName=ie}return __extends(t,e),t.prototype.canUndo=function(){return!!this._oldName},t.prototype.canExecute=function(e){return this._sheet&&this._newName&&this._newName!==this._oldName},t.prototype.execute=function(e){var t=this._sheet;t&&this._newName&&this._newName!==this._oldName&&(this.saveState(),this._suspendInvalidate(e),t.setNameCore(this._newName),this._resumeInvalidate(e),t._refreshTabStrip())},t.prototype.saveState=function(){this._sheet&&(this._oldName=this._sheet._name)},t.prototype.undo=function(e){var t=this._sheet;return!!t&&(this._suspendInvalidate(e),t.setNameCore(this._oldName),this._resumeInvalidate(e),t._refreshTabStrip(),!0)},t}(u),o.SheetRenameUndoAction=I,D=function(e){function t(t,o){e.call(this),this._sheet=t,o<.25?o=.25:o>4&&(o=4),this._zoomFactor=o,this._prevZoomFactor=-1}return __extends(t,e),t.prototype.canExecute=function(e){return this._sheet&&this._sheet.parent._allowUserZoom&&this._sheet._zoomFactor!==this._zoomFactor},t.prototype.execute=function(e){var t,o=this._sheet;if(this.saveState(),o&&(!o.parent||!0===o.parent._allowUserZoom)&&o._zoomFactor!==this._zoomFactor){if(!0===o.isEditing()&&!o.endEdit())return;this._suspendInvalidate(e),t=o.isPaintSuspended(),o.isPaintSuspended(!0),o.zoom(this._zoomFactor),o.isPaintSuspended(t),this._resumeInvalidate(e)||(o.invalidateLayout(),o.repaint())}},t.prototype.canUndo=function(){return this._sheet&&this._prevZoomFactor>0},t.prototype.saveState=function(){this._sheet&&(this._prevZoomFactor=this._sheet._zoomFactor)},t.prototype.undo=function(e){var t,o=this._sheet;return!!o&&(this._suspendInvalidate(e),t=o.isPaintSuspended(),o.isPaintSuspended(!0),o.zoom(this._prevZoomFactor),o.isPaintSuspended(t),this._resumeInvalidate(e)||(o.invalidateLayout(),o.repaint()),!0)},t}(u),o.ZoomUndoAction=D,F=function(e,t){this.value=e,this.formulaInfo=t},M=function(e){function o(t,o){e.call(this),this._cachedFormulaInfos=[],this._eventNS=".clearRangeAction",this._sheet=t,this._clearRange=o,this._cachedFilteredColumns=ie,this._cachedValues=ie,this._cachedTables=ie}return __extends(o,e),o.prototype.execute=function(e){var o,n,r;if(this.saveState(),(o=this._sheet)&&(n=o._getActualRange(this._clearRange)).colCount>0&&n.rowCount>0)try{o._bind(t.Events.CellChanged+this._eventNS,function(e,t){"value"===t.propertyName&&o._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),r=o.isPaintSuspended(),o.isPaintSuspended(!0),o.suspendEvent(),o.clear(n.row,n.col,n.rowCount,n.colCount,3,1),o.resumeEvent(),o.isPaintSuspended(r),l.raiseRangeDataChanged(o,n.row,n.col,n.rowCount,n.colCount,this._changedCells.getChangedCells(),2)}finally{this._sheet._unbind(t.Events.CellChanged+this._eventNS)}},o.prototype.canExecute=function(e){var t=this._sheet,o=this._clearRange;return!(!0===t.isProtected&&t._isAnyCellInRangeLocked(o))&&t._checkArrayFormula(o.row,o.col,o.rowCount,o.colCount)},o.prototype.canUndo=function(){return!!this._cachedValues},o.prototype.saveState=function(){var e,t,o,r,i,a,s,l,u,c,h,p,d,f=this,g=f._sheet;if(g){if(f._cachedTables=[],(e=g.getTables())&&e.length>0)for(c=0;c<e.length;c++)t=e[c],f._clearRange.containsRange(t.range())&&f._cachedTables.push(t);if(f._cachedFilteredColumns=[],(o=g.rowFilter())&&o.range&&o.isFiltered()&&(r=o.range.row,a=o.range.rowCount,o.filterButtonVisible&&o.filterButtonVisible()&&(r=o.range.row-1,a=o.range.rowCount+1,r<0&&(r=-1,a=-1)),(-1===f._clearRange.row||f._clearRange.row<=r&&r+a<=f._clearRange.row+f._clearRange.rowCount)&&(-1===f._clearRange.col||f._clearRange.col<=o.range.col&&o.range.col+o.range.colCount<=f._clearRange.col+f._clearRange.colCount)))for(i=o.range.col<0?0:o.range.col,s=o.range.colCount<0?g.getColumnCount():o.range.colCount,l=0;l<s;l++)o.isColumnFiltered(i+l)&&f._cachedFilteredColumns.push(i+l);if((u=g._getActualRange(f._clearRange)).colCount>0&&u.rowCount>0)for(f._cachedValues=[u.row+u.rowCount],c=0;c<u.rowCount;c++)for(f._cachedValues[u.row+c]=[u.col+u.colCount],f._cachedFormulaInfos[u.row+c]=[],h=0;h<u.colCount;h++)r=u.row+c,i=u.col+h,(p=g.getFormulaInformation(r,i)).hasFormula?f._cachedValues[r][i]=!p.isArrayFormula||p.baseRange.row===r&&p.baseRange.col===i?new F(p.formula,p):-1:(d=g.getValue(r,i))!==ae&&d!==ie&&(f._cachedValues[r][i]=new F(d,ae));f._changedCells=new n(g,g._getActualRange(f._clearRange),3)}},o.prototype.undo=function(e){var o,n,r,i,a,s,u,c,h,p,d,f,g=this,m=g._sheet;if(m){if(o=!1,g._cachedTables&&g._cachedTables.length>0)for(i=(r=g._cachedTables).length,n=0;n<i;n++)m._addTableInternal(r[n]);if(a=m._getActualRange(g._clearRange),g._cachedValues&&a.colCount>0&&a.rowCount>0){s=m.isPaintSuspended(),m.isPaintSuspended(!0),m.suspendEvent();try{for(m._bind(t.Events.CellChanged+g._eventNS,function(e,t){"value"===t.propertyName&&m._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),u=a.rowCount,c=a.colCount,n=0;n<u;n++)for(h=0;h<c;h++){var _=a.row+n,y=a.col+h,C=g._cachedValues[_][y];-1!==C&&(C?C.formulaInfo?(p=C.formulaInfo)&&p.isArrayFormula?m.setArrayFormula(_,y,p.baseRange.rowCount,p.baseRange.colCount,p.formula):m.setFormula(_,y,C.value):(m.setFormula(_,y,ie),m.setValue(_,y,C.value)):(m.setFormula(_,y,ie),m.setValue(_,y,ie)))}o=!0}finally{m._unbind(t.Events.CellChanged+g._eventNS),m.resumeEvent(),m.isPaintSuspended(s)}}if(o&&l.raiseRangeDataChanged(m,a.row,a.col,a.rowCount,a.colCount,g._changedCells.getChangedCells(),2),(d=m.rowFilter())&&g._cachedFilteredColumns&&g._cachedFilteredColumns.length>0)for(n=0;n<g._cachedFilteredColumns.length;n++)f=g._cachedFilteredColumns[n],d.filter(f);if(o)return m.repaint(),!0}return!1},o}(u),o.ClearRangeValueUndoAction=M,E=function(e){function t(t,o){var n;if(e.call(this),this._cachedActions=[],this._sheet=t,this._cachedActions=ie,o&&o.length>0)for(this._cachedActions=[],n=0;n<o.length;n++)this._cachedActions[n]=new M(t,o[n])}return __extends(t,e),t.prototype.canExecute=function(e){var t;if(this._cachedActions){for(t=0;t<this._cachedActions.length;t++)if(!this._cachedActions[t].canExecute(e))return!1;return!0}return!1},t.prototype.execute=function(e){var t;if(this.saveState(),this._cachedActions){for(this._suspendInvalidate(e),t=0;t<this._cachedActions.length;t++)this._cachedActions[t].execute(e);this._resumeInvalidate(e)||(this._sheet.invalidateLayout(),this._sheet.repaint())}},t.prototype.canUndo=function(){var e;if(this._cachedActions){for(e=0;e<this._cachedActions.length;e++)if(!this._cachedActions[e].canUndo())return!1;return!0}return!1},t.prototype.saveState=function(){var e;if(this._cachedActions)for(e=0;e<this._cachedActions.length;e++)this._cachedActions[e].saveState()},t.prototype.undo=function(e){var t,o,n,r;if(this._cachedActions){for(t=this._cachedActions.length-1;t>=0;t--){if(o=this._cachedActions[t],this._suspendInvalidate(e),n=o.undo(e),r=this._resumeInvalidate(e),!n)return!1;r||(this._sheet.invalidateLayout(),this._sheet.repaint())}return!0}return!1},t}(u),o.ClearValueUndoAction=E,N=function(e,t,o,n){this.startRange=e,this.fillRange=t,this.autoFillType=o,this.fillDirection=n},o.DragFillExtent=N,O=function(e){function o(t,o){e.call(this),this._workSheet=t,this._dragFillExtent=o,4===this._dragFillExtent.autoFillType?this._clearValueUndoAction=new E(t,[this._dragFillExtent.fillRange]):this.initWholeFilledRange(),this._fillSeries=0===this._dragFillExtent.fillDirection||1===this._dragFillExtent.fillDirection?1:0}return __extends(o,e),o.prototype.canExecute=function(e){var t=this._workSheet,o=this._dragFillExtent;return(!t.isProtected||!t._isAnyCellInRangeLocked(o.fillRange))&&!!t._checkArrayFormula(o.fillRange.row,o.fillRange.col,o.fillRange.rowCount,o.fillRange.colCount)&&(4===this._dragFillExtent.autoFillType?this.canExecuteDragClear():this.canExecuteDragFill())},o.prototype.canExecuteDragClear=function(){return!0},o.prototype.canExecuteDragFill=function(){var e=this._dragFillExtent.startRange;return!this._dragFillExtent.fillRange.intersect(e.row,e.col,e.rowCount,e.colCount)},o.prototype.execute=function(e){var t,o,r,i=this;if(i.canExecute(e)){var a,s=i._workSheet,u=s.getSelections();try{i._suspendInvalidate(s),s.suspendCalcService(),s.suspendEvent(),i.saveState(),t=s.isPaintSuspended(),s.isPaintSuspended(!0),4===i._dragFillExtent.autoFillType?i.executeDragFillClear(s):i.executeDragFill(s)}finally{s.isPaintSuspended(t),s.resumeCalcService(),s.resumeEvent(),o=i._dragFillExtent.fillRange,i._savedAfterFilledChangedCells=new n(i._workSheet,o,1023),i._savedAfterFilledChangedCells.mergeCellsHasDiffData(i._savedBeforeFillChangedCells.getCellsHasData()),l.raiseRangeDataChanged(s,o.row,o.col,o.rowCount,o.colCount,i._savedAfterFilledChangedCells.getChangedCells(),1,i._savedFilledViewportCells.getValues()),r=s.getSelections(),s._raiseSelectionChanging(u,r)&&s._raiseSelectionChanged(),a=i._resumeInvalidate(s)}a||(s.invalidateLayout(),s.repaint())}},o.prototype.executeDragFillClear=function(e){var o,n,r;this._clearValueUndoAction.execute(e),o=this._dragFillExtent.startRange,n=this._dragFillExtent.fillRange,o.equals(n)||(0===this._fillSeries?(r=new t.Range(o.row,o.col,le(1,o.rowCount-n.rowCount),o.colCount),e._setActiveCellImp(le(e._getFirstVisualRow(),r.row),le(e._getFirstVisualColumn(),r.col),e.activeRowViewportIndex,e.activeColViewportIndex),e._clearSelectionImp(),e.addSelection(r.row,r.col,r.rowCount,r.colCount)):(r=new t.Range(o.row,o.col,o.rowCount,le(1,o.colCount-n.colCount)),e._setActiveCellImp(le(e._getFirstVisualRow(),r.row),le(e._getFirstVisualColumn(),r.col),e.activeRowViewportIndex,e.activeColViewportIndex),e._clearSelectionImp(),e.addSelection(r.row,r.col,r.rowCount,r.colCount)))},o.prototype.executeDragFill=function(e){var o,n,r,i,a=this,s=a._workSheet,u=a._dragFillExtent.startRange,c=a._dragFillExtent.fillRange;if(1===a._dragFillExtent.autoFillType)s.fillAuto(u,a._wholeFillRange,a._fillSeries);else if(0===a._dragFillExtent.autoFillType)a.copyCells(u,c,1019);else if(2===a._dragFillExtent.autoFillType)a.copyCells(u,c,64);else if(3===a._dragFillExtent.autoFillType)if(1!==u.rowCount||1!==u.colCount||-1===u.row&&-1!==u.col||-1===u.col&&-1!==u.row){for(r=a.adjustRange(a._wholeFillRange),i=new t._GcSheetModel(r.rowCount,r.colCount,ie),o=0;o<r.rowCount;o++)for(n=0;n<r.colCount;n++)i.setStyle(o,n,l.getStyleObject(a._workSheet,r.row+o,r.col+n,3));for(s.fillAuto(u,a._wholeFillRange,a._fillSeries),o=0;o<r.rowCount;o++)for(n=0;n<r.colCount;n++)l.setStyleObject(a._workSheet,r.row+o,r.col+n,3,i.getStyle(o,n))}else a.copyCells(u,c,187);s._setActiveCellImp(le(e._getFirstVisualRow(),a._wholeFillRange.row),le(e._getFirstVisualColumn(),a._wholeFillRange.col),e.activeRowViewportIndex,e.activeColViewportIndex),e._selectionModel&&e._clearSelectionImp(),s.addSelection(a._wholeFillRange.row,a._wholeFillRange.col,a._wholeFillRange.rowCount,a._wholeFillRange.colCount)},o.prototype.clearData=function(e,t){this._workSheet.clearCore(e.row,e.col,e.rowCount,e.colCount,3,1,t)},o.prototype.adjustRange=function(e){var o=-1!==e.row?e.row:0,n=-1!==e.col?e.col:0,r=-1!==e.rowCount?e.rowCount:this._workSheet.getRowCount(),i=-1!==e.colCount?e.colCount:this._workSheet.getColumnCount();return new t.Range(o,n,r,i)},o.prototype.copyCells=function(e,t,o){var n,r,i,a,s,l,u,c,h,p,d,f,g,m=this,_=m._workSheet,y=m.adjustRange(e),C=m.adjustRange(t);if(0===m._fillSeries){for(c=ue(C.rowCount/y.rowCount),n=0;n<c;n++)r=y.row,i=y.col,a=3===m._dragFillExtent.fillDirection?C.row+n*y.rowCount:C.row+C.rowCount-(n+1)*y.rowCount,s=C.col,l=y.rowCount,u=y.colCount,_.copyToCore(r,i,a,s,l,u,o,!0);0!=(h=C.rowCount%y.rowCount)&&(3===m._dragFillExtent.fillDirection?r=y.row:(p=y.rowCount-(C.rowCount-y.rowCount*c),r=y.row+p),i=y.col,a=3===m._dragFillExtent.fillDirection?C.row+y.rowCount*c:C.row+C.rowCount-c*y.rowCount-h,s=C.col,l=h,u=y.colCount,_.copyToCore(r,i,a,s,l,u,o,!0))}else{for(d=ue(C.colCount/y.colCount),n=0;n<d;n++)r=y.row,i=y.col,a=C.row,s=1===m._dragFillExtent.fillDirection?C.col+n*y.colCount:C.col+C.colCount-(n+1)*y.colCount,l=y.rowCount,u=y.colCount,_.copyToCore(r,i,a,s,l,u,o,!0);0!=(f=C.colCount%y.colCount)&&(r=y.row,1===m._dragFillExtent.fillDirection?i=y.col:(g=y.colCount-(C.colCount-y.colCount*d),i=y.col+g),a=C.row,s=1===m._dragFillExtent.fillDirection?C.col+y.colCount*d:C.col+C.colCount-d*y.colCount-f,l=y.rowCount,u=f,_.copyToCore(r,i,a,s,l,u,o,!0))}},o.prototype.saveState=function(){4===this._dragFillExtent.autoFillType?this.saveDragClearState():this.saveDragFillState(),this._savedBeforeFillChangedCells=new n(this._workSheet,this._dragFillExtent.fillRange,1023),this._savedFilledViewportCells=this.saveRangeStates(this._dragFillExtent.fillRange)},o.prototype.saveDragClearState=function(){this._clearValueUndoAction.saveState()},o.prototype.saveDragFillState=function(){this._savedStartViewportCells=this.saveRangeStates(this._dragFillExtent.startRange)},o.prototype.saveRangeStates=function(e){var t=this.adjustRange(e),o=new i(t.rowCount,t.colCount);return l.saveViewportInfo(this._workSheet,o,t.row,t.col,1023),o},o.prototype.undo=function(e){var t,o,n=this._workSheet,r=!1;try{this._suspendInvalidate(n),n.suspendCalcService(),o=n.isPaintSuspended(),n.isPaintSuspended(!0),r=this._undo(n)}finally{n.isPaintSuspended(o),n.resumeCalcService(),t=this._resumeInvalidate(n)}return t||(n.invalidateLayout(),n.repaint()),r},o.prototype._undo=function(e){var t,o,n=e.getSelections(),r=this._dragFillExtent.fillRange,i=l.getValues(this._workSheet,r.row,r.col,r.rowCount,r.colCount);return t=4===this._dragFillExtent.autoFillType?this.undoDragClear(e):this.undoDragFill(e),!0!==e._skipCloseDragFillSmartTag&&e._closeDragFillPopup(),l.raiseRangeDataChanged(e,r.row,r.col,r.rowCount,r.colCount,this._savedAfterFilledChangedCells.getChangedCells(),1,i),o=e.getSelections(),e._raiseSelectionChanging(n,o)&&e._raiseSelectionChanged(),t},o.prototype.undoDragClear=function(e){var t=this._clearValueUndoAction.undo(e);return e._setActiveCellImp(le(e._getFirstVisualRow(),this._dragFillExtent.startRange.row),le(e._getFirstVisualColumn(),this._dragFillExtent.startRange.col),e.activeRowViewportIndex,e.activeColViewportIndex),e._clearSelectionImp(),e.addSelection(this._dragFillExtent.startRange.row,this._dragFillExtent.startRange.col,this._dragFillExtent.startRange.rowCount,this._dragFillExtent.startRange.colCount),t},o.prototype.undoDragFill=function(e){var t=this;t._suspendInvalidate(e),e.suspendCalcService();try{t.undoRangeStates(t._savedFilledViewportCells,t._dragFillExtent.fillRange),t.undoRangeStates(t._savedStartViewportCells,t._dragFillExtent.startRange),e._setActiveCellImp(le(e._getFirstVisualRow(),t._dragFillExtent.startRange.row),le(e._getFirstVisualColumn(),t._dragFillExtent.startRange.col),e.activeRowViewportIndex,e.activeColViewportIndex),e._clearSelectionImp(),e.addSelection(t._dragFillExtent.startRange.row,t._dragFillExtent.startRange.col,t._dragFillExtent.startRange.rowCount,t._dragFillExtent.startRange.colCount)}finally{e.resumeCalcService(!1),t._resumeInvalidate(e)}return e.invalidateLayout(),!0},o.prototype.undoRangeStates=function(e,t){var o=this.adjustRange(t);l.undoCellsInfo(this._workSheet,e,o.row,o.col,3)},o.prototype.initWholeFilledRange=function(){var e=0,o=0,n=0,r=0,i=this._dragFillExtent.fillDirection,a=this._dragFillExtent.startRange,s=this._dragFillExtent.fillRange;0===i||1===i?(e=a.row,o=a.rowCount,n=0===i?s.col:a.col,r=a.colCount+s.colCount):(e=2===i?s.row:a.row,o=a.rowCount+s.rowCount,n=a.col,r=a.colCount),this._wholeFillRange=new t.Range(e,n,o,r)},o}(u),o.DragFillUndoAction=O,P=function(e){function r(t,o,n){e.call(this),this._sheet=t,this._fillRange=n,this._fillType=o}return __extends(r,e),r.prototype.execute=function(e){var t,o,r,a,s=this,u=s._sheet;s._suspendInvalidate(u),s.saveState(),t=u.isPaintSuspended(),u.isPaintSuspended(!0);try{o=s.adjustRange(s._fillRange),r=new i(o.rowCount,o.colCount),l.saveViewportInfo(s._sheet,r,o.row,o.col,1023),s._savedFilledViewportCells=r;var c=u._eventHandler,h={sheet:u,sheetName:u._name,fillRange:s._fillRange,autoFillType:s._fillType,fillDirection:c.getCurrentFillDirection()},p=u._raiseDragFillBlock(h);c._currentDragFillType=h.autoFillType,c._isCancelDragFill=p,s.executeDragFillAction(e,h),u._raiseDragFillBlockCompleted(h)}finally{u.isPaintSuspended(t),a=s._fillRange,s._savedAfterFilledChangedCells=new n(u,a,1023),s._savedAfterFilledChangedCells.mergeCellsHasDiffData(s._savedBeforeFillChangedCells.getCellsHasData()),l.raiseRangeDataChanged(u,a.row,a.col,a.rowCount,a.colCount,s._savedAfterFilledChangedCells.getChangedCells(),1,s._savedFilledViewportCells.getValues())}s._resumeInvalidate(u)||s.refreshUI(e)},r.prototype.executeDragFillAction=function(e,t){var n,r=this._sheet,i=r._eventHandler,a=this._fillRange,s=this._fillType;if(i._currentDragFillType=s,n=r._getActualRange(a),i._preFillCellsInfo=new o.CopyMoveCellsInfo(n.rowCount,n.colCount),o.CopyMoveHelper.saveViewportInfo(r,i._preFillCellsInfo,n.row,n.col,1023),!i._isCancelDragFill){var l=5===t.autoFillType?s:t.autoFillType,u={startRange:i._dragFillStartRange,fillRange:a,autoFillType:l,fillDirection:i.getCurrentFillDirection()},c=new O(r,u);r.suspendEvent(),c.execute(e),r.resumeEvent(),this._dragFillUndoAction=c}},r.prototype.canExecute=function(e){return!0},r.prototype.canUndo=function(){return!0},r.prototype.refreshUI=function(e){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},r.prototype.adjustRange=function(e){var o=-1!==e.row?e.row:0,n=-1!==e.col?e.col:0,r=-1!==e.rowCount?e.rowCount:this._sheet.getRowCount(),i=-1!==e.colCount?e.colCount:this._sheet.getColumnCount();return new t.Range(o,n,r,i)},r.prototype.saveState=function(){this._savedBeforeFillChangedCells=new n(this._sheet,this._fillRange,1023)},r.prototype.undo=function(e){var t,o,r,i=this,a=i._sheet,s=!0;i._suspendInvalidate(a),a.suspendEvent(),i.saveState(),t=a.isPaintSuspended(),a.isPaintSuspended(!0),o=ie;try{r=i._fillRange,o=l.getValues(i._sheet,r.row,r.col,r.rowCount,r.colCount),s=i._dragFillUndoAction.undo(e)}finally{a.isPaintSuspended(t),a.resumeEvent(),i._savedAfterFilledChangedCells=new n(a,r,1023),i._savedAfterFilledChangedCells.mergeCellsHasDiffData(i._savedBeforeFillChangedCells.getCellsHasData()),l.raiseRangeDataChanged(a,r.row,r.col,r.rowCount,r.colCount,i._savedAfterFilledChangedCells.getChangedCells(),1,o),i._resumeInvalidate(a)||i.refreshUI(e)}return s},r}(u),o.FillUndoAction=P,L=function(e,t,o,n){this.sourceRange=e,this.targetRange=t,this.isCutting=o,this.clipboardText=n},o.PasteRangeExtent=L,H=function(e){function o(t,o,n,r,i){e.call(this),this._sheet=t,this._fromSheet=o,this._toSheet=n,this._pasteExtent=r,this._pasteOption=i}return __extends(o,e),o.prototype.canUndo=function(){return!0},o.prototype.canExecute=function(e){var t=this._sheet,o=this._pasteExtent.targetRange,n=this._pasteExtent.sourceRange;return!(t.isProtected&&t._isAnyCellInRangeLocked(o))&&t._checkArrayFormula(o.row,o.col,o.rowCount,o.colCount)&&(!this._pasteExtent.isCutting||!(t.isProtected&&t._isAnyCellInRangeLocked(n))&&t._checkArrayFormula(n.row,n.col,n.rowCount,n.colCount))},o.prototype.saveState=function(){var e,u,c,h,p,d,f,g,m,_,y,C,w,v,S=this;S.initSaveState();var x=S._pasteExtent.isCutting,R=o.convertPasteOption(S._pasteOption),b=S._pasteExtent.sourceRange,T=S._pasteExtent.targetRange;if(S._fromSheet&&b&&x){var A=b.row<0?0:b.row,I=b.col<0?0:b.col,D=b.row<0?S._fromSheet.getRowCount():b.rowCount,F=b.col<0?S._fromSheet.getColumnCount():b.colCount;b.row<0&&b.col<0&&T.row<0&&T.col<0&&S._fromSheet._name!==S._toSheet._name&&(e=new r,l.saveSheetInfo(S._fromSheet,e,R),S._savedFromSheetInfo=e),b.row<0&&(u=new i(S._fromSheet.getRowCount(1),F),c=new a(F),l.saveColumnHeaderInfo(S._fromSheet,u,c,I,R),S._savedFromColumnHeaderCells=u,S._savedFromColumns=c),b.col<0&&(h=new i(D,S._fromSheet.getColumnCount(2)),p=new s(D),l.saveRowHeaderInfo(S._fromSheet,h,p,A,R),S._savedFromRowHeaderCells=h,S._savedFromRows=p),d=new i(D,F),l.saveViewportInfo(S._fromSheet,d,A,I,R),S._savedFromViewportCells=d,f=[],l.saveTableInfo(S._sheet,f,new t.Range(A,I,D,F)),S._savedFromTables=f,S._savedFromBeforePastedChangedCells=new n(S._fromSheet,b,R)}var M=T.row<0?0:T.row,E=T.col<0?0:T.col,N=T.row<0?S._toSheet.getRowCount():T.rowCount,O=T.col<0?S._toSheet.getColumnCount():T.colCount;S._fromSheet&&b&&(b.row<0&&b.col<0&&T.row<0&&T.col<0&&S._fromSheet._name!==S._toSheet._name&&(g=new r,l.saveSheetInfo(S._toSheet,g,R),S._savedToSheetInfo=g),b.row<0&&(m=new i(S._toSheet.getRowCount(1),O),_=new a(O),l.saveColumnHeaderInfo(S._toSheet,m,_,E,R),S._savedToColumnHeaderCells=m,S._savedToColumns=_),b.col<0&&(y=new i(N,S._toSheet.getColumnCount(2)),C=new s(N),l.saveRowHeaderInfo(S._toSheet,y,C,M,R),S._savedToRowHeaderCells=y,S._savedToRows=C)),w=new i(N,O),l.saveViewportInfo(S._toSheet,w,M,E,R),S._savedToViewportCells=w,v=[],l.saveTableInfo(S._sheet,v,new t.Range(M,E,N,O)),S._savedToTables=v,S._savedToBeforePastedChangedCells=new n(S._toSheet,T,R)},o.prototype.initSaveState=function(){var e=this;e._savedFromSheetInfo=ie,e._savedFromColumnHeaderCells=ie,e._savedFromColumns=ie,e._savedFromViewportCells=ie,e._savedFromRowHeaderCells=ie,e._savedFromRows=ie,e._savedToSheetInfo=ie,e._savedToColumnHeaderCells=ie,e._savedToColumns=ie,e._savedToViewportCells=ie,e._savedToRowHeaderCells=ie,e._savedToRows=ie},o.prototype.pasteOption=function(){return this._pasteOption},o.prototype.pasteRange=function(){return this._pasteExtent.targetRange},o.prototype.execute=function(e){var r,i,a,s=this,u=s._fromSheet,c=s._toSheet,h=s._pasteExtent.sourceRange,p=s._pasteExtent.targetRange;if((!u||!h||u._isValidRange(h.row,h.col,h.rowCount,h.colCount,u.getRowCount(),u.getColumnCount()))&&c&&p&&c._isValidRange(p.row,p.col,p.rowCount,p.colCount,c.getRowCount(),c.getColumnCount())){s.saveState(),s._suspendInvalidate(e),c.suspendEvent(),u&&u.suspendEvent();try{h&&t._CacheMgr.startCache(u,h.row,h.col,h.row+h.rowCount-1,h.col+h.colCount-1),c._clipboardPaste(u,h,c,p,s._pasteExtent.isCutting,s._pasteExtent.clipboardText,s._pasteOption)}finally{c.resumeEvent(),u&&u.resumeEvent(),s._resumeInvalidate(e),s._sheet&&(r=s._savedFromViewportCells,s._pasteExtent.isCutting&&r&&u&&r.isValueOrFormulaSaved()&&(a=o.convertPasteOption(s._pasteOption),s._savedFromAfterPastedChangedCells=new n(u,h,a),s._savedFromAfterPastedChangedCells.mergeCellsHasDiffData(s._savedFromBeforePastedChangedCells.getCellsHasData()),l.raiseRangeDataChanged(u,h.row,h.col,h.rowCount,h.colCount,s._savedFromAfterPastedChangedCells.getChangedCells(),3,r.getValues())),(i=s._savedToViewportCells)&&c&&i.isValueOrFormulaSaved()&&(a=o.convertPasteOption(s._pasteOption),s._savedToAfterPastedChangedCells=new n(c,p,a),s._savedToAfterPastedChangedCells.mergeCellsHasDiffData(s._savedToBeforePastedChangedCells.getCellsHasData()),l.raiseRangeDataChanged(c,p.row,p.col,p.rowCount,p.colCount,s._savedToAfterPastedChangedCells.getChangedCells(),3,i.getValues()))),h&&t._CacheMgr.clearCache()}}},o.prototype.undo=function(e){var o,n,r,i=this,a=i._pasteExtent.sourceRange,s=i._pasteExtent.targetRange;if(!i._toSheet||!s||!i._toSheet._isValidRange(s.row,s.col,s.rowCount,s.colCount,i._toSheet.getRowCount(),i._toSheet.getColumnCount())||i._fromSheet&&a&&(!i._fromSheet._isValidRange(a.row,a.col,a.rowCount,a.colCount,i._fromSheet.getRowCount(),i._fromSheet.getColumnCount())||i._fromSheet&&i._fromSheet._name===i._toSheet._name&&i._toSheet.parent&&!t.ArrayHelper.contains(i._toSheet.parent.sheets,i._fromSheet)))return!1;i._suspendInvalidate(e),o=!1;try{var u=ie,c=ie,h=s.row<0?0:s.row,p=s.col<0?0:s.col,d=s.row<0?i._toSheet.getRowCount():s.rowCount,f=s.col<0?i._toSheet.getColumnCount():s.colCount;l.clearFormula(i._toSheet,h,p,d,f),i._savedToTables&&l.undoTableInfo(i._sheet,i._savedToTables,new t.Range(h,p,d,f)),i._savedToSheetInfo&&(l.undoSheetInfo(i._toSheet,i._savedToSheetInfo),o=!0),(n=i._savedToViewportCells)&&n.isValueOrFormulaSaved()&&(u=l.getValues(i._toSheet,h,p,d,f)),i._savedToColumnHeaderCells&&(l.undoCellsInfo(i._toSheet,i._savedToColumnHeaderCells,0,p,1),o=!0),i._savedToColumns&&(l.undoColumnsInfo(i._toSheet,i._savedToColumns,p),o=!0),n&&(l.undoCellsInfo(i._toSheet,n,h,p,3),o=!0),i._savedToRowHeaderCells&&(l.undoCellsInfo(i._toSheet,i._savedToRowHeaderCells,h,0,2),o=!0),i._savedToRows&&(l.undoRowsInfo(i._toSheet,i._savedToRows,h),o=!0);var g=0,m=0,_=0,y=0;i._fromSheet&&a&&(g=a.row<0?0:a.row,m=a.col<0?0:a.col,_=a.row<0?i._fromSheet.getRowCount():a.rowCount,y=a.col<0?i._fromSheet.getColumnCount():a.colCount,i._savedFromTables&&l.undoTableInfo(i._sheet,i._savedFromTables,new t.Range(g,m,_,y)),(r=i._savedFromViewportCells)&&r.isValueOrFormulaSaved()&&(c=l.getValues(i._fromSheet,g,m,_,y)),i._savedFromColumnHeaderCells&&(l.undoCellsInfo(i._fromSheet,i._savedFromColumnHeaderCells,0,m,1),o=!0),i._savedFromColumns&&(l.undoColumnsInfo(i._fromSheet,i._savedFromColumns,m),o=!0),r&&(l.undoCellsInfo(i._fromSheet,r,g,m,3),o=!0),i._savedFromRowHeaderCells&&(l.undoCellsInfo(i._fromSheet,i._savedFromRowHeaderCells,g,0,2),o=!0),i._savedFromRows&&(l.undoRowsInfo(i._fromSheet,i._savedFromRows,g),o=!0)),o&&e&&(u&&i._toSheet&&l.raiseRangeDataChanged(i._toSheet,h,p,d,f,i._savedToAfterPastedChangedCells.getChangedCells(),3,u),c&&i._fromSheet&&l.raiseRangeDataChanged(i._fromSheet,g,m,_,y,i._savedFromAfterPastedChangedCells.getChangedCells(),3,c))}finally{i._resumeInvalidate(e)}return o},o.convertPasteOption=function(e){var t=0;return(0===e||1===e)&&(t|=1),(0===e||2===e)&&(t|=64,t|=32),(0===e||3===e)&&(t|=2),0===e&&(t|=32,t|=16,t|=256,t|=4,t|=512,t|=128),t},o}(u),o.ClipboardPasteRangeUndoAction=H,k=function(e,t,o,n){this.fromRange=e,this.pastedRanges=t,this.isCutting=o,this.clipboardText=n},o.PasteExtent=k,V=function(e){function o(o,n,r,i,a){var s,l;if(e.call(this),this._sheet=o,!r)throw new Error(t.SR.Exp_DestSheetIsNull);if(!i)throw new Error(t.SR.Exp_PasteExtentIsNull);if(i.pastedRanges&&i.pastedRanges.length>0)for(this._cachedActions=[],s=0;s<i.pastedRanges.length;s++)l={sourceRange:i.fromRange,targetRange:i.pastedRanges[s],isCutting:i.isCutting,clipboardText:i.clipboardText},this._cachedActions[s]=new H(o,n,r,l,a)}return __extends(o,e),o.prototype.execute=function(e){var t,o,n,r;if(this._cachedActions){t=this._sheet,this._suspendInvalidate(t),o=t.isPaintSuspended(),t.isPaintSuspended(!0);try{for(n=0;n<this._cachedActions.length;n++)r=this._cachedActions[n],t?t._raiseClipboardPasting(r.pasteRange(),r.pasteOption())||(r.execute(e),t._raiseClipboardPasted(r.pasteRange(),r.pasteOption())):r.execute(e);this.refreshSelection(e)}finally{t.isPaintSuspended(o),this._resumeInvalidate(t)||this.refreshUI(e)}}},o.prototype.refreshSelection=function(e){var t,o,n,r,i=this._sheet;if(i&&this._cachedActions){if(t=i.getSelections(),i._clearSelectionImp(),this._cachedActions.length>1)for(o=0;o<this._cachedActions.length;o++)n=this._cachedActions[o].pasteRange(),i.addSelection(n.row,n.col,n.rowCount,n.colCount);else this._cachedActions.length>0&&(r=this._cachedActions[0].pasteRange(),i.addSelection(r.row,r.col,r.rowCount,r.colCount),r.contains(i._activeRowIndex,i._activeColIndex)||i._setActiveCellImp(le(i._getFirstVisualRow(),r.row),le(i._getFirstVisualColumn(),r.col),i.activeRowViewportIndex,i.activeColViewportIndex));i._raiseSelectionChanging(t,i.getSelections())&&i._raiseSelectionChanged()}},o.prototype.refreshUI=function(e){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},o.prototype.canExecute=function(e){var t;if(this._cachedActions){for(t=0;t<this._cachedActions.length;t++)if(!this._cachedActions[t].canExecute(e))return!1;return!0}return!1},o.prototype.canUndo=function(){var e;if(this._cachedActions){for(e=0;e<this._cachedActions.length;e++)if(!this._cachedActions[e].canUndo())return!1;return!0}return!1},o.prototype.saveState=function(){var e;if(this._cachedActions)for(e=0;e<this._cachedActions.length;e++)this._cachedActions[e].saveState()},o.prototype.undo=function(e){var t,o,n,r,i;if(this._cachedActions){t=this._sheet,o=!0,this._suspendInvalidate(t),n=t.isPaintSuspended(),t.isPaintSuspended(!0);try{for(r=0;r<this._cachedActions.length;r++)i=this._cachedActions[r],o=o&&i.undo(e)}finally{t.isPaintSuspended(n),this._resumeInvalidate(t)||this.refreshUI(e)}return o}return!1},o}(u),o.ClipboardPasteUndoAction=V,B=function(e){this.names=e},o.FloatingObjectExtent=B,z=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.init=function(e,t){this._sheet=e,this._floatingObjectExtent=t,this._savedFloatingObjects=[]},t.prototype.refreshUI=function(e){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(e){return!!this._sheet._hasFloatingObjectsSelected()},t.prototype.canUndo=function(){return!!(this._savedFloatingObjects&&this._savedFloatingObjects.length>0)},t.prototype.saveState=function(){var e,t,o;if(this._floatingObjectExtent&&this._floatingObjectExtent.names instanceof Array)for(e=0,t=this._floatingObjectExtent.names.length;e<t;e++)(o=this._sheet._findFloatingObjectInternal(this._floatingObjectExtent.names[e]))&&this._savedFloatingObjects.push(o)},t}(u),o.FloatingObjectUndoActionBase=z,G=function(e){function o(t,o){e.call(this),this.init(t,o)}return __extends(o,e),o.prototype.init=function(t,o){e.prototype.init.call(this,t,o),this._savedFloatingObjectPositions={}},o.prototype.execute=function(e){var o,n,r,i,a,s,l=this;if(t.features.floatingObject&&l._floatingObjectExtent&&l._floatingObjectExtent.names instanceof Array){for(l.saveState(),o=l._sheet,l._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=l._floatingObjectExtent.names.length;r<i;r++)(a=o._findFloatingObjectInternal(l._floatingObjectExtent.names[r]))&&(s=o._slicerCollection,l._isSlicer(a)&&s&&s.removeSlicer(a),o._removeFloatingObjectInternal(l._floatingObjectExtent.names[r])||(l._savedFloatingObjects[r]=ae),a.isSelected(!1));o._loadAndSetSheetSelections(),o.isPaintSuspended(n),l._resumeInvalidate(e)||l.refreshUI(e)}},o.prototype.undo=function(e){var o,n,r,i,a,s,l=this;if(t.features.floatingObject&&l._savedFloatingObjects&&l._savedFloatingObjects.length>0){for(o=l._sheet,l._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=l._savedFloatingObjects.length;r<i;r++)(a=l._savedFloatingObjects[r])&&(a.isSelected(!0),o._addFloatingOjectInternal(a),s=o._slicerCollection,l._isSlicer(a)&&s&&s.addSlicer(a),a.position(l._savedFloatingObjectPositions[a.name()]));return o._saveAndClearSheetSelections(),l._savedFloatingObjects.length=0,o.isPaintSuspended(n),l._resumeInvalidate(e)||l.refreshUI(e),!0}return!1},o.prototype._isSlicer=function(e){return e&&"Slicer"===e.typeName},o.prototype.saveState=function(){var t,o,n;e.prototype.saveState.call(this);var r=this._sheet,i=this._floatingObjectExtent;if(i&&i.names instanceof Array)for(t=0,o=i.names.length;t<o;t++)(n=r._findFloatingObjectInternal(i.names[t]))&&n.position()&&(this._savedFloatingObjectPositions[n.name()]=n.position())},o}(z),o.DeleteFloatingObjectUndoAction=G,W=function(e,t){this.offsetX=e,this.offsetY=t},o.MovingFloatingObjectExtent=W,j=function(e){function o(t,o,n){e.call(this),this.init(t,o),this._movingSettings=n}return __extends(o,e),o.prototype.execute=function(e){var o,n,r,i,a,s,l=this;if(t.features.floatingObject&&l._floatingObjectExtent&&l._floatingObjectExtent.names instanceof Array){for(l.saveState(),o=l._sheet,l._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=l._floatingObjectExtent.names.length;r<i;r++)s=(a=o._findFloatingObjectInternal(l._floatingObjectExtent.names[r])).position(),a.position(new t.Point(s.x+l._movingSettings.offsetX,s.y+l._movingSettings.offsetY));o.isPaintSuspended(n),l._resumeInvalidate(e)||l.refreshUI(e)}},o.prototype.undo=function(e){var o,n,r,i,a,s,l=this;if(t.features.floatingObject&&l._savedFloatingObjects&&l._savedFloatingObjects.length>0){for(o=l._sheet,l._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=l._savedFloatingObjects.length;r<i;r++)s=(a=l._savedFloatingObjects[r]).position(),a.position(new t.Point(s.x-l._movingSettings.offsetX,s.y-l._movingSettings.offsetY));return l._savedFloatingObjects.length=0,o.isPaintSuspended(n),l._resumeInvalidate(e)||l.refreshUI(e),!0}return!1},o}(z),o.MovingFloatingObjectUndoAction=j,U=function(e,t,o,n){this.offsetX=e,this.offsetY=t,this.offsetWidth=o,this.offsetHeight=n},o.ReszingFloatingObjectExtent=U,Y=function(e){function o(t,o,n){e.call(this),this.init(t,o),this._resizingSettings=n}return __extends(o,e),o.prototype.execute=function(e){var o,n,r,i,a,s,l=this;if(t.features.floatingObject&&l._floatingObjectExtent&&l._floatingObjectExtent.names instanceof Array){for(l.saveState(),o=l._sheet,l._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=l._floatingObjectExtent.names.length;r<i;r++)s=(a=o._findFloatingObjectInternal(l._floatingObjectExtent.names[r])).position(),a.width(a.width()+l._resizingSettings.offsetWidth),a.height(a.height()+l._resizingSettings.offsetHeight),a.position(new t.Point(s.x+l._resizingSettings.offsetX,s.y+l._resizingSettings.offsetY));o.isPaintSuspended(n),l._resumeInvalidate(e)||l.refreshUI(e)}},o.prototype.undo=function(e){var o,n,r,i,a,s,l=this;if(t.features.floatingObject&&l._savedFloatingObjects&&l._savedFloatingObjects.length>0){for(o=l._sheet,l._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=l._savedFloatingObjects.length;r<i;r++)s=(a=l._savedFloatingObjects[r]).position(),a.position(new t.Point(s.x-l._resizingSettings.offsetX,s.y-l._resizingSettings.offsetY)),a.width(a.width()-l._resizingSettings.offsetWidth),a.height(a.height()-l._resizingSettings.offsetHeight);return l._savedFloatingObjects.length=0,o.isPaintSuspended(n),l._resumeInvalidate(e)||l.refreshUI(e),!0}return!1},o}(z),o.ResizingFloatingObjectUndoAction=Y,X=function(e){function t(){e.call(this),this._sheet=ie,this._floatingObjectExtent=ie,this._savedObjects=ie}return __extends(t,e),t.prototype.refreshUI=function(e){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(e){var t=this._floatingObjectExtent;return!!(t&&t.names&&t.names.length>0&&this._canEditObjects(t.names))},t.prototype.canUndo=function(){return!!(this._savedObjects&&this._savedObjects.length>0)},t.prototype._canEditObjects=function(e){for(var t,o=this._sheet,n=0,r=e.length;n<r;n++)if((t=o._findFloatingObjectInternal(e[n]))&&!o.canEditFloatingObject(t))return!1;return!0},t.prototype._generateFloatingObjectName=function(){for(var e="FloatingObject",t=this._sheet._floatingObjectArray.length+1,o=e+t;this._sheet._findFloatingObjectInternal(o)!==ie;)o=e+ ++t;return o},t.prototype._isSlicer=function(e){return e&&"Slicer"===e.typeName},t}(u),o.FloatingObjectCopyPasteUndoAction=X,K=function(e){function o(t,o,n){e.call(this),this._sheet=ie,this._fromSheet=ie,this._floatingObjectExtent=ie,this._savedObjects=ie,this.OFFSET=15,this._sheet=t,this._fromSheet=n,this._floatingObjectExtent=o,this._savedObjects=[],this._activeRowIndex=this._sheet.getActiveRowIndex(),this._activeColumnIndex=this._sheet.getActiveColumnIndex()}return __extends(o,e),o.prototype.execute=function(e){var o,n,r,i,a,s,l,u,c,h,p,d,f,g,m=this;if(t.features.floatingObject&&m._floatingObjectExtent&&m._floatingObjectExtent.names&&m._floatingObjectExtent.names.length>0){var _=m._sheet,y=m._fromSheet,C=m._fromSheet._eventHandler;m._suspendInvalidate(e),o=_.isPaintSuspended(),_.isPaintSuspended(!0);for(var w=m._floatingObjectExtent.names,v=[],S=Number.MAX_VALUE,x=S,R=S,b=0,T=w.length;b<T;b++)s=C._getClipboardFloatingObjectData().findByPropertyName(w[b]).position(),x=se(x,s.x),R=se(R,s.y);for(n=[],b=0,T=w.length;b<T;b++)s=C._getClipboardFloatingObjectData().findByPropertyName(w[b]).position(),n.push(new t.Point(s.x-x,s.y-R));if(r=0,i=0,_._hasFloatingObjectsSelected()){var A=S,I=S,D=_._floatingObjectArray;for(b=0,T=D.length;b<T;b++)(a=D[b])&&a.isSelected()&&(s=a.position(),A=se(A,s.x),I=se(I,s.y),a.isSelected(!1));r=A<S?A+m.OFFSET:0,i=I<S?I+m.OFFSET:0}else{for(l=0;l<m._activeRowIndex;l++)i+=_._getActualRowHeight(l,3);for(u=0;u<m._activeColumnIndex;u++)r+=_._getActualColumnWidth(u,3)}for(b=0,T=w.length;b<T;b++)c=n[b],v.push(new t.Point(r+c.x,i+c.y));for(p=(h=_._getFloatingObjectClipboardHelper())&&h.isCutting,b=0,T=w.length;b<T;b++)g=C._getClipboardFloatingObjectData().findByPropertyName(w[b]),p&&!y._findFloatingObjectInternal(w[b])?(d=g).owner(_):(d=g.clone(_),f=m._isSlicer(d)?_._slicerCollection.getAutoSlicerName(d.name()):m._generateFloatingObjectName()),d.isVisible(!0),d.position(v[b]),d.isSelected(!0),f&&d.name(f),m._isSlicer(d)&&_._slicerCollection.addSlicer(d),_._addFloatingOjectInternal(d),m._savedObjects.push(d);_.isPaintSuspended(o),m._resumeInvalidate(e)||m.refreshUI(e)}},o.prototype.undo=function(e){var o,n,r,i,a,s,l=this;if(t.features.floatingObject&&l._savedObjects&&l._savedObjects.length>0){for(o=l._sheet,l._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=l._savedObjects.length;r<i;r++)a=l._savedObjects[r],s=o._slicerCollection,l._isSlicer(a)&&s&&s.removeSlicer(s.getSlicer(a.name())),o._removeFloatingObjectInternal(a.name());return l._savedObjects.length=0,o.isPaintSuspended(n),l._resumeInvalidate(e)||l.refreshUI(e),!0}return!1},o}(X),o.ClipboardPasteFloatingObjectUndoAction=K,J=function(e){function o(t,o,n){e.call(this),this._sheet=ie,this._floatingObjectExtent=ie,this._savedObjects=ie,this._movingInfo=ie,this._sheet=t,this._floatingObjectExtent=o,this._savedObjects=[],this._movingInfo=n}return __extends(o,e),o.prototype.execute=function(e){var o,n,r,i,a,s,l,u,c,h=this;if(t.features.floatingObject&&h._floatingObjectExtent&&h._floatingObjectExtent.names&&h._floatingObjectExtent.names.length>0&&h._movingInfo){for(o=h._sheet,h._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=h._floatingObjectExtent.names.length;r<i;r++)(a=o._findFloatingObjectInternal(h._floatingObjectExtent.names[r]))&&(s=a.clone(o),l=a.position(),s.position(new t.Point(l.x+h._movingInfo.offsetX,l.y+h._movingInfo.offsetY)),s.name(h._generateFloatingObjectName()),s.isSelected(!0),a.isSelected(!1),h._isSlicer(s)&&o._slicerCollection&&(u=s,c=o._slicerCollection.getAutoSlicerName(u.columnName()),u.name(c),o._slicerCollection.addSlicer(u)),o._addFloatingOjectInternal(s),h._savedObjects.push(s));o.isPaintSuspended(n),h._resumeInvalidate(e)||h.refreshUI(e)}},o.prototype.undo=function(e){var o,n,r,i,a=this;if(t.features.floatingObject&&a._savedObjects&&a._savedObjects.length>0){for(o=a._sheet,a._suspendInvalidate(e),n=o.isPaintSuspended(),o.isPaintSuspended(!0),r=0,i=a._savedObjects.length;r<i;r++){var s=a._savedObjects[r].name(),l=o._slicerCollection,u=o._findFloatingObjectInternal(s);a._isSlicer(u)&&l&&l.removeSlicer(u),o._removeFloatingObjectInternal(s)}return a._savedObjects.length=0,o.isPaintSuspended(n),a._resumeInvalidate(e)||a.refreshUI(e),!0}return!1},o}(X),o.DragCopyFloatingObjectUndoAction=J,Z=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.init=function(e,t){this._sheet=e,this._comment=t},t.prototype.refreshUI=function(e){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(e){return!0},t.prototype.canUndo=function(){return!!this._savedComment},t.prototype.saveState=function(){this._savedComment=this._comment},t.prototype.clearState=function(){this._savedComment=ae},t}(u),o.CommentUndoActionBase=Z,q=function(e){function t(t,o){e.call(this),this.init(t,o)}return __extends(t,e),t.prototype.execute=function(e){var t,o;this.saveState(),t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0);var n=this._comment,r=t._commentManager,i={sheet:t,sheetName:t.getName(),comment:n,cancel:!1};t.triggerCommentRemoving(i),i&&!0===i.cancel?this.clearState():(t.setComment(n._rowIndex,n._colIndex,ie),r._activeComment=ie,t._loadAndSetSheetSelections(),t.triggerCommentRemoved({sheet:t,sheetName:t.getName(),comment:n})),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e)},t.prototype.undo=function(e){var t,o;return!!this._savedComment&&(t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),t.setComment(this._savedComment._rowIndex,this._savedComment._colIndex,this._savedComment),t._saveAndClearSheetSelections(),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e),!0)},t}(Z),o.CommentDeleteUndoAction=q,$=function(e){function t(t,o,n,r,i){e.call(this),this.init(t,o),this._oldValue=n,this._newValue=r,this._propertyName=i}return __extends(t,e),t.prototype.execute=function(e){var t,o;this._comment&&(this.saveState(),t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._comment._changeProperty(this._propertyName,this._newValue),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e))},t.prototype.undo=function(e){var t,o;return!!this._savedComment&&(t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._comment._changeProperty(this._propertyName,this._oldValue),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e),!0)},t}(Z),o.CommentPropertyUndoAction=$,Q=function(e){function t(){e.call(this),this._commentUndoTransaction=[]}return __extends(t,e),t.prototype.execute=function(e){var t,o;if(this._commentUndoTransaction&&this._commentUndoTransaction.length>0)for(t=0;t<this._commentUndoTransaction.length;t++)(o=this._commentUndoTransaction[t])&&o.execute(e)},t.prototype.undo=function(e){var t,o;if(this._commentUndoTransaction&&this._commentUndoTransaction.length>0){for(t=0;t<this._commentUndoTransaction.length;t++)(o=this._commentUndoTransaction[t])&&o.undo(e);return!0}return!1},t.prototype.add=function(e){this._commentUndoTransaction.push(e)},t}(u),o.CommentUndoTransaction=Q,ee=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.init=function(e,t){this._sheet=e,this._slicerData=t},t.prototype.refreshUI=function(e){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(e){return!0},t.prototype.canUndo=function(){return!!this._slicerData},t.prototype.saveState=function(){this._savedSlicerData=this._slicerData},t}(u),o.SlicerDataUndoActionBase=ee,te=function(e){function t(t,o,n,r,i){e.call(this),this.init(t,o),this._columnName=n,this._oldValue=r,this._newValue=i}return __extends(t,e),t.prototype.execute=function(e){var t,o;this._slicerData&&(this.saveState(),t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._slicerData.doFilter(this._columnName,{exclusiveRowIndexes:this._newValue}),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e))},t.prototype.undo=function(e){var t,o;return!!this._slicerData&&(t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._slicerData.doFilter(this._columnName,{exclusiveRowIndexes:this._oldValue}),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e),!0)},t}(ee),o.SlicerDataFilterUndoAction=te,oe=function(e){function t(t,o,n,r){e.call(this),this.init(t,o),this._columnName=n,this._value=r}return __extends(t,e),t.prototype.execute=function(e){var t,o;this._slicerData&&(this.saveState(),t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._slicerData.doUnfilter(this._columnName),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e))},t.prototype.undo=function(e){var t,o;return!!this._slicerData&&(t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._slicerData.doFilter(this._columnName,{exclusiveRowIndexes:this._value}),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e),!0)},t}(ee),o.SlicerDataUnFilterUndoAction=oe,ne=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.init=function(e,t){this._sheet=e,this._slicer=t},t.prototype.refreshUI=function(e){var t=this._sheet;t&&(t.invalidateLayout(),t.repaint())},t.prototype.canExecute=function(e){return!0},t.prototype.canUndo=function(){return!!this._slicer},t.prototype.saveState=function(){this._savedSlicer=this._slicer},t}(u),o.SlicerUndoActionBase=ne,re=function(e){function t(t,o,n,r,i){e.call(this),this.init(t,o),this._oldValue=r,this._newValue=i,this._propertyName=n}return __extends(t,e),t.prototype.execute=function(e){var t,o;this._slicer&&(this.saveState(),t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._slicer[this._propertyName](this._newValue),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e))},t.prototype.undo=function(e){var t,o;return!!this._savedSlicer&&(t=this._sheet,this._suspendInvalidate(e),o=t.isPaintSuspended(),t.isPaintSuspended(!0),this._slicer[this._propertyName](this._oldValue),t.isPaintSuspended(o),this._resumeInvalidate(e)||this.refreshUI(e),!0)},t}(ne),o.SlicerPropertyUndoAction=re;t.UndoRedo}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){t.feature("core.sheet_event",["core.common","core.sheet_action","core.stringResource"]);var o=null,n=void 0,r=Math.max,i=Math.min,a=Math.abs,s=Math.ceil,l="undefined",u="position",c="absolute",h="border",p="box-shadow",d="background-color",f="overflow",g="top",m="left",_="z-index",y="height",C="hidden",w="auto",v="none",S="gcUIElement",x=t.util.device(),R=x.iphone||x.ipad||x.android,b=window.document,T=function(){function x(e){this.RESIZETOOLTIP_TOP=30,this.DRAGDROPTOOLTIP_OFFSET=5,this.DRAGFILLTOOLTIP_OFFSET=3,this.VSCROLLTOOLTIP_LEFT=100,this.HSCROLLTOOLTIP_LEFT=30,this.HSCROLLTOOLTIP_TOP=40,this._clipboardFloatingObjectData=o,this._repeatKeyDownTimeoutID=0,this.waittime=100,this.newLeft=0,this.newTop=0,this._focusReleased=!1,this._init(e)}return x.prototype._init=function(e){this._sheet=e,this._elem=o,this._eventSuspended=0},x.prototype._getElem=function(){return this._elem||(this._elem=b.createElement("input")),this._elem},x.prototype._dispose=function(){this._hScrollTimer&&this._hScrollTimer._dispose(),this._vScrollTimer&&this._vScrollTimer._dispose(),this.mousePosition=o},x.prototype._getHScrollTimer=function(){return this._hScrollTimer||(this._hScrollTimer=new t.Timer(this)),this._hScrollTimer},x.prototype._getVScrollTimer=function(){return this._vScrollTimer||(this._vScrollTimer=new t.Timer(this)),this._vScrollTimer},x.prototype.doResize=function(){var e,o,n,i,a,s=this._sheet,l=s._getCanvas();if(l&&l.parentNode){var u=getComputedStyle(l.parentNode),c=u.width,h=u.height,p=c.indexOf("px");p>0&&(c=c.substring(0,p)),(p=h.indexOf("px"))>0&&(h=h.substring(0,p)),e=parseInt(c),o=parseInt(h),isNaN(e)&&(e=t.GC$(l.parentNode).width()),isNaN(o)&&(o=t.GC$(l.parentNode).height()),0!==e&&0!==o&&(0,0,l.style.display=v,n=r(e-0,0),i=r(o-0,0),l.style.display="",l.width=n,l.height=i,l.style.width=n+"px",l.style.height=i+"px",n=l.clientWidth||l.width,i=l.clientHeight||l.height,a=s.getBounds(),s.setBounds(new t.Rect(a.x,a.y,n,i)),t.DPIHelper.setSize(l,n,i),s.invalidateLayout())}},x.prototype._getCanvasOffset=function(){var e=this._sheet,o=t.GC$(e._getCanvas()).offset();return o?(isNaN(b.body.clientTop)||(o.top+=b.body.clientTop),isNaN(b.body.clientLeft)||(o.left+=b.body.clientLeft)):o={top:0,left:0},window.gcGlobal.canvasOffset&&(o=window.gcGlobal.canvasOffset),o},x.prototype._getCanvasPosition=function(){var e=this._sheet,o=t.GC$(e._getCanvas()).position();return o||(o={top:0,left:0}),o},x.prototype.doMouseDown=function(e){var t,o,n;return 2===e.button||(this,t=this._sheet,this.handleDocumentMouseMove(),o=this._getCanvasOffset(),n=this.doMouseDownImp(e,e.pageX-o.left,e.pageY-o.top),t.isEditing()||n||this.setFocus(),t._isMouseDownInSheet=!0,!1)},x.prototype.handleDocumentMouseMove=function(){var e=this;e._isMouseCapture||(t.GC$(b).bind("mousemove.gcSheet",function(t){e.doMouseMove(t)}).bind("mouseup.gcSheet",function(t){e.doMouseUp(t)}),e._isMouseCapture=!0)},x.prototype.unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,t.GC$(b).unbind("mousemove.gcSheet").unbind("mouseup.gcSheet"))},x.prototype.doMouseDownImp=function(e,r,i){var a,s,l,u,c,h,p,d,f,g,m=this,_=m._sheet,y=_.hitTest(r,i),C=y.row,w=y.col,v=y.groupHitInfo,S=y.dragInfo,x=y.filterButtonHitInfo,R=y.formulaRangeHitInfo,b=y.cellTypeHitInfo;if("function"==typeof _.unSelectAllFloatingObjects&&_.unSelectAllFloatingObjects(),(a=_._commentManager)&&a.deactivateComment(),v)_.isEditing()||m._doClickRangeGroup(v);else if(_._currentTarget=y,m.isMouseDown=!0,y.resizeInfo){if(!_.endEdit())return;m.startResizing(y)}else if(S&&S.side&&"corner"!==S.side){if(!_.endEdit())return;m.startDragDropping(y)}else if(S&&"corner"===S.side){if(!_.endEdit())return;m.startDragFill(y)}else if(x){if(!_.endEdit())return;if(!x||!x.rowFilter)return;x.rowFilter.openFilterDialog(x)}else if(R)R.inBorder?m.startFormulaRangeMoving(y):(R.inTopLeft||R.inTopRight||R.inBottomLeft||R.inBottomRight)&&m.startFormulaRangeResizing(y);else if(_.canSelect(y.rowViewportIndex<0?-1:C,y.colViewportIndex<0?-1:w)){if((s=_._formulaTextBox)&&s.canAppendRange())return void m.startFormulaRangeAppending(y);if(m._clearFormulaTextbox(_))return;if(l=_.getActiveRowIndex(),u=_.getActiveColumnIndex(),b){if(!((c=b.sheetArea)!==o&&c!==n&&3!==c||C===l&&w===u)){h=_.isPaintSuspended(),_.isPaintSuspended(!0);try{if(!_.endEdit())return;if(p={sheet:_,sheetName:_._name,row:l,col:u,cancel:!1},_.triggerLeaveCell(p),p&&!0===p.cancel)return;var T,A=_._selectionModel.toArray(),I=_._getSpanModel().find(C,w);T=I?[new t.Range(I.row,I.col,I.rowCount,I.colCount)]:[new t.Range(C,w,1,1)],_.triggerSelectionChanging({sheet:_,sheetName:_._name,oldSelections:A,newSelections:T}),_._setActiveCellAndSelection(C,w,n,n,1),_.triggerEnterCell({sheet:_,sheetName:_._name,row:C,col:w}),_.triggerSelectionChanged({sheet:_,sheetName:_._name}),m._updateValidationUI(C,w)}finally{_.isPaintSuspended(h)}}d=_.getCellType(C,w,y.hitTestType),b.sheet||(b.sheet=_),d.processMouseDown(b)}if(b&&b.isReservedLocation)return!0;m.setMetaKeyState(e);try{if(m._hitTestResult=y,_.isEditing()&&l===_.getActiveRowIndex()&&u===_.getActiveColumnIndex()&&!_.endEdit())return}finally{m._hitTestResult=o}if(C===n||C===o||w===n||w===o)return;3===y.hitTestType&&m._updateValidationUI(C,w),f=_._selectionModel.toArray(),m.startSelecting(y),g=_._selectionModel.toArray(),m._notEqualSelecions(f,g)&&_.triggerSelectionChanging({sheet:_,sheetName:_._name,oldSelections:f,newSelections:g})}},x.prototype._clearFormulaTextbox=function(e){var n,r,i=!1,a=t.features.formulatextbox&&t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance;if(a&&a.dom)if(n=a.sheet,(r=e._formulaTextBox)&&n.setFormula(a.rowIndex,a.columnIndex,r.text()),n!==e){if(t.SpreadActions.changeSheetForFormulaTextboxAcrossSheet(n),!n.endEdit())return;i=!0}else r&&(r.destroy(),e._formulaTextBox=o),a.clear();return i},x.prototype._doClickRangeGroup=function(e){var o,n,r,i,a,s,l,u,c=this._sheet;c&&e&&t.features.group&&(o=e.info,"rgh"===e.what?c&&!c.isEditing()&&(n=o.index,r={sheet:c,sheetName:c._name,isRowGroup:!0,index:-1,level:n,cancel:!1},c.triggerRangeGroupStateChanging(r),r&&!1===r.cancel&&(i=new t.UndoRedo.RowGroupHeaderExpandUndoAction(c,{level:n}),c._doCommand(i),c.triggerRangeGroupStateChanged({sheet:c,sheetName:c._name,isRowGroup:!0,index:-1,level:n}))):"cgh"===e.what?c.isEditing()||(n=o.index,r={sheet:c,sheetName:c._name,isRowGroup:!1,index:-1,level:n,cancel:!1},c.triggerRangeGroupStateChanging(r),r&&!1===r.cancel&&(i=new t.UndoRedo.ColumnGroupHeaderExpandUndoAction(c,{level:n}),c._doCommand(i),c.triggerRangeGroupStateChanged({sheet:c,sheetName:c._name,isRowGroup:!1,index:-1,level:n}))):"rg"===e.what?c.rowRangeGroup&&(a=o.index,s=o.isExpanded,1===o.lineDirection?a--:a++,r={sheet:c,sheetName:c._name,isRowGroup:!0,index:a,level:o.level,cancel:!1},c.triggerRangeGroupStateChanging(r),r&&!1===r.cancel&&(l=new t.UndoRedo.RowGroupExpandUndoAction(c,{index:o.index,level:o.level,collapsed:s}),c._doCommand(l),c.triggerRangeGroupStateChanged({sheet:c,sheetName:c._name,isRowGroup:!0,index:a,level:o.level}))):"cg"===e.what&&c.colRangeGroup&&(a=o.index,s=o.isExpanded,1===o.lineDirection?a--:a++,r={sheet:c,sheetName:c._name,isRowGroup:!1,index:a,level:o.level,cancel:!1},c.triggerRangeGroupStateChanging(r),r&&!1===r.cancel&&(u=new t.UndoRedo.ColumnGroupExpandUndoAction(c,{index:o.index,level:o.level,collapsed:s}),c._doCommand(u),c.triggerRangeGroupStateChanged({sheet:c,sheetName:c._name,isRowGroup:!1,index:a,level:o.level}))))},x.prototype._isInvalidRect=function(e){var t,r=this._sheet;return!r||(t=r._getSheetLayout(),e.x===o||e.x===n||e.y===o||e.y===n||e.width===o||e.width===n||e.height===o||e.height===n||e.x+e.width>t.viewportX+t.viewportWidth+t.frozenTrailingWidth||e.y+e.height>t.viewportY+t.viewportHeight+t.frozenTrailingHeight)},x.prototype._commitSelectValue=function(e,r,i,a){for(var s,l,u,c,h,p=this._sheet,d=0,f=e.options,g=f.length;d<g;d++)if(f[d].selected){h=a[d].value;break}s=!1,p.isProtected&&((l=p.getActualStyle(r,i))&&(s=l.locked)),h===o||h===n||s||(u={row:r,col:i,newValue:h,autoFormat:!0},c=new t.UndoRedo.CellEditUndoAction(p,u),p._doCommand(c)),t.GC$(e).hide()},x.prototype._updateValidationUI=function(e,a){var s,l,f,y,C,x,R,T,A,I,D,F,M,E,N,O,P,L,H,k,V=this,B=V._sheet,z=B&&B.parent;if(z&&t.features.dataValidator&&B._disposeValidationUI()&&((s=z.getActiveSheet())&&B.getName()===s.getName())&&(l=B.getDataValidator(e,a))&&(f=V._getCanvasOffset(),y=B.getCellRect(e,a),!V._isInvalidRect(y))&&(C=t.util.getPreferredZIndex(z.getHost()),l&&l.showInputMessage&&l.inputMessage&&(x=b.createElement("span"),t.GC$(x).css(u,c).css(h,"1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css(d,"#FFFFFF").css(p,"1px 2px 5px rgba(0,0,0,0.4)").css("font","normal normal normal 12px/normal Arial").width(w).height(w).css(g,y.y+y.height+f.top+5).css(m,y.x+y.width/2+f.left).css(_,C).html("<b>"+l.inputTitle+"</b><br/>"+l.inputMessage).attr(S,"gcValidationInputMessage").appendTo(b.body),B._validationInputMessage=x),l&&3===l.type&&l.inCellDropdown)){var G=l.condition.getValidListImp(B,e,a),W=G.length,j=b.createElement("select"),U=B.getText(e,a),Y=-1,X=b.createDocumentFragment();for(R=0;R<W;R++)(T=G[R].text)===o||T===n||t.util.hasCalc()&&T instanceof t.Calc.CalcError||(Y<0&&T===U&&(Y=R),T instanceof Date&&(T=new t._DateTimeHelper(T).localeFormat("M/d/yyyy h:mm:ss")),(A=b.createElement("option")).value=T,A.text=T,X.appendChild(A));j.appendChild(X),j.selectedIndex=Y>0?Y:0;var K=B.getActualStyle(e,a),J=B._render,Z=K&&K.font?K.font:J._getDefaultFont();B._zoomFactor>1&&(Z=J._getZoomFont(Z)),D=1,(I=B.getSpans(new t.Range(e,a,1,1)))&&I.length>0&&I[0]&&(D=I[0].colCount);var q=a+D-1==B.getColumnCount()-1,$=B.getRowHeight(e)*B._zoomFactor,Q=B.parent&&B.parent.useTouchLayout();$=i(Q?50:15,$),F=t.util.device(),(M=t.util.browser.safari&&(F.ipad||F.iphone))?(E=y.width+3,N=y.height+3,O=y.y+f.top-1.5,P=y.x+f.left-1.5,L="white"):(E=r(y.width+(q?0:$),B.defaults.colWidth),N=W>8?140:w,O=y.y+y.height+f.top,P=y.x+y.width+f.left+(q?0:$)-E,L=""),H=t.GC$(j).css("outline",v).css(u,c).css("font",Z).css(_,C).css(d,L).width(E).height(N).css(g,O).css(m,P).attr(S,"gcValidationSelect").appendTo(b.body).attr("size",W>2?W:2).hide().bind("click",function(){V._commitSelectValue(j,e,a,G),M&&t.GC$(B._validationButton).show()}).bind("keydown",function(o){13!==o.keyCode||o.ctrlKey||o.shiftKey||o.altKey?27!==o.keyCode||o.ctrlKey||o.shiftKey||o.altKey||t.GC$(j).hide():V._commitSelectValue(j,e,a,G),M&&t.GC$(B._validationButton).show()}),M&&H.bind("blur",function(o){V._commitSelectValue(j,e,a,G),t.GC$(B._validationButton).show()}),B._validationSelect=j,(k=b.createElement("input")).type="image",k.src=t.DefaultDataValidator.getImageSrc(),k.alt="v",t.GC$(k).css(u,c).width($).height($).css(g,y.y+y.height+f.top-($+3)).css(m,y.x+y.width+f.left-(q?$:0)).css(_,C).css(d,"white").css(h,"1px solid gray").attr(S,"gcValidationButton").appendTo(b.body).bind("click",function(){(!B.isEditing()||B.endEdit())&&(t.GC$(B._validationSelect).toggle().focus(),M&&t.GC$(B._validationButton).toggle())}),B._validationButton=k}},x.prototype.startScroll=function(){var e;this.startHitInfo&&((3===(e=this.startHitInfo.hitTestType)||2===e)&&this._getVScrollTimer().setAction(this.processVSScrolled),(3===e||1===e)&&this._getHScrollTimer().setAction(this.processHSScrolled))},x.prototype.processVSScrolled=function(e){var t,o,n,r=this;if(!r.adjustScrollRowViewport()){var i=r.startHitInfo,a=r._sheet,s=i.scrollRowViewportIndex,l=a.getViewportTopRow(s),u=a.getViewportBottomRow(s);e?u<a.getRowCount()-a._frozenTrailingRowCount-1?a._setTopRow(a._getNextVisualRow(l)):(t=a._getRowLayout(s))&&t.length>0&&(o=a._getSheetLayout(),(n=t[t.length-1]).y+n.height>=o.viewportY+o.viewportHeight&&a._setTopRow(a._getNextVisualRow(l))):l>a.frozenRowCount&&a._setTopRow(a._getPrevVisualRow(l))}r.isSelecting&&r.continueSelecting(),r.isDragDropping&&r.continueDragDropping(),r.isDraggingFill&&r.continueDragFill(),r.isFormulaRangeAppending&&r.continueFormulaRangeAppending(),r.isFormulaRangeMoving&&r.continueFormulaRangeMoving(),r.isFormulaRangeResizing&&r.continueFormulaRangeResizing()},x.prototype.processHSScrolled=function(e){var t,o,n,r=this;if(!r.adjustScrollColViewport()){var i=r._sheet,a=r.startHitInfo.scrollColViewportIndex,s=i.getViewportLeftColumn(a),l=i.getViewportRightColumn(a);e?l<i.getColumnCount()-i._frozenTrailingColCount-1?i._setLeftColumn(i._getNextVisualColumn(s)):(t=i._getColumnLayout(a))&&t.length>0&&(o=i._getSheetLayout(),(n=t[t.length-1]).x+n.width>=o.viewportX+o.viewportWidth&&i._setLeftColumn(i._getNextVisualColumn(s))):s>i.frozenColCount&&i._setLeftColumn(i._getPrevVisualColumn(s))}r.isSelecting&&r.continueSelecting(),r.isDragDropping&&r.continueDragDropping(),r.isDraggingFill&&r.continueDragFill(),r.isFormulaRangeAppending&&r.continueFormulaRangeAppending(),r.isFormulaRangeMoving&&r.continueFormulaRangeMoving(),r.isFormulaRangeResizing&&r.continueFormulaRangeResizing()},x.prototype.adjustScrollRowViewport=function(){var e,t,o,n=this._sheet,r=n._getSheetLayout(),a=this.mousePosition,s=this.startHitInfo,l=s.scrollRowViewportIndex;if(0===l){if(a.y>r.viewportY)return n._setTopRow(n._getFirstPageTopRow()),s.scrollRowViewportIndex=1,!0}else if(1===l){if((e=n._getRowLayout(1))&&e.length>0){if(t=e[0],n.frozenRowCount>0&&a.y<r.viewportY&&t.row<=n._getFirstPageTopRow())return s.scrollRowViewportIndex=0,!0;if(t=e[e.length-1],n._frozenTrailingRowCount>0&&a.y>r.frozenTrailingY&&t.row>=n._getLastVisualRow()&&t.y+t.height<=r.frozenTrailingY)return s.scrollRowViewportIndex=2,!0}}else if(2===l&&((e=n._getRowLayout(1))&&e.length>0&&a.y<r.frozenTrailingY)){if((t=e[e.length-1]).y+t.height>r.frozenTrailingY){var u=r.viewportHeight,c=n.getRowCount()-n._frozenTrailingRowCount-1,h=0;for(o=c;o>=n.frozenRowCount;o--)if((h+=n._getZoomRowHeight(o))>u){c=i(o+1,c);break}n._setTopRow(n._getNextVisualRow(c-1))}return s.scrollRowViewportIndex=1,!0}return!1},x.prototype.adjustScrollColViewport=function(){var e,t,o,n=this._sheet,r=n._getSheetLayout(),a=this.mousePosition,s=this.startHitInfo,l=s.scrollColViewportIndex;if(0===l){if(a.x>r.viewportX)return n._setLeftColumn(n._getFirstPageLeftColumn()),s.scrollColViewportIndex=1,!0}else if(1===l){if((e=n._getColumnLayout(1))&&e.length>0){if(t=e[0],n.frozenColCount>0&&a.x<r.viewportX&&t.col<=n._getFirstPageLeftColumn())return s.scrollColViewportIndex=0,!0;if(t=e[e.length-1],n._frozenTrailingColCount>0&&a.x>r.frozenTrailingX&&t.col>=n._getLastVisualColumn()&&t.x+t.width<=r.frozenTrailingX)return s.scrollColViewportIndex=2,!0}}else if(2===l&&((e=n._getColumnLayout(1))&&e.length>0&&a.x<r.frozenTrailingX)){if((t=e[e.length-1]).x+t.width>r.frozenTrailingX){var u=r.viewportWidth,c=n.getColumnCount()-n._frozenTrailingColCount-1,h=0;for(o=c;o>=n.frozenColCount;o--)if((h+=n._getZoomColumnWidth(o))>u){c=i(o+1,c);break}n._setLeftColumn(n._getNextVisualColumn(c-1))}return s.scrollColViewportIndex=1,!0}return!1},x.prototype.continueScroll=function(){var e,t,n=this;if(n.isWorking||n.isFloatingObjectWorking||n.isCommentWorking){var r=n._sheet._getSheetLayout(),i=n.startHitInfo,a=i.scrollRowViewportIndex,s=i.scrollColViewportIndex,l=n.mousePosition,u=o;a>=0&&s>=0?u=r.viewportRect(a,s):a>=0?u=r.rowHeaderRect(a):s>=0&&(u=r.colHeaderRect(s)),u&&(e=0,t=0,l.x<=u.x?e=l.x-u.x:l.x>=u.x+u.width&&(e=l.x-(u.x+u.width)),l.y<=u.y?t=l.y-u.y:l.y>=u.y+u.height&&(t=l.y-(u.y+u.height)),n._getHScrollTimer().setInterval(n.getIntervalFromDistance(e)),n._getVScrollTimer().setInterval(n.getIntervalFromDistance(t)))}},x.prototype.stopScroll=function(){this._getHScrollTimer().stop(),this._getVScrollTimer().stop()},x.prototype.startResizing=function(e){var t,o,n,r,i,a=this,s=a._sheet,l=(s._getSheetLayout(),e.resizeInfo);"sizeRow"===l.action||"sizeHiddenRow"===l.action?(t=s._getAllRowLayout(l.sheetArea),s.getRowVisible(l.index)||(l.index=a._getPreVisualRow(l.index,l.sheetArea)),(o=t.findRow(l.index))||(o=t.findRow(e.row)),l.startY=o.y):(n=s._getAllColumnLayout(l.sheetArea),s.getColumnVisible(l.index)||(l.index=a._getPreVisualCol(l.index,l.sheetArea)),(r=n.findCol(l.index))||(r=n.findCol(e.col)),l.startX=r.x);var u=s.parent,c=e.x,h=e.y;u&&((1===(i=u.showResizeTip())&&("sizeCol"===l.action||"sizeHiddenCol"===l.action)||2===i&&("sizeRow"===l.action||"sizeHiddenRow"===l.action)||3===i)&&(h=h-a.RESIZETOOLTIP_TOP<0?h+a.RESIZETOOLTIP_TOP/2:h-a.RESIZETOOLTIP_TOP,a._showTooltip(a._getMouseDownResizeTooltipContent(),c,h))),a.isResizing=!0,a.isWorking=!0},x.prototype.continueResizing=function(){var e,t,o,n,r,i=this._sheet,a=i._currentTarget,s=a.resizeInfo,l=this.mousePosition,u=l.x,c=l.y,h=i._getSheetLayout();s&&this.isWorking&&this.isResizing&&(a.x!==u||a.y!==c)&&("sizeRow"===s.action||"sizeHiddenRow"===s.action?(s.movingY=c,s.movingY<s.startY&&(s.movingY=s.startY),e=h.y+h.height,s.movingY>e&&(s.movingY=e)):(s.movingX=u,s.movingX<s.startX&&(s.movingX=s.startX),e=h.x+h.width,s.movingX>e&&(s.movingX=e)),o=(t=i._render)._getCtx(),t.copyDoubleBuffer(h.x,h.y,h.width,h.height),t.paintAdornment(o),(n=i.parent)&&((1===(r=n.showResizeTip())&&("sizeCol"===s.action||"sizeHiddenCol"===s.action)||2===r&&("sizeRow"===s.action||"sizeHiddenRow"===s.action)||3===r)&&this._refreshTooltip(this._getMouseMoveResizeTooltipContent(s))))},x.prototype.stopResizing=function(){var e,i,a,s,l;this.isResizing=!1,this.isWorking=!1;var u,c,h,p,d=!0,f=this._sheet,g=f._currentTarget.resizeInfo;if(g){if(this._removeTooltip(),"sizeRow"===g.action||"sizeHiddenRow"===g.action)if(g.movingY!==n&&g.movingY!==o){if(u=r(0,(g.movingY-g.startY)/f._zoomFactor),e=[],f._isRowSelected(g.index))for(c=0;c<f._selectionModel.length;c++)-1===(h=f._selectionModel[c]).col&&(h=f._getActualRange(h),e.push({firstRow:h.row,lastRow:h.row+h.rowCount-1}));else e.push({firstRow:g.index,lastRow:g.index});i=1===g.sheetArea,p=new t.UndoRedo.RowResizeUndoAction(f,e,u,i),f._doCommand(p)}else d=!1;else if(g.movingX!==n&&g.movingX!==o){if(u=r(0,(g.movingX-g.startX)/f._zoomFactor),a=[],f._isColumnSelected(g.index))for(c=0;c<f._selectionModel.length;c++)-1===(h=f._selectionModel[c]).row&&(h=f._getActualRange(h),a.push({firstCol:h.col,lastCol:h.col+h.colCount-1}));else a.push({firstCol:g.index,lastCol:g.index});s=2===g.sheetArea,p=new t.UndoRedo.ColumnResizeUndoAction(f,a,u,s),f._doCommand(p)}else d=!1;(l=f.hitTest(this.mousePosition.x,this.mousePosition.y))&&this.updateCanvasCursor(l),d||f.repaint()}},x.prototype._startSelectingCore=function(e,t){var o,n,r,s,l,u,c,h,p=0,d=0,f=0,g=0,m=this,_=m._sheet;if(m._lastSelections=_._selectionModel.toArray(),m.ctrl||m.shift||_._clearSelectionImp(),0===e.hitTestType){if(!m.shift){if(o=_.frozenRowCount?_._getFirstVisualRow():_._scrollTopRow,l=_.frozenColCount?_._getFirstVisualColumn():_._scrollLeftCol,n={sheet:_,sheetName:_._name,row:_._activeRowIndex,col:_._activeColIndex,cancel:!1},_.triggerLeaveCell(n),n&&!0===n.cancel)return;_._setActiveCellImp(o,l,1,1,t),_.triggerEnterCell({sheet:_,sheetName:_._name,row:o,col:l}),m._updateValidationUI(o,l)}m.ctrl||_._clearSelectionImp(),_._setSelectedRange(-1,-1,_.getRowCount(),_.getColumnCount(),!0)}else if(1===e.hitTestType){if(!m.shift){if(o=_.frozenRowCount?_._getFirstVisualRow():_._scrollTopRow,r=_._getAvailableActiveCell(o,e.col,!1),n={sheet:_,sheetName:_._name,row:_._activeRowIndex,col:_._activeColIndex,cancel:!1},_.triggerLeaveCell(n),n&&!0===n.cancel)return;_._setActiveCellImp(r.row,r.col,1,e.colViewportIndex,t),_.triggerEnterCell({sheet:_,sheetName:_._name,row:r.row,col:r.col}),m._updateValidationUI(r.row,r.col)}m.shift?(p=i(_._activeColIndex,e.col),g=a(_._activeColIndex-e.col)+1,_._replaceActiveSelectedRange(-1,p,_.getRowCount(),g,!0)):_._setSelectedRange(-1,_._activeColIndex,_.getRowCount(),1,!0)}else if(2===e.hitTestType){if(!m.shift){if(u=_.frozenColCount?_._getFirstVisualColumn():_._scrollLeftCol,r=_._getAvailableActiveCell(e.row,u,!0),n={sheet:_,sheetName:_._name,row:_._activeRowIndex,col:_._activeColIndex,cancel:!1},_.triggerLeaveCell(n),n&&!0===n.cancel)return;s=_._activeRowIndex!==r.row,_._setActiveCellImp(r.row,r.col,e.rowViewportIndex,1,t),s&&_.doDataItemChanged(),_.triggerEnterCell({sheet:_,sheetName:_._name,row:r.row,col:r.col}),m._updateValidationUI(r.row,r.col)}m.shift?(d=i(_._activeRowIndex,e.row),f=a(_._activeRowIndex-e.row)+1,_._replaceActiveSelectedRange(d,-1,f,_.getColumnCount(),!0)):_._setSelectedRange(_._activeRowIndex,-1,1,_.getColumnCount(),!0)}else if(3===e.hitTestType)if(isNaN(e.row)||isNaN(e.col))_.isEditing()&&(h=_.getCellRect(_._activeRowIndex,_._activeColIndex,_.activeRowViewportIndex,_.activeColViewportIndex),_._render.update(h.x,h.y,h.width,h.height));else{if(!m.shift&&(_._activeRowIndex!==e.row||_._activeColIndex!==e.col)){if(n={sheet:_,sheetName:_._name,row:_._activeRowIndex,col:_._activeColIndex,cancel:!1},_.triggerLeaveCell(n),n&&!0===n.cancel)return;s=_._activeRowIndex!==e.row,_._setActiveCellImp(e.row,e.col,e.rowViewportIndex,e.colViewportIndex,t),s&&_.doDataItemChanged(),_.triggerEnterCell({sheet:_,sheetName:_._name,row:e.row,col:e.col}),m._updateValidationUI(e.row,e.col)}m.shift?_._extendSelectedRange(e.row,e.col,!0):(c=_._getSpanModel().find(e.row,e.col))?_._setSelectedRange(c.row,c.col,c.rowCount,c.colCount,!0):_._setSelectedRange(e.row,e.col,1,1,!0)}},x.prototype._startSelectingScroll=function(e){if(e&&(3!==e.hitTestType||!isNaN(e.row)&&!isNaN(e.col))){this.isWorking=!0,this.isSelecting=!0,this.startHitInfo={scrollRowViewportIndex:e.rowViewportIndex,scrollColViewportIndex:e.colViewportIndex,hitTestType:e.hitTestType},this.startScroll()}},x.prototype.startSelecting=function(e){this._startSelectingCore(e),this._startSelectingScroll(e)},x.prototype.continueSelecting=function(){var e;this.startHitInfo&&this.isWorking&&!0!==this._forceCancelSelectiong&&(3===(e=this.startHitInfo.hitTestType)?this.continueCellSelecting():2===e?this.continueRowSelecting():1===e&&this.continueColumnSelecting())},x.prototype.continueCellSelecting=function(){var e,t,o=this._sheet,n=this.getHitRowIndex(),r=this.getHitColumnIndex();n>=0&&r>=0&&o.canSelect(n,r)&&(e=o._selectionModel.toArray(),o._extendSelectedRange(n,r,!0),t=o._selectionModel.toArray(),this._notEqualSelecions(e,t)&&o.triggerSelectionChanging({sheet:o,sheetName:o._name,oldSelections:e,newSelections:t}),this.continueScroll())},x.prototype.continueRowSelecting=function(){var e,t,o=this._sheet,n=this.getHitRowIndex();if(n>=0&&o.canSelect(n,-1)){var a=i(o._activeRowIndex,n),s=r(o._activeRowIndex,n)-a+1,l=o.getColumnCount();if(0===o.selectionPolicy())return;2===o.selectionUnit()&&(a=-1,s=-1),e=o._selectionModel.toArray(),o._replaceActiveSelectedRange(a,-1,s,l,!0),t=o._selectionModel.toArray(),this._notEqualSelecions(e,t)&&o.triggerSelectionChanging({sheet:o,sheetName:o._name,oldSelections:e,newSelections:t})}this.continueScroll()},x.prototype.continueColumnSelecting=function(){var e,t,o=this._sheet,n=this.getHitColumnIndex();if(n>=0&&o.canSelect(-1,n)){var a=i(o._activeColIndex,n),s=r(o._activeColIndex,n)-a+1,l=o.getRowCount();if(0===o.selectionPolicy())return;1===o.selectionUnit()&&(a=-1,s=-1),e=o._selectionModel.toArray(),o._replaceActiveSelectedRange(-1,a,l,s,!0),t=o._selectionModel.toArray(),this._notEqualSelecions(e,t)&&o.triggerSelectionChanging({sheet:o,sheetName:o._name,oldSelections:e,newSelections:t})}this.continueScroll()},x.prototype.stopSelecting=function(){var e,t,n,r=this;r.startHitInfo=o,r.stopScroll(),r._forceCancelSelectiong=o,r.isWorking=!1,r.isSelecting=!1,e=r._sheet,(t=!r._lastSelections)||(n=e._selectionModel.toArray(),t=r._notEqualSelecions(r._lastSelections,n)),t&&e.triggerSelectionChanged({sheet:r._sheet,sheetName:r._sheet._name}),r._lastSelections=e._selectionModel.toArray()},x.prototype.startDragDropping=function(e){var n,r,i,a;if(!this.isDragDropping&&(n=this._sheet,r=o,1===n._selectionModel.length?r=n._selectionModel[0]:n._selectionModel.length<1&&(r=n._getSpanModel().find(n._activeRowIndex,n._activeColIndex)||new t.Range(n._activeRowIndex,n._activeColIndex,1,1)),r)){this.isDragDropping=!0,this.isWorking=!0,this._dragDropFromRange=r,i=n._getRangeRect(e.rowViewportIndex,e.colViewportIndex,r),(a=n._dragRect).x=i.x,a.y=i.y,a.width=i.width-1,a.height=i.height-1,a.row=r.row,a.col=r.col,a.rowCount=r.rowCount,a.colCount=r.colCount;var s=n._fixRange(r),l=e.row,u=e.col;l<s.row&&(l=s.row),l>=s.row+s.rowCount&&(l=s.row+s.rowCount-1),u<s.col&&(u=s.col),u>=s.col+s.colCount&&(u=s.col+s.colCount-1),a.hitRow=l,a.hitCol=u,a.rowOffset=l-s.row,a.colOffset=u-s.col,this.startHitInfo={scrollRowViewportIndex:e.rowViewportIndex,scrollColViewportIndex:e.colViewportIndex,hitTestType:e.hitTestType},this.startScroll()}},x.prototype.continueDragDropping=function(){var e,t,o=this;if(o.startHitInfo&&o.isWorking&&o.isDragDropping&&o._dragDropFromRange){var n=o.mousePosition;o._sheet._dragRect.hitTarget={x:n.x,y:n.y},e=o.getHitRowIndex(),t=o.getHitColumnIndex(),e>=0&&t>=0&&o.updateDragDropRect(e,t),o.continueScroll()}},x.prototype.updateDragDropRect=function(e,t){var o,n,a,s,l;if(this.isDragDropping&&this._dragDropFromRange){var u=this._sheet,c=u._dragRect,h=u._getActiveSelectedRange();-1===h.row&&-1!==h.col?(c.row=-1,c.col=r(0,i(u.getColumnCount()-c.colCount,t-c.colOffset))):-1!==h.row&&-1===h.col?(c.row=r(0,i(u.getRowCount()-c.rowCount,e-c.rowOffset)),c.col=-1):(c.row=c.row<0?-1:r(0,i(u.getRowCount()-c.rowCount,e-c.rowOffset)),c.col=c.col<0?-1:r(0,i(u.getColumnCount()-c.colCount,t-c.colOffset))),c.hitRow=e,c.hitCol=t,o=u._fixRange(c),(n=u._oldDragRange)&&o.row===n.row&&o.col===n.col&&o.rowCount===n.rowCount&&o.colCount===n.colCount&&o.row>u._getFirstVisualRow()&&o.col>u._getFirstVisualColumn()&&o.row+o.rowCount-1<u._getLastVisualRow()&&o.col+o.colCount-1<u._getLastVisualColumn()||(u._actualDragRange=o,u._render.refreshDragDropIndicator(),u._oldDragRange=o,(a=u.parent)&&a.showDragDropTip()&&(s=c.x+c.width+this.DRAGDROPTOOLTIP_OFFSET,l=c.y+c.height+this.DRAGDROPTOOLTIP_OFFSET,this._showTooltip(this._getDragDropRectString(o),s,l)))}},x.prototype._getDragDropRectString=function(e){if(e&&t.util.hasCalc()){var o,r=this._sheet,i=r._getActiveSelectedRange(),a=r.getActiveRowIndex(),s=r.getActiveColumnIndex();return a=a<0?0:a,s=s<0?0:s,1===i.rowCount&&1===i.colCount?o=new t.Calc.Expressions.CellExpression(e.row-a,e.col-s,!0,!0):(o=new t.Calc.Expressions.RangeExpression,-1===i.row&&i.col>=0?o.initBand(e.col-s,e.col-s+i.colCount-1,!0,!0,!1):-1===i.col&&i.row>=0?o.initBand(e.row-a,e.row-a+i.rowCount-1,!0,!0,!0):i.row>=0&&i.col>=0&&o.init(e.row-a,e.col-s,e.row-a+i.rowCount-1,e.col-s+i.colCount-1,!0,!0,!0,!0)),r.getCalcService().unparse(r._getSheetSource(),o,a,s)}return n},x.prototype.stopDragDrop=function(){var e,n,r=this,i=!1,a="",s=!1,l=r._sheet;if(r.startHitInfo=o,r.stopScroll(),e=(n=l._getActiveSelectedRange())&&(n.rowCount>0||n.colCount>0)?{r:n.row,c:n.col,rc:n.rowCount,cc:n.colCount}:{r:l._activeRowIndex,c:l._activeColIndex,rc:1,cc:1},!0===r.isDragDropping&&!0===r.isWorking){var u,c,h=e.r,p=e.c,d=e.rc,f=e.cc,g=l._dragRect.row,m=l._dragRect.col;!r._isDragInsert||-1!==h&&-1!==p?(g!==h||m!==p)&&((l._hasPartSpans(h,p,d,f)||l._hasPartSpans(g,m,d,f))&&(i=!0,a=t.SR.Exp_ChangeMergedCell),i||(l._hasPartArrayFormulas(h,p,d,f)||l._hasPartArrayFormulas(g,m,d,f))&&(i=!0,a=t.SR.Exp_ChangePartOfArray),!i&&l.isProtected&&(!r._isDragCopy&&l._isAnyCellInRangeLocked(new t.Range(h,p,d,f))||l._isAnyCellInRangeLocked(new t.Range(g,m,d,f)))&&(i=!0,a=t.SR.Exp_CellReadOnly),i||(c=new t.UndoRedo.DragDropExtent(h,p,g,m,d,f),l._raiseDragDropBlock(c.fromRow,c.fromColumn,c.toRow,c.toColumn,c.rowCount,c.columnCount,r._isDragCopy,!1,1023)||(u=new t.UndoRedo.DragDropUndoAction(l,c,r._isDragCopy,!1,1023),s=l._doCommand(u),l._raiseDragDropBlockCompleted(c.fromRow,c.fromColumn,c.toRow,c.toColumn,c.rowCount,c.columnCount,r._isDragCopy,!1,1023)))):p>=0&&h<0?(r._isDragCopy&&(m<=p||m>=p+f)||!r._isDragCopy&&(m<p||m>p+f))&&((l._hasPartSpans(-1,p,-1,f)||l._hasPartSpans(-1,m,-1,0))&&(i=!0,a=t.SR.Exp_ChangeMergedCell),i||(l._hasPartArrayFormulas(-1,p,-1,f)||l._hasPartArrayFormulas(-1,m,-1,0))&&(i=!0,a=t.SR.Exp_ChangePartOfArray),!i&&l.isProtected&&(i=!0,a=t.SR.Exp_ColumnReadOnly),!i&&l._hasPartTable(-1,m,-1,1)&&(i=!0,a=t.SR.Exp_DragDropShiftTableCell),i||r._isDragCopy||!l._hasPartTable(-1,p,-1,f)||(i=!0,a=t.SR.Exp_DragDropChangePartOfTable),i||(c=new t.UndoRedo.DragDropExtent(-1,p,-1,m,-1,f),l._raiseDragDropBlock(c.fromRow,c.fromColumn,c.toRow,c.toColumn,c.rowCount,c.columnCount,r._isDragCopy,!0,1023)||(u=new t.UndoRedo.DragDropUndoAction(l,c,r._isDragCopy,!0,1023),s=l._doCommand(u),l._raiseDragDropBlockCompleted(c.fromRow,c.fromColumn,c.toRow,c.toColumn,c.rowCount,c.columnCount,r._isDragCopy,!0,1023)))):h>=0&&p<0&&(r._isDragCopy&&(g<=h||g>=h+d)||!r._isDragCopy&&(g<h||g>h+d))&&((l._hasPartSpans(h,-1,d,-1)||l._hasPartSpans(g,-1,0,-1))&&(i=!0,a=t.SR.Exp_ChangeMergedCell),i||(l._hasPartArrayFormulas(h,-1,d,-1)||l._hasPartArrayFormulas(g,-1,0,-1))&&(i=!0,a=t.SR.Exp_ChangePartOfArray),!i&&l.isProtected&&(i=!0,a=t.SR.Exp_RowReadOnly),i||r._isDragCopy||!l._hasPartTable(h,-1,d,-1)||(i=!0,a=t.SR.Exp_DragDropChangePartOfTable),i||(c=new t.UndoRedo.DragDropExtent(h,-1,g,-1,d,-1),l._raiseDragDropBlock(c.fromRow,c.fromColumn,c.toRow,c.toColumn,c.rowCount,c.columnCount,r._isDragCopy,!0,1023)||(u=new t.UndoRedo.DragDropUndoAction(l,c,r._isDragCopy,!0,1023),s=l._doCommand(u),l._raiseDragDropBlockCompleted(c.fromRow,c.fromColumn,c.toRow,c.toColumn,c.rowCount,c.columnCount,r._isDragCopy,!0,1023))))}r.isWorking=!1,r.isDragDropping=!1,r._dragDropFromRange=o,r._isDragInsert=!1,r._isDragCopy=!1,r._removeTooltip(),!1===s&&(l._dragRect={},l.repaint()),i&&l._raiseInvalidOperation(3,a)},x.prototype.startFormulaRangeAppending=function(e){var o,n=this,r=n._sheet,i=r._formulaTextBox;if(i){(o=i.isAppending())&&n._formulaRangeAppendingInfo||(n._formulaRangeAppendingInfo={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1});var a,s=r.getRowCount(),l=r.getColumnCount(),u=e.hitTestType,c=e.row,h=e.col,p=n.shift,d=n.ctrl,f=n._formulaRangeAppendingInfo,g=f.anchorRow,m=f.anchorCol,_=-1,y=-1;0===u?(_=r.frozenRowCount?r._getFirstVisualRow():r._scrollTopRow,y=r.frozenColCount?r._getFirstVisualColumn():r._scrollLeftCol,a=new t.Range(-1,-1,-1,-1),d?i.appendRange(n.rangeToString(a),!1,!1):p?i.appendRange(n.rangeToString(a),!0,!1):i.appendRange(n.rangeToString(a),!1,!0),n.isWorking=!0):1===u?(_=r.frozenRowCount?r._getFirstVisualRow():r._scrollTopRow,y=h,a=r._getExtendedRange(0,h,s-1,h),a=new t.Range(-1,a.col,-1,a.colCount),d?i.appendRange(n.rangeToString(a),!1,!1):p?(m>=0&&(a=r._getExtendedRange(0,h,s-1,m),a=new t.Range(-1,a.col,-1,a.colCount)),i.appendRange(n.rangeToString(a),!0,!1)):i.appendRange(n.rangeToString(a),!1,!0),n.isWorking=!0):2===u?(_=c,y=r.frozenColCount?r._getFirstVisualColumn():r._scrollLeftCol,a=r._getExtendedRange(c,0,c,l-1),a=new t.Range(a.row,-1,a.rowCount,-1),d?i.appendRange(n.rangeToString(a),!1,!1):p?(g>=0&&(a=r._getExtendedRange(c,0,g,l-1),a=new t.Range(a.row,-1,a.rowCount,-1)),i.appendRange(n.rangeToString(a),!0,!1)):i.appendRange(n.rangeToString(a),!1,!0),n.isWorking=!0):3===u&&(_=c,y=h,a=r._getExtendedRange(c,h,c,h),a=new t.Range(a.row,a.col,1,1),d?i.appendRange(n.rangeToString(a),!1,!1):p?(g>=0&&m>=0&&(a=r._getExtendedRange(c,h,g,m)),i.appendRange(n.rangeToString(a),!0,!1)):i.appendRange(n.rangeToString(a),!1,!0),n.isWorking=!0),n.isFormulaRangeAppending=n.isWorking,p&&o||(f.anchorRow=_,f.anchorCol=y,f.leadingRow=_,f.leadingCol=y),n.startHitInfo={scrollRowViewportIndex:e.rowViewportIndex,scrollColViewportIndex:e.colViewportIndex,hitTestType:e.hitTestType},n.startScroll()}},x.prototype.continueFormulaRangeAppending=function(){var e,t=this.startHitInfo;t&&this.isWorking&&(3===(e=t.hitTestType)?this.continueFormulaRangeCellAppending():2===e?this.continueFormulaRangeRowAppending():1===e&&this.continueFormulaRangeColumnAppending())},x.prototype.continueFormulaRangeCellAppending=function(){var e=this._formulaRangeAppendingInfo,t=e.anchorRow,o=e.anchorCol,n=this.getHitRowIndex(),r=this.getHitColumnIndex();if(t>=0&&o>=0&&n>=0&&r>=0){var i=this._sheet,a=i._getExtendedRange(n,r,t,o),s=this.rangeToString(a);s&&i._formulaTextBox.appendRange(s,!0,!1)}this.continueScroll()},x.prototype.continueFormulaRangeRowAppending=function(){var e,o,n,r=this._formulaRangeAppendingInfo.anchorRow,i=this.getHitRowIndex();r>=0&&i>=0&&(o=(e=this._sheet)._getExtendedRange(i,0,r,e.getColumnCount()-1),o=new t.Range(o.row,-1,o.rowCount,-1),(n=this.rangeToString(o))&&e._formulaTextBox.appendRange(n,!0,!1)),this.continueScroll()},x.prototype.continueFormulaRangeColumnAppending=function(){var e,o,n,r=this._formulaRangeAppendingInfo.anchorCol,i=this.getHitColumnIndex();r>=0&&i>=0&&(o=(e=this._sheet)._getExtendedRange(0,i,e.getRowCount()-1,r),o=new t.Range(-1,o.col,-1,o.colCount),(n=this.rangeToString(o))&&e._formulaTextBox.appendRange(n,!0,!1)),this.continueScroll()},x.prototype.stopFormulaRangeAppending=function(){this.stopScroll(),this.startHitInfo=o,this.isWorking=!1,this.isFormulaRangeAppending=!1},x.prototype.startFormulaRangeMoving=function(e){var t,o,n,r,i,a=this._sheet,s=a._formulaTextBox,l=e.formulaRangeHitInfo;if(l&&l.inBorder&&s&&(s.isAppending()&&s.stopAppending(),s.close(),o=(t=l.paramRange)&&t.text)&&(n=this.stringToRange(o))){var u=a._fixRange(n),c=e.row,h=e.col;c<u.row&&(c=u.row),c>=u.row+u.rowCount&&(c=u.row+u.rowCount-1),h<u.col&&(h=u.col),h>=u.col+u.colCount&&(h=u.col+u.colCount-1),r=c-u.row,i=h-u.col,this.isWorking=!0,this.isFormulaRangeMoving=!0,this._formulaRangeMovingInfo={paramRange:t,fromRange:n,rowOffset:r,colOffset:i},this.startHitInfo={scrollRowViewportIndex:e.rowViewportIndex,scrollColViewportIndex:e.colViewportIndex,hitTestType:e.hitTestType},this.startScroll()}},x.prototype.continueFormulaRangeMoving=function(){var e,o;if(this.isWorking&&this.isFormulaRangeMoving){if(e=this.getHitRowIndex(),o=this.getHitColumnIndex(),e>=0&&o>=0){var n=this._formulaRangeMovingInfo,a=n.fromRange,s=n.rowOffset,l=n.colOffset,u=n.toRow,c=n.toCol,h=e,p=o;if(h!==u||p!==c){n.toRow=h,n.toCol=p;var d=this._sheet,f=d.getRowCount(),g=d.getColumnCount(),m=a.row,_=a.col,y=a.rowCount,C=a.colCount,w=m<0?-1:r(0,i(f-y,e-s)),v=_<0?-1:r(0,i(g-C,o-l)),S=this.rangeToString(new t.Range(w,v,y,C));S&&d._formulaTextBox.repalceRange(n.paramRange.index,S)}}this.continueScroll()}},x.prototype.stopFormulaRangeMoving=function(){this.stopScroll(),this.isWorking=!1,this.isFormulaRangeMoving=!1,this._formulaRangeMovingInfo=o},x.prototype.startFormulaRangeResizing=function(e){var t,o,n,r=this._sheet._formulaTextBox,i=e.formulaRangeHitInfo;if(i&&r&&(r.isAppending()&&r.stopAppending(),o=(t=i.paramRange)&&t.text,t&&o)&&(n=this.stringToRange(o))){var a,s,l,u,c=n.row,h=n.row<0?-1:n.row+n.rowCount-1,p=n.col,d=n.col<0?-1:n.col+n.colCount-1;if(i.inTopLeft)a=h,s=d,l=c,u=p;else if(i.inTopRight)a=h,s=p,l=c,u=d;else if(i.inBottomLeft)a=c,s=d,l=h,u=p;else{if(!i.inBottomRight)return;a=c,s=p,l=h,u=d}this.isWorking=!0,this.isFormulaRangeResizing=!0,this._formulaRangeResizingInfo={paramRange:t,anchorRow:a,anchorCol:s,toRow:l,toCol:u},this.startHitInfo={scrollRowViewportIndex:e.rowViewportIndex,scrollColViewportIndex:e.colViewportIndex,hitTestType:e.hitTestType},this.startScroll()}},x.prototype.continueFormulaRangeResizing=function(){var e,o,n;if(this.isWorking&&this.isFormulaRangeResizing){if(e=this.getHitRowIndex(),o=this.getHitColumnIndex(),e>=0&&o>=0){var a=this._formulaRangeResizingInfo,s=a.anchorRow,l=a.anchorCol,u=a.toRow,c=a.toCol,h=e,p=o;if(h!==u||p!==c){a.toRow=h,a.toCol=p;var d=this._sheet,f=d.getRowCount(),g=d.getColumnCount(),m=s<0?f-1:s,_=l<0?g-1:l,y=i(m,h),C=i(_,p),w=r(m,h)-y+1,v=r(_,p)-C+1;0===y&&w===f&&(y=-1,w=-1),0===C&&v===g&&(C=-1,v=-1),(n=this.rangeToString(new t.Range(y,C,w,v)))&&d._formulaTextBox.repalceRange(a.paramRange.index,n)}}this.continueScroll()}},x.prototype.stopFormulaRangeResizing=function(){this.stopScroll(),this.isWorking=!1,this.isFormulaRangeResizing=!1,this._formulaRangeResizingInfo=o},x.prototype.getFormulaRangeHitInfo=function(e,n,r){var i,a,s,l,u,c,h,p=this._sheet,d=p._formulaTextBox,f=d&&d.getRanges();if(!f||0===f.length||(i=e.rowViewportIndex,a=e.colViewportIndex,this.inGrayArea(i,a,n,r)))return o;for(c=f.length-1;c>=0;c--)if(!1!==(s=f[c]).allowDrag&&(!(h=t.features.formulatextbox&&t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance)||!h.text)&&(l=this.stringToRange(s.text))){var g=(u=p._getRangeRect(i,a,l)).x-2,m=u.x+u.width+1-5,_=u.y-2,y=u.y+u.height+1-5;if(g+5<=n&&n<m&&(_+1<=r&&r<=_+3||y+1<=r&&r<=y+3))return{paramRange:s,inBorder:!0};if(_+5<=r&&r<y&&(g+1<=n&&n<=g+3||m+1<=n&&n<=m+3))return{paramRange:s,inBorder:!0};if(m<=n&&n<m+5&&y<=r&&r<y+5)return{paramRange:s,inBottomRight:!0};if(g<=n&&n<g+5&&y<=r&&r<y+5)return{paramRange:s,inBottomLeft:!0};if(m<=n&&n<m+5&&_<=r&&r<_+5)return{paramRange:s,inTopRight:!0};if(g<=n&&n<g+5&&_<=r&&r<_+5)return{paramRange:s,inTopLeft:!0}}return o},x.prototype.changeFormulaReference=function(){var n,r,i,a,s=this._sheet,l=s._formulaTextBox;if(l){e.Sheets;var u,c,h=t.Calc,p=s._activeRowIndex,d=s._activeColIndex,f=1===s.referenceStyle(),g=new h.ParserContext(s._getSheetSource(),f,p,d),m=new h.Parser;if(l.isAppending())for(n=l.getAppendingRanges(),r=0;r<n.length;r++){u=n[r];try{c=m.parse(u.text,g)}catch(e){c=o}c&&(2===c.t?(this.changeRangeExpressionReference(c,p,d,!0,!0),l.repalceRange(u.index,m.unparse(c,g))):0===c.t&&(this.changeCellExpressionReference(c,p,d),l.repalceRange(u.index,m.unparse(c,g))))}else{if(!(u=l.getActiveRange()))return;try{c=m.parse(u.text,g)}catch(e){c=o}if(!c)return;2===c.t?(i=u.textOffset+u.text.lastIndexOf(":"),l.caret()<=i?(this.changeRangeExpressionReference(c,p,d,!0,!1),a=m.unparse(c,g),l.repalceRange(u.index,a),l.caret(u.textOffset+a.lastIndexOf(":"))):(this.changeRangeExpressionReference(c,p,d,!1,!0),l.repalceRange(u.index,m.unparse(c,g)))):0===c.t&&(this.changeCellExpressionReference(c,p,d),l.repalceRange(u.index,m.unparse(c,g)))}}},x.prototype.changeRangeExpressionReference=function(e,t,o,n,r){var i,a,s=e.startRowRelative,l=e.startColumnRelative;n&&(s&&l?(e.startRowRelative=!1,e.startColumnRelative=!1,e.startRow+=t,e.startColumn+=o):s?(e.startColumnRelative=!0,e.startColumn-=o):l?(e.startRowRelative=!0,e.startColumnRelative=!1,e.startRow-=t,e.startColumn+=o):(e.startColumnRelative=!0,e.startColumn-=o)),i=e.endRowRelative,a=e.endColumnRelative,r&&(i&&a?(e.endRowRelative=!1,e.endColumnRelative=!1,e.endRow+=t,e.endColumn+=o):i?(e.endColumnRelative=!0,e.endColumn-=o):a?(e.endRowRelative=!0,e.endColumnRelative=!1,e.endRow-=t,e.endColumn+=o):(e.endColumnRelative=!0,e.endColumn-=o))},x.prototype.changeCellExpressionReference=function(e,t,o){var n=e.rowRelative,r=e.columnRelative;n&&r?(e.rowRelative=!1,e.columnRelative=!1,e.row+=t,e.column+=o):n?(e.columnRelative=!0,e.column-=o):r?(e.rowRelative=!0,e.columnRelative=!1,e.row-=t,e.column+=o):(e.columnRelative=!0,e.column-=o)},x.prototype.rangeToString=function(n){var r,i,a,s;if(!n)return o;var l=e.Sheets,u=t.Calc,c=this._sheet,h=c._activeRowIndex,p=c._activeColIndex,d=1===c.referenceStyle();return n.row<0&&n.col<0&&(n=new l.Range(0,-1,c.getRowCount(),-1)),r=c.findTable(n.row,n.col),i=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,this.isStructReference(r,n)?(t.features.formulatextbox&&i&&i.text&&i.sheet!==c&&(h=p=-1),u.rangeToFormulaWithStructReference(c,n,h,p,15,d,r)):(a=u.rangeToFormula(n,h,p,15,d),t.features.formulatextbox&&i&&i.text&&(s=c.getName(),(/^\d+$/.test(s)||t.StringUtil.contains(s," "))&&(s="'"+s+"'"),a=s+"!"+a),a)},x.prototype.isStructReference=function(e,t){if(!e)return!1;var o=!1,n=!1;if(1===t.rowCount){if(e.hasHeadersRow()&&t.row===e.startRow()||e.hasTotalsRow()&&t.row===e.endRow())return!0}else e.hasHeadersRow()&&t.row===e.startRow()&&(t.rowCount===e.dataRange().rowCount+1&&(o=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1+1&&(o=!0)),t.row===e.dataRange().row&&(t.rowCount===e.dataRange().rowCount&&(o=!0),e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1&&(o=!0));return t.col+t.colCount<=e.startColumn()+e.dataRange().colCount&&(n=!0),o&&n},x.prototype.stringToRange=function(n){if(!n)return o;e.Sheets;var r=t.Calc,i=this._sheet,a=i._activeRowIndex,s=i._activeColIndex;try{return r.formulaToRange(i,n,a,s)}catch(e){}return o},x.prototype.startDragFill=function(e){var t=this;!0!==t.isDraggingFill&&!0!==t.isWorking&&(t.updateDragFillStartRange(),t._dragFillStartRange)&&(t.isWorking=!0,t.isDraggingFill=!0,t._isDragAroundIndicator=!0,t._dragStartRowViewport=e.rowViewportIndex,t._dragStartColumnViewport=e.colViewportIndex,t._dragToRowViewport=e.rowViewportIndex,t._dragToColumnViewport=e.colViewportIndex,t.updateDragStartRangeViewports(),t.startHitInfo={scrollRowViewportIndex:e.rowViewportIndex,scrollColViewportIndex:e.colViewportIndex,hitTestType:e.hitTestType},t.startScroll())},x.prototype.updateDragStartRangeViewports=function(){var e,t=this,o=t.dragFillStartTopRow();o>=0&&o<t._sheet.frozenRowCount?t._dragFillStartTopRowViewport=0:o>=t._sheet.frozenRowCount&&o<=t._sheet.getRowCount()&&(t._dragFillStartTopRowViewport=1),t._dragFillStartBottomRowViewport=t.isDragFillWholeColumns()?1:t._dragStartRowViewport,(e=t.dragFillStartLeftColumn())>=0&&e<t._sheet.frozenColCount?t._dragFillStartLeftColumnViewport=0:e>=t._sheet.frozenColCount&&e<=t._sheet.getColumnCount()&&(t._dragFillStartLeftColumnViewport=1),t._dragFillStartRightColumnViewport=t.isDragFillWholeRows()?1:t._dragStartColumnViewport},x.prototype.continueDragFill=function(){var e=this;if(e.startHitInfo&&e.isDraggingFill&&e.isWorking&&e._dragFillStartRange){if(e._dragToRowViewport=e.getHitRowViewportIndex(),e._dragToColumnViewport=e.getHitColumnViewportIndex(),e._dragToRow=e.getHitRowIndex(),e._dragToColumn=e.getHitColumnIndex(),e._dragToRow>=0&&e._dragToColumn>=0){e.updateCurrentFillSettings(),e.updateCurrentFillRange();var t=e._sheet.parent,o=!1;e.getDragFillFrameRange()&&(o=e.validateFillRange(e._currentFillRange,!0)),t&&t.showDragFillTip()&&o&&e._showDragFillTooltip(),e.refreshDragFill()}e.continueScroll()}},x.prototype._getDragFillTooltipContent=function(){var e,n,r,i;if(!t.features.fill)return o;var a,s=this,l=s._sheet,u=s._dragFillStartRange,c=s._currentFillRange,h=l.defaultDragFillType(),p=s.getDragAutoFillType(3===h?5:h),d=s.getCurrentFillDirection(),f=s.getDragFillFrameRange();if(1===p){a=0===d||1===d?1:0,e=new t.FillImp(l),o,n=e.fillAuto(f,a,!0);var g=s._getAvailableRange(d,c,u),m=l.getActualStyle(g.row,g.col),_=m.cellType||l.getDefaultCellType(),y=m.formatter?m.formatter:m._autoFormatter;return n instanceof Date&&t.features.formatter&&(y=new t.GeneralFormatter(t.DefaultTokens.DateTimeFormatInfo().shortDatePattern+" hh:mm:ss AM/PM;@",0)),r=3,s.startHitInfo&&(r=s.startHitInfo.hitTestType),i={sheet:l,row:g.row,col:g.col,sheetArea:r},_.format(n,y,i)}return 0===p?(g=s._getAvailableRange(d,c,u),l.getFormula(g.row,g.col)?o:l.getText(g.row,g.col)):o},x.prototype._getAvailableRange=function(e,o,n){var r,i=new t.Range(n.row,n.col,1,1);return 3===e?(r=0===(r=o.rowCount%n.rowCount)?n.row+n.rowCount-1:n.row+r-1,i.row=r,i.col=n.col):1===e?(r=0===(r=o.colCount%n.colCount)?n.col+n.colCount-1:n.col+r-1,i.row=n.row,i.col=r):0===e?(r=0===(r=o.colCount%n.colCount)?n.col:n.col+n.colCount-r,i.row=n.row,i.col=r):2===e&&(r=0===(r=o.rowCount%n.rowCount)?n.row:n.row+n.rowCount-r,i.row=r,i.col=n.col),i},x.prototype._showDragFillTooltip=function(){var e=this;if(4===e.getDragAutoFillType()||e.isDragFillWholeRows()||e.isDragFillWholeColumns())return e._removeTooltip(),o;var t,n,r,i=e._sheet,a=e.getCurrentFillDirection(),s=e.getDragFillFrameRange(),l=i._getRangeRect2(s);r=e._getDragFillTooltipContent(),3===a?(t=l.x+l.width+e.DRAGFILLTOOLTIP_OFFSET,n=l.y+l.height+e.DRAGFILLTOOLTIP_OFFSET):1===a?(t=l.x+l.width+e.DRAGFILLTOOLTIP_OFFSET,n=l.y+l.height+e.DRAGFILLTOOLTIP_OFFSET):0===a?(t=l.x+e.DRAGFILLTOOLTIP_OFFSET,n=l.y+l.height+e.DRAGFILLTOOLTIP_OFFSET):2===a&&(t=l.x+l.width+e.DRAGFILLTOOLTIP_OFFSET,n=l.y+e.DRAGFILLTOOLTIP_OFFSET),e._showTooltip(r,t,n)},x.prototype.refreshDragFill=function(){this.clearDragFill(),this.refreshSelectionBorder(),this.paintDragFill(),this._oldDragFillFrameRange=this.getDragFillFrameRange()},x.prototype.clearDragFill=function(){var e,t=this._sheet;this._oldDragFillFrameRange&&((e=t._getRangeRect2(this._oldDragFillFrameRange)).x-=2,e.y-=2,e.width+=4,e.height+=4,t._render.copyDoubleBufferRect(e))},x.prototype.refreshSelectionBorder=function(e){this._sheet._render.repaintSelection(this._dragFillStartRange,o,e)},x.prototype.paintDragFill=function(){var e,t,o=this._sheet,n=o._render,r=this.getDragFillFrameRange();r&&(e=n._getCtx(),t=o._getRangeRect2(r),e.save(),e.beginPath(),n.paintDragRectangle(e,t),e.restore())},x.prototype.updateCurrentFillRange=function(){this._currentFillRange=this.getCurrentFillRange()},x.prototype.isDragFillWholeRows=function(){return-1===this._dragFillStartRange.col&&-1!==this._dragFillStartRange.row},x.prototype.isDragFillWholeColumns=function(){return-1===this._dragFillStartRange.row&&-1!==this._dragFillStartRange.col},x.prototype.isDragClear=function(){return 4===this._currentFillDirection||5===this._currentFillDirection},x.prototype.getCurrentFillRange=function(){var e=this,o=-1,n=-1,r=-1,i=-1;switch(e._currentFillDirection){case 0:e.isDragFillWholeColumns()?(o=-1,r=-1):(o=e.dragFillStartTopRow(),r=e._dragFillStartRange.rowCount),n=e._dragToColumn,i=e.dragFillStartLeftColumn()-n;break;case 1:e.isDragFillWholeColumns()?(o=-1,r=-1):(o=e.dragFillStartTopRow(),r=e._dragFillStartRange.rowCount),n=e.dragFillStartRightColumn()+1,i=e._dragToColumn-n+1;break;case 2:o=e._dragToRow,r=e.dragFillStartTopRow()-o,e.isDragFillWholeRows()?(n=-1,i=-1):(n=e.dragFillStartLeftColumn(),i=e._dragFillStartRange.colCount);break;case 3:o=e.dragFillStartBottomRow()+1,r=e._dragToRow-o+1,e.isDragFillWholeRows()?(n=-1,i=-1):(n=e.dragFillStartLeftColumn(),i=e._dragFillStartRange.colCount);break;case 5:o=e._dragToRow,r=e.dragFillStartBottomRow()-o+1,e.isDragFillWholeRows()?(n=-1,i=-1):(n=e.dragFillStartLeftColumn(),i=e._dragFillStartRange.colCount);break;case 4:e.isDragFillWholeColumns()?(o=-1,r=-1):(o=e._dragFillStartRange.row,r=e._dragFillStartRange.rowCount),n=e._dragToColumn,i=e.dragFillStartRightColumn()-n+1}return new t.Range(o,n,r,i)},x.prototype.dragFillStartBottomRowLayout=function(){var e=this.dragFillStartBottomRow();return-1!==e?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(e):o},x.prototype.dragFillToViewportBottomRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportBottomRow())},x.prototype.dragFillToViewportBottomRow=function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},x.prototype.dragFillStartRightColumnLayout=function(){var e=this.dragFillStartRightColumn();return-1!==e?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(e):o},x.prototype.dragFillToViewportRightColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportRightColumn())},x.prototype.dragFillToViewportRightColumn=function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},x.prototype.updateCurrentFillSettings=function(){var e,o,n,r,s,l,u,c=this,h=c.isDragFillWholeRows(),p=c.isDragFillWholeColumns(),d=t.GC$(c._sheet._getCanvas()).offset(),f=c.mousePosition.e,g=c.mousePosition.x,m=c.mousePosition.y,_=f.pageX-d.left,y=f.pageY-d.top,C=!1;if(h||p?p?c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn()?c._currentFillDirection=4:c._dragToColumn<c.dragFillStartLeftColumn()?c._currentFillDirection=0:c._dragToColumn>c.dragFillStartRightColumn()&&(c._currentFillDirection=1):h&&(c._dragToRow>=c.dragFillStartTopRow()&&c._dragToRow<=c.dragFillStartBottomRow()?c._currentFillDirection=5:c._dragToRow<c.dragFillStartTopRow()?c._currentFillDirection=2:c._dragToRow>c.dragFillStartBottomRow()&&(c._currentFillDirection=3)):c._dragToRow>=c.dragFillStartTopRow()&&c._dragToRow<=c.dragFillStartBottomRow()?c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn()?(e=a(c._dragToColumn-c.dragFillStartRightColumn()),(o=a(c._dragToRow-c.dragFillStartBottomRow()))>e?c._currentFillDirection=5:o<e?c._currentFillDirection=4:((n=c.dragFillStartBottomRowLayout())||(n=c.dragFillToViewportBottomRowLayout()),m>n.y+n.height?c._currentFillDirection=3:((r=c.dragFillStartRightColumnLayout())||(r=c.dragFillToViewportRightColumnLayout()),s=r.x+r.width-g,l=n.y+n.height-m,_>=r.x&&_<=r.x+r.width&&y>=n.y&&y<=n.y+n.height?c._currentFillDirection=s>=l?4:5:C=!0))):c._dragToColumn<c.dragFillStartLeftColumn()?c._currentFillDirection=0:c._dragToColumn>c.dragFillStartRightColumn()&&(c._currentFillDirection=1):c._dragToRow<c.dragFillStartTopRow()?c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn()?c._currentFillDirection=2:c._dragToColumn<c.dragFillStartLeftColumn()?(e=a(c._dragToColumn-c.dragFillStartLeftColumn()),o=a(c._dragToRow-c.dragFillStartTopRow()),c._currentFillDirection=o>=e?2:0):c._dragToColumn>c.dragFillStartRightColumn()&&(e=a(c._dragToColumn-c.dragFillStartRightColumn()),o=a(c._dragToRow-c.dragFillStartTopRow()),c._currentFillDirection=o>=e?2:1):c._dragToRow>c.dragFillStartBottomRow()&&(c._dragToColumn>=c.dragFillStartLeftColumn()&&c._dragToColumn<=c.dragFillStartRightColumn()?c._currentFillDirection=3:c._dragToColumn<c.dragFillStartLeftColumn()?(e=a(c._dragToColumn-c.dragFillStartLeftColumn()),o=a(c._dragToRow-c.dragFillStartBottomRow()),c._currentFillDirection=o>=e?3:0):c._dragToColumn>c.dragFillStartRightColumn()&&(e=a(c._dragToColumn-c.dragFillStartRightColumn()),o=a(c._dragToRow-c.dragFillStartBottomRow()),c._currentFillDirection=o>=e?3:1)),u=c._sheet._dragFillIndicatorRect){var w=c.dragFillStartBottomRow(),v=c.dragFillStartRightColumn(),S=w+1,x=v+1,R=c._sheet.getRowHeight(w,3),b=c._sheet.getColumnWidth(v,3),T=c._sheet.getRowHeight(S,3),A=c._sheet.getColumnWidth(x,3),I=u.x+u.width/2-i(10,b/2),D=u.x+u.width/2+i(10,A/2),F=u.y+u.height/2-i(10,R/2),M=u.y+u.height/2+i(10,T/2),E=!1;h||p?p?E=I<=_&&_<=D:h&&(E=F<=y&&y<=M):E=I<=_&&_<=D&&F<=y&&y<=M,E||C?(c._isDragAroundIndicator=!0,c._currentFillDirection=4):c._isDragAroundIndicator=!1}},x.prototype.dragFillStartTopRow=function(){return this._dragFillStartRange?-1===this._dragFillStartRange.row?0:this._dragFillStartRange.row:-1},x.prototype.dragFillStartBottomRow=function(){return this._dragFillStartRange?-1===this._dragFillStartRange.row?this._sheet.getRowCount()-1:this._dragFillStartRange.row+this._dragFillStartRange.rowCount-1:-1},x.prototype.dragFillStartLeftColumn=function(){return this._dragFillStartRange?-1===this._dragFillStartRange.col?0:this._dragFillStartRange.col:-1},x.prototype.dragFillStartRightColumn=function(){return this._dragFillStartRange?-1===this._dragFillStartRange.col?this._sheet.getColumnCount()-1:this._dragFillStartRange.col+this._dragFillStartRange.colCount-1:-1},x.prototype.endDragFill=function(){var e,n,r,i=this,a=i._sheet;i.startHitInfo=o,i.stopScroll(),i._removeTooltip(),i.isDraggingFill&&i.isWorking?(i.isDraggingFill=!1,i.isWorking=!1,(e=i.getDragFillFrameRange())&&(!i.validateFillRange(i._currentFillRange)||i._isDragAroundIndicator?(i.resetDragFill(),i.refreshSelection(e)):(n=i.getDragAutoFillType(),r=new t.UndoRedo.FillUndoAction(a,n,i._currentFillRange),a._doCommand(r),!i._isCancelDragFill&&i.isDragFill()&&a.showDragFillSmartTag()&&4!==i._currentDragFillType?i.showDragFillSmartTag(i._currentDragFillType):i.refreshSelection(e),i.resetDragFill()))):i.resetDragFill()},x.prototype.showDragFillSmartTag=function(e){if(t.features.fill_ui){var o=this._sheet,n=o._dragFillIndicatorRect,r={x:n.x+n.width,y:n.y+n.height,fillType:e};o._smartTag=new t._GcFillDialog(o.parent._getContainerDiv(),o,r),o._smartTag.open()}},x.prototype.updateDragFillStartRange=function(){var e=this._sheet;1===e._selectionModel.length?this._dragFillStartRange=e._selectionModel[0]:e._activeRowIndex>=0&&e._activeColIndex>=0&&(this._dragFillStartRange=new t.Range(e._activeRowIndex,e._activeColIndex,1,1))},x.prototype.resetDragFill=function(){this.isWorking=!1,this.isDraggingFill=!1},x.prototype.refreshSelection=function(e){this._sheet._render.repaintSelection(e)},x.prototype.getDragAutoFillType=function(e){var t=this._sheet,o=e!==n?e:t.defaultDragFillType();return this.isDragClear()?4:5!==o?o:1===this._dragFillStartRange.rowCount&&1===this._dragFillStartRange.colCount&&!this.isDragFillWholeColumns()&&!this.isDragFillWholeRows()?this.isControlPressed?1:0:this.isControlPressed?0:1},x.prototype.getDragFillFrameRange=function(){var e=this;if(!e._dragFillStartRange)return o;if(e.isDragClear())return e._dragFillStartRange;if(!e._currentFillRange)return o;var n=0,r=0,i=0,a=0;return e.isVerticalDragFill()?(n=2===e._currentFillDirection?e._currentFillRange.row:e._dragFillStartRange.row,r=e._dragFillStartRange.rowCount+e._currentFillRange.rowCount,i=e._dragFillStartRange.col,a=e._dragFillStartRange.colCount):(n=e._dragFillStartRange.row,r=e._dragFillStartRange.rowCount,i=0===e._currentFillDirection?e._currentFillRange.col:e._dragFillStartRange.col,a=e._dragFillStartRange.colCount+e._currentFillRange.colCount),new t.Range(n,i,r,a)},x.prototype.validateFillRange=function(e,o){var n=this._sheet,r=!0,i="";return n._hasSpans(e.row,e.col,e.rowCount,e.colCount)&&(r=!1,i=t.SR.Exp_FillRangeContainsMergedCell),r&&n.isProtected&&n._isAnyCellInRangeLocked(e)&&(r=!1,i=t.SR.Exp_FillCellsReadOnly),r||o||n._raiseInvalidOperation(2,i),r},x.prototype.isDragFill=function(){return this.isIncreaseFill()||this.isDecreaseFill()},x.prototype.isIncreaseFill=function(){return 3===this._currentFillDirection||1===this._currentFillDirection},x.prototype.isDecreaseFill=function(){return 0===this._currentFillDirection||2===this._currentFillDirection},x.prototype.isVerticalDragFill=function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},x.prototype.isDragToRowInView=function(){return this.isRowInViewport(this._dragToRowViewport,this._dragToRow)},x.prototype.isRowInViewport=function(e,t){var o=this._sheet.getViewportTopRow(e),n=this._sheet.getViewportBottomRow(e);return t>=o&&t<=n},x.prototype.getCurrentDragToRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragToRow)},x.prototype.isDragFillStartBottomRowInView=function(){return this.isRowInViewport(this._dragFillStartBottomRowViewport,this.dragFillStartBottomRow())},x.prototype.dragFillStartViewportBottomRowLayout=function(){return this._sheet._getRowLayout(this._dragStartRowViewport).findRow(this.dragFillStartViewportBottomRow())},x.prototype.dragFillStartViewportBottomRow=function(){return this._sheet.getViewportBottomRow(this._dragStartRowViewport)},x.prototype.getValidVerDragToRowLayout=function(){return this.isIncreaseFill()?this.isDragToRowInView()?this.getCurrentDragToRowLayout():this.dragFillToViewportBottomRowLayout():this.isDragFillStartBottomRowInView?this.dragFillStartBottomRowLayout():this.dragFillStartViewportBottomRowLayout()},x.prototype.isDragToColumnInView=function(){return this.isColumnInViewport(this._dragToColumnViewport,this._dragToColumn)},x.prototype.isColumnInViewport=function(e,t){var o=this._sheet.getViewportLeftColumn(e),n=this._sheet.getViewportRightColumn(e);return t>=o&&t<=n},x.prototype.getCurrentDragToColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragToColumn)},x.prototype.isDragFillStartRightColumnInView=function(){return this.isColumnInViewport(this._dragFillStartRightColumnViewport,this.dragFillStartRightColumn())},x.prototype.dragFillStartViewportRightColumnLayout=function(){return this._sheet._getColumnLayout(this._dragStartColumnViewport).findCol(this.dragFillStartViewportRightColumn())},x.prototype.dragFillStartViewportRightColumn=function(){return this._sheet.getViewportRightColumn(this._dragStartColumnViewport)},x.prototype.getValidHorDragToColumnLayout=function(){return this.isIncreaseFill()?this.isDragToColumnInView()?this.getCurrentDragToColumnLayout():this.dragFillToViewportRightColumnLayout():this.isDragFillStartRightColumnInView()?this.dragFillStartRightColumnLayout():this.dragFillStartViewportRightColumnLayout()},x.prototype.dragFillToViewportTopRowLayout=function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportTopRow())},x.prototype.dragFillToViewportTopRow=function(){return this._sheet.getViewportTopRow(this._dragToRowViewport)},x.prototype.dragFillToViewportLeftColumnLayout=function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportLeftColumn())},x.prototype.dragFillToViewportLeftColumn=function(){return this._sheet.getViewportLeftColumn(this._dragToColumnViewport)},x.prototype.getCurrentFillDirection=function(){switch(this._currentFillDirection){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 0;case 5:return 2}return 3},x.prototype.getHitRowViewportIndex=function(){var e=this._sheet,t=e._getRowViewportIndexNearY(this.mousePosition.y),o=this.startHitInfo.scrollRowViewportIndex,n=e._getRowLayout(1);return 0===t&&o>0&&n.length>0&&n[0].row>e._getFirstPageTopRow()?t=1:2===t&&o<2&&n.length>0&&n[n.length-1].row<e._getLastVisualRow()&&(t=1),t},x.prototype.getHitColumnViewportIndex=function(){var e=this._sheet,t=e._getColumnViewportIndexNearX(this.mousePosition.x),o=this.startHitInfo.scrollColViewportIndex,n=e._getColumnLayout(1);return 0===t&&o>0&&n.length>0&&n[0].col>e._getFirstPageLeftColumn()?t=1:2===t&&o<2&&n.length>0&&n[n.length-1].col<e._getLastVisualColumn()&&(t=1),t},x.prototype.getHitRowIndex=function(){var e,t,o=this._sheet,n=this.mousePosition.y,r=this.getHitRowViewportIndex(),i=o._getViewportRowLayoutNearY(r,n);return i?(e=o._getSheetLayout(),t=i.row,1===r&&n<e.viewportY&&t>o._getFirstPageTopRow()?o._getNextVisualRow(t-1)||t:1===r&&n>e.frozenTrailingY&&t>o._getLastFullyVisibleRow()&&o._getPrevVisualRow(t)||t):-1},x.prototype.getHitColumnIndex=function(){var e,t,o=this._sheet,n=this.mousePosition.x,r=this.getHitColumnViewportIndex(),i=o._getViewportColumnLayoutNearX(r,n);return i?(e=o._getSheetLayout(),t=i.col,1===r&&n<e.viewportX&&t>o._getFirstPageLeftColumn()?o._getNextVisualColumn(t-1)||t:1===r&&n>e.frozenTrailingX&&t>o._getLastFullyVisibleColumn()&&o._getPrevVisualColumn(t)||t):-1},x.prototype.getIntervalFromDistance=function(e){var t,o=0;return isNaN(e)||0===e||(t=e<0,e=a(e),o=s(500/e),(o=r(20,10*o))>200&&(o=200),t&&(o=-o)),o},x.prototype.updateRange=function(e,t,o,n){if(0!==o&&0!==n){var r=this._sheet,i=r._getRowLayout(0,3),a=r._getColumnLayout(0,3),s=r._getRowLayout(1,3),l=r._getColumnLayout(1,3),u=0;a&&a.length>0&&(u=a[a.length-1].col),l&&l.length>0&&(u=l[l.length-1].col);var c=this.getYForRow(e,t,o,n,!0,u,i,s),h=this.getYForRow(e,t,o,n,!1,u,i,s),p=0;i&&i.length>0&&(p=i[i.length-1].row),s&&s.length>0&&(p=s[s.length-1].row);var d=this.getXForCol(e,t,o,n,!0,p,a,l),f=this.getXForCol(e,t,o,n,!1,p,a,l),g=r._getSheetLayout(),m=r._render;f>d&&h>c&&m.update(d-g.headerX-2,c-g.headerY-2,f-d+2*g.headerX+2,h-c+2*g.headerY+2),h>c&&m.update(g.headerX,c,g.rowHeaderWidth,h-c),f>d&&(m.update(d,g.headerY,f-d,g.colHeaderHeight),m.update(d,g.footerY,f-d,g.colHeaderHeight))}},x.prototype.getYForRow=function(e,t,o,n,i,a,s,l){var u,c,h,p=this._sheet,d=e;if(i||(d=e+o-1),d<p.frozenRowCount){if(s.length<1)return-1}else{if(l.length<1)return-1;i?d<l[0].row&&(d=l[0].row):d>l[l.length-1].row&&(d=l[l.length-1].row)}for(u=0,i&&(u=9e4),c=r(p._scrollLeftCol,t);c<t+n&&c<=a;c++)(h=p.getCellRect(d,c))&&(i?h.y<u&&(u=h.y):u<h.y+h.height&&(u=h.y+h.height));return u},x.prototype.getXForCol=function(e,t,o,n,i,a,s,l){var u,c,h,p=this._sheet,d=t;if(i||(d=t+n-1),d<p.frozenColCount){if(s.length<1)return}else{if(l.length<1)return;i?d<l[0].col&&(d=l[0].col):d>l[l.length-1].col&&(d=l[l.length-1].col)}for(u=0,i&&(u=9e4),c=r(p._scrollTopRow,e);c<e+o&&c<=a;c++)(h=p.getCellRect(c,d))&&(i?h.x<u&&(u=h.x):u<h.x+h.width&&(u=h.x+h.width));return u},x.prototype._getPreVisualRow=function(e,t){var n=this._sheet._getPrevVisualRow(e,t);return n!==o?n:e},x.prototype._getPreVisualCol=function(e,t){var n=this._sheet._getPrevVisualColumn(e,t);return n!==o?n:e},x.prototype._getPreVisibleRow=function(e,t,o){for(var n=this._sheet;e>t;)if(e--,n.getRowVisible(e,o))return e;return e},x.prototype._getPreVisibleCol=function(e,t,o){for(var n=this._sheet;e>t;)if(e--,n.getColumnVisible(e,o))return e;return e},x.prototype._getResizeRowInfo=function(e,n,i,a,s){var l,u,c,h,p,d,f,g=o;return e.canDoResizeRows()?(this,!(l=e._getRowLayout(n.rowViewportIndex,a))||isNaN(n.row)||isNaN(n.col)||(e.getRowVisible(n.row,a)||(n.row=this._getPreVisualRow(n.row,a)),(u=l.findRow(n.row))&&(u.y+u.height-i<=s&&s<=u.y+u.height+i?(g={action:"sizeRow",index:n.row,sheetArea:a},(c=l[l.length-1].row)>=0&&(h=e._getLastVisualRow(a),g.index===h&&g.index!==c&&u.y+u.height-i/2<=s&&(g={action:this.getResizeRowAction(e,c,a),index:c,sheetArea:a}))):u.y-i<=s&&s<=u.y+i&&t.ArrayHelper.indexOf(l,u)>0&&(p=this._getPreVisibleRow(n.row,0,a),g={action:this.getResizeRowAction(e,p,a),index:p,sheetArea:a})),!g&&1===n.rowViewportIndex&&l.length>0&&(u=l[0],r(0,u.y-i)<=s&&s<=u.y+i&&(d=n.row-1,f=e._getRowLayout(n.rowViewportIndex-1,a),d>=0&&f&&!f.findRow(d)&&(g={action:this.getResizeRowAction(e,d,a),index:d,sheetArea:a})))),g&&!e.getRowResizable(g.index,a)&&(g=o),g):g},x.prototype.getResizeRowAction=function(e,t,o){var n=e.parent;return n&&1===n.resizeZeroIndicator()&&e.getRowVisible(t)&&0===e._getActualRowHeight(t,o)?"sizeHiddenRow":"sizeRow"},x.prototype._getResizeColInfo=function(e,n,i,a,s){var l,u,c,h,p,d,f,g=o;return e.canDoResizeColumns()?(this,!(l=e._getColumnLayout(n.colViewportIndex,a))||isNaN(n.col)||isNaN(n.row)||(e.getColumnVisible(n.col,a)||(n.col=this._getPreVisualCol(n.col,a)),(u=l.findCol(n.col))&&(u.x+u.width-i<=s&&s<=u.x+u.width+i?(g={action:"sizeCol",index:n.col,sheetArea:a},(c=l[l.length-1].col)>=0&&(h=e._getLastVisualColumn(a),g.index===h&&g.index!==c&&u.x+u.width-i/2<=s&&(g={action:this.getResizeColAction(e,c,a),index:c,sheetArea:a}))):u.x-i<=s&&s<=u.x+i&&t.ArrayHelper.indexOf(l,u)>0&&(p=this._getPreVisibleCol(n.col,0,a),g={action:this.getResizeColAction(e,p,a),index:p,sheetArea:a})),!g&&1===n.colViewportIndex&&l.length>0&&(u=l[0],r(0,u.x-i)<=s&&s<=u.x+i&&(d=n.col-1,f=e._getColumnLayout(n.colViewportIndex-1,a),d>=0&&f&&!f.findCol(d)&&(g={action:this.getResizeColAction(e,d,a),index:d,sheetArea:a})))),g&&!e.getColumnResizable(g.index,a)&&(g=o),g):g},x.prototype.getResizeColAction=function(e,t,o){var n=e.parent;return n&&1===n.resizeZeroIndicator()&&e.getColumnVisible(t)&&0===e._getActualColumnWidth(t,o)?"sizeHiddenCol":"sizeCol"},x.prototype.getResizingRowCol=function(e,t,n,r){var i,s,l,u,c,h=this._sheet,p=h.parent,d=o;return(!p||p._allowUserResize)&&(l=h._getSheetLayout(),e.rowViewportIndex<0&&e.colViewportIndex>=0&&h.colHeaderVisible?(d=this._getResizeColInfo(h,e,r,1,t))||(d=this._getResizeRowInfo(h,e,r,1,n)):e.rowViewportIndex>=0&&e.colViewportIndex<0&&h.rowHeaderVisible?(d=this._getResizeRowInfo(h,e,r,2,n))||(d=this._getResizeColInfo(h,e,r,2,t)):e.rowViewportIndex<0&&e.colViewportIndex<0?h._getLastVisualRow(2)===o&&a(n-l.colHeaderHeight)<=r?((u=h._getRowLayout(1))&&u.length>0&&(i=u[u.length-1].row),i>=0&&h.getRowResizable(i,2)&&(d={action:this.getResizeRowAction(h,i,2),index:i,sheetArea:2})):h._getLastVisualColumn(1)===o&&a(t-l.rowHeaderWidth)<=r&&((c=h._getColumnLayout(1))&&c.length>0&&(s=c[c.length-1].col),s>=0&&h.getColumnResizable(s,1)&&(d={action:this.getResizeColAction(h,s,1),index:s,sheetArea:1})):e.rowViewportIndex>=0&&e.colViewportIndex>=0&&(0===l.colHeaderHeight&&n<=r&&h.colHeaderVisible?(i=h.getRowCount(1)-1)>=0&&(d={action:"sizeHiddenRow",index:i,sheetArea:1}):0===l.rowHeaderWidth&&t<=r&&h.rowHeaderVisible&&((s=h.getColumnCount(2)-1)>=0&&(d={action:"sizeHiddenCol",index:s,sheetArea:2})))),d},x.prototype.getDragInfo=function(e,t,n){var r,i,a,s,u=o,c=e.rowViewportIndex,h=e.colViewportIndex;if(typeof c===l||c===o||typeof h===l||h===o||-1===(i=(r=this._sheet)._getActiveSelectedRange()).row&&-1===i.col)return u;if(c>=0&&h>=0&&1===r._selectionModel.length){if(this.inGrayArea(c,h,t,n))return u;(a=r._getRangeRect(c,h,i)).x-4<t&&t<a.x+4&&a.y<=n&&n<a.y+a.height&&(u={action:"drag",side:"left"}),u||(s=this._sheet._dragFillIndicatorRect)&&s.x<=t&&t<=s.x+s.width&&s.y<=n&&n<=s.y+s.height&&(u={action:"drag",side:"corner"}),u||a.x+a.width-4<t&&t<a.x+a.width+4&&a.y<=n&&n<a.y+a.height&&(u={action:"drag",side:"right"}),u||a.y-4<n&&n<a.y+4&&a.x<=t&&t<a.x+a.width&&(u={action:"drag",side:"top"}),u||a.y+a.height-4<n&&n<a.y+a.height+4&&a.x<=t&&t<a.x+a.width&&(u={action:"drag",side:"bottom"}),u&&(t<a.x||t>a.x+a.width||n<a.y||n>a.y+a.height)&&(u.outside=!0)}return this._sheet.canUserDragDrop()||u&&"corner"!==u.side&&(u.side=o),this._sheet.canUserDragFill()||u&&"corner"===u.side&&(u.side=o),u},x.prototype.inGrayArea=function(e,t,o,n){var r,i,a,s,l=this._sheet,u=l._getSheetLayout().viewportRect(1,1);if(1===t)if((r=l._getColumnLayout(t))&&r.length>0){if((i=r[r.length-1]).x+i.width<=o&&o<u.x+u.width)return!0}else if(u.contains(o,n))return!0;if(1===e)if((a=l._getRowLayout(e))&&a.length>0){if((s=a[a.length-1]).y+s.height<=n&&n<u.y+u.height)return!0}else if(u.contains(o,n))return!0;return!1},x.prototype.doMouseMove=function(e){var t=this._getCanvasOffset();this.doMouseMoveImp(e,e.pageX-t.left,e.pageY-t.top)},x.prototype.doMouseOut=function(e){var t,n=this._sheet,r=n._currentTarget;if(r&&r.cellTypeHitInfo){var i=r.row,a=r.col;n.getCellType(i,a,r.hitTestType).processMouseLeave(r.cellTypeHitInfo)}this.isWorking||(t={x:-1e4,y:-1e4,rowViewportIndex:o,colViewportIndex:o,row:-1,col:-1,resizeInfo:o,hitTestType:o},n._setHoverCell(t))},x.prototype._hoverShowComment=function(e){var t,o=this._sheet,n=-1,r=-1;if(e&&e.rowViewportIndex>=0&&e.colViewportIndex>=0&&(n=e.row,r=e.col),o.parent){if(n<0||r<0)return;t=o.getComment(n,r),o._commentManager&&o._commentManager.hoverShowComment(t)}},x.prototype.doMouseMoveImp=function(e,o,n){var r,i,a=this;a.mousePosition={e:e,x:o,y:n},r=a._sheet,a.isMouseDown&&(t.FocusHelper.isActiveElement(r)||t.FocusHelper.setActiveElement(r)),a.isMouseDown&&a.isWorking?a.isResizing?a.continueResizing():a.isDragDropping?a.continueDragDropping():a.isDraggingFill?a.continueDragFill():a.isFormulaRangeAppending?a.continueFormulaRangeAppending():a.isFormulaRangeMoving?a.continueFormulaRangeMoving():a.isFormulaRangeResizing?a.continueFormulaRangeResizing():a.isSelecting&&a.continueSelecting():(i=r.hitTest(o,n))&&(t.features.comment&&a._hoverShowComment(i),a.updateCanvasCursor(i),r._setHoverCell(i))},x.prototype.updateCanvasCursor=function(t){var n,r,i=this._sheet,a=i._getCanvas();if(a){if(r=!(n=i._currentTarget)||t.row!==n.row||t.col!==n.col||t.hitTestType!==n.hitTestType||t.resizeInfo&&!n.resizeInfo||!t.resizeInfo&&n.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==n.resizeInfo.action||t.dragInfo&&!n.dragInfo||!t.dragInfo&&n.dragInfo||t.dragInfo&&t.dragInfo.action!==n.dragInfo.action,n&&r&&n.cellTypeHitInfo){var s=n.row,l=n.col;(w=i.getCellType(s,l,n.hitTestType)).processMouseLeave(n.cellTypeHitInfo)}var u=t.resizeInfo,c=t.dragInfo,h=t.formulaRangeHitInfo,p=t.cellTypeHitInfo,d=i._render;if(u)a.style.cursor="sizeCol"===u.action?e.Sheets.CursorResource.ResizeCol:"sizeRow"===u.action?e.Sheets.CursorResource.ResizeRow:"sizeHiddenCol"===u.action?e.Sheets.CursorResource.ResizeHiddenCol:"sizeHiddenRow"===u.action?e.Sheets.CursorResource.ResizeHiddenRow:"default";else if(c&&"drag"===c.action)"corner"===c.side?a.style.cursor="crosshair":c.side&&(a.style.cursor="move");else if(h){h.inBorder?a.style.cursor="move":h.inTopLeft?a.style.cursor="nw-resize":h.inTopRight?a.style.cursor="ne-resize":h.inBottomLeft?a.style.cursor="sw-resize":h.inBottomRight&&(a.style.cursor="se-resize");var f=this.isFormulaRangeHoving,g=this._formulRangeHovingInfo,m=g&&g.paramRange,_=h.paramRange;this.isFormulaRangeHoving=!0,this._formulRangeHovingInfo={paramRange:_},f&&_.index===m.index||d.paintFormulaTextBox()}else{if(p){var y=t.row,C=t.col,w=i.getCellType(y,C,t.hitTestType);p.sheet=i,r&&w.processMouseEnter(p),w.processMouseMove(p)}!r&&p&&p.isReservedLocation||(a.style.cursor="default"),this.isFormulaRangeHoving&&(this.isFormulaRangeHoving=!1,this._formulRangeHovingInfo=o,d.paintFormulaTextBox())}}},x.prototype.doMouseUp=function(e){var t,o=this._sheet;return this.unhandleDocumentMouseMove(),t=this._getCanvasOffset(),!o._isMouseDownInSheet||(o._isMouseDownInSheet=!1,this.doMouseUpImp(e,e.pageX-t.left,e.pageY-t.top),!1)},x.prototype.doMouseUpImp=function(e,o,n){var r,i=this,a=i._sheet,s=t.FocusHelper.getActiveElement();if(i.isMouseDown=!1,s&&s!==a&&s.endEdit&&(s.endEdit(),s.repaint()),t.FocusHelper.setActiveElement(a),i.isResizing)i.stopResizing();else if(i.isDragDropping)i.stopDragDrop();else if(i.isDraggingFill)i.endDragFill();else if(i.isFormulaRangeAppending)i.stopFormulaRangeAppending();else if(i.isFormulaRangeMoving)i.stopFormulaRangeMoving();else if(i.isFormulaRangeResizing)i.stopFormulaRangeResizing();else if(a._currentTarget){if((r=a._currentTarget).cellTypeHitInfo){var l=r.row,u=r.col,c=a.getCellType(l,u,r.hitTestType);r.cellTypeHitInfo.sheet||(r.cellTypeHitInfo.sheet=a),c.processMouseUp(r.cellTypeHitInfo)}r.cellTypeHitInfo&&r.cellTypeHitInfo.isReservedLocation||a.triggerCellClick({sheet:a,sheetName:a._name,sheetArea:r.hitTestType,row:r.row,col:r.col})}i.stopSelecting(),i.setMetaKeyState(e)},x.prototype.startEdit=function(e){var t=this._sheet,o=t._getCanvas(),n=this._getCanvasOffset();e.shiftKey||e.ctrlKey||t._doStartEdit(o,e.pageX-n.left,e.pageY-n.top)},x.prototype.doKeyDown=function(e){var o,n,r,i,a=this._sheet;if(a){var s=a.getActiveRowIndex(),l=a.getActiveColumnIndex(),u=a.getCellType(s,l),c={isEditing:a.isEditing(),sheet:a,row:s,col:l,sheetArea:3},h={sheet:a,row:s,col:l,sheetArea:3};if(u&&u.isReservedKey(e,c))return void(a.isEditing()||u.processKeyDown(e,h));if((o=a._formulaTextBox)&&o.isReservedKey(e))return;if((n=a.parent&&a.parent._attachedFormulaTextBox)&&n.isReservedKey(e))return}if(r=!(a.isEditing()||e.ctrlKey||e.metaKey||34!==e.keyCode&&33!==e.keyCode&&37!==e.keyCode&&39!==e.keyCode&&9!==e.keyCode&&13!==e.keyCode&&38!==e.keyCode&&40!==e.keyCode),a._isTouchMode&&(a._isTouchMode=!1,a._render.refreshTouchSelectionIndicator()),i=this._keyDownImp(e),r&&i&&t.FocusHelper.isActiveElement(a)){if(this._keyPressed)return this._keyPressedCount<25&&this._keyPressedCount++,void t.util.cancelDefault(e);this._keyPressed=!0,this._keyPressedCount=1,this._repeatKeyDown(e,!0)}},x.prototype._getMouseDownResizeTooltipContent=function(){var e,o,n,r,i=this._sheet,a=i._currentTarget,s=a.resizeInfo;return"sizeRow"===s.action||"sizeHiddenRow"===s.action?(e=i._getAllRowLayout(s.sheetArea),i.getRowVisible(s)||(s.index=this._getPreVisualRow(s.index,s.sheetArea)),(o=e.findRow(s.index))||(o=e.findRow(a.row)),t._StringHelper.format(t.SR.Tip_Height,[o.height.toFixed(0)])):(n=i._getAllColumnLayout(s.sheetArea),i.getColumnVisible(s.index)||(s.index=this._getPreVisualCol(s.index,s.sheetArea)),(r=n.findCol(s.index))||(r=n.findCol(a.col)),t._StringHelper.format(t.SR.Tip_Width,[r.width.toFixed(0)]))},x.prototype._getMouseMoveResizeTooltipContent=function(e){return"sizeRow"===e.action||"sizeHiddenRow"===e.action?t._StringHelper.format(t.SR.Tip_Height,[(e.movingY-e.startY).toFixed(0)]):t._StringHelper.format(t.SR.Tip_Width,[(e.movingX-e.startX).toFixed(0)])},x.prototype._repeatKeyDown=function(e,t){var o=this;o._keyPressed&&(t||o._keyDownImp(e),o._keyPressed&&(o._repeatKeyDownTimeoutID=window.setTimeout(function(){o._repeatKeyDown(e)},500/o._keyPressedCount)))},x.prototype._startEditByKeyboard=function(e){var t,n,r=this._sheet,i=r._getCanvas();if(i){r._startEditByKeydown=!0;try{t=r.isEditing(),r._startEditImp(i,r._activeRowIndex,r._activeColIndex,o,o,!0),!t&&r.isEditing()&&(!(n=r.getCellType(r._activeRowIndex,r._activeColIndex))._triggerButtonClicked||32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||n._triggerButtonClicked(r,r._activeRowIndex,r._activeColIndex,3),n._cancelDefaultKeydown&&n._cancelDefaultKeydown(e))}finally{r._startEditByKeydown=!1}}},x.prototype._keyDownImp=function(e){var n,r,i,a=this._sheet;return this.setMetaKeyState(e),a.isEditing()||27!==e.keyCode||e.altKey||e.ctrlKey||e.shiftKey||!a._validationInputMessage||(t.GC$(a._validationInputMessage).remove(),a._validationInputMessage=o),a.isEditing()||34!==e.keyCode&&33!==e.keyCode&&35!==e.keyCode&&36!==e.keyCode&&38!==e.keyCode&&40!==e.keyCode||t.util.cancelDefault(e),a.isEditing()||37!==e.keyCode&&39!==e.keyCode||t.util.cancelDefault(e),(!t.features.tableSlicer||!a._processSlicerKeyMap(e))&&((!t.features.floatingObject||!a._processFloatingObjectsKeyMap(e))&&((!t.features.comment||!a._processCommentKeyMap(e))&&(!!a._processKeyMap(e)||(n=229===e.keyCode||0===e.keyCode,this.allowEnterEditing(e)&&!n&&((r=a._formulaTextBox)&&r.isAppending()&&r.stopAppending(),a.isEditing()||((i=t.Global.prototype.getUIElement(e.target))&&"gcAttachedFormulaTextBox"===i.getAttribute(S)||this._startEditByKeyboard(e))),!1))))},x.prototype.clearRepeatKeyDownTimeout=function(){this._keyPressed=!1,this._repeatKeyDownTimeoutID>0&&(window.clearTimeout(this._repeatKeyDownTimeoutID),this._repeatKeyDownTimeoutID=0)},x.prototype.doKeyUp=function(e){var t,o,n;if(this.clearRepeatKeyDownTimeout(),t=this._sheet){var r=t.getActiveRowIndex(),i=t.getActiveColumnIndex(),a=t.getCellType(r,i),s={isEditing:t.isEditing(),sheet:t,row:r,col:i,sheetArea:3},l={sheet:t,row:r,col:i,sheetArea:3};if(a&&a.isReservedKey(e,s))return void(t.isEditing()||a.processKeyUp(e,l));if((o=t._formulaTextBox)&&o.isReservedKey(e))return;if((n=t.parent&&t.parent._attachedFormulaTextBox)&&n.isReservedKey(e))return}this.setMetaKeyState(e)},x.prototype.doCompositionStart=function(e){this._startEditByKeyboard(e)},x.prototype.allowEnterEditing=function(e){return!(e.ctrlKey||e.altKey||e.metaKey)&&(e.keyCode>=65&&e.keyCode<=90||(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||(e.keyCode>=186&&e.keyCode<=192||(e.keyCode>=220&&e.keyCode<=222||219===e.keyCode||(e.keyCode>=106&&e.keyCode<=111||(32===e.keyCode||(61===e.keyCode||(173===e.keyCode||(229===e.keyCode||0===e.keyCode||8===e.keyCode)))))))))},x.prototype.setMetaKeyState=function(e){var o,n=this,r=n._sheet,i=t.util.isMacOS()?e.metaKey:e.ctrlKey;if(n.ctrl=i&&!e.shiftKey,n.shift=e.shiftKey&&!i,r._isNavigateInSelection=!1,9===e.keyCode&&(r._selectionModel.length>1?r._isNavigateInSelection=!0:(o=r._getActiveSelectedRange())&&r._selectionModel.length>0&&(r._isNavigateInSelection=!(r._activeRowIndex===o.row&&r._activeColIndex===o.col&&r._activeRowCount===o.rowCount&&r._activeColCount===o.colCount))),!0===n.isDragDropping){var a=r._getActiveSelectedRange(),s=n._isDragInsert,l=n._isDragCopy;n._isDragInsert=(-1===a.row||-1===a.col)&&e.shiftKey,n._isDragCopy=e.ctrlKey,(s!==n._isDragInsert||l!==n._isDragCopy)&&r._render.refreshDragDropIndicator()}n.isShiftPressed=e.shiftKey,n.isControlPressed=e.ctrlKey},x.prototype.resetMetaKeyState=function(){this.shift=!1,this.ctrl=!1,this._sheet._isNavigateInSelection=!1,this.isDragDropping=!1,this._isDragInsert=!1,this._isDragCopy=!1,this.isShiftPressed=!1,this.isControlPressed=!1},x.prototype.doMouseWheel=function(e,o,n){var r,i,a,s,l,u,c,h=this._sheet,p=!1,d=!1,f=h._slicerCollection;if(f&&f.mouseWheelSelectedSlicer(e))return!0;if(e.ctrlKey){if(h.parent&&!h.parent._allowUserZoom)return!0;var g=h._zoomFactor,m=h._zoomFactor-.05*o,_=new t.UndoRedo.ZoomUndoAction(h,m);h._doCommand(_),g!==(m=h._zoomFactor)&&h.triggerUserZooming({sheet:h,sheetName:h._name,oldZoomFactor:g,newZoomFactor:m})}else h._scrollTopRow!==(r=this._getNewTopRow(o))?(this.vScrollTo(r),h._syncVScrollbarPosition(),(a=h.parent)&&!a._scrollbarShowMax&&h._syncVScrollbarSize()):p=!0,h._scrollLeftCol!==(i=this._getNewLeftCol(n))?(this.hScrollTo(i),h._syncHScollbarPosition(),(a=h.parent)&&!a._scrollbarShowMax&&h._syncHScrollbarSize()):d=!0;return s=this._getCanvasOffset(),l=h.hitTest(e.pageX-s.left,e.pageY-s.top),t.features.comment&&this._hoverShowComment(l),(c=(u=h._currentTarget)&&u.cellTypeHitInfo)&&(c.cellRect=h.getCellRect(u.row,u.col)),this.updateCanvasCursor(l),h._setHoverCell(l),p&&d},x.prototype._getNewTopRow=function(e){var t,n,r,i=this._sheet,a=i._scrollTopRow;return i.frozenRowCount>0&&(0===i._scrollTopRow&&e>0?a=i.frozenRowCount:e<0&&i._scrollTopRow===i.frozenRowCount-e&&(a=0)),e<0?a=-1!==(t=i._getScrollableRow(a+e,!0))?t:a+e:e>0&&(a=-1!==(t=i._getScrollableRow(a+e))?t:a+e),n=i._getFirstPageTopRow(),r=i._getLastVisualScrollRow(),i.getRowCount()-i.frozenRowCount-i._frozenTrailingRowCount<=0||null===n?a=i._scrollTopRow:(a<n?a=n:a>r&&(a=r),a===o&&(a=-1)),a},x.prototype._getNewLeftCol=function(e){var t,n,r,i=this._sheet,a=i._scrollLeftCol;return i.frozenColCount>0&&(0===i._scrollLeftCol&&e>0?a=i.frozenColCount:e<0&&i._scrollLeftCol===i.frozenColCount-e&&(a=0)),e<0?a=-1!==(t=i._getScrollableColumn(a+e,!0))?t:a+e:e>0&&(a=-1!==(t=i._getScrollableColumn(a+e))?t:a+e),n=i._getFirstPageLeftColumn(),r=i._getLastVisualScrollColumn(),i.getColumnCount()-i.frozenColCount-i._frozenTrailingColCount<=0||null===n?a=i._scrollLeftCol:(a<n?a=n:a>r&&(a=r),a===o&&(a=-1)),a},x.prototype.updateEditingEditor=function(e){var o,n,r,i,a;if(e&&e.sheet?(o=e.sheet,n=e.editor,r=e.canvasOffset):n=(o=this._sheet)._editor,o.isEditing()){var s=o._activeRowIndex,l=o._activeColIndex,u=o.getCellType(s,l),c=o._getSheetLayout(),h=o.getActualStyle(s,l),p=o.getCellRect(s,l);p&&p.width>0&&p.height>0&&p.x>=c.frozenX&&p.y>=c.frozenY&&p.x+p.width<=c.frozenTrailingX+c.frozenTrailingWidth&&p.y+p.height<=c.frozenTrailingY+c.frozenTrailingHeight?(i={sheet:o,row:s,col:l,sheetArea:3,canvasOffset:r},u.updateEditor(n,h,p,i)):t.GC$(n).css({top:-1e4,left:-1e4}),(a=o._formulaTextBox)&&a.position()}},x.prototype.doVScroll=function(e){var t=this,o=t._sheet;t.scrolling=!0,t.newTop=e,t.newLeft=o._scrollLeftCol,t.scrollTimer||(t.scrollTimer=window.setInterval(function(){t._scrollView()},t.waittime))},x.prototype.doHScroll=function(e){var t=this,o=t._sheet;t.scrolling=!0,t.newLeft=e,t.newTop=o._scrollTopRow,t.scrollTimer||(t.scrollTimer=window.setInterval(function(){t._scrollView()},t.waittime))},x.prototype._scrollView=function(){this.scrolling?(this.scrolling=!1,this._updateView()):this.scrollTimer&&(window.clearInterval(this.scrollTimer),this.scrollTimer=o)},x.prototype._showScrollTooltip=function(e,t){var o,n;e?(o=t.pageY,n=t.pageX-this.VSCROLLTOOLTIP_LEFT):(o=t.pageY-this.HSCROLLTOOLTIP_TOP,n=t.pageX-this.HSCROLLTOOLTIP_LEFT),this._showTooltip(this._getScrollTooltipContent(e),n,o,!0)},x.prototype._getScrollTooltipContent=function(e){var o=this._sheet;return e?t.SR.Tip_Row+(o._scrollTopRow+1):1===o.colHeaderAutoText?t.SR.Tip_Column+(o._scrollLeftCol+1):t.SR.Tip_Column+o._indexToLetters(o._scrollLeftCol+1)},x.prototype._dataContextLoaded=function(e,t){var o,n,r,i=e.data;if(i&&i.length>0){if((n=(o=this._sheet).getDataSource())&&this.lastLoadedRowIndex===e.start)for(r=0;r<i.length;r++)n[e.start+r]=i[r];o.recalcAll(),o.repaint()}},x.prototype.getElementById=function(e,t){var n,r;if(!e)return o;for(n=e.firstChild;n;){if(n.id===t||n.name===t)return n;if(r=this.getElementById(n,t))return r;n=n.nextSibling}return o},x.prototype._updateView=function(){var e,t,o=this,n=o._sheet;o.painting||(o.painting=!0,t=0,(e=n.parent)&&(t=e.showScrollTip()),o.newTop!==n._scrollTopRow?(o.vScrollTo(o.newTop),(2===t||3===t)&&o._refreshTooltip(o._getScrollTooltipContent(!0))):o.newLeft!==n._scrollLeftCol&&(o.hScrollTo(o.newLeft),(1===t||3===t)&&o._refreshTooltip(o._getScrollTooltipContent(!1))),o.painting=!1)},x.prototype.vScrollTo=function(e){var o,n,r,i,a,s,l,u,c=this._sheet,h=c._scrollTopRow;if(e!==h&&(c._scrollTopRow=e,c.triggerTopRowChanged({sheet:c,sheetName:c._name,oldTopRow:h,newTopRow:e}),!(c._paintSuspended||c._layoutSuspended>0))){if(t.features.comment&&c._commentManager.updateCommentsLayoutWhenSheetScroll(),o=!1,t.util._useDoubleBuffer()){var p,d,f,g,m=c.getBounds(),_=c._getSheetLayout(),y=_.viewportY,C=_.viewportHeight,w=c._render,v=w._getCtx();if(e>h){if((i=c._getRowLayout(1))&&i.length>0&&(n=i.findRow(e)),n){for(r=i[s=i.length-1];r.y+r.height>y+C;)r=i[s-=1];r.row>e&&(o=!0,l=2,p=m?m.x:_.x,d=n.y,f=_.width,g=r.y+r.height-n.y-l,w.copyScreen(p,d,f,g,p,y),c.invalidateLayout(),w.paintBody(v,new t.Rect(p,y+g,f,C-g)),w.paintAdornment(v,new t.Rect(p,y,f,C)),c.parent&&c.parent._themeVersion>2007&&0===c.frozenRowCount&&w.repaintSelection())}}else{for(a=0,s=e;s<h&&a<C;s++)a+=c._getZoomRowHeight(s);a<C&&(o=!0,l=2,p=m?m.x:_.x,d=y,f=_.width,g=C-a,c.getFrozenTrailingRowCount()>0&&(g-=1),w.copyScreen(p,d,f,g,p,d+a),c.invalidateLayout(),w.paintBody(v,new t.Rect(p,d,f,a+l)),w.paintAdornment(v,new t.Rect(p,y,f,C)),c.parent&&c.parent._themeVersion>2007&&(u=c._selectionModel,(0===c.frozenRowCount||1===u.length&&u[0].row+u[0].rowCount===c.frozenRowCount&&c._scrollTopRow===c.frozenRowCount)&&w.repaintSelection()))}}o||(c.invalidateLayout(),c.repaint()),this.updateEditingEditor()}},x.prototype.hScrollTo=function(e){var o,n,r,i,a,s,l,u,c=this._sheet,h=c._scrollLeftCol;if(e!==h&&(c._scrollLeftCol=e,c.triggerLeftColumnChanged({sheet:c,sheetName:c._name,oldLeftCol:h,newLeftCol:e}),!(c._paintSuspended||c._layoutSuspended>0))){if(t.features.comment&&c._commentManager.updateCommentsLayoutWhenSheetScroll(),o=!1,t.util._useDoubleBuffer()){var p,d,f,g,m=c.getBounds(),_=c._getSheetLayout(),y=_.viewportX,C=_.viewportWidth,w=c._render,v=w._getCtx();if(e>h){if((i=c._getColumnLayout(1))&&i.length>0&&(n=i.findCol(e)),n){for(r=i[s=i.length-1];r.x+r.width>y+C;)r=i[s-=1];r.col>e&&(o=!0,l=2,p=n.x,d=m?m.y:_.y,f=r.x+r.width-n.x-l,g=_.height,w.copyScreen(p,d,f,g,y,d),c.invalidateLayout(),w.paintBody(v,new t.Rect(y+f,d,C-f,g)),w.paintAdornment(v,new t.Rect(y,d,C,g)),c.parent&&c.parent._themeVersion>2007&&0===c.frozenColCount&&w.repaintSelection())}}else{for(a=0,s=e;s<h&&a<C;s++)a+=c._getZoomColumnWidth(s);a<C&&(o=!0,l=2,p=y,d=m?m.y:_.y,f=C-a,g=_.height,c.getFrozenTrailingColumnCount()>0&&(f-=1),w.copyScreen(p,d,f,g,p+a,d),c.invalidateLayout(),w.paintBody(v,new t.Rect(p,d,a+l,g)),w.paintAdornment(v,new t.Rect(y,d,C,g)),c.parent&&c.parent._themeVersion>2007&&(u=c._selectionModel,(0===c.frozenColCount||1===u.length&&u[0].col+u[0].colCount===c.frozenColCount&&c._scrollLeftCol===c.frozenColCount)&&w.repaintSelection()))}}o||(c.invalidateLayout(),c.repaint()),this.updateEditingEditor()}},x.prototype._notEqualSelecions=function(e,t){var o,n,r,i=!0;if(e.length===t.length)for(o=0;o<e.length;o++){if(n=e[o],r=t[o],n.row!==r.row||n.col!==r.col||n.rowCount!==r.rowCount||n.colCount!==r.colCount){i=!0;break}i=!1}return i},x.prototype._createFocusHolder=function(e,n,r,i){var a,s,p,d,_=this,w=_._sheet,x={sheet:w,row:n,col:r,sheetArea:3},T=w._getHost(),A=e.isImeAware(x),I=R?c:"fixed";return i&&_._destroyFocusHolder(),A&&!_._cellTypeFocusHolder&&(a=e.createEditorElement(x),_._focusHolderOldCss||(_._focusHolderOldCss={overflow:"visible",border:v,position:c}),_._focusHolderOldCss.overflow=a.style.overflow,_._focusHolderOldCss.border=a.style.border,_._focusHolderOldCss.position=a.style.position,t.GC$(a).css(u,I).css(f,C).css(g,"0px").css(m,"0px").css("width","0px").css(y,"0px").css(h,v),(w=_._sheet)._setEditorValue(e,a,n,r,w.getActualStyle(n,r)),s=e.getEditorValue(a,x),t.util.browser.safari&&(""===s||s===o||typeof s===l)&&e.setEditorValue(a," ",x),T&&T.insertBefore(a,o),_._cellTypeFocusHolder=a),_._originalFocusHolder||(a=b.createElement("div"),t.GC$(a).css(u,I).css(f,C).css(g,"0px").css(m,"0px").css("width","0px").css(y,"0px"),_._originalFocusHolder=a,p=b.createElement("textarea"),t.GC$(p).attr(S,"gcSheetFocusInput").attr("tabindex",-1).css(u,c).css(f,C).css(h,v).css("resize",v),p.value=" ",a.insertBefore(p,o),_._focusElem=p,d=b.createElement("div"),t.GC$(d).css(u,c).css(f,C).attr(S,"gcSheetFocusInput").attr("tabindex",-1),a.insertBefore(d,o),_._readonlyFocusElem=d,T&&T.insertBefore(a,o)),R&&(_._cellTypeFocusHolder&&_._setVisibleLocation(w,_._cellTypeFocusHolder),_._setVisibleLocation(w,_._originalFocusHolder)),A?_._cellTypeFocusHolder:_._focusElem},x.prototype._resetFocusHolder=function(){this._cellTypeFocusHolder&&this._focusHolderOldCss&&t.GC$(this._cellTypeFocusHolder).css(f,this._focusHolderOldCss.overflow).css(h,this._focusHolderOldCss.border).css(u,this._focusHolderOldCss.position)},x.prototype._destroyFocusHolder=function(){this._cellTypeFocusHolder&&(this._cellTypeFocusHolder.parentElement&&this._cellTypeFocusHolder.parentElement.removeChild(this._cellTypeFocusHolder),this._cellTypeFocusHolder=o)},x.prototype.setFocus=function(){t.FocusHelper.isActiveElement(this._sheet)||this._setFocusCore(!0,!0)},x.prototype.setFocusToReadonlyFocusElem=function(){var e=this._readonlyFocusElem;e&&e.focus()},x.prototype.changeFocusHolder=function(){this._setFocusCore(!0,!0)},x.prototype._clearTouchSetFocusTimeout=function(){this._touchSetFocusTimeout&&(clearTimeout(this._touchSetFocusTimeout),this._touchSetFocusTimeout=o)},x.prototype._setFocusCore=function(e,o){var n,r,i,a,s,l,u,c,h;(!t.util._isSilverlightCanvas()||t.util._isStandardCanvas())&&(0===arguments.length&&(e=!0),(n=this)._focusReleased=!1,n._clearTouchSetFocusTimeout(),r=n._sheet,i=r.getActiveRowIndex(),a=r.getActiveColumnIndex(),s=r.getCellType(i,a),n._createFocusHolder(s,i,a,o),l={sheet:r,row:i,col:a,sheetArea:3},u=s.isImeAware(l)?n._cellTypeFocusHolder:n._focusElem,o&&!t.util.browser.msie&&s.setImeMode(u,r.getActualStyle(i,a).imeMode,l),b.body.focus(),c=function(){var e=function(){try{s.isImeAware(l)?(s.focus(u,l),s.selectAll(u,l)):(u.focus(),u.select())}catch(e){}};e(),o&&t.util.browser.msie&&(s.setImeMode(u,r.getActualStyle(i,a).imeMode,l),e())},!r._isTouchMode&&!t.util.device().ipad||!e&&s.isImeAware(l)?!1!==r._enhanceIme&&c():(h=t.util.device(),!r.isEditing()&&(t.util.browser.metroMode||h.ipad||h.iphone||h.android)?o&&s.setImeMode(n._cellTypeFocusHolder,r.getActualStyle(i,a).imeMode,l):n._touchSetFocusTimeout=setTimeout(function(){n._clearTouchSetFocusTimeout(),r.isEditing()||!1!==r._enhanceIme&&c()},200)),t.FocusHelper.isActiveElement(r)||t.FocusHelper.setActiveElement(r),n._updateValidationUI(r._activeRowIndex,r._activeColIndex))},x.prototype._setVisibleLocation=function(e,o){var n,r,i=e.getActiveRowIndex(),a=e.getActiveColumnIndex(),s=e.activeRowViewportIndex,l=e.activeColViewportIndex,u=e.getCellRect(i,a,s,l),c=this._getCanvasOffset(),h=this._getCanvasPosition(),p=this._cellTypeFocusHolder,d=0,f=0,_=0,C=0;if(p){var w=t.GC$(p);d=parseInt(w.css(g),10),f=parseInt(w.css(m),10);_=parseInt(w.css(y),10),C=parseInt(w.css("width"),10)}this._isInvalidRect(u)?(n=d,r=f):(n=u.y+h.top-2,r=u.x+h.left-2);var v=window.pageYOffset-c.top+h.top,S=window.innerHeight+v-_,x=window.pageXOffset-c.left+h.left,R=window.innerWidth+x-C;(isNaN(n)||n<v||n>S)&&(n=v),(isNaN(r)||r<x||r>R)&&(r=x),t.GC$(o).css(g,n).css(m,r)},x.prototype.releaseFocus=function(e){var t,o,n,r;this._clearTouchSetFocusTimeout(),this._sheet.isEditing()||this._focusReleased&&b.activeElement===this._readonlyFocusElem||(t=this._sheet,e?(o=e.row,n=e.col,e.rowViewportIndex,e.colViewportIndex):(o=t._activeRowIndex,n=t._activeColIndex,t.activeRowViewportIndex,t.activeColViewportIndex),r=t.getCellType(o,n),this._createFocusHolder(r,o,n,!1),this._readonlyFocusElem.focus(),this._focusReleased=!0)},x.prototype.resumeFocus=function(e){0===arguments.length&&(e=!0),this._focusReleased&&(this._focusReleased=!1,this._setFocusCore(e))},x.prototype._switchFocusForClipboard=function(e){this._focusElem&&(this._focusElem.value=e,this._focusElem.focus(),this._focusElem.select(),this._clipboardFloatingObjectData=o)},x.prototype._switchBackFocusAfterClipboard=function(){this._focusElem&&(this._focusElem.value=" "),this._setFocusCore(!0,!1)},x.prototype._setClipboardFloatingObjectData=function(e){this._clipboardFloatingObjectData=e},x.prototype._getClipboardFloatingObjectData=function(){return this._clipboardFloatingObjectData},x.prototype._getClipboardData=function(){var e=this._focusElem?this._focusElem.value:"";return this._formatClipboardData(e)},x.prototype._formatClipboardData=function(e){var t,o,n,r=[];if(e){for('"',t=!1,o=0;o<e.length;o++)'"'===(n=e[o])?(t=!t,r.push('"')):t||"\n"!==n?r.push(n):r.push("\r\n");return r.join("")}return""},x.prototype._disposeFocusHolders=function(){var e;this._clearTouchSetFocusTimeout(),(e=this._cellTypeFocusHolder)&&(t.GC$(e).remove(),this._cellTypeFocusHolder=n),(e=this._originalFocusHolder)&&(t.GC$(e).remove(),this._focusElem=n,this._originalFocusHolder=o,this._readonlyFocusElem=o)},x.prototype.bind=function(e,o,n){t.GC$(this._getElem()).bind(e,o,n)},x.prototype.unbind=function(e,o){t.GC$(this._getElem()).unbind(e,o)},x.prototype.trigger=function(e,o){0===this._eventSuspended&&t.GC$(this._getElem()).trigger(e,o)},x.prototype._showTooltip=function(e,o,n,r){var i,a=this._sheet.parent;a&&!a._tooltip&&(i=b.createElement("div"),t.GC$(i).addClass("spread-toolTip ui-state-default ui-widget-content btn-default"),t.GC$(i).css(u,c).css("padding","0px 3px 0px 3px").css("font","normal normal normal 11pt calibri").css(p,"1px 2px 5px rgba(0,0,0,0.4)").width(w).height(w).appendTo(b.body),a._tooltip=i),this._refreshTooltip(e,o,n,r)},x.prototype._refreshTooltip=function(e,r,a,s){var l,u,c,h,p=this._sheet,d=p.parent;d&&((l=d._tooltip)&&(u=t.GC$(l),e===n||e===o||""===e?u.hide():(u.html(e),u.show()),c=this._getCanvasOffset(),s&&(a-=c.top,r-=c.left),h=p.getBounds(),a=i(a,h.y+h.height-u.outerHeight()),r=i(r,h.x+h.width-u.outerWidth()),a!==o&&a!==n&&u.css(g,a+c.top),r!==o&&r!==n&&u.css(m,r+c.left)))},x.prototype._removeTooltip=function(){var e=this._sheet.parent;e&&e._tooltip&&(t.GC$(e._tooltip).remove(),e._tooltip=o)},x}();t._SheetEventHandler=T,function(){}()}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){var o,n,r,i,a;t.feature("core.sheet_border",["core.common"]);var s,l,u=void 0,c=null,h=Math.sqrt,p=Math.pow,d=Math.min,f=1,g=2,m=function(){function e(){}return e.prototype.adjust=function(e){0===e.orientation?(e.offsetEnd&&(this._x2+=e.offsetEnd),e.offsetStart&&(this._x1+=e.offsetStart)):(e.offsetEnd&&(this._y2+=e.offsetEnd),e.offsetStart&&(this._y1+=e.offsetStart))},e.prototype.paint=function(e){var t=this._color||"#9eb6ce",o=this._lineWidth,n=e.lineWidth,r=e.strokeStyle;e.beginPath(),(n!==o||r!==t)&&(n!==o&&(e.lineWidth=o),r!==t&&(e.strokeStyle=t)),this.paintLine(e),e.stroke()},e.prototype.paintLine=function(e){e.moveTo(this._x1,this._y1),e.lineTo(this._x2,this._y2)},e.Create=function(e,t,a,s,l,h){switch((h===u||h===c)&&(h=1),h){case 1:return new o(e,t,a,s,l,1);case 2:return new o(e,t,a,s,l,2);case 5:return new o(e,t,a,s,l,3);case 3:return new n(e,t,a,s,l,1,[3,1]);case 9:return new n(e,t,a,s,l,1,[8,2,2,2]);case 4:return new n(e,t,a,s,l,1,[2,2]);case 11:return new n(e,t,a,s,l,1,[9,3,3,3,3,3]);case 13:return new r(e,t,a,s,l,e!==a,[11,1,5,1],[10,2,4,2]);case 10:return new n(e,t,a,s,l,2,[9,3,3,3]);case 12:return new n(e,t,a,s,l,2,[9,3,3,3,3,3]);case 8:return new n(e,t,a,s,l,2,[9,3]);case 7:return new n(e,t,a,s,l,1,[1]);case 6:return new i(e,t,a,s,l,e!==a)}return c},e}();t.Line=m,o=function(e){function t(t,o,n,r,i,a){e.call(this),a%2||(t!==n?(o-=.5,r-=.5):(t-=.5,n-=.5)),this._x1=t,this._y1=o,this._x2=n,this._y2=r,this._color=i,this._lineWidth=a}return __extends(t,e),t}(m),t.SolidLine=o,n=function(e){function t(t,o,n,r,i,a,s){e.call(this),a%2||(t!==n?(o-=.5,r-=.5):(t-=.5,n-=.5)),this._x1=t,this._y1=o,this._x2=n,this._y2=r,this._color=i,this._lineWidth=a,this._pattern=s}return __extends(t,e),t.prototype.paintLine=function(e){t.render(e,this._x1,this._y1,this._x2,this._y2,this._pattern)},t.render=function(e,t,o,n,r,i){var a,s,l=h(p(n-t,2)+p(r-o,2)),u=(n-t)/l,c=(r-o)/l,f=0,g=0;for(i=i&&i.length?i:[4,4];f<l;)f+=a=d(i[g++%i.length],l-f),(s=g%2)&&e.moveTo(t,o),t+=a*u,o+=a*c,s&&e.lineTo(t,o)},t}(m),t.DashedLine=n,r=function(e){function t(t,o,n,r,i,a,s,l){e.call(this),a?(t-=1,n-=1):(o-=1,r-=1);this._x1=t,this._y1=o,this._x2=n,this._y2=r,this._color=i,this._horizental=a,this._lineWidth=1,this._pattern1=s,this._pattern2=l}return __extends(t,e),t.prototype.paintLine=function(e){var t=this,o=t._horizental?0:1,r=t._horizental?1:0;n.render(e,t._x1-o,t._y1-r,t._x2-o,t._y2-r,t._pattern1),n.render(e,t._x1,t._y1,t._x2,t._y2,t._pattern2)},t}(m),t.SlantedLine=r,i=function(e){function t(t,n,r,i,a,s){e.call(this);var l=s?0:1,u=s?1:0;this._line1=new o(t-l,n-u,r-l,i-u,a,1),this._line2=new o(t+l,n+u,r+l,i+u,a,1),this._color=a,this._horizental=s,this._lineWidth=1}return __extends(t,e),t.prototype.paintLine=function(e){this._line1.paintLine(e),this._line2.paintLine(e)},t.prototype.adjust=function(e){e.lineSide?e.lineSide===f?this._line1.adjust(e):e.lineSide===g&&this._line2.adjust(e):(this._line1.adjust(e),this._line2.adjust(e))},t}(m),t.DoubleLine=i,(s=t._LineType||(t._LineType={}))[s.previous=-1]="previous",s[s.next=1]="next",t._LineType,(l=t._LineOrientation||(t._LineOrientation={}))[l.horizontal=0]="horizontal",l[l.vertical=1]="vertical";t._LineOrientation;var _=function(){function e(){}return e.compareColor=function(e,t){return 0},e.compareLineStyle=function(t,o){if(!t)return o?-1:0;if(!o)return 1;var n=e._styleWeightCache;return n[t.style]-n[o.style]},e.getDrawingThickness=function(e){if(e){if(e.isGridLine)return 1;if(e.style)return t.LineBorder.prototype.width(e.style)}return 0},e.isDoubleLine=function(e){return e&&6===e.style},e.isSlantedLine=function(e){return e&&13===e.style},e.getMaxLine=function(t,o){return t?o?e.compareLineStyle(t.style,o.style)>=0?t:o:t:o},e.adjustLine=function(e,t){e&&e.line&&e.line.adjust(t)},e.compareLine=function(t,o){return t===o?0:t?o?t.isGridLine?o.isGridLine?0:-1:o.isGridLine?1:e.compareLineStyle(t.style,o.style):1:-1},e.isDoubleLineItem=function(e){return e&&e.style&&6===e.style.style},e.isAllowExtend=function(e,t,o,n){if(e.style&&6===e.style.style)return!0;var r=0;return r+=t&&t.style&&6===t.style.style?1:0,r+=o&&o.style&&6===o.style.style?1:0,(r+=n&&n.style&&6===n.style.style?1:0)<2},e.layout4CrossRoad=function(e,t,o,n,r,i){var a={orientation:i?1:0,offsetStart:0,offsetEnd:0},s=this.compareLine(e,o),l=this.compareLine(e,n);s>=0&&l>=0?0===s&&0===l?-1!==r&&1===r&&(a.offsetEnd-=r):-1===r?a.offsetStart-=r:1===r&&(a.offsetEnd-=2*r):l>=0?(a.lineSide=g,a.offsetStart+=r):s>=0&&(a.lineSide=f,a.offsetStart+=r),this.adjustLine(e,a)},e.layout4TurnRoad=function(t,o,n,r,i,a,s,l,u){var c,h,p,d,m,_={orientation:l?1:0,lineSide:u?g:f,offsetStart:0,offsetEnd:0},y={orientation:l?1:0,lineSide:u?f:g,offsetStart:0,offsetEnd:0},C=1===a?r:i,w=1===s?n:o;this.isDoubleLineItem(w)?0===(c=this.compareLine(t,C))?0===(h=this.compareLine(t,w))?1===s&&(y.offsetEnd-=s):h>0&&(-1===s?y.offsetStart-=2*s:1===s&&(y.offsetEnd-=2*s)):c>0?0===(p=this.compareLine(t,w))?1===s&&(y.offsetEnd-=s):p>0&&(-1===s?y.offsetStart-=2*s:1===s&&(y.offsetEnd-=2*s)):0===(d=this.compareLine(t,w))?-1===s?_.offsetStart+=2*s:1===s&&(_.offsetEnd+=2*s):d>0&&(-1===s?_.offsetStart-=3*s:1===s&&(_.offsetEnd-=3*s)):this.compareLine(t,C)>=0?-1===s?y.offsetStart-=2*s:1===s&&(y.offsetEnd-=2*s):-1===s?_.offsetStart+=2*s:1===s&&(_.offsetEnd+=2*s);var v=1===(1===a?2:1)?r:i,S=!1,x=0;!S&&this.isDoubleLineItem(v)&&this.compareLine(v,t)>0&&(S=!0,m=e.getDrawingThickness(v),this.compareLine(v,C)>0?m>0&&(x=1===s&&this.isDoubleLineItem(n)?m>=2?2:1:-1===s&&this.isDoubleLineItem(o)?m>=3?2:1:3===m?3:2):x=3===m?3:2),S||this.isDoubleLineItem(w)||(!w||w.isGridLine)&&(!v||v.isGridLine)||(S=!0,x=-1===s?2:1),S&&(-1===s?(_.offsetStart+=s*x,y.offsetStart+=s*x):1===s&&(_.offsetEnd+=s*x,y.offsetEnd+=s*x)),(_.offsetStart||_.offsetEnd)&&this.adjustLine(t,_),(y.offsetStart||y.offsetEnd)&&this.adjustLine(t,y)},e.layout4TRoad=function(e,t,o,n,r,i){if(this.compareLine(e,o)>=0&&this.compareLine(e,n)>=0){var a={orientation:i?1:0,offsetStart:0,offsetEnd:0};-1===r?(a.offsetStart-=2*r,this.isDoubleLineItem(e)&&this.compareLine(t,e)>0&&(a.offsetStart-=1)):1===r&&(a.offsetEnd-=2*r,this.isDoubleLineItem(e)&&this.compareLine(t,e)>0&&(a.offsetEnd+=1)),this.adjustLine(e,a)}},e.layout4Connected=function(t,o,n,r,i,a){var s,l,u;this.isDoubleLineItem(t)&&((s=this.getMaxLine(n,r))&&!s.isGridLine&&((l=e.getDrawingThickness(s))>0&&(u={orientation:a?1:0,offsetStart:0,offsetEnd:0},-1===i?u.offsetStart+=l*i:u.offsetEnd+=l*i,(u.offsetStart||u.offsetEnd)&&this.adjustLine(t,u))))},e.calcLayoutHorizontal=function(t,o,n,r,i,a,s){var l,u,c,h,p=e;(o||n||r)&&(c=p.getMaxLine(n,r),p.isAllowExtend(t,o,n,r)?(u=p.compareLine(c,t))>0?(l=p.getDrawingThickness(c),p.isDoubleLineItem(t)&&(p.isDoubleLineItem(n)||p.isDoubleLineItem(r)||p.isDoubleLineItem(o))||3===l&&p.adjustLine(t,{orientation:0,offsetStart:1})):c&&u<0?(u=p.compareLine(t,o))>0?3===(l=p.getDrawingThickness(c))||2===l?p.adjustLine(t,{orientation:0,offsetStart:-2}):1===l&&p.adjustLine(t,{orientation:0,offsetStart:-1}):0!==u&&p.compareLine(o,c)>0&&(3===(l=p.getDrawingThickness(c))&&p.adjustLine(t,{orientation:0,offsetStart:1})):0===u&&(!o||p.compareLine(t,o)>0)&&(3===(l=p.getDrawingThickness(c))||2===l?p.adjustLine(t,{orientation:0,offsetStart:-2}):1===l&&p.adjustLine(t,{orientation:0,offsetStart:-1})):p.adjustLine(t,{orientation:0,offsetStart:1})),(i||a||s)&&(h=p.getMaxLine(a,s),p.isAllowExtend(t,i,a,s)?(u=p.compareLine(h,t))>0?(l=p.getDrawingThickness(h),p.isDoubleLineItem(t)&&(p.isDoubleLineItem(a)||p.isDoubleLineItem(s)||p.isDoubleLineItem(i))||(3===l?p.adjustLine(t,{orientation:0,offsetEnd:-2}):(2===l||1===l)&&p.adjustLine(t,{orientation:0,offsetEnd:-1}))):u<0?(u=p.compareLine(t,i))>0?3===(l=p.getDrawingThickness(h))&&p.adjustLine(t,{orientation:0,offsetEnd:1}):0!==u&&p.adjustLine(t,{orientation:0,offsetEnd:-1}):0===u&&((u=p.compareLine(t,i))>0?3===(l=p.getDrawingThickness(h))&&p.adjustLine(t,{orientation:0,offsetEnd:1}):0!==u&&p.adjustLine(t,{orientation:0,offsetEnd:-1})):p.adjustLine(t,{orientation:0,offsetEnd:-2}))},e.calcLayoutVertical=function(t,o,n,r,i,a,s){var l,u,h,p,d=e;(o||n||r)&&(h=d.getMaxLine(n,r),d.isAllowExtend(t,o,n,r)?(u=d.compareLine(h,t))>0?(l=d.getDrawingThickness(h),d.isDoubleLineItem(t)&&(d.isDoubleLineItem(n)||d.isDoubleLineItem(r)||d.isDoubleLineItem(o))||3===l&&d.adjustLine(t,{orientation:1,offsetStart:1})):u<0?(u=d.compareLine(t,o))>0?3===(l=d.getDrawingThickness(h))||2===l?d.adjustLine(t,{orientation:1,offsetStart:-2}):1===l&&d.adjustLine(t,{orientation:1,offsetStart:-1}):0!==u&&d.compareLine(o,h)>0&&(3===(l=d.getDrawingThickness(h))&&d.adjustLine(t,{orientation:1,offsetStart:1})):0===u&&d.compareLine(t,o)>0&&(3===(l=d.getDrawingThickness(h))||2===l?d.adjustLine(t,{orientation:1,offsetStart:-2}):1===l&&d.adjustLine(t,{orientation:1,offsetStart:-1})):d.adjustLine(t,{orientation:1,offsetStart:1})),(i||a||s)&&(p=d.getMaxLine(a,s),d.isAllowExtend(t,i,a,s)?(u=d.compareLine(t,p))<0?(l=d.getDrawingThickness(p),d.isDoubleLineItem(t)&&(d.isDoubleLineItem(a)||d.isDoubleLineItem(s)||d.isDoubleLineItem(i))||(3===l||2===l?d.adjustLine(t,{orientation:1,offsetEnd:-2}):1===l&&d.adjustLine(t,{orientation:1,offsetEnd:-1}))):p!==c&&u>0?(u=d.compareLine(t,i))>0?3===(l=d.getDrawingThickness(p))&&d.adjustLine(t,{orientation:1,offsetEnd:1}):0!==u&&d.adjustLine(t,{orientation:1,offsetEnd:-1}):0===u&&((u=d.compareLine(t,i))>0?3===(l=d.getDrawingThickness(p))&&d.adjustLine(t,{orientation:1,offsetEnd:1}):0!==u&&d.adjustLine(t,{orientation:1,offsetEnd:-1})):d.adjustLine(t,{orientation:1,offsetEnd:-2}))},e.calcDoubleLayout=function(t,o,n,r,i,a,s,l){var u,c=e;l?this.calcLayoutVertical(t,o,n,r,i,a,s):this.calcLayoutHorizontal(t,o,n,r,i,a,s);var h=c.isDoubleLineItem(n),p=c.isDoubleLineItem(r),d=c.isDoubleLineItem(o);h&&p&&d?c.layout4CrossRoad(t,o,n,r,-1,l):h&&!p?c.layout4TurnRoad(t,o,i,n,r,1,-1,l,!0):!h&&p?c.layout4TurnRoad(t,o,i,n,r,2,-1,l,!1):h&&p&&!d?c.layout4TRoad(t,o,n,r,-1,l):d&&c.layout4Connected(t,o,n,r,-1,l),h=c.isDoubleLineItem(a),p=c.isDoubleLineItem(s),u=c.isDoubleLineItem(i),h&&p&&u?c.layout4CrossRoad(t,i,a,s,1,l):h&&!p?c.layout4TurnRoad(t,o,i,a,s,1,1,l,!0):!h&&p?c.layout4TurnRoad(t,o,i,a,s,2,1,l,!1):h&&p&&!u?c.layout4TRoad(t,i,a,s,1,l):u&&c.layout4Connected(t,i,a,s,1,l)},e._styleWeightCache=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],e}(),y=function(e,t,o,n,r,i,a){_.calcLayoutHorizontal(e,t,o,n,r,i,a)},C=function(e,t,o,n,r,i,a){_.calcLayoutVertical(e,t,o,n,r,i,a)},w=function(e,t,o,n,r,i,a){_.calcDoubleLayout(e,t,o,n,r,i,a,!1)},v=function(e,t,o,n,r,i,a){_.calcDoubleLayout(e,t,o,n,r,i,a,!0)},S=function(e,t,o,n,r,i,a){},x=function(e,t,o,n,r,i,a){},R=function(){function e(e,t,o,n,r){this._row=e,this._column=t,this._horPoints=[],this._verPoints=[],this._lines={}}return e.prototype._addLine=function(e,t,o,n,r){var i,a,s,l,u;if(0!==n&&0!==r)throw"invalid argument.";if((i=this._lines[e])||(i=this._lines[e]={hori:[],vert:[]}),0===n)var c=t,h=o,p=o+r,d=i.hori;else c=o,h=t,p=t+n,d=i.vert;if(a=d[c])for(s=a.length-1;s>=0;s--){if(h>(l=a[s]).e)return void a.splice(s+1,0,{s:h,e:p});if(p<l.s){if(0===s)return void a.unshift({s:h,e:p});continue}if(h>=l.s)return void a.splice(s,1,{s:l.s,e:Math.max(l.e,p)});for(u=s-1;u>=0;u++){if(a[u].e<h)return void a.splice(u+1,s-u,{s:h,e:Math.max(l.e,p)});if(a[u].s>h){if(0===u)return void a.splice(0,s,{s:h,e:Math.max(l.e,p)});continue}return void a.splice(u,s-u+1,{s:a[u].s,e:Math.max(l.e,p)})}}else a=d[c]=[{s:h,e:p}]},e.prototype._getStyle=function(t){return 0===t.style?null:e._lineStyleCache[t.style]+t.color},e.prototype.addCellLines=function(e,t,o,n,r,i,a,s){var l,u,c,h;if(a){var p=this,d=1,f=1,g=p._horPoints,m=p._verPoints;if(s){if(e!==s.row||t!==s.col)return;e=s.row,t=s.col,d=s.rowCount,f=s.colCount,g[e]=s.y,g[e+d]=s.y+s.height,m[t]=s.x,m[t+f]=s.x+s.width}else g[e]=n,g[e+1]=n+i,m[t]=o,m[t+1]=o+r;(l=a.borderLeft)&&l.style&&p._addLine(p._getStyle(l),e,t,d,0),(u=a.borderRight)&&u.style&&p._addLine(p._getStyle(u),e,t+f,d,0),(c=a.borderTop)&&c.style&&p._addLine(p._getStyle(c),e,t,0,f),(h=a.borderBottom)&&h.style&&p._addLine(p._getStyle(h),e+d,t,0,f)}},e.prototype.addCellOverlfowLayout=function(e,t){for(var o=t.startColumn;o<=t.endColumn;o++)this._removeAllVertLine(e,o)},e.prototype._removeAllVertLine=function(e,t){for(var o in this._lines)this._removeLine(this._lines[o].vert,t,e,1)},e.prototype._removeLine=function(e,t,o,n){var r,i,a,s,l=o+n,u=e[t];if(u)for(r=u.length-1;r>=0;r--)(i=u[r]).e>o&&i.s<l&&(a=[],i.s<o&&a.push({s:i.s,e:o}),i.e>=l&&a.push({s:l,e:i.e}),s=[r,1].concat(a),Array.prototype.splice.apply(u,s))},e.prototype.paint=function(e,t){for(var o,n,r,i,a,s=(s=Object.getOwnPropertyNames(this._lines)).sort(),l=0;l<s.length;l++){var u=this._lines[s[l]],c=s[l].split("-"),h=parseInt(c[0]);for(e.beginPath(),e.strokeStyle=c[1],e.lineWidth=h,l=0;l<u.hori.length;l++)if(o=u.hori[l]){if("number"!=typeof(n=this._horPoints[l]))continue;for(r=0;r<o.length;r++)a=o[r],e.moveTo(this._verPoints[a.s],n-.5),e.lineTo(this._verPoints[a.e],n-.5)}for(l=0;l<u.vert.length;l++)if(o=u.vert[l]){if("number"!=typeof(i=this._verPoints[l]))continue;for(r=0;r<o.length;r++)a=o[r],e.moveTo(i-.5,this._horPoints[a.s]),e.lineTo(i-.5,this._horPoints[a.e])}e.stroke()}},e._lineStyleCache=["","1-","2-","1-","1-","3-","3-","1-","2-","1-","2-","1-","2-","2-"],e}();t._FastBorders=R,a=function(){function t(e,t,o,n){this._isInitialized=!1,this._isMerged=!1;this._sheet=e,this._sheetArea=n,this._rowViewportIndex=t,this._colViewportIndex=o}return t.prototype._initialize=function(){var e,t,o,n,r,i,a,s,l=this;l._spanCells=[],l._rowIndecies=[],l._colIndecies=[],l._overflowedCells=[],l._adjustingRanges=[],l._hGridLine={},l._vGridLine={},l._hBorders={},l._vBorders={};var u=l._sheet,c=l._sheetArea,h=l._colViewportIndex,p=l._rowViewportIndex,d=u._getRowLayout(p,c),f=u._getColumnLayout(h,c);if(d&&d.length>0&&f&&f.length>0){for(e=l._rowIndecies,t=d.length,n=0;n<t;n++)(o=d[n]).height>0&&e.push(o.row);for(e.push(e[e.length-1]+1),r=l._colIndecies,i=f.length,s=0;s<i;s++)(a=f[s]).width>0&&r.push(a.col);r.push(r[r.length-1]+1)}l._isInitialized=!0},t.prototype.addCellOverlfowLayout=function(e,t){if(t){var o={row:e,startCol:t.startColumn,endCol:t.endColumn};this._overflowedCells.push(o)}},t.prototype.addCellLines=function(e,t,o,n,r,i,a,s){var l,u,c,h,p;this._isInitialized||this._initialize(),s?this._spanCells.push(s):(a&&(l=a.borderLeft,u=a.borderTop,c=a.borderRight,h=a.borderBottom,p=a.backColor),!p||l||c||u||h||this._adjustingRanges.push({r:e,c:t,rc:1,cc:1}),this._addCellLineImp(e,t,o,n,r,i,l,u,c,h,p))},t.prototype._addCellLineImp=function(e,t,o,n,r,i,a,s,l,c,h,p,d){var f,g,m,_=this,y=!1,C=!1,w=!1,v=!1;s&&(y=_._addCellLineSide(e,t,o,n-.5,o+r,n-.5,s,_._hBorders)),a&&(C=_._addCellLineSide(e,t,o-.5,n,o-.5,n+i,a,_._vBorders)),c&&(w=_._addCellLineSide(e+1,t,o,n+i-.5,o+r,n+i-.5,c,_._hBorders)),l&&(v=_._addCellLineSide(e,t+1,o+r-.5,n,o+r-.5,n+i,l,_._vBorders)),f=_._sheet,h&&0!==f._cachePool.getZoomRowHeight(e)&&0!==f._cachePool.getZoomColWidth(t)||(m=!v&&!d,((g=!w&&!p)||m)&&_._addGridLine(e,t,o,n,r,i,g,m)),(y||h!==u)&&_._removeLineItem(e-1,t,_._hGridLine),(C||h!==u)&&_._removeLineItem(e,t-1,_._vGridLine),!h||a||l||s||c||(_._adjustLineItem(e-1,t-1,_._vGridLine,!1),_._adjustLineItem(e-1,t-1,_._hGridLine,!0))},t.prototype._addCellLineSide=function(e,t,o,n,r,i,a,s){if(a){var l=this._queryLineItem(e,t,s,!0);return l?6!==l.style.style&&(6===a.style||_.compareLineStyle(a,l.style)>0)&&(l.line=m.Create(o,n,r,i,a.color,a.style),l.style=a):((l=this._queryLineItem(e,t,s)).line=m.Create(o,n,r,i,a.color,a.style),l.style=a),l.line!==c}return!1},t.prototype._addGridLine=function(t,o,n,r,i,a,s,l){var u,c,h,p=e.Sheets,d=3===this._sheetArea,f=this._sheet.gridline,g=p.Line;d&&f&&(u=f.color,s&&(f.showHorizontalGridline||!d)&&((c=this._queryLineItem(t,o,this._hGridLine)).isGridLine=!0,c.line=g.Create(n,r+a-.5,n+i,r+a-.5,u)),l&&(f.showVerticalGridline||!d)&&((h=this._queryLineItem(t,o,this._vGridLine)).isGridLine=!0,h.line=g.Create(n+i-.5,r,n+i-.5,r+a,u)))},t.prototype._adjustLineItem=function(e,t,o,n){var r,i=this._queryLineItem(e,t,o,!0);i&&((r=i)&&r.line&&r.line.adjust({orientation:n?0:1,offsetEnd:-1}))},t.prototype._removeLineItem=function(e,t,o){var n;e>=0&&t>=0&&((n=o[e])&&(n[t]&&delete n[t]))},t.prototype._queryLineItem=function(e,t,o,n){var r,i;if(-1===e||-1===t)return null;if(!(r=o[e])){if(n)return null;o[e]=r={}}if(!(i=r[t])){if(n)return null;r[t]=i={}}return i},t.prototype._processOverflowCells=function(){for(var e,t=this._overflowedCells,o=t.length,n=this._vBorders,r=this._vGridLine,i=0;i<o;i++){var a=t[i],s=a.row,l=a.startCol,u=a.endCol;for(e=l;e<u;e++)this._queryLineItem(s,e+1,n,!0)?this._removeLineItem(s,e+1,n):this._queryLineItem(s,e,r,!0)&&this._removeLineItem(s,e,r)}},t.prototype._processSpans=function(){var e,t,o=this._spanCells,n=o.length;if(n>0)for(t=0;t<n;t++)e=o[t],this._processSpanCell(e)},t.prototype._processSpanCell=function(e){var t,o,n,r,i,a,s,l,u,h,p,d,f,g,m,_=this,y=e.row,C=e.col,w=e.x,v=e.y,S=_._sheet.getActualStyle(y,C,_._sheetArea),x=S?S.backColor:c,R=w,b=v;if(1===e.rowCount)for(a=y,l=_._sheet._getZoomRowHeight(a,_._sheetArea),i=0;i<e.colCount;i++)h=0===i,d=i===e.colCount-1,s=C+i,u=_._sheet._getZoomColumnWidth(s,_._sheetArea),(g=_._sheet.getActualStyle(a,s,_._sheetArea))?(t=g.borderLeft,o=g.borderTop,n=g.borderRight,r=g.borderBottom):t=o=n=r=c,h?_._addCellLineImp(a,s,R,b,u,l,t,o,c,r,x,!1,!0):d?_._addCellLineImp(a,s,R,b,u,l,c,o,n,r,x):_._addCellLineImp(a,s,R,b,u,l,c,o,c,r,x,!1,!0),R+=u;else if(1===e.colCount)for(s=C,u=_._sheet._getZoomColumnWidth(s,_._sheetArea),i=0;i<e.rowCount;i++)p=0===i,f=i===e.rowCount-1,a=y+i,l=_._sheet._getZoomRowHeight(a,_._sheetArea),(g=_._sheet.getActualStyle(a,s,_._sheetArea))?(t=g.borderLeft,o=g.borderTop,n=g.borderRight,r=g.borderBottom):t=o=n=r=c,p?_._addCellLineImp(a,s,R,b,u,l,t,o,n,c,x,!0,!1):f?_._addCellLineImp(a,s,R,b,u,l,t,c,n,r,x):_._addCellLineImp(a,s,R,b,u,l,t,c,n,c,x,!0,!1),b+=l;else for(i=0;i<e.rowCount;i++){for(a=y+i,p=0===i,f=i===e.rowCount-1,l=_._sheet._getZoomRowHeight(a,_._sheetArea),m=0;m<e.colCount;m++)s=C+m,h=0===m,d=m===e.colCount-1,u=_._sheet._getZoomColumnWidth(s,_._sheetArea),(g=_._sheet.getActualStyle(a,s,_._sheetArea))?(t=g.borderLeft,o=g.borderTop,n=g.borderRight,r=g.borderBottom):t=o=n=r=c,p?h?_._addCellLineImp(a,s,R,b,u,l,t,o,c,c,x,!0,!0):d?_._addCellLineImp(a,s,R,b,u,l,c,o,n,c,x,!0,!1):_._addCellLineImp(a,s,R,b,u,l,c,o,c,c,x,!0,!0):f?h?_._addCellLineImp(a,s,R,b,u,l,t,c,c,r,x,!1,!0):d?_._addCellLineImp(a,s,R,b,u,l,c,c,n,r,x):_._addCellLineImp(a,s,R,b,u,l,c,c,c,r,x,!1,!0):h?_._addCellLineImp(a,s,R,b,u,l,t,c,c,c,x,!0,!0):d&&_._addCellLineImp(a,s,R,b,u,l,c,c,n,c,x,!0,!1),R+=u;R=w,b+=l}!x||t||n||o||r||_._adjustingRanges.push({r:y,c:C,rc:e.rowCount,cc:e.colCount})},t.prototype._adjust=function(){var e,t,o=!1,n=!1;for(e in this._vBorders){o=!0;break}for(t in this._hBorders){n=!0;break}(o||n)&&this._adjustBorders(),this._adjustingRanges.length>0&&this._adjustGridlines()},t.prototype._adjustGridlines=function(){for(var e,t,o,n,r=this._adjustingRanges,i=r.length,a=0;a<i;a++){var s=r[a],l=s.r,u=s.c,c=l,h=l-1,p=u-1,d=u;for(s.rc>1&&(c+=s.rc-1),s.cc>1&&(d+=s.cc-1),e=!1,t=!1,o=0;o<i&&((n=r[o]).c===d+1&&n.r===l&&(t=!0),n.r===c+1&&n.c===u&&(e=!0),!e||!t)&&!(n.r>l+1&&n.c>u+1);o++);e||this._adjustLineItem(c,p,this._hGridLine,!0),t||this._adjustLineItem(h,d,this._vGridLine,!1)}},t.prototype._adjustBorders=function(){for(var e,t,o,n,r,i,a,s,l,u,h,p,d,f,g,m,R,b=this,T=b._rowIndecies,A=b._colIndecies,I=T.length,D=A.length,F={},M={},E=0;E<I;E++)for(t=T[E],e=0;e<D;e++)o=A[e],f=0,g=0,(m=b._queryLineItem(t,o,b._vBorders,!0))?f++:m=b._queryLineItem(t,o-1,b._vGridLine,!0),(R=b._queryLineItem(t,o,b._hBorders,!0))?g++:R=b._queryLineItem(t-1,o,b._hGridLine,!0),(m||R)&&((n=0===E?c:b._getLineItem(T[E-1],o,!0,M))&&n.line&&!n.isGridLine&&(f++,g++),(r=0===e?c:b._getLineItem(t,A[e-1],!1,F))&&r.line&&!r.isGridLine&&(f++,g++),m&&((i=b._getLineItem(t,o,!1,F))&&i.line&&!i.isGridLine&&f++,E!==I-1&&((s=b._getLineItem(T[E+1],o,!0,M))&&s.line&&!s.isGridLine&&f++),0!==e&&E!==I-1&&((l=b._getLineItem(T[E+1],A[e-1],!1,F))&&l.line&&!l.isGridLine&&f++),E!==I-1&&((u=b._getLineItem(T[E+1],o,!1,F))&&u.line&&!u.isGridLine&&f++),f>0&&(_.isDoubleLine(m.style)?v(m,n,r,i,s,l,u):_.isSlantedLine(m.style)?x(m,n,r,i,s,l,u):C(m,n,r,i,s,l,u))),R&&((a=b._getLineItem(t,o,!0,M))&&a.line&&!a.isGridLine&&g++,e!==D-1&&((h=b._getLineItem(t,A[e+1],!1,F))&&h.line&&!h.isGridLine&&g++),0!==E&&e!=D-1&&((p=b._getLineItem(T[E-1],A[e+1],!0,M))&&p.line&&!p.isGridLine&&g++),e!=D-1&&((d=b._getLineItem(t,A[e+1],!0,M))&&d.line&&!d.isGridLine&&g++),g>0&&(_.isDoubleLine(R.style)?w(R,r,n,a,h,p,d):_.isSlantedLine(R.style)?S(R,r,n,a,h,p,d):y(R,r,n,a,h,p,d))))},t.prototype._prevCol=function(e){return e<0?-1:this._colIndecies[e-1]},t.prototype._nextCol=function(e){return this._colIndecies[e+1]},t.prototype._prevRow=function(e){return e<0?-1:this._rowIndecies[e-1]},t.prototype._nextRow=function(e){return this._rowIndecies[e+1]},t.prototype._getLineItem=function(e,t,o,n){var r,i=n[e];return i||(i=n[e]={}),(r=i[t])===u&&(r=i[t]=this._getLineItemImp(e,t,o)),r},t.prototype._getLineItemImp=function(e,t,o){if(e===u||e<0||t===u||t<0)return c;var n=o?this._vBorders:this._hBorders,r=this._queryLineItem(e,t,n,!0);if(r)return r;if(n=o?this._vGridLine:this._hGridLine,o){if(--t<0)return c}else if(--e<0)return c;return(r=this._queryLineItem(e,t,n,!0))||c},t.prototype.paint=function(e,t){this._isInitialized&&(this._isMerged||(this._processSpans(),this._processOverflowCells(),this._adjust(),this._isMerged=!0),e.save(),e.beginPath(),this._paint(e,t),e.closePath(),e.stroke(),e.restore())},t.prototype._paint=function(e,t){this._paintGridLine(e),this._paintBorderLines(e)},t.prototype._paintGridLine=function(e){this._paintLines(e,this._hGridLine),this._paintLines(e,this._vGridLine)},t.prototype._paintBorderLines=function(e){this._paintLines(e,this._hBorders),this._paintLines(e,this._vBorders)},t.prototype._paintLines=function(e,t){var o,n,r,i,a;if(t)for(i in t)if(o=t[i])for(a in o)(r=(n=o[a])&&n.line)&&r.paint(e)},t}(),t._GcBorders=a}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){var t,o;e.feature("core.sheet_render",["core.common","core.sheet_border","core.sheet_action","core.sheet_model","core.imageLoader"]);var n=null,r=Math.min,i=Math.max,a=Math.abs,s=Math.PI,l="undefined",u=window.document,c=function(){function o(e){this.ctx=n,this.buffer=n,this.bufferCtx=n,this._rowGroups=n,this._columnGroups=n,this._floatingObjectRenderManager=n,this._defaultFont=n,this._existTouchDragFillIndicator=!1,this._showTouchSelectionIndicator=!0,this._init(e)}return o.prototype._init=function(e){this._sheet=e},o.prototype._getCtx=function(){var t;if(this.ctx=n,t=this._sheet._getCanvas()){if(!t.getContext&&e.util._isSilverlightCanvas()&&!t.getContext)return;t.getContext&&(this.ctx=t.getContext("2d"))}return this.ctx&&(this.ctx.name="userContext"),this.ctx},o.prototype._getBufferCtx=function(){var t=this,o=t._sheet,n=o.getBounds(),r=o._canvas.width,i=o._canvas.height,a=t.buffer;if(!a||a.width!==r||a.height!==i)if(a&&e.DPIHelper.disposeCanvasForSheet(o,a),t.buffer=a=u.createElement("canvas"),a.getContext)t.bufferCtx=a.getContext("2d"),e.DPIHelper.adjustDevicePixel(t.buffer,null,t._sheet,t.bufferCtx),e.DPIHelper.setSize(a,n.width,n.height);else if(a.width=n.width,a.height=n.height,e.util._isSilverlightCanvas()){if(!a.getContext)return;t.bufferCtx=a.getContext("2d")}return t.bufferCtx&&(t.bufferCtx.beginPath(),t.bufferCtx.font=t._getZoomFont(t._getDefaultFont()),t.bufferCtx.name="bufferContext"),t.bufferCtx},o.prototype._getDefaultFont=function(t){return this._defaultFont||(this._defaultFont=e.DefaultFontSize+" "+this._sheet.currentTheme().bodyFont()),this._defaultFont},o.prototype._resetDefaultFont=function(){this._defaultFont=n},o.prototype._getDefaultBackground=function(){return"white"},o.prototype._getSpreadBackColor=function(){var t=this._sheet,o=t.parent,r=o?o._backColor:this._getDefaultBackground(),i=e._ThemeContext.getColor(t,r),a=o?o._backgroundImage:n;return a&&""!==a&&(i="transparent"),i},o.prototype._getGrayAreaBackColor=function(t){var o,r=this._sheet,i=r.parent,a=i?i.grayAreaBackColor():"gray",s=e._ThemeContext.getColor(r,a);return t?((o=i?i._backgroundImage:n)&&""!==o&&(s="transparent"),s):s},o.prototype._getZoomFont=function(t){var o=this._sheet._zoomFactor;return 1===o?t:e.StyleHelper._scaleFont(t,o).font},o.prototype.copyDoubleBuffer=function(t,o,n,r,i){var a,s,l,u,c,h,p;n<=0||r<=0||(a=this.buffer,s=this._getCtx(),a&&s&&(i||(i=this._sheet.getBounds()),l=e.DPIHelper.getScaleX(a),u=e.DPIHelper.getScaleY(a),1!==l&&(t*=l,o*=u,n*=l,r*=u,i=new e.Rect(i.x*l,i.y*u,i.width*l,i.height*u)),c=i.getIntersect(t,o,n,r))&&(c.round(),t=c.x,o=c.y,n=c.width,r=c.height,(h=a.width)&&t+n>h&&((t=h-n)<0&&(n+=t,t=0)),(p=a.height)&&o+r>p&&((o=p-r)<0&&(r+=o,o=0)),e.util.browser.qtMode&&(t>0&&n--,o>0&&r--),1===l?(t,o,n,r):(t/l,o/u,n/l,r/u),s.scale(1/l,1/u),s.clearRect(t,o,n,r),s.drawImage(a,t,o,n,r,t,o,n,r),s.scale(l,u)))},o.prototype.copyDoubleBufferRect=function(e,t){e&&this.copyDoubleBuffer(e.x,e.y,e.width,e.height,t)},o.prototype.copyScreen=function(t,o,n,r,i,a){var s,l;if(!(n<=0||r<=0))try{var u=this._sheet,c=this._getCtx(),h=u._getCanvas(),p=this._getBufferCtx(),d=this.buffer,f=i,g=a,m=n,_=r,y=e.DPIHelper.getScaleX(h),C=e.DPIHelper.getScaleY(h);t=Math.floor(t*y),o=Math.floor(o*C),n=Math.ceil(n*y),r=Math.ceil(r*C),f=Math.floor(f*y),g=Math.floor(g*C),m=Math.ceil(m*y),_=Math.ceil(_*C),s=d.width,l=d.height,s&&t+n>s&&((t=s-n)<0&&(n+=t,t=0)),l&&o+r>l&&((o=l-r)<0&&(r+=o,o=0)),s&&f+m>s&&((f=s-m)<0&&(m+=f,f=0)),l&&g+_>l&&((g=l-_)<0&&(_+=g,g=0)),c.scale(1/y,1/C),p.scale(1/y,1/C),c.clearRect(f,g,m,_),c.drawImage(d,t,o,n,r,f,g,m,_),p.clearRect(f,g,m,_),p.drawImage(h,f,g,m,_,f,g,m,_),c.scale(y,C),p.scale(y,C)}catch(e){}},o.prototype.repaintSelection=function(t,o,n,a){var s,l,u,c,h,p,d;n||(n=this._getCtx());var f=!1,g=this._sheet,m=new e.Range(-1,-1,-1,-1),_=g._isNavigateInSelection;if(t&&(m=g._allowCellOverflow?new e.Range(t.row,0,t.rowCount,g.getColumnCount()):new e.Range(t.row,t.col,t.rowCount,t.colCount),!_)){if(m.col>=0){var y=m.col,C=m.col+m.colCount-1,w=g.getRowCount(1),v=g._getSpanModel(1);for(s=0;s<w;s++)(u=v.find(s,m.col))&&(y=r(u.col,y)),(u=v.find(s,m.col+m.colCount-1))&&(C=i(u.col+u.colCount-1,C));m.col=y,m.colCount=C-y+1}if(m.row>=0){var S=m.row,x=m.row+m.rowCount-1,R=g.getColumnCount(2);v=g._getSpanModel(2);for(l=0;l<R;l++)(u=v.find(m.row,l))&&(S=r(u.row,S)),(u=v.find(m.row+m.rowCount-1,l))&&(x=i(u.row+u.rowCount-1,x));m.row=S,m.rowCount=x-S+1}}if((c=g._getRangeRect2(m)).width>=0||c.height>=0){if(h=c.width,p=c.height,c.x-=9,c.y-=9,c.width+=18,c.height+=30,o&&!(c=c.getIntersectRect(o)))return;d=g._getSheetLayout(),p>0&&!_&&(g._dirty=!0,this.paint(n,new e.Rect(d.x,i(d.frozenY,c.y),d.rowHeaderWidth,c.height),a)),h>0&&!_&&(g._dirty=!0,this.paint(n,new e.Rect(i(d.frozenX,c.x),d.y,c.width,d.colHeaderHeight),a)),-1!==m.row||-1!==m.col||_||(g._dirty=!0,this.paint(n,d.headerCornerRect(),a)),h>0&&p>0&&this.paint(n,c),f=!0}return f},o.prototype.update=function(t,o,n,r,i){var a,s=this._sheet;s._layoutSuspended>0||(a=this._getCtx())&&(i||(s._dirty=!0),this.paint(a,new e.Rect(t,o,n,r)))},o.prototype.repaint=function(e){var t,o=this._sheet;o._layoutSuspended>0||(t=this._getCtx())&&(o._dirty=!0,this.paint(t,e))},o.prototype.paint=function(e,t,o){var n=this._sheet;!e||n._layoutSuspended>0||(o||this.paintBody(e,t),this.paintAdornment(e,t))},o.prototype.paintBody=function(t,o,n){var r=this._sheet;if(t&&!(r._layoutSuspended>0)){var i=e.util._useDoubleBuffer()?this._getBufferCtx():null,a=i||t,s=r.getBounds();o||(o=s),o&&o.round(),n&&n.round(),r._dirty&&(r._dirty=!1,i&&(i.clearRect(o.x,o.y,o.width,o.height),n&&i.clearRect(n.x,n.y,n.width,n.height),i.translate(-s.x,-s.y)),this.paintSheet(a,o),n&&this.paintSheet(a,n),i&&i.translate(s.x,s.y)),i&&(this.copyDoubleBufferRect(o),n&&this.copyDoubleBufferRect(n))}},o.prototype.paintAdornment=function(e,t){var o,n,r,i,a,s=this,l=s._sheet,u=l._isTouchMode;if(e&&!l._paintSuspended&&!(l._layoutSuspended>0)){if(t&&t.round(),o=l._getSheetLayout(),!l._hoverCell){if(u){for(n=o.headerCornerRect(),s.copyDoubleBufferRect(n),i=0;i<=2;i++)(n=o.rowHeaderRect(i))&&0!==n.width&&0!==n.height&&s.copyDoubleBufferRect(n);for(a=0;a<=2;a++)(n=o.colHeaderRect(a))&&0!==n.width&&0!==n.height&&s.copyDoubleBufferRect(n)}for(i=0;i<=2;i++)for(a=0;a<=2;a++)(n=o.viewportRect(i,a))&&0!==n.width&&0!==n.height&&(r=t,u&&(1!==i||1!==a)&&(s.copyDoubleBufferRect(n),r=n),(!r||n.intersectRect(r))&&s.paintSelection(e,i,a,r));if(s.paintResizeLine(e),l._formulaTextBox)for(i=0;i<=2;i++)for(a=0;a<=2;a++)(n=o.viewportRect(i,a))&&0!==n.width&&0!==n.height&&s.paintFormulaTextBoxRange(e,i,a,t)}u&&(s.paintTouchResizeIndicator(e),s._existTouchDragFillIndicator?s.paintTouchDragFillIndicator(e):s.paintTouchSelectionIndicator(e)),this.pri(e,t,o)}},o.prototype.pri=function(e,t,o){},o.prototype.paintTouchResizeIndicator=function(t){var o,n,r,i,a,s,l,u=this._sheet,c=u.getRowCount(),h=u.getColumnCount(),p=u._getSheetLayout(),d=u.getSelections();if(u._isTouchMode&&d.length>0){var f=d[d.length-1],g=f.row,m=f.row+f.rowCount-1,_=f.col,y=f.col+f.colCount-1;(!u.parent||u.parent._allowUserResize)&&(-1!==g&&-1===_&&u.getRowResizable(m)?(m<u.frozenRowCount?a=0:m<c-u._frozenTrailingRowCount?a=1:m<c&&(a=2),o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",n=u.getCellRect(m,u.getColumnCount(2)-1,a,-1),(i=p.rowHeaderRect(a)).y<=n.y&&n.y+n.height<=i.y+i.height&&(r=new e.Rect(p.frozenX-16,n.y+n.height-8,16,16))):-1===g&&-1!==_&&u.getColumnResizable(y)&&(y<u.frozenColCount?s=0:y<h-u._frozenTrailingColCount?s=1:y<h&&(s=2),o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0AAAAAElFTkSuQmCC",n=u.getCellRect(u.getRowCount(1)-1,y,-1,s),(i=p.colHeaderRect(s)).x<=n.x&&n.x+n.width<=i.x+i.width&&(r=new e.Rect(n.x+n.width-8,p.frozenY-16,16,16))),o&&r&&((l=u._getImageLoader()).getState(o)?t.drawImage(l.getImage(o),r.x,r.y,r.width,r.height):l.addImage(o)))}},o.prototype._getFloatingObjectRender=function(t,o){return e.features.floatingObject?(this._floatingObjectRenderManager||(this._floatingObjectRenderManager=[]),this._floatingObjectRenderManager[t]||(this._floatingObjectRenderManager[t]=[]),this._floatingObjectRenderManager[t][o]||(this._floatingObjectRenderManager[t][o]=new e._FloatingObjectRenderManager(this._sheet)),this._floatingObjectRenderManager[t][o]):n},o.prototype._getFloatingObjectRenderCount=function(){var e,t,o,n,r=this._floatingObjectRenderManager,i=0;if(!r||0===r.length)return 0;for(e=0;e<=2;e++)if((t=r[e])&&t.length>0)for(o=0;o<=2;o++)(n=t[o])&&(i+=n.getFloatingObjectRenderCount());return i},o.prototype._paintFloatingObject=function(t,o){var r,i,a,s,u=this._sheet;if(!u._hoverCell&&e.features.floatingObject&&u._floatingObjectArray&&(u._floatingObjectArray.length>0||this._getFloatingObjectRenderCount()>0))for(r=u._getSheetLayout(),(o===n||typeof o===l)&&(o=u._zoomFactor),i=0;i<=2;i++)for(a=0;a<=2;a++)r.viewportRect(i,a)&&((s=this._getFloatingObjectRender(i,a))&&!u._eventHandler.isFloatingObjectWorking&&s._render(i,a,o))},o.prototype._paintBackground=function(e,t){e.save(),e.fillStyle=this._getSpreadBackColor(),e.fillRect(t.x,t.y,t.width,t.height),e.restore()},o.prototype._paintHeadersAndViewport=function(e,t,o){for(var n,r,i,a,s,l,u=this._sheet._getSheetLayout(),c=0;c<=2;c++)(r=u.colHeaderRect(c))&&(t?(l=r.getIntersectRect(t))&&this.paintColHeader(e,c,l,o):this.paintColHeader(e,c,r,o));for(n=0;n<=2;n++)for((i=u.rowHeaderRect(n))&&(t?(l=i.getIntersectRect(t))&&this.paintRowHeader(e,n,l,o):this.paintRowHeader(e,n,i,o)),c=0;c<=2;c++)(a=u.viewportRect(n,c))&&(t?(l=a.getIntersectRect(t))&&this.paintViewport(e,n,c,l,o):this.paintViewport(e,n,c,a,o));(s=u.headerCornerRect())&&(t?(l=s.getIntersectRect(t))&&this.paintColHeaderCorner(e,l,o):this.paintColHeaderCorner(e,s,o))},o.prototype._paintGrayArea=function(e){var t,o,n,r=this._sheet,i=r._getSheetLayout(),a=r._getRowLayout(1);a.length>0?(t=a[a.length-1]).y+t.height<i.frozenTrailingY&&(e.fillStyle=this._getGrayAreaBackColor(!1),e.fillRect(i.headerX,t.y+t.height,i.width,i.frozenTrailingY-(t.y+t.height))):0===a.length&&(e.fillStyle=this._getGrayAreaBackColor(!1),e.fillRect(i.headerX,i.viewportY,i.width,i.frozenTrailingY-i.viewportY)),(o=r._getColumnLayout(1)).length>0?(n=o[o.length-1]).x+n.width<i.frozenTrailingX&&(e.fillStyle=this._getGrayAreaBackColor(!1),e.fillRect(n.x+n.width,i.headerY,i.frozenTrailingX-(n.x+n.width),i.height)):0===o.length&&(e.fillStyle=this._getGrayAreaBackColor(!1),e.fillRect(i.viewportX,i.headerY,i.frozenTrailingX-i.viewportX,i.height))},o.prototype._paintSheetBorder=function(e,t){var o=this._sheet;o.borderWidth>0&&(e.strokeStyle=o.borderColor,e.lineWidth=o.borderWidth,e.strokeRect(t.x+e.lineWidth/2,t.y+e.lineWidth/2,i(0,t.width-e.lineWidth),i(0,t.height-e.lineWidth)))},o.prototype.paintSheet=function(t,o){var n,r=this,i=r._sheet;!t||i._layoutSuspended>0||(e._CacheMgr.startCache(i,0,0,i.getRowCount()-1,i.getColumnCount()-1),n=i.getBounds(),t.save(),o?t.rect(o.x,o.y,o.width,o.height):t.rect(n.x,n.y,n.width,n.height),t.clip(),t.beginPath(),r._paintBackground(t,n),e.features.group&&r.paintGroup(t,o),e.features.floatingObject&&r._paintFloatingObject(o),e.features.comment&&i._commentManager.hasComment()&&(r._paintCommentFloatLayoutPanel(3),r._paintComment(o)),r._paintHeadersAndViewport(t,o,!1),r._paintGrayArea(t),r.paintFrozenLine(t),r._paintSheetBorder(t,n),e._CacheMgr.clearCache(),t.beginPath(),t.restore())},o.prototype.paintSheetForPrint=function(t,o){var n,r=this._sheet;t&&(e._CacheMgr.startCache(r,0,0,r.getRowCount()-1,r.getColumnCount()-1),n=r.getBounds(),t.save(),o?t.rect(o.x,o.y,o.width,o.height):t.rect(n.x,n.y,n.width,n.height),t.clip(),t.beginPath(),this._paintBackground(t,n),this._paintHeadersAndViewport(t,o,!0),e._CacheMgr.clearCache(),t.beginPath(),t.restore())},o.prototype.refreshDragDropIndicator=function(){var t,o,n=this._sheet,r=n._currentTarget;if(r&&r.dragInfo){var i=this._getCtx(),a=n._getSheetLayout(),s=n._actualDragRange,l=n._dragRect,u=n._getRangeRect2(s),c=n._frozenTrailingColCount,h=n._frozenTrailingRowCount,p=n.getColumnCount()-c,d=n.getRowCount()-h,f=a.viewportRect(1,1);c>0&&s.col+s.colCount<=p&&u.x+u.width>f.x+f.width&&u.intersectRect(f)&&(u=u.getIntersectRect(f)),h>0&&s.row+s.rowCount<=d&&u.y+u.height>f.y+f.height&&u.intersectRect(f)&&(u=u.getIntersectRect(f)),t=new e.Rect(a.frozenX,a.frozenY,a.frozenTrailingX+a.frozenTrailingWidth,a.frozenTrailingY+a.frozenTrailingHeight),u.width>0&&u.height>0?(l.x=u.x,l.y=u.y,l.width=u.width-1,l.height=u.height-1,this.paintDragDropIndicator(i,t)):(0===u.width||0===u.height)&&(l.x=u.x,l.y=u.y,l.width=u.width,l.height=u.height,this.paintDragDropIndicator(i,t)),o=n._eventHandler._isDragInsert,n._dragOldRect=!0===o?n._insertDragRect:new e.Rect(l.x,l.y,l.width,l.height)}},o.prototype.paintDragDropIndicator=function(t,o){var n,r,i,a,s,l,u,c,h=this,p=h._sheet,d=p._dragRect,f=p._eventHandler._isDragInsert,g=d.hitTarget;p&&d&&g&&(t.save(),!0!==f||-1!==d.row&&-1!==d.col?((n=p._dragOldRect)&&(r=new e.Rect(n.x-2,n.y-2,n.width+4,n.height+4),h.copyDoubleBufferRect(r,o),h.repaintSelection(p._getActiveSelectedRange(),o)),t.rect(o.x,o.y,o.width,o.height),t.clip(),t.beginPath(),h.paintDragRectangle(t,d)):-1===d.row&&-1!==d.col?((i=p._getColumnLayout(0).findCol(d.hitCol))||(i=p._getColumnLayout(1).findCol(d.hitCol)),i||(i=p._getColumnLayout(2).findCol(d.hitCol)),i&&(a=i.x,s=i.width,d.col=d.hitCol,g.x>a+s/2&&(d.col<p._getLastFullyVisibleColumn()||d.col===p._getLastVisualColumn())&&(a=i.x+i.width,d.col++),(n=p._dragOldRect)&&0===n.width||(n=p._dragRect),n&&(r=new e.Rect(n.x-2,n.y-2,n.width+4,n.height+4),h.copyDoubleBufferRect(r,o),h.repaintSelection(p._getActiveSelectedRange(),o)),p._insertDragRect=new e.Rect(a,d.y,0,d.height),t.rect(o.x,o.y,o.width,o.height),t.clip(),t.beginPath(),h.paintDragLine(t,a,d.y,a,d.y+d.height))):-1!==d.row&&-1===d.col&&((l=p._getRowLayout(0).findRow(d.hitRow))||(l=p._getRowLayout(1).findRow(d.hitRow)),l||(l=p._getRowLayout(2).findRow(d.hitRow)),l&&(u=l.y,c=l.height,d.row=d.hitRow,g.y>u+c/2&&(d.row<p._getLastFullyVisibleRow()||d.row===p._getLastVisualRow())&&(u=l.y+l.height,d.row++),(n=p._dragOldRect)&&0===n.height||(n=p._dragRect),n&&(r=new e.Rect(n.x-2,n.y-2,n.width+4,n.height+4),h.copyDoubleBufferRect(r,o),h.repaintSelection(p._getActiveSelectedRange(),o)),p._insertDragRect=new e.Rect(d.x,u,d.width,0),t.rect(o.x,o.y,o.width,o.height),t.clip(),t.beginPath(),h.paintDragLine(t,d.x,u,d.x+d.width,u))),t.beginPath(),t.restore())},o.prototype.paintDragRectangle=function(e,t){this.paintDragLine(e,t.x,t.y,t.x+t.width,t.y),this.paintDragLine(e,t.x,t.y+t.height,t.x+t.width,t.y+t.height),this.paintDragLine(e,t.x,t.y,t.x,t.y+t.height),this.paintDragLine(e,t.x+t.width,t.y,t.x+t.width,t.y+t.height),this.pri(e,n,n)},o.prototype.paintDragLine=function(t,o,n,r,i){var s,l,u;t.save(),o===r?(t.rect(o-2,n,7,a(i-n)),t.clip(),t.beginPath(),n<i?(n-=3,i+=3):(n+=3,i-=3),s=e.Line.Create(o-1,n-1,r-1,i+1,"black",7),l=e.Line.Create(o,n,r,i,"black",7),u=e.Line.Create(o+1,n-1,r+1,i+1,"black",7)):n===i&&(t.rect(o,n-2,a(r-o),7),t.clip(),t.beginPath(),o<r?(o-=3,r+=3):(o+=3,r-=3),s=e.Line.Create(o-1,n-1,r+1,i-1,"black",7),l=e.Line.Create(o,n,r,i,"black",7),u=e.Line.Create(o-1,n+1,r+1,i+1,"black",7)),s.paintLine(t),l.paintLine(t),u.paintLine(t),t.stroke(),t.beginPath(),t.restore()},o.prototype.paintResizeLine=function(e){var t,o,n,r,a,s,l,u,c,h=this._sheet;if(h._eventHandler.isResizing&&(l=h._currentTarget)&&(u=l.resizeInfo)){if(c=h._getSheetLayout(),"#000000",e.save(),"#000000"!==e.strokeStyle&&(e.strokeStyle="#000000"),1!==e.lineWidth&&(e.lineWidth=1),e.beginPath(),"sizeRow"===u.action||"sizeHiddenRow"===u.action)for(o=i(0,u.startY-.5),r=u.movingY-.5,a=c.x+c.width,t=c.x;t<a;t+=2)e.moveTo(t,o),e.lineTo(t+1,o),e.moveTo(t,r),e.lineTo(t+1,r);else for(t=i(0,u.startX-.5),n=u.movingX-.5,s=c.y+c.height,o=c.y;o<s;o+=2)e.moveTo(t,o),e.lineTo(t,o+1),e.moveTo(n,o),e.lineTo(n,o+1);e.stroke(),e.beginPath(),e.restore()}},o.prototype.paintColHeaderCorner=function(t,o,r){var i,a,s,l=this._sheet;t.beginPath(),i=l._getSheetLayout().headerCornerRect(),a=l.getActualStyle(-1,-1,0),this.paintCells(t,[{data:n,row:-1,col:-1,x:i.x,y:i.y,width:i.width,height:i.height,style:a.clone()}],0,r),(s=new e._GcBorders(l,0,0,0)).addCellLines(0,0,i.x,i.y,i.width,i.height),s.paint(t,o)},o.prototype.paintFrozenLine=function(t){var o,n=this._sheet;(n.frozenRowCount||n.frozenColCount||n._frozenTrailingRowCount||n._frozenTrailingColCount)&&(o=n._getSheetLayout(),t.save(),t.strokeStyle=e._ThemeContext.getColor(n,n._frozenlineColor),t.lineWidth=1,t.beginPath(),n.frozenColCount&&(t.moveTo(o.viewportX-.5,o.y),t.lineTo(o.viewportX-.5,o.y+o.height)),n.frozenRowCount&&(t.moveTo(o.x,o.viewportY-.5),t.lineTo(o.x+o.width,o.viewportY-.5)),n._frozenTrailingColCount&&(t.moveTo(o.frozenTrailingX-.5,o.y),t.lineTo(o.frozenTrailingX-.5,o.y+o.height)),n._frozenTrailingRowCount&&(t.moveTo(o.x,o.frozenTrailingY-.5),t.lineTo(o.x+o.width,o.frozenTrailingY-.5)),t.stroke(),t.restore())},o.prototype.paintColHeader=function(e,t,o,n){this.paintViewportImp(e,-1,t,1,o,n)},o.prototype.paintRowHeader=function(e,t,o,n){this.paintViewportImp(e,t,-1,2,o,n)},o.prototype.paintViewport=function(e,t,o,n,r){this.paintViewportImp(e,t,o,3,n,r);var i=this._sheet._cutCopyIndicatorManager;i&&i.paintCutCopyIndicator(e,n,t,o)},o.prototype.getTouchDragFillIndicatorRect=function(){var t=this._sheet,o=n,r=t.getSelections(),i=r.length;if(t._isTouchMode&&i>0){var a=r[i-1],s=t._getRangeRect2(a);o=new e.Rect(s.x+s.width-17,s.y+s.height,17,20)}return o},o.prototype.getCurrentViewportRange=function(t,o){var n,r=this._sheet,i=r.getRowCount(),a=r.getColumnCount(),s=1;0<=t&&t<r.frozenRowCount?s=0:i>t&&t>=i-r._frozenTrailingRowCount&&(s=2),n=1,0<=o&&o<r.frozenColCount?n=0:a>o&&o>=a-r._frozenTrailingColCount&&(n=2);var l=r._getViewportRowLayout(s),u=r._getViewportColumnLayout(n),c=0,h=0,p=0,d=0;return l.length>0&&(c=l[0].row,h=l[l.length-1].row),u.length>0&&(p=u[0].col,d=u[u.length-1].col),new e.Range(c,p,h-c+1,d-p+1)},o.prototype.isContainedByCurrentViewport=function(e,t){var o,n=this._sheet,r=n.getRowCount(),i=n.getColumnCount(),a=1;0<=e&&e<n.frozenRowCount?a=0:r>e&&e>=r-n._frozenTrailingRowCount&&(a=2),o=1,0<=t&&t<n.frozenColCount?o=0:i>t&&t>=i-n._frozenTrailingColCount&&(o=2);var s=n._getSheetLayout().viewportRect(a,o),l=!1,u=n._getViewportColumnLayout(o),c=-1===t?u[0]:u.findCol(t);c&&(l=s.x<=c.x&&c.x+c.width<=s.x+s.width);var h=!1,p=n._getViewportRowLayout(a),d=-1===e?p[0]:p.findRow(e);return d&&(h=s.y<=d.y&&d.y+d.height<=s.y+s.height),l&&h},o.prototype.getSelectionIndicatorRects=function(){var t,o,n,r,i=this._sheet,a=i.getSelections(),s=[];if(i._isTouchMode&&a.length>0){var l,u,c=a[a.length-1],h=i._getRangeRect2(c),p=i._getSheetLayout(),d=c.row,f=c.row+c.rowCount-1,g=c.col,m=c.col+c.colCount-1,_=this.getCurrentViewportRange(d,g),y=this.getCurrentViewportRange(f,m),C=_.row,w=y.row+y.rowCount-1,v=_.col,S=y.col+y.colCount-1,x=f===w&&this.isContainedByCurrentViewport(w,-1),R=m===S&&this.isContainedByCurrentViewport(-1,S);if(-1!==c.row&&-1!==c.col)v<=g&&g<=S&&C<=d&&d<=w&&(s[0]=new e.Rect(h.x-8,h.y-8,16,16)),(v<=m&&m<S||R)&&(C<=f&&f<w||x)&&(s[1]=new e.Rect(h.x+h.width-8,h.y+h.height-8,16,16));else if(-1!==c.row){l=p.viewportRect(1,0),u=p.viewportRect(1,1);var b=l.x+(l.width+u.width)/2-8,T=i.getColumnCount()-1-i.getFrozenTrailingColumnCount(),A=i._getViewportColumnLayout(1),I=A.findCol(T);I&&((t=i._getViewportColumnLayout(0)[0]||A[0])&&(b=t.x+(I.x+I.width-t.x)/2-8)),C<=d&&d<=w&&(s[0]=new e.Rect(b,h.y-8,16,16)),(C<=f&&f<w||x)&&(s[1]=new e.Rect(b,h.y+h.height-8,16,16))}else if(-1!==c.col){l=p.viewportRect(0,1),u=p.viewportRect(1,1);var D=l.y+(l.height+u.height)/2-8,F=i.getRowCount()-1-i.getFrozenTrailingRowCount(),M=i._getViewportRowLayout(1),E=M.findRow(F);E&&((o=i._getViewportRowLayout(0)[0]||M[0])&&(D=o.y+(E.y+E.height-o.y)/2-8)),v<=g&&g<=S&&(s[0]=new e.Rect(h.x-8,D,16,16)),(v<=m&&m<S||R)&&(s[1]=new e.Rect(h.x+h.width-8,D,16,16))}for(r=s.length-1;r>=0;r--)(!(n=s[r])||n.x<0||n.y<0)&&s.splice(r,1)}return s},o.prototype.paintTouchSelectionIndicator=function(t){var o,n,r,i,a=this._sheet;if(e.FocusHelper.isActiveElement(a)||a.parent&&!a.parent.hideSelection()){if(a.isEditing()||!this._showTouchSelectionIndicator)return;if((n=(o=this.getSelectionIndicatorRects()).length)>0){for(t.save(),t.fillStyle="white",t.strokeStyle=a.selectionBorderColor(),i=0;i<n;i++)r=o[i],t.beginPath(),t.arc(r.x+r.width/2,r.y+r.height/2,r.width/2,0,2*s,!1),t.fill(),t.stroke();t.restore()}}},o.prototype.refreshTouchSelectionIndicator=function(){var e=this._sheet,t=e.getSelections();!e._paintSuspended&&t.length>0&&this.repaintSelection(t[t.length-1],void 0,void 0,!0)},o.prototype.paintTouchDragFillIndicator=function(e){var t,o,n=this._sheet,r=this.getTouchDragFillIndicatorRect();r&&(t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1AAAAAElFTkSuQmCC",(o=n._getImageLoader()).getState(t)?e.drawImage(o.getImage(t),r.x,r.y,17,20):o.addImage(t))},o.prototype.paintSelection=function(t,o,n,r){var i,a,s,l,u,c,h,p,d,f,g,m,_,y=this._sheet;if(e.FocusHelper.isActiveElement(y)||y.parent&&!y.parent.hideSelection()){var C=y._eventHandler,w=y._selectionModel,v=w.length;if(!(r=this._getClipRect(o,n,r)))return;if(i=e.ThemeStyleHelper.getCssClassThemeStyle("gc-selection"),(a=parseInt(i.zIndex))>2007&&this.paintHeaderSelection(t,o,n,r),(l=(s=this._getPaintingRects(o,n,w,r)).length)<=0)return;for(c=!1,f=0;f<l;f++)if(u=s[f],!r.containsRect(u)){c=!0;break}if(t.save(),c&&(t.rect(r.x,r.y,r.width,r.height),t.clip()),t.beginPath(),l>0)for(h=e._ThemeContext.getColor(y,y.selectionBackColor()),t.fillStyle!==h&&(t.fillStyle=h),p=0,d=0,a>2007&&(p=1,d=-3),f=0;f<s.length;f++)u=s[f],t.fillRect(u.x+p,u.y+p,u.width+d,u.height+d);(g=y.getCellRect(y._activeRowIndex,y._activeColIndex,o,n))&&g.intersectRect(r)&&(p=1,d=-2,a>2007&&(p=0,d=0),this.copyDoubleBuffer(g.x+p,g.y+p,g.width+d,g.height+d),v>1&&(t.strokeStyle="black",t.lineWidth=1,t.strokeRect(g.x+1.5,g.y+1.5,g.width-4,g.height-4))),t.restore(),t.save(),c&&(this.adjustClipRect(r,y,o,n,a),t.rect(r.x,r.y,r.width,r.height),t.clip()),t.beginPath(),1===v&&(C.isDraggingFill&&C.isDragClear()&&!C._isDragAroundIndicator&&(m=C.getCurrentFillRange(),(_=y._getRangeRect(o,n,m))&&_.width>0&&_.height>0&&(t.fillStyle=i&&i.color,t.fillRect(_.x,_.y,_.width,_.height))),u&&u.width>=0&&u.height>=0&&this.paintSelectionBorder(t,o,n,u,r)),t.beginPath(),t.restore()}},o.prototype.adjustClipRect=function(e,t,o,n,r){var i=t.getSelections(),a=t._getSheetLayout(),s=t.getRowCount()-t._frozenTrailingRowCount-1,l=t.getColumnCount()-t._frozenTrailingColCount-1,u=t._getColumnLayout(1,3),c=t._getRowLayout(1,3);if(1===i.length&&r>2007){var h=i[0],p=h.row,d=h.col,f=h.rowCount,g=h.colCount;t.frozenRowCount>0&&(p===t.frozenRowCount?(e.y-=2,e.height+=2):p+f===t.frozenRowCount&&t.frozenRowCount===t._scrollTopRow&&(e.height+=2)),t.frozenColCount>0&&(d===t.frozenColCount?(e.x-=2,e.width+=2):d+g===t.frozenColCount&&t.frozenColCount===t._scrollLeftCol&&(e.width+=2)),0===p&&0===d&&(e.x-=2,e.y-=2,e.width+=2,e.height+=2),-1===p&&(p=0,f=t.getRowCount()),-1===d&&(d=0,g=t.getColumnCount());var m=!1,_=!1,y=c.findRow(s),C=u.findCol(l);y&&y.y+y.height<a.viewportY+a.viewportHeight&&(m=!0),C&&C.x+C.width<a.viewportX+a.viewportWidth&&(_=!0),m&&p+f-1===s&&(e.height+=2),_&&d+g-1===l&&(e.width+=2)}},o.prototype.paintHeaderSelection=function(e,t,o,n){var r,i,a,s,l=this._sheet,u=l._selectionModel,c=l._getSheetLayout(),h=u.length;if(!(h<=0)){var p=u[0],d=p.row,f=p.rowCount,g=p.col,m=p.colCount;if(-1===d&&(d=0),-1===g&&(g=0),-1===f&&(f=l.getRowCount()),-1===m&&(m=l.getColumnCount()),e.save(),e.beginPath(),e.lineWidth=2,e.strokeStyle=l.selectionBorderColor(),!0,!0,!(1===h&&0===l.frozenRowCount&&l._scrollTopRow>d&&l._scrollTopRow<d+f))for(a=0,s=(r=this._getColumnHeaderSelectionRects(o)).length;a<s;a++){var _=r[a],y=0,C=0,w=_.x,v=_.x+_.width;_.x<n.x+n.width&&n.x<_.x+_.width&&(1===h&&(0===l.frozenRowCount&&l._scrollTopRow===d||l.frozenRowCount>0&&0===d)&&(y=-1,C=1),_.x<n.x&&(y=0,w=n.x),_.x+_.width>n.x+n.width&&(C=0,v=n.x+n.width),e.moveTo(w+y-1,c.headerY+c.colHeaderHeight-1),e.lineTo(v+C,c.headerY+c.colHeaderHeight-1),e.stroke())}if(!(1===h&&0===l.frozenColCount&&l._scrollLeftCol>g&&l._scrollLeftCol<g+m))for(a=0,s=(i=this._getRowHeaderSelectionRects(t)).length;a<s;a++){var S=i[a],x=0,R=0,b=S.y,T=S.y+S.height;S.y<n.y+n.height&&n.y<S.y+S.height&&(1===h&&(0===l.frozenColCount&&l._scrollLeftCol===g||l.frozenColCount>0&&0===g)&&(x=-1,R=1),S.y<n.y&&(x=0,b=n.y),S.y+S.height>n.y+n.height&&(R=0,T=n.y+n.height),e.moveTo(c.headerX+c.rowHeaderWidth-1,b+x-1),e.lineTo(c.headerX+c.rowHeaderWidth-1,T+R),e.stroke())}e.beginPath(),e.restore()}},o.prototype._getColumnHeaderSelectionRects=function(t){for(var o,n,r,i,a,s=this._sheet,l=s._selectionModel,u=l.length,c=s._getColumnLayout(t),h=[],p=(s._getSheetLayout(),0);p<u;p++)if(o=l[p])if(-1===(n=o.col)){var d=s._getColumnLayout(0,3),f=s._getColumnLayout(1,3),g=s._getColumnLayout(2,3),m=-1,_=-1;d.length>0&&(m=d[0].x,_=d[d.length-1].x+d[d.length-1].width-m,h.push(new e.Rect(m,-1,_,-1))),f.length>0&&(m=f[0].x,_=f[f.length-1].x+f[f.length-1].width-m,h.push(new e.Rect(m,-1,_,-1))),g.length>0&&(m=g[0].x,_=g[g.length-1].x+g[g.length-1].width-m,h.push(new e.Rect(m,-1,_,-1)))}else c&&(r=c.findCol(n),i=c.findCol(n+o.colCount-1),(r||i)&&((a=new e.Rect(-1,-1,-1,-1)).x=r?r.x:c[0].x,a.width=i?i.x+i.width-a.x:c[c.length-1].x+c[c.length-1].width-a.x,h.push(a)));return h},o.prototype._getRowHeaderSelectionRects=function(t){for(var o,n,r,i,a,s=this._sheet,l=s._selectionModel,u=l.length,c=s._getRowLayout(t),h=[],p=(s._getSheetLayout(),0);p<u;p++)if(o=l[p])if(-1===(n=o.row)){var d=s._getRowLayout(0,3),f=s._getRowLayout(1,3),g=s._getRowLayout(2,3),m=-1,_=-1;d.length>0&&(m=d[0].y,_=d[d.length-1].y+d[d.length-1].height-m,h.push(new e.Rect(-1,m,-1,_))),f.length>0&&(m=f[0].y,_=f[f.length-1].y+f[f.length-1].height-m,h.push(new e.Rect(-1,m,-1,_))),g.length>0&&(m=g[0].y,_=g[g.length-1].y+g[g.length-1].height-m,h.push(new e.Rect(-1,m,-1,_)))}else c&&(r=c.findRow(n),i=c.findRow(n+o.rowCount-1),(r||i)&&((a=new e.Rect(-1,-1,-1,-1)).y=r?r.y:c[0].y,a.height=i?i.y+i.height-a.y:c[c.length-1].y+c[c.length-1].height-a.y,h.push(a)));return h},o.prototype.paintSelectionBorder=function(t,o,n,r,i){var a=this._sheet,s=a._eventHandler;if(r.width>=0&&r.height>=0&&(!i||r.intersect(i.x-1,i.y-1,i.width+2,i.height+2))){if(t.save(),i&&!i.containsRect(r)&&(t.rect(i.x,i.y,i.width,i.height),t.clip()),t.beginPath(),t.strokeStyle=e._ThemeContext.getColor(a,a.selectionBorderColor()),t.lineWidth=2,r.width>0&&r.height>0){if(s.isDraggingFill)switch(s._currentFillDirection){case 2:t.moveTo(r.x+.5,r.y-.5),t.lineTo(r.x+r.width-1,r.y-.5);break;case 3:t.moveTo(r.x+.5,r.y+r.height-.5),t.lineTo(r.x+r.width-1,r.y+r.height-.5);break;case 0:t.moveTo(r.x-.5,r.y+.5),t.lineTo(r.x-.5,r.y+r.height-1);break;case 1:t.moveTo(r.x+r.width-.5,r.y+.5),t.lineTo(r.x+r.width-.5,r.y+r.height-1)}else(a.parent&&a.parent._themeVersion)>2007?t.rect(r.x-1,r.y-1,r.width+1,r.height+1):t.rect(r.x-.5,r.y-.5,r.width,r.height);t.stroke(),a.canUserDragFill()&&this.paintDragFillIndicator(t,o,n,r,i)}else(0===r.width||0===r.height)&&t.strokeRect(r.x-1,r.y-1,r.width+1,r.height+1);t.beginPath(),t.restore()}},o.prototype._getClipRect=function(e,t,o){var i,a,s,l,u=this._sheet,c=u._getSheetLayout(),h=c.viewportRect(e,t);return 1===t&&((a=(i=u._getColumnLayout(t)).length>0?i[i.length-1]:n)&&(h.width=r(h.width,a.x+a.width-c.viewportX))),1===e&&((l=(s=u._getRowLayout(e)).length>0?s[s.length-1]:n)&&(h.height=r(h.height,l.y+l.height-c.viewportY))),o?o.getIntersect(h.x,h.y,h.width,h.height):h},o.prototype._getPaintingRects=function(e,t,o,n){for(var r,i,a,s=this._sheet,l=s._getSpanModel(),u=o.length,c=[],h=0;h<u;h++)(i=o[h])&&((r=l.find(i.row,i.col))&&r.containsRange(i)&&(i=r),(a=s._getRangeRect(e,t,i))&&a.x<=n.x+n.width&&a.y<=n.y+n.height&&n.x<=a.x+a.width&&n.y<=a.y+a.height&&c.push(a));return c},o.prototype.paintFormulaTextBox=function(){var e,t,o=this._sheet;o._paintSuspended||o._layoutSuspended>0||(e=o._getSheetLayout(),t=this._getCtx(),this.copyDoubleBuffer(e.x,e.y,e.width,e.height),this.paintAdornment(t))},o.prototype.paintFormulaTextBoxRange=function(t,o,n,r){var i,a,s,l,u,c,h,p=this._sheet,d=p._eventHandler,f=p._formulaTextBox,g=f&&f.getRanges(),m=g&&g.length;p.getName();if(!(m<=0)&&(i=this._getClipRect(o,n,r))){t.save(),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.beginPath();var _,y,C,w,v,S=[],x=d.isFormulaRangeHoving,R=d._formulRangeHovingInfo,b=d.isFormulaRangeMoving,T=d._formulaRangeMovingInfo,A=d.isFormulaRangeResizing,I=d._formulaRangeResizingInfo;for(c=0;c<m;c++)if(y=(_=g[c]).text,C=_.ranges&&_.ranges.length>0?_.ranges:[d.stringToRange(y)]){if(h=e.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,e.features.formulatextbox&&h&&h.sheet)if(e.StringUtil.contains(y,"!")){if(a=e.StringUtil.leftBefore(y,"!"),p.getName()!==a&&"'"+p.getName()+"'"!==a)continue}else if(!p.getCustomName(e.StringUtil.leftBefore(y,"["))&&!p.findTableByName(e.StringUtil.leftBefore(y,"[")))continue;for(w=this._getPaintingRects(o,n,C,i),s=0;s<w.length;s++)if((l=w[s])&&l.width>0&&l.height>0){if(v=f.getRangeColor(c),f.isAppendingRange(_)?(x&&R.paramRange.index===c&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=v,t.rect(l.x+1,l.y+1,l.width-3,l.height-3),t.stroke()),this.paintDashRect(t,l,v)):x&&R.paramRange.index===c||b&&T.paramRange.index===c||A&&I.paramRange.index===c?(t.beginPath(),t.lineWidth=2,t.strokeStyle=v,t.rect(l.x+1,l.y+1,l.width-3,l.height-3),t.stroke()):(t.beginPath(),t.lineWidth=2,t.strokeStyle=v,t.rect(l.x,l.y,l.width-1,l.height-1),t.stroke()),f.isActiveRange(_)){var D=0,F=0,M=0,E=e.util.parseColorString(v);3===E.length?(D=E[0],F=E[1],M=E[2]):4===E.length&&(D=E[1],F=E[2],M=E[3]),t.beginPath(),t.fillStyle="rgba("+D+","+F+","+M+",0.1)",t.fillRect(l.x+1,l.y+1,l.width-3,l.height-3)}S.push({rect:l,color:v,allowDrag:_.allowDrag})}}if(S.length>0)for(u=S.length,c=0;c<u;c++){l=S[c].rect,v=S[c].color;var N=l.x-2,O=l.x+l.width+1-5,P=l.y-2,L=l.y+l.height+1-5;!1!==S[c].allowDrag&&(h=e.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,e.features.formulatextbox&&h&&h.text||(t.beginPath(),t.fillStyle=v,t.fillRect(N,P,5,5),t.fillRect(O,P,5,5),t.fillRect(N,L,5,5),t.fillRect(O,L,5,5)))}t.beginPath(),t.restore()}},o.prototype.paintDashRect=function(t,o,n){var r,i,s,l,u,c,h;if(t.save(),r=[6,6],t.setLineDash&&!e.util.browser.qtMode)t.beginPath(),t.lineWidth=2,t.strokeStyle=n,t.setLineDash(r),t.rect(o.x,o.y,o.width-1,o.height-1),t.stroke();else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=n,i=r[0],s=r[1],l=o.x,u=o.y,c=o.width;c>0;)if(c>=i+s)t.moveTo(l,u),t.lineTo(l+i,u),l=l+i+s,c=c-i-s;else{if(c>=i){t.moveTo(l,u),t.lineTo(l+i,u),c=c-i-s;break}if(c>0){t.moveTo(l,u),t.lineTo(l+c,u),c=c-i-s;break}}for(l=o.x+o.width-1,u=o.y+1,h=o.height-1,c<0&&((c=a(c))>s&&(t.moveTo(l,u-2),t.lineTo(l,u+(c-s))),u+=c,h-=c);h>0;)h>=i+s?(t.moveTo(l,u),t.lineTo(l,u+i),u=u+i+s,h=h-i-s):h>=i?(t.moveTo(l,u),t.lineTo(l,u+i),h=h-i-s):h>0&&(t.moveTo(l,u),t.lineTo(l,u+h),h=h-i-s);for(l=o.x+o.width-2,u=o.y+o.height-1,c=o.width-1,h<0&&((h=a(h))>s&&(t.moveTo(l+2,u),t.lineTo(l-(h-s),u)),l-=h,c-=h);c>0;)if(c>=i+s)t.moveTo(l,u),t.lineTo(l-i,u),l=l-i-s,c=c-i-s;else{if(c>=i){t.moveTo(l,u),t.lineTo(l-i,u),c=c-i-s;break}if(c>0){t.moveTo(l,u),t.lineTo(l-c,u),c=c-i-s;break}}for(l=o.x,u=o.y+o.height-2,h=o.height-1,c<0&&((c=a(c))>s&&(t.moveTo(l,u+2),t.lineTo(l,u-(c-s))),u-=c,h-=c);h>0;)h>=i+s?(t.moveTo(l,u),t.lineTo(l,u-i),u=u-i-s,h=h-i-s):h>=i?(t.moveTo(l,u),u-i===o.y?t.lineTo(l,u-i-1):t.lineTo(l,u-i),h=h-i-s):h>0&&(u>o.y&&(t.moveTo(l,u),t.lineTo(l,u-h)),h=h-i-s);t.stroke()}t.beginPath(),t.restore()},o.prototype.getDragFillIndicatorRect=function(t,o){var n,r=this._sheet,i=r._getActiveSelectedRange(),a=r._getSheetLayout(),s=4,l=-2.5;return o>2007&&(s=5,l=-3),n=new e.Rect(-4,-4,s,s),-1===i.col?(n.x=a.frozenX,n.y=t.y+t.height+l):-1===i.row?(n.x=t.x+t.width+l,n.y=a.frozenY):(n.x=t.x+t.width+l,n.y=t.y+t.height+l),n},o.prototype.paintDragFillIndicator=function(t,o,n,r,a){var s,l,u=this._sheet,c=u._getSheetLayout(),h=u.parent&&u.parent._themeVersion,p=this.getDragFillIndicatorRect(r,h),d=c.viewportRect(o,n);(!a||p.intersectRect(a))&&p.intersectRect(d)&&(s=-1.5,h>2007&&(s=-1),(l=new e.Rect(p.x+s,p.y+s,p.width+2,p.height+2)).x=i(l.x,d.x),l.y=i(l.y,d.y),this.copyDoubleBufferRect(l),t.save(),a&&!a.containsRect(p)&&(t.rect(a.x,a.y,a.width,a.height),t.clip()),t.beginPath(),t.fillStyle=e._ThemeContext.getColor(u,u.selectionBorderColor()),t.fillRect(p.x,p.y,p.width,p.height),u._dragFillIndicatorRect=new e.Rect(p.x,p.y,4,4),t.beginPath(),t.restore())},o.prototype._paintCommentFloatLayoutPanel=function(e){var t;3===e&&((t=this._sheet._commentRender)&&t.renderCommentFloatPanel(this._sheet))},o.prototype._paintCommentCellAdorner=function(e,t,o){var n=this._sheet._commentRender;n&&n.renderCommentCellAdorner(e,t,o)},o.prototype._paintComment=function(e){var t,o,n,r,i,a=this._sheet,s=a._commentRender;if(!a._hoverCell)for(t=this._sheet._getSheetLayout(),n=0;n<=2;n++)for(r=0;r<=2;r++)(o=t.viewportRect(n,r))&&0!==o.width&&0!==o.height&&(!e||o.intersectRect(e))&&(i=a._commentManager,s&&i&&s.renderComment(i))},o.prototype.paintViewportImp=function(o,r,i,a,s,u){var c,h,p,d,f,g,m;(typeof a===l||a===n)&&(a=3);var _=this._sheet,y=_.parent,C=_._getRowLayout(r,a),w=_._getColumnLayout(i,a);if(y&&1===y.resizeZeroIndicator()&&(-1===r&&w.length>0&&w[0].col>=1&&0===_._getActualColumnWidth(w[0].col-1)&&w.unshift(new e._Layout(-1,w[0].col-1,_._getSheetLayout().viewportX,-1,0,-1)),-1===i&&C.length>0&&C[0].row>=1&&0===_._getActualRowHeight(C[0].row-1)&&C.unshift(new e._Layout(C[0].row-1,-1,-1,_._getSheetLayout().viewportY,-1,0))),c=C.length,h=w.length,!(c<0||h<0)){var v,S,x,R,b=_._getCellLayout(r,i,a),T=b.length>0,A=n,I=n,D=n,F=_._cachePool,M=0,E=0,N=0,O=0,P=F.isCaching()&&_.parent&&!_.parent.touchScrollOnRails()?new e._FastBorders(C[0].row,w[0].col,c,h,s):new e._GcBorders(_,r,i,a),L=[],H=[],k=3===a&&_._allowCellOverflow,V=n,B=_._getFilterButtonModel(),z=[],G=!u&&3===a&&_.parent&&_.parent.highlightInvalidData();o.save(),s&&(o.rect(s.x,s.y,s.width,s.height),o.clip()),o.beginPath();var W=[],j=-1,U=-1;for(p=0;p<c;p++)for(A=C[p],d=0;d<h;d++)I=w[d],(D=T&&b.findCell(A.row,I.col))?(v=D.row,S=D.col,M=D.x,E=D.y,N=D.width,O=D.height):(v=A.row,S=I.col,M=I.x,E=A.y,N=I.width,O=A.height),y&&1===y.resizeZeroIndicator()&&(-1===r&&_.getColumnVisible(S)&&0===_._getActualColumnWidth(S)&&((U<0||U!==S-1)&&W.push({x1:M,y1:E,x2:M,y2:E+O,horizontal:!1}),U=S),-1===i&&_.getRowVisible(v)&&0===_._getActualRowHeight(v)&&((j<0||j!==v-1)&&W.push({x1:M,y1:E,x2:M+N,y2:E,horizontal:!0}),j=v)),s&&(M+N<=s.x||M>=s.x+s.width||E+O<=s.y||E>=s.y+s.height)||0!==N&&0!==O&&(D&&e.ArrayHelper.contains(L,D)||(x=F.getValue(v,S,a),f={value:void 0},(R=F.getActualStyle(v,S,a))&&e._CacheMgr.getFormattedTextByStyle(_,R,x,f),B&&N>0&&O>0&&((g=B.find(v,S,a))&&(V||(V=new e._FilterButtonInfoModel),V.push(new e._FilterButtonInfo(g.rowFilter,g.row,g.col,g.sheetArea,M,E,N,O)))),G&&!_.isValid(v,S,x)&&z.push({x:M,y:E,width:N,height:O}),P.addCellLines(v,S,M,E,N,O,R,D),H.push({data:x,row:v,col:S,x:M,y:E,width:N,height:O,style:R}),D&&L.push(D)));H.length>0&&(k&&(m=F.getCellOverflowBuilder(r,i,function(){return new t(_,r,i)}),this.buildCellOverflowValueLayout(m,H,P)),this.paintCells(o,H,a,u)),V&&V.length>0&&this._paintFilterButtons(o,V),P.paint(o,s),W.length>0&&this._paintDoubleGridLines(o,W,1,3),z.length>0&&this._paintValidationUI(o,z),o.restore()}},o.prototype._paintDoubleGridLines=function(e,t,o,n){var r,i;if(0!==t.length)for(r=0,i=t.length;r<i;r++){var a=t[r],s=a.x1,l=a.y1,u=a.x2,c=a.y2,h=a.horizontal;if(e.beginPath(),e.save(),e.lineWidth=o,e.strokeStyle=this._getHeaderGridLineColor(e,h,s,l,u,c),e.fillStyle=this._getHeaderBackColor(e,h,s,l,u,c),h){e.fillRect(s,l+-3,u-s-1,n+2*o),e.translate(.5,.5),e.moveTo(s+-1,l+-3),e.lineTo(u+-2,c+-3),e.moveTo(s+-1,l+1),e.lineTo(u+-2,c+1)}else{e.fillRect(s+-3,l+0,n+2*o,c-l-1),e.translate(.5,.5),e.moveTo(s+-3,l+0),e.lineTo(u+-3,c+-1),e.moveTo(s+1,l+0),e.lineTo(u+1,c+-1)}e.stroke(),e.restore()}},o.prototype._getHeaderBackColor=function(t,o,n,r,i,a){var s,l,u,c,h,p=o?"rowHeader":"columnHeader",d=e.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-"+p+"-normal"),f=d&&d.backgroundColor,g=d&&d.backgroundImage;if(!o&&g&&-1!==g.indexOf("linear-gradient"))for(l=e.util.getLinearGradientColors(g),s=t.createLinearGradient(n,r,i,a),u=0,c=l.length;u<c;u++)h=l[u],s.addColorStop(h.point,h.color);else f&&(s=f);return s},o.prototype._getHeaderGridLineColor=function(t,o,n,r,i,a){var s=t.createLinearGradient(n,r,i,a),l=o?"rowHeader":"columnHeader",u=e.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-"+l+"-normal");return o?(s.addColorStop(0,u.borderTopColor),s.addColorStop(1,u.borderBottomColor)):(s.addColorStop(0,u.borderLeftColor),s.addColorStop(1,u.borderRightColor)),s},o.prototype._getFilterButtonRect=function(e,t){var o=this._sheet,n=o._zoomFactor,i=n>1?1:n,a=3===t||typeof t===l?o.defaults.rowHeight:o.defaults.colHeaderRowHeight,s=parseInt((r(20,a)*i).toString(),10);o.parent&&o.parent.useTouchLayout()&&(s=parseInt((a*n).toString(),10));var u=s;return{x:e.x+e.width-s,y:e.y+e.height-u,width:s,height:u}},o.prototype._paintFilterButtons=function(t,o){var n,r=this._sheet;for(t.save(),t.beginPath(),t.lineWidth=1,t.fillStyle="#FFFFFF",t.strokeStyle="#CCCCCC",this._getCtx(),n=0;n<o.length;n++){var i=o[n],a=this._getFilterButtonRect(new e.Rect(i.x,i.y,i.width,i.height),i.sheetArea),s=a.width,l=a.height,u=a.x,c=a.y;t.save(),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.beginPath(),t.fillRect(u+1,c+1,s-3,l-3),t.strokeRect(u+1-.5,c+2-.5,s-3,l-4);var h=i.getState(),p=e._GcFilterDialog.getImageSrc(h),d=r._getImageLoader();try{d.getState(p)?t.drawImage(d.getImage(p),u,c+1,s-3,l-3):d.addImage(p)}catch(e){}t.beginPath(),t.restore()}t.restore()},o.prototype._paintValidationUI=function(e,t){var o,n;if(t)for(o=t.length,n=0;n<o;n++){var r=t[n],i=r.x-4,a=r.y-4,s=r.width+8,l=r.height+8,u=s/2*.5522848,c=l/2*.5522848,h=i+s,p=a+l,d=i+s/2,f=a+l/2;e.save(),e.lineWidth=2,e.strokeStyle="red",e.beginPath(),e.moveTo(i,f),e.bezierCurveTo(i,f-c,d-u,a,d,a),e.bezierCurveTo(d+u,a,h,f-c,h,f),e.bezierCurveTo(h,f+c,d+u,p,d,p),e.bezierCurveTo(d-u,p,i,f+c,i,f),e.closePath(),e.stroke(),e.restore()}},o.prototype.paintCells=function(t,o,r,a){var s,l,u,c,h,p,d,f,g=this._sheet,m=3===r,_=e.StyleHelper._scaleFont,y=g._zoomFactor,C=_(this._getDefaultFont(r),y),w=g.getDefaultStyle(r),v=g.getDefaultCellType(r),S=g._conditionalFormats,x=g.parent&&g.parent.backColor()||"#FFFFFF";x="white"===x?"#FFFFFF":x,s=g._getImageLoader(),t.save(),t.beginPath(),t.fillStyle=w&&w.foreColor||"#000000",t.font=C.font,t.textAlign=m?"right":"center";var R,b,T,A,I,D,F,M,E,N,O,P,L,H,k,V,B=o.length,z=e.features.sparkline,G=g._getModel(r),W=[],j={sheet:g,row:-1,col:-1,fontInfo:n,lineHeight:-1,imageLoader:s,conditionalFormats:S,sheetArea:r,parentBackColor:x};for(f=0;f<B;f++){if(T=(R=o[f]).data,A=R.row,I=R.col,D=R.x,F=R.y,M=R.width,E=R.height,N=R.style,O=R.cellOverflowLayout,L=N.font?_(N.font,y):C,(l=!N.wordWrap&&N.shrinkToFit)&&(u=g.getText(A,I,r),N.watermark&&!u&&(u=N.watermark),u))for(c={value:!1},h=0;h<3&&!1===c.value&&(p=g._getStringWidthByCanvas(u,L.font),d=i(0,M-4),1!==N.hAlign&&N.textIndent&&(d=i(0,d-8*N.textIndent)),d<p);h++)L=_(L.font,d/p,c,!0);N.font=L.font,M>0&&E>0&&(b=N.cellType||v,D--,F--,M++,E++,m?(k=z&&G.getSparkline(A,I),j.sparkline=k):(P=a?0:this.getVisualState(A,I,r),j.visualState=P),H=g._getFontHeight(L.font,l),j.lineHeight=H,j.row=A,j.col=I,j.fontInfo=L,j.cellOverflowLayout=O,b.paint(t,T,D,F,M,E,N,j),O&&!j.showBarIconOnly&&W.push({cellType:b,data:T,x:D,y:F,width:M,height:E,style:N,options:{sheet:g,row:A,col:I,fontInfo:L,lineHeight:H,cellOverflowLayout:O,parentBackColor:x}})),!a&&e.features.comment&&g._commentManager.hasComment()&&this._paintCommentCellAdorner(t,r,R)}if((B=W.length)>0){var U=g.isEditing(),Y=g._activeRowIndex,X=g._activeColIndex,K=e.features.sparklineEx;for(f=0;f<B;f++)b=(V=W[f]).cellType,T=V.data,D=V.x,F=V.y,M=V.width,E=V.height,N=V.style,j=V.options,U&&j.row===Y&&j.col===X||K&&T instanceof e.SparklineExValue||b.paintValue&&b.paintValue(t,T,D,F,M,E,N,j)}t.restore()},o.prototype.getVisualState=function(t,o,r){var i=this._sheet,a=0;return(e.FocusHelper.isActiveElement(i)||i.parent&&!i.parent.hideSelection())&&(3===r||typeof r===l||r===n?!i.isEditing()&&i._isActiveCell(t,o)?a=3:i._isSelected(t,o,r)&&(a=2):(i._isSelected(t,o,r)&&(a=1,i._isAllSelected(t,o,r)&&(a=2)),i._isHover(t,o,r)&&(a=4))),a},o.prototype.paintLine=function(e,t,o,n,r,i){e.lineWidth=t.width(),e.strokeStyle=t.color,e.moveTo(o,n),e.lineTo(r,i)},o.prototype.paintGroup=function(t,o){var n,r,i,a,s,l=this._sheet,u=l._getGroupLayout();if(0!==u.width||0!==u.height){if(t.save(),t.beginPath(),n=l._getSheetLayout(),u.width>0&&(!o||o.intersect(u.x,u.y,u.width,n.height)))for(r=u.rowMaxLevel,new e._RangeGroupHeaderPresenter(l,!0,r).paintGroupHeader(t),a=l._cachePool.getRowGroups(function(){for(var t=[new e._RangeGroupPresenter(l,!0,0,r),new e._RangeGroupPresenter(l,!0,1,r),new e._RangeGroupPresenter(l,!0,2,r)],o=0;o<=2;o++)t[o].createGroupInfo();return t}),s=0;s<=2;s++)a[s].paintGroups(t);if(u.height>0&&(!o||o.intersect(u.x,u.y,n.width,u.height)))for(i=u.colMaxLevel,new e._RangeGroupHeaderPresenter(l,!1,i).paintGroupHeader(t),a=l._cachePool.getColGroups(function(){for(var t=[new e._RangeGroupPresenter(l,!1,0,i),new e._RangeGroupPresenter(l,!1,1,i),new e._RangeGroupPresenter(l,!1,2,i)],o=0;o<=2;o++)t[o].createGroupInfo();return t}),s=0;s<=2;s++)a[s].paintGroups(t);t.beginPath(),t.restore()}},o.prototype.groupHitTest=function(t,o){var r,i,a,s,l,u,c,h,p,d;if(!e.features.group||0===(i=(r=this._sheet)._getGroupLayout()).width&&0===i.height||(a=r._getSheetLayout(),!new e.Rect(i.x,i.y,i.width,a.height).contains(t,o)&&!new e.Rect(i.x,i.y,a.width,i.height).contains(t,o)))return n;if(s={what:"empty",info:n},i.width>0&&(c=i.rowMaxLevel,(u=new e._RangeGroupHeaderPresenter(r,!0,c).getGroupButton(t,o))&&(s={what:"rgh",info:u}),"empty"===s.what))for(h=[new e._RangeGroupPresenter(r,!0,0,c),new e._RangeGroupPresenter(r,!0,1,c),new e._RangeGroupPresenter(r,!0,2,c)],l=0;l<=2;l++)if(h[l].createGroupInfo(),u=h[l].getRowGroupButton(t,o)){s={what:"rg",info:u};break}if(i.height>0&&(p=i.colMaxLevel,"empty"===s.what&&((u=new e._RangeGroupHeaderPresenter(r,!1,p).getGroupButton(t,o))&&(s={what:"cgh",info:u})),"empty"===s.what))for(d=[new e._RangeGroupPresenter(r,!1,0,p),new e._RangeGroupPresenter(r,!1,1,p),new e._RangeGroupPresenter(r,!1,2,p)],l=0;l<=2;l++)if(d[l].createGroupInfo(),u=d[l].getColGroupButton(t,o)){s={what:"cg",info:u};break}return s},o.prototype.buildCellOverflowValueLayout=function(t,o,n){for(var r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A=this._sheet,I=A._cachePool,D=o.length,F={},M=[],E=0;E<D;E++){if(f=(h=o[E]).row,g=h.col,m=h.x,_=h.y,C=h.height,R=(x=t.getCellOverflowLayoutModel(f)).headingOverflowlayout,b=x.trailingOverflowLayout,!F[f]){for(r={},i=0;i<x.length;i++)r[x[i].column]=!1;R&&(r[R.column]=!1),b&&(r[b.column]=!1),F[f]=r}a=F[f],(T=x.find(g))?(T.column===g?(y=h.width,w=T.backgroundWidth,v=T.backgroundLeftWidth<0?m:T.backgroundRightWidth<0?m+y-w:m+y/2-T.backgroundLeftWidth,h.cellOverflowLayout=T,a[T.column]&&M.push(E)):a[T.column]||(g=T.column,d=I.getActualStyle(f,g),p=A.getValue(f,g),y=T.columnWidth,w=T.backgroundWidth,s=A.getCellRect(f,T.column),v=T.backgroundLeftWidth<0?s.x:T.backgroundRightWidth<0?s.x+s.width-w:s.x+s.width/2-T.backgroundLeftWidth,S={data:p,row:f,col:g,x:s.x,y:_,width:y,height:C,style:d,cellOverflowLayout:T},o.push(S)),T.layout=new e.Rect(v,_,w,C),n.addCellOverlfowLayout(f,T),a[T.column]=!0):R&&!a[R.column]&&R.contains(g)?(g=R.column,d=I.getActualStyle(f,g),p=A.getValue(f,g),y=R.columnWidth,w=R.backgroundWidth,S={data:p,row:f,col:g,x:v=(l=A.getCellRect(f,R.endColumn)).x+l.width-w,y:_,width:y,height:C,style:d,cellOverflowLayout:R},o.push(S),R.layout=new e.Rect(v,_,w,C),n.addCellOverlfowLayout(f,R),a[R.column]=!0):b&&!a[b.column]&&b.contains(g)&&(g=b.column,d=I.getActualStyle(f,g),p=A.getValue(f,g),y=b.columnWidth,w=b.backgroundWidth,v=(u=A.getCellRect(f,b.startColumn)).x,S={data:p,row:f,col:g,x:u.x+w-y,y:_,width:y,height:C,style:d,cellOverflowLayout:b},o.push(S),b.layout=new e.Rect(v,_,w,C),n.addCellOverlfowLayout(f,b),a[b.column]=!0)}if(M.length>0)for(c=M.length-1;c>=0;c--)o.splice(M[c],1)},o}();e._SheetRender=c,t=function(){function t(t,o,n){this.TEXT_WIDTH_OFFSET=2;var r=this;r._sheet=t,r._rowViewportIndex=o,r._colViewportIndex=n,r._colLayoutModel=t._getColumnLayout(n),r._cellLayoutModel=t._getCellLayout(o,n),r.maxCellOverflowDistance=t.maxCellOverflowDistance,r.scaleFont=e.StyleHelper._scaleFont,r.zoomFactor=t._zoomFactor,r.defaultFont=r.scaleFont(t._render._getDefaultFont(),r.zoomFactor).font,r.defaultCellType=t.getDefaultCellType(),r.cachedCellOverflowModels={}}return t.prototype.getCellOverflowLayoutModel=function(t){var o,r=this.cachedCellOverflowModels[t];if(r)return r;var i,a,s,u,c,h,p,d,f=this._sheet,g=f._cachePool,m=this._colLayoutModel,_=m.length,y=m[0].col,C=m[_-1].col,w=new e._CellOverflowLayoutModel;for(w.headingOverflowlayout=this._buildHeadingCellOverflowLayout(t),o=0;o<_;o++)(i=m[o]).width<=0||(a=i.col,u=g.getValue(t,a),s=g.getActualStyle(t,a),(u!==n&&typeof u!==l||s.watermark)&&(s.shrinkToFit||s.wordWrap||(c=g.getZoomColWidth(a),p=e._CacheMgr.getFormattedTextByStyle(f,s,u),3===(h=s.hAlign)&&(h=e.util.getHAlignByValueType(h,u,s.formatter)),0===h?(d=this._buildCellOverflowLayoutModelForLeft({data:u,style:s,width:c,text:p},t,a,C))&&w.push(d):2===h?(d=this._buildCellOverflowLayoutModelForRight({data:u,style:s,width:c,text:p},t,a,y))&&w.push(d):1===h&&((d=this._buildCellOverflowLayoutModelForCenter({data:u,style:s,width:c,text:p},t,a,y,C))&&w.push(d)))));return w.trailingOverflowLayout=this._buildTrailingCellOverflowLayout(t),this.cachedCellOverflowModels[t]=w,w},t.prototype._buildCellOverflowLayoutModelForLeft=function(t,o,r,i){var a,s,u,c,h,p,d=this._sheet._cachePool,f=this._cellLayoutModel,g=t.width,m=t.width,_=t.data,y=t.style,C=t.text;if(f.findCell(o,r)!==n||!(y.cellType||this.defaultCellType).allowOverflow||!C&&!y.watermark||(!C&&y.watermark&&(C=y.watermark),u=y.font,c=y.textIndent,u=u?this.scaleFont(u,this.zoomFactor).font:this.defaultFont,(s=e._WordWrapHelper._measureText(C,u)+(c?8*c:0)+this.TEXT_WIDTH_OFFSET)<=m))return n;for(h=r,p=r,a=r+1;a<=i&&f.findCell(o,a)===n&&((_=d.getValue(o,a))===n||typeof _===l)&&!d.getActualStyle(o,a).watermark&&(p=a,!(s<=(m+=d.getZoomColWidth(a))));a++);return p==r?n:new e._CellOverflowLayout(r,h,p,s,g,m,-1,m)},t.prototype._buildCellOverflowLayoutModelForRight=function(t,o,r,i){var a,s,u,c,h,p,d=this._sheet._cachePool,f=this._cellLayoutModel,g=t.width,m=t.width,_=t.data,y=t.style,C=t.text;if(f.findCell(o,r)!==n||!(y.cellType||this.defaultCellType).allowOverflow||!C&&!y.watermark||(!C&&y.watermark&&(C=y.watermark),u=y.font,c=y.textIndent,u=u?this.scaleFont(u,this.zoomFactor).font:this.defaultFont,(s=e._WordWrapHelper._measureText(C,u)+(c?8*c:0)+this.TEXT_WIDTH_OFFSET)<=m))return n;for(h=r,p=r,a=r-1;a>=i&&f.findCell(o,a)===n&&((_=d.getValue(o,a))===n||typeof _===l)&&!d.getActualStyle(o,a).watermark&&(h=a,!(s<=(m+=d.getZoomColWidth(a))));a--);return h==r?n:new e._CellOverflowLayout(r,h,p,s,g,m,m,-1)},t.prototype._buildCellOverflowLayoutModelForCenter=function(t,o,r,i,a){var s,u,c,h,p,d,f,g,m=this._sheet._cachePool,_=this._cellLayoutModel,y=t.width,C=t.width,w=t.data,v=t.style,S=t.text;if(_.findCell(o,r)!==n||!(v.cellType||this.defaultCellType).allowOverflow||!S&&!v.watermark||(!S&&v.watermark&&(S=v.watermark),c=v.font,h=v.textIndent,c=c?this.scaleFont(c,this.zoomFactor).font:this.defaultFont,(u=e._WordWrapHelper._measureText(S,c)+(h?8*h:0)+this.TEXT_WIDTH_OFFSET)<=C))return n;for(p=r,d=C/2,s=r-1;s>=i&&_.findCell(o,s)===n&&((w=m.getValue(o,s))===n||typeof w===l)&&!m.getActualStyle(o,s).watermark&&(p=s,!(u/2<=(d+=m.getZoomColWidth(s))));s--);for(f=r,g=C/2,s=r+1;s<=a&&_.findCell(o,s)===n&&((w=m.getValue(o,s))===n||typeof w===l)&&(f=s,!(u/2<=(g+=m.getZoomColWidth(s))));s++);return p===f?n:new e._CellOverflowLayout(r,p,f,u,y,d+g,d,g)},t.prototype._buildHeadingCellOverflowLayout=function(t){for(var o,r,i,a,s,u,c,h=this._sheet,p=h._cachePool,d=this._colLayoutModel,f=d[0].col,g=d[d.length-1].col,m=h._getSpanModel(),_=this.maxCellOverflowDistance,y=f,C=1;C<_;C++){if((u=y-C)<0||m.find(t,u))return n;if(i=p.getValue(t,u),(a=p.getZoomColWidth(u))>0&&i!==n&&typeof i!==l){if(3===(s=(r=p.getActualStyle(t,u)).hAlign)&&(s=e.util.getHAlignByValueType(s,i)),(0===s||1===s)&&r&&(o=e._CacheMgr.getFormattedTextByStyle(h,r,i)),0===s){if((c=this._buildCellOverflowLayoutModelForLeft({data:i,style:r,width:a,text:o},t,u,g))&&c.endColumn>=f)return c}else if((c=this._buildCellOverflowLayoutModelForCenter({data:i,style:r,width:a,text:o},t,u,f,g))&&c.endColumn>=f)return c;return n}}},t.prototype._buildTrailingCellOverflowLayout=function(t){for(var o,r,i,a,s,u,c,h=this._sheet,p=h._cachePool,d=this._colLayoutModel,f=d[0].col,g=d[d.length-1].col,m=h._getSpanModel(),_=this.maxCellOverflowDistance,y=h.getColumnCount(),C=g,w=1;w<_;w++){if((u=C+w)>=y||m.find(t,u))return n;if(i=p.getValue(t,u),(a=p.getZoomColWidth(u))>0&&i!==n&&typeof i!==l){if(3===(s=(r=p.getActualStyle(t,u)).hAlign)&&(s=e.util.getHAlignByValueType(s,i)),(2===s||1===s)&&r&&(o=e._CacheMgr.getFormattedTextByStyle(h,r,i)),2===s){if((c=this._buildCellOverflowLayoutModelForRight({data:i,style:r,width:a,text:o},t,u,f))&&c.startColumn<=g)return c}else if((c=this._buildCellOverflowLayoutModelForCenter({data:i,style:r,width:a,text:o},t,u,f,g))&&c.startColumn<=g)return c;return n}}},t}(),e._CellOverflowLayoutBuilder=t,o=function(){function t(e){this._needPaintIndicator=!1,this._eventNS=".cutCopyIndicator",this._isPastedInternal=!1,this._ch=n,this._sheet=e,this._bindEvents()}return t.prototype.isPastedInternal=function(e){if(0===arguments.length)return this._isPastedInternal;"boolean"==typeof e&&(this._isPastedInternal=e)},t.prototype.needPaintIndicator=function(e){var t;if(0===arguments.length)return this._needPaintIndicator;if("boolean"==typeof e){if(this._needPaintIndicator===e&&!1===e)return this;this._needPaintIndicator=e,(t=this._sheet)&&t.invalidate()}return this},t.prototype.getClipboardHelper=function(){var e=this._sheet;return e&&!this._ch&&(this._ch=e._getClipboardHelper()),this._ch},t.prototype._bindEvents=function(){var t=this,o=t._sheet,n=!1;o&&(o._bind(e.Events.ClipboardChanged+t._eventNS,function(e,o){t.needPaintIndicator(!0)}),o._bind(e.Events.ValueChanged+t._eventNS,function(e,o){t.needPaintIndicator(!1)}),o._eventHandler.bind(e.Events.CellChanged+t._eventNS,function(e,o){t.needPaintIndicator(!1)}),o._bind(e.Events.ColumnChanged+t._eventNS,function(e,o){"resizable"!==o.propertyName&&"width"!==o.propertyName&&"isVisible"!==o.propertyName&&t.needPaintIndicator(!1)}),o._bind(e.Events.RowChanged+t._eventNS,function(e,o){"resizable"!==o.propertyName&&"height"!==o.propertyName&&"isVisible"!==o.propertyName&&t.needPaintIndicator(!1)}),o._bind(e.Events.RangeChanged+t._eventNS,function(e,o){t.needPaintIndicator(!1)}),o._bind(e.Events.ClipboardPasting+t._eventNS,function(e,o){n=t.needPaintIndicator()}),o._bind(e.Events.ClipboardPasted+t._eventNS,function(e,o){var r=o.cellRange,i=o.sheet,a=t.getClipboardHelper();r&&a&&a.range&&a.fromSheet&&i&&(a.range.intersect(r.row,r.col,r.rowCount,r.colCount)||!t.isPastedInternal()?t.needPaintIndicator(!1):t.needPaintIndicator(n))}))},t.prototype.paintCutCopyIndicator=function(t,o,n,r){var i,a;if(this._needPaintIndicator){var s=this._sheet,l=s._render,u=this.getClipboardHelper(),c=s.parent;if((!c||!c.cutCopyIndicatorVisible||c.cutCopyIndicatorVisible())&&u&&u.fromSheet===s&&u.range){var h=s._getSheetLayout().viewportRect(n,r),p=l._getPaintingRects(n,r,[u.range],o)[0];p&&h&&(t.save(),t.rect(h.x,h.y,h.width,h.height),t.clip(),p&&(i=c&&c.cutCopyIndicatorBorderColor?c.cutCopyIndicatorBorderColor():"blue",a=e._ThemeContext.getColor(s,i),l.paintDashRect(t,p,a)),t.beginPath(),t.restore())}}},t.prototype.addRows=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},t.prototype.deleteRows=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},t.prototype.addColumns=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},t.prototype.deleteColumns=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},t.prototype.cancelIndicator=function(){this._needPaintIndicator&&this.needPaintIndicator(!1)},t.prototype._dispose=function(){var t=this._sheet,o=this._eventNS;t._eventHandler.unbind(e.Events.CellChanged+o),t._unbind(e.Events.ClipboardChanged+o),t._unbind(e.Events.ValueChanged+o),t._unbind(e.Events.CellChanged+o),t._unbind(e.Events.ColumnChanged+o),t._unbind(e.Events.RowChanged+o),t._unbind(e.Events.RangeChanged+o),t._unbind(e.Events.ClipboardPasting+o),t._unbind(e.Events.ClipboardPasted+o)},t}(),e.CutCopyIndicatorManager=o}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){var t,o;e.feature("core.sheet_ui",["core.common"]);var n=void 0,r="backColor",i="foreColor",a="hAlign",s="vAlign",l="themeFont",u="font",c="formatter",h="borderLeft",p="borderTop",d="borderRight",f="borderBottom",g="locked",m="textIndent",_="wordWrap",y="shrinkToFit",C="backgroundImage",w="backgroundImageLayout",v="validator",S="cellType",x="tabStop",R="textDecoration",b="imeMode",T="watermark",A=function(){function t(e,t,o,r){this.sheet=e,this.row=t,this.row2=t,this.col=o,this.col2=o,(r===n||null===r)&&(r=3),this.sheetArea=r}return t.prototype.value=function(e){var t,o,n=this;if(0===arguments.length)return n.sheet.getValue(n.row,n.col,n.sheetArea);for(t=n.row;t<=n.row2;t++)for(o=n.col;o<=n.col2;o++)n._isValidIndex(t,o)&&n.sheet.setValue(t,o,e,n.sheetArea);return n},t.prototype.text=function(e){var t,o,n=this;if(0===arguments.length)return n.sheet.getText(n.row,n.col,n.sheetArea);for(t=n.row;t<=n.row2;t++)for(o=n.col;o<=n.col2;o++)n._isValidIndex(t,o)&&n.sheet.setText(t,o,e,n.sheetArea);return n},t.prototype.formula=function(e){var t,o,n=this;if(0===arguments.length)return n.sheet.getFormula(n.row,n.col,n.sheetArea);for(t=n.row;t<=n.row2;t++)for(o=n.col;o<=n.col2;o++)n._isValidIndex(t,o)&&n.sheet.setFormula(t,o,e,n.sheetArea);return n},t.prototype.bindingPath=function(e){var t,o,n=this;if(0===arguments.length)return n.sheet.getBindingPath(n.row,n.col,n.sheetArea);for(t=n.row;t<=n.row2;t++)for(o=n.col;o<=n.col2;o++)n._isValidIndex(t,o)&&n.sheet.setBindingPath(t,o,e,n.sheetArea);return n},t.prototype.comment=function(e){var t,o,n=this;if(0===arguments.length)return n.sheet.getComment(n.row,n.col);for(t=n.row;t<=n.row2;t++)for(o=n.col;o<=n.col2;o++)n._isValidIndex(t,o)&&n.sheet.setComment(t,o,e);return n},t.prototype.tag=function(e){var t,o,n=this;if(0===arguments.length)return n.sheet.getTag(n.row,n.col,n.sheetArea);for(t=n.row;t<=n.row2;t++)for(o=n.col;o<=n.col2;o++)n._isValidIndex(t,o)&&n.sheet.setTag(t,o,e,n.sheetArea);return n},t.prototype.dataValidator=function(e){return 0==arguments.length?this._getStyleProperty(v):this._setStyleProperty(v,e)},t.prototype.cellType=function(e){return 0==arguments.length?this._getStyleProperty(S):this._setStyleProperty(S,e)},t.prototype.backgroundImage=function(e){return 0==arguments.length?this._getStyleProperty(C):this._setStyleProperty(C,e)},t.prototype.backgroundImageLayout=function(e){return 0==arguments.length?this._getStyleProperty(w):this._setStyleProperty(w,e)},t.prototype.backColor=function(e){return 0===arguments.length?this._getStyleProperty(r):this._setStyleProperty(r,e)},t.prototype.foreColor=function(e){return 0===arguments.length?this._getStyleProperty(i):this._setStyleProperty(i,e)},t.prototype.hAlign=function(e){return 0===arguments.length?this._getStyleProperty(a):this._setStyleProperty(a,e)},t.prototype.vAlign=function(e){return 0===arguments.length?this._getStyleProperty(s):this._setStyleProperty(s,e)},t.prototype.themeFont=function(e){return 0===arguments.length?this._getStyleProperty(l):this._setStyleProperty(l,e)},t.prototype.font=function(e){return 0===arguments.length?this._getStyleProperty(u):this._setStyleProperty(u,e)},t.prototype.formatter=function(e){return 0===arguments.length?this._getStyleProperty(c):this._setStyleProperty(c,e)},t.prototype.borderLeft=function(e){return 0===arguments.length?this._getStyleProperty(h):this._setStyleProperty(h,e)},t.prototype.borderTop=function(e){return 0===arguments.length?this._getStyleProperty(p):this._setStyleProperty(p,e)},t.prototype.borderRight=function(e){return 0===arguments.length?this._getStyleProperty(d):this._setStyleProperty(d,e)},t.prototype.borderBottom=function(e){return 0===arguments.length?this._getStyleProperty(f):this._setStyleProperty(f,e)},t.prototype.locked=function(e){return 0===arguments.length?this._getStyleProperty(g):this._setStyleProperty(g,e)},t.prototype.textIndent=function(e){return 0===arguments.length?this._getStyleProperty(m):this._setStyleProperty(m,e)},t.prototype.wordWrap=function(e){return 0===arguments.length?this._getStyleProperty(_):this._setStyleProperty(_,e)},t.prototype.shrinkToFit=function(e){return 0===arguments.length?this._getStyleProperty(y):this._setStyleProperty(y,e)},t.prototype.tabStop=function(e){return 0===arguments.length?this._getStyleProperty(x):this._setStyleProperty(x,e)},t.prototype.textDecoration=function(e){return 0===arguments.length?this._getStyleProperty(R):this._setStyleProperty(R,e)},t.prototype.watermark=function(e){return 0===arguments.length?this._getStyleProperty(T):this._setStyleProperty(T,e)},t.prototype.imeMode=function(e){return 0===arguments.length?this._getStyleProperty(b):this._setStyleProperty(b,e)},t.prototype.clearStyleProperty=function(e){for(var t,o,n=this.row;n<=this.row2;n++)for(t=this.col;t<=this.col2;t++)this._isValidIndex(n,t)&&((o=this.sheet.getStyleImp(n,t,this.sheetArea))&&o.clear(e))},t.prototype._getStyleProperty=function(e){return this.sheet.getStyleProperty(this.row,this.col,e,this.sheetArea)},t.prototype._setStyleProperty=function(t,o){for(var n,r,i=this,a=i.row;a<=i.row2;a++)for(n=i.col;n<=i.col2;n++)i._isValidIndex(a,n)&&((r=i.sheet.getStyleImp(a,n,i.sheetArea))||(r=new e.Style),r[t]=o,i.sheet.setStyle(a,n,r,i.sheetArea));return i},t.prototype._isValidIndex=function(e,t){var o,n,r=this.sheet,i=this.sheetArea;return!!(r&&(o=r.getRowCount(i),n=r.getColumnCount(i),0<=e&&e<o&&0<=t&&t<n))},t}();e.Cell=A,t=function(){function t(e,t,o){this.sheet=e,this.index=t,this.index2=t,(o===n||null===o)&&(o=3),this.sheetArea=o}return t.prototype.height=function(e){var t;if(0===arguments.length)return this.sheet.getRowHeight(this.index,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setRowHeight(t,e,this.sheetArea);return this},t.prototype.visible=function(e){var t;if(0===arguments.length)return this.sheet.getRowVisible(this.index,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setRowVisible(t,e,this.sheetArea);return this},t.prototype.resizable=function(e){var t;if(0===arguments.length)return this.sheet.getRowResizable(this.index,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setRowResizable(t,e,this.sheetArea);return this},t.prototype.dataValidator=function(e){return 0==arguments.length?this._getStyleProperty(v):this._setStyleProperty(v,e)},t.prototype.cellType=function(e){return 0==arguments.length?this._getStyleProperty(S):this._setStyleProperty(S,e)},t.prototype.backgroundImage=function(e){return 0==arguments.length?this._getStyleProperty(C):this._setStyleProperty(C,e)},t.prototype.backgroundImageLayout=function(e){return 0==arguments.length?this._getStyleProperty(w):this._setStyleProperty(w,e)},t.prototype.backColor=function(e){return 0===arguments.length?this._getStyleProperty(r):this._setStyleProperty(r,e)},t.prototype.foreColor=function(e){return 0===arguments.length?this._getStyleProperty(i):this._setStyleProperty(i,e)},t.prototype.hAlign=function(e){return 0===arguments.length?this._getStyleProperty(a):this._setStyleProperty(a,e)},t.prototype.vAlign=function(e){return 0===arguments.length?this._getStyleProperty(s):this._setStyleProperty(s,e)},t.prototype.themeFont=function(e){return 0===arguments.length?this._getStyleProperty(l):this._setStyleProperty(l,e)},t.prototype.font=function(e){return 0===arguments.length?this._getStyleProperty(u):this._setStyleProperty(u,e)},t.prototype.formatter=function(e){return 0===arguments.length?this._getStyleProperty(c):this._setStyleProperty(c,e)},t.prototype.borderLeft=function(e){return 0===arguments.length?this._getStyleProperty(h):this._setStyleProperty(h,e)},t.prototype.borderTop=function(e){return 0===arguments.length?this._getStyleProperty(p):this._setStyleProperty(p,e)},t.prototype.borderRight=function(e){return 0===arguments.length?this._getStyleProperty(d):this._setStyleProperty(d,e)},t.prototype.borderBottom=function(e){return 0===arguments.length?this._getStyleProperty(f):this._setStyleProperty(f,e)},t.prototype.locked=function(e){return 0===arguments.length?this._getStyleProperty(g):this._setStyleProperty(g,e)},t.prototype.textIndent=function(e){return 0===arguments.length?this._getStyleProperty(m):this._setStyleProperty(m,e)},t.prototype.wordWrap=function(e){return 0===arguments.length?this._getStyleProperty(_):this._setStyleProperty(_,e)},t.prototype.shrinkToFit=function(e){return 0===arguments.length?this._getStyleProperty(y):this._setStyleProperty(y,e)},t.prototype.tabStop=function(e){return 0===arguments.length?this._getStyleProperty(x):this._setStyleProperty(x,e)},t.prototype.textDecoration=function(e){return 0===arguments.length?this._getStyleProperty(R):this._setStyleProperty(R,e)},t.prototype.imeMode=function(e){return 0===arguments.length?this._getStyleProperty(b):this._setStyleProperty(b,e)},t.prototype.watermark=function(e){return 0===arguments.length?this._getStyleProperty(T):this._setStyleProperty(T,e)},t.prototype.clearStyleProperty=function(e){for(var t,o,n=this.sheet,r=this.index;r<=this.index2;r++)this._isValidIndex(r)&&((t=n.getStyleImp(r,-1,this.sheetArea))&&(o=t[e],t.clear(e),n.triggerRowChanged({sheet:n,sheetName:n._name,row:r,sheetArea:this.sheetArea,propertyName:e,oldValue:o})))},t.prototype.tag=function(e){var t;if(0===arguments.length)return this.sheet.getTag(this.index,-1,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setTag(t,-1,e,this.sheetArea);return this},t.prototype._getStyleProperty=function(e){var t=this.sheet.getStyleImp(this.index,-1,this.sheetArea);return t?t[e]:n},t.prototype._setStyleProperty=function(t,o){for(var n,r=this.index;r<=this.index2;r++)this._isValidIndex(r)&&((n=this.sheet.getStyleImp(r,-1,this.sheetArea))||(n=new e.Style),n[t]=o,this.sheet.setStyle(r,-1,n,this.sheetArea));return this},t.prototype._isValidIndex=function(e){if(this.sheet){var t=this.sheet.getRowCount(this.sheetArea);if(0<=e&&e<t)return!0}return!1},t}(),e.Row=t,o=function(){function t(e,t,o){this.sheet=e,this.index=t,this.index2=t,(o===n||null===o)&&(o=3),this.sheetArea=o}return t.prototype.width=function(e){var t;if(0===arguments.length)return this.sheet.getColumnWidth(this.index,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setColumnWidth(t,e,this.sheetArea);return this},t.prototype.visible=function(e){var t;if(0===arguments.length)return this.sheet.getColumnVisible(this.index,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setColumnVisible(t,e,this.sheetArea);return this},t.prototype.resizable=function(e){var t;if(0===arguments.length)return this.sheet.getColumnResizable(this.index,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setColumnResizable(t,e,this.sheetArea);return this},t.prototype.dataValidator=function(e){return 0==arguments.length?this._getStyleProperty(v):this._setStyleProperty(v,e)},t.prototype.cellType=function(e){return 0==arguments.length?this._getStyleProperty(S):this._setStyleProperty(S,e)},t.prototype.backgroundImage=function(e){return 0==arguments.length?this._getStyleProperty(C):this._setStyleProperty(C,e)},t.prototype.backgroundImageLayout=function(e){return 0==arguments.length?this._getStyleProperty(w):this._setStyleProperty(w,e)},t.prototype.backColor=function(e){return 0===arguments.length?this._getStyleProperty(r):this._setStyleProperty(r,e)},t.prototype.foreColor=function(e){return 0===arguments.length?this._getStyleProperty(i):this._setStyleProperty(i,e)},t.prototype.hAlign=function(e){return 0===arguments.length?this._getStyleProperty(a):this._setStyleProperty(a,e)},t.prototype.vAlign=function(e){return 0===arguments.length?this._getStyleProperty(s):this._setStyleProperty(s,e)},t.prototype.themeFont=function(e){return 0===arguments.length?this._getStyleProperty(l):this._setStyleProperty(l,e)},t.prototype.font=function(e){return 0===arguments.length?this._getStyleProperty(u):this._setStyleProperty(u,e)},t.prototype.formatter=function(e){return 0===arguments.length?this._getStyleProperty(c):this._setStyleProperty(c,e)},t.prototype.borderLeft=function(e){return 0===arguments.length?this._getStyleProperty(h):this._setStyleProperty(h,e)},t.prototype.borderTop=function(e){return 0===arguments.length?this._getStyleProperty(p):this._setStyleProperty(p,e)},t.prototype.borderRight=function(e){return 0===arguments.length?this._getStyleProperty(d):this._setStyleProperty(d,e)},t.prototype.borderBottom=function(e){return 0===arguments.length?this._getStyleProperty(f):this._setStyleProperty(f,e)},t.prototype.locked=function(e){return 0===arguments.length?this._getStyleProperty(g):this._setStyleProperty(g,e)},t.prototype.textIndent=function(e){return 0===arguments.length?this._getStyleProperty(m):this._setStyleProperty(m,e)},t.prototype.wordWrap=function(e){return 0===arguments.length?this._getStyleProperty(_):this._setStyleProperty(_,e)},t.prototype.shrinkToFit=function(e){return 0===arguments.length?this._getStyleProperty(y):this._setStyleProperty(y,e)},t.prototype.tabStop=function(e){return 0===arguments.length?this._getStyleProperty(x):this._setStyleProperty(x,e)},t.prototype.textDecoration=function(e){return 0===arguments.length?this._getStyleProperty(R):this._setStyleProperty(R,e)},t.prototype.imeMode=function(e){return 0===arguments.length?this._getStyleProperty(b):this._setStyleProperty(b,e)},t.prototype.watermark=function(e){return 0===arguments.length?this._getStyleProperty(T):this._setStyleProperty(T,e)},t.prototype.clearStyleProperty=function(e){for(var t,o,n=this.sheet,r=this.index;r<=this.index2;r++)this._isValidIndex(r)&&((t=n.getStyleImp(-1,r,this.sheetArea))&&(o=t[e],t.clear(e),n.triggerColumnChanged({sheet:n,sheetName:n._name,col:r,sheetArea:this.sheetArea,propertyName:e,oldValue:o})))},t.prototype.tag=function(e){var t;if(0===arguments.length)return this.sheet.getTag(-1,this.index,this.sheetArea);for(t=this.index;t<=this.index2;t++)this._isValidIndex(t)&&this.sheet.setTag(-1,t,e,this.sheetArea);return this},t.prototype._getStyleProperty=function(e){var t=this.sheet.getStyleImp(-1,this.index,this.sheetArea);return t?t[e]:n},t.prototype._setStyleProperty=function(t,o){for(var n,r=this.index;r<=this.index2;r++)this._isValidIndex(r)&&((n=this.sheet.getStyleImp(-1,r,this.sheetArea))||(n=new e.Style),n[t]=o,this.sheet.setStyle(-1,r,n,this.sheetArea));return this},t.prototype._isValidIndex=function(e){if(this.sheet){var t=this.sheet.getColumnCount(this.sheetArea);if(0<=e&&e<t)return!0}return!1},t}(),e.Column=o}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){function o(e,o,n,r){throw new Error(t._StringHelper.format(t.SR.Exp_InvalidAndSpace,[e,o,n,r]))}function n(e,t,o){for(var n in S)S[n]&&(e=e.replace(S[n],S[n].source));return!0===t?(e=(e=(e=e.replace(/~\?/g,x.source)).replace(/~\*/g,R.source)).replace(/\?/g,"."),e=(e=(e=o?e.replace(/\*/g,"((.|\\n)+)"):e.replace(/\*/g,"((.|\\n)*)")).replace(x,"\\?")).replace(R,"\\*")):e=(e=e.replace(/\?/g,"\\?")).replace(/\*/g,"\\*"),e}var r;t.feature("core.sheet",["core.common","core.stringResource","core.sheet_event","core.sheet_render","core.basecelltype","core.sheet_ui","core.sheet_model","core.sheet_action","core.sheet_border"]);var i=null,a=void 0,s=Math.min,l=Math.max,u=Math.floor,c=Math.abs,h=Math.round,p=Math.ceil,d="undefined",f="function",g="number",m="string",_="boolean",y=window.document,C=window.ko,w=function(){function o(e,n){this.disposed=!1,this._styleComposeCache=[{},{},{},{}],this._isDisposingValidationUI=!1;var r=this;r._name="",r._id=o.sheetId++,r._visible=!0,r.defaults=i,r.gridline=i,r.borderColor="black",r.borderWidth=0,r._zoomFactor=1,r.frozenRowCount=0,r.frozenColCount=0,r.rowHeaderVisible=!0,r.colHeaderVisible=!0,r.rowHeaderAutoText=1,r.colHeaderAutoText=2,r.rowHeaderAutoTextIndex=-1,r.colHeaderAutoTextIndex=-1,r.rowRangeGroup=i,r.colRangeGroup=i,r._activeRowIndex=0,r._activeColIndex=0,r.activeRowViewportIndex=0,r.activeColViewportIndex=0,r._allowCellOverflow=!1,r.maxCellOverflowDistance=100,r.showEditingLocator=!0,r.keyMap=i,r.isProtected=!1,r._allowUndo=!0,r._paintSuspended=!1,r._layoutSuspended=0,r.checkingChanges=!1,r.autoGenerateColumns=!0,r._allowEditorReservedLocations=!0,r._sheetTabColor=i,r._frozenlineColor="black",r._frozenTrailingRowCount=0,r._frozenTrailingColCount=0,r._rowLayoutCache=i,r._colLayoutCache=i,r._dragRect=i,r._scrollTopRow=0,r._scrollLeftCol=0,r.floatingObjectKeyMap=i,r._slicerKeyMap=i,r._commentKeyMap=i,r._cachePool=new t._CachePool(this),r._composedDefaultStyle={},r._defaultRowCount=200,r._defaultColCount=20,r._defaultRowHeaderColumnCount=1,r._defaultColHeaderRowCount=1,r._defaultRowHeight=20,r._defaultColWidth=62,r._defaultRowHeaderColWidth=40,r._defaultColHeaderRowHeight=20,r._defaultShowVerticalGridline=!0,r._defaultShowHorizontalGridline=!0,r.fontHeightCache=i,r._enableFormulaTextbox=!0,r._tag=null,n||r._init(e),r._initializeActiveCell()}return o.prototype._addFloatingOjectInternal=function(e){var o,n=this._floatingObjectArray;if(n&&t.features.floatingObject)try{o=this.isPaintSuspended(),this.isPaintSuspended(!0),n.add(e)}finally{this.isPaintSuspended(o)}},o.prototype._findFloatingObjectInternal=function(e){var o=this._floatingObjectArray;return t.features.floatingObject&&o&&o.length>0?o.find(e):i},o.prototype._removeFloatingObjectInternal=function(e){var o,n,r=this._floatingObjectArray;return!!(t.features.floatingObject&&r&&r.length&&(o=r.find(e),o&&(n={sheet:this,sheetName:this._name,floatingObject:o,cancel:!1},this.triggerFloatingObjectRemoving(n),n&&!1===n.cancel)))&&(r.remove(o),this.triggerFloatingObjectRemoved({sheet:this,sheetName:this._name,floatingObject:o}),!0)},o.prototype._saveAndClearSheetSelections=function(){var e,o,n,r=this._selectionModel;if(r&&r.length>0){for(e=new t._SelectionModel,this._selectionModelCache=e,e.selectionPolicy=r.selectionPolicy,e.selectionUnit=r.selectionUnit,e.activeSelectedRangeIndex=r.activeSelectedRangeIndex,o=0,n=r.length;o<n;o++)e.push(r[o]);for(this._clearSelectionImp(),o=0,n=e.length;o<n;o++)this._render.repaintSelection(e[o])}},o.prototype._loadAndSetSheetSelections=function(){var e,o,n,r=this._selectionModelCache;if(r)for(e=new t._SelectionModel,this._selectionModel=e,e.selectionPolicy=r.selectionPolicy,e.selectionUnit=r.selectionUnit,e.activeSelectedRangeIndex=r.activeSelectedRangeIndex,o=0,n=r.length;o<n;o++)e.push(r[o])},o.prototype.unSelectAllFloatingObjects=function(){var e,o=this._floatingObjectArray;if(t.features.floatingObject&&o&&o.length>0)for(e=0;e<o.length;e++)o[e].isSelected(!1)},o.prototype.refreshObjectsAboveSheet=function(){var e=this._floatingObjectArray;t.features.floatingObject&&e&&(e.isNeedToUpdateLayout=!0)},o.prototype.unSelectAllComments=function(){this._commentManager&&this._commentManager.deactivateComment()},o.prototype.addFloatingObject=function(e){this._floatingObjectArray&&t.features.floatingObject&&e instanceof t.CustomFloatingObject&&this._addFloatingOjectInternal(e)},o.prototype.findFloatingObject=function(e){if(!t.features.floatingObject)return i;var o=this._findFloatingObjectInternal(e);return o instanceof t.CustomFloatingObject?o:i},o.prototype.removeFloatingObject=function(e){var o,n;if(t.features.floatingObject){this;try{o=this.isPaintSuspended(),this.isPaintSuspended(!0),(n=this._findFloatingObjectInternal(e))instanceof t.CustomFloatingObject&&this._floatingObjectArray.remove(n)}finally{this.isPaintSuspended(o)}}},o.prototype.getFloatingObjects=function(){var e,o,n,r,i=[];if(!t.features.floatingObject)return i;for(o=0,n=(e=this._floatingObjectArray).length;o<n;o++)(r=e[o])instanceof t.CustomFloatingObject&&i.push(r);return i},o.prototype.addPicture=function(e,o,n,r,a,s,l,u,c,h){var p,f,g=this._floatingObjectArray;if(!g||!t.features.floatingObject)return i;try{return p=this.isPaintSuspended(),this.isPaintSuspended(!0),(f=new t.Picture(e)).owner(this),f.src(o),f.startRow(n),f.startColumn(r),f.endRow(a),f.endColumn(s),(typeof a===d||typeof s===d)&&(f._isTakeOriginalSize=!0),"number"==typeof l&&f.startRowOffset(l),"number"==typeof u&&f.startColumnOffset(u),"number"==typeof c&&f.endRowOffset(c),"number"==typeof h&&f.endColumnOffset(h),g.add(f),f}finally{this.isPaintSuspended(p)}},o.prototype.findPicture=function(e){if(!t.features.floatingObject)return i;var o=this._findFloatingObjectInternal(e);return o instanceof t.Picture?o:i},o.prototype.removePicture=function(e){var o,n;if(t.features.floatingObject){this;try{o=this.isPaintSuspended(),this.isPaintSuspended(!0),(n=this._findFloatingObjectInternal(e))instanceof t.Picture&&this._floatingObjectArray.remove(n)}finally{this.isPaintSuspended(o)}}},o.prototype.getPictures=function(){var e,o,n,r,i=[];if(!t.features.floatingObject)return i;for(o=0,n=(e=this._floatingObjectArray).length;o<n;o++)(r=e[o])instanceof t.Picture&&i.push(r);return i},o.prototype.setFloatingObjectZIndex=function(e,o){var n,r,i,a,s,l,u,c;if(!isNaN(o)&&t.features.floatingObject&&(r=(n=this._render)&&n._floatingObjectRenderManager))for(i=0,s=r.length;i<s;i++)if(u=r[i])for(a=0,l=u.length;a<l;a++)(c=u[a])&&c.setFloatingObjectZIndex(e,o)},o.prototype.getFloatingObjectZIndex=function(e){var o,n,r,i,a,s,l=this._render,u=l&&l._floatingObjectRenderManager;if(t.features.floatingObject&&u)for(o=0,r=u.length;o<r;o++)if(a=u[o])for(n=0,i=a.length;n<i;n++)if(s=a[n])return s.getFloatingObjectZIndex(e);return-1},o.prototype.getDataSource=function(){var e=this._bindingManager;return e?e.getSource():i},o.prototype.getBindingPath=function(e,t){var o=this._sheetModelManager.getDataModel(3);return o?o.getBindingPath(e,t):i},o.prototype.setBindingPath=function(e,t,o){var n=this;return n._bindToAutoRefresh(function(e,t,o){var r=n._getModel(3);return r&&r.setBindingPath(e,t,o),n})(e,t,o)},o.prototype.setDataSource=function(e,o){var n=this,r=n._bindingManager;r&&r.getSource()!==e&&n._bindToAutoRefresh(function(e,o){var i,a,s,l,u,c,h,p,d;if(o&&(n.resetImp(),n._initializeActiveCell()),r=n._bindingManager,e){if(r.bind(e),t._BindingManager.isCellBindingSource(e)){if(i=n._tableManager){for(i.resetTablesBindingManager(),a=i.getTables(),n.suspendCalcService(),s=0,l=a.length;s<l;s++)(u=a[s])&&u._applyBindingPath();n.resumeCalcService()}return void n.clearPendingChanges()}if(n._setRowCountInternal(r.getRowCount()),n.autoGenerateColumns&&(n.setColumnCount(r.getColumnCount()),c=n._sheetModelManager.getColInfos(),h=r.getFields()))for(p=0,d=h.length;p<d;p++)c._setItem(p,{name:h[p]});n.getCalcService()&&!n.getCalcService().IsSuspended()&&n.recalcAll()}else t._BindingManager.isCellBindingSource(r.getSource())&&((i=n._tableManager)&&i.resetTablesBindingManager()),n._bindingManager=new t._BindingManager(n),n.getCalcService()&&!n.getCalcService().IsSuspended()&&n.recalcAll();n.clearPendingChanges()})(e,o)},o.prototype.bindColumn=function(e,t){var o=this.isPaintSuspended();this.isPaintSuspended(!0);try{typeof t===m&&(t={name:t}),this._sheetModelManager.getColInfos()._setItem(e,t),t&&t.formatter&&this.setFormatter(-1,e,t.formatter),t&&t.cellType&&this.setCellType(-1,e,t.cellType)}finally{this.isPaintSuspended(o)}},o.prototype.bindColumns=function(e){var t,o,n,r=this.isPaintSuspended();this.isPaintSuspended(!0);try{if(e)for(t=this._sheetModelManager.getColInfos(),isNaN(e.length)||this.setColumnCount(e.length),o=0;o<e.length;o++)typeof(n=e[o])===m&&(n={name:n}),t._setItem(o,n),n&&n.formatter&&this.setFormatter(-1,o,n.formatter),n&&n.cellType&&this.setCellType(-1,o,n.cellType)}finally{this.isPaintSuspended(r)}},o.prototype.getDataItem=function(e){var t,o,n,r=this._bindingManager,a=this._sheetModelManager.getColInfos();if(!r||0===r.getRowCount())return i;var s=this.getColumnCount(),l={},u=r.getDataItem(e);if(u)for(t in u)u.hasOwnProperty(t)&&typeof t!==f&&(l[t]=u[t]);for(o=0;o<s;o++)(n=a._getItem(o))&&n.name&&n.name.length>0&&(l[n.name]=this.getValue(e,o));return l},o.prototype.getDirtyRows=function(){var e,t,o=[],n=this._sheetModelManager.dataModel().dirtyNodes;if(n)for(e in this._bindingManager,this.getDataSource(),n)t=n[e],n.hasOwnProperty(e)&&t&&"e"===t.rs&&o.push({row:+e,item:this.getDataItem(e),originalItem:t.originalItem});return o},o.prototype.getInsertRows=function(){var e,t=[],o=this._sheetModelManager.dataModel().dirtyNodes;if(o)for(e in o)o.hasOwnProperty(e)&&o[e]&&"n"===o[e].rs&&t.push({row:+e,item:this.getDataItem(e)});return t},o.prototype.getDirtyCells=function(e,o,n,r){var s,l,u,c,h,p,d,f,g,m,_,y;if((e===a||e===i)&&(e=-1),(o===a||o===i)&&(o=-1),(n===a||n<=0)&&(n=1),(r===a||r<=0)&&(r=1),s=[],l=this._sheetModelManager.dataModel().dirtyNodes,!t.GC$.isEmptyObject(l))if(e>=0&&o>=0){for(c=e;c<e+n;c++)if(l[c]&&"e"===l[c].rs)for(u=l[c],d=o;d<o+r;d++)u[d]&&s.push(this._getDirtyValue(c,d,u[d].oldValue))}else if(e>=0&&o<0){for(c=e;c<e+n;c++)if(l[c]&&"e"===l[c].rs)for(h in u=l[c])p=parseInt(h),!isNaN(p)&&u.hasOwnProperty(h)&&u[h]&&s.push(this._getDirtyValue(c,p,u[h].oldValue))}else if(e<0&&o>=0)for(d=o;d<o+r;d++)for(f in l)l[f]&&"e"===l[f].rs&&((u=l[f])[d]&&s.push(this._getDirtyValue(parseInt(f),d,u[d].oldValue)));else for(g in l)if(l[g]&&"e"===l[g].rs)for(m in u=l[g])_=parseInt(m),y=parseInt(g),!isNaN(_)&&u.hasOwnProperty(m)&&u[m]&&s.push(this._getDirtyValue(y,_,u[m].oldValue));return s},o.prototype._getDirtyValue=function(e,t,o){return{row:e,col:t,newValue:this.getValue(e,t),oldValue:o}},o.prototype.getDeleteRows=function(){var e=[];return this.deletedRows&&t.GC$.each(this.deletedRows,function(t,o){typeof o!==f&&o&&e.push({row:o.row,originalItem:o.data})}),e},o.prototype.hasPendingChanges=function(){var e;return!!(this.deletedRows&&this.deletedRows.length>0)||(e=this._sheetModelManager.dataModel().dirtyNodes,!t.GC$.isEmptyObject(e))},o.prototype.clearPendingChanges=function(){var e,t,o=this._sheetModelManager.dataModel().dirtyNodes;for(e in o)(t=o[e])&&t.rs&&delete t.rs;this._sheetModelManager.dataModel().dirtyNodes={},this.deletedRows=[]},o.prototype._getProperties=function(e){var t,o=[];if(e)for(t in e)typeof e[t]!==f?o.push(t):typeof C!==d&&C.isObservable(e[t])&&o.push(t);return o},o.prototype.referenceStyle=function(e){t.ReferenceStyle;var o=this.getCalcService();return 0===arguments.length?o&&o.useR1C1?1:0:(o&&(o.useR1C1=1===e),this)},o.prototype.recalcAll=function(){var e,t=this.getCalcService();t&&(e=this.isPaintSuspended(),this.isPaintSuspended(!0),t.recalculateAll(!0),this.isPaintSuspended(e))},o.prototype.recalcRange=function(e,t,o,n){var r=this.getCalcService();r&&r.recalcRange(this._getSheetSource(),e,t,o,n)},o.prototype.recalcRows=function(e){var t,o=this.getCalcService();if(o&&!o.ignoreDirty()){for(o.suspend(),t=0;t<e.length;t++)o.recalculate(this._vpSheetSource,e[t],-1);o.resume(!1)}},o.prototype._recalcCell=function(e,t,o){var n=this.getCalcService();n&&!n.ignoreDirty()&&n.recalculate(this._vpSheetSource,t,o)},o.prototype.getCalcService=function(){return!this.calcService&&t.util.hasCalc()&&(this.calcService=new t.Calc.CalcService,this._getSheetSource().setCalcService(this.calcService),this.calcService.initParserContext(this._getSheetSource())),this.calcService},o.prototype._getCalcContexts=function(){var e=[],t=this._getModel();return e.push({name:this._name,target:this,refModel:t}),e},o.prototype.suspendCalcService=function(e){this.getCalcService()&&this.getCalcService().suspend(e)},o.prototype.resumeCalcService=function(e){this.getCalcService()&&this.getCalcService().resume(e)},o.prototype._getSheetSource=function(e){return e===a||e===i||3===e?this._vpSheetSource:i},o.prototype.getCustomFunction=function(e){return this._functions&&e&&""!==e?this._functions[e.toUpperCase()]:i},o.prototype.addCustomFunction=function(e){this._addCustomFunctionCore(e),this.recalcAll()},o.prototype._addCustomFunctionCore=function(e){if(t.util.hasCalc()){if(!(e&&e instanceof t.Calc.Functions.Function))throw new Error(t.SR.Exp_InvalidCustomFunction);var o=e.name.toUpperCase();this._functions||(this._functions={}),this._functions[o]=e}},o.prototype.removeCustomFunction=function(e){this._functions&&e&&""!==e&&(e=e.toUpperCase(),this._functions.hasOwnProperty(e)&&(delete this._functions[e],this.recalcAll()))},o.prototype.clearCustomFunctions=function(){this._functions&&(delete this._functions,this.recalcAll())},o.prototype._findCustomFunction=function(e){if(!e||""===e)return i;var t=this.parent,o=this.getCustomFunction(e);return!o&&t&&t.getCustomFunction&&(o=t.getCustomFunction(e)),o},o.prototype.addCustomFunctionDescription=function(e){if(e&&e.name&&!this.getCustomFunctionDescription(e.name)){var t=this._functionDescriptions;t||(t=this._functionDescriptions=[]),t.push(e)}},o.prototype.getCustomFunctionDescription=function(e){var t,o,n,r=this._functionDescriptions;if(r&&e)for(e=e.toUpperCase(),t=r.length,n=0;n<t;n++)if((o=r[n]).name&&o.name.toUpperCase()===e)return o;return i},o.prototype.removeCustomFunctionDescription=function(e){var t,o,n,r=this._functionDescriptions;if(r&&e)for(e=e.toUpperCase(),t=r.length,n=0;n<t;n++)if((o=r[n]).name&&o.name.toUpperCase()===e){r.splice(n,1);break}},o.prototype.clearCustomFunctionDescriptions=function(){this._functionDescriptions&&(this._functionDescriptions=i)},o.prototype.getCustomName=function(e){var t=this._names;return t?t[e.toUpperCase()]:i},o.prototype.getCustomNames=function(){var e=[],o=this._names;return o&&t.GC$.each(o,function(t,o){e.push(o)}),e},o.prototype.addCustomName=function(e,t,o,n){this._addCustomNameCore(e,t,o,n,!1)},o.prototype._addCustomNameCore=function(e,o,n,r,i){var a,s,l;if(!e||""===e||!o||""===o)throw new Error(t.SR.Exp_InvalidCustomName);this._names||(this._names={});var u=this.getCalcService(),c=this._getSheetSource(),h=this._getCalcModel();if(u&&c){if(i)try{a=u.parse(c,o,n,r,!1,!0)}catch(e){}else a=u.parse(c,o,n,r);s=e.toUpperCase(),this._names[s]=new t.NameInfo(e,a,n,r),(l=h._getNameCalc(s,!0))&&(l.updateListening(!0,!0),l.addToDirty()),this.recalcAll()}},o.prototype.removeCustomName=function(e){var t,o,n;this._names&&e&&""!==e&&(t=e.toUpperCase(),this._names[t]&&(delete this._names[t],(o=this._getCalcModel())&&((n=o._getNameCalc(t))&&(n.updateListening(!0,!1),n.addToDirty())),this.recalcAll()))},o.prototype.clearCustomNames=function(){var e,t,o,n;if(this._names){if(e=this._names,delete this._names,t=this._getCalcModel())for(o in e)(n=t._getNameCalc(o))&&(n.updateListening(!0,!1),n.addToDirty());this.recalcAll()}},o.prototype._findCustomName=function(e){if(!e||""===e)return i;var t=this.parent,o=this.getCustomName(e);return!o&&t&&t.getCustomName&&(o=t.getCustomName(e)),o},o.prototype.setFormula=function(e,t,o){this._setFormulaCore(e,t,o,!1)},o.prototype._setFormulaCore=function(e,o,n,r,s){var l,u,c,h,p,d=this;if(1!==s&&2!==s){if((s===a||s===i)&&(s=3),t.Events,e<0||e>=d.getRowCount()||o<0||o>=d.getColumnCount())return void d._raiseInvalidOperation(0,t.SR.Exp_IndexOutOfRange);if(l=d._tableManager,3===s&&e>=0&&o>=0&&l&&(u=l.find(e,o))){if(u.showHeader()&&e===u.headerIndex()&&n)return;u.showFooter()&&e===u.footerIndex()&&u._setFooterFormula(o,n)}c=d._getCalcModel(),h=d._conditionalFormats,c&&(p=c.getFormula(e,o),c.setFormula(e,o,n,r),h&&h._clearCache(),d._eventHandler._eventSuspended<1&&d._raiseCellChanged("formula",e,o,p,n,s)),d._paintSuspended||(d.invalidateLayout(),d.repaint())}},o.prototype.setArrayFormula=function(e,t,o,n,r){this._setArrayFormulaCore(e,t,o,n,r,!1)},o.prototype._setArrayFormulaCore=function(e,o,n,r,s,l,u){var c=this;c._bindToAutoRefresh(function(e,o,n,r,s,u){var h,p,d,f,g,m,_;if(1!==u&&2!==u){if((u===a||u===i)&&(u=3),t.Events,e<0||e+n>c.getRowCount()||o<0||o+r>c.getColumnCount())return void c._raiseInvalidOperation(0,t.SR.Exp_IndexOutOfRange);if(c._hasSpans(e,o,n,r))return void c._raiseInvalidOperation(0,t.SR.Exp_ArrayFromulaSpan);if(h=c._tableManager,3===u&&e>=0&&o>=0&&h&&(p=h.find(e,o))){if(n>1||r>1)return void c._raiseInvalidOperation(0,t.SR.Exp_ArrayFormulaTable);if(p.showHeader()&&e===p.headerIndex()&&s)return;p.showFooter()&&e===p.footerIndex()&&p._setFooterFormula(o,s)}if(d=c._getCalcModel(),f=c._conditionalFormats,d&&(c.suspendEvent(),d.setArrayFormula(e,o,n,r,s,l),c.resumeEvent(),f&&f._clearCache(),c._eventHandler._eventSuspended<1)){for(g=[],m=e;m<e+n;m++)for(_=o;_<o+r;_++)g.push(new t.CellPosition(m,_));c._raiseRangeDataChanged(e,o,n,r,g,5)}}})(e,o,n,r,s,u)},o.prototype.getFormula=function(e,t){var o=this._getCalcModel();return o?o.getFormula(e,t):i},o.prototype.getFormulaInformation=function(e,o){var n,r,i=new t.FormulaInformation,a=this._getCalcModel(3);return a&&((n=a.getExpr(e,o))&&(r=a.getArray(e,o),i.hasFormula=!0,r&&(i.baseRange=new t.Range(r.row,r.col,r.rowCount,r.colCount)),i.isArrayFormula=!!r,e=r?r.row:e,o=r?r.col:o,i.formula=this.calcService.unparse(this._vpSheetSource,n,e,o),i.hasFormula=!!i.formula)),i},o.prototype.hasFormula=function(e,t){var o=this._getCalcModel();return!!o&&o.hasFormula(e,t)},o.prototype._findFormulas=function(e,t,o,n){},o.prototype._rebuildCalcNodes=function(){var e,t,o=this._getCalcModel();if(o)for(var n=0,r=o.rC(),i=o.cC();n<r;){for(e=0;e<i;)(t=o._getCellCalc(n,e))&&(t.stopListening(),t.startListening()),e++;n++}},o.prototype._setValueToDataTable=function(e,t,o,n){var r,i=e[t];i||(i=e[t]={}),(r=i[o])||(r=i[o]={}),r.value=n},o.prototype._serializeSheetDataSource=function(e){var t,o,n;if(!this.getDataSource())return a;var r=this.getRowCount(),s=this.getColumnCount(),l=this._bindingManager;for(t=0;t<r;t++)for(o=0;o<s;o++)(n=l.getValue(t,o).value)!==i&&n!==a&&this._setValueToDataTable(e,t,o,n)},o.prototype._serializeColumnHeaderNames=function(e){var t,o,n,r;if(!this.getDataSource())return a;var i=this.getRowCount(1),s=this.getColumnCount(1),l=this._sheetModelManager.getColInfos()._getItems(),u=this.colHeaderAutoTextIndex;for(t=0;t<i;t++)if(u>=0&&t===u||-1===u&&t===i-1)for(o=0;o<s;o++)(n=l[o])&&((r=n.displayName||n.name)&&this._setValueToDataTable(e,t,o,r))},o.prototype._serializeTablesDataSource=function(e){for(var t,o,n,r=this.getTables(),s=0,l=r.length;s<l;s++){var u=r[s],c=u.getSource(),h=u.dataRange(),p=h.row,d=h.col,f=p+h.rowCount-1,g=d+h.colCount-1;if(c)for(t=p;t<=f;t++)for(o=d;o<=g;o++)(n=u._getValue(t,o).value)!==i&&n!==a&&this._setValueToDataTable(e,t,o,n)}},o.prototype.toJSON=function(e){var o,n,r,s,l,u,c,h,p,d,f,g,m=this,_=m._sheetModelManager,y=m._sparklineGroupManager,C=m._commentManager,w=m._conditionalFormats,v=m._tableManager,S=m._floatingObjectArray,x=m.rowRangeGroup,R=m.colRangeGroup,b=m._rowFilter,T=m._printInfo,A=m._slicerCollection,I={defaults:m.defaults,columns:m._toArray(_.getColInfos()._getItems(),m.getColumnCount()),rows:m._toArray(_.getRowInfos()._getItems(),m.getRowCount()),autoGenerateColumns:m.autoGenerateColumns,frozenRowCount:m.frozenRowCount,frozenColCount:m.frozenColCount,frozenTrailingRowCount:m._frozenTrailingRowCount,frozenTrailingColCount:m._frozenTrailingColCount,rowCount:m.getRowCount(),columnCount:m.getColumnCount(),sparklineGroups:y?y.toJSON():i,comments:C?C.toJSON():i,spans:m._getSpanModel().toJSON(),selectionBackColor:m._selectionBackColor,selectionBorderColor:m._selectionBorderColor,activeRow:m._activeRowIndex,activeCol:m._activeColIndex,gridline:m.gridline,allowCellOverflow:m._allowCellOverflow,referenceStyle:m.referenceStyle(),zoomFactor:m._zoomFactor,theme:m.currentTheme(),showRowRangeGroup:m._showRowRangeGroup,showColumnRangeGroup:m._showColumnRangeGroup,conditionalFormats:w?w.toJSON():i,sheetTabColor:m._sheetTabColor,frozenlineColor:m._frozenlineColor,rowHeaderAutoText:m.rowHeaderAutoText,colHeaderAutoText:m.colHeaderAutoText,rowHeaderAutoTextIndex:m.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:m.colHeaderAutoTextIndex,rowHeaderVisible:m.rowHeaderVisible,colHeaderVisible:m.colHeaderVisible,rowHeaderColCount:m.getColumnCount(2),colHeaderRowCount:m.getRowCount(1),rowHeaderSpan:m._getSpanModel(2).toJSON(),colHeaderSpan:m._getSpanModel(1).toJSON(),rowHeaderColInfos:m._toArray(_.getColInfos(2)._getItems(),m.getColumnCount(2)),colHeaderRowInfos:m._toArray(_.getRowInfos(1)._getItems(),m.getRowCount(1)),clipBoardOptions:m._clipBoardOptions,isProtected:m.isProtected,protectionOption:m._protectionOption,borderColor:m.borderColor,borderWidth:m.borderWidth,allowUndo:m._allowUndo,allowEditorReservedLocations:m._allowEditorReservedLocations,tables:v?v.toJSON():i,floatingObjects:S?S.toJSON():i,visible:m._visible,rowHeaderData:m._getModel(2).toJSON(2),colHeaderData:m._getModel(1).toJSON(1),data:m._getModel().toJSON(),rowRangeGroup:x?x.toJSON():a,colRangeGroup:R?R.toJSON():a,tag:m._tag,customFunctions:m._functions,printInfo:T?T.toJSON():a,slicers:A?A.toJSON():i};for(c in e&&e.includeBindingSource&&(o=I.data.dataTable||{},m._serializeSheetDataSource(o),m._serializeTablesDataSource(o),t.GC$.isEmptyObject(o)||(I.data.dataTable=o),n=I.colHeaderData.dataTable||{},m._serializeColumnHeaderNames(n),t.GC$.isEmptyObject(n)||(I.colHeaderData.dataTable=n)),r={name:m._name,selections:m._selectionModel.toJSON(),rowFilter:b?b.toJSON():a},I)s=I[c],m._isDefaultValue(c,s)||(r[c]=s);if(l=[],u=m._namedStyles)for(c in u)(h=u[c])&&l.push(h.toJSON());if(l.length>0&&(r.namedStyles=l),p=[],(d=m._names)&&m.getCalcService())for(f in d)if(m._names.hasOwnProperty(f)){var D=d[f],F=D.getName(),M=D.getRow(),E=D.getColumn(),N=D.getExpression(),O=m.getCalcService().unparseWithoutCulture(m._getSheetSource(),N,M,E,!0);p.push({name:F,formula:O,row:M,col:E})}return p.length>0&&(r.names=p),(g=m._vpCalcSheetModel)&&g.toJSON(r),r},o.prototype._isDefaultValue=function(e,o){switch(e){case"defaults":return o.rowHeight===this._defaultRowHeight&&o.colWidth===this._defaultColWidth&&o.rowHeaderColWidth===this._defaultRowHeaderColWidth&&o.colHeaderRowHeight===this._defaultColHeaderRowHeight;case"columns":case"rows":return!o||0===o.length;case"autoGenerateColumns":return!0===o;case"sparklineGroups":case"comments":return o===i;case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":return 0===o;case"gridline":return o.color===t.ThemeStyleHelper.getCssClassThemeStyle("gc-gridlineColor").borderTopColor&&o.showHorizontalGridline===this._defaultShowHorizontalGridline&&o.showVerticalGridline===this._defaultShowVerticalGridline;case"allowCellOverflow":return!1===o;case"referenceStyle":return 0===o;case"zoomFactor":return 1===o;case"showRowRangeGroup":case"showColumnRangeGroup":return!0===o;case"conditionalFormats":case"sheetTabColor":return o===i;case"frozenlineColor":return"black"===o;case"rowHeaderAutoText":return 1===o;case"colHeaderAutoText":return 2===o;case"rowHeaderAutoTextIndex":case"colHeaderAutoTextIndex":return-1===o;case"rowHeaderVisible":case"colHeaderVisible":return!0===o;case"rowHeaderColCount":case"colHeaderRowCount":return 1===o;case"rowHeaderColInfos":case"colHeaderRowInfos":return!o||0===o.length;case"clipBoardOptions":return 0===o;case"isProtected":return!1===o;case"protectionOption":return t.GC$.isEmptyObject(o);case"borderColor":return"black"===o;case"borderWidth":return 0===o;case"allowUndo":case"allowEditorReservedLocations":return!0===o;case"tables":case"floatingObjects":return o===i;case"visible":return!0===o;case"data":case"rowHeaderData":case"colHeaderData":return t.GC$.isEmptyObject(o);case"tag":return o===i;case"printInfo":return t.GC$.isEmptyObject(o);case"slicers":return o===i;default:return!1}},o.prototype.fromJSON=function(o,n,r){var a,s,l,u,c,h,p,g,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O,P,L,H,k,V,B,z,G,W,j,U,Y,X,K,J,Z,q,$,Q,ee,te,oe,ne;if(o){a=this,t.features.binding&&(a._bindingManager=new t._BindingManager(a)),typeof n===d&&(n=!0),s=a._sheetModelManager,l=a.isPaintSuspended(),a.isPaintSuspended(!0),u=e.Sheets.Culture(),e.Sheets.switchCulture(""),c=o.rowCount,h=o.columnCount;try{if(a._name=o.name,a._names={},o.defaults&&(a.defaults=o.defaults),typeof c===d&&(c=a._defaultRowCount),a.setRowCount(c),typeof h===d&&(h=a._defaultColCount),a._setColumnCountCore(h),typeof o.activeRow!==d&&(a._activeRowIndex=o.activeRow),typeof o.activeCol!==d&&(a._activeColIndex=o.activeCol),typeof o.frozenRowCount!==d&&a.setFrozenRowCount(o.frozenRowCount),typeof o.frozenColCount!==d&&a.setFrozenColumnCount(o.frozenColCount),typeof o.frozenTrailingRowCount!==d&&a.setFrozenTrailingRowCount(o.frozenTrailingRowCount),typeof o.frozenTrailingColCount!==d&&a.setFrozenTrailingColumnCount(o.frozenTrailingColCount),typeof o.gridline!==d&&(a.gridline=o.gridline),typeof o.allowCellOverflow!==d&&(a._allowCellOverflow=o.allowCellOverflow),typeof o.autoGenerateColumns!==d&&(a.autoGenerateColumns=o.autoGenerateColumns),typeof(p=o.tag)!==d&&(typeof(g=p.typeName)===m&&((_=t.getTypeFromString(g))&&((p=new _).fromJSON&&p.fromJSON(o.tag))),a.tag(p)),r&&(o.dataSource&&((y=a._bindingManager)&&y.bind(o.dataSource)),o.dataBinding&&((y=a._bindingManager)&&y.fromJSON(o.dataBinding,r))),o.rows&&(s.getRowInfos()._setItems(o.rows),s.getRowInfos().length=c),o.columns&&(s.getColInfos()._setItems(o.columns),s.getColInfos().length=h),o.colStyles)for(w in o.colStyles)isNaN(w)||(C=parseInt(w,10),a.setStyle(-1,C,o.colStyles[w],3));if(o.rowStyles)for(w in o.rowStyles)isNaN(w)||(v=parseInt(w,10),a.setStyle(v,-1,o.rowStyles[w],3));if(typeof o.rowHeaderAutoText!==d&&(a.rowHeaderAutoText=o.rowHeaderAutoText),typeof o.colHeaderAutoText!==d&&(a.colHeaderAutoText=o.colHeaderAutoText),typeof o.rowHeaderAutoTextIndex!==d&&(a.rowHeaderAutoTextIndex=o.rowHeaderAutoTextIndex),typeof o.colHeaderAutoTextIndex!==d&&(a.colHeaderAutoTextIndex=o.colHeaderAutoTextIndex),typeof o.rowHeaderVisible!==d&&(a.rowHeaderVisible=o.rowHeaderVisible),typeof o.colHeaderVisible!==d&&(a.colHeaderVisible=o.colHeaderVisible),S=o.rowHeaderColCount,x=o.colHeaderRowCount,typeof o.rowHeaderColCount===d&&(S=this._defaultRowHeaderColumnCount),typeof o.colHeaderRowCount===d&&(x=this._defaultColHeaderRowCount),a.setColumnCount(S,2),a.setRowCount(x,1),o.rowHeaderData&&s.rowHeaderModel().fromJSON(o.rowHeaderData,r),o.colHeaderData&&s.colHeaderModel().fromJSON(o.colHeaderData,r),o.rowHeaderSpan&&a._getSpanModel(2).fromJSON(o.rowHeaderSpan,r),o.colHeaderSpan&&a._getSpanModel(1).fromJSON(o.colHeaderSpan,r),o.rowHeaderColInfos&&s.getColInfos(2)._setItems(o.rowHeaderColInfos),o.colHeaderRowInfos&&s.getRowInfos(1)._setItems(o.colHeaderRowInfos),(typeof o._zoomFactor!==d||typeof o.zoomFactor!==d)&&(a._zoomFactor=typeof o.zoomFactor===d?o._zoomFactor:o.zoomFactor),o.spans&&a._getSpanModel().fromJSON(o.spans,r),o.selections&&(a._clearSelectionImp(),a._selectionModel.fromJSON(o.selections,r)),typeof o.referenceStyle!==d&&a.referenceStyle(o.referenceStyle),a.clearCustomFunctions(),R=o.customFunctions)for(b in R)T=R[b],(A=t.getTypeFromString(T.typeName))&&((I=new A).fromJSON(T,r),a._addCustomFunctionCore(I));if(n&&o.names){for(D=0;D<o.names.length;D++)F=o.names[D],a._addCustomNameCore(F.name,F.formula,F.row,F.col,!0);a._rebuildCalcNodes()}if(o.data&&(s.dataModel().fromJSON(o.data,r),M=o.data.dataTable,n&&M))for(E in M)if(typeof E!==f)for(N in M[E])typeof N!==f&&((P=(O=M[E][N]).formula)&&(O.arrayInfo?a._setArrayFormulaCore(parseInt(E,10),parseInt(N,10),parseInt(O.arrayInfo.rowCount,10),parseInt(O.arrayInfo.colCount,10),P,!0):a._setFormulaCore(parseInt(E,10),parseInt(N,10),P,!0)));if(L=r?o.sparklineGroupManager?o.sparklineGroupManager.groups:i:o.sparklineGroups,n&&L&&(H=a._sparklineGroupManager))for(H.fromJSON(L,r),k=H.groups(),V=s.getDataModel(),Z=0;Z<k.length;Z++)for(B=k[Z]._innerList,G=0;G<B.length;G++)z=B[G],V.setSparkline(z.row,z.column,z);if((W=r?o.commentManager:o.comments)&&a._commentManager.fromJSON(W,r),o.theme)if("string"==typeof(j=o.theme)||typeof j===d)a.currentTheme(j);else{var re=j.themeColor?j.themeColor:j._themeColor,ie=re.name?re.name:re._name,ae=new t.ThemeColor(ie);ae.fromJSON(re,r),U=new t.SpreadTheme(j.name?j.name:j._name,ae,j.headingFont?j.headingFont:j._headingFont,j.bodyFont?j.bodyFont:j._bodyFont),a.currentTheme(U)}if(typeof o.showRowRangeGroup!==d&&(a._showRowRangeGroup=o.showRowRangeGroup),typeof o.showColumnRangeGroup!==d&&(a._showColumnRangeGroup=o.showColumnRangeGroup),o.rowRangeGroup&&a.rowRangeGroup&&a.rowRangeGroup.fromJSON(o.rowRangeGroup,r),o.colRangeGroup&&a.colRangeGroup&&a.colRangeGroup.fromJSON(o.colRangeGroup,r),(Y=o.rowFilter)&&t.features.filter&&((K=Y.typeName)?(J=t.getTypeFromString(K))&&(X=new J):X=new t.HideRowFilter,X&&(a._rowFilter=X,X.sheet=a,X.fromJSON(Y,r),X.reFilter())),o.conditionalFormats&&t.features.conditionalFormat&&a.getConditionalFormats().fromJSON(o.conditionalFormats,r),o.sheetTabColor&&a.sheetTabColor(o.sheetTabColor),o.frozenlineColor&&a.frozenlineColor(o.frozenlineColor),typeof o.clipBoardOptions!==d&&(a._clipBoardOptions=o.clipBoardOptions),typeof o.isProtected!==d&&(a.isProtected=o.isProtected),a._protectionOption=typeof o.protectionOption!==d?o.protectionOption:{},o.borderColor&&(a.borderColor=o.borderColor),typeof o.borderWidth!==d&&(a.borderWidth=o.borderWidth),typeof o.allowUndo!==d&&a.allowUndo(o.allowUndo),typeof o.allowEditorReservedLocations!==d&&a.allowEditorReservedLocations(o.allowEditorReservedLocations),a._namedStyles={},o.namedStyles)for(Z=0;Z<o.namedStyles.length;Z++)q=o.namedStyles[Z],($=new t.Style).fromJSON(q,r),typeof q.validator!==d&&(t.features.dataValidator&&(Q=new e.Sheets.DefaultDataValidator).fromJSON(q.validator,r),$.validator=Q),a._addNamedStyleImp($,!1);o.selectionBackColor&&a.selectionBackColor(o.selectionBackColor),o.selectionBorderColor&&a.selectionBorderColor(o.selectionBorderColor),typeof(ee=r?o.tableManager?o.tableManager.tables:i:o.tables)!==d&&a._tableManager&&a._tableManager.fromJSON(ee,r),typeof(te=r?o.floatingObjectArray?o.floatingObjectArray.floatingObjects:i:o.floatingObjects)!==d&&a._floatingObjectArray&&a._floatingObjectArray.fromJSON(te,r),typeof(oe=o.slicers)!==d&&a._slicerCollection&&a._slicerCollection.fromJSON(oe),typeof o.visible!==d&&(a._visible=o.visible),(ne=this.printInfo())&&typeof o.printInfo!==d&&ne.fromJSON(o.printInfo),this.clearPendingChanges()}finally{e.Sheets.switchCulture(u),a.isPaintSuspended(l)}}},o.prototype.formulaFromJSON=function(e,t){var o,n,r,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S;if(e){if(this,o=e.names)for(n=0;n<o.length;n++)r=o[n],this._addCustomNameCore(r.name,r.formula,r.row,r.col,!0);if((a=e.data)&&(s=a.dataTable))for(c=this.getRowCount(),h=this.getColumnCount(),p=0;p<c;p++)if(l=s[p])for(d=0;d<h;d++)(f=(u=l[d])&&u.formula)&&(u.arrayInfo?this._setArrayFormulaCore(p,d,parseInt(u.arrayInfo.rowCount,10),parseInt(u.arrayInfo.colCount,10),f,!0):this._setFormulaCore(p,d,f,!0));if((g=t?e.sparklineGroupManager?e.sparklineGroupManager.groups:i:e.sparklineGroups)&&(m=this._sparklineGroupManager))for(m.fromJSON(g,t),_=m.groups(),y=this._sheetModelManager.getDataModel(),v=0;v<_.length;v++)for(C=_[v]._innerList,S=0;S<C.length;S++)w=C[S],y.setSparkline(w.row,w.column,w)}},o.prototype._toArray=function(e,t){var o,n;if(!e)return i;for(o=[],n=0;n<t;n++)e[n]!==a&&(o[n]=e[n]);return o},o.prototype.isPaintSuspended=function(e){var t=this;return 0===arguments.length?t._paintSuspended:(t._paintSuspended!==e&&(t._paintSuspended=e,!e&&t._layoutSuspended<=0&&(!t.parent||t.parent.getActiveSheet&&t.parent.getActiveSheet()===t)&&(t.invalidateLayout(),t.repaint())),t)},o.prototype.getName=function(){return this._name},o.prototype.setName=function(e){var o=this.parent;if(!this._isValidSheetName(e))throw t.SR.Exp_NotSupport;this.setNameCore(e),o&&o._doTabHSResize&&o._doTabHSResize()},o.prototype.setNameCore=function(e){var t=v.getDataValidatorsBeforeSetSheetName(this);this._name=e,v.adjustModelFormulasAfterSetSheetName(this),v.adjustValidatorsAfterSetSheetName(this,t)},o.prototype.visible=function(e){var o,n;if(0==arguments.length)return this._visible;if(this._visible=e,o=this.parent){var r=o.sheets,i=r.length,a=t.util.inArray(this,r),s=o.getActiveSheetIndex();if(e)s<0?o._setActiveSheetIndexImp(a,1):o._doTabHSResize();else if(a===s){for(n=a+1;n<i&&!r[n]._visible;)n++;if(n>=i)for(n=a-1;n>=0&&!r[n]._visible;)n--;n<0?(this._dispose(!1),o._activeSheetIndex=n,o._doResize()):(n<o._tab._firstTab&&(o._tab._firstTab=n),o._setActiveSheetIndexImp(n,1))}else o._doTabHSResize();return this}},o.prototype.allowCellOverflow=function(e){var t=this;return 0===arguments.length?t._allowCellOverflow:t._bindToAutoRefresh(function(e){return t._allowCellOverflow=e,t})(e)},o.prototype.allowUndo=function(e){var t;return 0===arguments.length?this._allowUndo:(this._allowUndo=e,(t=this.undoManager())&&(t._allowUndo=e),this)},o.prototype.allowEditorReservedLocations=function(e){return 0===arguments.length?this._allowEditorReservedLocations:(this._allowEditorReservedLocations=e,this)},o.prototype.sheetTabColor=function(e){var t=this.parent;return 0===arguments.length?this._sheetTabColor:(this._sheetTabColor=e,t&&t._doTabHSResize&&t._doTabHSResize(),this)},o.prototype.frozenlineColor=function(e){var t=this;return 0===arguments.length?t._frozenlineColor:t._bindToAutoRefresh(function(e){return e&&(t._frozenlineColor=e),t})(e)},o.prototype.enableFormulaTextbox=function(e){return 0===arguments.length?this._enableFormulaTextbox:(this._enableFormulaTextbox=e,this)},o.prototype.addRows=function(e,o){var n,r,i,a,s,l,u,c,h,p,d,f;if(!(o<=0)){var g=this,m=g.getRowCount(),_=g.getDataSource();if(_&&t._BindingManager.isDataViewSource(_)){if(!_.canAdd||!_.canAdd())return;e=m}n=g.isPaintSuspended(),g.isPaintSuspended(!0);try{if((e<0||e>m)&&(e=m),r=g._getCalcModel()){if(!g._checkArrayFormula(e,0,0,g.getColumnCount()))return;r.getCalcService().getOperatorAdjustor().onBeforeAddRemoveRows(r,e)}this._sheetModelManager.getRowInfos().addItems(e,o),this._sheetModelManager.getDataModel().addRows(e,o),(i=g._cutCopyIndicatorManager)&&i.addRows(),(a=g._bindingManager)&&a.addItems(e,o),v.adjustCustomNameOnInsertRemove(g,e,o,!0,!0),(s=g._getCalcModel())&&s.addRows(e,o),g._getModel(2).addRows(e,o),g._getSpanModel(2).addRows(e,o),g._getSpanModel().addRows(e,o),(l=g._rowFilter)&&l._addRows(e,o),(u=g.rowRangeGroup)&&u._add(e,o),(c=g._sparklineGroupManager)&&c._addRows(e,o),(h=g._conditionalFormats)&&h._addRows(e,o),(p=g._tableManager)&&p.addRows(e,o),r&&r.getCalcService().getOperatorAdjustor().onAfterAddRemoveRows(r,e,o,!0),(d=g._floatingObjectArray)&&d.length>0&&d.addRows(e,o),(f=g._commentManager)&&f.addRows(e,o),g._needSyncVScrollbarSize=!0,g.triggerRowChanged({sheet:g,sheetName:g._name,row:e,oldValue:m,count:o,sheetArea:3,propertyName:"addRows"})}finally{g.isPaintSuspended(n)}}},o.prototype.deleteRows=function(e,o){var n,r,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,S,x,R,b,T,A=this,I=A.getRowCount();if(!(0>e)&&!(e>=I)&&!(o<=0)&&(!(n=A.getDataSource())||!t._BindingManager.isDataViewSource(n)||n.canRemove&&n.canRemove())){r=A.isPaintSuspended(),A.isPaintSuspended(!0);try{if(a=A._getCalcModel()){if(!A._checkArrayFormula(e,0,o,A.getColumnCount()))return;a.getCalcService().getOperatorAdjustor().onBeforeAddRemoveRows(a,e)}if(s=A._getModel(),A.deletedRows||(A.deletedRows=[]),l=A._bindingManager)for(u=l.getRowCount(),c=0;c<o&&e+c<s.getRowCount();c++)h=null,e+c<u&&(h=l.getDataItem(e+c)),p=i,s.dataTable&&s.dataTable[e+c]&&(p=s.dataTable[e+c].key),A.deletedRows.push({row:e+c,data:h,key:p});if(v.adjustCustomNameOnInsertRemove(A,e,o,!1,!0),(d=A._getCalcModel())&&d.deleteRows(e,o),this._sheetModelManager.getRowInfos().deleteItems(e,o),s.deleteRows(e,o),l&&l.removeItems(e,o),(f=A._cutCopyIndicatorManager)&&f.deleteRows(),A._getModel(2).deleteRows(e,o),A._getSpanModel(2).removeRows(e,o),A._getSpanModel().removeRows(e,o),(g=A._rowFilter)&&g._removeRows(e,o),(m=A.rowRangeGroup)&&m._remove(e,o),(_=A._sparklineGroupManager)&&_._removeRows(e,o),(y=A._conditionalFormats)&&y._removeRows(e,o),(C=A._tableManager)&&C.removeRows(e,o),(w=A._scrollTopRow)>=0){for(S=-1,x=w;x>=A.frozenRowCount;x--)if(A.getRowVisible(x)&&A._getZoomRowHeight(x)>0){S=x;break}-1===S&&(S=0),w!==S&&(A._scrollTopRow=S,A._syncVScrollbarPosition(),A.triggerTopRowChanged({sheet:A,sheetName:A._name,oldTopRow:w,newTopRow:S}))}a&&a.getCalcService().getOperatorAdjustor().onAfterAddRemoveRows(a,e,o,!1),(R=A._floatingObjectArray)&&R.length>0&&R.removeRows(e,o),(b=A._commentManager)&&b.removeRows(e,o),T=I,A.getActiveRowIndex()>=T&&A.setActiveCell(T-1,A.getActiveColumnIndex()),A._needSyncVScrollbarSize=!0,A.triggerRowChanged({sheet:A,sheetName:A._name,row:e,oldValue:I,count:o,sheetArea:3,propertyName:"deleteRows"})}finally{A.isPaintSuspended(r)}}},o.prototype.addColumns=function(e,t){if(!(t<=0)){var o=this,n=o.getColumnCount();o._bindToAutoRefresh(function(e,t){var r,i,a,s,l,u,c,h,p,d;if((e<0||e>n)&&(e=n),!o.parent||!o.parent.gcSpreadsheet){if(r=o._getCalcModel()){if(!o._checkArrayFormula(0,e,o.getRowCount(),0))return;r.getCalcService().getOperatorAdjustor().onBeforeAddRemoveColumns(r,e)}o._sheetModelManager.getColInfos().addItems(e,t),o._getModel().addColumns(e,t),(i=o._cutCopyIndicatorManager)&&i.addColumns(),v.adjustCustomNameOnInsertRemove(o,e,t,!0,!1),(a=o._getCalcModel())&&a.addColumns(e,t),o._getModel(1).addColumns(e,t),o._getSpanModel(1).addColumns(e,t),o._getSpanModel().addColumns(e,t),(s=o._rowFilter)&&s._addColumns(e,t),(l=o.colRangeGroup)&&l._add(e,t),(u=o._sparklineGroupManager)&&u._addColumns(e,t),(c=o._conditionalFormats)&&c._addColumns(e,t),(h=o._tableManager)&&h.addColumns(e,t),r&&r.getCalcService().getOperatorAdjustor().onAfterAddRemoveColumns(r,e,t,!0),(p=o._floatingObjectArray)&&p.length>0&&p.addColumns(e,t),(d=o._commentManager)&&d.addColumns(e,t),o._needSyncHScrollbarSize=!0,o.triggerColumnChanged({sheet:o,sheetName:o._name,col:e,oldValue:n,count:t,sheetArea:3,propertyName:"addColumns"})}})(e,t)}},o.prototype.deleteColumns=function(e,t){var o=this,n=o.getColumnCount();0>e||e>=n||t<=0||o.parent&&o.parent.gcSpreadsheet||o._bindToAutoRefresh(function(e,t){var r,i,a,s,l,u,c,h,p,d,f,g,m,_=o._getCalcModel();if(_){if(!o._checkArrayFormula(0,e,o.getRowCount(),t))return;_.getCalcService().getOperatorAdjustor().onBeforeAddRemoveColumns(_,e)}if(v.adjustCustomNameOnInsertRemove(o,e,t,!1,!1),(r=o._getCalcModel())&&r.deleteColumns(e,t),o._sheetModelManager.getColInfos().deleteItems(e,t),o._getModel().deleteColumns(e,t),(i=o._cutCopyIndicatorManager)&&i.deleteColumns(),o._getModel(1).deleteColumns(e,t),o._getSpanModel(1).removeColumns(e,t),o._getSpanModel(3).removeColumns(e,t),(a=o._rowFilter)&&a._removeColumns(e,t),(s=o.colRangeGroup)&&s._remove(e,t),(l=o._sparklineGroupManager)&&l._removeColumns(e,t),(u=o._conditionalFormats)&&u._removeColumns(e,t),(c=o._tableManager)&&c.removeColumns(e,t),(h=o._scrollLeftCol)>=0){for(p=-1,d=h;d>=o.frozenColCount;d--)if(o.getColumnVisible(d)&&o._getZoomColumnWidth(d)>0){p=d;break}-1===p&&(p=0),h!==p&&(o._scrollLeftCol=p,o._syncHScollbarPosition(),o.triggerLeftColumnChanged({sheet:o,sheetName:o._name,oldLeftCol:h,newLeftCol:p}))}_&&_.getCalcService().getOperatorAdjustor().onAfterAddRemoveColumns(_,e,t,!1),(f=o._floatingObjectArray)&&f.length>0&&f.removeColumns(e,t),(g=o._commentManager)&&g.removeColumns(e,t),m=n,o.getActiveColumnIndex()>=m&&o.setActiveCell(o.getActiveRowIndex(),m-1),o._needSyncHScrollbarSize=!0,o.triggerColumnChanged({sheet:o,sheetName:o._name,col:e,oldValue:n,count:t,sheetArea:3,propertyName:"deleteColumns"})})(e,t)},o.prototype.setFrozenCount=function(e,t){(typeof e===d||e===i||e<0||isNaN(e))&&(e=0),(typeof t===d||t===i||t<0||isNaN(t))&&(t=0);var o=this;(o.frozenRowCount!==e||o.frozenColCount!==t)&&o._bindToAutoRefresh(function(e,t){var n=!1;o.frozenRowCount!==e&&(o._scrollTopRow+=e-o.frozenRowCount,o.frozenRowCount=e,n=!0),o.frozenColCount!==t&&(o._scrollLeftCol+=t-o.frozenColCount,o.frozenColCount=t,n=!0),n&&(o._needSyncVScrollbarSize=!0,o._needSyncHScrollbarSize=!0)})(e,t)},o.prototype.setFrozenColumnCount=function(e){(typeof e===d||e===i||e<0||isNaN(e))&&(e=0);var t=this;t.frozenColCount!==e&&t._bindToAutoRefresh(function(e){t._scrollLeftCol+=e-t.frozenColCount,t.frozenColCount=e,t._needSyncHScrollbarSize=!0})(e)},o.prototype.setFrozenRowCount=function(e){(typeof e===d||e===i||e<0||isNaN(e))&&(e=0);var t=this;t.frozenRowCount!==e&&t._bindToAutoRefresh(function(e){t._scrollTopRow+=e-t.frozenRowCount,t.frozenRowCount=e,t._needSyncVScrollbarSize=!0})(e)},o.prototype.setFrozenTrailingRowCount=function(e){(typeof e===d||e===i||e<0||isNaN(e))&&(e=0);var t=this;t._frozenTrailingRowCount!==e&&t._bindToAutoRefresh(function(e){t._frozenTrailingRowCount=e,t._needSyncVScrollbarSize=!0})(e)},o.prototype.setFrozenTrailingColumnCount=function(e){(e===a||e===i||e<0||isNaN(e))&&(e=0);var t=this;t._frozenTrailingColCount!==e&&t._bindToAutoRefresh(function(e){t._frozenTrailingColCount=e,t._needSyncHScrollbarSize=!0})(e)},o.prototype.getRowCount=function(e){var t=this._sheetModelManager.getDataModel(e);return t&&t.getRowCount()||0},o.prototype.getColumnCount=function(e){var t=this._sheetModelManager.getDataModel(e);return t&&t.getColumnCount()||0},o.prototype.setRowCount=function(e,o){(o===a||o===i)&&(o=3);var n=this.getDataSource();(!n||t._BindingManager.isCellBindingSource(n)||3!==o&&2!==o)&&this._setRowCountInternal(e,o)},o.prototype._setRowCountInternal=function(e,t){if(e=parseInt(e,10),!isNaN(e)){var o=this;e<0||e===o.getRowCount(t)||o._bindToAutoRefresh(function(e,t){var n,r;(t===a||t===i)&&(t=3),n=o._sheetModelManager,3===t||2===t?(n.dataModel().getRowCount()>e&&o.deleteRows(e,n.dataModel().getRowCount()-e),n.dataModel().setRowCount(e),n.rowHeaderModel().setRowCount(e),o.frozenRowCount>e&&o.setFrozenRowCount(e),o.rowRangeGroup&&o.rowRangeGroup._setCount(e)):1===t&&((r=n.colHeaderModel()).getRowCount()>e&&n.getRowInfos(t).deleteItems(e,r.getRowCount()-e),r.setRowCount(e)),o._conditionalFormats&&o._conditionalFormats._resetCache(),o._needSyncVScrollbarSize=!0,o._activeRowIndex>=e&&(3===t||2===t)&&o.setActiveCell(e-1,o.getActiveColumnIndex()),o.clearPendingChanges()})(e,t)}},o.prototype.setColumnCount=function(e,t){if(e=parseInt(e,10),!isNaN(e)){var o=this;e<0||e===o.getColumnCount(t)||o._bindToAutoRefresh(function(e,t){var n,r;(t===a||t===i)&&(t=3),n=o._sheetModelManager,3===t||1===t?(n.dataModel().getColumnCount()>e&&o.deleteColumns(e,n.dataModel().getColumnCount()-e),o._setColumnCountCore(e)):2===t&&((r=n.rowHeaderModel()).getColumnCount()>e&&n.getColInfos(t).deleteItems(e,r.getColumnCount()-e),r.setColumnCount(e)),o._conditionalFormats&&o._conditionalFormats._resetCache(),o._needSyncHScrollbarSize=!0,o._activeColIndex>=e&&(3===t||1===t)&&o.setActiveCell(o.getActiveRowIndex(),e-1),o.clearPendingChanges()})(e,t)}},o.prototype._setColumnCountCore=function(e){var t=this._sheetModelManager;t.dataModel().setColumnCount(e),t.colHeaderModel().setColumnCount(e),this.frozenColCount>e&&this.setFrozenColumnCount(e),this.colRangeGroup&&this.colRangeGroup._setCount(e)},o.prototype.getText=function(e,t,o){var n;(typeof o===d||o===i)&&(o=3);var r=this.getValue(e,t,o),a=this.getCellType(e,t,o),s=this.getStyleProperty(e,t,"formatter",o);return s||(s=this.getStyleProperty(e,t,"_autoFormatter",o)),n={sheet:this,row:e,col:t,sheetArea:o},(r=a.format(r,s,n))&&"string"==typeof r&&""!==r&&(r=r.replace(/\r\n?/g,"\n")),r},o.prototype.setText=function(e,o,n,r){var s=this;s._bindToAutoRefresh(function(e,o,n,r){var l,u,c,h;(r===a||r===i)&&(r=3),l=n,u=t.util.isStringNumber(t._NumberHelper.replaceCultureSymbolToNormal(n)),t.features.formatter&&u&&(c={},(new t.GeneralFormatter).GetPreferredDisplayFormatter(l,c),"number"==typeof c.value&&(n=c.value));var p=n,d=s.getCellType(e,o,r),f=s.getCell(e,o,r).formatter();d&&f&&(h={sheet:s,row:e,col:o,sheetArea:r},p=(p=d.parse(l,f,h))===i||p===a?n:p),s._setValueInternal(e,o,p,r)})(e,o,n,r)},o.prototype.getValue=function(e,o,n){var r,s,l,u,c,h,p,f,g,m;return(typeof n===d||n===i)&&(n=3),(s=(r=this)._getModel(n))?(l=r._getValueImp(s,e,o,n),1===n?(l===a||l===i)&&((c=r.getDataSource())&&(h=window.ko,(t._BindingManager.isDataViewSource(c)||c.length>0||h&&h.isObservable(c))&&(p=r._sheetModelManager.getColInfos()._getItem(o),f=r.colHeaderAutoTextIndex,p&&(f>=0&&e===f||-1===f&&e===s.getRowCount()-1)&&(l=p.displayName||p.name))),(l===a||l===i)&&(((u=r.colHeaderAutoTextIndex)<0||u>=s.getRowCount())&&(u=s.getRowCount()-1),e===u&&(2===(g=r.colHeaderAutoText)?l=r._indexToLetters(o+1):1===g&&(l=o+1)))):2===n&&(l===a||l===i)&&(((u=this.rowHeaderAutoTextIndex)<0||u>=s.getColumnCount())&&(u=s.getColumnCount()-1),o===u&&(2===(m=r.rowHeaderAutoText)?l=r._indexToLetters(e+1):1===m&&(l=e+1))),l):i},o.prototype._getCurrentValue=function(e,t){return this._isValidatingCell&&this._validatingRow===e&&this._validatingColumn===t?this._validatingValue:this.getValue(e,t)},o.prototype._getValuesForCalc=function(e,t,o,n,r,i){var a,s,l=this._getModel();if(l){this.getRowCount(),this.getColumnCount();var u,c,h=this._isValidatingCell;for(a=0;a<n;a++)for(i||(u=[],e.push(u)),s=0;s<r;s++)h&&this._validatingRow===a+t&&this._validatingColumn===s+o?(c=this._validatingValue,h=!1):c=this._getValueImp(l,t,o,3),i?e.push(c):u.push(c)}},o.prototype.setValue=function(e,t,o,n,r){this._setValueInternal(e,t,o,n,r),this.invalidate()},o.prototype._setValueInternal=function(e,o,n,r,s){var l,u,c,h,p,f,g,m,_,y,C,w;if((typeof r===d||r===i)&&(r=3),(u=(l=this)._getModel(r))&&(c=u.getRowCount(),h=u.getColumnCount(),!(e<0||e>=c||o<0||o>=h))){p=3===r,n=v.tryConvertDateToOADate(n);var S,x=l._getValueImp(u,e,o,r),R=!1,b=l._tableManager;if(p&&b&&b._tableList.length>0&&(S=b.find(e,o)))if(S.showHeader()&&e===S.headerIndex()){if(S._hasColumnName(n))return;f=n!==a&&n!==i&&"string"!=typeof n?n.toString():n,S._setHeaderName(o,f)}else S.showFooter()&&e===S.footerIndex()?S._setFooterValue(o,n):R=S._setValue(e,o,n);p?(g=l._bindingManager,!R&&g&&g._dataSource&&((m=g.getValue(e,o)).hasBinding&&n!==m.value&&(_=t.GC$.extend({},l.getDataItem(e)),u._updateDirty(e,o,{originalItem:_,oldValue:x}),g.setValue(e,o,n)),R=m.hasBinding),(!R||l.checkingChanges)&&u.setValue(e,o,n)):u.setValue(e,o,n),p&&!s&&l._recalcCell(u,e,o),p&&S&&S.hasSlicerData()&&((y=S.dataRange()).contains(e,o)&&((C=S.getSlicerData())&&C.onDataChanged(e-y.row,o-y.col,{value:l.getValue(e,o),text:l.getText(e,o)}))),(w=l._conditionalFormats)&&w._clearCache(),l._eventHandler._eventSuspended>0||x===n||l._raiseCellChanged(P,e,o,x,n,r)}},o.prototype.sortRange=function(e,o,n,r,i,s){var l=this,u=t.util.hasCalc()&&t.Calc.CalcOperatorAdjustor;return l._bindToAutoRefresh(function(e,o,n,r,i,s){var c,h,p,d,f,g,m,_;if(l._checkArrayFormula(e,0,n,l.getColumnCount(),!1)){c=l.isPaintSuspended(),l.isPaintSuspended(!0),l.suspendEvent(),l.suspendCalcService();try{if((h=l.getSpans(new t.Range(e,o,n,r)))&&h.length>0)return!1;var y,C,w,v,S,x,R,b,T,A,I,D=l.getRowCount(),F=l.getColumnCount(),M=[];if(-1===e&&(e=0),-1===n&&(n=D),-1===o&&(o=0),-1===r&&(r=F),e<0||e>=D||o<0||o>=F||n<0||e+n>D||r<0||o+r>F||!s)return!1;if(p=[],R=l._quickSort(e,o,n,r,i,s)){var E,N,O,P=l._getModel(),L=l._getCalcModel(),H=l._getSheetSource();if(i){for(C=e;C<e+n;C++)if(M[E=l._getSwapIndex(R,e,C)]=C,C!==E)for(w=C,S=E,y=o;y<o+r;y++)v=y,b=l.getValue(w,v),T=l.getValue(S,v),A=l.getComment(w,v),I=l.getComment(S,v),L&&H&&((d=L._getCellCalc(w,v,!1))&&d.hasListeners()&&d.addListenersToAdjust(),(f=L._getCellCalc(S,v,!1))&&f.hasListeners()&&f.addListenersToAdjust(),L._swapNode(w,v,S,v),N=u._copyExpression(L._getExpr(w,v),w,v,0,0),L._setExpr(w,v,N),(O=L._getCellCalc(w,v,!!N))&&O.startListening(),N=u._copyExpression(L._getExpr(S,v),S,v,0,0),L._setExpr(S,v,N),(O=L._getCellCalc(S,v,!!N))&&O.startListening()),P.swapNode(w,v,S,v),l.setComment(w,v,I),l.setComment(S,v,A),l.setValue(w,v,T),l.setValue(S,v,b),p.push(new t.CellPosition(w,v)),p.push(new t.CellPosition(S,v))}else for(y=o;y<o+r;y++)if(y!==(E=l._getSwapIndex(R,o,y)))for(v=y,x=E,C=e;C<e+n;C++)w=C,b=l.getValue(w,v),T=l.getValue(w,x),A=l.getComment(w,v),I=l.getComment(w,x),L&&H&&((d=L._getCellCalc(w,v,!1))&&d.hasListeners()&&d.addListenersToAdjust(),(f=L._getCellCalc(w,x,!1))&&f.hasListeners()&&f.addListenersToAdjust(),L._swapNode(w,v,w,x),N=u._copyExpression(L._getExpr(w,v),w,v,0,0),L._setExpr(w,v,N),(O=L._getCellCalc(w,v,!!N))&&O.startListening(),N=u._copyExpression(L._getExpr(w,x),w,x,0,0),L._setExpr(w,x,N),(O=L._getCellCalc(w,x,!!N))&&O.startListening()),P.swapNode(w,v,w,x),l.setComment(w,v,I),l.setComment(w,x,A),l.setValue(w,v,T),l.setValue(w,x,b),p.push(new t.CellPosition(w,v)),p.push(new t.CellPosition(w,x));for(g=e;g<e+n;g++)for(m=o;m<o+r;m++)(_=L.getExpression(g,m))&&L.setExpression(g,m,_,a);return!0}return!1}finally{l.resumeCalcService(!1),l.resumeEvent(),l.isPaintSuspended(c),l._raiseRangeDataChanged(e,o,n,r,p,4)}}})(e,o,n,r,i,s)},o.prototype.canDoSort=function(){return!this.isProtected||this._protectionOption.allowSort},o.prototype.clearStyleCache=function(){this._styleComposeCache=[{},{},{},{}]},o.prototype.getActualStyle=function(e,o,n,r,s){var l,u,c,h,p;if((typeof n===d||n===i)&&(n=3),-1===e&&-1===o)return this.getDefaultStyle(n);var f,g,m,_,y,C,w,v,S,x,R,b,T,A=this,I=A._styleComposeCache,D=this._sheetModelManager.getDataModel(n);if(!D)return new t.Style;if(m=D.getStyle(e,o),_=D.getStyle(e,-1),y=D.getStyle(-1,o),_=_||i,y=y||i,R=(m=m||i)?m.charAt?m:"__spreadJSDefault"+m._id:"__undefined",b=_?_.charAt?_:"__spreadJSDefault"+_._id:"__undefined",T=y?y.charAt?y:"__spreadJSDefault"+y._id:"__undefined",C=(S=I[n])[R],(l=A._tableManager)&&l.getCount()>0&&3===n&&(x=l.find(e,o)),x||(C||(C=S[R]={}),(w=C[b])?v=w[T]:w=C[b]={}),v||(g=A.getCompositeStyle(e,o,n,m,_,y,x)),3===n&&!r&&(v||(u=g.formatter)&&u.HasFormatedColor&&u.HasFormatedColor()&&(c={value:i},u.Format(A.getValue(e,o),c),c.value&&((f=new t.Style).foreColor=c.value)),(h=A._conditionalFormats)&&h.count()>0)){var F,M=h.getRules(e,o),E=M.length,N=i;if(E>0)for(M.sort(function(e,t){return e.priority()-t.priority()}),p=0;p<E&&!((F=M[p])&&(F.isScaleRule()?(F instanceof t.TwoScaleRule||F instanceof t.ThreeScaleRule)&&(N=F.evaluate(A,e,o,A.getValue(e,o,n)),N&&(f||(f=new t.Style),f.backColor===a&&(f.backColor=N))):(N=F.evaluate(A,e,o,A.getValue(e,o,n)),N&&(f||(f=new t.Style),f.compose(N))),F.stopIfTrue()&&N));p++);}if(f)f.compose(v||g),g=f;else if(v)return s?v:v.clone();return(typeof g.locked===d||g.locked===i)&&(g.locked=!0),g=g._normalize(A._currentTheme),f||x||(w[T]=g.clone()),g},o.prototype.getStyleProperty=function(e,o,n,r){var s,l,u,c,h,p,f,g,m,_,y,C,w,v,S;if((typeof r===d||r===i)&&(r=3),!(h=(s=this)._getModel(r)))return a;if(f=!1,3===r&&("foreColor"===n&&((m=s.getStyleProperty(e,o,"formatter",r))&&m.HasFormatedColor&&m.HasFormatedColor()&&(_={value:i},m.Format(s.getValue(e,o),_),_.value&&(p=_.value,f=!0))),(y=s._conditionalFormats)&&y.count()>0)){var x,R=y.getRules(e,o),b=R.length,T=i;if(b>0)for(R.sort(function(e,t){return e.priority()-t.priority()}),C=0;C<b;C++)if(x=R[C]){if(x.isScaleRule()){if("backColor"===n&&(x instanceof t.TwoScaleRule||x instanceof t.ThreeScaleRule)&&(T=x.evaluate(s,e,o,s.getValue(e,o,r)))){p=T,f=!0;break}}else if((T=x.evaluate(s,e,o,s.getValue(e,o,r)))&&T[n]!==a){p=T[n],f=!0;break}if(x.stopIfTrue()&&T)break}}for(w=0;!f&&w<=4;)if(0===w?l=h.getStyle(e,o):1===w?(v=s._tableManager)&&v.getCount()>0&&3===r&&((S=v.find(e,o))&&t.TableStyle[n]&&(l=new t.Style,S._compose(e,o,l))):l=2===w?h.getStyle(e,-1):3===w?h.getStyle(-1,o):s.getDefaultStyle(),w++,l){if(l.charAt&&"string"==typeof l&&(l=s._name2Style(l)),"font"===n&&l.themeFont&&!g&&(g=l.themeFont),l[n]!==a){p=l[n],f=!0;break}for(u=l.parentName;u&&(c=s._name2Style(u));){if(c[n]!==a){p=c[n],f=!0;break}u=c.parentName}}return"locked"===n?p===a||p===i||p:f||g?(("foreColor"===n||"backColor"===n||"font"===n||"borderLeft"===n||"borderTop"===n||"borderRight"===n||"borderBottom"===n)&&((l=new t.Style)[n]=p,"font"===n&&g&&(l.themeFont=g),l._normalize(s._currentTheme),p=l[n]),p):a},o.prototype.getStyle=function(e,t,o){return this.getStyleImp(e,t,o,!0)},o.prototype.getStyleImp=function(e,o,n,r){var s,l,u,c;if((n===a||n===i)&&(n=3),s=this._sheetModelManager.getDataModel(n)){if((l=s.getStyle(e,o))instanceof t.Style)return r&&this.clearStyleCache(),l;if("string"==typeof l&&(u=this._name2Style(l))!==i)return(c=new t.Style).compose(u),r&&this.clearStyleCache(),c}return i},o.prototype.addNamedStyle=function(e){this._addNamedStyleImp(e,!0)},o.prototype._addNamedStyleImp=function(e,o){var n,r;if(e!==i&&e!==a){if(e.name===i||e.name===a||""===e.name)throw new Error(t.SR.Exp_EmptyNamedStyle);o?(n=this,this._bindToAutoRefresh(function(e){var t=e.name.toUpperCase();n._namedStyles[t]=e})(e)):(r=e.name.toUpperCase(),this._namedStyles[r]=e)}},o.prototype.getNamedStyle=function(e){return this.getNamedStyleImp(e,!0)},o.prototype.getNamedStyleImp=function(e,t){var o,n=this._namedStyles;return n&&e?((o=n[e=e.toUpperCase()]||i)&&t&&this.clearStyleCache(),o):i},o.prototype.getNamedStyles=function(){var e=[],o=this._namedStyles;return o&&t.GC$.each(o,function(t,o){e.push(o)}),this.clearStyleCache(),e},o.prototype.removeNamedStyle=function(e){this._namedStyles&&e!==a&&e!=i&&""!==e&&(e=e.toUpperCase(),this._namedStyles.hasOwnProperty(e)&&(delete this._namedStyles[e],this.invalidate()))},o.prototype.setStyle=function(e,o,n,r){(typeof r===d||r===i)&&(r=3),this.setStyleObject(e,o,n,r),-1===e&&-1===o&&(this._composedDefaultStyle[r]=i),(-1===e||-1===o)&&n&&n.validator&&n.validator.condition instanceof t.FormulaCondition&&n.validator.condition.getExpected(this,e<0?0:e,o<0?0:o),this.clearStyleCache(),this.invalidate()},o.prototype.setStyleWithoutLocked=function(e,o,n,r){var i,s;this.isProtected?(i=this.getStyle(e,o,r),n?(s=i?i.locked:a,n.locked!==s&&(n.locked=s),this.setStyle(e,o,n,r)):i&&((s=i.locked)!==a&&((n=new t.Style).locked=s),this.setStyle(e,o,n,r))):this.setStyle(e,o,n,r)},o.prototype.getStyleName=function(e,o,n){var r=this.getStyleObject(e,o,n);return r instanceof t.Style?r.name:r},o.prototype.setStyleName=function(e,t,o,n){"string"==typeof o&&(this.setStyleObject(e,t,o,n),this.invalidate())},o.prototype.getStyleObject=function(e,t,o){(o===a||o===i)&&(o=3);var n=i,r=this._getModel(o);return r&&((n=r.getStyle(e,t))!==a&&n!==i)?n:i},o.prototype.setStyleObject=function(e,o,n,r){var a,s,l,u,c,h,p;(typeof r===d||r===i)&&(r=3);var g=this,m=g.getStyleObject(e,o,r),_=(m&&m.formatter,g._getModel(r));if(_){if(a=_.getRowCount(),s=_.getColumnCount(),e<-1||e>=a||o<-1||o>=s)return;l=_.getStyle(e,o),_.setStyle(e,o,n),t._DataValidatorCache.setStyle(n,g,e,o),u=m&&m.cellType&&m.cellType.typeName||i,c=n&&n.cellType&&n.cellType.typeName||i,e===g._activeRowIndex&&o===g._activeColIndex&&u!==c&&t.FocusHelper.isActiveElement(g)&&g._eventHandler.changeFocusHolder(),n&&n.formatter&&t.features.formatter&&((h=n.formatter)&&typeof h.Init===f&&h.Init()),p="[styleinfo]",-1!==e&&-1!==o?g._raiseCellChanged(p,e,o,l,n,r):-1!==e&&-1===o?g.triggerRowChanged({sheet:g,sheetName:g._name,row:e,sheetArea:r,propertyName:p,oldValue:l}):-1===e&&-1!==o&&g.triggerColumnChanged({sheet:g,sheetName:g._name,col:o,sheetArea:r,propertyName:p,oldValue:l})}},o.prototype.getDefaultStyle=function(e){var o,n,r,a,s;return(typeof e===d||e===i)&&(e=3),(o=this._composedDefaultStyle)[e]||((n=this._sheetModelManager.getDataModel(e))?("string"==typeof(r=n.getStyle(-1,-1))&&(r=this._name2Style(r)),r||(r=new t.Style,n.setStyle(-1,-1,r)),a=1===e||2===e,typeof r.hAlign===d&&(r.hAlign=a?1:3),typeof r.vAlign===d&&(r.vAlign=a?1:0),typeof r.imeMode===d&&(r.imeMode=1),r.font||typeof r.themeFont!==d||(r.themeFont="Body"),o[e]=r,r):((s=new t.Style).locked=!0,o[e]=s,s))},o.prototype.setDefaultStyle=function(e,o){(typeof o===d||o===i)&&(o=3);var n=this._sheetModelManager.getDataModel(o);n&&(n.setStyle(-1,-1,e),t._DataValidatorCache.setStyle(e,this,-1,-1)),this._composedDefaultStyle[o]=i,this.clearStyleCache()},o.prototype._name2Style=function(e){var t,o=this.getNamedStyleImp(e,!1);return o||((t=this.parent)&&t.getNamedStyleImp?t.getNamedStyleImp(e,!1):i)},o.prototype.getCompositeStyle=function(e,o,n,r,a,s,l){var u,c,h,p,f;(typeof n===d||n===i)&&(n=3);var g,m,_=this,y=new t.Style,C=!1,w=_._sheetModelManager.getDataModel(n);if(w){if(u=w.getRowCount(),c=w.getColumnCount(),0<=e&&e<u&&0<=o&&o<c&&((h=void 0!==r?r:w.getStyle(e,o))&&h.charAt&&(h=_._name2Style(h)),h))for(y.compose(h,!0),C=!0,m=h.parentName;m&&(g=_._name2Style(m));)y.compose(g),m=g.parentName;if(void 0===l&&((p=_._tableManager)&&p.getCount()>0&&3===n&&(l=p.find(e,o))),l&&(l._compose(e,o,y),C=!0),0<=e&&e<u&&((h=void 0!==a?a:w.getStyle(e,-1))&&h.charAt&&(h=_._name2Style(h)),h))for(y.compose(h,!C),C=!0,m=h.parentName;m&&(g=_._name2Style(m));)y.compose(g),m=g.parentName;if(0<=o&&o<c&&((h=void 0!==s?s:w.getStyle(-1,o))&&h.charAt&&(h=_._name2Style(h)),h))for(y.compose(h,!C),C=!0,m=h.parentName;m&&(g=_._name2Style(m));)y.compose(g),m=g.parentName}if((f=_.getDefaultStyle(n))&&f.charAt&&(f=_._name2Style(f)),f)for(y.compose(f,!C),m=f.parentName;m&&(g=_._name2Style(m));)y.compose(g),m=g.parentName;return y},o.prototype.getCellType=function(e,t,o){return this.getStyleProperty(e,t,"cellType",o)||this.getDefaultCellType(o)},o.prototype.getDefaultCellType=function(e){(typeof e===d||e===i)&&(e=3);var o=this._defaultCellType;return o||(o=this._defaultCellType=new t.TextCellType),3===e?o:1===e?new t.ColumnHeaderCellType:2===e?new t.RowHeaderCellType:0===e?new t.CornerCellType:o},o.prototype.setCellType=function(e,o,n,r){var i=this.getStyleImp(e,o,r);i||(i=new t.Style),i.cellType=n,this.setStyle(e,o,i,r)},o.prototype.getFormatter=function(e,t,o){return this.getStyleProperty(e,t,"formatter",o)},o.prototype.setFormatter=function(e,o,n,r){var i=this.getStyleImp(e,o,r);i||(i=new t.Style),i.formatter=n,this.setStyle(e,o,i,r)},o.prototype._changeFormatterAfterCultureChanged=function(e,o){var n,r,a=e;a&&a._autoFormatter&&a._autoFormatter._innerFormatter&&o!==i&&(n=a._autoFormatter._innerFormatter.GetPreferredEditingFormatter(o),a._autoFormatter._innerFormatter=n),a.formatter&&"string"!=typeof a.formatter&&(r=a.formatter,t.GeneralFormatter._needChangeDefaultFormat(r)&&(r.cultureName=t._CultureInfo._currentCulture.Name(),r.isConstructed=!1))},o.prototype.getDataValidator=function(e,t,o){return this.getStyleProperty(e,t,"validator",o)},o.prototype.setDataValidator=function(e,o,n,r){var s,l,u,c,h;(r===a||r===i)&&(r=3),(l=(s=this).getStyleImp(e,o,r))||(l=new t.Style),u=l.validator,l.validator=n,s.suspendEvent(),s.setStyle(e,o,l,r),s.resumeEvent(),t.features.conditionalFormat&&n&&n.condition instanceof t.FormulaCondition&&(((c=n.condition)._baseRow===a||c._baseRow===i)&&(c._baseRow=-1!==e?e:0),(c._baseCol===a||c._baseCol===i)&&(c._baseCol=-1!==o?o:0)),t.Events,h="validator",s._raiseCellChanged(h,e,o,u,n,r),-1!==e&&-1===o?s.triggerRowChanged({sheet:s,sheetName:s._name,row:e,sheetArea:r,propertyName:h,oldValue:u}):-1===e&&-1!==o&&s.triggerColumnChanged({sheet:s,sheetName:s._name,col:o,sheetArea:r,propertyName:h,oldValue:u})},o.prototype.isValid=function(e,t,o){var n,r;try{if((n=this)._validatingRow=e,n._validatingColumn=t,n._validatingValue=o,n._isValidatingCell=!0,r=n.getDataValidator(e,t))return r.isValid(n,e,t,o)}finally{n._validatingRow=-1,n._validatingColumn=-1,n._validatingValue=i,n._isValidatingCell=!1}return!0},o.prototype.addSelection=function(e,o,n,r){var i=this;i._bindToAutoRefresh(function(e,o,n,r){var a,s,l=e,u=o,c=n,h=r;-1!==l&&-1!==u&&((a=i._getSpanModel().getSpans())&&a.length>0&&(l=(s=i._cellRangeInflate(a,new t.Range(e,o,n,r))).row,u=s.col,c=s.rowCount,h=s.colCount)),i._selectionModel.add(l,u,c,h)})(e,o,n,r)},o.prototype.setSelection=function(e,t,o,n){this._setSelectionImp(e,t,o,n,2)},o.prototype._setSelectionImp=function(e,o,n,r,i){var a,s,l,u,c,h=this,p=h.getRowCount(),d=h.getColumnCount();switch(e>=p&&(e=p-1),(a=e)<0&&(a=0),s=o,o>=d&&(o=d-1),s<0&&(s=0),h._clearSelectionImp(),l=!0,i){case 1:l=!0;break;case 0:l=!1;break;case 2:l=t.FocusHelper.isActiveElement(h)}u=1,a<h.frozenRowCount?u=0:a>=p-h._frozenTrailingRowCount&&(u=2),c=1,s<h.frozenColCount?c=0:s>=d-h._frozenTrailingColCount&&(c=2),h._setActiveCellImp(a,s,u,c,!l),h.addSelection(e,o,n,r)},o.prototype.getSelections=function(){return this._selectionModel.toArray()},o.prototype.canSelect=function(e,t,o){var n,r,i,a,s,l,u=!1!==this._protectionOption.allowSelectLockedCells,c=!1!==this._protectionOption.allowSelectUnlockedCells;if(!this.isProtected||u&&c)return!0;if(!u&&!c)return!1;if(u===(n=o?o.locked:this.getStyleProperty(e,t,"locked"))&&(e<0||t<0)){var h=t<0,p=e<0,d=e<0?this.getRowCount():1;e=e<0?0:e,r=t<0?this.getColumnCount():1,t=t<0?0:t;var f=this._getModel(),g=f.dataTable,m=e+d-1,_=t+r-1;for(s=e;s<=m;s++)if(i=g[s])for(l=t;l<=_;l++)if((a=i[l])&&a.style&&u!==a.style.locked)return!1;if(p)for(s=e;s<=m;s++)if((o=f.getStyle(s,-1))&&u!==o.locked)return!1;if(h)for(l=t;l<=_;l++)if((o=f.getStyle(-1,l))&&u!==o.locked)return!1}return u===n},o.prototype.canSelectFloatingObject=function(e){return!this.isProtected||!e.isLocked()||this._protectionOption.allowEditObjects},o.prototype.canEditComment=function(e){return!this.isProtected||this._protectionOption.allowEditObjects||e&&!e.locked()},o.prototype.canEditFloatingObject=function(e){return!this.isProtected||!e.isLocked()||this._protectionOption.allowEditObjects},o.prototype.canDoResizeRows=function(){return!this.isProtected||this._protectionOption.allowResizeRows},o.prototype.canDoResizeColumns=function(){return!this.isProtected||this._protectionOption.allowResizeColumns},o.prototype._addSpanImp=function(e,o,n,r,s){var l=this;l._bindToAutoRefresh(function(e,o,n,r,s){var u,c,h,p,d;if((s===a||s===i)&&(s=3),(u=l._getSpanModel(s)).clear(e,o,n,r),c=new t.Range(e,o,n,r),h=l._getActualRange(c,s),u.addSpan(h),3===s){for(p=l.getSelections(),d=0;d<p.length;d++)p[d].intersect(e,o,n,r)&&(p[d]=p[d].union(c));l._selectionModel.fromArray(p)}})(e,o,n,r,s)},o.prototype.addSpan=function(e,o,n,r,i){var a;if((1!==n||1!==r)&&0!==i&&(a=!0,(3===i||void 0===i)&&(a=this._checkArrayFormula(e,o,n,r,!1)),a)){if(this._getSpanModel(i).hasPartSpans(e,o,n,r))throw new Error(t.SR.Exp_InvalidRange);this._addSpanImp(e,o,n,r,i),this._updateCommentsInSpanChangedArea(!0,e,o,n,r)}},o.prototype.removeSpan=function(e,t,o){var n=this;this._bindToAutoRefresh(function(e,t,o){var r,s,l;for((o===a||o===i)&&(o=3),r=n._getSpanModel(o),s=0;s<r.length;s++)if((l=r[s]).row===e&&l.col===t)return void r.removeSpan(s,1)})(e,t,o),n._updateCommentsInSpanChangedArea(!1,e,t)},o.prototype._updateCommentsInSpanChangedArea=function(e,t,o,n,r){var a,s,l;if(e&&this._commentManager)for(a=this._commentManager.getCommentList(),s=0;s<a.length;s++){var u,c=(u=a[s])._rowIndex,h=u._colIndex;(c!==t||h!==o)&&c>=t&&c<t+n&&h>=o&&h<o+r&&this.setComment(c,h,i)}(u=this.getComment(t,o))&&((l=this._commentManager.getCommentView(u))&&l.updateLayoutWhenCellSpanChanged())},o.prototype.repaint=function(e){this._paintSuspended||this._render.repaint(e)},o.prototype.startEdit=function(e,t){this._startEditImp(this._getCanvas(),this._activeRowIndex,this._activeColIndex,i,i,e,t)},o.prototype.editorStatus=function(){return this._editorStatus?this._editorStatus:0},o.prototype.isEditing=function(){return 1===this._editorStatus||2===this._editorStatus},o.prototype.doKeyDown=function(e){this._eventHandler.doKeyDown(e)},o.prototype.doKeyUp=function(e){this._eventHandler.doKeyUp(e)},o.prototype.doCompositionStart=function(e){this._eventHandler.doCompositionStart(e)},o.prototype.removeKeyMap=function(e,t,o,n,r){this.removeKeyMapInternal(e,t,o,n,r,this.keyMap)},o.prototype.removeKeyMapInternal=function(e,t,o,n,r,i){var a,s;if(i)for(r="function"!=typeof r&&r,a=0;a<i.length;a++)if((s=i[a])&&s.key===e&&s.ctrl===t&&s.shift===o&&s.alt===n&&s.meta===r){i.splice(a,1);break}},o.prototype.removeFloatingObjectKeyMap=function(e,t,o,n,r){this.removeKeyMapInternal(e,t,o,n,r,this.floatingObjectKeyMap)},o.prototype.removeSlicerKeyMap=function(e,t,o,n,r){this.removeKeyMapInternal(e,t,o,n,r,this._slicerKeyMap)},o.prototype.removeCommentKeyMap=function(e,t,o,n,r){this.removeKeyMapInternal(e,t,o,n,r,this._commentKeyMap)},o.prototype.addKeyMap=function(e,t,o,n,r,i){this.keyMap||(this.keyMap=[]),this.addKeyMapInternal(e,t,o,n,r,i,this.keyMap)},o.prototype.addKeyMapInternal=function(e,o,n,r,i,a,s){s||(s=[]);var l=a||i,u=(i=a&&i||!1,a=l,this._getKeyActionInternal(e,o,n,r,i,s));u?u.action=a:s.push(new t.KeyMap(e,o,n,r,i,a))},o.prototype.addFloatingObjectKeyMap=function(e,t,o,n,r,i){this.floatingObjectKeyMap||(this.floatingObjectKeyMap=[]),this.addKeyMapInternal(e,t,o,n,r,i,this.floatingObjectKeyMap)},o.prototype.addSlicerKeyMap=function(e,t,o,n,r,i){this._slicerKeyMap||(this._slicerKeyMap=[]),this.addKeyMapInternal(e,t,o,n,r,i,this._slicerKeyMap)},o.prototype.addCommentKeyMap=function(e,t,o,n,r,i){this._commentKeyMap||(this._commentKeyMap=[]),this.addKeyMapInternal(e,t,o,n,r,i,this._commentKeyMap)},o.prototype._moveFormulaTextBoxCell=function(e,o,n,r){var a,s,l,u,c,h,p,f=this,g=f._formulaTextBox;if(g&&g.canAppendRange()&&(!f.parent||f.parent.canUserEditFormula())&&f._enableFormulaTextbox){var m=f._getKeyboardAppendingInfo(),_=m.anchorRow,y=m.anchorCol,C=m.leadingRow,w=m.leadingCol;switch((typeof n===d||n===i)&&(n=_),(typeof r===d||r===i)&&(r=y),a=f._eventHandler,e){case 3:h=f._getMoveLeftCell(n,r,o,C);break;case 4:h=f._getMoveRightCell(n,r,o,C);break;case 1:h=f._getMoveUpCell(n,r,o,w);break;case 2:h=f._getMoveDownCell(n,r,o,w);break;case 5:h=f._getMoveFirstCell();break;case 6:h=f._getMoveLastCell()}h&&(s=h.row,l=h.col,u=h.leadingCellRow?h.leadingCellRow:s,c=h.leadingCellCol?h.leadingCellCol:l,f._canMoveCurrentTo(s,l))&&(m.anchorRow=s,m.anchorCol=l,m.leadingRow=u,m.leadingCol=c,(p=a.rangeToString(new t.Range(s,l,1,1)))&&g.appendRange(p,!1,!0),s>=0&&l>=0&&f._scrollByMoveCell(s,l))}},o.prototype._changeFormulaTextBoxActiveRange=function(e,o){var n,r,i,a=this._formulaTextBox;if(a&&a.canAppendRange()&&(!this.parent||this.parent.canUserEditFormula())&&this._enableFormulaTextbox){var s,l=this._eventHandler,u=this._getKeyboardAppendingInfo(),c=u.anchorRow,h=u.anchorCol;a.isAppending()?(n=a.getActiveRange(),s=l.stringToRange(n.text)):s=new t.Range(c,h,1,1),s&&(r=this._getKeyboardSelectedRange(s,e,o,c,h),(i=l.rangeToString(r))&&a.appendRange(i,!0,!1))}},o.prototype._getKeyboardAppendingInfo=function(){var e=this._formulaTextBox,t=this._eventHandler;return e.isAppending()?t._formulaRangeAppendingInfo:t._formulaRangeAppendingInfo={anchorRow:this._activeRowIndex,anchorCol:this._activeColIndex,leadingRow:this._leadingCellRow,leadingCol:this._leadingCellCol}},o.prototype.moveActiveCell=function(e,o,n,r){var s,l,u=this,c={sheet:u,sheetName:u._name,row:u._activeRowIndex,col:u._activeColIndex,cancel:!1};u.triggerLeaveCell(c),c&&!0===c.cancel||u.endEdit()&&(s=u._activeRowIndex,l=u._activeColIndex,(n===a||n===i)&&(n=u._activeRowIndex),(r===a||r===i)&&(r=u._activeColIndex),t.Direction,3===e?u._moveActiveCellLeft(n,r,o):4===e?u._moveActiveCellRight(n,r,o):1===e?u._moveActiveCellUp(n,r,o):2===e?u._moveActiveCellDown(n,r,o):5===e?u._moveActiveCellFirst():6===e&&u._moveActiveCellLast(),u.moveActiveCellEnd(e,s,l))},o.prototype._moveActiveCellInSelection=function(e){var t,o,n=this,r={sheet:n,sheetName:n._name,row:n._activeRowIndex,col:n._activeColIndex,cancel:!1};n.triggerLeaveCell(r),r&&!0===r.cancel||n.endEdit()&&(t=n._activeRowIndex,o=n._activeColIndex,3===e?n._moveActiveCellLeftInSelection(n._activeRowIndex,n._activeColIndex):4===e&&n._moveActiveCellRightInSelection(n._activeRowIndex,n._activeColIndex),n.moveActiveCellEnd(e,t,o))},o.prototype.doDataItemChanged=function(){var e=this._bindingManager;e&&e.doDataItemChanged()},o.prototype.moveActiveCellEnd=function(e,o,n){var r,i,a,s,l,u,c=this,h=c._eventHandler,p=c._selectionModel.toArray(),d=!1;c._isNavigateInSelection||(r=c._fixRange(c._getActiveSelectedRange()),(c._selectionModel.length>1||r.rowCount>1||r.colCount>1)&&(d=!0),c._clearSelectionImp());var f=c._activeRowIndex,g=c._activeColIndex,m=c._getSpanModel().find(f,g);if(m?(c._activeRowCount=m.rowCount,c._activeColCount=m.colCount):(c._activeRowCount=1,c._activeColCount=1),!c._isNavigateInSelection){var _=c._getExtendedRange(f,g),y=c.selectionPolicy(),C=c.selectionUnit();0===y?c._selectionModel.clear():1===y&&c._selectionModel.clear(),1===C?(_.col=-1,_.colCount=-1):2===C&&(_.row=-1,_.rowCount=-1),c._replaceActiveSelectedRange(_.row,_.col,_.rowCount,_.colCount,!1),i=c._selectionModel.toArray(),h._notEqualSelecions(p,i)&&(t.Events,c.triggerSelectionChanging({sheet:c,sheetName:c._name,oldSelections:p,newSelections:i}),c.triggerSelectionChanged({sheet:c,sheetName:c._name}))}if(c._scrollTopRow,c._scrollByMoveCell(f,g),o!=f&&c.doDataItemChanged(),a=c._render,d){var w=c._getSheetLayout(),v=w.headerX,S=w.headerY,x=w.width-v,R=w.height-S;a.copyDoubleBuffer(v,S,x,R),a.repaint(new t.Rect(v,S,x,w.colHeaderHeight)),a.repaint(new t.Rect(v,S,w.rowHeaderWidth,R)),a.paintAdornment(a._getCtx())}else(u=c._getSpanModel().find(o,n))?(s=u.rowCount,l=u.colCount):(s=1,l=1),a.repaintSelection(new t.Range(f,g,c._activeRowCount,c._activeColCount).union(new t.Range(o,n,s,l)));c.triggerEnterCell({sheet:c,sheetName:c._name,row:f,col:g}),h._updateValidationUI(f,g)},o.prototype._scrollByMoveCell=function(e,t){var o,n,r,i=this,a=i.frozenColCount?i._getNextVisualColumn(i.frozenColCount-1):i._getFirstVisualColumn(),s=i.frozenRowCount?i._getNextVisualRow(i.frozenRowCount-1):i._getFirstVisualRow();if(t<i._scrollLeftCol&&t>=a&&i._setLeftColumn(i._getPrevVisualColumn(t+1)),t>i._getLastFullyVisibleColumn()&&t<=i._getLastVisualColumn()){var l=0,u=t,c=i._getSheetLayout(),h=i._getSpanModel().find(e,u);for(h&&(u=h.col+h.colCount-1);u>i._scrollLeftCol&&!((l+=i._getZoomColumnWidth(u))>c.viewportWidth);)u--;o=i._getNextVisualColumn(u),i._setLeftColumn(o)}if(e<i._scrollTopRow&&e>=s&&i._setTopRow(i._getPrevVisualRow(e+1)),e>i._getLastFullyVisibleRow()&&e<=i._getLastVisualRow()){var p=0,d=e,f=i._getSpanModel().find(d,t);for(f&&(d=f.row+f.rowCount-1),n=i._getSheetLayout();d>i._scrollTopRow&&!((p+=i._getZoomRowHeight(d))>n.viewportHeight);)d--;r=i._getNextVisualRow(d),i._setTopRow(r)}e===i._getLastVisualRow()&&i._setTopRow(i._getLastPageTopRow()),t===i._getLastVisualColumn()&&i._setLeftColumn(i._getLastPageLeftColumn())},o.prototype.commitArrayFormula=function(){this._endEditImp(!1,1)},o.prototype._endEditImp=function(e,t){var o,n;if(!this.isEditing())return!0;o=this.isPaintSuspended(),this.isPaintSuspended(!0);try{n=this._endEditCore(e,t)}finally{return n?this.isPaintSuspended(o):this._paintSuspended=o,n}},o.prototype._endEditCore=function(e,o){var n,r,a,s,l,u,c,h,p,d,f,g=this,m=g._eventHandler,_=g._editor,C=g.getCellType(g._activeRowIndex,g._activeColIndex),w={sheet:g,row:g._activeRowIndex,col:g._activeColIndex,sheetArea:3};if(!C.isImeAware(w)&&m&&m.changeFocusHolder(),_&&_.parentNode){if(r=C.getEditorValue(_,w),a={sheet:g,sheetName:g._name,row:g._activeRowIndex,col:g._activeColIndex,editor:_,editingText:r,cancel:!1},g.triggerEditEnd(a),a&&!0===a.cancel)return;if(g.triggerEditEnding(a),a&&!0===a.cancel)return;if(g._detachFormulaTextBox(),s=this.parent&&this.parent._attachedFormulaTextBox,y.activeElement===(s&&s._host)&&m.changeFocusHolder(),g._activeRowIndex>=0&&g._activeColIndex>=0&&(l=_._oldValue,C.isEditingValueChanged(l,r,w)||1===o))if(e)C.setEditorValue(_,l,w),C.selectAll(_,w);else if(u=!C.hasOwnProperty("_autoFormatValue")||C._autoFormatValue,c={row:g._activeRowIndex,col:g._activeColIndex,newValue:r,autoFormat:u},1===o&&(h=[g._getActiveSelectedRange()],c.ranges=h,c.endEditType=o),n=new t.UndoRedo.CellEditUndoAction(g,c),g._doCommand(n),!0===(2===n.applyResult))return C.focus(_,w),g._attachFormulaTextBox(C.getEditingElement()),!1;if(g._dirty=!0,C.deactivateEditor(_,w),C.isImeAware(w))t.util.browser.msie&&9===parseFloat(t.util.browser.version)&&m?m.changeFocusHolder():(t.GC$(_).css("width","0"),t.GC$(_).css("height","0"),t.GC$(_).css("overflow","hidden"));else for(p=g._getHost(),d=_;d;)d.parentNode===p?p.removeChild(d):d=d.parentNode}return g._editingTimeValue=!1,g.triggerEditEnded({sheet:g,sheetName:g._name,row:g._activeRowIndex,col:g._activeColIndex,editingText:r}),0!==g._editorStatus&&(f=g._editorStatus,g._editorStatus=0,g.triggerEditorStatusChanged({sheet:g,sheetName:g._name,oldStatus:f,newStatus:0})),g._editor=i,!n||1!==n.applyResult},o.prototype.endEdit=function(e){return this._endEditImp(e)},o.prototype.hitTest=function(e,t,o){var n,r,s,l,u,c,h,p,d,f,g,m,_=this;return _._getSheetLayout(),n={x:e,y:t,rowViewportIndex:i,colViewportIndex:i,row:-1,col:-1,resizeInfo:i,hitTestType:i,groupHitInfo:i,filterButtonHitInfo:i,dragInfo:i,cellTypeHitInfo:i,floatingObjectHitInfo:i,formulaRangeHitInfo:i,commentHitInfo:i},(r=_._render.groupHitTest(e,t))?n.groupHitInfo=r:(s=_._getRowViewportIndexFromY(t),l=_._getColumnViewportIndexFromX(e),n.rowViewportIndex=s,n.colViewportIndex=l,n.row=_._getRowIndexFromY(t,s),n.col=_._getColumnIndexFromX(e,l),s>=0&&s<=2&&l>=0&&((u=_._getCellLayoutByCell(s,l,a,n.row,n.col))&&!0!==o&&(n.row=u.row,n.col=u.col)),n.hitTestType=_._getSheetArea(s,l),(d=(c=_._eventHandler).getDragInfo(n,e,t))?n.dragInfo=d:(h=c.getResizingRowCol(n,e,t,5))?n.resizeInfo=h:(g=c.getFormulaRangeHitInfo(n,e,t))?n.formulaRangeHitInfo=g:(m=this._getCommentHitInfo(e,t))?n.commentHitInfo=m:(p=this._getFloatingObjectHitInfo(e,t))?n.floatingObjectHitInfo=p:(f=_._getFilterButtonHitInfo(n,e,t))?n.filterButtonHitInfo=f:n.cellTypeHitInfo=_._getCellTypeHitInfo(n,e,t)),n},o.prototype.getCellRect=function(e,o,n,r){var a,s,l=3;if(-1===n?l=1:-1===r&&(l=2),s=(a=this)._getSheetLayout(),-1===n&&-1===r)return new t.Rect(s.headerX,s.headerY,s.rowHeaderWidth,s.colHeaderHeight);var u=a.getBounds(),c=a.getRowCount(),h=a.getColumnCount();(typeof n===d||n===i)&&(e<a.frozenRowCount?n=0:e<c-a._frozenTrailingRowCount?n=1:e<c&&(n=2)),(typeof r===d||r===i)&&(o<a.frozenColCount?r=0:o<h-a._frozenTrailingColCount?r=1:o<h&&(r=2));var p=a._getRowLayout(n,l).findRow(e),f=a._getColumnLayout(r,l).findCol(o),g=a._getCellLayout(n,r,l).findCell(e,o);return g?new t.Rect(g.x-u.x,g.y-u.y,g.width,g.height):p&&f?new t.Rect(f.x-u.x,p.y-u.y,f.width,p.height):new t.Rect},o.prototype._setActiveCellCore=function(e,t,o){var n=this._eventHandler,r=!1;e!==i&&e!==a&&(this._activeRowIndex=e,r=!0),t!==i&&t!==a&&(this._activeColIndex=t,r=!0),!o&&n&&r&&n.changeFocusHolder()},o.prototype._setActiveCellImp=function(e,o,n,r,i){var a=this,s=a._activeRowIndex,l=a._activeColIndex,u=a._getSpanModel().find(e,o);if(u?(a._activeRowCount=u.rowCount,a._activeColCount=u.colCount):(a._activeRowCount=1,a._activeColCount=1),!a._paintSuspended){var c=a._getSpanModel().find(s,l),h=1,p=1;c&&(h=c.rowCount,p=c.colCount),a._render.repaintSelection(new t.Range(s,l,h,p))}a.activeRowViewportIndex=n,a.activeColViewportIndex=r,a._setActiveCellCore(e,o,i),a._leadingCellRow=e,a._leadingCellCol=o},o.prototype.setActiveCell=function(e,t,o,n){this._setActiveCellAndSelection(e,t,o,n,2)},o.prototype._setActiveCellAndSelection=function(e,o,n,r,i){var a=this;a._bindToAutoRefresh(function(e,o,n,r,i){var s,l,u=a.getRowCount(),c=a.getColumnCount();switch(e<0?e=0:e>=u&&(e=u-1),o<0?o=0:o>=c&&(o=c-1),a._clearSelectionImp(),s=!0,i){case 1:s=!0;break;case 0:s=!1;break;case 2:s=t.FocusHelper.isActiveElement(a)}a._setActiveCellImp(e,o,n,r,!s),(l=a._getSpanModel().find(e,o))?a._setSelectedRange(l.row,l.col,l.rowCount,l.colCount):a._setSelectedRange(e,o,1,1)})(e,o,n,r,i)},o.prototype.getActiveRowIndex=function(){return this._activeRowIndex},o.prototype.getActiveColumnIndex=function(){return this._activeColIndex},o.prototype.selectionPolicy=function(e){return 0===arguments.length?this._selectionModel.selectionPolicy:(this._selectionModel.selectionPolicy=e,this)},o.prototype.selectionUnit=function(e){return 0===arguments.length?this._selectionModel.selectionUnit:(this._selectionModel.selectionUnit=e,this)},o.prototype.getRowResizable=function(e,t){return this._sheetModelManager.getRowInfos(t).getResizeable(e)},o.prototype.setRowResizable=function(e,t,o){this.setRowColInfo(e,t,"resizable",!0,o)},o.prototype.setRowColInfo=function(e,t,o,n,r){(typeof r===d||r===i)&&(r=3);var a,s=this._sheetModelManager[n?"getRowInfos":"getColInfos"](r);switch(o){case"resizable":a=s.getResizeable(e),s.setResizeable(e,t);break;case"pageBreak":a=s.getPageBreak(e),s.setPageBreak(e,t);break;case"isVisible":a=s.getVisible(e),s.setVisible(e,t);break;case B:a=s.getSize(e),s.setSize(e,t),3===r&&a!==t&&(0===a||0===t)&&this.recalcRows([e]);break;case V:a=s.getSize(e),s.setSize(e,t)}n?this.triggerRowChanged({sheet:this,sheetName:this._name,row:e,sheetArea:r,propertyName:o,oldValue:a}):this.triggerColumnChanged({sheet:this,sheetName:this._name,col:e,sheetArea:r,propertyName:o,oldValue:a})},o.prototype.getColumnResizable=function(e,t){return this._sheetModelManager.getColInfos(t).getResizeable(e)},o.prototype.setColumnResizable=function(e,t,o){this.setRowColInfo(e,t,"resizable",!1,o)},o.prototype.getRowHeight=function(e,t){var o,n,r,a,s;return(typeof t===d||t===i)&&(t=3),(3===t||2===t)&&(n=(o=this._sheetModelManager.getDataModel(t))&&o.getRowCount()||0,e<0||e>=n||this.filterRowsVisibleInfo&&!this.filterRowsVisibleInfo.getRowVisible(e)||(r=this.rowRangeGroup)&&!r._isEmpty()&&r.isCollapsed(e))?0:(a=this.defaults.rowHeight,1===t&&(a=this.defaults.colHeaderRowHeight),(s=this._sheetModelManager.getRowInfos(t).getSize(e))||0===s?s:a)},o.prototype._getActualRowHeight=function(e,t){var o,n;return(typeof t===d||t===i)&&(t=3),o=this.defaults.rowHeight,1===t&&(o=this.defaults.colHeaderRowHeight),(n=this._sheetModelManager.getRowInfos(t).getActualSize(e))||0===n?n:o},o.prototype.setRowHeight=function(e,t,o){this.setRowColInfo(e,t,B,!0,o),this._needSyncVScrollbarSize=!0,this.invalidate()},o.prototype.getRowVisible=function(e,t,o){var n;return(typeof t===d||t===i)&&(t=3),!(!o&&(this.isRowFilterOut(e,t)||(3===t||2===t)&&(n=this.rowRangeGroup,n&&!n._isEmpty()&&0<=e&&e<this.getRowCount(t)&&n.isCollapsed(e))))&&this._sheetModelManager.getRowInfos(t).getVisible(e)},o.prototype.isRowFilterOut=function(e,t){return(typeof t===d||t===i)&&(t=3),!(3!==t&&2!==t||!this.filterRowsVisibleInfo||this.filterRowsVisibleInfo.getRowVisible(e))},o.prototype.hasRowFilterOut=function(){return this.filterRowsVisibleInfo&&this.filterRowsVisibleInfo.hasFilterOut()},o.prototype.setRowVisible=function(e,t,o){var n=this;n._bindToAutoRefresh(function(e,t,o){n.setRowColInfo(e,t,"isVisible",!0,o),n._needSyncVScrollbarSize=!0})(e,t,o)},o.prototype.getColumnWidth=function(e,t){var o,n,r,a,s;return(typeof t===d||t===i)&&(t=3),o=this.defaults.colWidth,2===t&&(o=this.defaults.rowHeaderColWidth),(3===t||1===t)&&(r=(n=this._sheetModelManager.getDataModel(t))&&n.getColumnCount()||0,e<0||e>=r||(a=this.colRangeGroup)&&!a._isEmpty()&&a.isCollapsed(e))?0:(s=this._sheetModelManager.getColInfos(t).getSize(e))||0===s?s:o},o.prototype._getActualColumnWidth=function(e,t){var o,n;return(typeof t===d||t===i)&&(t=3),o=this.defaults.colWidth,2===t&&(o=this.defaults.rowHeaderColWidth),(n=this._sheetModelManager.getColInfos(t).getActualSize(e))||0===n?n:o},o.prototype.setColumnWidth=function(e,t,o){this.setRowColInfo(e,t,V,!1,o),this._needSyncHScrollbarSize=!0,this.invalidate()},o.prototype.getColumnVisible=function(e,t){if((typeof t===d||t===i)&&(t=3),3===t||1===t){var o=this.colRangeGroup;if(o&&!o._isEmpty()&&0<=e&&e<this.getColumnCount(t)&&o.isCollapsed(e))return!1}return this._sheetModelManager.getColInfos(t).getVisible(e)},o.prototype.setColumnVisible=function(e,t,o){var n=this;n._bindToAutoRefresh(function(e,t,o){this.setRowColInfo(e,t,"isVisible",!1,o),n._needSyncHScrollbarSize=!0})(e,t,o)},o.prototype.zoom=function(e){var t=this;return 0===arguments.length?t._zoomFactor:(e=parseFloat(e),isNaN(e)||!isFinite(e)?t:(e>4?e=4:e<.25&&(e=.25),t._bindToAutoRefresh(function(e){t.showEditingLocator&&t._showEditingLocator(),t._zoomFactor=e,t._needSyncHScrollbarSize=!0,t._needSyncVScrollbarSize=!0})(e),t))},o.prototype.invalidateLayout=function(){var e=this,o=e._eventHandler;e._layoutModel=i,e._cachedGroupLayout=i,e._rowLayoutCache={colHeader:i,viewport:i,colFooter:i},e._colLayoutCache={rowHeader:i,viewport:i},e._filterButtonsModel=i,o&&t.FocusHelper.isActiveElement(e)&&o._updateValidationUI(e._activeRowIndex,e._activeColIndex),e._needSyncHScrollbarSize&&(e._syncHScrollbarSize(),e._needSyncHScrollbarSize=!1),e._needSyncVScrollbarSize&&(e._syncVScrollbarSize(),e._needSyncVScrollbarSize=!1),e._dirty=!0},o.prototype.invalidate=function(){!this._paintSuspended&&this._layoutSuspended<=0&&(this.invalidateLayout(),this.repaint())},o.prototype.getViewportHeight=function(e){var t=this._getSheetLayout();return 0===e?t.frozenHeight:1===e?t.viewportHeight:2===e?t.frozenTrailingHeight:0},o.prototype.getViewportWidth=function(e){var t=this._getSheetLayout();return 0===e?t.frozenWidth:1===e?t.viewportWidth:2===e?t.frozenTrailingWidth:0},o.prototype.getViewportTopRow=function(e){return 0===e?0:1===e?l(this.frozenRowCount,this._scrollTopRow):2===e?l(this.frozenRowCount,this.getRowCount()-this._frozenTrailingRowCount):-1},o.prototype.getViewportBottomRow=function(e){var t;if(2===e)return this.getRowCount()-1;var o=this.getViewportTopRow(e),n=this.getViewportHeight(e),r=0,i=0,a=this.getRowCount()-this._frozenTrailingRowCount;for(0===e&&(a=s(this.frozenRowCount,a)),t=o;t<a&&r<n;t++,i++)r+=this._getZoomRowHeight(t);return o+i-1},o.prototype.getViewportLeftColumn=function(e){return 0===e?0:1===e?l(this.frozenColCount,this._scrollLeftCol):2===e?l(this.frozenColCount,this.getColumnCount()-this._frozenTrailingColCount):-1},o.prototype.getViewportRightColumn=function(e){var t;if(2===e)return this.getColumnCount()-1;var o=this.getViewportLeftColumn(e),n=this.getViewportWidth(e),r=0,i=0,a=this.getColumnCount()-this._frozenTrailingColCount;for(0===e&&(a=s(this.frozenColCount,a)),t=o;t<a&&i<n;t++,r++)i+=this._getZoomColumnWidth(t);return o+r-1},o.prototype.clearSelection=function(){var e=this;this._bindToAutoRefresh(function(){e._clearSelectionImp(),e._setActiveCellImp(0,0),e.unSelectAllComments()})()},o.prototype._clearSelectionImp=function(){this._selectionModel.clear()},o.prototype._validationError=function(e,t,o){var n=this.getDataValidator(e,t),r={sheet:this,sheetName:this._name,row:e,col:t,validator:n,validationResult:0};return this.triggerValidationError(r),r.validationResult},o.prototype.getSpans=function(e,t){(t===a||t===i)&&(t=3);var o=this._getSpanModel(t);return o?o.getSpans(e):[]},o.prototype.getSpan=function(e,t,o){return(o===a||o===i)&&(o=3),this._getSpanModel(o).find(e,t)},o.prototype.getCell=function(e,o,n){return new t.Cell(this,e,o,n)},o.prototype.getCells=function(e,t,o,n,r){var i=this.getCell(e,t,r);return i.row2=o,i.col2=n,i},o.prototype.getRow=function(e,o){return new t.Row(this,e,o)},o.prototype.getRows=function(e,t,o){var n=this.getRow(e,o);return n.index2=t,n},o.prototype.getColumn=function(e,o){return new t.Column(this,e,o)},o.prototype.getColumns=function(e,t,o){var n=this.getColumn(e,o);return n.index2=t,n},o.prototype.setBorder=function(e,t,o,n){var r,s;(n===a||n===i)&&(n=3),s=(r=this).isPaintSuspended(),r.isPaintSuspended(!0);try{var l,u,c=r._getActualRange(e,n),h=c.row,p=c.col,d=c.rowCount,f=c.colCount;if(o.left||o.all||o.outline)for(l=0;l<d;l++)r.getCell(h+l,p,n).borderLeft(t);if(o.top||o.all||o.outline)for(u=0;u<f;u++)r.getCell(h,p+u,n).borderTop(t);if(o.right||o.all||o.outline)for(l=0;l<d;l++)r.getCell(h+l,p+f-1,n).borderRight(t);if(o.bottom||o.all||o.outline)for(u=0;u<f;u++)r.getCell(h+d-1,p+u,n).borderBottom(t);if(o.innerHorizontal||o.all||o.inside)for(l=0;l<d-1;l++)for(u=0;u<f;u++)r.getCell(h+l,p+u,n).borderBottom(t),r.getCell(h+l+1,p+u,n).borderTop(t);if(o.innerVertical||o.all||o.inside)for(u=0;u<f-1;u++)for(l=0;l<d;l++)r.getCell(h+l,p+u,n).borderRight(t),r.getCell(h+l,p+u+1,n).borderLeft(t)}finally{r.isPaintSuspended(s)}},o.prototype.search=function(e){var o,n,r,a,s;if(!e||!t.features.search)return i;var l=e.sheetArea,u=e.searchString,c=e.searchTarget,h=e.searchFlags,p=this.getRowCount(l),d=this.getColumnCount(l);if(!u||0===c||p<=0&&d<=0)return new t.SearchResult;for(-1===e.rowStart&&(e.rowStart=0),-1===e.columnStart&&(e.columnStart=0),-1===e.findBeginRow&&(e.findBeginRow=e.rowStart),-1===e.findBeginColumn&&(e.findBeginColumn=e.columnStart),-1===e.rowEnd&&(e.rowEnd=p-1),-1===e.columnEnd&&(e.columnEnd=d-1),o=new t.SearchResult,n=new t.CellsEnumerator(this,e),(8&h)>0&&(n.isBlockRange=!0);n.moveNext();){var f=n.currentRow,g=n.currentColumn,_=n.current();if(_&&((1&c)>0&&(r=_.text(),this._trySearch(r,u,h)&&""!==r&&(o.searchFoundFlag|=1,o.foundString=r)),(8&c)>0&&(a=typeof(a=_.formula())===m?a.toString():i,this._trySearch(a,u,h)&&""!==a&&(o.searchFoundFlag|=8,o.foundString=a)),(4&c)>0&&(typeof(s=_.tag())===m&&this._trySearch(s,u,h)&&""!==s&&(o.searchFoundFlag|=4,o.foundString=s)),0!==o.searchFoundFlag))return o.foundRowIndex=f,o.foundColumnIndex=g,o}return new t.SearchResult},o.prototype.showCell=function(e,t,o,n){var r,i,a=this,s=a.getRowCount(),l=a.getColumnCount();if(!(e<0||e>=s||t<0||t>=l)){var u=a._getColumnViewportIndex(t),c=a._getRowViewportIndex(e),h=a.getViewportTopRow(c),p=a.getViewportLeftColumn(u);1===u&&(t=a._getNewLeftColumn(t,n)),1===c&&(e=a._getNewTopRow(e,o)),r=!1,1===c&&e!==h&&(e>a._getLastVisualScrollRow()&&(e=a._getLastVisualScrollRow()),a._scrollTopRow=e,a._syncVScrollbarPosition(),r=!0),1===u&&t!==p&&(t>a._getLastVisualScrollColumn()&&(t=a._getLastVisualScrollColumn()),a._scrollLeftCol=t,a._syncHScollbarPosition(),r=!0),r&&((i=a.parent)&&!i._scrollbarShowMax&&(a._needSyncHScrollbarSize=!0,a._needSyncVScrollbarSize=!0),a.invalidateLayout(),a.repaint())}},o.prototype._getRowViewportIndex=function(e){var t=1;return e<this.frozenRowCount?t=0:e>=this.getRowCount()-this._frozenTrailingRowCount&&(t=2),t},o.prototype._getColumnViewportIndex=function(e){var t=1;return e<this.frozenColCount?t=0:e>=this.getColumnCount()-this._frozenTrailingColCount&&(t=2),t},o.prototype._getNewLeftColumn=function(e,t){var o,n=this,r=n._zoomFactor,i=n._getColumnViewportIndex(e),a=n.getViewportLeftColumn(i);if(0!==t)if(1===t)for(o=u((n.getViewportWidth(i)-u(n.getColumnWidth(e)*r))/2);0<e&&!((o-=u(n.getColumnWidth(e-1)*r))<0);e--);else if(2===t)for(o=n.getViewportWidth(i)-u(n.getColumnWidth(e)*r);0<e&&!((o-=u(n.getColumnWidth(e-1)*r))<0);e--);else if(3===t&&e>=a)for(o=n.getViewportWidth(i)-u(n.getColumnWidth(e)*r);a<e&&!((o-=u(n.getColumnWidth(e-1)*r))<0);e--);return e},o.prototype._getNewTopRow=function(e,t){var o,n=this,r=n._zoomFactor,i=n._getRowViewportIndex(e),a=n.getViewportTopRow(i);if(0!==t)if(1===t)for(o=u((n.getViewportHeight(i)-u(n.getRowHeight(e)*r))/2);0<e&&!((o-=u(n.getRowHeight(e-1)*r))<0);e--);else if(2===t)for(o=n.getViewportHeight(i)-u(n.getRowHeight(e)*r);0<e&&!((o-=u(n.getRowHeight(e-1)*r))<0);e--);else if(3===t&&!(e<a||-1===a))for(o=n.getViewportHeight(i)-u(n.getRowHeight(e)*r);a<e&&!((o-=u(n.getRowHeight(e-1)*r))<0);e--);return e},o.prototype.showColumn=function(e,t){this.showCell(this._scrollTopRow,e,0,t)},o.prototype.showRow=function(e,t){this.showCell(e,this._scrollLeftCol,t,0)},o.prototype.bind=function(e,t,o){this._eventHandler.bind(e+b,t,o)},o.prototype.unbind=function(e,t){this._eventHandler.unbind(e+b,t)},o.prototype.unbindAll=function(){this._eventHandler.unbind(b)},o.prototype._bind=function(e,t,o){e.indexOf(".")>=0?this._eventHandler.bind(e,t,o):this._eventHandler.bind(e+T,t,o)},o.prototype._unbind=function(e,t){e.indexOf(".")>=0?this._eventHandler.unbind(e,t):this._eventHandler.unbind(e+T,t)},o.prototype._unbindAll=function(){this._eventHandler.unbind(T)},o.prototype.suspendEvent=function(){this._eventHandler._eventSuspended++},o.prototype.resumeEvent=function(){var e=this._eventHandler;e._eventSuspended--,e._eventSuspended<0&&(e._eventSuspended=0)},o.prototype.currentTheme=function(e){var o=this;return 0===arguments.length?(o._currentTheme||o.resetCurrentTheme(),o._currentTheme):(typeof e===m&&(e=t.SpreadThemes.hasOwnProperty(e)?t.SpreadThemes[e]:new t.SpreadTheme(e)),o._bindToAutoRefresh(function(e){o._currentTheme=e,o._render._resetDefaultFont(),o.clearStyleCache()})(e),o)},o.prototype.resetCurrentTheme=function(){this._currentTheme=this._getDefaultSpreadTheme(),this.clearStyleCache()},o.prototype._getDefaultSpreadTheme=function(){var e=t.ThemeStyleHelper.getCssClassThemeStyle("");return parseInt(e.zIndex)>2007?t.SpreadThemes.Office:t.SpreadThemes.Office2007},o.prototype._createSheetModelManager=function(e){return new t.SheetModelManager(this,e)},o.prototype.reset=function(){var e=this;e._bindToAutoRefresh(function(){e.resetImp()})()},o.prototype.resetImp=function(){var e,o,n,r=this;r.disposed=!1,r.defaults={rowHeight:r._defaultRowHeight,colWidth:r._defaultColWidth,rowHeaderColWidth:r._defaultRowHeaderColWidth,colHeaderRowHeight:r._defaultColHeaderRowHeight},r.gridline={color:t.ThemeStyleHelper.getCssClassThemeStyle("gc-gridlineColor").borderTopColor,showVerticalGridline:r._defaultShowVerticalGridline,showHorizontalGridline:r._defaultShowHorizontalGridline},r._rowLayoutCache={colHeader:i,viewport:i,colFooter:i},r._colLayoutCache={rowHeader:i,viewport:i},r._dragRect={},r._render=new t._SheetRender(r),e=i,r._eventHandler&&(e=r._eventHandler._elem),r._eventHandler=r._createEventHandler(),r._eventHandler._elem=e,(o=r.parent)&&((n=o.getActiveSheet())&&r.getName()===n.getName()&&r._setHost(o._vp)),r._composedDefaultStyle={},t.util.hasCalc()&&(r._vpCalcSheetModel?r._vpCalcSheetModel.clearAll():r._vpSheetSource=new t.Calc.SheetSource(r)),this._sheetModelManager=this._createSheetModelManager(this._name),r._selectionModel=new t._SelectionModel,r.resetCurrentTheme(),r._allowDragDrop=!0,r._allowDragFill=!0,r._defaultDragFillType=5,r._showDragFillSmartTag=!0,r._protectionOption={},t.features.group&&(r.rowRangeGroup=new t.RangeGroup(r.getRowCount()),r.colRangeGroup=new t.RangeGroup(r.getColumnCount()),r.rowRangeGroup.groupChangeHandler=function(){r._invalidateVScrollbar()},r.colRangeGroup.groupChangeHandler=function(){r._invalidateHScrollbar()}),r._showRowRangeGroup=!0,r._showColumnRangeGroup=!0,r.autoGenerateColumns=!0,r._rowFilter=i,t.features.filter&&(r.filterRowsVisibleInfo=new t.FilterRowsVisibleInfo),r._initDefaultKeyMap(),t.features.floatingObject&&r._initDefaultFloatingObjectKeyMap(),t.features.tableSlicer&&r._initDefaultSlicerKeyMap(),t.features.comment&&r._initDefaultCommentKeyMap(),r._scrollTopRow=0,r._scrollLeftCol=0,r.frozenRowCount=0,r.frozenColCount=0,r._frozenTrailingRowCount=0,r._frozenTrailingColCount=0,t.features.binding&&(r._bindingManager=new t._BindingManager(r)),t.features.sparkline&&(r._sparklineGroupManager=new t.WorksheetSparklineGroupManager(r,r)),t.features.table&&(r._tableManager=new t._SheetTableManager(r)),t.features.floatingObject&&(r._floatingObjectArray=new t._FloatingObjectArray(r)),r._namedStyles={},r._needSyncHScrollbarSize=!0,r._needSyncVScrollbarSize=!0,r._cutCopyIndicatorManager=new t.CutCopyIndicatorManager(r),r.invalidateLayout(),r._clipBoardOptions=0,r._containerDiv=i,t.features.comment&&(r._commentManager=new t.CommentManager(r)),t.features.tableSlicer&&(r._slicerCollection=new t.SlicerCollection(r))},o.prototype.initCalc=function(e){var o=this,n=o.calcService;(!n||e)&&t.util.hasCalc()&&(o.calcService=e||new t.Calc.CalcService,o._getSheetSource().setCalcService(o.calcService),o.calcService.initParserContext(o._getSheetSource()),n&&e?e.setSourceModel(o._getSheetSource(),n.getSourceModel(o._vpSheetSource)):o._vpCalcSheetModel=o.calcService.getSourceModel(o._vpSheetSource))},o.prototype.onAttached=function(t){if(t instanceof e.Sheets.Spread){var o=t,n=this,r=o.isPaintSuspended();n._paintSuspended!==r&&(n._paintSuspended=r),n.enableFormulaTextbox(o.enableFormulaTextbox()),n.initCalc(o.calcService)}else n.initCalc();n.parent=t},o.prototype.onDettached=function(){},o.prototype._createEventHandler=function(){return new t._SheetEventHandler(this)},o.prototype.undoManager=function(){var e=this.parent;return this._undoManager||(this._undoManager=e&&e._undoManager?e._undoManager:new t._UndoManager(this,-1,this.allowUndo())),this._undoManager},o.prototype.clipBoardOptions=function(e){return 0===arguments.length?this._clipBoardOptions:(this._clipBoardOptions=e,this)},o.prototype.doCommand=function(e){this._doCommand(e)},o.prototype.copyTo=function(e,t,o,n,r,i,a){this.copyToCore(e,t,o,n,r,i,a)},o.prototype.copyToCore=function(e,t,o,n,r,i,a,s){var l=this.isPaintSuspended();this.isPaintSuspended(!0),this.suspendEvent(),v.copyTo(this,e,t,this,o,n,r,i,a,s),this.resumeEvent(),this.isPaintSuspended(l)},o.prototype.moveTo=function(e,t,o,n,r,i,a){var s=this.isPaintSuspended();this.isPaintSuspended(!0),this.suspendEvent(),v.moveTo(this,e,t,this,o,n,r,i,a),this.resumeEvent(),this.isPaintSuspended(s)},o.prototype.setCsv=function(e,t,o,n,r,i){var a=this.isPaintSuspended();this.isPaintSuspended(!0),this.suspendEvent(),v.setRangeText(this,e,t,o,n,r,'"',i),this.resumeEvent(),this.isPaintSuspended(a)},o.prototype.getCsv=function(e,t,o,n,r,i){return v.getRangeText(this,e,o,t,n,r,i,'"',!0,0)},o.prototype.canUserDragDrop=function(e){var t=this.parent;return 0===arguments.length?(t&&t.canUserDragDrop&&(this._allowDragDrop=t.canUserDragDrop()),this._allowDragDrop):(t&&t.canUserDragDrop?t.canUserDragDrop(e):this._allowDragDrop=e,this)},o.prototype.canUserDragFill=function(e){var o=this,n=o.parent;return 0===arguments.length?!!t.features.fill&&(n&&n.canUserDragFill&&(o._allowDragFill=n.canUserDragFill()),o._allowDragFill):(o.canUserDragFill()!==e&&(n&&n.canUserDragFill?n.canUserDragFill(e):o._allowDragFill=e,1!==o.getSelections().length||o._paintSuspended||o._render.repaintSelection(o.getSelections()[0])),o)},o.prototype.showDragFillSmartTag=function(e){var t,o=this.parent;return 0===arguments.length?(o&&o.showDragFillSmartTag&&(this._showDragFillSmartTag=o.showDragFillSmartTag()),this._showDragFillSmartTag):(t=this.showDragFillSmartTag(),"boolean"==typeof e&&t!==e&&(o&&o.showDragFillSmartTag?o.showDragFillSmartTag(e):this._showDragFillSmartTag=e),this)},o.prototype.defaultDragFillType=function(e){var o,n=this.parent;return 0===arguments.length?(n&&n.defaultDragFillType&&(this._defaultDragFillType=n.defaultDragFillType()),this._defaultDragFillType):(o=this.defaultDragFillType(),t.AutoFillType[e]!==a&&4!==e&&e!==o&&(n&&n.defaultDragFillType?n.defaultDragFillType(e):this._defaultDragFillType=e),this)},o.prototype.isColumnBound=function(e){var t;return!(e<0||e>=this.getColumnCount())&&(!!this.getDataSource()&&!(!(t=this._sheetModelManager.getColInfos()._getItem(e))||!t.name))},o.prototype.getDataColumnName=function(e){var t;return e<0||e>=this.getColumnCount()?i:this.getDataSource()?(t=this._sheetModelManager.getColInfos()._getItem(e))&&(t.displayName||t.name):i},o.prototype.getSparkline=function(e,t){if(!this._sparklineGroupManager)return i;return this._sheetModelManager.getDataModel(3).getSparkline(e,t)},o.prototype.setSparkline=function(e,o,n,r,s,l,u,c){var h=this,p=h._sparklineGroupManager;return p?h._bindToAutoRefresh(function(e,o,n,r,s,l,u,c){var d,f=n,g=new t.Sparkline(e,o,f,r,s,l);return u&&c!==a&&c!==i&&(g.dateAxisData(u),g.dateAxisOrientation(c),g.group().displayDateAxis=!0),d=h.getSparkline(e,o),h.removeSparkline(e,o),h._getModel().setSparkline(e,o,g),p.add(g.group()),h._raiseCellChanged("sparkline",e,o,d,g,3),g})(e,o,n,r,s,l,u,c):i},o.prototype.removeSparkline=function(e,t){var o=this,n=o._sparklineGroupManager;n&&o._bindToAutoRefresh(function(e,t){var r,a=o._getModel(3),s=a.getSparkline(e,t);s&&((r=s.group()).remove(s),r.count()<=0&&n.remove(r)),a.setSparkline(e,t,i)})(e,t)},o.prototype.groupSparkline=function(e){var t=this._sparklineGroupManager;return t?(this,this._bindToAutoRefresh(function(e){for(var o,n,r=i,a=0;a<e.length;a++)if(o=e[a]){if(!r){r=o.group();continue}(n=o.group()).remove(o),r.add(o),n.count()<=0&&t.remove(n)}return r})(e)):i},o.prototype.ungroupSparkline=function(e){var t=this._sparklineGroupManager;t&&this._bindToAutoRefresh(function(e){var o,n,r,i;if(e){for(o=(o=[]).concat(e._innerList),n=0;n<o.length;n++)(r=o[n])&&(e.remove(r),(i=e.clone()).add(r),t.add(i));t.remove(e)}})(e)},o.prototype.fillAuto=function(e,o,n){if(t.features.fill){if(!o)throw new Error(t.SR.Exp_RangeIsNull);var r=this;r._checkFillRange(e,o,n)&&r._bindToAutoRefresh(function(e,o,n){e&&(r._eventHandler._dragFillStartRange=e),new t.FillImp(r).fillAuto(o,n)})(e,o,n)}},o.prototype.fillAutobyDirection=function(e,o,n){if(t.features.fill){if(!o)throw new Error(t.SR.Exp_RangeIsNull);var r=this;r._checkFillRange(e,o,i,n)&&r._bindToAutoRefresh(function(e,o,n){e&&(r._eventHandler._dragFillStartRange=e),new t.FillImp(r).fillAutobyDirection(o,n)})(e,o,n)}},o.prototype.fillLinear=function(e,o,n,r,i){if(t.features.fill){if(!o)throw new Error(t.SR.Exp_RangeIsNull);var a=this;a._checkFillRange(e,o,n)&&a._bindToAutoRefresh(function(e,o,n,r,i){e&&(a._eventHandler._dragFillStartRange=e),new t.FillImp(a).fillLinear(o,n,r,i)})(e,o,n,r,i)}},o.prototype.fillGrowth=function(e,o,n,r,i){if(t.features.fill){if(!o)throw new Error(t.SR.Exp_RangeIsNull);var a=this;a._checkFillRange(e,o,n)&&a._bindToAutoRefresh(function(e,o,n,r,i){e&&(a._eventHandler._dragFillStartRange=e),new t.FillImp(a).fillGrowth(o,n,r,i)})(e,o,n,r,i)}},o.prototype.fillDate=function(e,o,n,r,s,l){if(t.features.fill){if(!o)throw new Error(t.SR.Exp_RangeIsNull);var u=this;u._checkFillRange(e,o,n)&&u._bindToAutoRefresh(function(e,o,n,r,s,l){e&&(u._eventHandler._dragFillStartRange=e);var c=new t.FillImp(u),h=i;l!==a&&l!==i&&(h=new t._DateTimeHelper(l).toOADate()),c.fillDate(o,n,r,s,h)})(e,o,n,r,s,l)}},o.prototype._checkFillRange=function(e,t,o,n){if(!e||!t||!t.containsRange(e))return!1;if(o!==a&&o!==i)if(1===o){if(e.row===t.row&&e.rowCount===t.rowCount)return!0}else if(0===o&&e.col===t.col&&e.colCount===t.colCount)return!0;if(n!==a&&n!==i)if(2===n||3===n){if(e.col===t.col&&e.colCount===t.colCount)return!0}else if((0===n||1===n)&&e.row===t.row&&e.rowCount===t.rowCount)return!0;return!1},o.prototype.clear=function(e,t,o,n,r,i){this.clearCore(e,t,o,n,r,i)},o.prototype._checkArrayFormula=function(e,o,n,r,i){return!((i=void 0===i)&&this._hasPartArrayFormulas(e,o,n,r)||!i&&this._hasArrayFormula(e,o,n,r))||(this._raiseInvalidOperation(4,t.SR.Exp_ChangePartOfArray),!1)},o.prototype.clearCore=function(e,t,o,n,r,s,l){var u=this;u._bindToAutoRefresh(function(e,t,o,n,r,s){var c,h,p,d,f,g,m,_,y,C,w,v;u.suspendCalcService();try{if(3,r===a||r===i||3===r){if(!u._checkArrayFormula(e,t,o,n))return!1;if(1&s){if(u.getDataSource()){for(u.suspendEvent(),c=e;c<e+o;c++)if(!l||!u.isRowFilterOut(c))for(h=t;h<t+n;h++)u.setValue(c,h,i,r);u.resumeEvent()}u._conditionalFormats&&u._conditionalFormats._clearCache(),u._rowFilter&&u._rowFilter.range&&u._rowFilter._clear(e,t,o,n)}16&s&&u._sparklineGroupManager&&u._sparklineGroupManager.clear(e,t,o,n),u._tableManager&&(f=u._tableManager.clear(e,t,o,n,s),u.onTableRemoved(f)),4&s&&u._commentManager&&u._commentManager.clear(e,t,o,n)}if(g=u._getModel(r),m=u._getCalcModel(r),g){for(c=-1===e?0:e,_=-1===e?g.getRowCount():o,h=-1===t?0:t,y=-1===t?g.getColumnCount():n,C=[],w=c;w<_;w++)l&&u.isRowFilterOut(w)&&C.push(w);if(g.clear(c,h,_,y,s,C),m&&1&s&&(u._getCalcModel().unlinkCellExpression(c,h,_,y),m.clear(c,h,_,y)),8&s&&!(e>=0&&t>=0))if(t>=0)for(d=0;d<y;d++)u.setTag(-1,h+d,i,r);else if(e>=0)for(p=0;p<_;p++)l&&u.isRowFilterOut(c+p)||u.setTag(c+p,-1,i,r);else u.setTag(-1,-1,i,r);if(2&s&&!(e>=0&&t>=0))if(t>=0)for(d=0;d<y;d++)u.setStyle(-1,h+d,i,r);else if(e>=0)for(p=0;p<_;p++)l&&u.isRowFilterOut(c+p)||u.setStyle(c+p,-1,i,r);else u.setStyle(-1,-1,i,r);if(32&s&&!(e>=0&&t>=0))if(t>=0)for(d=0;d<y;d++)u.setColumnVisible(h+d,!0,r),u.setColumnResizable(h+d,!0,r),u.setColumnWidth(h+d,2===r?u.defaults.rowHeaderColWidth:u.defaults.colWidth,r);else if(e>=0)for(p=0;p<_;p++)l&&u.isRowFilterOut(c+p)||(u.setRowVisible(c+p,!0,r),u.setRowResizable(c+p,!0,r),u.setRowHeight(c+p,1===r?u.defaults.colHeaderRowHeight:u.defaults.rowHeight,r));else{for(d=0;d<y;d++)u.setColumnVisible(h+d,!0,r),u.setColumnResizable(h+d,!0,r),u.setColumnWidth(h+d,2===r?u.defaults.rowHeaderColWidth:u.defaults.colWidth,r);for(p=0;p<_;p++)l&&u.isRowFilterOut(c+p)||(u.setRowVisible(c+p,!0,r),u.setRowResizable(c+p,!0,r),u.setRowHeight(c+p,1===r?u.defaults.colHeaderRowHeight:u.defaults.rowHeight,r))}for(p=0;p<_;p++)for(d=0;d<y;d++)c=e+p,h=t+d,1&s&&u._raiseCellChanged(P,c,h,a,i,r),8&s&&u._raiseCellChanged(L,c,h,a,i,r),2&s&&u._raiseCellChanged("style",c,h,a,i,r),16&s&&u._raiseCellChanged("sparkline",c,h,a,i,r),4&s&&u._raiseCellChanged("comment",c,h,a,i,r),32&s&&u._raiseCellChanged("axis",c,h,a,i,r),64&s&&u._raiseCellChanged("bindingPath",c,h,a,i,r)}(r===a||r===i||3===r)&&1==(1&s)&&((v=u._getCalcModel())&&v._addCellsToDirty(e,t,o,n))}finally{u.resumeCalcService(!1)}})(e,t,o,n,r,s)},o.prototype.getConditionalFormats=function(){return!this._conditionalFormats&&t.features.conditionalFormat&&(this._conditionalFormats=new t.ConditionalFormats(this)),this._conditionalFormats},o.prototype.rowFilter=function(e){var t=this;return 0===arguments.length?t._rowFilter:t._bindToAutoRefresh(function(e){return t._rowFilter&&t._rowFilter.reset(),t._rowFilter=e,t._rowFilter?t._rowFilter.sheet=t:(t.refreshObjectsAboveSheet(),t.filterRowsVisibleInfo&&t.filterRowsVisibleInfo.reset()),t})(e)},o.prototype.autoFitColumn=function(e){e<0||e>=this.getColumnCount()||new t.UndoRedo.ColumnAutoFitUndoAction(this,[{col:e}],!1).execute(this)},o.prototype.autoFitRow=function(e){e<0||e>=this.getRowCount()||new t.UndoRedo.RowAutoFitUndoAction(this,[{row:e}],!1).execute(this)},o.prototype.setGridlineOptions=function(e){var t=this;t._bindToAutoRefresh(function(e){if(e){t.gridline||(t.gridline={});var o=t.gridline;e.color&&(o.color=e.color),e.showVerticalGridline!==i&&e.showVerticalGridline!==a&&(o.showVerticalGridline=e.showVerticalGridline),e.showHorizontalGridline!==i&&e.showHorizontalGridline!==a&&(o.showHorizontalGridline=e.showHorizontalGridline)}})(e)},o.prototype.getGridlineOptions=function(){var e,t;return this.gridline||(this.gridline={}),e=this.gridline,(t={}).color=e.color,t.showVerticalGridline=e.showVerticalGridline,t.showHorizontalGridline=e.showHorizontalGridline,t},o.prototype.getFrozenRowCount=function(){return this.frozenRowCount},o.prototype.getFrozenColumnCount=function(){return this.frozenColCount},o.prototype.getFrozenTrailingRowCount=function(){return this._frozenTrailingRowCount},o.prototype.getFrozenTrailingColumnCount=function(){return this._frozenTrailingColCount},o.prototype.setRowHeaderVisible=function(e){var t=this;this._bindToAutoRefresh(function(o){t.rowHeaderVisible=e})(e)},o.prototype.getRowHeaderVisible=function(){return this.rowHeaderVisible},o.prototype.setColumnHeaderVisible=function(e){var t=this;this._bindToAutoRefresh(function(o){t.colHeaderVisible=e})(e)},o.prototype.getColumnHeaderVisible=function(){return this.colHeaderVisible},o.prototype.setRowHeaderAutoText=function(e){var t=this;this._bindToAutoRefresh(function(e){t.rowHeaderAutoText=e})(e)},o.prototype.getRowHeaderAutoText=function(){return this.rowHeaderAutoText},o.prototype.setColumnHeaderAutoText=function(e){var t=this;this._bindToAutoRefresh(function(e){t.colHeaderAutoText=e})(e)},o.prototype.getColumnHeaderAutoText=function(){return this.colHeaderAutoText},o.prototype.setRowHeaderAutoTextIndex=function(e){var t=this;this._bindToAutoRefresh(function(e){t.rowHeaderAutoTextIndex=e})(e)},o.prototype.getRowHeaderAutoTextIndex=function(){return this.rowHeaderAutoTextIndex},o.prototype.setColumnHeaderAutoTextIndex=function(e){var t=this;this._bindToAutoRefresh(function(e){t.colHeaderAutoTextIndex=e})(e)},o.prototype.getColumnHeaderAutoTextIndex=function(){return this.colHeaderAutoTextIndex},o.prototype.setIsProtected=function(e){var t=this;this._bindToAutoRefresh(function(e){t.isProtected=e,t.undoManager().clear(),t.adjustActiveCellToSelectable()})(e)},o.prototype.getIsProtected=function(){return this.isProtected},o.prototype.protectionOption=function(e){var t=this;return 0===arguments.length?t._protectionOption:(t._bindToAutoRefresh(function(e){t._protectionOption=e,t.adjustActiveCellToSelectable()})(e),t)},o.prototype.adjustActiveCellToSelectable=function(){var e,t,o=this.protectionOption();this.isProtected&&(!1===o.allowSelectLockedCells||!1===o.allowSelectUnlockedCells)&&(e=this._activeRowIndex,t=this._activeColIndex,this.canSelect(e,t)||(this._clearSelectionImp(),this._moveActiveCellRight(e,t,!0),this.moveActiveCellEnd(4,e,t)))},o.prototype.setArray=function(e,o,n,r){var i,a=this,s=a.getRowCount(),l=a.getColumnCount();if(n&&0<=e&&e<s&&0<=o&&o<l){a.suspendCalcService(),i=a.isPaintSuspended(),a.isPaintSuspended(!0);try{t.GC$.each(n,function(n,i){if(i instanceof Array)t.GC$.each(i,function(t,i){var u=e+n,c=o+t;u<s&&c<l&&(r?a.setFormula(u,c,i):a.setValue(u,c,i,3,!0))});else{var u=e+n,c=o;u<s&&c<l&&(r?a.setFormula(u,c,i):a.setValue(u,c,i,3,!0))}})}finally{a.resumeCalcService(),a.isPaintSuspended(i)}}},o.prototype.getArray=function(e,t,o,n,r){var i,a,s=[],l=this.getRowCount(),u=this.getColumnCount();if(0<=e&&e<l&&0<=t&&t<u)for(e+o>l&&(o=l-e),t+n>u&&(n=u-t),i=0;i<o;i++)for(s[i]=[],a=0;a<n;a++)s[i][a]=r?this.getFormula(e+i,t+a):this.getValue(e+i,t+a);return s},o.prototype.showRowRangeGroup=function(e){var o=this;return 0===arguments.length?!!t.features.group&&o._showRowRangeGroup:(o._showRowRangeGroup!==e&&o._bindToAutoRefresh(function(e){o._showRowRangeGroup=e})(e),o)},o.prototype.showColumnRangeGroup=function(e){var o=this;return 0===arguments.length?!!t.features.group&&o._showColumnRangeGroup:(o._showColumnRangeGroup!==e&&o._bindToAutoRefresh(function(e){o._showColumnRangeGroup=e})(e),o)},o.prototype.addTable=function(e,o,n,r,s,l){var u,c=this._tableManager;if(!c)return i;this._checkCanAddTable(e,o,n,r,s,!0),l===a&&(l=t.TableStyles.medium2()),u=this.isPaintSuspended(),this.isPaintSuspended(!0);try{return c.add(this._createTable(e,o,n,r,s,l))}finally{this.isPaintSuspended(u)}},o.prototype.addTableByDataSource=function(e,o,n,r,s){var l,u,c,h,p,d=this,f=d._tableManager;if(!f||!t.features.binding)return i;if(!r)throw new Error(t.SR.Exp_TableDataSourceNullError);d._checkCanAddTable(e,o,n,1,1,!0),(l=new t._BindingManager).bind(r),u=l.getRowCount(),c=l.getColumnCount(),o+(u+=1)>d.getRowCount()&&d.setRowCount(o+u),n+c>d.getColumnCount()&&d.setColumnCount(n+c),d._checkCanAddTable(e,o,n,u,c,!0),s===a&&(s=t.TableStyles.medium2()),h=d.isPaintSuspended(),d.isPaintSuspended(!0);try{return(p=f.add(d._createTable(e,o,n,u,c,s)))._bind(l),d.clearPendingChanges(),p}finally{d.isPaintSuspended(h)}},o.prototype._createTable=function(e,o,n,r,i,a){return new t.SheetTable(e,o,n,r,i,a)},o.prototype.findTable=function(e,t){var o=this._tableManager;return o?o.find(e,t):i},o.prototype.findTableByName=function(e){var t,o,n=this._tableManager,r=i;if(n&&(r=n.findByName(e)),!r&&(t=this.parent&&this.parent.sheets))for(o=0;o<t.length&&(!(n=t[o]._tableManager)||!(r=n.findByName(e)));o++);return r},o.prototype.removeTable=function(e){var t,o=this._tableManager;if(!e||!o)return this;t=this.isPaintSuspended(),this.isPaintSuspended(!0),this.suspendCalcService();try{return(e=o.remove(e))&&this.onTableRemoved([e]),this}finally{this.resumeCalcService(!1),this.isPaintSuspended(t)}},o.prototype.onTableRemoved=function(e){e&&v.adjustNamesOnRemoveTables(this,e)},o.prototype.removeTableByName=function(e){var t=this.findTableByName(e);return t&&this.removeTable(t),this},o.prototype.moveTable=function(e,t,o){var n,r=this._tableManager;if(!r||!e||t<0||o<0)return this;var i=e.range(),a=i.rowCount,s=i.colCount,l=r.findByRange(t,o,a,s);if(l){if(l.length>1)return this;if(1===l.length&&l[0]!==e)return this}n=this.isPaintSuspended(),this.isPaintSuspended(!0);try{return e._moveTo(t,o),this}finally{this.isPaintSuspended(n)}},o.prototype.moveTableByName=function(e,t,o){var n=this.findTableByName(e);return n&&this.moveTable(n,t,o),this},o.prototype.resizeTable=function(e,o){var n,r,i=this._tableManager;if(!i||!e)return this;var a=e.range(),s=a.row,l=a.col,u=o;if(3===arguments.length&&(u=new t.Range(s,l,arguments[1],arguments[2])),!u||u.rowCount<0||u.colCount<0||(n=i.findByRange(u.row,u.col,u.rowCount,u.colCount))&&n.length>1)return this;r=this.isPaintSuspended(),this.isPaintSuspended(!0);try{return e._resize(u),this}finally{this.isPaintSuspended(r)}},o.prototype.resizeTableByName=function(e,o){var n,r,i=this.findTableByName(e);return i&&(n=i.range(),r=o,3===arguments.length&&(r=new t.Range(n.row,n.col,arguments[1],arguments[2])),this.resizeTable(i,r)),this},o.prototype.getTables=function(){var e=this._tableManager;if(e)return e.getTables()},o.prototype.clearTables=function(){var e,t,o=this._tableManager;if(o){e=this.isPaintSuspended(),this.isPaintSuspended(!0),this.suspendCalcService();try{t=o.getTables(),o.clearTables(),this.onTableRemoved(t)}finally{this.resumeCalcService(!1),this.isPaintSuspended(e)}}return this},o.prototype.selectionBackColor=function(e){var o=this;return 0===arguments.length?o._selectionBackColor?o._selectionBackColor:t.ThemeStyleHelper.getCssClassThemeStyle("gc-selection").backgroundColor:o._bindToAutoRefresh(function(e){return e&&(o._selectionBackColor=e),o})(e)},o.prototype.selectionBorderColor=function(e){var o=this;return 0===arguments.length?o._selectionBorderColor?o._selectionBorderColor:t.ThemeStyleHelper.getCssClassThemeStyle("gc-selection").borderTopColor:o._bindToAutoRefresh(function(e){return e&&(o._selectionBorderColor=e),o})(e)},o.prototype._addTableInternal=function(e){var t,o=this._tableManager;o&&(t=e.range(),this._checkCanAddTable(e.name(),t.row,t.col,t.rowCount,t.colCount))&&o.add(e)},o.prototype._checkCanAddTable=function(e,o,n,r,i,a){var s,l,u;if(!e){if(a)throw new Error(t.SR.Exp_TableEmptyNameError);return!1}if(o<0||r<1||o+r>this.getRowCount()){if(a)throw new Error(t.SR.Exp_TableInvalidRow);return!1}if(n<0||i<1||n+i>this.getColumnCount()){if(a)throw new Error(t.SR.Exp_TableInvalidColumn);return!1}if(this._hasTable(o,n,r,i)){if(a)throw new Error(t.SR.Exp_TableIntersectError);return!1}if(this.parent&&this.parent._findTable(e)||!this.parent&&this.findTableByName(e)){if(a)throw new Error(t.SR.Exp_TableHasSameNameError);return!1}if((s=this._getsArrayFormulas(o,n,r,i))&&s.ranges&&s.ranges.length>0)for(l=0;l<s.ranges.length;l++)if((u=s.ranges[l]).rowCount>1||u.colCount>1){if(a)throw new Error(t.SR.Exp_ArrayFormulaTable);return!1}return!0},o.prototype.setComment=function(e,o,n){var r;if(t.features.comment){var i=this._commentManager,a=this.getSpan(e,o);a&&(a.row!==e||a.col!==o)&&n||((r=this.getComment(e,o))&&i&&i.containsComment(r)&&i.removeComment(r),this._getModel(3).setComment(e,o,n),i.addComment(e,o,n),this._raiseCellChanged("comment",e,o,r,n,3))}},o.prototype.getComment=function(e,o){return t.features.comment?this._getModel(3).getComment(e,o):i},o.prototype.getComments=function(){if(t.features.comment)return this._commentManager.getCommentList()},o.prototype.setTag=function(e,t,o,n){var r,a,s,l,u;if((typeof n===d||n===i)&&(n=3),this,r=this._getModel(n)){if(a=r.getRowCount(),s=r.getColumnCount(),e<-1||e>=a||t<-1||t>=s)return;o=v.tryConvertDateToOADate(o),(u=this._eventHandler._eventSuspended>0)||(l=r.getTag(e,t)),r.setTag(e,t,o),u||l===o||(-1!==e&&-1!==t?this._raiseCellChanged(L,e,t,l,o,n):-1!==e&&-1===t?this.triggerRowChanged({sheet:this,sheetName:this._name,row:e,sheetArea:n,propertyName:L,oldValue:l}):-1===e&&-1!==t&&this.triggerColumnChanged({sheet:this,sheetName:this._name,col:t,sheetArea:n,propertyName:L,oldValue:l}))}},o.prototype.getTag=function(e,t,o){var n,r;return(o===a||o===i)&&(o=3),(n=this._getModel(o))?(r=n.getTag(e,t),v.tryConvertOADateToDate(r)):i},o.prototype.tag=function(e){return 0===arguments.length?v.tryConvertOADateToDate(this._tag):(this._tag=v.tryConvertDateToOADate(e),this)},o.prototype.getParent=function(){return this.parent},o.prototype.addSlicer=function(e,o,n,r){var i,a=this.findTableByName(o);return a&&-1!==a.getColumnIndexInTable(n)?(i=new t.Slicer(e,a,n),r&&i.style(r),this.addSlicerInternal(i),i):null},o.prototype.addSlicerInternal=function(e){var t=this._slicerCollection;e&&t&&(t.addSlicer(e),this.addFloatingObject(e))},o.prototype.removeSlicer=function(e){var t=this._slicerCollection;t&&e&&(t.removeSlicer(t.getSlicer(e)),this.removeFloatingObject(e))},o.prototype.getSlicer=function(e){if(this._slicerCollection&&e)return this._slicerCollection.getSlicer(e)},o.prototype.getSlicers=function(){return this._slicerCollection?this._slicerCollection.getSlicers():[]},o.prototype.getSlicersFromTable=function(e){return e&&this._slicerCollection?this._slicerCollection.getSlicers(e):[]},o.prototype.printInfo=function(e){return 0===arguments.length?(!this._printInfo&&t.features.print&&(this._printInfo=new t.PrintInfo),this._printInfo):(this._printInfo=e,this)},o.prototype.getRowPageBreak=function(e){return this._sheetModelManager.getRowInfos(3).getPageBreak(e)},o.prototype.setRowPageBreak=function(e,t){this.setRowColInfo(e,t,"pageBreak",!0,3)},o.prototype.getColumnPageBreak=function(e){return this._sheetModelManager.getColInfos(3).getPageBreak(e)},o.prototype.setColumnPageBreak=function(e,t){this.setRowColInfo(e,t,"pageBreak",!1)},o.prototype._bindToAutoRefresh=function(e,t){return t||(t=this),function(){var o=e.apply(t,arguments);return t._paintSuspended||(typeof t.invalidateLayout===f&&t.invalidateLayout(),typeof t.repaint===f&&t.repaint()),o}},o.prototype._isValidSheetName=function(e){var t,o,n,r,i;if(!e||""===e)return!1;for(r=0;r<e.length;r++)if("*"===(t=e.charAt(r))||":"===t||"["===t||"]"===t||"?"===t||"\\"===t||"/"===t)return!1;if(this,!(o=this.parent))return!0;for(n=o.sheets.length,r=0;r<n;r++)if((i=o.sheets[r])!==this&&e===i._name)return!1;return!0},o.prototype._init=function(e){this._name=e,this.setBounds(new t.Rect(0,0,0,0)),this.resetImp()},o.prototype.applyOptions=function(e){var t,o,n;if(e){var r=this,i=r.defaults,a=r.gridline;typeof e.name===m&&e.name.length>0&&(r._name=e.name),e.data&&r.setDataSource(e.data),typeof e.defaultRowHeight===g&&(i.rowHeight=e.defaultRowHeight),typeof e.defaultColWidth===g&&(i.colWidth=e.defaultColWidth),typeof e.defaultRowHeaderColWidth===g&&(i.rowHeaderColWidth=e.defaultRowHeaderColWidth),typeof e.defaultColHeaderRowHeight===g&&(i.colHeaderRowHeight=e.defaultColHeaderRowHeight),typeof e.rowCount===g&&r.setRowCount(e.rowCount),typeof e.colCount===g&&r.setColumnCount(e.colCount),typeof e.frozenRowCount===g&&(r.frozenRowCount=e.frozenRowCount),typeof e.frozenColCount===g&&(r.frozenColCount=e.frozenColCount),typeof e.frozenTrailingRowCount===g&&(r._frozenTrailingRowCount=e.frozenTrailingRowCount),typeof e.frozenTrailingColCount===g&&(r._frozenTrailingColCount=e.frozenTrailingColCount),e.gridlineColor&&(a.color=e.gridlineColor),typeof e.showVerticalGridline===_&&(a.showVerticalGridline=e.showVerticalGridline),typeof e.showHorizontalGridline===_&&(a.showHorizontalGridline=e.showHorizontalGridline),e.borderColor&&(r.borderColor=e.borderColor),typeof e.borderWidth===g&&(r.borderWidth=e.borderWidth),typeof e._zoomFactor===g&&(r._zoomFactor=e._zoomFactor),typeof e.rowHeaderVisible===_&&(r.rowHeaderVisible=e.rowHeaderVisible),typeof e.colHeaderVisible===_&&(r.colHeaderVisible=e.colHeaderVisible),typeof e.autoGenerateColumns===_&&(r.autoGenerateColumns=e.autoGenerateColumns),e.rowHeaderAutoText&&(r.rowHeaderAutoText=e.rowHeaderAutoText),e.colHeaderAutoText&&(r.colHeaderAutoText=e.colHeaderAutoText),typeof e._activeRowIndex===g&&(t=e._activeRowIndex),typeof e._activeColIndex===g&&(o=e._activeColIndex),r._setActiveCellCore(t,o),typeof e._allowCellOverflow===_&&(r._allowCellOverflow=e._allowCellOverflow),typeof e.isProtected===_&&(r.isProtected=e.isProtected),typeof e.allowUndo===_&&r.allowUndo(e.allowUndo),(n=e.columns)&&n.length>0&&(r.autoGenerateColumns=!1,r.bindColumns(n))}},o.prototype._initDefaultFloatingObjectKeyMap=function(){var e=t.util.isMacOS(),o=!e,n=e,r=this;r.addFloatingObjectKeyMap(27,!1,!1,!1,!1,t.SpreadActions.unSelectAllFloatingObjects),r.addFloatingObjectKeyMap(46,!1,!1,!1,!1,t.SpreadActions.deleteFloatingObject),r.addFloatingObjectKeyMap(9,!1,!1,!1,!1,t.SpreadActions.navigationNextFloatingObject),r.addFloatingObjectKeyMap(9,!1,!0,!1,!1,t.SpreadActions.navigationPreviousFloatingObject),r.addFloatingObjectKeyMap(88,o,!1,!1,n,t.SpreadActions.clipboardCutFloatingObject),r.addFloatingObjectKeyMap(67,o,!1,!1,n,t.SpreadActions.clipboardCopyFloatingObject),r.addFloatingObjectKeyMap(86,o,!1,!1,n,t.SpreadActions.clipboardPasteFloatingObject),r.addFloatingObjectKeyMap(65,o,!1,!1,n,t.SpreadActions.selectAllFloatingObjects),r.addFloatingObjectKeyMap(38,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectUp),r.addFloatingObjectKeyMap(40,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectDown),r.addFloatingObjectKeyMap(37,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectLeft),r.addFloatingObjectKeyMap(39,!1,!1,!1,!1,t.SpreadActions.moveFloatingObjectRight)},o.prototype._initDefaultSlicerKeyMap=function(){this.addSlicerKeyMap(67,!1,!1,!0,!1,t.SpreadActions.unfilterSlicer)},o.prototype._initDefaultCommentKeyMap=function(){t.util.isMacOS();this.addCommentKeyMap(46,!1,!1,!1,!1,t.SpreadActions.deleteComment),this.addCommentKeyMap(27,!1,!1,!1,!1,t.SpreadActions.deactivateComment),this.addCommentKeyMap(38,!1,!1,!1,!1,t.SpreadActions.moveCommentUp),this.addCommentKeyMap(40,!1,!1,!1,!1,t.SpreadActions.moveCommentDown),this.addCommentKeyMap(37,!1,!1,!1,!1,t.SpreadActions.moveCommentLeft),this.addCommentKeyMap(39,!1,!1,!1,!1,t.SpreadActions.moveCommentRight)},o.prototype._initDefaultKeyMap=function(){var e=t.util.isMacOS(),o=!e,n=e,r=this;r.addKeyMap(37,!1,!1,!1,!1,t.SpreadActions.navigationLeft),r.addKeyMap(39,!1,!1,!1,!1,t.SpreadActions.navigationRight),r.addKeyMap(38,!1,!1,!1,!1,t.SpreadActions.navigationUp),r.addKeyMap(40,!1,!1,!1,!1,t.SpreadActions.navigationDown),r.addKeyMap(37,o,!1,!1,n,t.SpreadActions.navigationHome2),r.addKeyMap(39,o,!1,!1,n,t.SpreadActions.navigationEnd2),r.addKeyMap(38,o,!1,!1,n,t.SpreadActions.navigationTop),r.addKeyMap(40,o,!1,!1,n,t.SpreadActions.navigationBottom),r.addKeyMap(36,!1,!1,!1,!1,t.SpreadActions.navigationHome),r.addKeyMap(36,!0,!1,!1,!1,t.SpreadActions.navigationFirst),r.addKeyMap(35,!1,!1,!1,!1,t.SpreadActions.navigationEnd),r.addKeyMap(35,!0,!1,!1,!1,t.SpreadActions.navigationLast),r.addKeyMap(9,!1,!1,!1,!1,t.SpreadActions.moveToNextCell),r.addKeyMap(9,!1,!0,!1,!1,t.SpreadActions.moveToPreviousCell),r.addKeyMap(33,!1,!1,!1,!1,t.SpreadActions.navigationPageUp),r.addKeyMap(34,!1,!1,!1,!1,t.SpreadActions.navigationPageDown),r.addKeyMap(33,o,!1,!1,n,t.SpreadActions.navigationPreviousSheet),r.addKeyMap(34,o,!1,!1,n,t.SpreadActions.navigationNextSheet),r.addKeyMap(46,!1,!1,!1,!1,t.SpreadActions.clear),r.addKeyMap(8,!1,!1,!1,!1,t.SpreadActions.clearAndEditing),r.addKeyMap(13,!1,!1,!1,!1,t.SpreadActions.commitInputNavigationDown),r.addKeyMap(13,!1,!0,!1,!1,t.SpreadActions.commitInputNavigationUp),r.addKeyMap(27,!1,!1,!1,!1,t.SpreadActions.cancelInput),r.addKeyMap(13,!0,!0,!1,!1,t.SpreadActions.commitArrayFormula),r.addKeyMap(37,!1,!0,!1,!1,t.SpreadActions.selectionLeft),r.addKeyMap(39,!1,!0,!1,!1,t.SpreadActions.selectionRight),r.addKeyMap(38,!1,!0,!1,!1,t.SpreadActions.selectionUp),r.addKeyMap(40,!1,!0,!1,!1,t.SpreadActions.selectionDown),r.addKeyMap(36,!1,!0,!1,!1,t.SpreadActions.selectionHome),r.addKeyMap(35,!1,!0,!1,!1,t.SpreadActions.selectionEnd),r.addKeyMap(33,!1,!0,!1,!1,t.SpreadActions.selectionPageUp),r.addKeyMap(34,!1,!0,!1,!1,t.SpreadActions.selectionPageDown),r.addKeyMap(37,o,!0,!1,n,t.SpreadActions.selectionHome),r.addKeyMap(39,o,!0,!1,n,t.SpreadActions.selectionEnd),r.addKeyMap(38,o,!0,!1,n,t.SpreadActions.selectionTop),r.addKeyMap(40,o,!0,!1,n,t.SpreadActions.selectionBottom),r.addKeyMap(36,!0,!0,!1,!1,t.SpreadActions.selectionFirst),r.addKeyMap(35,!0,!0,!1,!1,t.SpreadActions.selectionLast),r.addKeyMap(67,o,!1,!1,n,t.SpreadActions.copy),r.addKeyMap(88,o,!1,!1,n,t.SpreadActions.cut),r.addKeyMap(86,o,!1,!1,n,t.SpreadActions.paste),r.addKeyMap(90,o,!1,!1,n,t.SpreadActions.undo),r.addKeyMap(89,o,!1,!1,n,t.SpreadActions.redo)},o.prototype._setHost=function(e){var o,n,r,i,a,s,l,u;e&&(o=t.util._isStandardCanvas(),n=t.util._isSilverlightCanvas(),o||!n)&&(i=(r=this)._eventHandler,r.disposed=!1,a=y.createElement("canvas"),t.DPIHelper.adjustDevicePixel(a,null,r),a.setAttribute("id",e.getAttribute("id")+"_vp"),t.GC$(a).html("You need a browser which full supports HTML5 Canvas to run SpreadJS"),e.appendChild(a),a.gcObject=!0,(s=r._canvas)&&(t.GC$(s).unbind(A).unbind(I).unbind(D).unbind(F).unbind(M).unbind(E).unbind(N),r._unbindTouchEvents(),s.parentNode&&s.parentNode.removeChild(s)),r._canvas=a,t.features.comment&&(r._commentRender=r.parent?r.parent._commentRender:new t.CommentRender(r._getContainerDiv())),a.setAttribute("renderMethod","auto"),l=t.util.device(),u=l.ipad||l.iphone,r._mouseDownDelegate=function(e){if(!u){var o=r._touchManager;return o&&o.preProcessMouseDown(e)?void t.util.cancelDefault(e):i.doMouseDown(e)}},r._mouseMoveDelegate=function(e){if(!u){var o=r._touchManager;if(o&&o.preProcessMouseMove(e))return void t.util.cancelDefault(e);i._isMouseCapture||i.doMouseMove(e)}},r._mouseUpDelegate=function(e){if(!u){var o=r._touchManager;if(o&&o.preProcessMouseUp(e))return void t.util.cancelDefault(e);if(!r._continueMouseUpBubble)return i._isMouseCapture?void 0:i.doMouseUp(e)}},r._mouseOutDelegate=function(e){if(!u)return i.doMouseOut(e)},r._dblClickDelegate=function(e){var o,n,a,s,l,c,h,p,d,f;if(!u&&!(o=r)._isTouchMode){if((l=o._currentTarget)&&(o.triggerCellDoubleClick({sheet:o,sheetName:o._name,sheetArea:l.hitTestType,row:l.row,col:l.col}),c=l.resizeInfo)){if("sizeRow"===c.action||"sizeHiddenRow"===c.action){if(h=[],o._isRowSelected(c.index)){for(n=0;n<o._selectionModel.length;n++)if(-1===(a=o._selectionModel[n]).col)for(a=o._getActualRange(a),p=0;p<a.rowCount;p++)h.push({row:a.row+p})}else h.push({row:c.index});s=new t.UndoRedo.RowAutoFitUndoAction(o,h,1===c.sheetArea),o._doCommand(s)}else{if(d=[],o._isColumnSelected(c.index)){for(n=0;n<o._selectionModel.length;n++)if(-1===(a=o._selectionModel[n]).row)for(a=o._getActualRange(a),f=0;f<a.colCount;f++)d.push({col:a.col+f})}else d.push({col:c.index});s=new t.UndoRedo.ColumnAutoFitUndoAction(o,d,2===c.sheetArea),o._doCommand(s)}return}return i.startEdit(e)}},r._mouseWheelDelegate=function(e){var o,n;if(!u){if(o=(e=e||window.event).detail?e.detail:e.wheelDelta/-40,n=0,t.util.isMacOS()){var r=e.wheelDeltaY,a=e.deltaY,s=e.wheelDeltaX,l=e.deltaX;c(r)>=c(s)?s=0:r=0,t.util.browser.safari?(typeof r!==d&&typeof a!==d&&(o=h(-r/c(a))),typeof s!==d&&typeof l!==d&&(n=h(-s/c(l)))):t.util.browser.chrome&&(typeof r!==d&&(o=((o=r/-40)>=0?1:-1)*p(c(o))),typeof s!==d&&(n=((n=s/-40)>=0?1:-1)*p(c(n))))}return!!i.doMouseWheel(e,parseInt(o,10)||0,parseInt(n,10)||0)&&void 0}},t.GC$(a).bind(A,r._mouseDownDelegate).bind(I,r._mouseMoveDelegate).bind(D,r._mouseUpDelegate).bind(F,r._mouseOutDelegate).bind(M,r._dblClickDelegate).bind(E,r._mouseWheelDelegate).bind(N,r._mouseWheelDelegate),r._bindTouchEvents(),i.doResize(),r.repaint(),r.parent&&r.parent._paintSpreadBackgroundImage())},o.prototype._unbindTouchEvents=function(){this._touchManager&&this._touchManager.detach()},o.prototype._bindTouchEvents=function(){if(t.features.touch){var e=this.parent,o=e&&e._touchEventProvider?e._touchEventProvider:new t.TouchEventProvider,n=new t.TouchManager(this._canvas,this,o);n.attach(),this._touchManager=n}},o.prototype._disposeValidationUI=function(){var e,o,n,r;return!this._isDisposingValidationUI&&(this._isDisposingValidationUI=!0,(e=this._validationInputMessage)&&((r=e.parentNode)&&r.removeChild(e),this._validationInputMessage=i),(o=this._validationButton)&&(t.GC$(o).unbind("click"),(r=o.parentNode)&&r.removeChild(o),this._validationButton=i),(n=this._validationSelect)&&(t.GC$(n).unbind("keydown").unbind("blur").unbind("click"),(r=n.parentNode)&&r.removeChild(n),this._validationSelect=i),this._isDisposingValidationUI=!1,!0)},o.prototype._disposeFloatingObjectUI=function(){var e,t,o,n,r,a,s=this._render,l=s&&s._floatingObjectRenderManager;if(l){for(e=0,o=l.length;e<o;e++)if(r=l[e]){for(t=0,n=r.length;t<n;t++)(a=r[t])&&a._dispose();r.length=0}l.length=0,l=i}this._floatingObjectArray&&this._floatingObjectArray.dispose()},o.prototype._disposeComment=function(){var e=this._commentManager;e&&e.hideAllComments()},o.prototype._dispose=function(e){var o,n,r,a,s,l,u=this;t.DPIHelper.disposeSheet(u),u.isEditing()&&u.endEdit(),(o=u._canvas)&&(t.GC$(o).unbind(A).unbind(I).unbind(D).unbind(F).unbind(M).unbind(E).unbind(N),o.parentNode&&o.parentNode.removeChild(o),u._canvas=i),u._unbindTouchEvents(),t.GC$(window).unbind(O),t.StyleHelper._disposeMeasureSpan(),(n=u._eventHandler)&&(n._dispose(),n._disposeFocusHolders()),(r=u._filterDialiog)&&r.close(),(a=u._smartTag)&&a.close(),(s=u._editor)&&t.GC$(s).remove(),u._disposeValidationUI(),u._disposeFloatingObjectUI(),u._disposeComment(),u._disposeStringWidthPre(),u._disposeStringWidthSpan(),!1!==e&&(u.disposed=!0,u.clearCache(),(l=u._cutCopyIndicatorManager)&&l._dispose(),u._dblClickDelegate=i,u._mouseDownDelegate=i,u._mouseMoveDelegate=i,u._mouseOutDelegate=i,u._mouseUpDelegate=i,u._mouseWheelDelegate=i,u.parent=i,u.calcService=i,u._vpSheetSource=i,u._cutCopyIndicatorManager=i,u._bindingManager=i,u._sparklineGroupManager=i,u._tableManager=i,u._floatingObjectArray=i,u._commentManager=i,u._sheetModelManager=i,u._cachePool=i,u._render=i,u._eventHandler=i,u._touchManager=i,u.imageLoader=i,t.FocusHelper.isActiveElement(u)&&t.FocusHelper.setActiveElement(i,!0))},o.prototype._disposeStringWidthSpan=function(){var e=this._editingSpan;e&&(t.GC$(e).remove(),this._editingSpan=a)},o.prototype._disposeStringWidthPre=function(){var e=this._editingPre;e&&(t.GC$(e).remove(),this._editingPre=a)},o.prototype.clearCache=function(){var e=this._conditionalFormats;e&&e.clearCellRuleCache()},o.prototype._getModel=function(e){return this._sheetModelManager.getDataModel(e)},o.prototype._getCalcModel=function(e){return!this._vpCalcSheetModel&&t.util.hasCalc()&&(this._vpCalcSheetModel=this.getCalcService().getSourceModel(this._vpSheetSource)),this._vpCalcSheetModel},o.prototype._getValueImp=function(e,o,n,r){var a,s,l;(typeof r===d||r===i)&&(r=3);var u=3===r,c=i,h=!1,p=this._tableManager;return u&&p&&p._tableList.length>0&&((a=p.find(o,n))&&(a.showHeader()&&o===a.headerIndex()?(!0,(c=a._getHeaderName(n))!==i&&typeof c!==d&&(c=t.util.toString(c)),h=!0):a.hasBinding()&&((c=a._getValue(o,n)).hasBinding?(h=!0,c=c.value):c=i))),h||((s=this._bindingManager)&&s._dataSource&&u?c=(l=s.getValue(o,n)).hasBinding?l.value:e.getValue(o,n):c=e.getValue(o,n)),v.tryConvertOADateToDate(c)},o.prototype._getSwapIndex=function(e,t,o){for(var n=e[o-t];n.index<o;)n=e[n.index-t];return n.index},o.prototype._quickSortImp=function(e){var t,o;if(e.length<=1)return e;var n=e[u(e.length/2)],r=[],i=[],a=[];for(t=0;t<e.length;t++)(o=this._sortCompare(e[t],n))<0?r.push(e[t]):o>0?i.push(e[t]):a.push(e[t]);return this._quickSortImp(r).concat(a,this._quickSortImp(i))},o.prototype._quickSort=function(e,t,o,n,r,i){var a,s,l,u,c,h=r?o:n,p=[];if(r)for(a=0;a<h;a++)p[a]={sheet:this,index:e+a,byRows:r,sortInfo:i};else for(a=0;a<h;a++)p[a]={sheet:this,index:t+a,byRows:r,sortInfo:i};if(r)for(s=[],u=p.length-1;u>=0;u--)l=p[u],this.isRowFilterOut(l.index)&&(p.splice(u,1),s.push({index:u,value:l}));if(p=this._quickSortImp(p),r)for(u=s.length-1;u>=0;u--)c=s[u],p.splice(c.index,0,c.value);return p},o.prototype._isEquals=function(e,o){return e instanceof Date&&o instanceof Date?new t._DateTimeHelper(e).toOADate()===new t._DateTimeHelper(o).toOADate():typeof e===m&&typeof o===m?e.toLowerCase()===o.toLowerCase():e===o},o.prototype._isGreaterThan=function(e,o){return"boolean"==typeof e?e=e?1:0:e instanceof Date&&(e=new t._DateTimeHelper(e).toOADate()),"boolean"==typeof o?o=o?1:0:o instanceof Date&&(o=new t._DateTimeHelper(o).toOADate()),typeof e==typeof o||"number"!=typeof e&&"number"!=typeof o?typeof e===m&&typeof o===m?e.toLowerCase()>o.toLowerCase():e>o:"number"==typeof o},o.prototype._sortCompare=function(e,t){var o,n,r,s,l,u,c,h;if(e.sortInfo&&e.sortInfo.length>0){for(this,o=0,u=0;u<e.sortInfo.length&&(e.sortInfo[u]&&(c=e.sortInfo[u].ascending,0<=(h=e.sortInfo[u].index)&&(e.byRows?(n=e.sheet.getValue(e.index,h),r=t.sheet.getValue(t.index,h),s=n===a||n===i||""===n||"number"==typeof n&&isNaN(n),l=r===a||r===i||""===r||"number"==typeof r&&isNaN(r),s||l?s&&l?o=0:s&&!l?o=1:!s&&l&&(o=-1):o=this._isEquals(n,r)?0:this._isGreaterThan(n,r)?c?1:-1:c?-1:1):(n=e.sheet.getValue(h,e.index),r=t.sheet.getValue(h,t.index),s=n===a||n===i||""===n||"number"==typeof n&&isNaN(n),l=r===a||r===i||""===r||"number"==typeof r&&isNaN(r),s||l?s&&l?o=0:s&&!l?o=1:!s&&l&&(o=-1):o=this._isEquals(n,r)?0:this._isGreaterThan(n,r)?c?1:-1:c?-1:1))),0===o);u++);return o}return 0},o.prototype._getActualRange=function(e,o){(typeof o===d||o===i)&&(o=3);var n=new t.Range(-1,-1,-1,-1);return e===i||typeof e===d?n:(n.col=e.col,n.row=e.row,n.colCount=e.colCount,n.rowCount=e.rowCount,-1===n.col&&(n.col=0,n.colCount=this.getColumnCount(o)),-1===n.row&&(n.row=0,n.rowCount=this.getRowCount(o)),n)},o.prototype._getRangeRect=function(e,o,n){var r,i,a=new t.Rect(-1,-1,-1,-1),s=this,l=s._getSheetLayout();if(0===l.width||0===l.height||(r=s._getViewportColumnLayout(o),i=s._getViewportRowLayout(e),!r||0===r.length||!i||0===i.length))return a;var u=s._getActualRange(n),c=s._cachePool,h=function(e,t){for(var o=0,n=e;n<=t;n++)o+=c.getZoomColWidth(n);return o},p=function(e,t){for(var o=0,n=e;n<=t;n++)o+=c.getZoomRowHeight(n);return o},d=u.row,f=u.row+u.rowCount-1,g=u.col,m=u.col+u.colCount-1,_=s.frozenRowCount,y=s.getRowCount()-s._frozenTrailingRowCount-1,C=s.frozenColCount,w=s.getColumnCount()-s._frozenTrailingColCount-1,v=r[0].col,S=r[r.length-1].col,x=i[0].row,R=i[i.length-1].row;return g<v&&(g=function(e,t){for(;e>t;)if(e--,s.getColumnVisible(e))return e;return e}(v,g)),m>S&&(m=function(e,t){for(;e<t;)if(e++,s.getColumnVisible(e))return e;return e}(S,m)),d<x&&(d=function(e,t){for(;e>t;)if(e--,s.getRowVisible(e))return e;return e}(x,d)),f>R&&(f=function(e,t){for(;e<t;)if(e++,s.getRowVisible(e))return e;return e}(R,f)),m<g||f<d?a:(0===o?g<C&&(a.x=l.frozenX+h(0,g-1),a.width=h(g,m)):1===o?g<=w&&m>=C&&(a.x=g<v?r[0].x-h(g,v-1):r[0].x+h(v,g-1),a.width=h(g,m)):2===o&&m>w&&(a.x=g<v?l.frozenTrailingX-h(g,v-1):l.frozenTrailingX+h(v,g-1),a.width=h(g,m)),0===e?d<_&&(a.y=l.frozenY+p(0,d-1),a.height=p(d,f)):1===e?d<=y&&f>=_&&(a.y=d<x?i[0].y-p(d,x-1):i[0].y+p(x,d-1),a.height=p(d,f)):2===e&&f>y&&(a.y=d<x?l.frozenTrailingY-p(d,x-1):l.frozenTrailingY+p(x,d-1),a.height=p(d,f)),a)},o.prototype._getRangeRect2=function(e){var o=this,n=new t.Rect(-1,-1,-1,-1),r=o._getSheetLayout();if(0===r.width||0===r.height)return n;var i,a,u=o._getActualRange(e),c=isNaN(o.frozenColCount)?0:o.frozenColCount,h=isNaN(o.frozenRowCount)?0:o.frozenRowCount,p=isNaN(o._frozenTrailingColCount)?0:o._frozenTrailingColCount,d=isNaN(o._frozenTrailingRowCount)?0:o._frozenTrailingRowCount,f=o._cachePool,g=function(e,t){for(var o=0,n=e;n<=t;n++)o+=f.getZoomColWidth(n);return o},m=function(e,t){for(var o=0,n=e;n<=t;n++)o+=f.getZoomRowHeight(n);return o},_=u.row,y=u.row+u.rowCount-1,C=u.col,w=u.col+u.colCount-1,v=o.getRowCount(),S=o.getColumnCount();if(C<c)n.x=r.frozenX+g(0,C-1),n.width=g(C,s(w,c-1)),c<=w&&w<S-p?(i=o._getViewportColumnLayout(1))&&i.length>0&&(n.width+=g(i[0].col,s(w,i[i.length-1].col))):w>=S-p&&((i=o._getViewportColumnLayout(2))&&i.length>0&&(n.width=i[0].x-n.x,n.width+=g(S-p,s(w,S-1))));else if(C<S-p){if(!(i=o._getViewportColumnLayout(1))||0===i.length||C>i[i.length-1].col||w<i[0].col)return n;n.x=r.viewportX+g(i[0].col,C-1),c<=w&&w<S-p?n.width=g(l(C,i[0].col),s(w,i[i.length-1].col)):w>=S-p&&((i=o._getViewportColumnLayout(2))&&i.length>0&&(n.width=i[0].x-n.x,n.width+=g(S-p,s(w,S-1))))}else C<S&&((i=o._getViewportColumnLayout(2))&&i.length>0&&(n.x=r.frozenTrailingX+g(i[0].col,C-1),n.width=g(C,s(w,S-1))));if(_<h)n.y=r.frozenY+m(0,_-1),n.height=m(_,s(y,h-1)),h<=y&&y<v-d?(a=o._getViewportRowLayout(1))&&a.length>0&&(n.height+=m(a[0].row,s(y,a[a.length-1].row))):y>=v-d&&((a=o._getViewportRowLayout(2))&&a.length>0&&(n.height=a[0].y-n.y,n.height+=m(v-d,s(y,v-1))));else if(_<v-d){if(!(a=o._getViewportRowLayout(1))||0===a.length||_>a[a.length-1].row||y<a[0].row)return n;n.y=r.viewportY+m(a[0].row,_-1),h<=y&&y<v-d?n.height=m(l(_,a[0].row),s(y,a[a.length-1].row)):y>=v-d&&((a=o._getViewportRowLayout(2))&&a.length>0&&(n.height=a[0].y-n.y,n.height+=m(v-d,s(y,v-1))))}else _<v&&((a=o._getViewportRowLayout(2))&&a.length>0&&(n.y=r.frozenTrailingY+m(a[0].row,_-1),n.height+=m(_,s(y,v-1))));return n},o.prototype._getCanvas=function(){var e=this._canvas;return!e&&this.parent&&(e=this.parent.canvas),e&&!e.getContext&&e.firstChild&&(e.getContext=e.firstChild.getContext),e},o.prototype._getStringWidth=function(e,t){return this._getStringWidthByCanvas(e,t)+1},o.prototype._getStringWidthByCanvas=function(e,o){var n,r=this._render;return n=o||r._getZoomFont(r._getDefaultFont()),t._WordWrapHelper._measureText(e,n)},o.prototype._getFontHeight=function(e,t){var o,n,r,i=this.fontHeightCache;if(!t)if(i){if(o=i[e])return o}else i=this.fontHeightCache={};return(n=this._getEditingSpan()).style.font=e||this._render._getDefaultFont(),n.innerHTML="H",r=n.offsetHeight,t||(i[e]=r),r},o.prototype._getEditingSpan=function(){if(!this._editingSpan){var e=y.createElement("span"),t=e.style;t.visibility=z,t.top="-10000px",t.left="-10000px",t.position="absolute",e.className="gcStringWidthSpanStyle",e.setAttribute("gcUIElement","gcStringWidthSpan"),y.body.insertBefore(e,i),this._editingSpan=e}return this._editingSpan},o.prototype._getColumnViewportIndexFromX=function(e){var t=this._getSheetLayout(),o=i;return t.headerX<e&&e<t.headerX+t.rowHeaderWidth?o=-1:t.frozenX<e&&e<t.frozenX+t.frozenWidth?o=0:t.viewportX<e&&e<t.viewportX+t.viewportWidth?o=1:t.frozenTrailingX<e&&e<t.frozenTrailingX+t.frozenTrailingWidth&&(o=2),o},o.prototype._getRowViewportIndexFromY=function(e){var t=this._getSheetLayout(),o=i;return t.headerY<e&&e<t.headerY+t.colHeaderHeight?o=-1:t.frozenY<e&&e<t.frozenY+t.frozenHeight?o=0:t.viewportY<e&&e<t.viewportY+t.viewportHeight?o=1:t.frozenTrailingY<e&&e<t.frozenTrailingY+t.frozenTrailingHeight&&(o=2),o},o.prototype._getRowIndexFromY=function(e,t){var o,n=i;return(n=-1===t?this._getColumnHeaderRowLayout():this._getViewportRowLayout(t))&&(o=n.findY(e))?o.row:void 0},o.prototype._getColumnIndexFromX=function(e,t){var o,n=i;return(n=-1===t?this._getRowHeaderColumnLayout():this._getViewportColumnLayout(t))&&(o=n.findX(e))?o.col:void 0},o.prototype._isActiveCell=function(e,t){return this._activeRowIndex<=e&&e<this._activeRowIndex+this._activeRowCount&&this._activeColIndex<=t&&t<this._activeColIndex+this._activeColCount},o.prototype._isColumnSelected=function(e){for(var t,o,n=0;n<this._selectionModel.length;n++)if(o=-1===(t=this._selectionModel[n]).col?0:t.col,-1===t.row&&e>=o&&e<o+t.colCount)return!0;return!1},o.prototype._isRowSelected=function(e){for(var t,o,n=0;n<this._selectionModel.length;n++)if(o=-1===(t=this._selectionModel[n]).row?0:t.row,-1===t.col&&e>=o&&e<o+t.rowCount)return!0;return!1},o.prototype._isSelected=function(e,t,o){for(var n,r,a=!1,s=this._selectionModel,l=0,u=s.length;l<u;l++)if(n=s[l],r=this._getActualRange(n),3===o||typeof o===d||o===i?a=r.row<=e&&e<r.row+r.rowCount&&r.col<=t&&t<r.col+r.colCount:2===o?a=r.row<=e&&e<r.row+r.rowCount:1===o?a=r.col<=t&&t<r.col+r.colCount:0===o&&(a=-1===n.row&&-1===n.col),a)return a;return a},o.prototype._isAllSelected=function(e,t,o){for(var n,r,s,l=!1,u=this.getRowCount(),c=this.getColumnCount(),h=0;h<this._selectionModel.length;h++)if(n=this._selectionModel[h],o!==a&&o!==i&&3!==o&&(2===o?(r=-1===n.row?0:n.row,l=-1===n.col&&e>=r&&e<r+n.rowCount):1===o?(s=-1===n.col?0:n.col,l=-1===n.row&&t>=s&&t<s+n.colCount):0===o&&(l=-1===n.row&&-1===n.col&&n.rowCount===u&&n.colCount===c)),l)return l;return l},o.prototype._isHover=function(e,t,o){var n,r,a,s=this._currentTarget;if(s&&!s.resizeInfo&&typeof o!==d&&o!==i){if(1===o)return n=!1,(r=this._getSpanModel(1).find(s.row,s.col))&&(n=r.contains(e,t,1,1)),a=e===s.row&&t===s.col||n,s.hitTestType===o&&a;if(2===o)return n=!1,(r=this._getSpanModel(2).find(s.row,s.col))&&(n=r.contains(e,t,1,1)),a=e===s.row&&t===s.col||n,s.hitTestType===o&&a;if(3===o)return s.hitTestType===o&&e===s.row&&t===s.col;if(0===o)return s.hitTestType===o}return!1},o.prototype._indexToLetters=function(e){for(var t,o="A".charCodeAt(0),n="";e>0;e=parseInt((e-1)/26,10))t=(e-1)%26,n=String.fromCharCode(o+t)+n;return n},o.prototype._doStartEdit=function(e,t,o){var n,r,i,s,l,u=this,c=u.hitTest(t,o);if(c&&(n=c.row,r=c.col,n>=0&&r>=0&&c.rowViewportIndex>=0&&c.colViewportIndex>=0&&!c.resizeInfo&&!c.dragInfo&&n===u._activeRowIndex&&r===u._activeColIndex&&(i=u.isEditing(),u._startEditImp(e,n,r),!i&&u.isEditing()&&(s=c.hitTestType,(l=u.getCellType(n,r))._triggerButtonClicked)))){var h=1===s?-1:a,p=2===s?-1:a,d=u.getCellRect(n,r,h,p),f=u.getActualStyle(n,r,s),g={sheet:u,row:n,col:r,sheetArea:s},m=l.getHitInfo(t,o,f,d,g);m&&m.isReservedLocation&&l._triggerButtonClicked(u,n,r,3)}},o.prototype._getSheetArea=function(e,t){return e>=0&&e<=2&&t>=0?3:e>=0&&e<=2&&t<0?2:e<0&&t>=0?1:e<0&&t<0?0:i},o.prototype.setFocus=function(){var e=this._eventHandler;e&&e.setFocus()},o.prototype._getHost=function(){var e,t,o=this.parent;return(e=o&&o._host)||(e=(t=this._canvas)&&t.parentElement),e},o.prototype._startEditImp=function(e,o,n,r,s,l,u){var c,h,p,d,f,g,m,_,y,C,w,v;if(!(o<0||n<0||(c=this,c.isEditing()))){(h=c._eventHandler)&&h.setFocus();var S,x=o,R=n;if((S=c.getCellRect(x,R))&&!(S.width<=0)&&!(S.height<=0)&&(c.showCell(c._activeRowIndex,c._activeColIndex,3,3),p=c.getActualStyle(o,n),!c.isProtected||!1===p.locked)&&(d=c.getCellType(x,R))&&(g={sheet:c,row:o,col:n,sheetArea:3},d.isImeAware(g)?h&&(f=h._cellTypeFocusHolder):f=d.createEditorElement(g),f)){if(c._editor=f,m={sheet:c,sheetName:c._name,row:x,col:R,cancel:!1},c.triggerEditStarting(m),m&&!0===m.cancel)return void(t.util.device().ipad&&h&&h.changeFocusHolder());var b=c.getValue(x,R),T=c.getFormula(x,R),A=c._editorStatus;c._editorStatus=c._startEditByKeydown?1:b!==i&&b!==a||T!==i&&T!==a?2:1,c.triggerEditorStatusChanged({sheet:c,sheetName:c._name,oldStatus:A,newStatus:c._editorStatus}),_=c._getSheetLayout(),S=c.getCellRect(x,R,r,s),d.isImeAware(g)&&h._resetFocusHolder(),d.activateEditor(c._editor,p,S,g),c._setEditorValue(d,c._editor,x,R,p,u);var I=c._getHost();c.showEditingLocator&&(y=d._getLocator(),f._editingLocator=y,C=this.getValue(this._sheetModelManager.getDataModel(1).getRowCount()-1,n,1),w=this.getValue(o,this._sheetModelManager.getDataModel(2).getColumnCount()-1,2),y.innerHTML=C+""+w,d._updateEditorLocator(c._editor,g),I.insertBefore(y,i)),d.isImeAware(g)||I.insertBefore(c._editor,i),d.updateEditor(c._editor,p,S,g),d.isImeAware(g)&&l||d.focus(c._editor,g),l&&d.selectAll(c._editor,g),c._allowCellOverflow&&((v=c.getCellRect(o,n,r,s)).x-=2,v.y-=2,v.width+=4,v.height+=4,v.x=_.frozenX,v.width=_.viewportWidth,c.repaint(v)),c._render.refreshTouchSelectionIndicator(),c._attachFormulaTextBox(d.getEditingElement()),t.FocusHelper.setActiveElement(c),c.triggerEditStarted({sheet:c,sheetName:c._name,row:x,col:R})}}},o.prototype._setEditorValue=function(e,t,o,n,r,s){var l,u,c,h=this.getFormula(o,n);h&&(h="="+h),l=h,u={sheet:this,row:o,col:n,sheetArea:3},h&&0!==h.length||(h=this.getValue(o,n),c=!this.parent||this.parent.canUserEditFormula(),h&&h.length>0&&/^=/gi.test(h)&&c&&(h="'"+h),l=h,h=e._formatEditorValue(t,r,h,u)),t._oldValue=h,s!==i&&s!==a&&(h=s),e.setEditorValue(t,h,u),t._originalValue=l},o.prototype._attachFormulaTextBox=function(o){var n,r,i,a=this;if(t.features.formulatextbox&&o&&(!a.parent||a.parent.canUserEditFormula())&&a._enableFormulaTextbox){a._formulaTextBox&&a._formulaTextBox.destroy(),a._formulaTextBox=new t.FormulaTextBox(o,a.parent),n=a._formulaTextBox.text(),(r=a.getFormulaInformation(a._activeRowIndex,a._activeColIndex))&&r.hasFormula||"="===n[0]&&(n="'"+n,a._formulaTextBox.text(n));var s=a._formulaTextBox,l=a._eventHandler,u=a._render;s.bind("AppendStarted",function(t){s.close();e.Sheets.EditorStatus;var o=a._editorStatus;1!==o&&(a._editorStatus=1,a.triggerEditorStatusChanged({sheet:a,sheetName:a._name,oldStatus:o,newStatus:1}))}),s.bind("AppendEnded",function(e){u.paintFormulaTextBox()}),s.bind("TextChanged",function(e,t){if(!a.disposed){if(t&&"input"!==t.type){l.updateEditingEditor(t);var o=a._activeRowIndex,n=a._activeColIndex,r=a.getCellType(o,n);a.triggerEditChange({sheet:a,sheetName:a._name,row:o,col:n,editingText:r.getEditorValue(a._editor)})}u.paintFormulaTextBox(),a.triggerFormulaTextBoxTextChanged({sheet:a,sheetName:a._name,text:s.text()})}}),s.bind("CaretChanged",function(){u.paintFormulaTextBox(),a.triggerFormulaTextBoxCaretChanged({sheet:a,sheetName:a._name,caret:s.caret()})}),s.add(t.SR.getHelpFuncs()),(i=this._functionDescriptions)&&i.length>0&&s.add(i),(i=this.parent&&this.parent._functionDescriptions)&&i.length>0&&s.add(i),u.paintFormulaTextBox()}},o.prototype._detachFormulaTextBox=function(){this._formulaTextBox&&(this._formulaTextBox.destroy(),this._formulaTextBox=i,this._render.paintFormulaTextBox())},o.prototype._showEditingLocator=function(){var e,o,n,r,i=this;if(!1!==i.isEditing()&&(o=(e=i._editor)&&e._editingLocator)){var a=t.GC$(e),s=parseInt(a.css(H),10)+i.getColumnWidth(i._activeColIndex)/2,l=parseInt(a.css(k),10)+i.getRowHeight(i._activeRowIndex)/2,u=t.GC$(i._getCanvas()).offset();s-=u.left,l-=u.top,n=i._getRowIndexFromY(l,i._getRowViewportIndexFromY(l)),r=i._getColumnIndexFromX(s,i._getColumnViewportIndexFromX(s)),n===i._activeRowIndex&&r===i._activeColIndex?t.GC$(o).css(G,z):t.GC$(o).css(G,"visible")}},o.prototype._getKeyAction=function(e,t,o,n,r){return this._getKeyActionInternal(e,t,o,n,r,this.keyMap)},o.prototype._getKeyActionInternal=function(e,t,o,n,r,a){var s,l,u;if(!a)return i;for(s=a.length,u=0;u<s;u++)if((l=a[u])&&l.key===e&&l.ctrl===t&&l.shift===o&&l.alt===n&&l.meta===r)return l;return i},o.prototype._getFloatingObjectKeyAction=function(e,t,o,n,r){return this._getKeyActionInternal(e,t,o,n,r,this.floatingObjectKeyMap)},o.prototype._getSlicerKeyAction=function(e,t,o,n,r){return this._getKeyActionInternal(e,t,o,n,r,this._slicerKeyMap)},o.prototype._getCommentKeyAction=function(e,t,o,n,r){return this._getKeyActionInternal(e,t,o,n,r,this._commentKeyMap)},o.prototype._moveActiveCellUp=function(e,t,o){var n=this._getMoveUpCell(e,t,o,this._leadingCellCol||0);if(n){var r=n.row,i=n.col,a=n.leadingCellCol;this._canMoveCurrentTo(r,i)&&(this._leadingCellRow=r,this._leadingCellCol=a,this._setActiveCellCore(r,i))}},o.prototype._getMoveUpCell=function(e,t,o,n){var r,s=this.getRowCount(),l=this.getColumnCount(),u=e,c=t;return 0===u&&!o||0===s||0===l?i:(r=this._getPrevRow(u,n),o||this._adjustCell(r),u=r.r,c=r.c,u<0&&o&&(((c=this._getPrevVisualColumn(c))<0||c===a||c===i)&&(c=this._getPrevVisualColumn(l)),n=c,u=(r=this._getPrevRow(s,c)).r,(c=r.c)===t&&u<=e)?i:{row:u,col:c,leadingCellCol:n})},o.prototype._moveActiveCellDown=function(e,t,o){var n=this._getMoveDownCell(e,t,o,this._leadingCellCol||0);if(n){var r=n.row,i=n.col,a=n.leadingCellCol;this._canMoveCurrentTo(r,i)&&(this._leadingCellRow=r,this._leadingCellCol=a,this._setActiveCellCore(r,i))}},o.prototype._getMoveDownCell=function(e,t,o,n){var r,s=this.getRowCount(),l=this.getColumnCount(),u=e,c=t;if((u!==s-1||o)&&0!==s&&0!==l)return r=this._getNextRow(u,n),o||this._adjustCell(r),u=r.r,c=r.c,u===s&&o&&(((c=this._getNextVisualColumn(c))>=l||c===a||c===i)&&(c=this._getNextVisualColumn(-1)),n=c,u=(r=this._getNextRow(-1,c)).r,(c=r.c)===t&&u>=e)?void 0:{row:u,col:c,leadingCellCol:n}},o.prototype._moveActiveCellLast=function(){var e,t,o=this._getMoveLastCell();o&&(e=o.row,t=o.col,this._leadingCellRow=e,this._leadingCellCol=t,this._setActiveCellCore(e,t))},o.prototype._getMoveLastCell=function(){var e,t,o=this._getLastVisualRow(),n=this._getLastVisualColumn(),r=n;if(!o&&!r)return i;if(e=!1!==this._protectionOption.allowSelectLockedCells,t=!1!==this._protectionOption.allowSelectUnlockedCells,!this.isProtected||e&&t)return{row:o,col:r};if(!e&&!t)return i;for(;o!==i&&o>=0;o=this._getPrevVisualRow(o))for(r=n;r!==i&&r>=0;r=this._getPrevVisualColumn(r))if(e===this.getStyleProperty(o,r,"locked"))return{row:o,col:r};return i},o.prototype._moveActiveCellFirst=function(){var e,t,o=this._getMoveFirstCell();o&&(e=o.row,t=o.col,this._leadingCellRow=e,this._leadingCellCol=t,this._setActiveCellCore(e,t))},o.prototype._getMoveFirstCell=function(){var e,t,o=this,n=o._getFirstVisualRow(),r=o._getFirstVisualColumn(),a=r,s=o._getLastVisualRow(),l=o._getLastVisualColumn();if(n===i||a===i)return i;if(e=!1!==o._protectionOption.allowSelectLockedCells,t=!1!==o._protectionOption.allowSelectUnlockedCells,!o.isProtected||e&&t)return{row:n,col:a};if(!e&&!t)return i;for(;n!==i&&n<=s;n=o._getNextVisualRow(n))for(a=r;a!==i&&a<=l;a=o._getNextVisualColumn(a))if(e===o.getStyleProperty(n,a,"locked"))return{row:n,col:a};return i},o.prototype._moveActiveCellLeft=function(e,t,o){var n=this._getMoveLeftCell(e,t,o,this._leadingCellRow||0);if(n){var r=n.row,i=n.col,a=n.leadingCellRow;this._canMoveCurrentTo(r,i)&&(this._leadingCellRow=a,this._leadingCellCol=i,this._setActiveCellCore(r,i))}},o.prototype._getMoveLeftCell=function(e,t,o,n){var r,s,l=this.getRowCount(),u=this.getColumnCount(),c=e,h=t;if(0===h&&!o||0===l||0===u)return i;for(r=this._getPrevColumn(n,h),s=n,o||this._adjustCell(r),c=r.r,h=r.c;h<0&&o;){if(((c=this._getPrevVisualRow(c,3,!0))<0||c===a||c===i)&&(c=this._getPrevVisualRow(l,3,!0)),n=c,c=(r=this._getPrevColumn(n,u)).r,h=r.c,c===e&&h<t)return i;if(c===e&&h===t){if(n===s)return i;c=(r=this._getPrevColumn(n,h)).r,h=r.c}}return{row:c,col:h,leadingCellRow:n}},o.prototype._adjustCell=function(e){e.r<0?e.r=this._getFirstVisualRow():e.r>=this.getRowCount()&&(e.r=this._getLastVisualRow()),e.c<0?e.c=this._getFirstVisualColumn():e.c>=this.getColumnCount()&&(e.c=this._getLastVisualColumn())},o.prototype._fixRange=function(e){var o=e.row<0?0:e.row,n=e.col<0?0:e.col,r=e.row<0?this.getRowCount():e.rowCount,i=e.col<0?this.getColumnCount():e.colCount;return new t.Range(o,n,r,i)},o.prototype._moveActiveCellLeftInSelection=function(e,t){for(var o,n,r=this._selectionModel,i=r.activeSelectedRangeIndex,a=-1,s=this._fixRange(this._getActiveSelectedRange()),l=s.row,u=s.col,c=s.col+s.colCount-1,h=e,p=t;h=(o=this._getPrevColumnInSelection(h,p)).r,!((p=o.c)>=u);){if(a===i&&h===e&&p<=t)return;--h>=l?p=c+1:(n=this._fixRange(this._getActiveSelectedRange(3)),a=r.activeSelectedRangeIndex,l=n.row,u=n.col,c=n.col+n.colCount-1,h=n.row+n.rowCount-1,p=n.col+n.colCount)}h>=0&&(this._setActiveCellCore(h,p),this._leadingCellRow=h,this._leadingCellCol=p)},o.prototype._moveActiveCellRightInSelection=function(e,t){for(var o,n,r=this._selectionModel,i=r.activeSelectedRangeIndex,a=-1,s=this._fixRange(this._getActiveSelectedRange()),l=s.col,u=s.row+s.rowCount-1,c=s.col+s.colCount-1,h=e,p=t;h=(o=this._getNextColumnInSelection(h,p)).r,!((p=o.c)<=c);){if(a===i&&h===e&&p>=t)return;++h<=u?p=l-1:(n=this._fixRange(this._getActiveSelectedRange(4)),a=r.activeSelectedRangeIndex,l=n.col,u=n.row+n.rowCount-1,c=n.col+n.colCount-1,h=n.row,p=n.col-1)}h>=0&&(this._setActiveCellCore(h,p),this._leadingCellRow=h,this._leadingCellCol=p)},o.prototype._moveActiveCellRight=function(e,t,o){var n=this._getMoveRightCell(e,t,o,this._leadingCellRow||0);if(n){var r=n.row,i=n.col,a=n.leadingCellRow;this._canMoveCurrentTo(r,i)&&(this._leadingCellRow=a,this._leadingCellCol=i,this._setActiveCellCore(r,i))}},o.prototype._getMoveRightCell=function(e,t,o,n){var r,s,l=this.getRowCount(),u=this.getColumnCount(),c=e,h=t;if(h===u-1&&!o||0===l||0===u)return i;if(r=this._getNextColumn(n,h),s=n,!o){if(r.c===u)return i;this._adjustCell(r)}for(c=r.r,h=r.c;h===u&&o;){if(((c=this._getNextVisualRow(c,!0))>=l||c===a||c===i)&&(c=this._getNextVisualRow(-1,!0)),n=c,c=(r=this._getNextColumn(n,-1)).r,h=r.c,c===e&&h>t)return i;if(c===e&&h===t){if(n===s)return i;c=(r=this._getNextColumn(n,h)).r,h=r.c}}return{row:c,col:h,leadingCellRow:n}},o.prototype._getPrevColumn=function(e,o){for(var n,r,i={r:e,c:o};o>=0&&(e=i.r,!(--o<0));)if((n=this.getSpans(new t.Range(e,o,1,1)))&&n.length>0&&(o>=(r=n[0]).col&&(o=r.col,e=r.row)),this._canMoveCurrentTo(e,o))return{r:e,c:o};return{r:e,c:o}},o.prototype._getPrevColumnInSelection=function(e,t){for(var o,n;t>=0&&!(--t<0);){if(o=this._getSpanModel().find(e,t)){if(!((n=this._getActiveSelectedRange()).row<=o.row&&o.row+o.rowCount<=n.row+n.rowCount&&n.col<=o.col&&o.col+o.colCount<=n.col+n.colCount))continue;if(o.row!==e||o.col!==t)continue;t>=o.col&&(t=o.col,e=o.row)}if(this._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},o.prototype._getNextColumn=function(e,o){for(var n,r,i,a=this.getColumnCount(),s={r:e,c:o};o<a&&(e=s.r,(n=this._getSpanModel().find(e,o))?o+=n.colCount:o++,!(o>=a));)if((r=this.getSpans(new t.Range(e,o,1,1)))&&r.length>0&&(o>(i=r[0]).col?o=l(o,i.col+i.colCount):e=i.row),this._canMoveCurrentTo(e,o))return{r:e,c:o};return{r:e,c:o}},o.prototype._getNextColumnInSelection=function(e,t){for(var o,n,r,i=this.getColumnCount();t<i&&((o=this._getSpanModel().find(e,t))?t=o.col+o.colCount:t++,!(t>=i));){if(n=this._getSpanModel().find(e,t)){if(!((r=this._getActiveSelectedRange()).row<=n.row&&n.row+n.rowCount<=r.row+r.rowCount&&r.col<=n.col&&n.col+n.colCount<=r.col+r.colCount))continue;if(n.row!==e||n.col!==t)continue;t>n.col?t=l(t,n.col+n.colCount):e=n.row}if(this._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},o.prototype._canMoveCurrentTo=function(e,t){var o,n=!1,r=this.getRowVisible(e),i=this.getColumnVisible(t),a=this._getZoomRowHeight(e),s=this._getZoomColumnWidth(t);return n=e>=0&&e<this.getRowCount()&&t>=0&&t<this.getColumnCount()&&r&&i&&a>0&&s>0,!!this.canSelect(e,t)&&(o=!!this._isTabNavigation,!0===n&&!0===o&&(!1===this.getStyleProperty(e,t,"tabStop")&&(n=!1)),n)},o.prototype._getPrevRow=function(e,o){for(var n,r;e>=0&&!(--e<0);)if((n=this.getSpans(new t.Range(e,o,1,1)))&&n.length>0&&(e>=(r=n[0]).row&&(e=r.row,o=r.col)),this._canMoveCurrentTo(e,o))return{r:e,c:o};return{r:e,c:o}},o.prototype._getNextRow=function(e,o){for(var n,r,i,a=this.getRowCount();e<a&&((n=this._getSpanModel().find(e,o))?e+=n.rowCount:e++,!(e>=a));)if((r=this.getSpans(new t.Range(e,o,1,1)))&&r.length>0&&(e>(i=r[0]).row?e=l(e,i.row+i.rowCount):o=i.col),this._canMoveCurrentTo(e,o))return{r:e,c:o};return{r:e,c:o}},o.prototype._setSelectedRange=function(e,t,o,n,r){this._selectionModel.add(e,t,o,n),r&&!this._paintSuspended&&this._render.repaintSelection()},o.prototype._extendSelectedRange=function(e,t,o){var n=this._getExtendedRange(e,t,this._activeRowIndex,this._activeColIndex),r=n.row,i=n.col,a=n.rowCount,s=n.colCount,l=this.selectionPolicy(),u=this.selectionUnit();0!==l&&(1===l&&this._selectionModel.clear(),1===u?(i=-1,s=-1):2===u&&(r=-1,a=-1),this._replaceActiveSelectedRange(r,i,a,s,o))},o.prototype._getExtendedRange=function(e,o,n,r){var i,a,s,l,u,c;return typeof n===d&&(n=this._activeRowIndex),typeof r===d&&(r=this._activeColIndex),i=new t.Range(n,r,1,1),(a=this._getSpanModel().find(n,r))&&(i=a),s=new t.Range(e,o,1,1),(l=this._getSpanModel().find(e,o))&&(s=l),u=i.union(s),(c=this.getSpans())&&c.length>0&&(u=this._inflateRangeToCoverSpans(c,u)),u},o.prototype._replaceActiveSelectedRange=function(e,o,n,r,i){var a,s,l=this._getActiveSelectedRange();if(this._selectionModel.length>0?this._selectionModel.splice(this._selectionModel.activeSelectedRangeIndex,1,new t.Range(e,o,n,r)):this._selectionModel.add(e,o,n,r),i&&!this._paintSuspended){if((a=this._getActiveSelectedRange()).row===l.row&&a.col===l.col&&a.rowCount===l.rowCount&&a.colCount===l.colCount)return;s=this._render,l.containsRange(a)?s.repaintSelection(l):a.containsRange(l)?s.repaintSelection(a):(s.repaintSelection(l),s.repaintSelection(a))}},o.prototype._changeActiveSelectedRange=function(e,t){var o,n,r,i=this;if(!(i._selectionModel.length<=0)&&(o=i._getActiveSelectedRange(),n=i._getKeyboardSelectedRange(o,e,t))){var a=i._selectionModel.toArray(),s=n.row,l=n.col,u=n.rowCount,c=n.colCount,h=i.selectionPolicy(),p=i.selectionUnit();if(0===h)return;1===h&&i._selectionModel.clear(),1===p?(l=-1,c=-1):2===p&&(s=-1,u=-1),i._replaceActiveSelectedRange(s,l,u,c,!0),r=i._selectionModel.toArray(),i._eventHandler._notEqualSelecions(a,r)&&(i.triggerSelectionChanging({sheet:i,sheetName:i._name,oldSelections:a,newSelections:r}),i.triggerSelectionChanged({sheet:i,sheetName:i._name}))}},o.prototype._getKeyboardSelectedRange=function(e,t,o,n,r){var a=this,s=a._fixRange(e),l=i;return 37===t?l=o?a._searchSelectedRangebyLeftCtrl(s,!1,n,r):a._searchSelectedRangebyLeft(s,n,r):39===t?l=o?a._searchSelectedRangebyRightCtrl(s,!1,n,r):a._searchSelectedRangebyRight(s,n,r):38===t?l=o?a._searchSelectedRangebyUpCtrl(s,!1,n,r):a._searchSelectedRangebyUp(s,n,r):40===t?l=o?a._searchSelectedRangebyDownCtrl(s,!1,n,r):a._searchSelectedRangebyDown(s,n,r):36===t?l=o?a._searchSelectedRangebyHomeCtrl(s,n,r):a._searchSelectedRangebyHome(s,n,r):35===t?l=o?a._searchSelectedRangebyEndCtrl(s,n,r):a._searchSelectedRangebyEnd(s,n,r):33===t?l=a._searchSelectedRangebyPageUp(s,n,r):34===t&&(l=a._searchSelectedRangebyPageDown(s,n,r)),l&&(e.row<0&&(l.row=-1,l.rowCount=-1),e.col<0&&(l.col=-1,l.colCount=-1)),l},o.prototype._searchSelectedRangebyLeft=function(e,o,n){for(var r,a,u,c,h,p,d,f,g=e.col+e.colCount-1,m={r:e.row+e.rowCount-1,c:g};g>0;)if(g--,this._canMoveCurrentTo(m.r,g)&&(r=this._getExtendedRange(m.r,g,o,n),a=s(e.row,r.row),u=s(e.col,r.col),h=l(e.row+e.rowCount-1,r.row+r.rowCount-1)-a+1,p=(c=s(e.col+e.colCount-1,r.col+r.colCount-1))-u+1,a!==e.row||u!==e.col||h!==e.rowCount||p!==e.colCount))return d=this._scrollLeftCol,f=this._activeColIndex,e.col<f?u<=d&&this._setLeftColumn(u):e.col===f&&c<=d&&this._setLeftColumn(c),new t.Range(a,u,h,p);return i},o.prototype._searchSelectedRangebyLeftCtrl=function(e,o,n,r){var u,c,h,p,d,f=this.frozenColCount?this._getNextVisualColumn(this.frozenColCount-1):this._getFirstVisualColumn(),g=o?f:this._getFirstVisualColumn();if(g!==a&&g!==i)return(this.frozenColCount<=0||o)&&this._setLeftColumn(g),u=this._getExtendedRange(e.row,g,n,r),c=s(e.row,u.row),h=s(e.col,u.col),p=l(e.row+e.rowCount-1,u.row+u.rowCount-1)-c+1,d=s(e.col+e.colCount-1,u.col+u.colCount-1)-h+1,new t.Range(c,h,p,d)},o.prototype._searchSelectedRangebyRight=function(e,o,n){for(var r,a,u,c,h,p,d,f,g=e.col,m=this.getColumnCount()-1,_={r:e.row+e.rowCount-1,c:g};g<m;)if(g++,this._canMoveCurrentTo(_.r,g)&&(r=this._getExtendedRange(_.r,g,o,n),a=s(e.row,r.row),u=l(e.col,r.col),h=l(e.row+e.rowCount-1,r.row+r.rowCount-1)-a+1,p=(c=l(e.col+e.colCount-1,r.col+r.colCount-1))-u+1,a!==e.row||u!==e.col||h!==e.rowCount||p!==e.colCount))return d=this._getPageRightColumn(),f=this._activeColIndex,e.col<f?u>=d&&this._setLeftColumn(this._getNewLeftColumn(u,2)):e.col===f&&c>=d&&this._setLeftColumn(this._getNewLeftColumn(c,2)),new t.Range(a,u,h,p);return i},o.prototype._searchSelectedRangebyRightCtrl=function(e,o,n,r){var u,c,h,p,d,f,g=this._getLastPageLeftColumn();if(g!==a&&g!==i)return this._setLeftColumn(g),u=this._getLastVisualColumn(),o||(u+=this._frozenTrailingColCount),c=this._getExtendedRange(e.row,u,n,r),h=s(e.row,c.row),p=l(e.col,c.col),d=l(e.row+e.rowCount-1,c.row+c.rowCount-1)-h+1,f=l(e.col+e.colCount-1,c.col+c.colCount-1)-p+1,new t.Range(h,p,d,f)},o.prototype._searchSelectedRangebyUp=function(e,o,n){for(var r,a,u,c,h,p,d,f,g=e.row+e.rowCount-1,m={r:g,c:e.col+e.colCount-1};g>0;)if(g--,this._canMoveCurrentTo(g,m.c)&&(r=this._getExtendedRange(g,m.c,o,n),a=s(e.row,r.row),u=s(e.col,r.col),h=(c=s(e.row+e.rowCount-1,r.row+r.rowCount-1))-a+1,p=l(e.col+e.colCount-1,r.col+r.colCount-1)-u+1,a!==e.row||u!==e.col||h!==e.rowCount||p!==e.colCount))return d=this._scrollTopRow,f=this._activeRowIndex,e.row<f?a<=d&&this._setTopRow(a):e.row===f&&c<=d&&this._setTopRow(c),new t.Range(a,u,h,p);return i},o.prototype._searchSelectedRangebyUpCtrl=function(e,o,n,r){var u,c,h,p,d,f=this.frozenRowCount?this._getNextVisualRow(this.frozenRowCount-1):this._getFirstVisualRow(),g=o?f:this._getFirstVisualRow();if(g!==a&&g!==i)return(this.frozenRowCount<=0||o)&&this._setTopRow(g),u=this._getExtendedRange(g,e.col,n,r),c=s(e.row,u.row),h=s(e.col,u.col),p=s(e.row+e.rowCount-1,u.row+u.rowCount-1)-c+1,d=l(e.col+e.colCount-1,u.col+u.colCount-1)-h+1,new t.Range(c,h,p,d)},o.prototype._searchSelectedRangebyDown=function(e,o,n){for(var r,a,u,c,h,p,d,f,g=e.row,m=this.getRowCount()-1,_={r:g,c:e.col+e.colCount-1};g<m;)if(g++,this._canMoveCurrentTo(g,_.c)&&(r=this._getExtendedRange(g,_.c,o,n),a=l(e.row,r.row),u=s(e.col,r.col),h=(c=l(e.row+e.rowCount-1,r.row+r.rowCount-1))-a+1,p=l(e.col+e.colCount-1,r.col+r.colCount-1)-u+1,a!==e.row||u!==e.col||h!==e.rowCount||p!==e.colCount))return d=this._getPageBottomRow(),f=this._activeRowIndex,e.row<f?a>=d&&this._setTopRow(this._getNewTopRow(a,2)):e.row===f&&c>=d&&this._setTopRow(this._getNewTopRow(c,2)),new t.Range(a,u,h,p);return i},o.prototype._searchSelectedRangebyDownCtrl=function(e,o,n,r){var u,c,h,p,d,f,g=this._getLastPageTopRow();if(g!==a&&g!==i)return this._setTopRow(g),u=this._getLastVisualRow(),o||(u+=this._frozenTrailingRowCount),c=this._getExtendedRange(u,e.col,n,r),h=l(e.row,c.row),p=s(e.col,c.col),d=l(e.row+e.rowCount-1,c.row+c.rowCount-1)-h+1,f=l(e.col+e.colCount-1,c.col+c.colCount-1)-p+1,new t.Range(h,p,d,f)},o.prototype._searchSelectedRangebyHome=function(e,o,n){for(var r,a,u,c,h,p=this.frozenColCount?this.frozenColCount-1:-1,d=this._activeColIndex,f={r:e.row+e.rowCount-1,c:e.col};p<d;)if(p++,this._canMoveCurrentTo(f.r,p)){if(e.col<=p&&e.col+e.colCount-1===this._activeColIndex)break;return r=this._getExtendedRange(f.r,p,o,n),a=s(e.row,r.row),u=s(e.col,r.col),c=l(e.row+e.rowCount-1,r.row+r.rowCount-1)-a+1,h=s(e.col+e.colCount-1,r.col+r.colCount-1)-u+1,this._setLeftColumn(this._getFirstVisualColumn()),new t.Range(a,u,c,h)}return i},o.prototype._searchSelectedRangebyHomeCtrl=function(e,t,o){return e=this._searchSelectedRangebyLeftCtrl(e,!0,t,o),this._searchSelectedRangebyUpCtrl(e,!0,t,o)},o.prototype._searchSelectedRangebyEnd=function(e,o,n){for(var r,a,u,c,h,p=this.getColumnCount(),d=this._activeColIndex,f={r:e.row+e.rowCount-1,c:e.col+e.colCount-1};p>d;)if(p--,this._canMoveCurrentTo(f.r,p)){if(e.col+e.colCount-1>=p&&e.col===this._activeColIndex)break;return r=this._getExtendedRange(f.r,p,o,n),a=s(e.row,r.row),u=l(e.col,r.col),c=l(e.row+e.rowCount-1,r.row+r.rowCount-1)-a+1,h=l(e.col+e.colCount-1,r.col+r.colCount-1)-u+1,this._setLeftColumn(this._getLastPageLeftColumn()),new t.Range(a,u,c,h)}return i},o.prototype._searchSelectedRangebyEndCtrl=function(e,t,o){return e=this._searchSelectedRangebyRightCtrl(e,!0,t,o),this._searchSelectedRangebyDownCtrl(e,!0,t,o)},o.prototype._searchSelectedRangebyPageUp=function(e,o,n){var r,u,c,h,p,d=this,f=d._getPrevPageTopRow();if(f===a||f===i)return i;var g=d._getRowLayout(1),m=-1;return d._setTopRow(f)?m=d._getNextVisualRow(e.row+e.rowCount-1-g.length):d.frozenRowCount<=0&&(m=d._getFirstVisualRow()),m<d._scrollTopRow?m=d._scrollTopRow:m>=d._getPageBottomRow()&&(m=d._getPrevVisualRow(d._getPageBottomRow())),r=d._getExtendedRange(m,e.col,o,n),u=s(e.row,r.row),c=s(e.col,r.col),h=s(e.row+e.rowCount-1,r.row+r.rowCount-1)-u+1,p=l(e.col+e.colCount-1,r.col+r.colCount-1)-c+1,new t.Range(u,c,h,p)},o.prototype._searchSelectedRangebyPageDown=function(e,o,n){var r,u,c,h,p,d,f,g=this,m=g._getNextPageTopRow();return m===a||m===i?i:(r=g._getRowLayout(1),g._setTopRow(m),(u=g._getPrevVisualRow(e.row+e.rowCount-1+r.length))<g._scrollTopRow?u=g._scrollTopRow:u>=g._getPageBottomRow()&&(u=g._scrollTopRow>=g._getLastPageTopRow()?g._getPageBottomRow():g._getPrevVisualRow(g._getPageBottomRow())),c=g._getExtendedRange(u,e.col,o,n),h=l(e.row,c.row),p=s(e.col,c.col),d=l(e.row+e.rowCount-1,c.row+c.rowCount-1)-h+1,f=l(e.col+e.colCount-1,c.col+c.colCount-1)-p+1,new t.Range(h,p,d,f))},o.prototype._getPrevPageTopRow=function(){var e=this._getRowLayout(1);if(!e||e.length<=0)return i;for(var t=this.frozenRowCount?this._getNextVisualRow(this.frozenRowCount-1):this._getFirstVisualRow(),o=0,n=this._scrollTopRow,r=this._getSheetLayout();n>t&&(n--,!((o+=this._getZoomRowHeight(n))>r.viewportHeight)););return n},o.prototype._getPrevPageLeftColumn=function(){var e=this._getColumnLayout(1);if(!e||e.length<=0)return i;for(var t=this.frozenColCount?this._getNextVisualColumn(this.frozenColCount-1):this._getFirstVisualColumn(),o=0,n=this._scrollLeftCol,r=this._getSheetLayout();n>t&&(n--,!((o+=this._getZoomColumnWidth(n))>r.viewportWidth)););return n},o.prototype._getNextPageTopRow=function(){var e=this._getRowLayout(1);return!e||e.length<=0?i:this._getLastVisualRow()===e[e.length-1].row?this._scrollTopRow:e[e.length-1].row},o.prototype._getLastPageTopRow=function(){var e,t,o,n,r,i=this;if(i._getLastVisualRow()===i._getPageBottomRow()&&(e=i._getSheetLayout(),(t=i._getRowLayout(1))&&t.length>=1&&(o=t[t.length-1]).y+o.height<=e.viewportY+e.viewportHeight))return i._scrollTopRow;n=i._scrollTopRow;try{return i._scrollTopRow=i._getLastVisualRow(),r=i._getPrevPageTopRow(),i._getNextVisualRow(r)}catch(e){}finally{i._scrollTopRow=n}},o.prototype._getLastPageLeftColumn=function(){var e,t,o,n,r;if(this._getLastVisualColumn()===this._getPageRightColumn()&&(e=this._getSheetLayout(),(t=this._getColumnLayout(1))&&t.length>=1&&(o=t[t.length-1]).x+o.width<=e.viewportX+e.width))return this._scrollLeftCol;for(e=this._getSheetLayout(),n=0,r=this._getLastVisualColumn();r>0&&!((n+=this._getZoomColumnWidth(r))>e.viewportWidth);)r--;return r>0&&(r=this._getNextVisualColumn(r)),r},o.prototype._getPageBottomRow=function(){var e=this._getRowLayout(1);return!e||e.length<=0?i:e[e.length-1].row},o.prototype._getPageRightColumn=function(){var e=this._getColumnLayout(1);return!e||e.length<=0?i:e[e.length-1].col},o.prototype._getLastFullyVisibleRow=function(){var e,t,o=this._getRowLayout(1);return!o||o.length<=0?i:(e=this._getSheetLayout(),o[t=o.length-1].y+o[t].height<=e.viewportY+e.viewportHeight?o[t].row:o[l(t-1,0)].row)},o.prototype._getLastFullyVisibleColumn=function(){var e,t,o=this._getColumnLayout(1);return!o||o.length<=0?i:(e=this._getSheetLayout(),o[t=o.length-1].x+o[t].width<=e.viewportX+e.viewportWidth?o[t].col:o[l(t-1,0)].col)},o.prototype._getFirstVisualRow=function(){return this._getNextVisualRow(-1)},o.prototype._getLastVisualRow=function(e){(e===a||e===i)&&(e=3);var t=this.getRowCount(e);return(3===e||2===e)&&(t-=this._frozenTrailingRowCount),this._getPrevVisualRow(t,e)},o.prototype._getFirstVisualColumn=function(){return this._getNextVisualColumn(-1)},o.prototype._getLastVisualColumn=function(e){(e===a||e===i)&&(e=3);var t=this.getColumnCount(e);return(3===e||1===e)&&(t-=this._frozenTrailingColCount),this._getPrevVisualColumn(t,e)},o.prototype._getFirstPageLeftColumn=function(){var e=isNaN(this.frozenColCount)?0:this.frozenColCount;return e>0?this._getNextVisualColumn(e-1):this._getFirstVisualColumn()},o.prototype._getFirstPageTopRow=function(){var e=isNaN(this.frozenRowCount)?0:this.frozenRowCount;return e>0?this._getNextVisualRow(e-1):this._getFirstVisualRow()},o.prototype._getNextVisualRow=function(e,t){for(var o=t?this.getRowCount()-1:this.getRowCount()-1-this._frozenTrailingRowCount;e<o;)if(e++,this.getRowVisible(e)&&this._getZoomRowHeight(e)>0)return e;return i},o.prototype._getPrevVisualRow=function(e,t,o){for(var n=o?0:this.frozenRowCount;e>n;)if(e--,this.getRowVisible(e,t)&&this._getZoomRowHeight(e,t)>0)return e;return i},o.prototype._getNextVisualColumn=function(e){for(var t=this.getColumnCount()-1-this._frozenTrailingColCount;e<t;)if(e++,this.getColumnVisible(e)&&this._getZoomColumnWidth(e)>0)return e;return i},o.prototype._getPrevVisualColumn=function(e,t){for(;e>this.frozenColCount;)if(e--,this.getColumnVisible(e,t)&&this._getZoomColumnWidth(e,t)>0)return e;return i},o.prototype._inflateRangeToCoverSpans=function(e,t){var o,n;if(e&&e.length>0)for(o=0;o<e.length;o++)if(n=e[o],t.intersect(n.row,n.col,n.rowCount,n.colCount))return e.splice(o--,1),this._inflateRangeToCoverSpans(e,t.union(n));return t},o.prototype._getActiveSelectedRange=function(e){var o=this,n=new t.Range(-1,-1,0,0);return o._selectionModel.length<=0?n:(3===e?(o._selectionModel.activeSelectedRangeIndex--,o._selectionModel.activeSelectedRangeIndex<0&&(o._selectionModel.activeSelectedRangeIndex=o._selectionModel.length-1)):4===e&&(o._selectionModel.activeSelectedRangeIndex++,o._selectionModel.activeSelectedRangeIndex>=o._selectionModel.length&&(o._selectionModel.activeSelectedRangeIndex=0)),o._selectionModel.activeSelectedRangeIndex>=0&&(n=o._selectionModel[o._selectionModel.activeSelectedRangeIndex]),n)},o.prototype._initializeActiveCell=function(){var e=this._activeRowIndex,t=this._activeColIndex,o=this._selectionModel;if(e===a||e===i||t===a||t===i||o.length<=0){var n=1,r=1,s=this._getSpanModel().find(0,0);s&&(n=s.rowCount,r=s.colCount),o.add(0,0,n,r),this._activeRowIndex=0,this._activeColIndex=0,this._activeRowCount=n,this._activeColCount=r,this._leadingCellRow=0,this._leadingCellCol=0}},o.prototype._isResizeInfoEqual=function(e,t){var o=!1;return e||t?e&&t&&(o=e.action===t.action&&e.index===t.index&&e.sheetArea===t.sheetArea):o=!0,o},o.prototype._setHoverCell=function(e){var t,o,n,r=this,a=!1,s=r._currentTarget;if(s||(a=!0),a||e||(a=!0),a||(a=e.col!==s.col||e.row!==s.row||e.colViewportIndex!==s.colViewportIndex||e.rowViewportIndex!==s.rowViewportIndex||e.hitTestType!==s.hitTestType||!r._isResizeInfoEqual(e.resizeInfo,s.resizeInfo)),r._currentTarget=e,a){r._hoverCell=!0;var l=r._getSheetLayout(),u=r._render,c=i,h=!1;s&&(s.rowViewportIndex<0||s.colViewportIndex<0)&&((c=r.getCellRect(s.row,s.col,s.rowViewportIndex,s.colViewportIndex))&&c.width>0&&c.height>0&&(t=0,o=0,(n=r._getGroupLayout())&&(t=n.width,o=n.height),(c.x<l.rowHeaderWidth+t||c.y<l.colHeaderHeight+o||c.y>=l.height-l.footerHeight)&&(u.update(c.x,c.y,c.width,c.height),h=r._isHoverOnHeaderSelection(s)))),e&&(e.rowViewportIndex<0||e.colViewportIndex<0)&&((c=r.getCellRect(e.row,e.col,e.rowViewportIndex,e.colViewportIndex))&&c.width>0&&c.height>0&&(t=0,o=0,(n=r._getGroupLayout())&&(t=n.width,o=n.height),(c.x<l.rowHeaderWidth+t||c.y<l.colHeaderHeight+o||c.y>=l.height-l.footerHeight)&&(u.update(c.x,c.y,c.width,c.height),h||(h=r._isHoverOnHeaderSelection(e))))),r._hoverCell=!1,h&&u.repaintSelection()}},o.prototype._isHoverOnHeaderSelection=function(e){var t;return!!(this.parent&&this.parent._themeVersion>2007&&(t=3,e.rowViewportIndex<0&&(t=1),e.colViewportIndex<0&&(t=2),3!==t&&this._isSelected(e.row,e.col,t)))},o.prototype._getAvailableActiveCell=function(e,t,o){var n=this._skipSpanCell(e,t,o);return this._skipInvisibleCell(n)},o.prototype._skipSpanCell=function(e,o,n){var r=this._getSpanModel().find(e,o);return r?n&&1===r.rowCount||!n&&1===r.colCount?r:(n?o++:e++,this._skipSpanCell(e,o,n)):new t.Range(e,o,1,1)},o.prototype._skipInvisibleCell=function(e){for(var o,n,r=e.row,i=this.getRowCount(),a=r;a<i&&!0!==this.getRowVisible(a);a++);for(a<i&&(r=a),o=e.col,n=this.getColumnCount(),a=o;a<n&&!0!==this.getColumnVisible(a);a++);return a<n&&(o=a),new t.Range(r,o,e.rowCount,e.colCount)},o.prototype._processKeyMap=function(e){var o,n=e.ctrlKey,r=e.shiftKey,i=e.altKey,a=e.metaKey,s=e.keyCode,l=this._getKeyAction(s,n,r,i,a);return!(!l||typeof l.action!==f)&&((o=l.action.call(this))&&t.util.cancelDefault(e),o)},o.prototype._processSlicerKeyMap=function(e){var o,n=this._slicerCollection;return!!n&&(1===n.getSelectedSlicers().length&&(!(!(o=this._getSlicerKeyAction(e.keyCode,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey))||!o.action)&&(o.action.call(this)&&t.util.cancelDefault(e),!0)))},o.prototype._processFloatingObjectsKeyMap=function(e){var o;if(!t.features.floatingObject||(90===e.keyCode&&!0===e.ctrlKey||89===e.keyCode&&!0===e.ctrlKey))return!1;this._eventHandler;var n=86===e.keyCode&&(e.ctrlKey||e.metaKey);return!!(this._hasFloatingObjectsSelected()||n&&this.isPasteFloatingObject())&&((o=this._getFloatingObjectKeyAction(e.keyCode,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey))&&o.action&&(o.action.call(this)&&t.util.cancelDefault(e)),!0)},o.prototype.isPasteFloatingObject=function(){var e,t=this._eventHandler,o=this._getFloatingObjectClipboardHelper().fromSheet,n=o&&o._eventHandler,r=!0;return(t||n)&&(!(e=t._getClipboardFloatingObjectData())&&n&&(e=n._getClipboardFloatingObjectData()),e&&e.length||(r=!1)),r},o.prototype._processCommentKeyMap=function(e){var o,n;if(!t.features.comment||(90===e.keyCode&&!0===e.ctrlKey||89===e.keyCode&&!0===e.ctrlKey))return!1;if(this,o=this._commentManager.getActiveComment()){if(9===e.keyCode)return t.util.cancelDefault(e),!0;if((n=this._getCommentKeyAction(e.keyCode,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey))&&n.action)return n.action.call(this)&&t.util.cancelDefault(e),!0;if(this._eventHandler.allowEnterEditing(e))return o.commentState(2),!0}return!1},o.prototype._hasFloatingObjectsSelected=function(){var e,o,n=this._floatingObjectArray;if(t.features.floatingObject&&n&&n.length>0)for(e=0,o=n.length;e<o;e++)if(n[e].isSelected())return!0;return!1},o.prototype._getZoomRowHeight=function(e,t){var o=this.getRowHeight(e,t),n=this._zoomFactor;return 1!==n&&(o*=n),u(o)},o.prototype._getZoomColumnWidth=function(e,t){var o=this.getColumnWidth(e,t),n=this._zoomFactor;return 1!==n&&(o*=n),u(o)},o.prototype._getGroupLayout=function(){return this._cachedGroupLayout||(this._cachedGroupLayout=this._createGroupLayout()),this._cachedGroupLayout},o.prototype._getGroupButtonWidth=function(){return 17},o.prototype._getGroupButtonHeight=function(){return 17},o.prototype._getGroupPadding=function(){return 2},o.prototype._createGroupLayout=function(){var e,t,o,n,r={x:0,y:0,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},i=this._getGroupButtonWidth(),a=this._getGroupButtonHeight(),l=this._getGroupPadding(),u=this.rowRangeGroup,c=this.colRangeGroup,h=this._showRowRangeGroup,p=this._showColumnRangeGroup,d=this._zoomFactor;return h&&u&&!u._isEmpty()&&((e=u.getMaxLevel())>=0&&(t=s(i,i*d),r.width=t*(e+2)+2*l,r.rowMaxLevel=e)),p&&c&&!c._isEmpty()&&((o=c.getMaxLevel())>=0&&(n=s(a,a*d),r.height=n*(o+2)+2*l,r.colMaxLevel=o)),r},o.prototype._createLayout=function(){var e,o,n,r,s=this,u=s.getBounds(),c=new t.Rect(u.x+s.borderWidth,u.y+s.borderWidth,l(0,u.width-2*s.borderWidth),l(0,u.height-2*s.borderWidth)),h=c.width,p=c.height,d={x:c.x,y:c.y,width:c.width,height:c.height,rowHeaderWidth:0,colHeaderHeight:0,frozenWidth:0,frozenHeight:0,frozenTrailingWidth:0,frozenTrailingHeight:0,footerHeight:0,footerWidth:0,footerX:0,footerY:0,frozenX:0,frozenY:0,frozenTrailingX:0,frozenTrailingY:0,viewportX:0,viewportY:0,viewportHeight:0,viewportWidth:0,headerX:0,headerY:0,headerCornerRect:function(){return new t.Rect(this.x,this.y,this.rowHeaderWidth,this.colHeaderHeight)},colHeaderRect:function(e){var o=this;return 0===e?new t.Rect(o.frozenX,o.y,o.frozenWidth,o.colHeaderHeight):1===e?new t.Rect(o.viewportX,o.y,o.viewportWidth,o.colHeaderHeight):2===e?new t.Rect(o.frozenTrailingX,o.y,o.frozenTrailingWidth,o.colHeaderHeight):i},rowHeaderRect:function(e){var o=this;return 0===e?new t.Rect(o.x,o.frozenY,o.rowHeaderWidth,o.frozenHeight):1===e?new t.Rect(o.x,o.viewportY,o.rowHeaderWidth,o.viewportHeight):2===e?new t.Rect(o.x,o.frozenTrailingY,o.rowHeaderWidth,o.frozenTrailingHeight):i},viewportRect:function(e,o){var n=this;return 0===e?0===o?new t.Rect(n.frozenX,n.frozenY,n.frozenWidth,n.frozenHeight):1===o?new t.Rect(n.viewportX,n.frozenY,n.viewportWidth,n.frozenHeight):2===o?new t.Rect(n.frozenTrailingX,n.frozenY,n.frozenTrailingWidth,n.frozenHeight):i:1===e?0===o?new t.Rect(n.frozenX,n.viewportY,n.frozenWidth,n.viewportHeight):1===o?new t.Rect(n.viewportX,n.viewportY,n.viewportWidth,n.viewportHeight):2===o?new t.Rect(n.frozenTrailingX,n.viewportY,n.frozenTrailingWidth,n.viewportHeight):i:2===e?0===o?new t.Rect(n.frozenX,n.frozenTrailingY,n.frozenWidth,n.frozenTrailingHeight):1===o?new t.Rect(n.viewportX,n.frozenTrailingY,n.viewportWidth,n.frozenTrailingHeight):2===o?new t.Rect(n.frozenTrailingX,n.frozenTrailingY,n.frozenTrailingWidth,n.frozenTrailingHeight):i:i},footerRect:function(e){var o=this;return 0===e?new t.Rect(o.frozenX,o.footerY,o.frozenWidth,o.footerHeight):1===e?new t.Rect(o.viewportX,o.footerY,o.viewportWidth,o.footerHeight):2===e?new t.Rect(o.frozenTrailingX,o.footerY,o.frozenTrailingWidth,o.footerHeight):i},footerCornerRect:function(){return new t.Rect(this.footerX,this.footerY,this.footerWidth,this.footerHeight)}},f=s._getGroupLayout();if(d.x+=f.width,d.y+=f.height,h-=f.width,p-=f.height,s.rowHeaderVisible===i||s.rowHeaderVisible===a||s.rowHeaderVisible)for(r=s.getColumnCount(2),n=0;n<r;n++)d.rowHeaderWidth+=s._getZoomColumnWidth(n,2);if(s.colHeaderVisible===i||s.colHeaderVisible===a||s.colHeaderVisible)for(o=s.getRowCount(1),e=0;e<o;e++)d.colHeaderHeight+=s._getZoomRowHeight(e,1);if(s.frozenColCount>0)for(r=s.getColumnCount(),n=0;n<s.frozenColCount&&n<r;n++)s.getColumnVisible(n)&&(d.frozenWidth+=s._getZoomColumnWidth(n));if(s.frozenRowCount>0)for(o=s.getRowCount(),e=0;e<s.frozenRowCount&&e<o;e++)s.getRowVisible(e)&&(d.frozenHeight+=s._getZoomRowHeight(e));if(s._frozenTrailingColCount>0)for(r=s.getColumnCount(),n=l(s.frozenColCount,r-s._frozenTrailingColCount);n<r;n++)d.frozenTrailingWidth+=s._getZoomColumnWidth(n);if(s._frozenTrailingRowCount>0)for(o=s.getRowCount(),e=l(s.frozenRowCount,o-s._frozenTrailingRowCount);e<o;e++)d.frozenTrailingHeight+=s._getZoomRowHeight(e);return h-=d.rowHeaderWidth,p-=d.colHeaderHeight,h-=d.frozenWidth,p-=d.frozenHeight,h-=d.frozenTrailingWidth,p-=d.frozenTrailingHeight,p-=d.footerHeight,d.viewportWidth=l(0,h),d.viewportHeight=l(0,p),d.headerX=d.x,d.headerY=d.y,d.frozenX=d.headerX+d.rowHeaderWidth,d.frozenY=d.headerY+d.colHeaderHeight,d.viewportX=d.frozenX+d.frozenWidth,d.viewportY=d.frozenY+d.frozenHeight,d.frozenTrailingX=d.viewportX+d.viewportWidth,d.frozenTrailingY=d.viewportY+d.viewportHeight,d.footerX=d.headerX,d.footerY=d.y+d.height-d.footerHeight,d},o.prototype._getSheetLayout=function(){return this._layoutModel||(this._layoutModel=this._createLayout()),this._layoutModel},o.prototype._getColumnLayout=function(e,t){return typeof t===d||t===i||3===t||1===t?this._getViewportColumnLayout(e):2===t?this._getRowHeaderColumnLayout():i},o.prototype._getRowHeaderColumnLayout=function(){return this._colLayoutCache.rowHeader||(this._colLayoutCache.rowHeader=this._createRowHeaderColumnLayout()),this._colLayoutCache.rowHeader},o.prototype._getViewportColumnLayout=function(e){return this._colLayoutCache.viewport||(this._colLayoutCache.viewport={}),this._colLayoutCache.viewport[e]||(this._colLayoutCache.viewport[e]=this._createViewportColumnLayout(e)),this._colLayoutCache.viewport[e]},o.prototype._createRowHeaderColumnLayout=function(){for(var e,o=new t._LayoutModel,n=this._getSheetLayout().headerX,r=this.getColumnCount(2),i=0;i<r;i++)e=this._getZoomColumnWidth(i,2),o.push(new t._Layout(-1,i,n,-1,e,-1)),n+=e;return o},o.prototype._createViewportColumnLayout=function(e){var o,n,r,i,a=this,u=new t._LayoutModel,c=a._getSheetLayout(),h=a.getColumnCount(),p=a._cachePool;if(0===e)for(n=c.frozenX,h=isNaN(a.frozenColCount)?0:s(a.frozenColCount,h),o=0;o<h;o++)r=p.getZoomColWidth(o),u.push(new t._Layout(-1,o,n,-1,r,-1)),n+=r;else if(1===e)for(n=c.viewportX,h-=a._frozenTrailingColCount,i=c.viewportWidth,o=l(a.frozenColCount,a._scrollLeftCol);i>0&&o<h;o++)r=p.getZoomColWidth(o),u.push(new t._Layout(-1,o,n,-1,r,-1)),n+=r,i-=r;else if(2===e)for(n=c.frozenTrailingX,o=l(a.frozenColCount,h-a._frozenTrailingColCount);o<h;o++)r=p.getZoomColWidth(o),u.push(new t._Layout(-1,o,n,-1,r,-1)),n+=r;return u},o.prototype._getRowLayout=function(e,t){return typeof t===d||t===i||3===t||2===t?this._getViewportRowLayout(e):1===t?this._getColumnHeaderRowLayout():i},o.prototype._getAllRowLayout=function(e){for(var o,n=new t._LayoutModel,r=0;r<3;r++)(o=this._getRowLayout(r,e))&&o.length>0&&(n=t.GC$.merge(n,o));return n},o.prototype._getAllColumnLayout=function(e){for(var o,n=new t._LayoutModel,r=0;r<3;r++)(o=this._getColumnLayout(r,e))&&o.length>0&&(n=t.GC$.merge(n,o));return n},o.prototype._getColumnHeaderRowLayout=function(){return this._rowLayoutCache.colHeader||(this._rowLayoutCache.colHeader=this._createColumnHeaderRowLayout()),this._rowLayoutCache.colHeader},o.prototype._getViewportRowLayout=function(e){return this._rowLayoutCache.viewport||(this._rowLayoutCache.viewport={}),this._rowLayoutCache.viewport[e]||(this._rowLayoutCache.viewport[e]=this._createViewportRowLayout(e)),this._rowLayoutCache.viewport[e]},o.prototype._createColumnHeaderRowLayout=function(){for(var e,o=new t._LayoutModel,n=this._getSheetLayout().headerY,r=this.getRowCount(1),i=0;i<r;i++)e=this._getZoomRowHeight(i,1),o.push(new t._Layout(i,-1,-1,n,-1,e)),n+=e;return o},o.prototype._createViewportRowLayout=function(e){var o,n,r,i,a=this,u=new t._LayoutModel,c=a._getSheetLayout(),h=a.getRowCount(),p=a._cachePool;if(0===e)for(n=c.frozenY,h=isNaN(a.frozenRowCount)?0:s(a.frozenRowCount,h),o=0;o<h;o++)r=p.getZoomRowHeight(o),u.push(new t._Layout(o,-1,-1,n,-1,r)),n+=r;else if(1===e)for(n=c.viewportY,h-=a._frozenTrailingRowCount,i=c.viewportHeight,o=l(a.frozenRowCount,a._scrollTopRow);i>0&&o<h;o++)r=p.getZoomRowHeight(o),u.push(new t._Layout(o,-1,-1,n,-1,r)),n+=r,i-=r;else if(2===e)for(n=c.frozenTrailingY,o=l(a.frozenRowCount,h-a._frozenTrailingRowCount);o<h;o++)r=p.getZoomRowHeight(o),u.push(new t._Layout(o,-1,-1,n,-1,r)),n+=r;return u},o.prototype._getCellLayout=function(e,o,n){var r=this.getRowCount(n),i=this.getColumnCount(n),a=this._getRowLayout(e,n),s=this._getColumnLayout(o,n),l=new t._LayoutModel;if(a&&a.length>0&&s&&s.length>0){var u=a[0].row,c=s[0].col,h=a[a.length-1].row,p=s[s.length-1].col,d=this.getSpans(new t.Range(u,c,h-u+1,p-c+1),n);d&&d.length>0&&this._addCellLayout(d,u,c,h,p,l,r,i,n,a,s)}return l},o.prototype._getCellLayoutByCell=function(e,o,n,r,a){var s,l=this.getRowCount(n),u=this.getColumnCount(n),c=this._getRowLayout(e,n),h=this._getColumnLayout(o,n),p=new t._LayoutModel;if(c&&c.length>0&&h&&h.length>0){var d=c[0].row,f=h[0].col,g=this.getSpan(r,a,n);return g&&((s=[]).push(g),this._addCellLayout(s,d,f,g.row+g.rowCount,g.col+g.colCount,p,l,u,n,c,h)),p.length>0?p[0]:i}return i},o.prototype._addCellLayout=function(e,o,n,r,i,a,s,l,u,c,h){var p,d,f,g,m,_=e.length;if(!(_<=0)){var y=r+1,C=i+1,w=new Array(y),v=new Array(C),S=new Array(C),x=new Array(y),R=0,b=0;for(m=o-1;m>=0;m--)w[m]=this._getZoomRowHeight(m,u),b-=w[m],x[m]=b;for(b=0,m=o;m<y;m++)x[m]=b,w[m]=this._getZoomRowHeight(m,u),b+=w[m];for(m=n-1;m>=0;m--)v[m]=this._getZoomColumnWidth(m,u),R-=v[m],S[m]=R;for(R=0,m=n;m<C;m++)S[m]=R,v[m]=this._getZoomColumnWidth(m,u),R+=v[m];for(p=0;p<_;p++)if((d=e[p]).intersect(o,n,r-o+1,i-n+1)){if((f=d.row+d.rowCount)>y){for(m=y;m<f;m++)w.push(this._getZoomRowHeight(m,u)),x.push(x[m-1]+w[m]);y=f}if((g=d.col+d.colCount)>C){for(m=C;m<g;m++)v.push(this._getZoomColumnWidth(m,u)),S.push(S[m-1]+v[m]);C=g}R=S[d.col],b=x[d.row];for(var T,A=0,I=0,D=d.col;D<d.col+d.colCount&&D<l;D++)A+=v[D];for(T=d.row;T<d.row+d.rowCount&&T<s;T++)I+=w[T];a.push(new t._Layout(d.row,d.col,h[0].x+R,c[0].y+b,A,I,d.rowCount,d.colCount))}}},o.prototype._getRowViewportIndexNearY=function(e){var t=this._getSheetLayout();return this.frozenRowCount>0&&e<t.frozenY+t.frozenHeight?0:this._frozenTrailingRowCount>0&&e>t.frozenTrailingY?2:1},o.prototype._getColumnViewportIndexNearX=function(e){var t=this._getSheetLayout();return this.frozenColCount>0&&e<t.frozenX+t.frozenWidth?0:this._frozenTrailingColCount>0&&e>t.frozenTrailingX?2:1},o.prototype._getViewportColumnLayoutNearX=function(e,t){var o=this._getColumnLayout(e);return o?o.findNearX(t):i},o.prototype._getViewportRowLayoutNearY=function(e,t){var o=this._getRowLayout(e);return o?o.findNearY(t):i},o.prototype._syncHScollbarPosition=function(){var e=this.parent,t=this._getScrollableColumn(this._scrollLeftCol);-1!==t&&t!==this._scrollLeftCol&&(this._scrollLeftCol=t),e&&e._scrollbarH&&e._scrollbarH.value(this._getVisibleColIndex(this._scrollLeftCol))},o.prototype._syncVScrollbarPosition=function(){var e=this.parent,t=this._getScrollableRow(this._scrollTopRow);-1!==t&&t!==this._scrollTopRow&&(this._scrollTopRow=t),e&&e._scrollbarV&&e._scrollbarV.value(this._getVisibleRowIndex(this._scrollTopRow))},o.prototype._syncHScrollbarSize=function(){var e=this.parent;e&&e._resizeHScrollBar&&(e.scrollIgnoreHidden()&&(this._columnIndexInfo=this._getColumnIndexInfo(!0)),e._resizeHScrollBar())},o.prototype._syncVScrollbarSize=function(){var e=this.parent;e&&e._resizeVScrollBar&&(e.scrollIgnoreHidden()&&(this._rowIndexInfo=this._getRowIndexInfo(!0)),e._resizeVScrollBar())},o.prototype._invalidateVScrollbar=function(){var e=this.parent;e&&e.scrollIgnoreHidden()&&(this._needSyncVScrollbarSize=!0),this._syncVScrollbarPosition()},o.prototype._invalidateHScrollbar=function(){var e=this.parent;e&&e.scrollIgnoreHidden()&&(this._needSyncHScrollbarSize=!0),this._syncHScollbarPosition()},o.prototype._getVisibleRowIndex=function(e){var t=this.parent;return t&&t.scrollIgnoreHidden()?this._getRowIndexInfo().visibleIndex[e]:e},o.prototype._getOriginalRowIndex=function(e){var t=this.parent;return t&&t.scrollIgnoreHidden()?this._getRowIndexInfo().originalIndex[e]:e},o.prototype._getVisibleColIndex=function(e){var t=this.parent;return t&&t.scrollIgnoreHidden()?this._getColumnIndexInfo().visibleIndex[e]:e},o.prototype._getOriginalColIndex=function(e){var t=this.parent;return t&&t.scrollIgnoreHidden()?this._getColumnIndexInfo().originalIndex[e]:e},o.prototype._getColumnIndexInfo=function(e){var t,o;if(this._columnIndexInfo&&!e)return this._columnIndexInfo;var n=this.getColumnCount()-this._frozenTrailingColCount-this.frozenColCount,r=this.frozenColCount,i=r+n-1,a=this._cachePool,s={visibleIndex:{},originalIndex:{}};if(i-r+1<=0)return s;for(t=0,o=r;o<=i;o++)s.originalIndex[t]=o,s.visibleIndex[o]=t,a.getZoomColWidth(o)>0&&t++;for(o--,t--;a.getZoomColWidth(o)<=0&&o>=r;)s.originalIndex[t]=o,s.visibleIndex[o]=t,o--;return s},o.prototype._getRowIndexInfo=function(e){var t,o;if(this._rowIndexInfo&&!e)return this._rowIndexInfo;var n=this.getRowCount()-this._frozenTrailingRowCount-this.frozenRowCount,r=this.frozenRowCount,i=r+n-1,a=this._cachePool,s={visibleIndex:{},originalIndex:{}};if(i-r+1<=0)return s;for(t=0,o=r;o<=i;o++)s.originalIndex[t]=o,s.visibleIndex[o]=t,a.getZoomRowHeight(o)>0&&t++;for(o--,t--;a.getZoomRowHeight(o)<=0&&o>=r;)s.originalIndex[t]=o,s.visibleIndex[o]=t,o--;return s},o.prototype._getScrollableRow=function(e,t){var o,n=this.getFrozenRowCount(),r=this.getRowCount()-this.getFrozenTrailingRowCount()-1;if(t){if(e>r&&(e=r),(o=this._getPrevVisualRow(e+1))!=i&&o>=n)return o}else if(e<n&&(e=n),(o=this._getNextVisualRow(e-1))!=i&&o<=r)return o;return-1},o.prototype._getScrollableColumn=function(e,t){var o,n=this.getFrozenColumnCount(),r=this.getColumnCount()-this.getFrozenTrailingColumnCount()-1;if(t){if(e>r&&(e=r),(o=this._getPrevVisualColumn(e+1))!=i&&o>=n)return o}else if(e<n&&(e=n),(o=this._getNextVisualColumn(e-1))!=i&&o<=r)return o;return-1},o.prototype._getTopRowWhenLastRowShowComplete=function(e,t,o){var n,r,i,a,s;if(o<t)return o;for(n=0,r=this._cachePool,i=o,a=o;i>=t;i--)if(!((s=r.getZoomRowHeight(i))<=0)){if((n+=s)>e)break;a=i}return a},o.prototype._getBottomRowWhenFirstRowShowComplete=function(e,t,o){var n,r,i,a,s;if(o<t)return o;for(n=0,r=this._cachePool,i=t,a=t;i<=o;i++)if(!((s=r.getZoomRowHeight(i))<=0)){if((n+=s)>e)break;a=i}return a},o.prototype._getLeftColWhenLastColShowComplete=function(e,t,o){var n,r,i,a,s;if(o<t)return o;for(n=0,r=this._cachePool,i=o,a=o;i>=t;i--)if(!((s=r.getZoomColWidth(i))<=0)){if((n+=s)>e)break;a=i}return a},o.prototype._getPageValueH=function(){var e,t,o,n=this._getSheetLayout(),r=this._getColumnLayout(1,3),i=0,a=0;if(r)for(e=0;e<r.length;e++)i+=t=r[e].width,t>0&&a++;return 0===(o=i/(a=0===a?1:a))?1:u(n.viewportWidth/o)},o.prototype._getPageValueV=function(){var e,t,o,n=this._getSheetLayout(),r=this._getRowLayout(1,3),i=0,a=0;if(r)for(e=0;e<r.length;e++)i+=t=r[e].height,t>0&&a++;return 0===(o=i/(a=0===a?1:a))?1:u(n.viewportHeight/o)},o.prototype._getRightColWhenFirstColShowComplete=function(e,t,o){var n,r,i,a,s;if(o<t)return o;for(n=0,r=this._cachePool,i=t,a=t;i<=o;i++)if(!((s=r.getZoomColWidth(i))<=0)){if((n+=s)>e)break;a=i}return a},o.prototype._getLastVisualScrollRow=function(e){var t,o,n;(e===a||e===i)&&(e=3);var r=this.parent,s=this.frozenRowCount;return r&&r._scrollbarMaxAlign?(t=this._getSheetLayout(),this._getTopRowWhenLastRowShowComplete(t.viewportHeight,s,this.getRowCount()-this._frozenTrailingRowCount-1)):(o=this.getRowCount(e),(3===e||2===e)&&(o-=this._frozenTrailingRowCount),(n=this._getPrevVisualRow(o,e))===i&&(n=s),n)},o.prototype._getLastVisualScrollColumn=function(e){var t,o,n;(e===a||e===i)&&(e=3);var r=this.parent,s=this.frozenColCount;return r&&r._scrollbarMaxAlign?(t=this._getSheetLayout(),this._getLeftColWhenLastColShowComplete(t.viewportWidth,s,this.getColumnCount()-this._frozenTrailingColCount-1)):(o=this.getColumnCount(e),(3===e||1===e)&&(o-=this._frozenTrailingColCount),(n=this._getPrevVisualColumn(o,e))===i&&(n=s),n)},o.prototype._getLastNonNullRowAndCol=function(){var e,t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C=this,w=C.frozenRowCount,v=C.frozenColCount,S=C._floatingObjectArray,x=C.getRowCount()-C._frozenTrailingRowCount-1,R=C.getColumnCount()-C._frozenTrailingColCount-1,b=C._sheetModelManager;if(b&&(e=b.getRowInfos(3),t=b.getColInfos(3),e&&e._getItems()&&((o=e._getItems()).length>0&&o.length-1>w&&(w=o.length-1)),t&&t._getItems()&&((o=t._getItems()).length>0&&o.length-1>v&&(v=o.length-1)),(n=b.getDataModel(3))&&(n._lastNonNullRow>w&&(w=n._lastNonNullRow),n._lastNonNullColumn>v&&(v=n._lastNonNullColumn)),(r=b.getDataModel(2))&&r._lastNonNullRow>w&&(w=r._lastNonNullRow),(i=b.getDataModel(1))&&i._lastNonNullColumn>v&&(v=i._lastNonNullColumn)),(a=b.getSpanModel(3))&&(a._lastNonNullRow>w&&(w=a._lastNonNullRow),a._lastNonNullColumn>v&&(v=a._lastNonNullColumn)),(s=b.getSpanModel(2))&&s._lastNonNullRow>w&&(w=s._lastNonNullRow),(l=b.getSpanModel(1))&&l._lastNonNullColumn>v&&(v=l._lastNonNullColumn),(u=C._tableManager)&&(c=u.getTables()))for(m=0,_=c.length;m<_;m++)(h=c[m])&&((p=h.range()).row+p.rowCount-1>w&&(w=p.row+p.rowCount-1),p.col+p.colCount-1>v&&(v=p.col+p.colCount-1));if(S&&S.length>0)for(m=0,_=S.length;m<_;m++)(d=S[m])&&(d.endRow()>w&&(w=d.endRow()),d.endColumn()>v&&(v=d.endColumn()));if((f=C._commentManager)&&((g=f._commentViewList)&&g.length>0))for(m=0,_=g.length;m<_;m++)(y=g[m])&&y._comment&&(y._endRow>w&&(w=y._endRow),y._endColumn>v&&(v=y._endColumn));return w>x&&(w=x),v>R&&(v=R),{lastNonNullRow:w,lastNonNullCol:v}},o.prototype._setTopRow=function(e){var t,o=this._scrollTopRow;e>=this._getFirstPageTopRow()&&e<=this._getLastVisualScrollRow()&&e!==o&&(this._eventHandler.vScrollTo(e),this._syncVScrollbarPosition(),(t=this.parent)&&!t._scrollbarShowMax&&this._syncVScrollbarSize())},o.prototype._setLeftColumn=function(e){var t,o=this._scrollLeftCol;e>=this._getFirstPageLeftColumn()&&e<=this._getLastVisualScrollColumn()&&e!==o&&(this._eventHandler.hScrollTo(e),this._syncHScollbarPosition(),(t=this.parent)&&!t._scrollbarShowMax&&this._syncHScrollbarSize())},o.prototype._getSpanModel=function(e){return this._sheetModelManager.getSpanModel(e)},o.prototype._clipboardFloatingObjectCopy=function(e,o,n){var r,a,s;if(t.features.floatingObject){var l=this._getFloatingObjectClipboardHelper(),u=l.fromSheet,c=u&&u._eventHandler;for(c&&c._setClipboardFloatingObjectData(i),l.fromSheet=this,l.isCutting=o,r=new t.NamedObjectArray,a=0;a<e.length;a++)(s=this._findFloatingObjectInternal(e[a]))&&r.push(s);this._eventHandler._setClipboardFloatingObjectData(r)}},o.prototype._clipboardCopy=function(e,t,o){var n;if(e){var r=this,a=r._eventHandler,s=v.getRangeText(r,e.row,e.rowCount,e.col,e.colCount,"\r\n","\t",'"',!1,0),l=r._getClipboardHelper();l.fromSheet=r,l.range=e,l.isCutting=t,r._clearFloatingObjectClipboardHelper();try{n={sheet:r,sheetName:r._name,copyData:s,cancel:!1},r.triggerClipboardChanging(n),n&&!1===n.cancel?(a&&!o&&a._switchFocusForClipboard(s),r.triggerClipboardChanged({sheet:r,sheetName:r._name,copyData:s}),setTimeout(function(){!a||o||r.disposed||a._switchBackFocusAfterClipboard()},100)):(l.fromSheet=i,l.range=i)}catch(e){}finally{return s}}},o.prototype._trySearch=function(e,o,r){var i,a,s,l;return!!e&&(t.SearchFlags,e=e.toString(),o=o.toString(),(i=(2&r)>0)&&0==(4&r)?(1&r)>0?e.toLowerCase()===o.toLowerCase():e===o:(a=(4&r)>0,s=(1&r)>0?new RegExp(n(o,a,i),"i"):new RegExp(n(o,a,i)),l=e.search(s)>-1,i&&l&&o.search(/\*/)<=-1&&(l=e.length===o.length),l))},o.prototype._getFilterButtonModel=function(){return!this._filterButtonsModel&&t.features.filter_ui&&(this._filterButtonsModel=this._createFilterButtonModle()),this._filterButtonsModel},o.prototype._createFilterButtonModle=function(){var e,o,n,r,i,a,s,l,u=new t._FilterButtonInfoModel,c=this.rowFilter();if(c&&c.range){var h,p,d,f=(h=c.range).col<0?0:h.col,g=h.col<0?this.getColumnCount():h.col+h.colCount;if(h.row<1?(p=this.getRowCount(1)-1,d=1):(p=h.row-1,d=3),p>=0)for(;f<g;)c.filterButtonVisible&&c.filterButtonVisible(f)?((l=new t._FilterButtonInfo(c)).sheetArea=d,l.row=p,(e=this.getSpans(new t.Range(p,f,1,1),d))&&e.length>0?(o=e[0],l.row=o.row,l.col=o.col,f+=o.colCount):(l.col=f,f++),u.push(l)):f++}for(r=(n=this.getTables())?n.length:0,a=0;a<r;a++)if((i=n[a])&&i.showHeader()&&(p=i.headerIndex())>=0)for(h=i.range(),s=0;s<h.colCount;s++)f=h.col+s,i.filterButtonVisible(s)&&(l=new t._FilterButtonInfo(i.rowFilter(),p,f,3),u.push(l));return u},o.prototype._getFilterButtonHitInfo=function(e,o,n){var r,a,s;if(!t.features.filter_ui)return i;var l,u,c,h=e.rowViewportIndex,p=e.colViewportIndex;if(1===e.hitTestType?(l=this._getColumnHeaderRowLayout().findY(n),u=this._getViewportColumnLayout(p).findX(o),c=1):3===e.hitTestType&&(l=this._getViewportRowLayout(h).findY(n),u=this._getViewportColumnLayout(p).findX(o),c=3),!l||!u)return i;var d=l.row,f=u.col,g=this.getSpan(d,f,c);if(g){if(d!==g.row+g.rowCount-1||f!==g.col+g.colCount-1)return i;d=g.row,f=g.col}return(r=this._getFilterButtonModel().find(d,f,c))&&(a=this.getCellRect(d,f,h,p),(s=this._render._getFilterButtonRect(a,c)).x<=o&&o<=s.x+s.width&&s.y<=n&&n<=s.y+s.height)?new t._FilterButtonInfo(r.rowFilter,r.row,r.col,r.sheetArea,s.x,s.y,s.width,s.height):i},o.prototype._getCellTypeHitInfo=function(e,t,o){var n=e.row,r=e.col,s=e.hitTestType;if(n===i||n===a||r===i||r===a)return i;var l=this.getActualStyle(n,r,s),u=1===s?-1:a,c=2===s?-1:a,h=this.getCellRect(n,r,u,c),p={sheet:this,row:n,col:r,sheetArea:s},d=l.cellType||this.getDefaultCellType(s);return this._allowEditorReservedLocations?d.getHitInfo(t,o,l,h,p):i},o.prototype._getFloatingObjectHitInfo=function(e,o){var n,r,a=this._floatingObjectArray,s=this._getSheetLayout();if(t.features.floatingObject&&s&&a&&a.length>0)for(n=a.length-1;n>=0;n--)if(r=a[n],this.canSelectFloatingObject(r)){var l=r.position().x*this._zoomFactor+s.headerX+s.rowHeaderWidth,u=r.position().y*this._zoomFactor+s.headerY+s.colHeaderHeight,c=r.width(),h=r.height();if(e>=l&&e<l+c&&o>=u&&o<u+h)return{x:e,y:o,floatingObject:r}}return i},o.prototype._getCommentHitInfo=function(e,o){return t.features.comment?this._commentManager.getCommentHitInfo(e,o):i},o.prototype._disposeUserEvents=function(){this.unbindAll(),this._unbindAll()},o.prototype._doCommand=function(e){return this.undoManager().doAction(e)},o.prototype._refreshTabStrip=function(){this.parent&&this.parent._tab&&this.parent._tab.repaint&&this.parent._tab.repaint()},o.prototype._isAnyCellInRangeLocked=function(e){for(var t,o=this._getActualRange(e),n=o.row,r=o.col,i=n+o.rowCount,a=r+o.colCount,s=n;s<i;s++)for(t=r;t<a;t++)if(!0===this.getActualStyle(s,t).locked)return!0;return!1},o.prototype._isValidRange=function(e,t,o,n,r,i){if(-1<=e&&e<r&&-1<=t&&t<i){if(-1===e&&-1===t)return!0;if(-1===e){if(0!==n&&t+n<=i)return!0}else if(-1===t){if(0!==o&&e+o<=r)return!0}else if(0!==n&&t+n<=i&&0!==o&&e+o<=r)return!0}return!1},o.prototype._isValidPastedRange=function(e,t,o,n,r,i){return this._isValidRange(e,t,o,n,r,i)},o.prototype._hasPartSpans=function(e,t,o,n){var r,a,s,l,u,c;if(e<0&&t<0)return!1;if(e<0){if((s=this._getSpanModel(1))&&0!==s.length)for(r=s.getEnumerator(-1,t,-1,n),a=i;r.moveNext();)if((a=r.current()).col<t||a.col+a.colCount>t+n)return!0}else if(t<0&&((l=this._getSpanModel(2))&&0!==l.length))for(r=l.getEnumerator(e,-1,o,-1),a=i;r.moveNext();)if((a=r.current()).row<e||a.row+a.rowCount>e+o)return!0;if((u=this._getSpanModel())&&0!==u.length)for(c=u.getEnumerator(e,t,o,n),a=i;c.moveNext();)if(a=c.current(),-1!==e&&(a.row<e||a.row+a.rowCount>e+o)||-1!==t&&(a.col<t||a.col+a.colCount>t+n))return!0;return!1},o.prototype._hasSpans=function(e,t,o,n){var r,i,a=this._getSpanModel();if(a)for(r=0,i=a.length;r<i;r++)if(a[r].intersect(e,t,o,n))return!0;return!1},o.prototype._hasPartTable=function(e,o,n,r){var i,a,s,l,u=this.getTables();if(u&&u.length>0)for(i=new t.Range(e,o,n,r),a=u.length,l=0;l<a;l++)if(s=u[l].range(),i.intersect(s.row,s.col,s.rowCount,s.colCount)&&!i.containsRange(s))return!0;return!1},o.prototype._hasTable=function(e,t,o,n){return!(!this._tableManager||!this._tableManager.has(e,t,o,n))},o.prototype._hasPartArrayFormulas=function(e,t,o,n){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(e,t,o,n,!0,!0)},o.prototype._getsArrayFormulas=function(e,t,o,n){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(e,t,o,n,!1,!0)},o.prototype._hasArrayFormula=function(e,t,o,n){var r=this._getsArrayFormulas(e,t,o,n);return r&&r.formulas&&r.formulas.length>0},o.prototype._suspendInvalidate=function(){this._layoutSuspended++},o.prototype._resumeInvalidate=function(){if(this._layoutSuspended--,this._layoutSuspended<=0){if(!this.isPaintSuspended())return this.invalidateLayout(),this.repaint(),!0;this._layoutSuspended=0}return!1},o.prototype._nextNonNullRow=function(e,t){var o,n,r=this._bindingManager,i=this.getDataSource();for(e++,n=(o=t?this._getModel(2):this._getModel(3)).getRowCount(),!1===t&&i&&(n=l(n,r.getRowCount()));e>=0&&e<n&&(!o.dataTable.hasOwnProperty(e)||!o.dataTable[e])&&(!1!==t||!i||!r.getDataItem(e));)e++;return e<n?e:-1},o.prototype._nextNonNullColumn=function(e,t,o){var n,r=this._bindingManager,s=this.getDataSource(),l=i,u=o?this._getModel(1):this._getModel(3);if(e>=0&&e<u.getRowCount()&&u.dataTable.hasOwnProperty(e)&&(l=u.dataTable[e]),!1===o&&!l&&s&&e>=0&&e<r.getRowCount()&&(l=r.getDataItem(e)),!l)return-1;for(t++;t>=0&&(t<u.getColumnCount()||t<l.length)&&(!l.hasOwnProperty(t)||!l[t])&&(!1!==o||!s||((n=this._getValueImp(u,e,t))===a||n===i));)t++;return t<u.getColumnCount()||!1===o&&l&&t<l.length?t:-1},o.prototype._closeDragFillPopup=function(){this._smartTag&&this._smartTag.close()},o.prototype._cellRangeInflate=function(e,t){var o,n;if(e&&e.length>0)for(o=0;o<e.length;o++)if(n=e[o],t.intersect(n.row,n.col,n.rowCount,n.colCount))return e.splice(o--,1),this._cellRangeInflate(e,this._unionCellRange(t,n));return t},o.prototype._unionCellRange=function(e,o){var n=s(e.row,o.row),r=s(e.col,o.col),i=l(e.row+e.rowCount-1,o.row+o.rowCount-1),a=l(e.col+e.colCount-1,o.col+o.colCount-1);return n>=0&&r>=0?new t.Range(n,r,i-n+1,a-r+1):n>=0?new t.Range(n,-1,i-n+1,-1):r>=0?new t.Range(-1,r,-1,a-r+1):new t.Range(-1,-1,-1,-1)},o.prototype._getClipboardHelper=function(){return!this._clipboardHelper&&this.parent&&this.parent._clipboardHelper?this._clipboardHelper=this.parent._clipboardHelper:this._clipboardHelper||(this._clipboardHelper={fromSheet:i,range:i,isCutting:!1}),this._clipboardHelper},o.prototype._getFloatingObjectClipboardHelper=function(){return!this._floatingObjectClipboardHelper&&this.parent&&this.parent._floatingObjectClipboardHelper?this._floatingObjectClipboardHelper=this.parent._floatingObjectClipboardHelper:this._floatingObjectClipboardHelper||(this._floatingObjectClipboardHelper={fromSheet:i,isCutting:!1}),this._floatingObjectClipboardHelper},o.prototype._clearFloatingObjectClipboardHelper=function(){var e=this._getFloatingObjectClipboardHelper();e.fromSheet&&e.fromSheet._eventHandler._setClipboardFloatingObjectData(i),e.fromSheet=i,e.isCutting=!1},o.prototype._checkPastedRange=function(e,o,n,r,a,s){var l=t.SR.Exp_PasteSourceCellsLocked;if(s.pastedInternal=!1,s.pastedRange=i,!(e||a&&""!==a))return!1;if(this,this,this._isPastedInternal(e,o,this,a)||!a){if(s.pastedInternal=!0,r&&e.isProtected&&e._isAnyCellInRangeLocked(o))return this._raiseInvalidOperation(1,l),!1;s.pastedRange=this._getPastedRange(e,o,this,n,r)}else s.pastedRange=this._getPastedRangefromText(n,a);return this._checkPasteRangeImp(e,o,n,r,s)},o.prototype._checkPasteRangeImp=function(e,o,n,r,i){var a,s,l,c,h,p,d,f=t.SR.Exp_InvalidCopyPasteSize,g=t.SR.Exp_PasteDestinationCellsLocked,m=t.SR.Exp_PasteChangeMergeCell,_=t.SR.Exp_ChangePartOfArray,y=this,C=y;if(!i.pastedRange)return y._raiseInvalidOperation(1,f),!1;if(C.isProtected&&C._isAnyCellInRangeLocked(i.pastedRange))return y._raiseInvalidOperation(1,g),!1;if(i.pastedInternal){if(e._hasPartSpans(o.row,o.col,o.rowCount,o.colCount))return y._raiseInvalidOperation(1,m),!1;if(r&&e._hasPartArrayFormulas(o.row,o.col,o.rowCount,o.colCount))return y._raiseInvalidOperation(1,_),!1;var w=i.pastedRange.row<0?C.getRowCount():i.pastedRange.rowCount,v=i.pastedRange.col<0?C.getColumnCount():i.pastedRange.colCount,S=o.row<0?e.getRowCount():o.rowCount,x=o.col<0?e.getColumnCount():o.colCount;if(w>S||v>x)for(a=n.row,s=n.col,n.row<0&&S<C.getRowCount()&&(a=0),n.col<0&&x<C.getColumnCount()&&(s=0),w%S==0&&1===v?(v=x,i.pastedRange=new t.Range(a,s,w,v)):1===w&&v%x==0?(w=S,i.pastedRange=new t.Range(a,s,w,v)):(w%S!=0||v%x!=0)&&(w=S,v=x,i.pastedRange=new t.Range(a,s,w,v)),l=u(w/S),c=u(v/x),h=0;h<l;h++)for(p=0;p<c;p++){if(!y._isSingleCellToSpanCell(o,i.pastedRange)&&C._hasPartSpans(a<0?-1:a+h*S,s<0?-1:s+p*x,a<0?-1:S,s<0?-1:x))return y._raiseInvalidOperation(1,m),!1;if(C._hasPartArrayFormulas(a<0?-1:a+h*S,s<0?-1:s+p*x,a<0?-1:S,s<0?-1:x))return y._raiseInvalidOperation(1,_),!1}else{if(d=i.pastedRange,!y._isSingleCellToSpanCell(o,d)&&C._hasPartSpans(d.row,d.col,d.rowCount,d.colCount))return y._raiseInvalidOperation(1,m),!1;if(C._hasPartArrayFormulas(d.row,d.col,d.rowCount,d.colCount))return y._raiseInvalidOperation(1,_),!1}}else{if(d=i.pastedRange,C._hasPartSpans(d.row,d.col,d.rowCount,d.colCount))return y._raiseInvalidOperation(1,m),!1;if(C._hasPartArrayFormulas(d.row,d.col,d.rowCount,d.colCount))return y._raiseInvalidOperation(1,_),!1;if(!C._isValidPastedRange(d.row,d.col,d.rowCount,d.colCount,C.getRowCount(),C.getColumnCount()))return y._raiseInvalidOperation(1,f),!1}return!0},o.prototype._isSingleCellToSpanCell=function(e,t){if(e&&1===e.rowCount&&1===e.colCount){var o=this.getSpan(t.row,t.col);if(o&&o.equals(t))return!0}return!1},o.prototype._isPastedInternal=function(e,o,n,r){if(e&&o&&n){var i=v.getRangeText(e,o.row,o.rowCount,o.col,o.colCount,"\r\n","\t",'"',!1,0),a=i===r;return!a&&(t.util.browser.chrome||t.util.browser.safari||t.util.browser.webkit)&&(a=i===r+"\r\n"),a}return!1},o.prototype._getPastedRange=function(e,o,n,r,a){var s,l=o.row<0?0:o.row,u=o.col<0?0:o.col,c=o.row<0?e.getRowCount():o.rowCount,h=o.col<0?e.getColumnCount():o.colCount,p=r.row<0?0:r.row,d=r.col<0?0:r.col,f=r.row<0?n.getRowCount():r.rowCount,g=r.col<0?n.getColumnCount():r.colCount;if(a?(f=c,g=h):f%c==0&&1===g?g=h:1===f&&g%h==0?f=c:(f%c!=0||g%h!=0)&&(f=c,g=h),!this._isValidPastedRange(l,u,c,h,e.getRowCount(),e.getColumnCount())||!this._isValidPastedRange(p,d,f,g,n.getRowCount(),n.getColumnCount()))return i;if(s=new t.Range(p,d,f,g),!a&&e._name===n._name)if(s.contains(l,u,c,h)){if((l-p)%c!=0||(u-d)%h!=0)return i}else if(s.intersect(l,u,c,h)&&(f>c||g>h))return i;return-1===r.row&&(p=-1,f=-1),-1===r.col&&(d=-1,g=-1),new t.Range(p,d,f,g)},o.prototype._getPastedRangefromText=function(e,o){var n=i,r=v.parseCsv(o,"\r\n","\t",'"');if(r){var a=e.row<0?0:e.row,s=e.col<0?0:e.col,l=r.length,u=v.getMaxLength(r);l>0&&u>0&&(n=new t.Range(a,s,l,u))}return n},o.prototype._clearClipboard=function(){var e=this._getClipboardHelper();e&&(e.fromSheet=i,e.range=i,e.isCutting=!1)},o.prototype._clipboardPaste=function(e,o,n,r,a,s,l){var c,h,p,d,f,g,m,_,y,C,w,S,x,R;if(e&&n._name===e._name&&n.parent&&!t.ArrayHelper.contains(n.parent.sheets,e))e._clearClipboard();else if(m=(0,t.UndoRedo.ClipboardPasteRangeUndoAction.convertPasteOption)(l),e&&o){if(0!=(2&m)&&(a&&e._hasPartArrayFormulas(o.row,o.col,o.rowCount,o.colCount)||n._hasPartArrayFormulas(r.row,r.col,r.rowCount,r.colCount)))throw t.SR.Exp_ChangePartOfArray;if(a)v.moveTo(e,o.row,o.col,n,r.row,r.col,o.rowCount,o.colCount,m),e._clearClipboard();else if(_=r.row<0?n.getRowCount():r.rowCount,y=r.col<0?n.getColumnCount():r.colCount,p=o.row<0?e.getRowCount():o.rowCount,d=o.col<0?e.getColumnCount():o.colCount,_>p||y>d){c=r.row,h=r.col,r.row<0&&p<n.getRowCount()&&(c=0),r.col<0&&d<n.getColumnCount()&&(h=0),_%p==0&&1===y?y=d:1===_&&y%d==0?_=p:(_%p!=0||y%d!=0)&&(_=p,y=d),C=u(_/p),w=u(y/d),e.suspendCalcService(),n.suspendCalcService();try{for(f=0;f<C;f++)for(g=0;g<w;g++)v.copyTo(e,o.row,o.col,n,c<0?-1:c+f*p,h<0?-1:h+g*d,c<0?-1:p,h<0?-1:d,m,!0)}finally{e.resumeCalcService(!1),n.resumeCalcService(!1)}}else v.copyTo(e,o.row,o.col,n,r.row,r.col,o.rowCount,o.colCount,m,!0)}else{c=r.row,h=r.col,p=r.rowCount,d=r.colCount;for(var b=n._getSpanModel(),T=b.getEnumerator(c,h,p,d),A=[];T.moveNext();)(S=T.current())&&A.push(S);for(x=0,R=A.length;x<R;x++)b.remove(A[x]);if((1&m)>0&&v.clearFormula(n,c,h,p,d,!0),s&&""!==s)n.setCsv(c,h,s,"\r\n","\t",16);else for(f=0;f<p;f++)for(g=0;g<d;g++)n.setValue(c+f,h+g,i)}},o.prototype._copyFormula=function(e,o,n,r,i,a){t.Calc.CalcOperatorAdjustor.copyFormula(this._getCalcModel(),e,o,this._getCalcModel(),n,r,i,a)},o.prototype._getAutoFitType=function(){return this.parent!=i?this.parent.autoFitType():0},o.prototype._doCut=function(e){if(!this.isEditing()){var t=this.getSelections();if(t&&1===t.length)return this._clipboardCopy(t[0],!0,e)}return i},o.prototype._doCopy=function(e){if(!this.isEditing()){var t=this.getSelections();if(t&&1===t.length)return this._clipboardCopy(t[0],!1,e)}return i},o.prototype._doFloatingObjectCopy=function(e){var t,o,n,r,i;if(this._hasFloatingObjectsSelected()){for(t=[],o=0,n=(r=this._floatingObjectArray).length;o<n;o++)(i=r[o]).isSelected()&&t.push(i.name());this._clipboardFloatingObjectCopy(t,!1,e)}},o.prototype._doFloatingObjectCut=function(e){var o,n,r,i,a,s,l;if(this._hasFloatingObjectsSelected()){for(o=[],n=0,r=(i=this._floatingObjectArray).length;n<r;n++)(a=i[n]).isSelected()&&o.push(a.name());this._clipboardFloatingObjectCopy(o,!0,e),s={names:o},l=new t.UndoRedo.DeleteFloatingObjectUndoAction(this,s),this._doCommand(l)}},o.prototype._doFloatingObjectPaste=function(e,o){var n=this;if(!n.isEditing()&&t.features.floatingObject){var r=n._getFloatingObjectClipboardHelper(),i=r.fromSheet,a=i._eventHandler;r.isCutting;setTimeout(function(){var r,s,l,u,c;if(!n.disposed){if(r=e,a&&!e&&(r=a._getClipboardFloatingObjectData()),r&&r.length){for(s=[],l=0,u=r.length;l<u;l++)s.push(r[l].name());c=new t.UndoRedo.ClipboardPasteFloatingObjectUndoAction(n,{names:s},i),n._doCommand(c)}o&&o()}},100)}},o.prototype._doPaste=function(e,t){var o=this,n=o._eventHandler;o.isEditing()||(n&&!e&&n._switchFocusForClipboard(""),setTimeout(function(){var r,i,a;o.disposed||(r=e,n&&!e&&(r=n._getClipboardData(),n._switchBackFocusAfterClipboard()),(i=o._getPasteInfo(r))&&(a=o._createPasteAction(i),o._doCommand(a),t&&t()))},100))},o.prototype._createPasteAction=function(e){var o=e.pastedRanges,n=e.fromSheet,r=e.fromRange,i=e.isCutting,a=e.pasteOption,s=e.clipboardText,l={fromRange:r,pastedRanges:o.slice(0),isCutting:i,clipboardText:s};return new t.UndoRedo.ClipboardPasteUndoAction(this,n,this,l,a)},o.prototype._getPasteInfo=function(e){var o,n,r,a,s,l=this,u=(l._eventHandler,t.SR.Exp_InvalidPastedArea),c=l._getClipboardHelper(),h=c.fromSheet,p=c.range,d=c.isCutting;d&&h&&p&&h.isProtected&&h._isAnyCellInRangeLocked(p)&&(d=!1);var f,g={pastedRange:i,pastedInternal:!1},m=[],_=l.getSelections();if(_.length>1)for(o=0;o<_.length;o++){if(f=_[o],!l._checkPastedRange(h,p,f,d,e,g))return;if(f.containsRange(g.pastedRange)&&!f.equals(g.pastedRange))return void l._raiseInvalidOperation(1,u);m.push(g.pastedRange)}else if(_.length>0){if(f=_[0],!l._checkPastedRange(h,p,f,d,e,g))return;m.push(g.pastedRange)}else{if((f=l._getSpanModel().find(l._activeRowIndex,l._activeColIndex))||(f=new t.Range(l._activeRowIndex,l._activeColIndex,1,1)),!l._checkPastedRange(h,p,f,d,e,g))return;m.push(g.pastedRange)}for((n=l._cutCopyIndicatorManager)&&n.isPastedInternal(g.pastedInternal),g.pastedInternal||(h=i,p=i,d=!1),r=l.clipBoardOptions(),d&&(r=0),a=0;a<m.length;a++)s=m[a],l._isSingleCellToSpanCell(p,s)&&(s.rowCount=1,s.colCount=1);return{fromSheet:h,fromRange:p,isCutting:d,pasteOption:r,pastedRanges:m,clipboardText:e}},o.prototype._getImageLoader=function(){if(!this.imageLoader){var e=this;e.imageLoader=new t._GcImageLoader(function(){e.imageLoader&&e.repaint()})}return this.imageLoader},o.prototype._getContainerDiv=function(){return!this._containerDiv&&this._canvas&&this._canvas.parentNode&&(this._containerDiv=y.createElement("div"),t.GC$(this._containerDiv).css({position:"absolute",left:0,top:0,width:0,height:0}),t.GC$(this._canvas.parentNode).prepend(this._containerDiv)),this._containerDiv},o.prototype._raiseDragDropBlock=function(e,t,o,n,r,i,a,s,l){var u={sheet:this,sheetName:this._name,fromRow:e,fromCol:t,toRow:o,toCol:n,rowCount:r,colCount:i,copy:a,insert:s,copyOption:l,cancel:!1};return this.triggerDragDropBlock(u),u&&!0===u.cancel},o.prototype._raiseDragDropBlockCompleted=function(e,t,o,n,r,i,a,s,l){var u={sheet:this,sheetName:this._name,fromRow:e,fromCol:t,toRow:o,toCol:n,rowCount:r,colCount:i,copy:a,insert:s,copyOption:l};this.triggerDragDropBlockCompleted(u)},o.prototype._raiseInvalidOperation=function(e,t){var o={sheet:this,sheetName:this._name,invalidType:e,message:t};this.triggerInvalidOperation(o)},o.prototype._raiseSelectionChanging=function(e,t){return!0===this._eventHandler._notEqualSelecions(e,t)&&(this.triggerSelectionChanging({sheet:this,sheetName:this._name,oldSelections:e,newSelections:t}),!0)},o.prototype._raiseSelectionChanged=function(){this.triggerSelectionChanged({sheet:this,sheetName:this._name})},o.prototype._raiseDragFillBlock=function(e){return e.cancel=!1,this.triggerDragFillBlock(e),e&&!0===e.cancel},o.prototype._raiseDragFillBlockCompleted=function(e){this.triggerDragFillBlockCompleted(e)},o.prototype._raiseCellChanged=function(e,t,o,n,r,i){var a={sheet:this,sheetName:this._name,row:t,col:o,sheetArea:i,propertyName:e,oldValue:n,newValue:r};this.triggerCellChanged(a)},o.prototype._raiseClipboardPasting=function(e,t){var o={sheet:this,sheetName:this._name,cellRange:e,pasteOption:t,cancel:!1};return this.triggerClipboardPasting(o),!0===o.cancel},o.prototype._raiseClipboardPasted=function(e,t){var o={sheet:this,sheetName:this._name,cellRange:e,pasteOption:t};this.triggerClipboardPasted(o)},o.prototype._raiseValueChanged=function(e,t,o,n){var r={sheet:this,sheetName:this._name,row:e,col:t,oldValue:o,newValue:n};this.triggerValueChanged(r)},o.prototype._raiseRangeDataChanged=function(e,t,o,n,r,i){var a={sheet:this,sheetName:this._name,row:e,column:t,rowCount:o,columnCount:n,changedCells:r,action:i};this.triggerRangeChanged(a)},o.prototype._trigger=function(e,t){var o=this._eventHandler;o&&0===o._eventSuspended&&o.trigger(e,t)},o.prototype.triggerValidationError=function(e){this._trigger(t.Events.ValidationError,e)},o.prototype.triggerCellClick=function(e){this._trigger(t.Events.CellClick,e)},o.prototype.triggerCellDoubleClick=function(e){this._trigger(t.Events.CellDoubleClick,e)},o.prototype.triggerEnterCell=function(e){this._trigger(t.Events.EnterCell,e)},o.prototype.triggerLeaveCell=function(e){this._trigger(t.Events.LeaveCell,e)},o.prototype.triggerValueChanged=function(e){this._trigger(t.Events.ValueChanged,e)},o.prototype.triggerTopRowChanged=function(e){this._trigger(t.Events.TopRowChanged,e)},o.prototype.triggerLeftColumnChanged=function(e){this._trigger(t.Events.LeftColumnChanged,e)},o.prototype.triggerInvalidOperation=function(e){this._trigger(t.Events.InvalidOperation,e)},o.prototype.triggerRangeFiltering=function(e){this._trigger(t.Events.RangeFiltering,e)},o.prototype.triggerRangeFiltered=function(e){this._trigger(t.Events.RangeFiltered,e)},o.prototype.triggerTableFiltering=function(e){this._trigger(t.Events.TableFiltering,e)},o.prototype.triggerTableFiltered=function(e){this._trigger(t.Events.TableFiltered,e)},o.prototype.triggerRangeSorting=function(e){this._trigger(t.Events.RangeSorting,e)},o.prototype.triggerRangeSorted=function(e){this._trigger(t.Events.RangeSorted,e)},o.prototype.triggerClipboardChanging=function(e){this._trigger(t.Events.ClipboardChanging,e)},o.prototype.triggerClipboardChanged=function(e){this._trigger(t.Events.ClipboardChanged,e)},o.prototype.triggerClipboardPasting=function(e){this._trigger(t.Events.ClipboardPasting,e)},o.prototype.triggerClipboardPasted=function(e){this._trigger(t.Events.ClipboardPasted,e)},o.prototype.triggerColumnWidthChanging=function(e){this._trigger(t.Events.ColumnWidthChanging,e)},o.prototype.triggerColumnWidthChanged=function(e){this._trigger(t.Events.ColumnWidthChanged,e)},o.prototype.triggerRowHeightChanging=function(e){this._trigger(t.Events.RowHeightChanging,e)},o.prototype.triggerRowHeightChanged=function(e){this._trigger(t.Events.RowHeightChanged,e)},o.prototype.triggerDragDropBlock=function(e){this._trigger(t.Events.DragDropBlock,e)},o.prototype.triggerDragDropBlockCompleted=function(e){this._trigger(t.Events.DragDropBlockCompleted,e)},o.prototype.triggerDragFillBlock=function(e){this._trigger(t.Events.DragFillBlock,e)},o.prototype.triggerDragFillBlockCompleted=function(e){this._trigger(t.Events.DragFillBlockCompleted,e)},o.prototype.triggerEditStarting=function(e){this._trigger(t.Events.EditStarting,e)},o.prototype.triggerEditChange=function(e){this._trigger(t.Events.EditChange,e)},o.prototype.triggerEditEnding=function(e){this._trigger(t.Events.EditEnding,e)},o.prototype.triggerEditEnded=function(e){this._trigger(t.Events.EditEnded,e)},o.prototype.triggerRangeGroupStateChanging=function(e){this._trigger(t.Events.RangeGroupStateChanging,e)},o.prototype.triggerRangeGroupStateChanged=function(e){this._trigger(t.Events.RangeGroupStateChanged,e)},o.prototype.triggerSelectionChanging=function(e){this._trigger(t.Events.SelectionChanging,e)},o.prototype.triggerSelectionChanged=function(e){this._trigger(t.Events.SelectionChanged,e)},o.prototype.triggerSheetNameChanging=function(e){this._trigger(t.Events.SheetNameChanging,e)},o.prototype.triggerSheetNameChanged=function(e){this._trigger(t.Events.SheetNameChanged,e)},o.prototype.triggerUserZooming=function(e){this._trigger(t.Events.UserZooming,e)},o.prototype.triggerUserFormulaEntered=function(e){this._trigger(t.Events.UserFormulaEntered,e)},o.prototype.triggerCellChanged=function(e){this._trigger(t.Events.CellChanged,e)},o.prototype.triggerColumnChanged=function(e){this._trigger(t.Events.ColumnChanged,e)},o.prototype.triggerRowChanged=function(e){this._trigger(t.Events.RowChanged,e)},o.prototype.triggerSparklineChanged=function(e){this._trigger(t.Events.SparklineChanged,e)},o.prototype.triggerRangeChanged=function(e){e.changedCells&&e.changedCells.length>0&&this._trigger(t.Events.RangeChanged,e)},o.prototype.triggerEditorStatusChanged=function(e){this._trigger(t.Events.EditorStatusChanged,e)},o.prototype.triggerFloatingObjectChanged=function(e){this._trigger(t.Events.FloatingObjectChanged,e)},o.prototype.triggerFloatingObjectSelectionChanged=function(e){this._trigger(t.Events.FloatingObjectSelectionChanged,e)},o.prototype.triggerPictureChanged=function(e){this._trigger(t.Events.PictureChanged,e)},o.prototype.triggerPictureSelectionChanged=function(e){this._trigger(t.Events.PictureSelectionChanged,e)},o.prototype.triggerCustomFloatingObjectLoaded=function(e){this._trigger(t.Events.CustomFloatingObjectLoaded,e)},o.prototype.triggerTouchToolStripOpening=function(e){this._trigger(t.Events.TouchToolStripOpening,e)},o.prototype.triggerCommentChanged=function(e){this._trigger(t.Events.CommentChanged,e)},o.prototype.triggerEditEnd=function(e){this._trigger(t.Events.EditEnd,e)},o.prototype.triggerEditStarted=function(e){this._trigger(t.Events.EditStarted,e)},o.prototype.triggerFormulaTextBoxTextChanged=function(e){this._trigger("FormulaTextBoxTextChanged",e)},o.prototype.triggerFormulaTextBoxCaretChanged=function(e){this._trigger("FormulaTextBoxCaretChanged",e)},o.prototype.triggerSlicerChanged=function(e){this._trigger(t.Events.SlicerChanged,e)},o.prototype.triggerFloatingObjectRemoving=function(e){this._trigger(t.Events.FloatingObjectRemoving,e)},o.prototype.triggerFloatingObjectRemoved=function(e){this._trigger(t.Events.FloatingObjectRemoved,e)},o.prototype.triggerCommentRemoving=function(e){this._trigger(t.Events.CommentRemoving,e)},o.prototype.triggerCommentRemoved=function(e){this._trigger(t.Events.CommentRemoved,e)},o.prototype.getBounds=function(){var e=this._bounds;return new t.Rect(e.x,e.y,e.width,e.height)},o.prototype.setBounds=function(e){var o=this._bounds=new t.Rect(0,0,0,0);o.x=e.x,o.y=e.y,o.width=e.width,o.height=e.height},o.sheetId=1,o}();t.Sheet=w,r=function(){function e(e){this.rowHeader=1==(1&e),this.columnHeader=2==(2&e),this.unFormatted=8==(8&e),this.formula=16==(16&e),this.expandRows=!0,this.expandColumns=!0}return e.prototype.fixOptions=function(e){e&&(e.getColumnCount(2)<=0&&(this.rowHeader=!1),e.getRowCount(1)<=0&&(this.columnHeader=!1))},e}();var v=function(){function e(){}return e.saveTable=function(e,o,n,r,i,a,l,u){var c,h,p,d,f=[],g=e.getTables();if(g)for(o<0&&(o=0,l=s(e.getRowCount(),r.getRowCount())),n<0&&(n=0,u=s(e.getColumnCount(),r.getColumnCount())),c=e._tableManager,h=new t.Range(o,n,l,u),p=g.length-1;p>=0;p--)d=g[p],h.containsRange(d.range())&&(c._tableList.splice(p,1),d._clearSheetModelFormula(),f.push(d));return f},e.restoreTableForCopyTo=function(e,o,n,r,i,s,l,u,c){var h,p,d,f,g;for(n<0&&(n=0),r<0&&(r=0),s<0&&(s=0),l<0&&(l=0),h=o._tableManager,p=0;p<e.length;p++)(m=e[p])._setOwner(h),h._tableList.push(m),m._syncSheetModelFormula();for(d=i._tableManager,f=0;f<e.length;f++){var m=e[f],_=JSON.stringify(m.toJSON()),y=m.bindingPath()?a:m.getSource(),C=new t.SheetTable;C._setOwner(d),C.fromJSON(JSON.parse(_)),g=C.range(),C.name(d.getNoConflictTableName(C.name())),C._moveToCore(s+g.row-n,l+g.col-r),d._tableList.push(C),C._syncSheetModelFormula(),y&&C.copyDataSourceImp(y)}},e.restoreTableForMoveTo=function(e,t,o,n,r,i,a,s,l){var u,c,h,p;for(o<0&&(o=0),n<0&&(n=0),i<0&&(i=0),a<0&&(a=0),u=r._tableManager,c=0;c<e.length;c++)(h=e[c])._setOwner(u),p=h.range(),h._moveToCore(i+p.row-o,a+p.col-n),u._tableList.push(h),h._syncSheetModelFormula()},e.copyTo=function(o,n,r,a,s,l,u,c,h,p){var d,f,g,m,_=e,y=o._getCalcModel(),C=a._getCalcModel();_.checkArguments(o,n,r,a,s,l,u,c),(64&h)>0&&_.copyStyle(o,n,r,a,s,l,u,c,p),(1&h)>0&&(2&h)>0&&(d=_.saveTable(o,n,r,a,s,l,u,c)),o.suspendCalcService(),a.suspendCalcService(),f=i,(256&h)>0&&(f=_.copyBindingPath(o,n,r,a,s,l,u,c,p));try{if((1&h)>0&&(_.copyValue(o,n,r,a,s,l,u,c,p),0==(2&h)&&_.clearFormula(a,s,l,u,c,p),(256&h)>0)){var w=f.length,v=s<0?0:s,S=l<0?0:l;for(g=0;g<w;g++)m=f[g],p&&a.isRowFilterOut(v+m.row)||a.setValue(v+m.row,S+m.col,m.value)}(1&h)>0&&(2&h)>0&&_.restoreTableForCopyTo(d,o,n,r,a,s,l,u,c),(2&h)>0&&t.Calc.CalcOperatorAdjustor.copyFormula(y,n,r,C,s,l,u,c,p)}finally{o.resumeCalcService(!1),a.resumeCalcService(!1)}(512&h)>0&&_.copyConditionalFormatRules(o,n,r,a,s,l,u,c),(4&h)>0&&_.copyComment(o,n,r,a,s,l,u,c,p),(128&h)>0&&_.copyTag(o,n,r,a,s,l,u,c),(16&h)>0&&_.copySparkline(o,n,r,a,s,l,u,c),(8&h)>0&&(n<0&&_.copyColumnRangeGroup(o,r,a,l,c),r<0&&_.copyRowRangeGroup(o,n,a,s,u)),(32&h)>0&&(1===u&&1===c||_.copySpan(o,n,r,a,s,l,u,c)),n<0&&_.copyColumnAxis(o,r,a,l,c,h),r<0&&_.copyRowAxis(o,n,a,s,u,h,p),n<0&&s<0&&r<0&&l<0&&_.copySheetInfo(o,a,h)},e.checkArguments=function(e,n,r,i,a,l,u,c){var h,p,d,f;if(!e)throw new Error(t.SR.Exp_SrcIsNull);if(!i)throw new Error(t.SR.Exp_DestIsNull);(n<-1||n>=e.getRowCount())&&o("from row index",n,"-1",e.getRowCount()-1),(r<-1||r>=e.getColumnCount())&&o("from column index",r,"-1",e.getColumnCount()-1),(a<-1||a>=i.getRowCount())&&o("to row index",a,"-1",i.getRowCount()-1),(l<-1||l>=i.getColumnCount())&&o("to column index",l,"-1",i.getColumnCount()-1),h=r,r<0&&(h=0,c=e.getColumnCount()),p=l<0?0:l,(c<1||h+c>e.getColumnCount()||p+c>i.getColumnCount())&&o("column count",c,"1",s(e.getColumnCount()-h,i.getColumnCount()-p)),d=n,n<0&&(d=0,u=e.getRowCount()),f=a<0?0:a,(u<1||d+u>e.getRowCount()||f+u>i.getRowCount())&&o("row count",u,"1",s(e.getRowCount()-d,i.getRowCount()-f))},e.copyValue=function(o,n,r,a,l,u,c,h,p){var f,g,m,_,y,C,w,v,S=!(o===a&&o._name===a._name);if(n<0){var x=r,R=u;if(f=s(o.getRowCount(1),a.getRowCount(1)),g=h,r<0&&(x=0,g=o.getColumnCount()),u<0&&(R=0),S)for(m=0;m<f;m++)for(_=0;_<g;_++)(typeof(y=o._sheetModelManager.getDataModel(1).getValue(m,x+_))===d||y===i)&&o.isColumnBound(x+_)&&(m===o.colHeaderAutoTextIndex||m===f-1&&-1===o.colHeaderAutoTextIndex)&&(y=o.getDataColumnName(x+_)),typeof y===d||y===i?a._setValueInternal(m,R+_,i,1,!1):a._setValueInternal(m,R+_,e.cloneObject(y),1,!1);else{for(C=new t._GcSheetModel(f,g,i),m=0;m<f;m++)for(_=0;_<g;_++)(typeof(y=o._sheetModelManager.getDataModel(1).getValue(m,x+_))===d||y===i)&&o.isColumnBound(x+_)&&(m===o.colHeaderAutoTextIndex||m===f-1&&-1===o.colHeaderAutoTextIndex)&&(y=o.getDataColumnName(x+_)),typeof y!==d&&y!==i&&C.setValue(m,_,e.cloneObject(y));for(m=0;m<f;m++)for(_=0;_<g;_++)a._setValueInternal(m,R+_,C.getValue(m,_),1,!1)}}if(r<0){var b=n,T=l;if(f=c,g=s(o.getColumnCount(2),a.getColumnCount(2)),n<0&&(b=0,f=o.getRowCount()),l<0&&(T=0),S)for(m=0;m<f;m++)for(_=0;_<g;_++)typeof(y=o._sheetModelManager.getDataModel(2).getValue(b+m,_))===d||y===i?a._setValueInternal(T+m,_,i,2,!1):a._setValueInternal(T+m,_,e.cloneObject(y),2,!1);else{for(w=new t._GcSheetModel(f,g,i),m=0;m<f;m++)for(_=0;_<g;_++)typeof(y=o._sheetModelManager.getDataModel(2).getValue(b+m,_))!==d&&y!==i&&w.setValue(m,_,e.cloneObject(y));for(m=0;m<f;m++)for(_=0;_<g;_++)a._setValueInternal(T+m,_,w.getValue(m,_),2,!1)}}var A=n,I=r,D=l,F=u,M=c,E=h;if(n<0&&(A=0,M=s(o.getRowCount(),a.getRowCount())),r<0&&(I=0,E=s(o.getColumnCount(),a.getColumnCount())),l<0&&(D=0),u<0&&(F=0),S){for(m=0;m<M;m++)if(!p||!a.isRowFilterOut(D+m))for(_=0;_<E;_++)typeof(y=o.getValue(A+m,I+_,3))===d||y===i?a._setValueInternal(D+m,F+_,i,3,!1):a._setValueInternal(D+m,F+_,e.cloneObject(y),3,!1)}else{for(v=new t._GcSheetModel(M,E,i),m=0;m<M;m++)for(_=0;_<E;_++)typeof(y=o.getValue(A+m,I+_,3))!==d&&y!==i&&v.setValue(m,_,e.cloneObject(y));for(m=0;m<M;m++)if(!p||!a.isRowFilterOut(D+m))for(_=0;_<E;_++)a._setValueInternal(D+m,F+_,v.getValue(m,_),3,!1)}},e._copyMoveBindingPath=function(e,o,n,r,a,l,u,c,h,p){var d,f,g,m,_,y=o,C=n,w=a,v=l,S=u,x=c;if(o<0&&(y=0,S=s(e.getRowCount(),r.getRowCount())),n<0&&(C=0,x=s(e.getColumnCount(),r.getColumnCount())),a<0&&(w=0),l<0&&(v=0),d=[],!(e===r&&e._name===r._name))for(m=0;m<S;m++)for(_=0;_<x;_++)g=e.getBindingPath(y+m,C+_),r.setBindingPath(w+m,v+_,g),g&&d.push({row:m,col:_,value:e.getValue(y+m,C+_)}),h&&e.setBindingPath(y+m,C+_,i);else{for(f=new t._GcSheetModel(S,x,i),m=0;m<S;m++)for(_=0;_<x;_++)g=e.getBindingPath(y+m,C+_),f.setBindingPath(m,_,g),g&&d.push({row:m,col:_,value:e.getValue(y+m,C+_)}),h&&e.setBindingPath(y+m,C+_,i);for(m=0;m<S;m++)if(!p||!r.isRowFilterOut(w+m))for(_=0;_<x;_++)r.setBindingPath(w+m,v+_,f.getBindingPath(m,_))}return d},e.copyBindingPath=function(t,o,n,r,i,a,s,l,u){return e._copyMoveBindingPath(t,o,n,r,i,a,s,l,!1,u)},e.cloneObject=function(t){var o,n;if(!t)return t;if(typeof t===g||typeof t===m||typeof t===_||typeof t===d)return t;if(t instanceof Date)return new Date(t);for(n in o=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(n)&&o[n]!==t[n]&&(o[n]="object"==typeof this[n]?e.cloneObject(t[n]):t[n]);return o.toString=t.toString,o.valueOf=t.valueOf,o},e.clearFormula=function(e,t,o,n,r,a){var s,l;for(t<0&&(t=0,n=e.getRowCount()),o<0&&(o=0,r=e.getColumnCount()),s=0;s<n;s++)if(!a||!e.isRowFilterOut(s+t))for(l=0;l<r;l++)e.setFormula(s+t,l+o,i)},e.copyStyle=function(e,o,n,r,a,l,u,c,h){var p,d,f,g,m,_,y,C,w,v,S,x,R=!(e===r&&e._name===r._name);if(o<0)if(_=n,y=l,p=s(e.getRowCount(1),r.getRowCount(1)),d=c,n<0&&(_=0,d=e.getColumnCount()),l<0&&(y=0),R)for(f=0;f<p;f++)for(g=0;g<d;g++)(m=e.getCompositeStyle(f,_+g,1))?r.setStyleWithoutLocked(f,y+g,m.clone(),1):r.setStyleWithoutLocked(f,y+g,i,1);else{for(C=new t._GcSheetModel(p,d,i),f=0;f<p;f++)for(g=0;g<d;g++)(m=e.getCompositeStyle(f,_+g,1))&&C.setValue(f,g,m.clone());for(f=0;f<p;f++)for(g=0;g<d;g++)r.setStyleWithoutLocked(f,y+g,C.getValue(f,g),1)}if(n<0)if(w=o,v=a,p=u,d=s(e.getColumnCount(2),r.getColumnCount(2)),o<0&&(w=0,p=e.getRowCount()),a<0&&(v=0),R)for(f=0;f<p;f++)for(g=0;g<d;g++)(m=e.getCompositeStyle(w+f,g,2))?r.setStyleWithoutLocked(v+f,g,m.clone(),2):r.setStyleWithoutLocked(v+f,g,i,2);else{for(S=new t._GcSheetModel(p,d,i),f=0;f<p;f++)for(g=0;g<d;g++)(m=e.getCompositeStyle(w+f,g,2))&&S.setValue(f,g,m.clone());for(f=0;f<p;f++)for(g=0;g<d;g++)r.setStyleWithoutLocked(v+f,g,S.getValue(f,g),2)}var b=o,T=n,A=a,I=l,D=u,F=c;if(o<0&&(b=0,D=s(e.getRowCount(),r.getRowCount())),n<0&&(T=0,F=s(e.getColumnCount(),r.getColumnCount())),a<0&&(A=0),l<0&&(I=0),R){for(f=0;f<D;f++)if(!h||!r.isRowFilterOut(A+f))for(g=0;g<F;g++)(m=e.getCompositeStyle(b+f,T+g,3))?r.setStyleWithoutLocked(A+f,I+g,m.clone(),3):r.setStyleWithoutLocked(A+f,I+g,i,3)}else{for(x=new t._GcSheetModel(D,F,i),f=0;f<D;f++)for(g=0;g<F;g++)(m=e.getCompositeStyle(b+f,T+g,3))&&x.setValue(f,g,m.clone());for(f=0;f<D;f++)if(!h||!r.isRowFilterOut(A+f))for(g=0;g<F;g++)r.setStyleWithoutLocked(A+f,I+g,x.getValue(f,g),3)}},e.copyConditionalFormatRules=function(e,o,n,r,i,a,s,l){var u,c,h,p,d,f,g,m,_=[],y=e._conditionalFormats;if(y){for(u=0;u<s;u++)for(c=0;c<l;c++)for(h=y.getRules(o+u,n+c),p=0;p<h.length;p++){for(d=h[p],f=[],g=0;g<d.ranges.length;g++){var C=d.ranges[g],w=C.row,v=C.col,S=C.rowCount,x=C.colCount;(-1===w&&(w=0,S=e.getRowCount()),-1===v&&(v=0,x=e.getColumnCount()),t.ArrayHelper.indexOf(_,C)>-1||!C.contains(o+u,n+c))||(_.push(C),(m=new t.Range(-1,-1,-1,-1)).row=i+u,m.col=a+c,m.rowCount=w+S>=s+o?s-u:o<w?S:w+S-o,m.colCount=v+x>=l+n?l-c:n<v?x:v+x-n,C.containsRange(m)||f.push(m))}d.ranges=d.ranges.concat(f)}y._resetCache()}},e.copyComment=function(e,t,o,n,r,i,a,l,u){var c,h,p,d,f,g,m,_=t,y=o,C=r,w=i,v=a,S=l;for(t<0&&(_=0,v=s(e.getRowCount(),n.getRowCount())),o<0&&(y=0,S=s(e.getColumnCount(),n.getColumnCount())),r<0&&(C=0),i<0&&(w=0),c=[],h=0;h<v;h++)if(!u||!n.isRowFilterOut(C+h))for(p=0;p<S;p++)(m=e.getComment(_+h,y+p))&&((d=m.clone())._sheet=n,d._rowIndex=C+h,d._colIndex=w+p,d._location=d._defaultLocation,c.push(d));for(f=0,g=c.length;f<g;f++)m=c[f],n.setComment(m._rowIndex,m._colIndex,m)},e.copyTag=function(o,n,r,a,l,u,c,h,p){var f,g,m,_,y,C,w,v,S,x,R,b,T,A=!(o===a&&o._name===a._name);if(n<0){var I=r,D=u;if(f=s(o.getRowCount(1),a.getRowCount(1)),g=h,r<0&&(I=0,g=o.getColumnCount()),u<0&&(D=0),A){for(m=0;m<f;m++)for(_=0;_<g;_++)typeof(y=o.getTag(m,I+_,1))===d||y===i?a.setTag(m,D+_,i,1):a.setTag(m,D+_,e.cloneObject(y),1);for(_=0;_<g;_++)typeof(y=o.getTag(-1,I+_))===d||y===i?a.setTag(-1,D+_,i):a.setTag(-1,D+_,e.cloneObject(y))}else{for(C=new t._GcSheetModel(f,g,i),m=0;m<f;m++)for(_=0;_<g;_++)typeof(y=o.getTag(m,I+_,1))!==d&&y!==i&&C.setTag(m,_,e.cloneObject(y));for(m=0;m<f;m++)for(_=0;_<g;_++)a.setTag(m,D+_,C.getTag(m,_),1);for(w={},_=0;_<g;_++)typeof(y=o.getTag(-1,I+_))!==d&&y!==i&&(w[_]=e.cloneObject(y));for(x in w)R=parseInt(x),isNaN(R)||a.setTag(-1,D+R,w[R])}}if(r<0){var F=n,M=l;if(f=c,g=s(o.getColumnCount(2),a.getColumnCount(2)),n<0&&(F=0,f=o.getRowCount()),l<0&&(M=0),A){for(m=0;m<f;m++)for(_=0;_<g;_++)typeof(y=o.getTag(F+m,_,2))===d||y===i?a.setTag(M+m,_,i,2):a.setTag(M+m,_,e.cloneObject(y),2);for(m=0;m<f;m++)typeof(y=o.getTag(F+m,-1))===d||y===i?a.setTag(M+m,-1,i):a.setTag(M+m,-1,e.cloneObject(y))}else{for(v=new t._GcSheetModel(f,g,i),m=0;m<f;m++)for(_=0;_<g;_++)typeof(y=o.getTag(F+m,_,2))!==d&&y!==i&&v.setTag(m,_,e.cloneObject(y));for(m=0;m<f;m++)for(_=0;_<g;_++)a.setTag(M+m,_,v.getTag(m,_),2);for(S={},m=0;m<f;m++)typeof(y=o.getTag(F+m,-1))!==d&&y!==i&&(S[m]=e.cloneObject(y));for(x in S)R=parseInt(x),isNaN(R)||a.setTag(M+R,-1,S[R])}}var E=n,N=r,O=l,P=u,L=c,H=h;if(n<0&&(E=0,L=s(o.getRowCount(),a.getRowCount())),r<0&&(N=0,H=s(o.getColumnCount(),a.getColumnCount())),l<0&&(O=0),u<0&&(P=0),A){for(m=0;m<L;m++)if(!p||!a.isRowFilterOut(O+m))for(_=0;_<H;_++)typeof(y=o.getTag(E+m,N+_))===d||y===i?a.setTag(O+m,P+_,i):a.setTag(O+m,P+_,e.cloneObject(y))}else{for(b=new t._GcSheetModel(L,H,i),m=0;m<L;m++)for(_=0;_<H;_++)typeof(y=o.getTag(E+m,N+_))!==d&&y!==i&&b.setTag(m,_,e.cloneObject(y));for(m=0;m<L;m++)if(!p||!a.isRowFilterOut(O+m))for(_=0;_<H;_++)a.setTag(O+m,P+_,b.getTag(m,_))}if(n<0&&r<0){if(!A)return;T=e.cloneObject(o.tag()),a.tag(T)}},e.copyColumnRangeGroup=function(t,o,n,r,i){var a,l=o,u=r,c=i;l<0&&(l=0,c=s(t.getColumnCount(),n.getColumnCount())),r<0&&(u=0),!(t===n&&t._name===n._name)?t.colRangeGroup&&n.colRangeGroup&&e.crossSheetCopyRangeGroup(t.colRangeGroup,l,n.colRangeGroup,u,c):(a=t.colRangeGroup)&&a._copy(l,u,c)},e.crossSheetCopyRangeGroup=function(e,o,n,r,i){var a,s,l,u;if(o<0&&(o=0),r<0&&(r=0),a=[],e)for(s=t.ArrayHelper.nextNonEmptyIndex(e.items,o-1);s>=0&&s<o+i;)a[s-o]=new t.RangeGroupItemInfo(e.items[s]),s=t.ArrayHelper.nextNonEmptyIndex(e.items,s);if(n&&(t.ArrayHelper.clear(n.items,r,i),a.length>0))for(l in a)a.hasOwnProperty(l)&&(u=a[l],n.items[r+l]=u)},e.copySparkline=function(e,t,o,n,r,i,a,l,u){var c,h=t,p=o,d=r,f=i,g=a,m=l;t<0&&(h=0,g=s(e.getRowCount(),n.getRowCount())),o<0&&(p=0,m=s(e.getColumnCount(),n.getColumnCount())),r<0&&(d=0),i<0&&(f=0),!(e===n&&e._name===n._name)?(c=n._sparklineGroupManager)&&c._exCopy(e,h,p,d,f,g,m,u):(c=e._sparklineGroupManager)&&c._copy(h,p,d,f,g,m,u)},e.copyRowRangeGroup=function(t,o,n,r,i){var a,l=o,u=r,c=i;o<0&&(l=0,c=s(t.getRowCount(),n.getRowCount())),r<0&&(u=0),!(t===n&&t._name===n._name)?t.rowRangeGroup&&n.rowRangeGroup&&e.crossSheetCopyRangeGroup(t.rowRangeGroup,l,n.rowRangeGroup,u,c):(a=t.rowRangeGroup)&&a._copy(l,u,c)},e.copySpan=function(t,o,n,r,i,a,l,u){var c,h,p,d,f=o,g=n,m=i,_=a,y=l,C=u;o<0&&(f=0,y=s(t.getRowCount(),r.getRowCount())),g<0&&(g=0,C=s(t.getColumnCount(),r.getColumnCount())),i<0&&(m=0),a<0&&(_=0),c=!(t===r&&t._name===r._name),o<0&&(c?e.crossSheetCopySpans(t._getSpanModel(1),-1,g,r._getSpanModel(1),-1,_,-1,C):(h=t._getSpanModel(1))&&h.copy(-1,g,-1,_,-1,C)),n<0&&(c?e.crossSheetCopySpans(t._getSpanModel(2),f,-1,r._getSpanModel(2),m,-1,y,-1):(p=t._getSpanModel(2))&&p.copy(f,-1,m,-1,y,-1)),c?e.crossSheetCopySpans(t._getSpanModel(),f,g,r._getSpanModel(),m,_,y,C):(d=t._getSpanModel(3))&&d.copy(f,g,m,_,y,C)},e.crossSheetCopySpans=function(o,n,r,i,a,s,l,u){var c,h,p,d,f,g=e.getSpans(o),m=e.getSpans(i),_=[];if(-1===n){if(g&&g.length>0)for(c=0;c<g.length;c++)(p=g[c]).col>=r&&p.col+p.colCount<=r+u&&_.push(new t.Range(p.row,s+p.col-r,p.rowCount,p.colCount));if(m&&m.length>0)for(c=0;c<m.length;c++)if((p=m[c]).col>=s&&p.col<s+u)for(h=0;h<i.length;h++)if((d=i[h]).row===p.row&&d.col===p.col){i.splice(h,1);break}}else if(-1===r){if(g&&g.length>0)for(c=0;c<g.length;c++)n<=(p=g[c]).row&&p.row+p.rowCount<=n+l&&_.push(new t.Range(a+p.row-n,p.col,p.rowCount,p.colCount));if(m&&m.length>0)for(c=0;c<m.length;c++)if((p=m[c]).row>=a&&p.row<a+l)for(h=0;h<i.length;h++)if((d=i[h]).row===p.row&&d.col===p.col){i.splice(h,1);break}}else{if(g&&g.length>0)for(c=0;c<g.length;c++)n<=(p=g[c]).row&&p.row<n+l&&r<=p.col&&p.col<r+u&&_.push(new t.Range(a+p.row-n,s+p.col-r,p.rowCount,p.colCount));if(m&&m.length>0)for(c=0;c<m.length;c++)if((p=m[c]).row>=a&&p.row<a+l&&p.col>=s&&p.col<s+u)for(h=0;h<i.length;h++)if((d=i[h]).row===p.row&&d.col===p.col){i.splice(h,1);break}}if(_.length>0&&i)for(c=0;c<_.length;c++)f=_[c],i.push(f)},e.getSpans=function(e){return e&&e.length>0?e.slice(0):i},e.copyColumnAxis=function(e,t,o,n,r,l){var u,c,h,p,d,f,g,m=t,_=n,y=r;for(t<0&&(m=0,y=s(e.getColumnCount(),o.getColumnCount())),n<0&&(_=0),1,u=0;u<y;u++)(c=e._getActualColumnWidth(u+m))!==a&&c!==i&&o.setColumnWidth(u+_,c),(h=e.getColumnVisible(u+m))!==a&&h!==i&&o.setColumnVisible(u+_,h),(64&l)>0&&((p=e.getActualStyle(-1,u+m))?o.setStyleWithoutLocked(-1,u+_,p.clone()):o.setStyleWithoutLocked(-1,u+_,i),(p=e.getActualStyle(-1,u+m,1))?o.setStyleWithoutLocked(-1,u+_,p.clone(),1):o.setStyleWithoutLocked(-1,u+_,i,1));for(d=s(e.getRowCount(1),o.getRowCount(1)),f=0;f<d;f++)(g=e._getActualRowHeight(f,1))!==a&&g!==i&&o.setRowHeight(f,g,1)},e.cloneAxisInfo=function(e,t,o){for(var n,r,a,s=[],l=0;l<o;l++)if(n=e[t+l]){for(a in r={},n)n.hasOwnProperty(a)&&(r[a]=n[a]);s.push(r)}else s.push(i);return s},e.getAxisInfo=function(e,t,o){for(var n=[],r=0;r<o;r++)n.push(e[t+r]);return n},e.setAxisInfo=function(e,t,o){if(t)for(var n=0;n<e.length;n++)t[o+n]=e[n]},e.copyRowAxis=function(e,t,o,n,r,l,u){var c,h,p,d,f,g,m,_=t,y=n,C=r;for(t<0&&(_=0,C=s(e.getRowCount(),o.getRowCount())),n<0&&(y=0),2,c=0;c<C;c++)u&&o.isRowFilterOut(c+y)||((h=e._getActualRowHeight(c+_))!==a&&h!==i&&o.setRowHeight(c+y,h),(p=e.getRowVisible(c+_))!==a&&p!==i&&o.setRowVisible(c+y,p),(64&l)>0&&((d=e.getActualStyle(c+_,-1))?o.setStyleWithoutLocked(c+y,-1,d.clone()):o.setStyleWithoutLocked(c+y,-1,i),(d=e.getActualStyle(c+_,-1,2))?o.setStyleWithoutLocked(c+y,-1,d.clone(),2):o.setStyleWithoutLocked(c+y,-1,i,2)));for(f=s(e.getColumnCount(2),o.getColumnCount(2)),g=0;g<f;g++)(m=e._getActualColumnWidth(g,2))!==a&&m!==i&&o.setColumnWidth(g,m,2)},e.copySheetInfo=function(e,t,o){if(e!==t||e._name!==t._name){if((64&o)>0){t.setDefaultStyle(e.getDefaultStyle().clone()),t.setDefaultStyle(e.getDefaultStyle(1).clone(),1),t.setDefaultStyle(e.getDefaultStyle(2).clone(),2)}t.defaults.colWidth=e.defaults.colWidth,t.defaults.rowHeight=e.defaults.rowHeight,t.defaults.rowHeaderColWidth=e.defaults.rowHeaderColWidth}},e.moveTo=function(o,n,r,a,l,u,c,h,p){var d,f,g,m,_,y,C,w=e;t.util.hasCalc()&&t.Calc.CalcOperatorAdjustor;w.checkArguments(o,n,r,a,l,u,c,h),(64&p)>0&&w.moveStyle(o,n,r,a,l,u,c,h),(1&p)>0&&(2&p)>0&&(d=w.saveTable(o,n,r,a,l,u,c,h)),o.suspendCalcService(),a.suspendCalcService(),f=i,(256&p)>0&&(f=w.moveBindingPath(o,n,r,a,l,u,c,h));try{if((1&p)>0&&(w.moveValue(o,n,r,a,l,u,c,h),0==(2&p)&&w.clearFormula(a,l,u,c,h),(256&p)>0)){var v=f.length,S=l<0?0:l,x=u<0?0:u;for(g=0;g<v;g++)m=f[g],a.setValue(S+m.row,x+m.col,m.value)}w.adjustCustomNameOnMove(o,n,r,a,l,u,c,h),(2&p)>0&&w.moveFormula(o,n,r,a,l,u,c,h)}finally{(1&p)>0&&(2&p)>0&&w.restoreTableForMoveTo(d,o,n,r,a,l,u,c,h),o.resumeCalcService(!1),a.resumeCalcService(!1)}if((512&p)>0&&w.moveConditionalFormatRules(o,n,r,a,l,u,c,h),(4&p)>0&&w.moveComment(o,n,r,a,l,u,c,h),(128&p)>0&&w.moveTag(o,n,r,a,l,u,c,h),(16&p)>0&&w.moveSparkline(o,n,r,a,l,u,c,h),(8&p)>0&&(n<0&&w.moveColumnRangeGroup(o,r,a,u,h),r<0&&w.moveRowRangeGroup(o,n,a,l,c)),(32&p)>0&&w.moveSpan(o,n,r,a,l,u,c,h),n<0&&w.moveColumnAxis(o,r,a,u,h,p),r<0&&w.moveRowAxis(o,n,a,l,c,p),n<0&&l<0&&r<0&&u<0&&w.moveSheetInfo(o,a,p),n<0)for(_=r,y=h,r<0&&(_=0,y=s(o.getColumnCount(),a.getColumnCount())),C=0;C<y;C++)o.isColumnBound(_+C)&&o._sheetModelManager.getColInfos().reset(_+C)},e.moveFormula=function(e,o,n,r,l,u,c,h){var p,d,f,g,m,_,y,C=e._getCalcModel(),w=r._getCalcModel();if(C&&w){var v=C.getCalcService().getOperatorAdjustor(),S=o,x=n,R=l,b=u,T=c,A=h;for(o<0&&(S=0,T=s(e.getRowCount(),r.getRowCount())),n<0&&(x=0,A=s(e.getColumnCount(),r.getColumnCount())),l<0&&(R=0),u<0&&(b=0),p=!(e===r&&e._name===r._name),C.unlinkCellExpression(S,x,T,A),v._addDependentsToAdjust(C,S,x,T,A),w.unlinkCellExpression(R,b,T,A),v._addDependentsToAdjust(w,R,b,T,A),d=[],f=0;f<T;f++)for(g=0;g<A;g++){var I=C._getExpr(f+S,g+x),D=C.getArrayInfo(f+S,g+x),F=C._getWorkingExpr(f+S,g+x);I?(d.push({expr:I,arrayInfo:D,workingExpr:F}),C._clearAllExpr(f+S,g+x)):d.push(i)}for(m=r.getCalcService(),f=0;f<T;f++)for(g=0;g<A;g++)(y=d.shift())?(I=y.expr,D=y.arrayInfo,m&&D&&D.row===S+f&&D.col===x+g&&(_=new t.Range(f+R,g+b,D.rowCount,D.colCount)),D&&(D.row=f+R,D.col=g+b),w._setExpr(f+R,g+b,I),w._setArrayInfo(f+R,g+b,D?_:a),w._setWorkingExpr(f+R,g+b,y.workingExpr)):(w._setExpr(f+R,g+b,a),w._setArrayInfo(f+R,g+b,a));v._addCellsToAdjust(C,S,x,T,A),v._addCellsToAdjust(w,R,b,T,A),v.adjustFormulasOnMoveSwap(C.getSource(),S,x,w.getSource(),R,b,T,A,!0),!0===p&&v.adjustFormulasOnMoveSwap(C.getSource(),S,x,w.getSource(),R,b,T,A,!0)}},e.moveValue=function(e,o,n,r,a,l,u,c){var h,p,f,g,m,_,y,C,w,v,S=!(e===r&&e._name===r._name);if(o<0){var x=n,R=l;if(h=s(e.getRowCount(1),r.getRowCount(1)),p=c,n<0&&(x=0,p=e.getColumnCount()),l<0&&(R=0),S)for(f=0;f<h;f++)for(g=0;g<p;g++)(typeof(m=e._sheetModelManager.getDataModel(1).getValue(f,x+g))===d||m===i)&&e.isColumnBound(x+g)&&(f===e.colHeaderAutoTextIndex||f===h-1&&-1===e.colHeaderAutoTextIndex)&&(m=e.getDataColumnName(x+g)),typeof m===d||m===i?r._setValueInternal(f,R+g,i,1,!1):(r._setValueInternal(f,R+g,m,1,!1),e._setValueInternal(f,x+g,i,1,!1));else{for(_=new t._GcSheetModel(h,p,i),f=0;f<h;f++)for(g=0;g<p;g++)(typeof(m=e._sheetModelManager.getDataModel(1).getValue(f,x+g))===d||m===i)&&e.isColumnBound(x+g)&&(f===e.colHeaderAutoTextIndex||f===h-1&&-1===e.colHeaderAutoTextIndex)&&(m=e.getDataColumnName(x+g)),typeof m!==d&&m!==i&&_.setValue(f,g,m),e._setValueInternal(f,x+g,i,1,!1);for(f=0;f<h;f++)for(g=0;g<p;g++)r._setValueInternal(f,R+g,_.getValue(f,g),1,!1)}}if(2,n<0)if(y=o,C=a,h=u,p=s(e.getColumnCount(2),r.getColumnCount(2)),o<0&&(y=0,h=e.getRowCount()),a<0&&(C=0),S)for(f=0;f<h;f++)for(g=0;g<p;g++)typeof(m=e.getValue(y+f,g,2))===d||m===i?r._setValueInternal(C+f,g,i,2,!1):(r._setValueInternal(C+f,g,m,2,!1),e._setValueInternal(y+f,g,i,2,!1));else{for(w=new t._GcSheetModel(h,p,i),f=0;f<h;f++)for(g=0;g<p;g++)typeof(m=e._getModel(2).getValue(y+f,g))!==d&&m!==i&&w.setValue(f,g,m),e._setValueInternal(y+f,g,i,2,!1);for(f=0;f<h;f++)for(g=0;g<p;g++)r._setValueInternal(C+f,g,w.getValue(f,g),2,!1)}var b=o,T=n,A=a,I=l,D=u,F=c;if(o<0&&(b=0,D=s(e.getRowCount(),r.getRowCount())),n<0&&(T=0,F=s(e.getColumnCount(),r.getColumnCount())),a<0&&(A=0),l<0&&(I=0),S)for(f=0;f<D;f++)for(g=0;g<F;g++)typeof(m=e.getValue(b+f,T+g))===d||m===i?r._setValueInternal(A+f,I+g,i,3,!1):(r._setValueInternal(A+f,I+g,m,3,!1),e._setValueInternal(b+f,T+g,i,3,!1));else{for(v=new t._GcSheetModel(D,F,i),f=0;f<D;f++)for(g=0;g<F;g++)typeof(m=e.getValue(b+f,T+g))!==d&&m!==i&&v.setValue(f,g,m);for(f=0;f<D;f++)for(g=0;g<F;g++)e._setValueInternal(b+f,T+g,i,3,!1);for(f=0;f<D;f++)for(g=0;g<F;g++)r._setValueInternal(A+f,I+g,v.getValue(f,g),3,!1)}},e.adjustCustomNameOnMove=function(t,o,n,r,i,a,s,l){var u,c,h,p,d,f,g,m=e;if(t.parent&&t.parent.sheets){if(c=t.parent.sheets,(h=t.parent.getCustomNames())&&h.length>0)for(g=0;g<h.length;g++)p=h[g].getExpression(),(d=m.adjustCustomNameExpOnMove(null,t,o,n,r,i,a,s,l,p))!==p&&h[g].setExpression(d);for(f=0;f<c.length;f++)if((u=c[f].getCustomNames())&&u.length>0)for(g=0;g<u.length;g++)p=u[g].getExpression(),(d=m.adjustCustomNameExpOnMove(c[f],t,o,n,r,i,a,s,l,p))!==p&&u[g].setExpression(d)}else if((u=t.getCustomNames())&&u.length>0)for(g=0;g<u.length;g++)p=u[g].getExpression(),(d=m.adjustCustomNameExpOnMove(t,t,o,n,r,i,a,s,l,p))!==p&&u[g].setExpression(d)},e.adjustCustomNameExpOnMove=function(o,n,r,i,a,s,l,u,c,h){var p,d,f,g,m=e,_=s-r,y=l-i,C=n._getSheetSource(),w=a._getSheetSource();if(10===h.t){var v=h,S=v.left,x=v.right,R=m.adjustCustomNameExpOnMove(o,n,r,i,a,s,l,u,c,S),b=m.adjustCustomNameExpOnMove(o,n,r,i,a,s,l,u,c,x);if(S!==R||x!==b)return new t.Calc.Expressions.BinaryOperatorExpression(v.operator,R,b)}else if(11===h.t){var T=h,A=T.operand,I=m.adjustCustomNameExpOnMove(o,n,r,i,a,s,l,u,c,A);if(A!==I)return new t.Calc.Expressions.UnaryOperatorExpression(T.operator,I)}else if(7===h.t){var D,F=h,M=!1,E=[];for(p=0;p<F.args.length;p++)D=F.args[p],d=m.adjustCustomNameExpOnMove(o,n,r,i,a,s,l,u,c,D),M=M||D!==d,E.push(d);if(M)return new t.Calc.Expressions.FunctionExpression(F.fn,E)}else if(1===h.t){if((f=h).source===C&&!f.rowRelative&&f.row>=r&&f.row<r+u&&!f.columnRelative&&f.column>=i&&f.column<i+c)return new t.Calc.Expressions.ExternalCellExpression(w,f.row+_,f.column+y)}else if(22!==h.t)if(0===h.t){if(g=h,o===n&&!g.rowRelative&&g.row>=r&&g.row<r+u&&!g.columnRelative&&g.column>=i&&g.column<i+c)return new t.Calc.Expressions.ExternalCellExpression(w,g.row+_,g.column+y)}else if(3===h.t){var N=h,O=!N.startRowRelative&&!N.startColumnRelative,P=!N.endRowRelative&&!N.endColumnRelative;if(N.source===C&&(O&&N.startRow>=r&&N.startColumn>=i||P&&N.endColumn<i+c&&N.endRow<r+u))return new t.Calc.Expressions.ExternalRangeExpression(w,N.startRow+(O?_:0),N.startColumn+(O?y:0),N.endRow+(P?_:0),N.endColumn+(P?y:0),N.startRowRelative,N.startColumnRelative,N.endRowRelative,N.endColumnRelative)}else if(23!==h.t)if(2===h.t){var L=h;O=!L.startRowRelative&&!L.startColumnRelative,P=!L.endRowRelative&&!L.endColumnRelative;if(o===n&&(O&&L.startRow>=r&&L.startColumn>=i||P&&L.endColumn<i+c&&L.endRow<r+u))return new t.Calc.Expressions.ExternalRangeExpression(w,L.startRow+(O?_:0),L.startColumn+(O?y:0),L.endRow+(P?_:0),L.endColumn+(P?y:0),L.startRowRelative,L.startColumnRelative,L.endRowRelative,L.endColumnRelative)}else if(14===h.t){var H=h.argument,k=m.adjustCustomNameExpOnMove(o,n,r,i,a,s,l,u,c,H);if(H!==k)return new t.Calc.Expressions.ParenthesesExpression(k)}return h},e.adjustCustomNameOnInsertRemove=function(t,o,n,r,i){var a,s,l,u,c,h,p,d=e;if(t.parent&&t.parent.sheets){if(s=t.parent.sheets,(l=t.parent.getCustomNames())&&l.length>0)for(p=0;p<l.length;p++)u=l[p].getExpression(),(c=d.adjustCustomNameExpOnInsertRemove(null,t,o,n,r,i,u))!==u&&l[p].setExpression(c);for(h=0;h<s.length;h++)if((a=s[h].getCustomNames())&&a.length>0)for(p=0;p<a.length;p++)u=a[p].getExpression(),(c=d.adjustCustomNameExpOnInsertRemove(s[h],t,o,n,r,i,u))!==u&&a[p].setExpression(c)}else if((a=t.getCustomNames())&&a.length>0)for(p=0;p<a.length;p++)u=a[p].getExpression(),(c=d.adjustCustomNameExpOnInsertRemove(t,t,o,n,r,i,u))!==u&&a[p].setExpression(c)},e.adjustCustomNameExpOnInsertRemove=function(o,n,r,i,a,s,l){var u,c,h,p=e,d=n._getSheetSource(),f=new t.Calc.Expressions.ExternalErrorExpression(d,t.Calc.Errors.Reference);if(10===l.t){var g=l,m=g.left,_=g.right,y=p.adjustCustomNameExpOnInsertRemove(o,n,r,i,a,s,m),C=p.adjustCustomNameExpOnInsertRemove(o,n,r,i,a,s,_);if(m!==y||_!==C)return new t.Calc.Expressions.BinaryOperatorExpression(g.operator,y,C)}else if(11===l.t){var w=l,v=w.operand,S=p.adjustCustomNameExpOnInsertRemove(o,n,r,i,a,s,v);if(v!==S)return new t.Calc.Expressions.UnaryOperatorExpression(w.operator,S)}else if(7===l.t){var x,R=l,b=!1,T=[];for(u=0;u<R.args.length;u++)x=R.args[u],c=p.adjustCustomNameExpOnInsertRemove(o,n,r,i,a,s,x),b=b||x!==c,T.push(c);if(b)return new t.Calc.Expressions.FunctionExpression(R.fn,T)}else if(22!==l.t)if(1===l.t||0===l.t){if(h=l,(I=l.source||o&&o._getSheetSource())&&I===d&&(s&&!h.rowRelative||!s&&!h.columnRelative))if(s&&a){if(h.row>=r)return new t.Calc.Expressions.ExternalCellExpression(d,h.row+i,h.column,h.rowRelative,h.columnRelative)}else if(!s&&a){if(h.column>=r)return new t.Calc.Expressions.ExternalCellExpression(d,h.row,h.column+i,h.rowRelative,h.columnRelative)}else if(s&&!a){if(h.row>=r+i)return new t.Calc.Expressions.ExternalCellExpression(d,h.row-i,h.column,h.rowRelative,h.columnRelative);if(h.row>=r)return f}else{if(h.column>=r+i)return new t.Calc.Expressions.ExternalCellExpression(d,h.row,h.column-i,h.rowRelative,h.columnRelative);if(h.column>=r)return f}}else if(23!==l.t)if(3===l.t||2===l.t){var A=l,I=l.source||o&&o._getSheetSource(),D=A.startRow,F=A.startColumn,M=A.endRow,E=A.endColumn;if(I&&I===d)if(s&&a){if(!A.startRowRelative&&D>=r&&(D+=i),!A.endRowRelative&&M>=r&&(M+=i),D!==A.startRow||M!==A.endRow)return new t.Calc.Expressions.ExternalRangeExpression(d,D,F,M,E,A.startRowRelative,A.startColumnRelative,A.endRowRelative,A.endColumnRelative)}else if(!s&&a){if(!A.startColumnRelative&&F>=r&&(F+=i),!A.endColumnRelative&&E>=r&&(E+=i),F!==A.startColumn||E!==A.endColumn)return new t.Calc.Expressions.ExternalRangeExpression(d,D,F,M,E,A.startRowRelative,A.startColumnRelative,A.endRowRelative,A.endColumnRelative)}else if(s&&!a){if(!A.startRowRelative&&D>=r&&!A.endRowRelative&&M<r+i)return f;if(A.startRowRelative&&A.endRowRelative||M<r)return l;if(!A.startRowRelative)if(D>=r+i)D-=i;else if(!(D<r)){if(A.endRowRelative)return f;D>r&&(D=r)}if(!A.endRowRelative)if(M>=r+i)M-=i;else{if(A.startRowRelative)return f;M<r+i&&(M=r-1)}if(D!==A.startRow||M!==A.endRow)return new t.Calc.Expressions.ExternalRangeExpression(d,D,F,M,E,A.startRowRelative,A.startColumnRelative,A.endRowRelative,A.endColumnRelative)}else{if(!A.startColumnRelative&&F>=r&&!A.endColumnRelative&&E<r+i)return f;if(A.startColumnRelative&&A.endColumnRelative||E<r)return l;if(!A.startColumnRelative)if(F>=r+i)F-=i;else if(!(F<r)){if(A.endColumnRelative)return f;F>r&&(F=r)}if(!A.endColumnRelative)if(E>=r+i)E-=i;else{if(A.startColumnRelative)return f;E<r+i&&(E=r-1)}if(F!==A.startColumn||E!==A.endColumn)return new t.Calc.Expressions.ExternalRangeExpression(d,D,F,M,E,A.startRowRelative,A.startColumnRelative,A.endRowRelative,A.endColumnRelative)}}else if(14===l.t){var N=l.argument,O=p.adjustCustomNameExpOnInsertRemove(o,n,r,i,a,s,N);if(N!==O)return new t.Calc.Expressions.ParenthesesExpression(O)}return l},e.moveStyle=function(e,o,n,r,a,l,u,c){var h,p,d,f,g,m,_,y,C,w,v,S,x=!(e===r&&e._name===r._name);if(o<0)if(m=n,_=l,h=s(e.getRowCount(1),r.getRowCount(1)),p=c,n<0&&(m=0,p=e.getColumnCount()),l<0&&(_=0),x)for(d=0;d<h;d++)for(f=0;f<p;f++)(g=e.getCompositeStyle(d,m+f,1))?(r.setStyleWithoutLocked(d,_+f,g.clone(),1),e.setStyleWithoutLocked(d,m+f,i,1)):r.setStyleWithoutLocked(d,_+f,i,1);else{for(y=new t._GcSheetModel(h,p,i),d=0;d<h;d++)for(f=0;f<p;f++)(g=e.getCompositeStyle(d,m+f,1))&&y.setValue(d,f,g.clone()),e.setStyleWithoutLocked(d,m+f,i,1);for(d=0;d<h;d++)for(f=0;f<p;f++)r.setStyleWithoutLocked(d,_+f,y.getValue(d,f),1)}if(2,n<0)if(C=o,w=a,h=u,p=s(e.getColumnCount(2),r.getColumnCount(2)),o<0&&(C=0,h=e.getRowCount()),a<0&&(w=0),x)for(d=0;d<h;d++)for(f=0;f<p;f++)(g=e.getCompositeStyle(C+d,f,2))?(r.setStyleWithoutLocked(w+d,f,g.clone(),2),e.setStyleWithoutLocked(C+d,f,i,2)):r.setStyleWithoutLocked(w+d,f,i,2);else{for(v=new t._GcSheetModel(h,p,i),d=0;d<h;d++)for(f=0;f<p;f++)(g=e.getCompositeStyle(C+d,f,2))&&v.setValue(d,f,g.clone()),e.setStyleWithoutLocked(C+d,f,i,2);for(d=0;d<h;d++)for(f=0;f<p;f++)r.setStyleWithoutLocked(w+d,f,v.getValue(d,f),2)}var R=o,b=n,T=a,A=l,I=u,D=c;if(o<0&&(R=0,I=s(e.getRowCount(),r.getRowCount())),n<0&&(b=0,D=s(e.getColumnCount(),r.getColumnCount())),a<0&&(T=0),l<0&&(A=0),x)for(d=0;d<I;d++)for(f=0;f<D;f++)(g=e.getCompositeStyle(R+d,b+f))?(r.setStyleWithoutLocked(T+d,A+f,g.clone()),e.setStyleWithoutLocked(R+d,b+f,i)):r.setStyleWithoutLocked(T+d,A+f,i);else{for(S=new t._GcSheetModel(I,D,i),d=0;d<I;d++)for(f=0;f<D;f++)(g=e.getCompositeStyle(R+d,b+f))&&S.setValue(d,f,g.clone()),e.setStyleWithoutLocked(R+d,b+f,i);for(d=0;d<I;d++)for(f=0;f<D;f++)r.setStyleWithoutLocked(T+d,A+f,S.getValue(d,f))}},e.moveTag=function(e,o,n,r,a,l,u,c){var h,p,f,g,m,_,y,C,w,v,S,x,R,b=!(e===r&&e._name===r._name);if(o<0){var T=n,A=l;if(h=s(e.getRowCount(1),r.getRowCount(1)),p=c,n<0&&(T=0,p=e.getColumnCount()),l<0&&(A=0),b){for(f=0;f<h;f++)for(g=0;g<p;g++)typeof(m=e.getTag(f,T+g,1))===d||m===i?r.setTag(f,A+g,i,1):(r.setTag(f,A+g,m,1),e.setTag(f,T+g,i,1));for(g=0;g<p;g++)typeof(m=e.getTag(-1,T+g))===d||m===i?r.setTag(-1,A+g,i):(r.setTag(-1,A+g,m),e.setTag(-1,T+g,i))}else{for(_=new t._GcSheetModel(h,p,i),f=0;f<h;f++)for(g=0;g<p;g++)typeof(m=e.getTag(f,T+g,1))!==d&&m!==i&&_.setTag(f,g,m),e.setTag(f,T+g,i,1);for(f=0;f<h;f++)for(g=0;g<p;g++)r.setTag(f,A+g,_.getTag(f,g),1);for(y={},g=0;g<p;g++)typeof(m=e.getTag(-1,T+g))!==d&&m!==i&&(y[g]=m),e.setTag(-1,T+g,i);for(v in y)S=parseInt(v),isNaN(S)||r.setTag(-1,A+S,y[S])}}if(n<0){var I=o,D=a;if(h=u,p=s(e.getColumnCount(2),r.getColumnCount(2)),o<0&&(I=0,h=e.getRowCount()),a<0&&(D=0),b){for(f=0;f<h;f++)for(g=0;g<p;g++)typeof(m=e.getTag(I+f,g,2))===d||m===i?r.setTag(D+f,g,i,2):(r.setTag(D+f,g,m,2),e.setTag(I+f,g,i,2));for(f=0;f<h;f++)typeof(m=e.getTag(I+f,-1))===d||m===i?r.setTag(D+f,-1,i):(r.setTag(D+f,-1,m),e.setTag(I+f,-1,i))}else{for(C=new t._GcSheetModel(h,p,i),f=0;f<h;f++)for(g=0;g<p;g++)typeof(m=e.getTag(I+f,g,2))!==d&&m!==i&&C.setTag(f,g,m),e.setTag(I+f,g,i,2);for(f=0;f<h;f++)for(g=0;g<p;g++)r.setTag(D+f,g,C.getTag(f,g),2);for(w={},f=0;f<h;f++)typeof(m=e.getTag(I+f,-1))!==d&&m!==i&&(w[f]=m),e.setTag(I+f,-1,i);for(v in w)S=parseInt(v),isNaN(S)||r.setTag(D+S,-1,w[S])}}var F=o,M=n,E=a,N=l,O=u,P=c;if(o<0&&(F=0,O=s(e.getRowCount(),r.getRowCount())),n<0&&(M=0,P=s(e.getColumnCount(),r.getColumnCount())),a<0&&(E=0),l<0&&(N=0),b)for(f=0;f<O;f++)for(g=0;g<P;g++)typeof(m=e.getTag(F+f,M+g))===d||m===i?r.setTag(E+f,N+g,i):(r.setTag(E+f,N+g,m),e.setTag(F+f,M+g,i));else{for(x=new t._GcSheetModel(O,P,i),f=0;f<O;f++)for(g=0;g<P;g++)typeof(m=e.getTag(F+f,M+g))!==d&&m!==i&&x.setTag(f,g,m),e.setTag(F+f,M+g,i);for(f=0;f<O;f++)for(g=0;g<P;g++)r.setTag(E+f,N+g,x.getTag(f,g))}if(o<0&&n<0){if(!b)return;R=e.tag(),e.tag(i),r.tag(R)}},e.moveConditionalFormatRules=function(e,t,o,n,r,i,a,s){this.copyConditionalFormatRules(e,t,o,n,r,i,a,s),this._deleteConditionalFormatRange(e,t,o,n,r,i,a,s)},e._deleteConditionalFormatRange=function(e,o,n,r,i,a,u,c){var h,p,d,f,g,m,_,y,C,w,v,S,x=[],R=e._conditionalFormats;if(R){for(h=0;h<u;h++)for(p=0;p<c;p++)for(d=R.getRules(o+h,n+p),f=0;f<d.length;f++){for(g=d[f],m=[],_=0;_<g.ranges.length;_++){var b=g.ranges[_],T=b.row,A=b.col,I=b.rowCount,D=b.colCount;(-1===T&&(T=0,I=e.getRowCount()),-1===A&&(A=0,D=e.getColumnCount()),t.ArrayHelper.indexOf(x,b)>-1||!b.contains(o+h,n+p))||(x.push(b),o>T&&((y=new t.Range(-1,-1,-1,-1)).row=T,y.col=A,y.rowCount=o-T,y.colCount=D,m.push(y)),n>A&&((C=new t.Range(-1,-1,-1,-1)).row=l(o,T),C.col=A,C.rowCount=s(o+u,T+I)-C.row,C.colCount=n-A,m.push(C)),n+c<A+D&&((w=new t.Range(-1,-1,-1,-1)).row=l(o,T),w.col=n+c,w.rowCount=s(o+u,T+I)-w.row,w.colCount=A+D-(n+c),m.push(w)),o+u<T+I&&((v=new t.Range(-1,-1,-1,-1)).row=o+u,v.col=A,v.rowCount=T+I-(o+u),v.colCount=D,m.push(v)))}for(S=0;S<x.length;S++)t.ArrayHelper.remove(g.ranges,x[S]);g.ranges=g.ranges.concat(m)}R._resetCache()}},e.moveComment=function(e,t,o,n,r,a,l,u){var c,h,p,d,f,g,m,_=t,y=o,C=r,w=a,v=l,S=u;for(t<0&&(_=0,v=s(e.getRowCount(),n.getRowCount())),o<0&&(y=0,S=s(e.getColumnCount(),n.getColumnCount())),r<0&&(C=0),a<0&&(w=0),c=[],h=0;h<v;h++)for(p=0;p<S;p++)(m=e.getComment(_+h,y+p))&&((d=m.clone())._sheet=n,d._rowIndex=C+h,d._colIndex=w+p,c.push(d),e.setComment(_+h,y+p,i));for(f=0,g=c.length;f<g;f++)m=c[f],n.setComment(m._rowIndex,m._colIndex,m)},e.moveSparkline=function(e,t,o,n,r,i,a,l){var u,c=t,h=o,p=r,d=i,f=a,g=l;t<0&&(c=0,f=s(e.getRowCount(),n.getRowCount())),o<0&&(h=0,g=s(e.getColumnCount(),n.getColumnCount())),r<0&&(p=0),i<0&&(d=0),!(e===n&&e._name===n._name)?(u=n._sparklineGroupManager)&&u._exMove(e,c,h,p,d,f,g):(u=e._sparklineGroupManager)&&u._move(c,h,p,d,f,g)},e.moveColumnRangeGroup=function(o,n,r,i,a){var l,u=n,c=i,h=a;u<0&&(u=0,h=s(o.getColumnCount(),r.getColumnCount())),i<0&&(c=0),!(o===r&&o._name===r._name)?o.colRangeGroup&&r.colRangeGroup&&(e.crossSheetCopyRangeGroup(o.colRangeGroup,u,r.colRangeGroup,c,h),t.ArrayHelper.clear(o.colRangeGroup.items,u,h)):(l=o.colRangeGroup)&&l._move(u,c,h)},e.moveRowRangeGroup=function(o,n,r,i,a){var l,u=n,c=i,h=a;n<0&&(u=0,h=s(o.getRowCount(),r.getRowCount())),i<0&&(c=0),!(o===r&&o._name===r._name)?o.rowRangeGroup&&r.rowRangeGroup&&(e.crossSheetCopyRangeGroup(o.rowRangeGroup,u,r.rowRangeGroup,c,h),t.ArrayHelper.clear(o.rowRangeGroup.items,u,h)):(l=o.rowRangeGroup)&&l._move(u,c,h)},e.moveSpan=function(t,o,n,r,i,a,l,u){var c,h,p,d,f=o,g=n,m=i,_=a,y=l,C=u;o<0&&(f=0,y=s(t.getRowCount(),r.getRowCount())),g<0&&(g=0,C=s(t.getColumnCount(),r.getColumnCount())),i<0&&(m=0),a<0&&(_=0),c=!(t===r&&t._name===r._name),o<0&&(c?(e.crossSheetCopySpans(t._getSpanModel(1),-1,g,r._getSpanModel(1),-1,_,-1,C),t._getSpanModel(1)&&t._getSpanModel(1).clear(-1,g,-1,C)):(h=t._getSpanModel(1))&&h.move(-1,g,-1,_,-1,C)),n<0&&(c?(e.crossSheetCopySpans(t._getSpanModel(2),f,-1,r._getSpanModel(2),m,-1,y,-1),t._getSpanModel(2)&&t._getSpanModel(2).clear(f,-1,y,-1)):(p=t._getSpanModel(2))&&p.move(f,-1,m,-1,y,-1)),c?(e.crossSheetCopySpans(t._getSpanModel(),f,g,r._getSpanModel(),m,_,y,C),t._getSpanModel()&&t._getSpanModel().clear(f,g,y,C)):(d=t._getSpanModel())&&d.move(f,g,m,_,y,C)},e.moveColumnAxis=function(e,t,o,n,r,l){var u,c,h,p,d,f,g,m=t,_=n,y=r;for(t<0&&(m=0,y=s(e.getColumnCount(),o.getColumnCount())),n<0&&(_=0),1,u=0;u<y;u++)(c=e._getActualColumnWidth(u+m))!==a&&c!==i&&(e.setColumnWidth(u+m,e.defaults.colWidth),o.setColumnWidth(u+_,c)),(h=e.getColumnVisible(u+m))!==a&&h!==i&&(e.setColumnVisible(u+m,!0),o.setColumnVisible(u+_,h)),(64&l)>0&&((p=e.getActualStyle(-1,u+m))?(o.setStyleWithoutLocked(-1,u+_,p.clone()),e.setStyleWithoutLocked(-1,u+m,i)):o.setStyleWithoutLocked(-1,u+_,i),(p=e.getActualStyle(-1,u+m,1))?(o.setStyleWithoutLocked(-1,u+_,p.clone(),1),e.setStyleWithoutLocked(-1,u+m,i,1)):o.setStyleWithoutLocked(-1,u+_,i,1));for(d=s(e.getRowCount(1),o.getRowCount(1)),f=0;f<d;f++)(g=e._getActualRowHeight(f,1))!==a&&g!==i&&(e.setRowHeight(f,e.defaults.colHeaderRowHeight,1),o.setRowHeight(f,g,1))},e.moveRowAxis=function(e,t,o,n,r,l){var u,c,h,p,d,f,g,m=t,_=n,y=r;for(t<0&&(m=0,y=s(e.getRowCount(),o.getRowCount())),n<0&&(_=0),2,u=0;u<y;u++)(c=e._getActualRowHeight(u+m))!==a&&c!==i&&(e.setRowHeight(u+m,e.defaults.rowHeight),o.setRowHeight(u+_,c)),(h=e.getRowVisible(u+m))!==a&&h!==i&&(e.setRowVisible(u+m,!0),o.setRowVisible(u+_,h)),(64&l)>0&&((p=e.getActualStyle(u+m,-1))?(o.setStyleWithoutLocked(u+_,-1,p.clone()),e.setStyleWithoutLocked(u+m,-1,i)):o.setStyleWithoutLocked(u+_,-1,i),(p=e.getActualStyle(u+m,-1,2))?(o.setStyleWithoutLocked(u+_,-1,p.clone(),2),e.setStyleWithoutLocked(u+m,-1,i,2)):o.setStyleWithoutLocked(u+_,-1,i,2));for(d=s(e.getColumnCount(2),o.getColumnCount(2)),f=0;f<d;f++)(g=e._getActualColumnWidth(f,2))!==a&&g!==i&&(e.setColumnWidth(f,e.defaults.rowHeaderColWidth,2),o.setColumnWidth(f,g,2))},e.moveSheetInfo=function(e,t,o){if(e!==t||e._name!==t._name){if((64&o)>0){t.setDefaultStyle(e.getDefaultStyle()),t.setDefaultStyle(e.getDefaultStyle(1),1),t.setDefaultStyle(e.getDefaultStyle(2),2),e.setDefaultStyle(i),e.setDefaultStyle(i,1),e.setDefaultStyle(i,2)}t.defaults.colWidth=e.defaults.colWidth,t.defaults.rowHeight=e.defaults.rowHeight,t.defaults.rowHeaderColWidth=e.defaults.rowHeaderColWidth,e.defaults.colWidth=62,e.defaults.rowHeight=20,e.defaults.rowHeaderColWidth=40}},e.moveBindingPath=function(t,o,n,r,i,a,s,l){return e._copyMoveBindingPath(t,o,n,r,i,a,s,l,!0)},e.setRangeText=function(n,r,s,l,u,c,h,p){if(!n)throw new Error(t.SR.Exp_SheetIsNull);if((r<-1||r>=n.getRowCount())&&o("row",r,"-1",n.getRowCount()-1),(s<-1||s>=n.getColumnCount())&&o("column",s,"-1",n.getColumnCount()-1),l!==a&&l!==i&&""!==l){-1===r&&(r=0),-1===s&&(s=0);var d=e.parseText(l,u,c,h);d&&d.length>0&&e.setSheetData(n,r,s,d,p)}},e.getRangeText=function(e,n,r,s,l,u,c,h,p,d){var f,g,m,_,y,C,w,v;if(!e)throw new Error(t.SR.Exp_SheetIsNull);for((n<-1||n>=e.getRowCount())&&o("row",n,"-1",e.getRowCount()-1),(r<-1||n+r>e.getRowCount())&&o("rowCount",n,"-1",e.getRowCount()-n),(s<-1||s>=e.getColumnCount())&&o("column",s,"-1",e.getColumnCount()-1),(l<-1||s+l>e.getColumnCount())&&o("columnCount",s,"-1",e.getColumnCount()-s),f=-1,g=-1,-1===n&&-1===s&&-1===r&&-1===l?(n=0,s=0,f=e.getRowCount()-1,g=e.getColumnCount()-1):(-1===n&&(n=0),-1===s&&(s=0),-1===r&&(r=e.getRowCount()-n),-1===l&&(l=e.getColumnCount()-s),f=n+r-1,g=s+l-1),(u===a||u===i||""===u)&&(u="\r\n"),(c===a||c===i||""===c)&&(c="\t"),(h===a||h===i||""===h)&&(h='"'),m="",_=n;_<=f;_++){for(y=!0,C=s;C<=g;C++)y||(m+=c),y=!1,w="",(v=e.getText(_,C))!==a&&v!==i&&(w=(w=v).replace(new RegExp(h,"g"),h+h)),m+=p||-1!==w.indexOf(h)||-1!==w.indexOf(c)||-1!==w.indexOf(u)||-1!==w.indexOf("\n")?h+w+h:w;m+=u}return m.toString()},e.parseText=function(e,o,n,r){var s,l,u,c;if(e===a||e===i||""===e)return i;(o===a||o===i||""===o)&&(o="\r\n"),(n===a||n===i||""===n)&&(n="\t"),(r===a||r===i||""===r)&&(r='"'),t.StringHelper.EndsWith(e,o)||(e+=o);var h=[],p=[],d="",f=!1,g=r.length,m=o.length,_="\n".length,y=n.length;for(s=0;s<e.length;s++)(d+=e[s]).length>=g&&r===d.substr(d.length-g,g)?f&&e.length>=s+1+g&&r===e.substr(s+1,g)?s+=g:f?(d=d.substr(0,d.length-g),f=!1):0===d.indexOf(r)&&(d=d.substr(0,d.length-g),f=!0):!f&&d.length>=y&&n===d.substr(d.length-y,y)?(d=d.substr(0,d.length-y),p.push(d.toString()),d=""):!f&&d.length>=m&&o===d.substr(d.length-m,m)?(d=d.substr(0,d.length-m),p.push(d.toString()),h.push(p),p=[],d=""):!f&&d.length>=_&&"\n"===d.substr(d.length-_,_)?(d=d.substr(0,d.length-_),p.push(d.toString()),h.push(p),p=[],d=""):f&&e.length>=s+1+y&&n===e.substr(s+1,y)&&","!=n&&(s+=g);if(f){if(p.length>0){for(l=0;l<h.length&&h[l]!==p;l++);l>=h.length&&h.push(p)}(u=d.toString())&&(u=u.replace(new RegExp(n,"g"),""),t.StringHelper.EndsWith(u,o)&&(u=u.substr(0,u.length-m)),0==h.length&&h.push([u]))}return 0==h.length&&e&&(c=e,t.StringHelper.EndsWith(e,o)&&(c=c.substr(0,c.length-m)),h.push([c])),h},e.setSheetData=function(t,o,n,i,a){var s,l,u,c,h=i.length,p=e.getMaxLength(i);if(0!==h&&0!==p){(s=new r(a)).fixOptions(t);var d=s.rowHeader?t.getColumnCount(2):0,f=s.columnHeader?t.getRowCount(1):0,g=0;for((p-=d)<=0&&(p=0),(h-=f)<=0&&(g=0),(h-=g)<=0&&(h=0),s.expandRows&&o+h>t.getRowCount()&&t.setRowCount(o+h),s.expandColumns&&n+p>t.getColumnCount()&&t.setColumnCount(n+p),l=0,u=0;l<i.length;l++,u++)(c=i[l]).length<=0||(f>0&&l<f?e.setRowData(t,c,u,n,p,1,s):h>0&&u<t.getRowCount()&&(l===f&&(u=o),e.setRowData(t,c,u,0,d,2,s),c.splice(0,d),e.setRowData(t,c,u,n,p,3,s)))}},e.setRowData=function(t,o,n,r,i,a,s){for(var l=0,u=r;l<o.length;l++,u++)i>0&&u<t.getColumnCount(a)&&e.setCellData(t,a,n,u,o[l],s)},e.setCellData=function(e,o,n,r,s,l){var u,c,h,p,d=s,f=i;if(!1===l.unFormatted&&t.features.formatter&&(u={value:s},f=(new t.GeneralFormatter).GetPreferredDisplayFormatter(s,u),d=u.value),d===a||d===i)e.setValue(n,r,d,o);else if(""!==s)if(l.formula&&"="===s[0])try{e.setFormula(n,r,s.substr(1))}catch(t){e.setText(n,r,s,o)}else{if(c=e.getActualStyle(n,r,o),!1===l.unFormatted&&t.features.formatter)if(c.formatter)"@"===c.formatter.toString()&&(d=s.toString());else{h=new t.AutoFormatter(f),e.getCell(n,r,o)._setStyleProperty("_autoFormatter",h);var g=s,m=e.getCellType(n,r,o),_=h.FormatString();m&&"7"===m.typeName&&(p={sheet:e,row:n,col:r,sheetArea:o},d=(g=m.parse(s,_,p))===i||g===a?s:g)}else c.formatter&&e.getCell(n,r,o).formatter(i);e.setValue(n,r,d,o)}else e.setValue(n,r,i,o)},e.getMaxLength=function(e){var t,o,n;if(e===a||e===i)return 0;for(t=0,o=0;o<e.length;o++)n=e[o],t=l(n.length,t);return t},e.parseCsv=function(t,o,n,r){var a,s,l=i,u=e.parseText(t,o,n,r);if(u){var c=u.length,h=e.getMaxLength(u),p=[];for(a=0;a<c;a++)for(p[a]=[],s=0;s<h;s++)p[a][s]=s<u[a].length?u[a][s]:i;l=p}return l},e.tryConvertDateToOADate=function(e){return typeof e!==d&&e!==i&&e.constructor===Date&&(e="/OADate("+new t._DateTimeHelper(e).toOADate()+")/"),e},e.tryConvertOADateToDate=function(e){var o;typeof e===m&&"/"===e.charAt(0)&&(j.test(e)?(o=e.match(j),e=t._DateTimeHelper.fromOADate(parseFloat(o[1]))):W.test(e)&&(o=e.match(W),e=new Date(parseFloat(o[1]))));return e},e.adjustModelFormulasAfterSetSheetName=function(e){var o,n,r,i,a,s,l,u,c,h,p,d,f;if(t.util.hasCalc()&&(n=(o=e.getCalcService()).getSourceModel(e._getSheetSource())))for(r=function(e){var t,n,r,i,a=e.sourceModel.getSource();e.name?(i=e.name,t=e.sourceModel.getNodeByName(i)):(n=void 0===(n=e.row)?-1:n,r=void 0===(r=e.column)?-1:r,t=e.sourceModel.getNode(n,r));var s=t.expr,l=t.arrayInfo,u=o.unparseWithoutCulture(a,s,n<0?0:n,r<0?0:r);l?a.setArrayFormula(l.row,l.col,l.rowCount,l.colCount,u):i?a.setFormulaByName(i,u):a.setFormula(n,r,u)},i=n.getAllNodes(),a=0;a<i.length;a++)if(l=(s=i[a]).calc)for(s.expr&&r(l),u=l._listeners,h=0;h<u.length;h++)if(p=l[u[h]])for(d=p.length,f=0;f<d;f++)(c=p[f]).sourceModel!==n&&r(c)},e.getDataValidatorsBeforeSetSheetName=function(e){var o,n,r,i,a,s,l,u,c;if(t.util.hasCalc()){var h=e.getCalcService(),p=e._getSheetSource(),d=[[],[]];if(t.features.dataValidator)for(o=t._DataValidatorCache.getAllValidators(),l=0;l<o.length;l++)if(n=o[l].validator,o[l].sheet._getSheetSource(),s=[],(i=(r=n.condition).getFormulas())&&i.length>0){for(u=0;u<i.length;u++)a=i[u],c=h.parse(p,a,0,0),s.push(c),p.getCalcService().unparse(p,c,0,0);d[0].push(r),d[1].push(s)}return d}},e.adjustValidatorsAfterSetSheetName=function(e,o){var n,r,i;if(t.util.hasCalc()){var a=o[0].length,s=e.getCalcService(),l=e._getSheetSource();for(n=0;n<a;n++){var u=o[0][n],c=o[1][n],h=[];for(r=0;r<c.length;r++)i=s.unparse(l,c[r],0,0),h.push(i);u.setFormulas(h)}}},e.adjustNamesOnRemoveTables=function(t,o){var n,r=t.parent,i=function(o,n){for(var r,i,a=0;a<o.length;a++)r=o[a].getExpression(),(i=e.adjustNameOnRemoveTable(r,n))!==r&&(o[a].setExpression(i),t.getCalcService().getOperatorAdjustor().invalidName(t._getSheetSource(),o[a].getName()))};if(r)for(i(r.getCustomNames(),o),n=0;n<r.sheets.length;n++)i((t=r.sheets[n]).getCustomNames(),o);else i(t.getCustomNames(),o);t.getCalcService().getOperatorAdjustor().onAfterRemoveTable()},e.adjustNameOnRemoveTable=function(o,n){var r,i,a,s,l=e.adjustNameOnRemoveTable;if(10===o.t){var u=o,c=u.left,h=u.right,p=l(c,n),d=l(h,n);if(c!==p||h!==d)return new t.Calc.Expressions.BinaryOperatorExpression(u.operator,p,d)}else if(11===o.t){var f=o,g=f.operand,m=l(g,n);if(g!==m)return new t.Calc.Expressions.UnaryOperatorExpression(f.operator,m)}else if(7===o.t){var _,y=o,C=!1,w=[];for(r=0;r<y.args.length;r++)i=l(_=y.args[r],n),C=C||_!==i,w.push(i);if(C)return new t.Calc.Expressions.FunctionExpression(y.fn,w)}else if(14===o.t){var v=o.argument,S=l(v,n);if(v!==S)return new t.Calc.Expressions.ParenthesesExpression(S)}else if(17===o.t)for(a=o,s=0;s<n.length;s++)if(a.baseTable()===n[s])return new t.Calc.Expressions.ErrorExpression(t.Calc.Errors.Reference);return o},e}(),S=[/\\/g,/\(/g,/\[/g,/\{/g,/\^/g,/\$/g,/\|/g,/\)/g,/\+/g,/\./g],x=new RegExp("{113E2532-EAF5-444c-A5CB-3D7446971C4D}","g"),R=new RegExp("{E21523B3-0F1F-458f-B547-23D25713D0EC}","g"),b=".gcSheet",T=".gcSheetInternal",A="mousedown"+b,I="mousemove"+b,D="mouseup"+b,F="mouseout"+b,M="dblclick"+b,E="mousewheel"+b,N="DOMMouseScroll"+b,O="resize"+b,P="value",L="tag",H="left",k="top",V="width",B="height",z="hidden",G="visibility",W=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),j=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$")}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){var o,n;t.feature("core.spread",["core.common","core.theme","core.sheet_event","core.sheet_action","core.sheet","core.spreadpanelex","core.stringResource","core.imageLoader"]);var r=null,i=void 0,a=Math.round,s=Math.max,l=Math.min,u=Math.pow,c=Math.sqrt,h="string",p="boolean",d="number",f="undefined",g=window.document,m="px",_=".gcSpread",y=".gcSpreadInternal",C=".gcScrollbar",w="scroll-handle",v="scroll-bar",S=function(){function s(e,t){var o,n,a,s;this._isResizing=!1,(o=this)._host=r,o._allowUndo=!0,o._paintSuspended=!1,o._availableSheetIndex=-1,o._useTouchLayout=!1,o.touchScrollOnRails(!0),o.sheets=r,o.name=r,o._tabStripRatio=.5,o._tabStripRatioUserSet=.5,o._activeSheetIndex=0,o._allowUserZoom=!0,o._allowUserResize=!0,o._allowSheetReorder=!0,o._tabStripVisible=!0,o._tabEditable=!0,o._newTabVisible=!0,o._firstTabUserSet=0,o._canUserEditFormula=!0,o._enableFormulaTextbox=!0,o._highlightInvalidData=!1,o._autoFitType=0,o._allowDragDrop=!0,o._allowDragFill=!0,o._showDragFillSmartTag=!0,o._defaultDragFillType=5,o._showScrollTip=0,o._showResizeTip=0,o._showDragDropTip=!0,o._showDragFillTip=!0,o._tooltip=r,o._showVerticalScrollbar=!0,o._showHorizontalScrollbar=!0,o._scrollIgnoreHidden=!1,o._backColor="white",o._backgroundImage=r,o._backgroundImageLayout=0,o._imageLoader=r,o._suspendSetFocus=!1,o._cutCopyIndicatorVisible=!0,o._cutCopyIndicatorBorderColor="#217346",o._defaultSheetCount=1,o._defaultActiveSheetIndex=0,o._windowResizeTimer=r,o._scrollbarMaxAlign=!1,o._scrollbarShowMax=!0,o._hideSelection=!1,o._resizeZeroIndicator=1,o._tabNavigationVisible=!0,(typeof t===d||t===r||t===i)&&(n={},typeof arguments[0]===h&&(n.name=arguments[0]),typeof arguments[1]===d&&(n.sheetCount=arguments[1]),t=n),(typeof e===h||e===r||e===i)&&(e=r,"object"==typeof arguments[2]&&(e=arguments[2])),a=1,s=[],t&&(typeof t.sheetCount===d&&(a=t.sheetCount),typeof t.name===h&&t.name.length>0&&(o.name=t.name),typeof t.font===h&&t.font.length>0&&(o._font=t.font),typeof t.allowUserZoom===p&&(o._allowUserZoom=t.allowUserZoom),typeof t.allowUserResize===p&&(o._allowUserResize=t.allowUserResize),typeof t.tabStripVisible===p&&(o._tabStripVisible=t.tabStripVisible),typeof t.tabEditable===p&&(o._tabEditable=t.tabEditable),typeof t.newTabVisible===p&&(o._newTabVisible=t.newTabVisible),typeof t.tabStripRatio===d&&(o._tabStripRatio=t.tabStripRatio),typeof t.activeSheetIndex===d&&(o._activeSheetIndex=t.activeSheetIndex),t.sheets&&t.sheets.length>0&&(s=t.sheets)),o._init(a,s,e)}return s.prototype._init=function(e,o,n){var i,a,s,l,u,c,h=this;for(h._initCalcService(),h._userEvents=[],h._userEventsElem=g.createElement("input"),h._eventSuspended=0,h._undoManager=new t._UndoManager(h,-1,h.allowUndo()),h._clipboardHelper={fromSheet:r,range:r,isCutting:!1},h._floatingObjectClipboardHelper={fromSheet:r,isCutting:!1},h._containerDiv=r,t.features.touch&&(h._touchEventProvider=new t.TouchEventProvider),h.sheets=[],h._namedStyles={},t.features.sparklineEx&&(h._sparklineExs={},h.addSparklineEx(new t.PieSparkline),h.addSparklineEx(new t.AreaSparkline),h.addSparklineEx(new t.ScatterSparkline),h.addSparklineEx(new t.LineSparkline),h.addSparklineEx(new t.ColumnSparkline),h.addSparklineEx(new t.WinlossSparkline),h.addSparklineEx(new t.BulletSparkline),h.addSparklineEx(new t.SpreadSparkline),h.addSparklineEx(new t.StackedSparkline),h.addSparklineEx(new t.HBarSparkline),h.addSparklineEx(new t.VBarSparkline),h.addSparklineEx(new t.BoxPlotSparkline),h.addSparklineEx(new t.VariSparkline),h.addSparklineEx(new t.CascadeSparkline),h.addSparklineEx(new t.ParetoSparkline)),i=0;i<e;i++)a=h._createSheet(h._getDefaultSheetName(i)),h.sheets.push(a),a.onAttached(h);if(s=t.util._isStandardCanvas(),l=t.util._isSilverlightCanvas(),s&&h._suspendInvalidate(),n&&h._setHost(n),o&&o.length>0){if(h.getSheetCount()<o.length)for(c=h.getSheetCount();c<o.length;)u=h._createSheet(h._getDefaultSheetName(c)),h._addSheetImp(c,0,u),c=h.getSheetCount();for(i=0;i<o.length;i++)(u=h.getSheet(i)).applyOptions(o[i])}s?h._resumeInvalidate()||(h.invalidateLayout(),h.repaint()):l&&window.slcanvas&&window.slcanvas.autoLoad&&window.slcanvas.autoLoad(),t.features.touch&&!h.touchToolStrip&&(h.touchToolStrip=new t.TouchToolStrip(h,h._getContainerDiv()))},s.prototype._getContainerDiv=function(){return!this._containerDiv&&this._host&&(this._containerDiv=g.createElement("div"),t.GC$(this._containerDiv).css({position:"relative",left:0,top:0,height:0}),t.GC$(this._host).prepend(this._containerDiv)),this._containerDiv},s.prototype._getDefaultSheetName=function(e){var t,o,n,a,s=this;s._availableSheetIndex<s.getSheetCount()?s._availableSheetIndex=s.getSheetCount():s._availableSheetIndex++,(e===i||e===r||e<s._availableSheetIndex)&&(e=s._availableSheetIndex),t=!1;do{if(o="Sheet"+(e+1),(n=s.sheets.length)>0)for(a=0;a<n;a++)if(a in s.sheets){if(s.sheets[a]._name===o){e++,t=!0;break}t&&(t=!1)}}while(t);return o},s.prototype._initCalcService=function(){t.util.hasCalc()&&(this.calcService=new t.Calc.CalcService,this._spreadSource=new t.Calc.SpreadSource(this),this._spreadSourceModel=this.calcService.getGlobalSourceModel(this._spreadSource))},s.prototype._createSheet=function(e){return new t.Sheet(e)},s.prototype._slSetHost=function(e){var o;t.GC$(e).data("spread",this),(o=g.createElement("canvas")).setAttribute("width",""+e.clientWidth),o.setAttribute("height",""+e.clientHeight),e.appendChild(o),this.canvas=o,o.setAttribute("renderMethod","auto"),o.setAttribute("gcSpreadsheet","true"),o.setAttribute("onload","GcSpread.Sheets.util.initPaint('"+e.id+"')"),this._resizeHandler=t.util.createEventHandler(this,this._doResize),t.GC$(window).bind("resize.gcSpread",this._resizeHandler)},s.prototype._setHost=function(e){var o,n,i,a,s,l,u,c,h,p,d,f,y=this;if(e){if(o=t.util._isStandardCanvas(),n=t.util._isSilverlightCanvas(),!o&&n)return void y._slSetHost(e);for(y._host=e,(i=window.jQuery)&&i(e).data("spread",y),t.GC$(e).data("spread",y),e.setAttribute("gcUIElement","gcSpread"),t.Global.prototype._createDummyObjects(),(a=g.createElement("table")).cellSpacing="0px",a.cellPadding="0px",a.style.border="0px",u=0;u<2;u++){for(s=g.createElement("tr"),c=0;c<2;c++)l=g.createElement("td"),s.appendChild(l);a.appendChild(s)}for(e.appendChild(a),t.GC$(e).bind(t.Events.CultureChanged,y,y._onCultureChanged),t.GC$(e).addClass("no-user-select"),y._vp=g.createElement("div"),y._vp.id=e.id+"vp",a.rows[0].cells[0].insertBefore(y._vp,r),"100%",a.style.width="100%",a.style.height="100%",a.style.border="0",a.style.margin="0",u=0;u<a.rows.length;u++)for(c=0;c<a.rows[u].cells.length;c++)a.rows[u].cells[c].style.padding="0",a.rows[u].cells[c].style.border="0";for(y._scrollbarV=new t.Scrollbar(!1),h=y._scrollbarV.getScrollbar(),y._scrollbarVContainer=g.createElement("div"),t.GC$(y._scrollbarVContainer).append(h),a.rows[0].cells[1].insertBefore(y._scrollbarVContainer,r),t.GC$(h).bind("scroll"+C,function(e,t){y.getActiveSheet();var o=t.scrollEventType,n=t.scrollOrientation;if(e.data=y,1===n)switch(o){case 0:case 1:case 2:case 3:case 5:y._vscrollDelegate(e,t);break;case 4:y._vScrollStop(e)}}).bind("mousedown"+C,function(e,t){e.data=y,y._vScrollMouseDown(e)}).bind("mouseup"+C,function(e,t){e.data=y,y._scrollMouseUp(e)}),a.rows[1].cells[0].innerHTML="<table cellspacing=0 cellpadding=0 border=0><tr><td></td><td></td></tr></table>",y._footerCornerContainer=g.createElement("div"),t.GC$(a.rows[1].cells[1]).append(y._footerCornerContainer),(p=a.rows[1].cells[0].firstChild).style.border="0",p.style.margin="0",t.GC$(p).css("user-select","none"),u=0;u<p.rows.length;u++)for(c=0;c<p.rows[u].cells.length;c++)p.rows[u].cells[c].style.padding="0",p.rows[u].cells[c].style.border="0";y._tabs=g.createElement("div"),y._tabs.style.width=""+y._getActualTabStripRatio()*t.GC$(y._host).width()+m,y._tabs.style.height=""+y._getTabStripHeight()+m,y._tabs.style.fontSize="10pt",y._tabs.style.fontFamily="Arial",p.rows[0].cells[0].insertBefore(y._tabs,r),y._scrollbarH=new t.Scrollbar(!0),d=y._scrollbarH.getScrollbar(),y._scrollbarHContainer=g.createElement("div"),t.GC$(y._scrollbarHContainer).append(d),p.rows[0].cells[1].insertBefore(y._scrollbarHContainer,r),t.GC$(d).bind("scroll"+C,function(e,t){y.getActiveSheet();var o=t.scrollEventType,n=t.scrollOrientation;if(e.data=y,0===n)switch(o){case 0:case 1:case 2:case 3:case 5:y._hscrollDelegate(e,t);break;case 4:y._hScrollStop(e)}}).bind("mousedown"+C,function(e,t){e.data=y,y._hScrollMouseDown(e)}).bind("mouseup"+C,function(e,t){e.data=y,y._scrollMouseUp(e)}),this._resizeHandler=t.util.createEventHandler(y,y._doWindowResize),t.GC$(window).bind("resize"+_,this._resizeHandler),t.features.comment&&(y._commentRender=new t.CommentRender(y._getContainerDiv())),(f=y.getActiveSheet())&&(f._setHost(y._vp),t.GC$(window).unbind("resize.gcSheet")),y._refreshScrollbarAndTabStrip(),y._doResize(),y._createFocusElementForTab(e)}},s.prototype._createFocusElementForTab=function(e){var o=this,n=parseInt(t.GC$(e).attr("tabindex"),10)||0,i=g.createElement("div");t.GC$(i).css("position","absolute").css("overflow","hidden").attr("gcUIElement","gcSheetFocusElementForTab").attr("tabindex",n).bind("focus",function(){o._ignoreFocusEvent||o.getActiveSheet().setFocus();o._ignoreFocusEvent=!1}),e.insertBefore(i,r),o._tabFocusElement=i},s.prototype.focusTabFocusElement=function(){var e=this._tabFocusElement;e&&(this._ignoreFocusEvent=!0,e.focus())},s.prototype._onCultureChanged=function(e,t){var o,n,i,a,s,l,u=e.data;for(u.invalidateLayout(),u.touchToolStrip&&u.touchToolStrip._updateResource(),o=0,n=u.sheets.length;o<n;o++){var c=u.sheets[o],h=c.getRowCount(),p=c.getColumnCount();for(i=0;i<h;i++)for(a=0;a<p;a++)(s=c.getValue(i,a))!==r&&((l=c.getStyle(i,a))&&c._changeFormatterAfterCultureChanged(l,s))}u.repaint()},s.prototype._hscrollDelegate=function(e,t){var o,n,a,s,l=e.data,u=l.getActiveSheet();u&&t&&(o=parseInt(t.newValue,10),o=u._getOriginalColIndex(o),(t.oldValue===i||t.oldValue===r)&&(t.oldValue=0),t.oldValue=parseInt(t.oldValue,10),u._needSyncHScrollbarSize=!1,2===t.scrollEventType||0===t.scrollEventType?(2===t.scrollEventType&&(o=u._getPrevPageLeftColumn()),-1!=(n=u._getScrollableColumn(o,!0))&&n!=o&&(o=n),l._scrollbarShowMax||(u._needSyncHScrollbarSize=!0,t.ignoreUpdatePosition=!0)):(3===t.scrollEventType||1===t.scrollEventType)&&(3===t.scrollEventType&&((o=u._getPageRightColumn())===u._scrollLeftCol&&o++),l._scrollbarShowMax||(u._needSyncHScrollbarSize=!0,1===t.scrollEventType&&t.newValue===t.oldValue&&o++),-1!=(n=u._getScrollableColumn(o))&&n!=o&&(o=n)),o<(a=u._getFirstPageLeftColumn())&&(o=a),o>u._getLastVisualScrollColumn()&&(o=u._getLastVisualScrollColumn()),s=u._getVisibleColIndex(o),t.newValue!==s&&(t.newValue=s),t.oldValue!==s&&u._eventHandler.doHScroll(o))},s.prototype._hScrollStop=function(e){var t,o,n=e.data,r=n.getActiveSheet();r&&((o=(t=n._scrollbarH).value())<r._getFirstPageLeftColumn()?t.value(r._getVisibleColIndex(r._getFirstPageLeftColumn())):o>r._getLastVisualScrollColumn()&&t.value(r._getVisibleColIndex(r._getLastVisualScrollColumn())),r._eventHandler._removeTooltip(),n._scrollbarShowMax||(r._eventHandler.scrolling?r._needSyncHScrollbarSize=!0:n._resizeHScrollBar()),r._formulaTextBox&&r._formulaTextBox.focus())},s.prototype._hScrollMouseDown=function(e){var o,n,r,i,a,s=e.data;s&&((o=s.getActiveSheet())&&o.setFocus(),(1===(n=s.showScrollTip())||3===n)&&(i=(r=t.GC$(e.srcElement||e.target)).parent(),(r&&r.hasClass(w)||i&&i.hasClass(w)||r&&r.hasClass(v)||i&&i.hasClass(v))&&(r||i)&&((a=o&&o._eventHandler)&&a._showScrollTooltip(!1,e))))},s.prototype._vscrollDelegate=function(e,t){var o,n,a,s,l=e.data,u=l.getActiveSheet();u&&t&&(o=parseInt(t.newValue,10),o=u._getOriginalRowIndex(o),(t.oldValue===i||t.oldValue===r)&&(t.oldValue=0),t.oldValue=parseInt(t.oldValue,10),u._needSyncVScrollbarSize=!1,2===t.scrollEventType||0===t.scrollEventType?(2===t.scrollEventType&&(o=u._getPrevPageTopRow()),-1!=(n=u._getScrollableRow(o,!0))&&n!=o&&(o=n),l._scrollbarShowMax||(u._needSyncVScrollbarSize=!0,t.ignoreUpdatePosition=!0)):(3===t.scrollEventType||1===t.scrollEventType)&&(3===t.scrollEventType&&((o=u._getPageBottomRow())===u._scrollTopRow&&o++),l._scrollbarShowMax||(u._needSyncVScrollbarSize=!0,1===t.scrollEventType&&t.newValue===t.oldValue&&o++),-1!=(n=u._getScrollableRow(o))&&n!=o&&(o=n)),o<(a=u._getFirstPageTopRow())&&(o=a),o>u._getLastVisualScrollRow()&&(o=u._getLastVisualScrollRow()),s=u._getVisibleRowIndex(o),t.newValue!==s&&(t.newValue=s),t.oldValue!==s&&u._eventHandler.doVScroll(o))},s.prototype._initPaint=function(){var e,o,n;t.util._isStandardCanvas()||(o=(e=this).getActiveSheet())&&((n=o._getCanvas())&&n.firstChild&&n.firstChild.loaded?(e.invalidateLayout(),e.repaint()):window.setTimeout(function(){e._initPaint.call(e)},10))},s.prototype._vScrollStop=function(e){var t,o,n=e.data,r=n.getActiveSheet();r&&((o=(t=n._scrollbarV).value())<r._getFirstPageTopRow()?t.value(r._getVisibleRowIndex(r._getFirstPageTopRow())):o>r._getLastVisualScrollRow()&&t.value(r._getVisibleRowIndex(r._getLastVisualScrollRow())),r._eventHandler._removeTooltip(),n._scrollbarShowMax||(r._eventHandler.scrolling?r._needSyncVScrollbarSize=!0:n._resizeVScrollBar()),r._formulaTextBox&&r._formulaTextBox.focus())},s.prototype._vScrollMouseDown=function(e){var o,n,r,i,a,s=e.data;s&&((o=s.getActiveSheet())&&o.setFocus(),(2===(n=s.showScrollTip())||3===n)&&((r=t.GC$(e.srcElement||e.target))&&(i=r.parent(),(r.hasClass(w)||i&&i.hasClass(w)||r.hasClass(v)||i&&i.hasClass(v))&&((a=o&&o._eventHandler)&&a._showScrollTooltip(!0,e)))))},s.prototype._scrollMouseUp=function(e){var t,o,n=e.data;n&&((o=(t=n.getActiveSheet())&&t._eventHandler)&&o._removeTooltip())},s.prototype._dispose=function(){var e,o,n,i,a,s=this;for(t.DPIHelper.disposeSpread(s),t.GC$(window).unbind("resize"+_,s._resizeHandler),s.unbindAll(),s._resizeHandler=r,s._scrollbarH&&s._scrollbarH.dispose(),s._scrollbarV&&s._scrollbarV.dispose(),s._touchEventProvider&&s._touchEventProvider.dispose(),s._disposeUserEvents(),t._DataValidatorCache.clear(),e=s.sheets,o=0;o<e.length;o++)e[o]._dispose(!0);e.splice(0,e.length),(n=s._host)&&(n.innerHTML="",n.removeAttribute("gcUIElement"),(i=t.GC$(s._host)).unbind(t.Events.CultureChanged),i.removeClass("no-user-select"),i.attr("class")||i.removeAttr("class"),i.attr("unselectable")||i.removeAttr("unselectable"),i.data("spread")&&i.data("spread",r),$&&$(n).data("spread")&&$(n).data("spread",r)),s.touchToolStrip&&(s.touchToolStrip._dispose(),s.touchToolStrip=r),s._commentRender&&(s._commentRender=r),(a=s._printer)&&a.dispose(),s._scrollbarHContainer=s._scrollbarVContainer=r,s._undoManager=r,s._tab&&(s._tab.dispose(),s._tab=r),s._tabFocusElement&&(t.GC$(s._tabFocusElement).unbind("focus"),s._tabFocusElement=r),s.calcService&&(s.calcService.dispose(),s.calcService=r,s._spreadSource=r,s._spreadSourceModel=r),s._imageLoader=r},s.prototype._disposeUserEvents=function(){var e;for(t.GC$(this._userEventsElem).unbind(_),e=0;e<this.sheets.length;e++)this.sheets[e]._disposeUserEvents()},s.prototype._getCalcContexts=function(){for(var e,t=[],o=0;o<this.sheets.length;o++)if(e=this.sheets[o]._getCalcContexts())for(;e.length>0;)t.push(e.pop());return t},s.prototype._refreshScrollbarAndTabStrip=function(){var e,r=this,i=t.ThemeStyleHelper.getCssClassThemeStyle(""),a=parseInt(i.zIndex),s=a!==r._themeVersion;s&&(r._themeVersion=a);r._getTabStripHeight(),r._getScrollbarSize(),r._getVScrollbarContainerWidth();r._tab&&!s?r._tab.repaint():(e=r._host,r._tab&&r._tab.dispose(),r._tab=a>2007?new n(e.getAttribute("id")+"_tabStrip"):new o(e.getAttribute("id")+"_tabStrip"),r._tab.setOwner(r),r._tab.setHost(r._tabs)),r._refreshVScrollContainer(),r._refreshHScrollContainer(),r._refreshFooterCorner()},s.prototype._refreshVScrollContainer=function(){var e,o,n=t.ThemeStyleHelper.getCssClassThemeStyle("gc-vertical-scrollbar ui-widget-header ui-state-default btn btn-default"),r=parseInt(n.zIndex),i=this._getScrollbarSize(),a=this._getVScrollbarContainerWidth(),s=0;r>2007&&(s=1),(a-i)%2==0?o=(e=(a-i)/2)-s:o=e=(a-i-s)/2,t.GC$(this._scrollbarVContainer).css({"box-sizing":"content-box",border:"none","border-color":"none","border-left-style":"solid","border-left-width":s+"px","border-left-color":n.borderLeftColor,"background-color":n.backgroundColor,width:i,padding:"0px "+e+"px 0px "+o+"px",margin:"0"})},s.prototype._refreshHScrollContainer=function(){var e,o,n=t.ThemeStyleHelper.getCssClassThemeStyle("gc-horizontal-scrollbar ui-widget-header ui-state-default btn btn-default"),r=parseInt(n.zIndex),i=this._getTabStripHeight(),a=this._getScrollbarSize(),s=0;r>2007&&(s=1),(i-a)%2==0?o=(e=(i-a)/2)-s:o=e=(i-a-s)/2,t.GC$(this._scrollbarHContainer).css({"box-sizing":"content-box",border:"none","border-color":"none","border-top-style":"solid","border-top-width":s+"px","border-top-color":n.borderTopColor,"background-color":n.backgroundColor,height:a,padding:o+"px 0px "+e+"px 0px",margin:"0"})},s.prototype._refreshFooterCorner=function(){var e=t.ThemeStyleHelper.getCssClassThemeStyle("gc-footer-corner ui-widget-header ui-state-default btn btn-default"),o=this._getVScrollbarContainerWidth(),n=this._getTabStripHeight();t.GC$(this._footerCornerContainer).css({border:"none",padding:"0",margin:"0",width:o+"px",height:n+"px","background-color":e.backgroundColor})},s.prototype._doWindowResize=function(){var e=this;e._windowResizeTimer&&window.clearTimeout(e._windowResizeTimer),e._windowResizeTimer=window.setTimeout(function(){t.DPIHelper.updateDPI(),e._doResize(),e._windowResizeTimer=r},100)},s.prototype._doResize=function(){this._isResizing||(this._isResizing=!0,this._doResizeImp(),this._isResizing=!1)},s.prototype._doResizeImp=function(){var e,o,n,r,i,s,l=this;if(t.util.browser.msie&&parseInt(t.util.browser.version,10)<9&&(e=l.canvas)){var u=e.parentElement,c=u.parentElement,h=e.firstChild;h&&c&&((o=function(e){return""===e||"auto"===e||/%$/gi.test(e)})(u.style.width)&&c.offsetWidth>12&&(h.width=c.offsetWidth-12),o(u.style.height&&c.offsetHeight>10)&&(h.height=c.offsetHeight-10))}var p=l._getTabStripHeight(),d=l._getScrollbarSize(),f=l._getVScrollbarContainerWidth(),g=l._host;if(g){var _=t.GC$(g),y=_.width(),C=t.GC$(g).height();l.showVerticalScrollbar()?(l._vp.style.width=""+(y-f)+m,t.GC$(l._scrollbarVContainer).css("display","block"),t.GC$(l._footerCornerContainer).css("width",f+m)):(l._vp.style.width=""+y+m,t.GC$(l._scrollbarVContainer).css("display","none"),t.GC$(l._footerCornerContainer).css("width","0px")),l.showHorizontalScrollbar()||l._tabStripVisible?(l._vp.style.height=""+(C-p)+m,t.GC$(l._scrollbarHContainer).css("display","block"),t.GC$(l._footerCornerContainer).css("height",p+m)):(l._vp.style.height=""+C+m,t.GC$(l._scrollbarHContainer).css("display","none"),t.GC$(l._footerCornerContainer).css("height","0px")),l.showHorizontalScrollbar()?(t.GC$(l._scrollbarH.getScrollbar()).show(),l.setTabStripRatio(l.getTabStripRatio())):(t.GC$(l._scrollbarH.getScrollbar()).hide(),l._setActualTabStripRatio(1)),n=t.GC$(l._vp).width(),(r=a(l._getActualTabStripRatio()*n))===n&&(r=n-1),l._tabs.style.width=""+r+m,l._tabs.style.height=""+p+m,l._scrollbarV.width(d),l._scrollbarV.height(t.GC$(l._vp).height()),i=y-(l._tabStripVisible?r:0)-(l.showVerticalScrollbar()?f:0),l._scrollbarH.width(i>0?i:1),l._scrollbarH.height(d),(s=l.getActiveSheet())&&(0===s._scrollTopRow&&(s._scrollTopRow=s._getFirstPageTopRow()),0===s._scrollLeftCol&&(s._scrollLeftCol=s._getFirstPageLeftColumn())),s&&s._eventHandler.doResize(),l._resizeHScrollBar(),l._resizeVScrollBar(),s&&(s.invalidateLayout(),s.repaint()),!0===l._tabStripVisible?t.GC$(l._tabs).show():t.GC$(l._tabs).hide(),l._tab&&l._tab.doResize(),y===_.width()||l._haveLayoutFixing||(l._haveLayoutFixing=!0,setTimeout(function(){delete l._haveLayoutFixing,l._doResizeImp()},1))}},s.prototype._resizeHScrollBar=function(){var e,t,o=this.getActiveSheet();if(o){var n=o.getColumnCount()-o._frozenTrailingColCount-o.frozenColCount,r=o.frozenColCount,i=o._getSheetLayout(),a=0===n?r:r+n-1,s=o._scrollLeftCol,l=1,u=o._getLeftColWhenLastColShowComplete(i.viewportWidth,r,a);if(this._scrollbarMaxAlign&&(a=u),!this._scrollbarShowMax){var c=o._getLastNonNullRowAndCol().lastNonNullCol,h=o._getLeftColWhenLastColShowComplete(i.viewportWidth,r,c);h===r&&(++h>a&&(h=a)),a=s>h?s<a?s:a:h}s>a&&(o._scrollLeftCol=a),-1!==(e=o._getScrollableColumn(o._scrollLeftCol))&&e!==o._scrollLeftCol&&(o._scrollLeftCol=e),(l=o._getPageValueH())<1&&(l=1),(t=this._scrollbarH)&&(t.minimum(o._getVisibleColIndex(r)),t.maximum(o._getVisibleColIndex(a)),t.pageValue(l),t.refreshLayout(),t.value(o._getVisibleColIndex(o._scrollLeftCol)))}},s.prototype._resizeVScrollBar=function(){var e,t,o=this.getActiveSheet();if(o){var n=o.getRowCount()-o._frozenTrailingRowCount-o.frozenRowCount,r=o.frozenRowCount,i=o._getSheetLayout(),a=0===n?r:r+n-1,s=o._scrollTopRow,l=1,u=o._getTopRowWhenLastRowShowComplete(i.viewportHeight,r,a);if(this._scrollbarMaxAlign&&(a=u),!this._scrollbarShowMax){var c=o._getLastNonNullRowAndCol().lastNonNullRow,h=o._getTopRowWhenLastRowShowComplete(i.viewportHeight,r,c);h===r&&(++h>a&&(h=a)),a=s>h?s<a?s:a:h}s>a&&(o._scrollTopRow=a),-1!==(e=o._getScrollableRow(o._scrollTopRow))&&e!==o._scrollTopRow&&(o._scrollTopRow=e),(l=o._getPageValueV())<1&&(l=1),(t=this._scrollbarV)&&(t.minimum(o._getVisibleRowIndex(r)),t.maximum(o._getVisibleRowIndex(a)),t.pageValue(l),t.refreshLayout(),t.value(o._getVisibleRowIndex(o._scrollTopRow)))}},s.prototype._doTabHSResize=function(){var e,o,n=this,r=n._getScrollbarSize(),i=n._getTabStripHeight(),s=n._getVScrollbarContainerWidth(),l=n._host;if(l){var u=t.GC$(l).width(),c=t.GC$(n._vp).width(),h=a(n._getActualTabStripRatio()*c);h===c&&(h=c-1),n._tabs.style.width=""+h+m,n._tabs.style.height=""+i+m,e=u-(n._tabStripVisible?h:0)-(n.showVerticalScrollbar()?s:0),n._scrollbarH.width(e>0?e:1),n._scrollbarH.height(r),n._scrollbarH.refreshLayout(),(o=n.getActiveSheet())&&(0===o._scrollLeftCol&&(o._scrollLeftCol=o._getFirstPageLeftColumn()),n._scrollbarH.value(o._scrollLeftCol)),!0===n._tabStripVisible?t.GC$(n._tabs).show():t.GC$(n._tabs).hide(),n._tab&&n._tab.doResize()}},s.prototype._copyUserEvents=function(e){var t,o;for(e._eventHandler._eventSuspended=this._eventSuspended,t=0;t<this._userEvents.length;t++)o=this._userEvents[t],e.bind(o.type,o.data,o.fn)},s.prototype._suspendInvalidate=function(){var e=this.getActiveSheet();e&&e._suspendInvalidate()},s.prototype._resumeInvalidate=function(){var e=this.getActiveSheet();return!!e&&e._resumeInvalidate()},s.prototype._paintSpreadBackgroundImage=function(){var e,o=this,n=o.getActiveSheet();if(n){if(!o._backgroundImage)return;if(t.GC$(n._getCanvas()).css("background-image","url('"+o._backgroundImage+"')").css("background-repeat","no-repeat"),o._backgroundImageLayout===r||o._backgroundImageLayout===i)return;e=o._backgroundImage,o._imageLoader||(o._imageLoader=new t._GcImageLoader(function(){o._imageLoader&&o._paintSpreadBackgroundImage()}));try{if(o._imageLoader.getState(e)){var a=o._imageLoader.getImage(e),s=n.getBounds(),l=s.width,u=s.height;t.util._applyBackgroundImageLayout(n._getCanvas(),l,u,a.width,a.height,o._backgroundImageLayout)}else o._imageLoader.addImage(e)}catch(e){}}},s.prototype.touchScrollOnRails=function(e){return 0===arguments.length?this._touchScrollOnRails:(this._touchScrollOnRails=e,t.features.touch&&t.TouchHelper.TouchScrollOnRails(e),this)},s.prototype._changeSheetForFormulaAcrossSheet=function(e,t){void 0===t&&(t=!0);this._tab._doSheetTabClickChange(this.getSheetIndex(e.getName()),t)},s.prototype.scrollIgnoreHidden=function(e){var t;return 0===arguments.length?this._scrollIgnoreHidden:(this._scrollIgnoreHidden!==e&&(this._scrollIgnoreHidden=e,(t=this.getActiveSheet())&&(t._needSyncHScrollbarSize=!0,t._needSyncVScrollbarSize=!0,t.invalidate())),this)},s.prototype.scrollbarMaxAlign=function(e){var t;return 0===arguments.length?this._scrollbarMaxAlign:(this._scrollbarMaxAlign!==e&&(this._scrollbarMaxAlign=e,(t=this.getActiveSheet())&&(t._needSyncHScrollbarSize=!0,t._needSyncVScrollbarSize=!0,t.invalidate())),this)},s.prototype.scrollbarShowMax=function(e){var t;return 0===arguments.length?this._scrollbarShowMax:(this._scrollbarShowMax!==e&&(this._scrollbarShowMax=e,(t=this.getActiveSheet())&&(t._needSyncHScrollbarSize=!0,t._needSyncVScrollbarSize=!0,t.invalidate())),this)},s.prototype.showVerticalScrollbar=function(e){return 0===arguments.length?this._showVerticalScrollbar:(this._showVerticalScrollbar!==e&&(this._showVerticalScrollbar=e,this._doResize()),this)},s.prototype.showHorizontalScrollbar=function(e){return 0===arguments.length?this._showHorizontalScrollbar:(this._showHorizontalScrollbar!==e&&(this._showHorizontalScrollbar=e,this._doResize()),this)},s.prototype.allowUserZoom=function(e){return 0===arguments.length?this._allowUserZoom:(this._allowUserZoom=e,this)},s.prototype.allowSheetReorder=function(e){return 0===arguments.length?this._allowSheetReorder:(this._allowSheetReorder=e,this)},s.prototype.allowUserResize=function(e){return 0===arguments.length?this._allowUserResize:(this._allowUserResize=e,this)},s.prototype.tabStripVisible=function(e){return 0===arguments.length?this._tabStripVisible:(this._tabStripVisible!==e&&(this._tabStripVisible=e,this._doResize()),this)},s.prototype.tabNavigationVisible=function(e){return 0===arguments.length?this._tabNavigationVisible:(this._tabNavigationVisible!==e&&(this._tabNavigationVisible=e,this._tab&&this._tab.repaint()),this)},s.prototype.tabEditable=function(e){return 0===arguments.length?this._tabEditable:(this._tabEditable=e,this)},s.prototype.newTabVisible=function(e){return 0===arguments.length?this._newTabVisible:(this._newTabVisible!==e&&(this._newTabVisible=e,this._tab&&this._tab.repaint()),this)},s.prototype.cutCopyIndicatorVisible=function(e){var t,o=this;return 0===arguments.length?o._cutCopyIndicatorVisible:o._cutCopyIndicatorVisible===e?o:(t=o.getActiveSheet())?t._bindToAutoRefresh(function(e){return o._cutCopyIndicatorVisible=e,o})(e):(o._cutCopyIndicatorVisible=e,o)},s.prototype.cutCopyIndicatorBorderColor=function(e){var t,o=this;return 0===arguments.length?o._cutCopyIndicatorBorderColor:o._cutCopyIndicatorBorderColor===e?o:(t=o.getActiveSheet())?t._bindToAutoRefresh(function(e){return o._cutCopyIndicatorBorderColor=e,o})(e):(o._cutCopyIndicatorBorderColor=e,o)},s.prototype.canUserEditFormula=function(e){return 0===arguments.length?t.util.hasCalc()&&this._canUserEditFormula:(this._canUserEditFormula=e,this)},s.prototype.enableFormulaTextbox=function(e){var t;if(0===arguments.length)return this._enableFormulaTextbox;for(t=0;t<this.sheets.length;t++)this.sheets[t].enableFormulaTextbox(e);return this._enableFormulaTextbox=e,this},s.prototype.autoFitType=function(e){return 0===arguments.length?this._autoFitType:(this._autoFitType=e,this)},s.prototype.startSheetIndex=function(e){var t,o=this;return 0===arguments.length?o._tab?o._firstTabUserSet:0:(o._tab&&0<=e&&e<o.getSheetCount()&&(o._firstTabUserSet=e,o.sheets[e].visible()?o._tab._firstTab=e:-1!==(t=o._tab._getNextVisibleIndex(e))&&(o._tab._firstTab=t)),o._doTabHSResize(),o)},s.prototype.highlightInvalidData=function(e){if(0===arguments.length)return this._highlightInvalidData;var t=this,o=this.getActiveSheet();if(o)return o._bindToAutoRefresh(function(e){return t._highlightInvalidData=e,t})(e);t._highlightInvalidData=e},s.prototype.isPaintSuspended=function(e){var t;if(0===arguments.length)return this._paintSuspended;if(this._paintSuspended!==e){for(this._paintSuspended=e,t=0;t<this.sheets.length;t++)this.sheets[t].isPaintSuspended(e);this._tab&&this._tab.isPaintSuspended(e)}return this},s.prototype.destroy=function(){t.GC$(window).unbind("resize.gcSpread",this._resizeHandler),this._dispose()},s.prototype.repaint=function(){var e;this._tab&&this._tab.repaint(),(e=this.getActiveSheet())&&e.repaint()},s.prototype.refresh=function(){this._host&&(t.ThemeStyleHelper.clearCache(),this._refreshScrollbarAndTabStrip(),this._doResize(),this.repaint())},s.prototype.getHost=function(){return this._host},s.prototype.invalidateLayout=function(){var e=this.getActiveSheet();e&&e.invalidateLayout()},s.prototype.getActiveSheet=function(){return this.sheets.length>0?this.sheets[this._activeSheetIndex]:r},s.prototype.setActiveSheet=function(e){this._setActiveSheetInternal(e,2)},s.prototype._setActiveSheetInternal=function(e,t){for(var o=this.sheets,n=0;n<o.length;n++)o[n].getName()===e&&this._setActiveSheetIndexImp(n,t)},s.prototype.getActiveSheetIndex=function(){return this._activeSheetIndex},s.prototype.setActiveSheetIndex=function(e){this._setActiveSheetIndexImp(e,2)},s.prototype._setActiveSheetIndexImp=function(e,o){var n,r,i,a,s,l;"number"==typeof e&&e!==(n=this)._activeSheetIndex&&((r=n.sheets[e])&&r.visible())&&(((i=t.util.device()).ipad||i.iphone)&&(s=n,l=(new Date).valueOf(),s.lastSetActiveSheetTime&&l-s.lastSetActiveSheetTime<300)||(a=n.getActiveSheet(),n._activeSheetIndex=e,r!==a&&(a&&a._dispose(!1),n._setActiveSheetImp(r,o,!1)),n._doResize(),(i.ipad||i.iphone)&&(s=n,l=(new Date).valueOf(),s.lastSetActiveSheetTime=l)))},s.prototype.addNamedStyle=function(e){this._addNamedStyleImp(e,!0)},s.prototype._addNamedStyleImp=function(e,o){var n,a,s=this;if(e!==r&&e!==i){if(e.name===r||e.name===i||""===e.name)throw new Error(t.SR.Exp_EmptyNamedStyle);o?(a=e.name.toUpperCase(),(n=s.getActiveSheet())?n._bindToAutoRefresh(function(e){s._namedStyles[a]=e})(e):s._namedStyles[a]=e):(a=e.name.toUpperCase(),s._namedStyles[a]=e)}},s.prototype.getNamedStyle=function(e){return this.getNamedStyleImp(e,!0)},s.prototype.getNamedStyleImp=function(e,t){var o,n=this._namedStyles;return n&&e?((o=n[e=e.toUpperCase()]||r)&&t&&this.clearStyleCache(),o):r},s.prototype.removeNamedStyle=function(e){var t,o=this._namedStyles;o&&e&&(e=e.toUpperCase(),o.hasOwnProperty(e)&&(delete o[e],(t=this.getActiveSheet())&&t.invalidate()))},s.prototype.getNamedStyles=function(){var e=[],o=this._namedStyles;return o&&t.GC$.each(o,function(t,o){e.push(o)}),this.clearStyleCache(),e},s.prototype.clearStyleCache=function(){for(var e=0;e<this.sheets.length;e++)this.sheets[e].clearStyleCache()},s.prototype._setActiveSheetImp=function(e,o,n){n||e._setHost(this._vp);var i=!0;switch(o){case 1:i=!0;break;case 0:i=!1;break;case 2:i=t.FocusHelper.isActiveElement(e)}t.FocusHelper.setActiveElement(r),!this._suspendSetFocus&&i&&e.setFocus(),e._syncHScollbarPosition(),e._syncVScrollbarPosition()},s.prototype.addSheet=function(e,t){this._addSheetImp(e,2,t)},s.prototype._addSheetImp=function(e,o,n){var r,i,a,s=this;if(n||(n=s._createSheet(s._getDefaultSheetName(e))),i=s.sheets.length,n._name){for(r=0;r<i;r++)if(s.sheets[r]._name===n._name)throw t.SR.Exp_NotSupport}else n._name=s._getDefaultSheetName(e);s._copyUserEvents(n);var l=s.getActiveSheet(),u=s._activeSheetIndex,c=s.sheets.length-e,h=[];for(r=0;r<c&&s.sheets.length>0;r++)h.push(s.sheets.pop());for(s.sheets.push(n),n.onAttached(s);h.length>0;)s.sheets.push(h.pop());1===s.sheets.length?(s._vp&&n._setHost(s._vp),s._activeSheetIndex=0):s._activeSheetIndex=u<0?0:u,(a=s.getActiveSheet())!==l&&(l&&l._dispose(!1),a&&s._setActiveSheetImp(a,o,1===s.sheets.length),s._doResize()),s._tab&&s._tab.repaint()},s.prototype.removeSheet=function(e){this._removeSheetImp(e,2)},s.prototype._removeSheetImp=function(e,o){var n,r,i,a,s,l,u,c,h=this;if(isNaN(e)||e<0||e>=h.sheets.length)throw new Error(t.SR.Exp_IndexOutOfRange);if(n=e<=h._activeSheetIndex||e===h.sheets.length-1,r=h.getActiveSheet(),e<h._activeSheetIndex&&h._activeSheetIndex--,(i=h.sheets[e])._disposeUserEvents(),h.sheets.splice(e,1),0===(s=(a=h.sheets).length))h._activeSheetIndex=-1;else if(h._activeSheetIndex>=s)h._activeSheetIndex=h._tab._getPreVisibleIndex(s);else{for(l=h._activeSheetIndex;l<s;l++)if(a[l]._visible){h._activeSheetIndex=l;break}l>=s&&(h._activeSheetIndex=-1)}n&&(r!==(u=h.sheets[h._activeSheetIndex])&&(r&&r._dispose(!1),u&&h._setActiveSheetImp(u,o,!1))),h.calcService&&h.calcService.removeSource(i._getSheetSource()),h._tab&&(c=h.sheets.length,h._tab._firstTab>=c?h.startSheetIndex(h._tab._getPreVisibleIndex(c)):h._tab._firstTab<0?h.startSheetIndex(0):h._doResize())},s.prototype.clearSheets=function(){for(var e=this.sheets,o=(this.getActiveSheet(),0);o<e.length;o++)e[o]._disposeUserEvents(),e[o]._dispose();e.splice(0,e.length),this.calcService&&this.calcService.clearSource(),this._activeSheetIndex=-1,this._tab&&(this._tab._firstTab=0,this._tab.repaint()),t._DataValidatorCache.clear()},s.prototype.getSheet=function(e){return e>=0&&e<this.sheets.length?this.sheets[e]:r},s.prototype.getSheetFromName=function(e){for(var t=this.sheets,o=0;o<t.length;o++)if(t[o].getName()===e)return t[o];return r},s.prototype.getSheetIndex=function(e){for(var t=this.sheets,o=0;o<t.length;o++)if(t[o].getName()===e)return o;return r},s.prototype.getSheetCount=function(){return this.sheets.length},s.prototype.setSheetCount=function(e){this._setSheetCountImp(e,2)},s.prototype._setSheetCountImp=function(e,o){var n,r;if(e<0)throw t.SR.Exp_ArgumentOutOfRange;if(0===e&&this.clearSheets(),e<(n=this.sheets.length))for(r=n-1;r>=e;r--)this._removeSheetImp(r,o);else if(e>n)for(r=n;r<e;r++)this._addSheetImp(r,o,i)},s.prototype.search=function(e){var o,n;if(!e||!t.features.search)return r;if(this,0,!e.searchString||0===e.searchTarget||this.getSheetCount()<=0)return new t.SearchResult;if(-1===e.startSheetIndex&&(e.startSheetIndex=0),-1===e.endSheetIndex&&(e.endSheetIndex=this.getSheetCount()-1),e.endSheetIndex>=e.startSheetIndex&&0<=e.startSheetIndex&&e.startSheetIndex<this.getSheetCount()&&0<=e.endSheetIndex&&e.endSheetIndex<this.getSheetCount())for(o=e.startSheetIndex;o<=e.endSheetIndex;o++)if((n=this.getSheet(o).search(e))&&0!==n.searchFoundFlag)return n.foundSheetIndex=o,n;return new t.SearchResult},s.prototype.showCell=function(e,t,o,n){var r=this.getActiveSheet();r&&r.showCell(e,t,o,n)},s.prototype.showColumn=function(e,t){var o=this.getActiveSheet();o&&o.showColumn(e,t)},s.prototype.showRow=function(e,t){var o=this.getActiveSheet();o&&o.showRow(e,t)},s.prototype.showActiveCell=function(e,t){var o=this.getActiveSheet();o&&o.showCell(o._activeRowIndex,o._activeColIndex,e,t)},s.prototype.getCustomName=function(e){return this._names?this._names[e.toUpperCase()]:r},s.prototype.getCustomNames=function(){var e=[];return this._names&&t.GC$.each(this._names,function(t,o){e.push(o)}),e},s.prototype.addCustomName=function(e,t,o,n){this._addCustomNameCore(e,t,o,n,!1)},s.prototype._addCustomNameCore=function(e,o,n,a,s){var l,u,c,h,p;if(e===i||e===r||""===e||o===i||o===r||""===o)throw new Error(t.SR.Exp_InvalidCustomName);if(this,this._names||(this._names={}),this.calcService){if(u=(l=this.getActiveSheet())?l._getSheetSource():r,s)try{c=this.calcService.parse(u,o,n,a,!1,!0)}catch(e){}else c=this.calcService.parse(u,o,n,a);h=e.toUpperCase(),this._names[h]=new t.NameInfo(e,c,n,a),(p=this._spreadSourceModel._getNameCalc(h,!0))&&(p.updateListening(!0,!0),p.addToDirty()),this._recalcAll()}},s.prototype.removeCustomName=function(e){var t,o,n;this._names&&e!==i&&e!==r&&""!==e&&(t=e.toUpperCase(),this._names[t]&&(delete this._names[t],(o=this._spreadSourceModel)&&((n=o._getNameCalc(t))&&(n.updateListening(!0,!1),n.addToDirty())),this._recalcAll()))},s.prototype.clearCustomNames=function(){var e,t,o,n;if(this._names){if(e=this._names,delete this._names,t=this._spreadSourceModel)for(o in e)(n=t._getNameCalc(o))&&(n.updateListening(!0,!1),n.addToDirty());this._recalcAll()}},s.prototype._findCustomName=function(e){return e===i||e===r||""===e?r:this.getCustomName(e)},s.prototype.addCustomFunction=function(e){this._addCustomFunctionCore(e),this._recalcAll()},s.prototype._addCustomFunctionCore=function(e){if(t.util.hasCalc()){if(e===i||e===r||!(e instanceof t.Calc.Functions.Function))throw new Error(t.SR.Exp_InvalidCustomFunction);var o=e.name.toUpperCase();this._functions||(this._functions={}),this._functions[o]=e}},s.prototype.getCustomFunction=function(e){return this._functions&&e!==i&&e!==r&&""!==e?this._functions[e.toUpperCase()]:r},s.prototype.removeCustomFunction=function(e){this._functions&&e!==i&&e!==r&&""!==e&&(e=e.toUpperCase(),this._functions.hasOwnProperty(e)&&(delete this._functions[e],this._recalcAll()))},s.prototype.clearCustomFunctions=function(){this._functions&&(this._functions=r,this._recalcAll())},s.prototype._recalcAll=function(){var e,t;this.calcService&&!this.calcService.IsSuspended()&&((e=this.getActiveSheet())&&(t=e.isPaintSuspended(),e.isPaintSuspended(!0),this.calcService.recalculateAll(),e.isPaintSuspended(t)))},s.prototype.getCalcService=function(){return this.calcService},s.prototype.addCustomFunctionDescription=function(e){if(e&&e.name&&!this.getCustomFunctionDescription(e.name)){var t=this._functionDescriptions;t||(t=this._functionDescriptions=[]),t.push(e)}},s.prototype.getCustomFunctionDescription=function(e){var t,o,n,i=this._functionDescriptions;if(i&&e)for(e=e.toUpperCase(),t=i.length,n=0;n<t;n++)if((o=i[n]).name&&o.name.toUpperCase()===e)return o;return r},s.prototype.removeCustomFunctionDescription=function(e){var t,o,n,r=this._functionDescriptions;if(r&&e)for(e=e.toUpperCase(),t=r.length,n=0;n<t;n++)if((o=r[n]).name&&o.name.toUpperCase()===e){r.splice(n,1);break}},s.prototype.clearCustomFunctionDescriptions=function(){this._functionDescriptions&&(this._functionDescriptions=r)},s.prototype.referenceStyle=function(e){return 0===arguments.length?this.calcService&&this.calcService.useR1C1?1:0:(this.calcService&&(this.calcService.useR1C1=1===e),this)},s.prototype.bind=function(e,o,n){var r;for(this._userEvents.push({type:e,data:o,fn:n}),t.GC$(this._userEventsElem).bind(e+_,o,n),r=0;r<this.sheets.length;r++)this.sheets[r].bind(e,o,n)},s.prototype.unbind=function(e,o){for(var n,r=0;r<this._userEvents.length;r++)this._userEvents[r].type===e&&this._userEvents.splice(r,1);for(t.GC$(this._userEventsElem).unbind(e+_,o),n=0;n<this.sheets.length;n++)this.sheets[n].unbind(e,o)},s.prototype.unbindAll=function(){var e;for(this._userEvents.length=0,t.GC$(this._userEventsElem).unbind(_),e=0;e<this.sheets.length;e++)this.sheets[e].unbindAll()},s.prototype._bind=function(e,o,n){var r;for(this._userEvents.push({type:e,data:o,fn:n}),t.GC$(this._userEventsElem).bind(e+y,o,n),r=0;r<this.sheets.length;r++)this.sheets[r]._bind(e,o,n)},s.prototype._unbind=function(e,o){for(var n,r=0;r<this._userEvents.length;r++)this._userEvents[r].type===e&&this._userEvents.splice(r,1);for(t.GC$(this._userEventsElem).unbind(e+y,o),n=0;n<this.sheets.length;n++)this.sheets[n]._unbind(e,o)},s.prototype._unbindAll=function(){var e;for(this._userEvents.length=0,t.GC$(this._userEventsElem).unbind(y),e=0;e<this.sheets.length;e++)this.sheets[e]._unbindAll()},s.prototype.suspendEvent=function(){var e;for(this._eventSuspended++,e=0;e<this.sheets.length;e++)this.sheets[e].suspendEvent()},s.prototype.resumeEvent=function(){var e;for(this._eventSuspended--,this._eventSuspended<0&&(this._eventSuspended=0),e=0;e<this.sheets.length;e++)this.sheets[e].resumeEvent()},s.prototype.doCommand=function(e){this._undoManager.doAction(e)},s.prototype.allowUndo=function(e){return 0===arguments.length?this._allowUndo:(this._allowUndo=e,this._undoManager&&(this._undoManager._allowUndo=e),this)},s.prototype.undoManager=function(){return this._undoManager||(this._undoManager=new t._UndoManager(this,-1,this.allowUndo())),this._undoManager},s.prototype.canUserDragDrop=function(e){return 0===arguments.length?this._allowDragDrop:(this._allowDragDrop=e,this)},s.prototype.canUserDragFill=function(e){var o;return 0===arguments.length?!!t.features.fill&&this._allowDragFill:(this._allowDragFill!==e&&(this._allowDragFill=e,(o=this.getActiveSheet())&&(o._dragFillIndicatorRect=r,1!==o.getSelections().length||o._paintSuspended||o._render.repaintSelection(o.getSelections()[0]))),this)},s.prototype.showDragFillSmartTag=function(e){return 0===arguments.length?this._showDragFillSmartTag:("boolean"==typeof e&&this._showDragFillSmartTag!==e&&(this._showDragFillSmartTag=e),this)},s.prototype.defaultDragFillType=function(e){return 0===arguments.length?this._defaultDragFillType:(t.AutoFillType[e]!==i&&4!==e&&e!==this._defaultDragFillType&&(this._defaultDragFillType=e),this)},s.prototype.toJSON=function(e){var o,n,i,a,s,l,u,c,h,p,d,f=this,g=f.getSheetCount(),m={activeSheetIndex:f.getActiveSheetIndex(),sheetCount:g,tabStripRatio:f.getTabStripRatio(),tabStripVisible:f._tabStripVisible,tabEditable:f._tabEditable,newTabVisible:f._newTabVisible,referenceStyle:f.referenceStyle(),canUserEditFormula:f._canUserEditFormula,startSheetIndex:f.startSheetIndex(),allowUndo:f._allowUndo,allowUserZoom:f._allowUserZoom,allowUserResize:f._allowUserResize,allowDragDrop:f._allowDragDrop,allowDragFill:f._allowDragFill,showDragFillSmartTag:f._showDragFillSmartTag,defaultDragFillType:f._defaultDragFillType,allowSheetReorder:f._allowSheetReorder,highlightInvalidData:f._highlightInvalidData,autoFitType:f._autoFitType,showScrollTip:f._showScrollTip,showResizeTip:f._showResizeTip,showDragDropTip:f._showDragDropTip,showDragFillTip:f._showDragFillTip,scrollIgnoreHidden:f._scrollIgnoreHidden,showHorizontalScrollbar:f._showHorizontalScrollbar,showVerticalScrollbar:f._showVerticalScrollbar,scrollbarMaxAlign:f._scrollbarMaxAlign,scrollbarShowMax:f._scrollbarShowMax,backColor:f._backColor,backgroundImage:f._backgroundImage,backgroundImageLayout:f._backgroundImageLayout,grayAreaBackColor:f._grayAreaBackColor,cutCopyIndicatorVisible:f._cutCopyIndicatorVisible,cutCopyIndicatorBorderColor:f._cutCopyIndicatorBorderColor,useTouchLayout:f._useTouchLayout,hideSelection:f._hideSelection,customFunctions:f._functions,resizeZeroIndicator:f._resizeZeroIndicator,tabNavigationVisible:f._tabNavigationVisible},_={version:t.productInfo.productVersion};for(l in m)o=m[l],f._isDefaultValue(l,o)||(_[l]=o);for(n={},i=0;i<g;i++)n[(a=f.getSheet(i))._name]=a.toJSON(e),n[a._name].index=i;if(t.GC$.isEmptyObject(n)||(_.sheets=n),s=[],f._namedStyles)for(l in f._namedStyles)s.push(f._namedStyles[l]);if(s.length>0&&(_.namedStyles=s),u=[],f._names&&f.calcService)for(c in f._names)if(f._names.hasOwnProperty(c)){var y=f._names[c],C=y.getName(),w=y.getRow(),v=y.getColumn(),S=y.getExpression(),x=f.calcService.unparseWithoutCulture(r,S,w,v,!0);u.push({name:C,formula:x,row:w,col:v})}for(p in u.length>0&&(_.names=u),h=[],f._sparklineExs)(d=f._sparklineExs[p].toJSON())&&d.typeName&&h.push(d);return h.length>0&&(_.sparklineExs=h),_},s.prototype._isDefaultValue=function(e,t){switch(e){case"activeSheetIndex":return t===this._defaultActiveSheetIndex;case"sheetCount":return t===this._defaultSheetCount;case"tabStripRatio":return.5===t;case"tabStripVisible":case"tabEditable":case"newTabVisible":return!0===t;case"referenceStyle":return 0===t;case"canUserEditFormula":return!0===t;case"startSheetIndex":return 0===t;case"allowUndo":case"allowUserZoom":case"allowUserResize":case"allowDragDrop":case"allowDragFill":case"showDragFillSmartTag":return!0===t;case"defaultDragFillType":return 5===t;case"allowSheetReorder":return!0===t;case"highlightInvalidData":return!1===t;case"autoFitType":case"showScrollTip":case"showResizeTip":return 0===t;case"showDragDropTip":case"showDragFillTip":return!0===t;case"scrollIgnoreHidden":return!1===t;case"showHorizontalScrollbar":case"showVerticalScrollbar":return!0===t;case"scrollbarMaxAlign":return!1===t;case"scrollbarShowMax":return!0===t;case"backColor":return"white"===t;case"backgroundImage":return t===r;case"backgroundImageLayout":return 0===t;case"cutCopyIndicatorVisible":return!0===t;case"cutCopyIndicatorBorderColor":return"#217346"===t;case"useTouchLayout":case"hideSelection":return!1===t;case"resizeZeroIndicator":return 1===t;case"tabNavigationVisible":return!0===t;default:return!1}},s.prototype.fromJSON=function(o){var n,a,s,l,u,c,h,p,d,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E;if(o){a=(n=this)._getJsonDataVersion(o)<3,n._suspendSetFocus=!0,s=n.isPaintSuspended(),n.isPaintSuspended(!0),n.suspendEvent(),l=e.Sheets.Culture(),e.Sheets.switchCulture("");try{if(n._initCalcService(),n._availableSheetIndex=-1,n.clearSheets(),typeof(u=o.sheetCount)===f&&(u=n._defaultSheetCount),n._setSheetCountImp(u,0),o.referenceStyle!==r&&o.referenceStyle!==i&&n.referenceStyle(o.referenceStyle),n._names={},n._namedStyles={},o.namedStyles)for(_=0;_<o.namedStyles.length;_++)c=o.namedStyles[_],(h=new t.Style).fromJSON(c,a),typeof c.validator!==f&&(t.features.dataValidator&&(p=new e.Sheets.DefaultDataValidator).fromJSON(c.validator,a),h.validator=p),n._addNamedStyleImp(h,!1);if(_=0,d=o.sheets)for(D in d)"string"==typeof D&&(((M=(F=d[D]).index!==i?F.index:F._index)!=i?n.sheets[M]:n.sheets[_]).fromJSON(F,!1,a),_++);if(typeof(g=o.activeSheetIndex)===f&&(g=n._defaultActiveSheetIndex),n._setActiveSheetIndexImp(g,0),typeof o.tabStripRatio!==f&&n.setTabStripRatio(o.tabStripRatio),typeof o.tabStripVisible!==f&&(n._tabStripVisible=o.tabStripVisible),typeof o.tabEditable!==f&&(n._tabEditable=o.tabEditable),typeof o.newTabVisible!==f&&(n._newTabVisible=o.newTabVisible),n.gcSpreadsheet=o.gcSpreadsheet,typeof o.canUserEditFormula!==f&&(n._canUserEditFormula=o.canUserEditFormula),typeof o.startSheetIndex!==f&&n.startSheetIndex(o.startSheetIndex),typeof o.allowUndo!==f&&n.allowUndo(o.allowUndo),typeof o.allowUserZoom!==f&&(n._allowUserZoom=o.allowUserZoom),typeof o.allowUserResize!==f&&(n._allowUserResize=o.allowUserResize),m=n.sheets,typeof o.allowDragDrop!==f&&(n._allowDragDrop=o.allowDragDrop,m&&m.length>0))for(_=0;_<m.length;_++)m[_]._allowDragDrop=n._allowDragDrop;if(typeof o.allowDragFill!==f&&(n._allowDragFill=o.allowDragFill,m&&m.length>0))for(_=0;_<m.length;_++)m[_]._allowDragFill=n._allowDragFill;if(typeof o.showDragFillSmartTag!==f&&(n._showDragFillSmartTag=o.showDragFillSmartTag,m&&m.length>0))for(_=0;_<m.length;_++)m[_]._showDragFillSmartTag=n._showDragFillSmartTag;if(typeof o.defaultDragFillType!==f&&(n._defaultDragFillType=o.defaultDragFillType,m&&m.length>0))for(_=0;_<m.length;_++)m[_]._defaultDragFillType=n._defaultDragFillType;if(typeof o.allowSheetReorder!==f&&(n._allowSheetReorder=o.allowSheetReorder),typeof o.highlightInvalidData!==f&&(n._highlightInvalidData=o.highlightInvalidData),typeof o.autoFitType!==f&&n.autoFitType(o.autoFitType),typeof o.showResizeTip!==f&&(n._showResizeTip=o.showResizeTip),typeof o.showScrollTip!==f&&(n._showScrollTip=o.showScrollTip),typeof o.showDragDropTip!==f&&(n._showDragDropTip=o.showDragDropTip),typeof o.showDragFillTip!==f&&(n._showDragFillTip=o.showDragFillTip),typeof o.scrollIgnoreHidden!==f&&(n._scrollIgnoreHidden=o.scrollIgnoreHidden),typeof o.showHorizontalScrollbar!==f&&(n._showHorizontalScrollbar=o.showHorizontalScrollbar),typeof o.showVerticalScrollbar!==f&&(n._showVerticalScrollbar=o.showVerticalScrollbar),typeof o.scrollbarMaxAlign!==f&&(n._scrollbarMaxAlign=o.scrollbarMaxAlign),typeof o.scrollbarShowMax!==f&&(n._scrollbarShowMax=o.scrollbarShowMax),typeof o.backColor!==f&&(n._backColor=o.backColor),typeof o.backgroundImage!==f&&n.backgroundImage(o.backgroundImage),typeof o.backgroundImageLayout!==f&&n.backgroundImageLayout(o.backgroundImageLayout),typeof o.grayAreaBackColor!==f&&(n._grayAreaBackColor=o.grayAreaBackColor),typeof o.cutCopyIndicatorVisible!==f&&(n._cutCopyIndicatorVisible=o.cutCopyIndicatorVisible),typeof o.cutCopyIndicatorBorderColor!==f&&(n._cutCopyIndicatorBorderColor=o.cutCopyIndicatorBorderColor),typeof o.useTouchLayout!==f&&(n._useTouchLayout=o.useTouchLayout),typeof o.hideSelection!==f&&n.hideSelection(o.hideSelection),typeof o.resizeZeroIndicator!==f&&(n._resizeZeroIndicator=o.resizeZeroIndicator),typeof o.tabNavigationVisible!==f&&(n._tabNavigationVisible=o.tabNavigationVisible),n.calcService&&n.calcService.suspend(),n.clearCustomNames(),o.names)for(b=0;b<o.names.length;b++)y=o.names[b],n._addCustomNameCore(y.name,y.formula,y.row,y.col,!0);if(n.clearCustomFunctions(),C=o.customFunctions)for(w in C)v=C[w],(S=t.getTypeFromString(v.typeName))&&((x=new S).fromJSON(v,a),n._addCustomFunctionCore(x));if(R=o.sparklineExs)for(b=0;b<R.length;b++)T=o.sparklineExs[b],(A=t.getTypeFromString(T.typeName))&&((I=new A).fromJSON(T),n.addSparklineEx(I));if(d)for(D in _=0,d)"string"==typeof D&&(((M=(F=d[D]).index!==i?F.index:F._index)!=i?n.sheets[M]:n.sheets[_]).formulaFromJSON(F,a),_++);n.calcService&&(o.noRecalc?n.calcService.resumeWithoutCalc():n.calcService.resume(!0))}finally{e.Sheets.switchCulture(l),n._suspendSetFocus=!1,(E=n.getActiveSheet())&&t.FocusHelper.isActiveElement(E)&&E.setFocus(),n.resumeEvent(),n._doResize(),n.isPaintSuspended(s)}}},s.prototype._getJsonDataVersion=function(e){var t,o,n,r=e.version;if(!r||"string"!=typeof r||(!(t=r.split("."))||0===t.length))return 1;if(t.length>3)return 3;if(o=parseFloat(t[0]),t.length<=2)return isNaN(o)?1:o;if(n=parseFloat(t[1]),o>=3){if(n>=20143)return 3;if(n>=20142)return 2}return 1},s.prototype.setTabStripRatio=function(e,o){var n,r;if(isNaN(n=e))throw t.SR.Exp_InvalidArgument;var i=0,a=this._vp;a&&(r=t.GC$(a).width(),i=this._tab._resizeBarWidth/r),this._tabStripRatio=n<i?i:n>1?1:n,this._tabStripRatioUserSet=n<0?0:n>1?1:n,this._doTabHSResize()},s.prototype.getTabStripRatio=function(){return this._tabStripRatioUserSet},s.prototype._getActualTabStripRatio=function(){return this.showHorizontalScrollbar()?this._tabStripRatio:1},s.prototype._setActualTabStripRatio=function(e){this._tabStripRatio=e},s.prototype.showScrollTip=function(e){return 0===arguments.length?this._showScrollTip:(this._showScrollTip=e,this)},s.prototype.showResizeTip=function(e){return 0===arguments.length?this._showResizeTip:(this._showResizeTip=e,this)},s.prototype.showDragDropTip=function(e){return 0===arguments.length?!!t.util.hasCalc()&&this._showDragDropTip:(this._showDragDropTip=e,this)},s.prototype.showDragFillTip=function(e){return 0===arguments.length?!!t.features.fill&&this._showDragFillTip:(this._showDragFillTip=e,this)},s.prototype.grayAreaBackColor=function(e){var o,n;return 0===arguments.length?this._grayAreaBackColor?this._grayAreaBackColor:t.ThemeStyleHelper.getContentThemeStyle("gc-grayArea").backgroundColor:(o=this,(n=this.getActiveSheet())?n._bindToAutoRefresh(function(e){return o._grayAreaBackColor=e,o})(e):void(o._grayAreaBackColor=e))},s.prototype.backColor=function(e){if(0===arguments.length)return this._backColor;var t=this,o=this.getActiveSheet();if(o)return o._bindToAutoRefresh(function(e){return t._backColor=e,t})(e);t._backColor=e},s.prototype.backgroundImage=function(e){var t,o=this;return 0===arguments.length?o._backgroundImage:(t=o.getActiveSheet())?t._bindToAutoRefresh(function(e){return o._backgroundImage=e,o._paintSpreadBackgroundImage(),o})(e):(o._backgroundImage=e,o)},s.prototype.backgroundImageLayout=function(e){return 0===arguments.length?this._backgroundImageLayout:(this._backgroundImageLayout=e,this._paintSpreadBackgroundImage(),this)},s.prototype._findTable=function(e){var t,o,n,i;if(!this.sheets||0===this.sheets.length)return r;for(o=(t=this.sheets).length,n=0;n<o;n++)if(i=t[n].findTableByName(e))return i;return r},s.prototype.addSparklineEx=function(e){var t=this._sparklineExs;e&&t&&(t[e.name()]=e)},s.prototype.getSparklineEx=function(e){var t=this._sparklineExs;return t&&t[e]},s.prototype.removeSparklineEx=function(e){var t=this._sparklineExs;t&&(t[e]=i)},s.prototype.useTouchLayout=function(e){return 0===arguments.length?this._useTouchLayout:(this._useTouchLayout=e,this._doResize(),this)},s.prototype.focus=function(e){if(!1===e)t.FocusHelper.setActiveElement(r);else{var o=this.getActiveSheet();o&&o.setFocus()}},s.prototype.hideSelection=function(e){var o;return 0===arguments.length?this._hideSelection:(this._hideSelection=e,o=this.getActiveSheet(),e?t.FocusHelper.hideSelection(o):t.FocusHelper.showSelection(o),this)},s.prototype.nextControl=function(e){return 0===arguments.length?this._nextControl:(this._nextControl=e,this)},s.prototype.previousControl=function(e){return 0===arguments.length?this._previousControl:(this._previousControl=e,this)},s.prototype.resizeZeroIndicator=function(e){var t;return 0===arguments.length?this._resizeZeroIndicator:(this._resizeZeroIndicator!==e&&(this._resizeZeroIndicator=e,(t=this.getActiveSheet())&&t.invalidate()),this)},s.prototype._getScrollbarSize=function(){return this._themeVersion>2007?15:18},s.prototype._getVScrollbarContainerWidth=function(){return this._themeVersion>2007?22:this._getScrollbarSize()},s.prototype._getTabStripHeight=function(){return this._themeVersion>2007?28:this._getScrollbarSize()},s.prototype.suspendCalcService=function(e){this.calcService&&this.calcService.suspend(e)},s.prototype.resumeCalcService=function(e){this.calcService&&this.calcService.resume(e)},s.prototype.print=function(e){var t=this._getPrinter();t&&t.print(this,e)},s.prototype._getPrinter=function(){return!this._printer&&t.features.print&&(this._printer=new t.SpreadPrinter),this._printer},s.prototype._trigger=function(e,o){0===this._eventSuspended&&t.GC$(this._userEventsElem).trigger(e,o)},s.prototype.triggerSheetTabClick=function(e){this._trigger(t.Events.SheetTabClick,e)},s.prototype.triggerSheetTabDoubleClick=function(e){this._trigger(t.Events.SheetTabDoubleClick,e)},s.prototype.triggerActiveSheetChanging=function(e){this._trigger(t.Events.ActiveSheetChanging,e)},s.prototype.triggerActiveSheetChanged=function(e){this._trigger(t.Events.ActiveSheetChanged,e)},s.prototype.triggerButtonClicked=function(e){this._trigger(t.Events.ButtonClicked,e)},s}();t.Spread=S;var x=".gcTab",R=".tabNameEditor",b="mouse",T=b+"move.spliter",A=b+"up.spliter",I="keydown"+R,D="focusin"+R,F="focusout"+R,M=b+"down"+x,E=b+"move"+x,N=b+"up"+x,O=b+"out"+x,P="dblclick"+x,L="resizeBar",H="navButton",k="tab",V="newTab",B=function(){function e(e){this._reorderMaxDistance=10;var t=this;t._spread=r,t._activeIndex=0,t._firstTab=0,t._activePos=70,t._hoverNavButton=-1,t._hoverTab=-1,t._font="",t._tabSizes=[],t._targetTabIndex=-1,t._sourceTabIndex=-1,t._reorderSpeedTimeout=r,t._paintSuspended=!1,t._init(e)}return e.prototype._init=function(e){this.setBounds(new t.Rect(0,0,200,28)),this.name=e},e.prototype.setHost=function(e){var o=this,n=g.createElement("canvas");t.DPIHelper.adjustDevicePixel(n,o._spread),n.setAttribute("id",o.name),o._tabIndicator=o._getTabIndicator(),e.appendChild(o._tabIndicator.getElement(0)),e.appendChild(n),n.gcObject=!0,o.canvas&&(t.GC$(o.canvas).unbind(M).unbind(E).unbind(N).unbind(O).unbind(P),o._unbindTouchEvents(),o.canvas.parentNode.removeChild(o.canvas)),o.canvas=n,!t.util._isStandardCanvas()&&t.util._isSilverlightCanvas()&&(n.setAttribute("renderMethod","auto"),n.setAttribute("onload",o._test(o))),t.GC$(n).bind(M,t.util.createEventHandler(o,o.doMouseDown)).bind(E,t.util.createEventHandler(o,o.doMouseMove)).bind(N,t.util.createEventHandler(o,o.doMouseUp)).bind(O,t.util.createEventHandler(o,o.doMouseOut)).bind(P,t.util.createEventHandler(o,o.doMouseDbClick)),o._bindTouchEvents(),o.doResize()},e.prototype.dispose=function(){this._dispose()},e.prototype.setOwner=function(t){this._spread=t,t&&t._font&&t._font.length>0&&t._font!==e.defaultFont&&(this._font=t._font)},e.prototype.getBounds=function(){var e=this._bounds;return new t.Rect(e.x,e.y,e.width,e.height)},e.prototype.setBounds=function(e){var o=this._bounds=new t.Rect(0,0,0,0);o.x=e.x,o.y=e.y,o.width=e.width,o.height=e.height},e.prototype.getNewTabSize=function(){return this._newTabSize},e.prototype.getTabEndPosition=function(){var e=this.getBounds();return e.x+e.width-this._resizeBarWidth},e.prototype.getTabStartPosition=function(){return 0},e.prototype.doResize=function(){var e,o,n,r,i=this._getCanvas();i&&i.parentNode&&(0!==(e=t.GC$(i.parentNode)).width()&&0!==e.height())&&(o=s(e.width(),0),n=s(e.height(),0),i.style.display="none",i.width=o,i.height=n,i.style.display="",i.style.width=o+"px",i.style.height=n+"px",o=i.clientWidth||i.width,n=i.clientHeight||i.height,r=this.getBounds(),this.setBounds(new t.Rect(r.x,r.y,o,n)),t.DPIHelper.setSize(i,o,n),this.repaint())},e.prototype.isCoverSheetTab=function(){return!1},e.prototype.getCoverPosition=function(){return 0},e.prototype.getInputTopPosition=function(){return 0},e.prototype.getTabIndicatorEdgeElement=function(){return""},e.prototype.getBasicWidth=function(){return 0},e.prototype._test=function(e){return e._spread.initPaint(e._spread)},e.prototype._getTabIndicator=function(){return t.GC$(g.createElement("div")).css({position:"absolute","border-style":"solid","border-color":"black","border-width":4,display:"none",width:"0","border-bottom":"0","border-left-color":"transparent","border-right-color":"transparent"})},e.prototype._unbindTouchEvents=function(){this._touchManager&&this._touchManager.unbindTouchEvents()},e.prototype._bindTouchEvents=function(){if(t.features.touch){var e=new t.TabStripTouchManager(this.canvas,this,this._spread._touchEventProvider);e.bindTouchEvents(),this._touchManager=e}},e.prototype._dispose=function(){var e=this.canvas;e&&(t.GC$(e).unbind(M).unbind(E).unbind(N).unbind(P).unbind(O),e.parentNode&&e.parentNode.removeChild(e)),this._touchManager&&(this._touchManager.unbindTouchEvents(),this._touchManager=r),t.GC$(this._tabIndicator).remove(),this._spread=r},e.prototype.hitTest=function(e,t){return{element:""}},e.prototype.doMouseDown=function(e){var o,n,i,a=t.util.device();if(!(a.ipad||a.iphone)){if((o=this)._touchManager&&o._touchManager.preProcessMouseDown(e))return t.util.cancelDefault(e),!1;var s=t.GC$(o._getCanvas()).offset(),l=e.pageX-s.left,u=e.pageY-s.top,c=o._spread.getActiveSheet();if(o._tabNameEditor&&o.endSheetTabEditing(c,!1),n=o.hitTest(l,u),t.Events,0===e.button&&(n.element===L?(o.resizeTab=!0,o.activeX=e.pageX,o.handleDocumentMouseMove()):n.element===H?o.doNavButtonClick(n.index):n.element===k?(o.doSheetTabClick(n.index,n.position),o._initTabReorder(e,n)):n.element===V&&o.doNewTabClick(n.position),(i=(c=o._spread.getActiveSheet())&&c._eventHandler)&&!c.isEditing()))try{i._tabStripHitTestResult={left:e.pageX,top:e.pageY},c.setFocus()}finally{i._tabStripHitTestResult=r}return o._isMouseDownInTab=!0,!1}},e.prototype.doMouseMove=function(e){var o,n,r=t.util.device();if(!(r.ipad||r.iphone)){if((o=this)._touchManager&&o._touchManager.preProcessMouseMove(e))return t.util.cancelDefault(e),!1;if("default","w-resize",o._tabStartPos&&!o._reorderSheet&&(c(u(o._tabStartPos.x-e.pageX,2)+u(o._tabStartPos.y-e.pageY,2))>o._reorderMaxDistance&&(o._reorderSheet=!0)),o.resizeTab){o.canvas.style.cursor="w-resize";var i=e.pageX-o.activeX,a=o._spread._vp.clientWidth,s=o._spread;s.setTabStripRatio(s._getActualTabStripRatio()+i/a,!0),n=o._resizeBarWidth/a,1,s._getActualTabStripRatio()<n?(s.setTabStripRatio(n,!0),o.activeX=o._resizeBarWidth):s._getActualTabStripRatio()>=1?(s.setTabStripRatio(1,!0),o.activeX=a):o.activeX=e.pageX}else if(o._reorderSheet)o._showTabTip(e.pageX,e.pageY),o._setTabIndicator(e);else{o._hoverNavButton=-1,o._hoverTab=-1;var l=t.GC$(o._getCanvas()).offset(),h=e.pageX-l.left,p=e.pageY-l.top,d=o.hitTest(h,p);if(""===d.element)return o.canvas.style.cursor="default",o.repaint(),!1;d.element===L?o.canvas.style.cursor="w-resize":(o.canvas.style.cursor="default",d.element===H?o._hoverNavButton=d.index:d.element===k?o._hoverTab=d.index:d.element===V&&(o._hoverTab=-2)),o.repaint()}return!1}},e.prototype.doMouseUp=function(e){var o,n=t.util.device();if(!(n.ipad||n.iphone))return(o=this)._touchManager&&o._touchManager.preProcessMouseUp(e)?(t.util.cancelDefault(e),!1):(o.resizeTab&&(o.resizeTab=!1,o._spread._doTabHSResize()),o._clearSpeedTimeout(),o._reorderSheet&&(o._reorderSheet=!1,o._tabTip.remove(),o._reorderTab(),o._tabIndicator.hide()),o._tabStartPos=null,o._clearRepeatDown(),o.unhandleDocumentMouseMove(),!o._isMouseDownInTab||(o._isMouseDownInTab=!1,!1))},e.prototype.doMouseOut=function(e){var o,n,r=t.util.device();if(!(r.ipad||r.iphone))return this,this._clearRepeatDown(),o=this._hoverNavButton,this._hoverNavButton=-1,n=this._hoverTab,this._hoverTab=-1,(this._hoverNavButton!==o||this._hoverTab!==n)&&this.repaint(),!1},e.prototype.handleDocumentMouseMove=function(){var e,o=this;o._isCapture||(t.GC$(g).bind(T,function(e){o.doMouseMove(e)}).bind(A,function(e){o.doMouseUp(e)}),(e=o._spread.getActiveSheet())&&(e._continueMouseUpBubble=!0),o._isCapture=!0)},e.prototype.unhandleDocumentMouseMove=function(){if(this._isCapture){this._isCapture=!1,t.GC$(g).unbind(T).unbind(A);var e=this._spread.getActiveSheet();e&&delete e._continueMouseUpBubble}},e.prototype.doNavButtonClick=function(e,t){var o,n=this;if(n._clearRepeatDown(),!((o=n._getVisibleTabs()).length<=0))switch(200,e%=4){case 0:n._navigateToFirst(o);break;case 1:t||(n._repeatDown=window.setTimeout(function(){n.doNavButtonClick(1)},200)),n._navigateToPrevious(o);break;case 2:t||(n._repeatDown=window.setTimeout(function(){n.doNavButtonClick(2)},200)),n._navigateToNext(o);break;case 3:n._navigateToLast(o);break;default:return}},e.prototype.doSheetTabClick=function(e,o){var n,r,i,a=this;t.Events;a._activeIndex=e,a._activePos=o,n=a._spread.isPaintSuspended(),a._spread.isPaintSuspended(!0),r=a._spread.getActiveSheet(),(i=a._spread.getSheet(e))&&i.isEditing()&&i!==r&&!i.endEdit()||(a._spread.triggerSheetTabClick({sheet:i,sheetName:i._name,sheetTabIndex:e}),a._doSheetTabClickChange(e),a._spread.isPaintSuspended(n),a.repaint())},e.prototype.doNewTabClick=function(e){var o,n,i,a=this,s=(t.Events,a._spread),l=s.getActiveSheet();if((!l||!l._formulaTextBox||!l._formulaTextBox.canAppendRange())&&(s.triggerSheetTabClick({sheet:r,sheetName:r,sheetTabIndex:-1}),o=s.sheets.length,n=s._createSheet(s._getDefaultSheetName(o)),s._addSheetImp(o,1,n),a._activeIndex=o,a._activePos=e,i={oldSheet:l,newSheet:n,cancel:!1},s.triggerActiveSheetChanging(i),i&&!1===i.cancel)){for(s._setActiveSheetIndexImp(o,1),s.triggerActiveSheetChanged({oldSheet:l,newSheet:n});a._activeIndex>a._firstTab&&a.isCoverSheetTab();)s.sheets[a._firstTab].visible()&&(a._activePos-=a._tabSizes[a._firstTab]),a._firstTab++;a.repaint()}},e.prototype._doSheetTabClickChange=function(e,o){var n,r;void 0===o&&(o=!0);var i=this,a=(t.Events,i._spread.getSheet(e)),s=i._spread.getActiveSheet();e!==i._spread._activeSheetIndex&&(n={oldSheet:s,newSheet:a,cancel:!1},i._spread.triggerActiveSheetChanging(n),n&&!1===n.cancel&&(i._spread._setActiveSheetIndexImp(e,1),this._spread.triggerActiveSheetChanged({oldSheet:s,newSheet:a}),r=i._getNextVisibleIndex(i._firstTab),i._activeIndex>i._firstTab&&i._activePos+i._tabSizes[i._activeIndex]>i.getCoverPosition()&&-1!=r&&(i._firstTab=r))),i._activeIndex<i._firstTab&&(i._firstTab=i._getPreVisibleIndex(i._firstTab))},e.prototype._doMouseDbClickImp=function(e,o){var n,i,a,s=this;if(s.hitTest(e,o).element===k){if(n=s._activeIndex,i=s._spread.sheets[n],s._spread.triggerSheetTabDoubleClick({sheet:i,sheetName:i._name,sheetTabIndex:n}),!s._spread._tabEditable)return!1;if((a=t.FocusHelper.getActiveElement())&&a.endEdit&&!a.endEdit())return;t.FocusHelper.setActiveElement(r);var l=s._tabSizes[n],u=t.GC$(s._getCanvas()).offset(),c=g.createElement("input"),h=c.style;c.type="text",c.value=i._name,c.setAttribute("contentEditable","true"),c.setAttribute("autocomplete","off"),h.position="absolute",h.margin="0",h.padding="0",h.margin="0",h.left=u.left+s._activePos+s._tabLeftPadding+m,h.top=u.top+s.getInputTopPosition()+m,h.width=l-s._tabLeftPadding-s._tabRightPadding+2+m,h.backgroundColor="white",h.borderWidth="0px",h.outline="none",g.body.insertBefore(c,r),s._tabNameEditor=c,t.GC$(c).addClass("sheetTabEditor").bind(I,function(e){return 13===e.keyCode?(s.endSheetTabEditing(i,!1),!1):27===e.keyCode?(s.endSheetTabEditing(i,!0),!1):void 0}).bind(D,function(e){c.selectionStart=0,c.selectionEnd=c.value.length}).bind(F,function(e){s.endSheetTabEditing(i,!1)}),c.focus()}return!1},e.prototype.doMouseDbClick=function(e){var o,n,r=t.util.device(),i=r.ipad||r.iphone;if(!i&&!(o=this._spread.getActiveSheet())._isTouchMode){if(i=o._formulaTextBox&&o._formulaTextBox.canAppendRange(),n=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,i)return;n&&n.dom&&n.clear();var a=t.GC$(this._getCanvas()).offset(),s=e.pageX-a.left,l=e.pageY-a.top;return this._doMouseDbClickImp(s,l)}},e.prototype.endSheetTabEditing=function(e,o){var n,a,s,l,u;this._tabNameEditor&&(t.GC$(this._tabNameEditor).unbind(I).unbind(D).unbind(F),n=this._tabNameEditor.value,!1===o&&(n!==(a=e.getName())&&(n!==i&&n!==r&&""!==n&&this._isValidSheetName(n)?(s={sheet:e,oldValue:a,newValue:n,cancel:!1},e.triggerSheetNameChanging(s),s&&!1===s.cancel&&(l=new t.UndoRedo.SheetRenameUndoAction(e,n),e._doCommand(l),u={sheet:e,oldValue:a,newValue:n},e.triggerSheetNameChanged(u))):e.triggerInvalidOperation({sheet:e,sheetName:e.getName(),invalidType:5,message:t.SR.Exp_SheetNameInvalid}))),this._tabNameEditor.parentNode.removeChild(this._tabNameEditor),delete this._tabNameEditor)},e.prototype._isValidSheetName=function(e){var t,o,n;if(e===i||e===r||""===e)return!1;for(n=0;n<e.length;n++)if("*"===(t=e.charAt(n))||":"===t||"["===t||"]"===t||"?"===t||"\\"===t||"/"===t)return!1;for(o=this._spread.sheets.length,n=0;n<o;n++)if(e===this._spread.sheets[n]._name)return!1;return!0},e.prototype._initTabReorder=function(e,o){var n=this._spread,r=n&&n.getActiveSheet(),i=r&&r._formulaTextBox,a=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance,s=t.features.formulatextbox&&a&&a.text;!this._spread._allowSheetReorder||s||i?this._reorderSheet=!1:(this._sourceTabIndex=o.index,this._tabTip=this._getTabTip(this._sourceTabIndex),this._tabStartPos=new t.Point(e.pageX,e.pageY),this.handleDocumentMouseMove())},e.prototype._getTabTip=function(e){var o,n,r=this._spread.sheets;if(!(e>=r.length||e<0))return(o=r[e]._name)||(o="sheet"),(n=t.GC$(g.createElement("span")).text(o).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header tab-tip-span btn-primary"),n},e.prototype._clearRepeatDown=function(){this._repeatDown&&(window.clearTimeout(this._repeatDown),this._repeatDown=r)},e.prototype._showTabTip=function(e,o){var n,r;this._tabTip&&0===t.GC$(".tab-tip-span").length()&&(this._tabTip.appendTo(g.body),this._tabTip.hide()),n=this._tabTip.width(),r=this._tabTip.height(),this._tabTip.css({left:e-n/2,top:o-r/2}),this._tabTip.show()},e.prototype._setTabIndicator=function(e){var o=this,n=t.GC$(o._getCanvas()),i=n.position(),a=n.offset(),s=e.pageX-a.left,l=e.pageY-a.top,u=o.hitTest(s,l),c=o.getBounds(),h=o.getTabStartPosition(),p=o._spread.sheets.length;s>c.x+o.getCoverPosition()?o._reorderSpeedTimeout===r&&o._targetTabIndex<p&&(o._reorderSpeedTimeout=setInterval(function(){o._navigateToNext(o._getVisibleTabs()),o._targetTabIndex===p?(o._clearSpeedTimeout(),o._tabIndicator.css({left:i.left+o._getLastTabPos()-4,top:i.top-4}),o._tabIndicator.show()):(o._targetTabIndex++,o._tabIndicator.hide())},100)):s<h?o._reorderSpeedTimeout===r&&o._targetTabIndex>0&&(o._reorderSpeedTimeout=setInterval(function(){o._navigateToPrevious(o._getVisibleTabs()),0===o._targetTabIndex?(o._clearSpeedTimeout(),o._tabIndicator.css({left:i.left+h-4,top:i.top-4}),o._tabIndicator.show()):(o._targetTabIndex--,o._tabIndicator.hide())},100)):(o._clearSpeedTimeout(),(u.element===k||u.element===o.getTabIndicatorEdgeElement())&&(o._targetTabIndex=u.element===k&&typeof u.index!==f?u.index:o._spread.sheets.length,o._tabIndicator.css({left:i.left+u.position-4,top:i.top-4}),o._tabIndicator.show()))},e.prototype._getLastTabPos=function(){for(var e=this._tabSizes,t=this._getVisibleTabs(),o=this._getVisibleTabIndex(this._firstTab,t),n=(this.getBounds().height,this.getTabStartPosition()+this._firstTabSpace),r=o;r<t.length;r++)n+=e[t[r]],n+=this._tabSpace;return n},e.prototype._clearSpeedTimeout=function(){this._reorderSpeedTimeout!==r&&(window.clearInterval(this._reorderSpeedTimeout),this._reorderSpeedTimeout=r)},e.prototype._reorderTab=function(){var e,t,o,n=this._targetTabIndex,r=this._sourceTabIndex,i=-1;if(-1!==n&&-1!==r&&r!==n&&r!==n-1&&this._tabIndicator.isVisible()){if(t=(e=this._spread.sheets)[r],r>n){for(o=r;o>n;o--)e[o]=e[o-1];e[n]=t,i=n}else if(r<n-1){for(o=r;o<n-1;o++)e[o]=e[o+1];e[n-1]=t,i=n-1}this._spread._activeSheetIndex=i,this.doResize()}},e.prototype._getVisibleTabs=function(){for(var e=[],t=0;t<this._spread.sheets.length;t++)this._tabVisible(t)&&e.push(t);return e},e.prototype._navigateToFirst=function(e){e.length<=0||this._firstTab!=e[0]&&this._spread.startSheetIndex(e[0])},e.prototype._navigateToPrevious=function(e){var t;e.length<=0||(this,this._firstTab>e[0]&&(-1!==(t=this._getPreVisibleIndex(this._firstTab))&&this._spread.startSheetIndex(t)))},e.prototype._navigateToNext=function(e){e.length<=0||(this,this._firstTab<e[e.length-1]&&(-1!==this._reCalculateFirstTabIndex(e)&&this._spread.startSheetIndex(this._getNextVisibleIndex(this._firstTab))))},e.prototype._navigateToLast=function(e){if(!(e.length<=0)&&this._firstTab<e[e.length-1]){var t=this._reCalculateFirstTabIndex(e);-1!==t&&this._spread.startSheetIndex(t)}},e.prototype._reCalculateFirstTabIndex=function(e){var t,o;if(e.length<=0)return-1;var n,r=this.getBounds(),i=this.getCoverPosition(),a=0,s=this._tabSizes,l=(r.height,this.getBasicWidth()),u=this._getVisibleTabIndex(this._firstTab,e);for(-1===u&&(u=0),n=e.length-1;n>=u;n--)if(a+=s[e[n]],n!==e.length-1&&(a+=this._tabSpace),t=l+a,0!==n&&(t+=this._firstTabSpace),t>i)return o=n+1<e.length?e[n+1]:e[e.length-1],this._firstTab<o?o:-1;return-1},e.prototype._getPreVisibleIndex=function(e){this._spread.sheets.length;for(var t=e-1;t>=0;t--)if(this._tabVisible(t))return t;return-1},e.prototype._getNextVisibleIndex=function(e){for(var t=this._spread.sheets.length,o=e+1;o<t;o++)if(this._tabVisible(o))return o;return-1},e.prototype._getVisibleTabIndex=function(e,t){for(var o=0;o<=t.length-1;o++)if(e===t[o])return o;return-1},e.prototype._tabVisible=function(e){return this._spread.sheets[e].visible()},e.prototype.isPaintSuspended=function(e){return 0===arguments.length?this._paintSuspended:(this._paintSuspended!==e&&(this._paintSuspended=e,e||this.repaint()),this)},e.prototype.repaint=function(e){var o=this._getCanvas();if(o){if(!o.getContext&&t.util._isSilverlightCanvas()&&!o.getContext)return;o.getContext||typeof window.FlashCanvas===f||window.FlashCanvas.initElement(o),o.getContext&&this.paint(o.getContext("2d"),e)}},e.prototype.paint=function(e,o){var n,i,a,u,c,h,p=this;if(!p._paintSuspended){if(n=p.getBounds(),i=p.canvas,o){if(o.x>=n.x+n.width)return;if(o.y>=n.y+n.height)return;if(o.x+o.width>n.width&&(o.width=n.width-o.x,o.width<=0))return;if(o.y+o.height>n.height&&(o.height=n.height-o.y,o.height<=0))return;if(o.width<=0||o.height<=0)return}if((u=t.util._useDoubleBuffer())&&((c=p.buffer)&&(!c||c.width===i.width&&c.height===i.height)&&(c||c.width===n.width&&c.height===n.height)||(c&&t.DPIHelper.disposeCanvasForSpread(p._spread,c),p.buffer=c=g.createElement("canvas"),t.DPIHelper.adjustDevicePixel(c,p._spread),t.DPIHelper.setSize(c,n.width,n.height)),!c.getContext))if(t.util._isSilverlightCanvas()){if(!c.getContext)return}else if(typeof window.FlashCanvas!==f&&(h=p._getCanvas(),window.FlashCanvas.initElement(h),!c.getContext))return;if(!(n.width<=0)&&!(n.height<=0)&&(!o||!(o.width<=0||o.height<=0))&&((a=u?p.buffer.getContext("2d"):e).clearRect(0,0,n.width,n.height),a.translate(-n.x,-n.y),p.paintTabs(a,o),a.translate(n.x,n.y),u)){var d,m,_=n.x>=0?0:-n.x,y=n.y>=0?0:-n.y,C=_,w=y;o&&(C=n.x+o.x,w=n.y+o.y,n=new t.Rect(C,w,o.width,o.height)),_=n.x>=0?n.x:0,y=n.y>=0?n.y:0;var v=r,S=t.DPIHelper.getScaleX(i),x=t.DPIHelper.getScaleY(i);i&&1!==S&&(C*=S,w*=x,n.x*=S,n.y*=x,n.width*=S,n.height*=x);try{i?o?(d=s(n.width-C,0),m=s(n.height-w,0)):(d=l(n.width-C,s(i.width-n.x,3)),m=l(n.height-w,s(i.height-n.y,3))):(C=o.x,w=o.y,d=o.width,m=o.height),i?(e.scale(1/S,1/x),e.drawImage(p.buffer,C,w,d,m,_,y,d,m),e.scale(S,x)):v=(a=p.buffer.getContext("2d")).getImageData(C,w,d,m)}catch(e){return}!i&&v&&n.width>0&&n.height>0&&e.putImageData(v,_,y)}}},e.prototype.paintTabs=function(e,o){var n,r,i,s,l,u,c=this,h=c._spread;if(e&&h){n=c.getBounds(),e.save(),e.font=c._font,o?e.rect(o.x,o.y,o.width,o.height):e.rect(n.x,n.y,n.width,n.height),e.clip(),e.beginPath();var p=60,d=c.getTabStartPosition(),f=d;for(e.save(),e.font=t.StyleHelper.setStringFont(e.font,{fontWeight:"bold"}),c._tabSizes=[],i=h.sheets,r=0;r<i.length;r++)p=a(e.measureText(i[r]._name).width)+c._tabRightPadding+c._tabLeftPadding,c._tabSizes.push(p);if(e.restore(),s=[],(l=c._firstTab)>0&&c._getPreVisibleIndex(l)>=0&&(f+=c._firstTabSpace),l>=0)for(r=l;r<i.length&&(u=i[r].visible(),p=c._tabSizes[r],!(f>n.x+n.width));r++)s.push({i:r,x:f,w:p,t:i[r]._name,visible:u}),u&&(f+=p+c._tabSpace);c.paintBackground(e,n),c.paintNewSheetTab(e,n,f,d),c.paintTab(e,n,s,l,d),c._spread&&c._spread.tabNavigationVisible()&&c.paintNavigationButtons(e,n,d),c.paintResizeBar(e,n),e.beginPath(),e.restore()}},e.prototype.paintBackground=function(e,t){},e.prototype.paintNewSheetTab=function(e,t,o,n){},e.prototype.paintTab=function(e,t,o,n,r){var i,a,s,l,u,c=this._spread,h=c.sheets,p=this._hoverTab;if(this._activeIndex=c.getActiveSheetIndex(),i=this._activeIndex,h.length>0){for(e.save(),e.beginPath(),a=t.x+this.getCoverPosition(),e.rect(r,0,a-r,t.height),e.clip(),s=o.length-1;s>=0;s--)(l=o[s]).i!==i&&l.visible&&this.drawTab(e,l.x,0,l.w,t.height,5,!1,l.i===p,l.t);u=o[i-n],i>=n&&i<h.length&&u&&u.visible&&this.drawTab(e,u.x,0,u.w,t.height,5,!0,!1,u.t),e.restore(),e.save(),e.beginPath(),n>0&&this._getPreVisibleIndex(n)>=0&&this.paintTabBeforeFirstTab(e,t,n,r),e.restore()}},e.prototype.paintTabBeforeFirstTab=function(e,t,o,n){},e.prototype.paintNavigationButtons=function(e,t,o){},e.prototype.paintResizeBar=function(e,t){},e.prototype.drawNavButton=function(e,t,o,n,r,i,a,s,l,u){},e.prototype.drawTab=function(e,t,o,n,r,i,a,s,l){},e.prototype._getCanvas=function(){var e=this.canvas;return e&&!e.getContext&&e.firstChild&&(e.getContext=e.firstChild.getContext),e},e.prototype._getTabStripBackColor=function(e,o){var n,r,i,a,s=e.createLinearGradient(o.x,o.y,o.width,o.height),l=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripBackground"),u=l&&l.backgroundImage,c=l&&l.backgroundColor;if(u&&-1!==u.indexOf("linear-gradient"))for(r=0,i=(n=t.util.getLinearGradientColors(u)).length;r<i;r++)a=n[r],s.addColorStop(a.point,a.color);else c&&(s.addColorStop(0,"#DDDDDD"),s.addColorStop(1,c));return s},e.prototype._getTabBackColor=function(e,o,n,r){var i,a,s,l,u,c,h,p=this.getBounds(),d=e.createLinearGradient(p.x+.7*p.height,p.y+0,.7*p.height,p.height),f=this._spread.getSheetFromName(n);if(""===n&&this._firstTab>0&&(f=this._spread.getSheet(this._firstTab-1)),f&&f._sheetTabColor)i="rgba(0, 0, 0, 0)",e.fillStyle=i,e.fillStyle=t._ThemeContext.getColor(f,f._sheetTabColor),(h=e.fillStyle)!==i&&(o?(d.addColorStop(0,"#FFFFFF"),d.addColorStop(.45,"#F1F6FD"),d.addColorStop(.9,h),d.addColorStop(1,"#FFFFFF")):d=h);else if(r)if(a=r&&r.backgroundImage,s=r&&r.backgroundColor,a&&-1!==a.indexOf("linear-gradient"))for(u=0,c=(l=t.util.getLinearGradientColors(a)).length;u<c;u++)h=l[u],d.addColorStop(h.point,h.color);else s&&d.addColorStop(0,s);return d},e.prototype._getTabForeColor=function(e,o){var n,r="black";return e&&(r=e.color),o&&((n=t._Color.parse(o))&&n.getBrightness()<127.5&&(r="white")),r},e.defaultFont="10pt Arial",e}();t._GcTabBase=B,o=function(e){function o(t){e.call(this,t);this._tabLeftPadding=12,this._tabRightPadding=8,this._tabSpace=3,this._resizeBarWidth=12,this._newTabSize=48,this._firstTabSpace=5,this._font="10pt Arial"}return __extends(o,e),o.prototype._getNavigationButtonWidth=function(){var e=this._spread;return e&&e.tabNavigationVisible()?(0,e.useTouchLayout()?2*e._getScrollbarSize():e._getScrollbarSize()):0},o.prototype._getNavigationButtonHeight=function(){var e=this._spread;return e&&e.tabNavigationVisible()?e._getScrollbarSize():0},o.prototype.getTabStartPosition=function(){return 4*this._getNavigationButtonWidth()+this._getTabMarginLeft()},o.prototype._getTabMarginLeft=function(){var e=this._spread;return e&&e.tabNavigationVisible()?2:0},o.prototype.hitTest=function(e,t){var o,n,r=this,i=r.getBounds();if(i.x+i.width-r._resizeBarWidth<e&&e<i.x+i.width&&r._spread.showHorizontalScrollbar())return{element:L};var a,s=-1,l=0,u=r._getNavigationButtonWidth();for(0,4,a=0;a<4;a++){if(l<e&&e<l+u){s=a;break}l+=u}if(-1!==s)return{element:H,index:a};if(l=r.getTabStartPosition(),-1!==(o=r._getPreVisibleIndex(r._firstTab))){if(l<e&&e<l+r._firstTabSpace+r._tabSpace)return{element:k,index:o,position:l};l+=r._firstTabSpace}if(n=0,r._firstTab>-1)for(a=r._firstTab;a<r._spread.sheets.length&&a<r._tabSizes.length;a++)if(r._spread.sheets[a].visible()){if(n=r._tabSizes[a],l<e&&e<l+n+r._tabSpace)return{element:k,index:a,position:l};l+=n+r._tabSpace}return r._spread._newTabVisible&&e>l&&e<l+r.getNewTabSize()?{element:V,position:l}:{element:""}},o.prototype.isCoverSheetTab=function(){return this._activePos+this._tabSizes[this._activeIndex]+this.getNewTabSize()>this.getCoverPosition()},o.prototype.getCoverPosition=function(){return this.getBounds().width-this._resizeBarWidth},o.prototype.getInputTopPosition=function(){return 1},o.prototype.getTabIndicatorEdgeElement=function(){return V},o.prototype.getBasicWidth=function(){var e=this.getBounds().height,t=this.getTabStartPosition()+e;return this._spread._newTabVisible&&(t+=this.getNewTabSize(),t+=this._tabSpace),t},o.prototype.paintBackground=function(e,o){var n,r,i,a;e.save(),e.beginPath();var s=e.createLinearGradient(o.x,o.y,o.width,o.height),l=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripBackground"),u=l&&l.backgroundImage,c=l&&l.backgroundColor;if(u&&-1!==u.indexOf("linear-gradient"))for(r=0,i=(n=t.util.getLinearGradientColors(u)).length;r<i;r++)a=n[r],s.addColorStop(a.point,a.color);else c&&(s.addColorStop(0,"#DDDDDD"),s.addColorStop(1,c));e.fillStyle=s,e.fillRect(o.x,o.y,o.width,o.height),e.restore()},o.prototype.paintNewSheetTab=function(e,o,n,r){this._spread._newTabVisible&&(this._newTabSize=e.measureText(t.SR.NewTab).width+this._tabLeftPadding,this.drawTab(e,n,0,this.getNewTabSize(),o.height,5,!1,-2===this._hoverTab,t.SR.NewTab))},o.prototype.paintTabBeforeFirstTab=function(e,t,o,n){var r=o-1,i=this._tabSizes[r];this.drawTab(e,n+this._firstTabSpace-i-this._tabSpace,0,i,t.height,5,this._activeIndex===r,this._hoverTab===r,"")},o.prototype.paintNavigationButtons=function(e,t,o){e.fillStyle="#92A5C7",e.fillRect(t.x,t.y,o-1,t.height);var n=this._getNavigationButtonWidth(),i=n/2,a=this._getNavigationButtonHeight()/2,s=this._hoverNavButton;this.drawNavButton(e,i,a,i+5,a+5,i+5,a-5,!0,i-5,0===s),i+=n,this.drawNavButton(e,i,a,i+5,a+5,i+5,a-5,!0,r,1===s),i+=n,this.drawNavButton(e,i,a,i-5,a+5,i-5,a-5,!1,r,2===s),i+=n,this.drawNavButton(e,i,a,i-5,a+5,i-5,a-5,!1,i+4,3===s)},o.prototype.paintResizeBar=function(e,o){var n,r=this._spread,i=this._resizeBarWidth,a=t.ThemeStyleHelper.getVisualStateThemeStyle,s=a(4,"gc-tabStripResizeBarInner"),l=a(0,"gc-tabStripResizeBarOuter");r.showHorizontalScrollbar()&&(n=o.x+o.width-i,e.fillStyle=l.backgroundColor,e.fillRect(n,o.y,i,o.height),e.fillStyle=s.backgroundColor,e.fillRect(n+1,o.y+1,i-2,o.height-2),e.fillStyle=s.color,e.fillRect(n+i/2-1,o.y+4,2,o.height-8))},o.prototype.drawTab=function(e,o,n,r,i,a,s,l,u){var c,h,p,d,f;e.save(),e.beginPath(),e.moveTo(o,n),e.lineTo(o,n+i-a),e.arcTo(o,n+i,o+r,n+i,a),e.lineTo(o+r,n+i),e.lineTo(o+r+i,n),s||e.lineTo(o,n),c=0,(s||l)&&(c=4),h=t.ThemeStyleHelper.getVisualStateThemeStyle(c,"gc-tab-"+t.VisualState[c].toLowerCase()),p=this._getTabBackColor(e,s||l,u,h),e.fillStyle=p,e.fill(),e.strokeStyle="#92A5C7",e.stroke(),e.textBaseline="top","string"==typeof p&&(d=p),e.fillStyle=this._getTabForeColor(h,d),f=this._tabLeftPadding,e.textBaseline="middle",e.fillText(u,o+f,n+i/2),e.restore()},o.prototype.drawNavButton=function(e,o,n,a,u,c,h,p,d,f){var g,m,_,y,C,w;e.save();var v=this.getBounds(),S=this._getNavigationButtonWidth(),x=t.ThemeStyleHelper.getVisualStateThemeStyle,R=x(4,"gc-navButton-hover"),b=x(0,"gc-navButton-normal"),T=b&&b.backgroundColor;if(f)e.fillStyle=R.backgroundColor,e.fillRect(o-S/2+2,v.y+2,S-4,v.height-4);else{if((g=b&&b.backgroundImage)&&-1!==g.indexOf("linear-gradient")){for(m=e.createLinearGradient(v.x+.7*v.height,v.y+0,.7*v.height,v.height),y=0,C=(_=t.util.getLinearGradientColors(g)).length;y<C;y++)w=_[y],m.addColorStop(w.point,w.color);e.fillStyle=m}else T&&(e.fillStyle=T);e.fillRect(o-S/2,v.y+1,S,v.height-2)}e.fillStyle=f?R.color:b.color,d!==i&&d!==r&&e.fillRect(d,l(u,h),1,s(u,h)-l(u,h)),p?(o-=2,a-=2,c-=2):(o+=2,a+=2,c+=2),e.beginPath(),e.moveTo(o,n),e.lineTo(a,u),e.lineTo(c,h),e.lineTo(o,n),e.fill(),e.restore()},o}(B),n=function(e){function o(t){e.call(this,t);this._tabLeftPadding=13,this._tabRightPadding=12,this._tabSpace=0,this._resizeBarWidth=30,this._itemWidth=28,this._moreTabWidth=28,this._newTabSize=28,this._firstTabSpace=0,this._font="10pt Segoe UI"}return __extends(o,e),o.prototype._getNavigationButtonWidth=function(){var e=this._spread;return e&&e.tabNavigationVisible()?this._itemWidth:0},o.prototype._getNavigationButtonHeight=function(){var e=this._spread;return e&&e.tabNavigationVisible()?e._getTabStripHeight():0},o.prototype._getFirstMoreTabWidth=function(){return this._moreTabWidth},o.prototype._getSecondMoreTabWidth=function(){return this._hideNewTabSecondMoreTab?0:this._moreTabWidth},o.prototype.getNewTabSize=function(){return this._hideNewTabSecondMoreTab?0:this._newTabSize},o.prototype.getTabEndPosition=function(){for(var e=this._spread.sheets,t=this.getTabStartPosition(),o=this._tabSizes,n=this.getBounds(),r=n.x+n.width-this._resizeBarWidth-this.getNewTabSize()-this._getSecondMoreTabWidth(),i=this._firstTab,a=e.length;i<a;i++)if(e[i].visible()&&(t+=o[i]),t>r){t=r;break}return t},o.prototype.getTabStartPosition=function(){return 2*this._getNavigationButtonWidth()+this._getFirstMoreTabWidth()+this._getNavigationMarginLeft()},o.prototype._getNavigationMarginLeft=function(){var e=this._spread;return e&&e.tabNavigationVisible()?this._resizeBarWidth/2:0},o.prototype.hitTest=function(e,t){var o,n,r=this,i=r._getFirstMoreTabWidth(),a=r._getSecondMoreTabWidth(),s=r.getBounds();if(s.x+s.width-r._resizeBarWidth<e&&e<s.x+s.width&&r._spread.showHorizontalScrollbar())return{element:L};var l,u=-1,c=r._resizeBarWidth/2,h=r._getNavigationButtonWidth();for(1,3,l=1;l<3;l++){if(c<e&&e<c+h){u=l;break}c+=h}if(-1!==u)return{element:H,index:l};if((c=r.getTabStartPosition())-i<=e&&e<c)return{element:H,index:5,position:c};if(o=0,n=s.x+s.width-r._resizeBarWidth-r.getNewTabSize()-a,r._firstTab>-1)for(l=r._firstTab;l<r._spread.sheets.length&&l<r._tabSizes.length;l++)if(r._spread.sheets[l].visible()){if(o=r._tabSizes[l],e<n&&c<e&&e<c+o+r._tabSpace)return{element:k,index:l,position:c};c+=o+r._tabSpace}return c>n&&(c=n),c<e&&e<c+a?{element:H,index:6,position:c}:(c+=a,r._spread._newTabVisible&&c<e&&e<c+r.getNewTabSize()?{element:V,position:c}:{element:""})},o.prototype.isCoverSheetTab=function(){return this._activePos+this._tabSizes[this._activeIndex]>this.getCoverPosition()},o.prototype.getCoverPosition=function(){return this.getBounds().width-this._resizeBarWidth-this.getNewTabSize()-this._getSecondMoreTabWidth()},o.prototype.getInputTopPosition=function(){return 6},o.prototype.getTabIndicatorEdgeElement=function(){return H},o.prototype.getBasicWidth=function(){return this.getTabStartPosition()},o.prototype.paintBackground=function(e,o){e.save(),e.beginPath();var n=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripBackground");this._backgroundColor=t._Color.parse(n.backgroundColor),e.fillStyle=n.backgroundColor,e.fillRect(o.x,o.y,o.width,o.height),e.beginPath(),e.strokeStyle=n.borderTopColor,e.moveTo(o.x,o.y+.5),e.lineTo(o.x+o.width,o.y+.5),e.stroke(),e.restore()},o.prototype.paintNewSheetTab=function(e,t,o,n){var r,i,a=this._spread,s=this._itemWidth,l=this._getSecondMoreTabWidth();o+=l,this._newTabSize=a._newTabVisible?s:0,o>(r=t.x+t.width-this._resizeBarWidth-this.getNewTabSize())&&(o=r,(i=r-l)<n&&(o=(i=n)+s),this.drawMoreTab(e,i,0,l,t.height)),a._newTabVisible&&this.drawNewSheetTab(e,o,0,s,t.height,-2===this._hoverTab)},o.prototype.paintTabBeforeFirstTab=function(e,t,o,n){var r=this._getFirstMoreTabWidth();this.drawMoreTab(e,n-r,0,r,t.height)},o.prototype.paintNavigationButtons=function(e,t,o){var n=this._getNavigationButtonWidth(),i=this._getNavigationButtonHeight(),a=this._resizeBarWidth/2+n/2,s=i/2,l=this._hoverNavButton;this.drawNavButton(e,a,s,a+5,s+5,a+5,s-5,!0,r,1===l),a+=n,this.drawNavButton(e,a,s,a-5,s+5,a-5,s-5,!1,r,2===l)},o.prototype.paintResizeBar=function(e,o){var n,r,i=this._spread,a=this._resizeBarWidth,s=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tabStripResizeBarInner");i.showHorizontalScrollbar()&&(e.beginPath(),e.rect(o.x+o.width-a,0,a,o.height),e.clip(),this.paintBackground(e,this.getBounds()),n=o.x+o.width-a/2,r=o.y+o.height/2,e.fillStyle=s.color,e.fillRect(n,r,2,2),e.fillRect(n,r-4,2,2),e.fillRect(n,r+4,2,2))},o.prototype.drawTab=function(e,o,n,r,i,a,s,l,u){var c,h,p,d,f,g=0;l&&(g=4),s&&(g=3),c=t.ThemeStyleHelper.getVisualStateThemeStyle(g,"gc-tab-"+t.VisualState[g].toLowerCase()),h=t.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-tab-"+t.VisualState[0].toLowerCase()),e.save(),s&&(e.fillStyle="white",e.fillRect(o,n,r,i-4)),p=this._getTabBackColor(e,s,u,c),e.fillStyle=p,e.fillRect(o+3,n+3,r-6+1,i-6),e.beginPath(),e.lineWidth=1,e.strokeStyle=h&&h.borderLeftColor,s?(e.moveTo(o+.5,n),e.lineTo(o+.5,n+i-4),e.moveTo(o+r+.5,n),e.lineTo(o+r+.5,n+i-4)):(e.moveTo(o+.5,n+4),e.lineTo(o+.5,n+i-4),e.moveTo(o+r+.5,n+4),e.lineTo(o+r+.5,n+i-4)),e.stroke(),s&&(e.beginPath(),e.strokeStyle=c&&c.borderBottomColor,e.lineWidth=2,e.moveTo(o,n+i-4),e.lineTo(o+r+1,n+i-4),e.stroke()),e.textBaseline="top","string"==typeof p&&(d=p),e.fillStyle=this._getTabForeColor(c,d),(l||s)&&(e.font=t.StyleHelper.setStringFont(e.font,{fontWeight:"bold"})),f=this._tabLeftPadding,e.textBaseline="middle",e.fillText(u,o+f,n+i/2-1),e.restore()},o.prototype.drawNavButton=function(e,o,n,r,i,a,s,l,u,c){var h,p,d;e.save(),h=1,c&&(h=4),l?(o-=2,r-=2,2,-1===this._getPreVisibleIndex(this._firstTab)&&(h=0)):(o+=2,r+=2,2,-1===this._reCalculateFirstTabIndex(this._getVisibleTabs())&&(h=0)),p=t.ThemeStyleHelper.getVisualStateThemeStyle(h,"gc-navButton-"+t.VisualState[h].toLowerCase()),e.strokeStyle=this.getVisibleForeColor(p.borderTopColor),e.beginPath(),d=1,o>r&&(d=-1),e.moveTo(o-.5,n),e.lineTo(o-.5,n+1),e.moveTo(o+1*d-.5,n-1),e.lineTo(o+1*d-.5,n+2),e.moveTo(o+2*d-.5,n-2),e.lineTo(o+2*d-.5,n+3),e.moveTo(o+3*d-.5,n-3),e.lineTo(o+3*d-.5,n+4),e.stroke(),e.restore()},o.prototype.drawNewSheetTab=function(e,o,n,r,i,a){var s,l,u;e.save(),e.beginPath(),s=(i-14)/2,l=1,a&&(l=4),u=t.ThemeStyleHelper.getVisualStateThemeStyle(l,"gc-tabStripNewTab-"+t.VisualState[l].toLowerCase()),e.lineWidth=1.5,e.strokeStyle=this.getVisibleForeColor(u.borderTopColor),e.arc(o+r/2,n+i/2,s,0,2*Math.PI),e.stroke(),e.beginPath(),e.lineWidth=2,e.moveTo(o+r/2-4,n+i/2),e.lineTo(o+r/2+4,n+i/2),e.moveTo(o+r/2,n+i/2-4),e.lineTo(o+r/2,n+i/2+4),e.stroke(),e.restore()},o.prototype.drawMoreTab=function(e,o,n,r,i){var a,s;e.save(),e.beginPath(),a=1,(5===this._hoverNavButton||6===this._hoverNavButton)&&(a=4),s=t.ThemeStyleHelper.getVisualStateThemeStyle(a,"gc-navMoreButton-"+t.VisualState[a].toLowerCase()),e.fillStyle=this.getVisibleForeColor(s.borderTopColor),e.fillRect(o+r/2,n+i/2,2,2),e.fillRect(o+r/2-4,n+i/2,2,2),e.fillRect(o+r/2+4,n+i/2,2,2),e.restore()},o.prototype.getVisibleForeColor=function(e){var o=t._Color.parse(e),n=this._backgroundColor;return o.a<=.01?t._Color.invertColor(n):t._Color.isTwoColorSimilar(n,o)?t._Color.invertColor(o):e},o}(B)}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){var t,o,n,r,i,a;(t=e.Sheets||(e.Sheets={})).feature("core.spread_ui",["core.common","core.spread"]),o=function(){var e=this;e.sheetCount=1,e.name="",e.font=t._GcTabBase.defaultFont,e.allowUserZoom=!0,e.allowUserResize=!0,e.tabStripVisible=!0,e.tabEditable=!0,e.newTabVisible=!0,e.tabStripRatio=.5,e.activeSheetIndex=0,e.sheets=[]},t.GcSpreadSheetsOptions=o,n=new o,t.WijspreadOptions=o,r={init:function(e){e=t.GC$.extend(!0,n,e);var o=this.get(0);new t.Spread(o,e)},spread:function(){return this.data("spread")},destroy:function(){var e=this.data("spread");e&&e.destroy()},refresh:function(){var e=this.data("spread");e&&e.refresh()},repaint:function(){var e=this.data("spread");e&&e.repaint()}},(i=window.jQuery)&&(i.fn.wijspread=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:r.init.apply(this,arguments)},void 0===i.wijmo&&(i.wijmo={wijspread:void 0}),i.wijmo.wijspread=e.Sheets),void 0===window.wijmo&&(window.wijmo={spread:void 0}),window.wijmo.spread=e.Sheets,(a=window.ko)&&(a.GcSpread=a.GcSpread||{},a.GcSpread.gcspreadsheetsBinding={init:function(e,o,n,r){new t.Spread(t.GC$("#"+e.id).getElement(0),o())},update:function(e,t,o,n){}},a.bindingHandlers["gcspread-sheets"]=a.GcSpread.gcspreadsheetsBinding,a.wijmo=a.GcSpread,a.bindingHandlers.wijspread=a.GcSpread.gcspreadsheetsBinding);e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){!function(o){function n(e,t){t||(t=this);var o=Ce(e.row,t.row),r=Ce(e.column,t.column),i=ye(e.row+e.rowCount,t.row+t.rowCount),a=ye(e.column+e.columnCount,t.column+t.columnCount);return o>=i||r>=a?me:{row:o,column:r,rowCount:i-o,columnCount:a-r,intersectWith:n}}function r(e,t){return!(e!==_e&&e!==me||t!==_e&&t!==me)||(e!==_e&&e!==me||t===_e||t===me)&&(e===_e||e===me||t!==_e&&t!==me)&&e.toLowerCase()===t.toLowerCase()}function i(e,t){var o={row:this.row,column:this.column,rowCount:1,columnCount:1};return this.rowRelative&&(o.row+=e,o.row=o.row>=q.maxRowCount?o.row%q.maxRowCount:o.row),this.columnRelative&&(o.column+=t,o.column=o.column>=q.maxColumnCount?o.column%q.maxColumnCount:o.column),o}function a(e,t){var o,n,r,i,a={row:-1,column:-1,rowCount:-1,columnCount:-1},s=this;return s.isFullRow?(a.column=-1,a.columnCount=-1):(s.startColumnRelative?r=(r=s.startColumn+t)>=q.maxColumnCount?r%q.maxColumnCount:r:r=s.startColumn,s.endColumnRelative?i=(i=s.endColumn+t)>=q.maxColumnCount?i%q.maxColumnCount:i:i=s.endColumn,a.column=r<=i?r:i,a.columnCount=we(i-r)+1),s.isFullColumn?(a.row=-1,a.rowCount=-1):(s.startRowRelative?o=(o=s.startRow+e)>=q.maxRowCount?o%q.maxRowCount:o:o=s.startRow,s.endRowRelative?n=(n=s.endRow+e)>=q.maxRowCount?n%q.maxRowCount:n:n=s.endRow,a.row=o<=n?o:n,a.rowCount=we(n-o)+1),a}function s(e){return e<=255}function l(e){return e<=127}function u(e){var t=e.charCodeAt(0);return t>=48&&t<=57}function c(e){var t=e.charCodeAt(0);return!s(t)||(l(t)?(t|=32)>=96&&t<=122:Ye[t]===Ue.UppercaseLetter||Ye[t]===Ue.LowercaseLetter)}function h(e){var t=e.charCodeAt(0);return!s(t)||(l(t)?t<=57?t>=48:(t|=32)>=96&&t<=122:Ye[t]===Ue.UppercaseLetter||Ye[t]===Ue.LowercaseLetter)}function p(e){var t=e.charCodeAt(0);return!!s(t)&&(Ye[t]===Ue.MathSymbol||Ye[t]===Ue.currencySymbol||Ye[t]===Ue.ModifierSymbol||Ye[t]===Ue.OtherSymbol)}function d(e){var t=e.charCodeAt(0);return l(t)?t>=48&&t<=57:Ye[t]===Ue.DecimalDigitNumber||Ye[t]===Ue.OtherNumber}function f(e,t,o){for(var n,r=e.length,i=je.None,a=t;a<r;a++)if(u(n=e.charAt(a)))i===je.None?i=je.Int:i===je.Dot?i=je.Decimal:i===je.Sign?i=je.Int:(i===je.Exponent||i===je.SignExponent)&&(i=je.ScientificNotation);else if(n===o)if(i===je.Int)i=je.Decimal;else{if(i!==je.None&&i!==je.Sign)return{result:!1};i=je.Dot}else if("+"===n||"-"===n)if(i===je.None)i=je.Sign;else{if(i!==je.Exponent)return{result:!0,endIndex:a-1};i=je.SignExponent}else if("E"===n||"e"===n){if(i!==je.Int&&i!==je.Decimal)return{result:!1};i=je.Exponent}else if(i===je.Int||i===je.Decimal||i===je.ScientificNotation)return{result:!0,endIndex:a-1};return i===je.Int||i===je.Decimal||i===je.ScientificNotation?{result:!0,endIndex:r-1}:{result:!1}}function g(e,o,n,r,i){for(var a,s=e.length,l=n===r?0:1,u="",c=o+1;c<s;c++)if((a=e.charAt(c))===n&&l++,a===r)if(l--,n===r&&c+2<s&&e.charAt(c+1)===n)u+=n,c++;else{if(0===l)return{result:u,endIndex:c};u+=a}else u+=a;if(i)throw t._StringHelper.format(t.SR.Exp_NoSyntax,[r,n])}function m(e,o,n,r,i,a){for(var s,l=e.length,u=0,c="",h=o;h<l;h++)if((s=e.charAt(h))===i&&(c+=s,h++,s=e.charAt(h)),s===n)c+=s,u++;else if(s===r){if(0==--u)return{result:c,endIndex:h};c+=s}else c+=s;if(a)throw t._StringHelper.format(t.SR.Exp_NoSyntax,[r,n])}function _(e,o,n){for(var r,i,a,s=e.length,l=s-o,u=0;u<de.length;u++)if(!(o+(i=(r=de[u]).length)>s)&&(a=e.slice(o,o+i),i<=l&&(r===a||r===a.toUpperCase())))return{result:r,endIndex:o+i-1};if(n)throw t._StringHelper.format(t.SR.Exp_IsValid,[e.slice(o)])}function y(e){return"^"===e||":"===e?1:"*"===e||"/"===e||" "===e?2:"+"===e||"-"===e||","===e?3:"&"===e?4:5}function C(e){if(11===e.subType)return U.range;if(10===e.subType)return U.union;if(9===e.subType)return U.intersection;var t=e.value;return"^"===t?U.exponent:"*"===t?U.multiply:"/"===t?U.divide:"+"===t?U.add:"-"===t?U.subtract:"&"===t?U.concatenate:"<"===t?U.lessThan:"="===t?U.equal:">"===t?U.greaterThan:">="===t?U.greaterThanOrEqual:"<="===t?U.lessThanOrEqual:"<>"===t?U.notEqual:":"===t||"!"===t?U.range:" "===t||","===t?U.intersection:U.add}function w(e,t,o){return e&&e.hasOwnProperty(t)?e[t]:o}function v(e,t){var o=t+1;return e<0?e%o+o:e>t?e%o:e}var S,x,R,b,T,A,I,D,F,M,E,N,O,P,L,H,k,V,B,z,G,W,j,U,Y,X,K,J,Z,q,$,Q,ee,te,oe,ne;t.feature("calc.common",["core.stringResource","core.common","core.globalize"]);var re,ie="undefined",ae="number",se="string",le="boolean",ue="TRUE",ce="FALSE",he="ARRAY",pe="ARRAYROW",de=["#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#N/A","#NUM!"],fe=[0,7,15,23,29,42,36],ge=[1,26,676],me=null,_e=void 0,ye=Math.min,Ce=Math.max,we=Math.abs,ve=Math.pow;o.missingArgument={},(re=o.CalcValueType||(o.CalcValueType={}))[re.anyType=0]="anyType",re[re.numberType=1]="numberType",re[re.stringType=2]="stringType",re[re.booleanType=3]="booleanType",re[re.dateType=4]="dateType";o.CalcValueType;var Se,xe,Re=["o","n","s","b","d"];new Date;(Se=o.NodeType||(o.NodeType={}))[Se.Cell=0]="Cell",Se[Se.Row=1]="Row",Se[Se.Col=2]="Col",Se[Se.NameIdentity=3]="NameIdentity",o.NodeType,S=function(){function e(){this._headNames=["_head","_headRows","_headCols"],this._tailNames=["_tail","_tailRows","_tailCols"]}return e.prototype.isAdjustCell=function(e){return e.preAdj||e===this._head},e.prototype.isAdjust=function(e){return e.preAdj||e===this._head},e.prototype.addAdjust=function(e,t){var o=this._headNames[t],n=this._tailNames[t];e&&!e.preAdj&&e!==this[o]&&(this[o]?this[n].nextAdj=e:this[o]=e,e.preAdj=this[n],e.nextAdj=me,this[n]=e)},e.prototype.removeAdjust=function(e,t){var o,n,r=this._headNames[t],i=this._tailNames[t];e&&(e.preAdj||e===this[r])&&(o=e.preAdj,n=e.nextAdj,o?o.nextAdj=n:this[r]=n,n?n.preAdj=o:this[i]=o,e.preAdj=me,e.nextAdj=me)},e.prototype._adjustIndexesOnAdd=function(e,t,o,n,r,i,a,s,l,u){if(o>=0||!r){var c=n+(r?o:0),h=i+(a?o:0);return s===e&&l+u<=o&&(c-=r?u:0,h-=a?u:0),s===t&&(l<=c?(c+=u,h+=u):l<=h&&(h+=u)),{index:c-=r?o:0,endIndex:h-=a?o:0}}return{index:n,endIndex:i}},e.prototype._adjustCellExpressionOnAddRemove=function(e,t,o,n,r,i,a,s,l,u){if(t){var c,h=l?r.row:r.column,p=l?r.rowRelative:r.columnRelative;if(l&&o>=0||!l&&n>=0||!p){if(u)c=this._adjustIndexesOnAdd(e,t,l?o:n,h,p,-1,!1,i,a,s).index;else if(c=this._adjustCellOnRemove(e,t,l?o:n,h,p,i,a,s),G.err(c))return new K.ErrorExpression(c);c!==h&&(r=r.offset(l?c-h:0,l?0:c-h,!0))}}return r},e.prototype._adjustRangeExpressionOnAddRemove=function(e,t,o,n,r,i,a,s,l,u){var c,h,p;if(t){if((c=r._getRangeType())===X.sheet||l&&c===X.column||!l&&c===X.row)return r;var d,f=l?r.startRowRelative:r.startColumnRelative,g=l?r.endRowRelative:r.endColumnRelative,m=l?r.startRow:r.startColumn,_=l?r.endRow:r.endColumn;if(l&&o>=0||!l&&n>=0||!f||!g){if(u)d=this._adjustIndexesOnAdd(e,t,l?o:n,m,f,_,g,i,a,s);else if(d=this._adjustRangeOnRemove(e,t,l?o:n,m,f,_,g,i,a,s),G.err(d))return new K.ErrorExpression(d);h=d.index,p=d.endIndex,(h!==m||p!==_)&&(r=r.offset2(l?h-m:0,l?0:h-m,l?p-_:0,l?0:p-_))}}return r},e.prototype._adjustStructReferenceExpressionOnAddRemoveColumn=function(e,t,o,n,r,i,a,s,l){if(t){var u=r;if(u&&t===u.source())return u.offsetWhenInsertRemoveColumn(a,s,l)}return r},e.prototype.adjustFormulaOnAddRemove=function(e,t,o,n,r,i,a,s,l){var u,c,h,p=this,d=p.adjustFormulaOnAddRemove,f=n;if(0===n.t)f=p._adjustCellExpressionOnAddRemove(e,e,t,o,n,r,i,a,s,l);else if(2===n.t)f=p._adjustRangeExpressionOnAddRemove(e,e,t,o,n,r,i,a,s,l);else if(1===n.t)f=p._adjustCellExpressionOnAddRemove(e,n.source,t,o,n,r,i,a,s,l);else if(3===n.t)f=p._adjustRangeExpressionOnAddRemove(e,n.source,t,o,n,r,i,a,s,l);else if(14===n.t)(u=d.call(p,e,t,o,n.argument,r,i,a,s,l))!==n.argument&&(f=new K.ParenthesesExpression(u));else if(11===n.t)(u=d.call(p,e,t,o,n.operand,r,i,a,s,l))!==n.operand&&(f=new K.UnaryOperatorExpression(n.operator,u));else if(10===n.t)c=d.call(p,e,t,o,n.left,r,i,a,s,l),h=d.call(p,e,t,o,n.right,r,i,a,s,l),(c!==n.left||h!==n.right)&&(f=new K.BinaryOperatorExpression(n.operator,c,h));else if(7===n.t){for(var g,m=me,_=n,y=_.argCount(),C=0;C<y;C++)if(g=_.getArg(C),(u=d.call(p,e,t,o,g,r,i,a,s,l))!==g){(m=[])[C]=u;break}if(m){for(C=0;C<y;C++)g=_.getArg(C),(m[C]===_e||m[C]===me)&&(m[C]=d.call(p,e,t,o,g,r,i,a,s,l));f=new K.FunctionExpression(_.fn,m)}}else s||17!==n.t||(f=p._adjustStructReferenceExpressionOnAddRemoveColumn(e,e,t,o,n,r,i,a,l));return f},e.prototype.adjustFormulasOnAddRemove=function(e,t,o,n,r){this.adjustFormulasOnOperator(e,this.adjustFormulaOnAddRemove,t,o,n,r);var i=0,a=0,s=0,l=0;0===t&&(n&&r?s=o:n&&!r?i=o:!n&&r?l=o:a=o),this.adjustValidatorFormulasOnOperator(e,this.adjustFormulaOnAddRemove,t,o,i,a,s,l,n,r)},e.prototype._adjustCellOnRemove=function(e,t,o,n,r,i,a,s){if(o>=0||!r){var l=n+(r?o:0);if(i===e&&a<=o&&(l+=r?s:0),i===t)if(a+s<=l)l-=s;else if(a<=l)return He;return l-(r?o:0)}return n},e.prototype._adjustRangeOnRemove=function(e,t,o,n,r,i,a,s,l,u){if(o>=0||!r){var c=n+(r?o:0),h=i+(a?o:0),p=l+u-1;if(s===e&&l<=o&&(c+=r?u:0,h+=a?u:0),s===t)if(p<c)c-=u,h-=u;else{if(l<=c&&p>=h)return He;l>h||(p<=h?(c=l>=c?c:l,h-=u):h=l-1)}return{index:c-=r?o:0,endIndex:h-=a?o:0}}return{index:n,endIndex:i}},e.prototype.adjustValidatorFormulasOnOperator=function(e,o,n,r,i,a,s,l,u,c){var h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I;if(t.features.dataValidator)for(h=t._DataValidatorCache.getAllValidators(),m=0;m<h.length;m++){for(C in _=!0,y=!0,h[m])if(!isNaN(parseFloat(C))){for(w in h[m][C])if("-1"!==(v=w.split("_"))[0]&&(y=!1),"-1"!==v[1]&&(_=!1),!_&&!y)break;if(!_&&!y)break}if((!u||!y)&&(u||!_)&&(p=h[m].validator,x=s,R=l,(S=h[m].sheet._getSheetSource())!==e&&(x=i,R=a),(f=(d=p.condition).getFormulas())&&f.length>0)){for(b=0;b<f.length;b++)g=f[b],((T=e.getCalcService().parse(e,g,i,a))!==(A=o.call(this,S,x,R,T,e,n,r,u,c))||i!==s||a!==l)&&(I=e.getCalcService().unparse(e,A,x,R),f[b]=I);d.setFormulas(f)}}},e.prototype.adjustFormulasOnOperator=function(e,o,n,r,i,a){for(var s,l,u,c,h,p,d,f,g=this,m={};g._head;)if(h=(s=g._head.sourceModel).getSource(),l=g._head.row,u=g._head.column,m[l]&&m[l][u])g.removeAdjust(g._head,0);else{if(c=s._getExpr(l,u))if(c=o.call(g,h,l,u,c,e,n,r,i,a),p=s.getArrayInfo(l,u))for(p=new t.Range(l,u,p.rowCount,p.colCount),d=l;d<l+p.rowCount;d++)for(m[d]||(m[d]={}),f=u;f<u+p.colCount;f++)s.setExpression(d,f,c,p,d===l&&f===u),m[d][f]=!0;else s.setExpression(l,u,c,p,!0);else(s.getRowExpression&&s.getRowExpression(l)||s.getColumnExpression&&s.getColumnExpression(u))&&s._addCellsToDirty(l,u,1,1);g.removeAdjust(g._head,0)}for(;g._headRows;)s=g._headRows.sourceModel,l=g._headRows.row,s.getRowExpression&&((c=s.getRowExpression(l))&&s.setExpression&&s.setExpression(l,-1,o.call(g,h,l,-1,c,e,n,r,i,a),_e,!0)),g.removeAdjust(g._headRows,1);for(;g._headCols;)s=g._headCols.sourceModel,u=g._headCols.column,s.getColumnExpression&&((c=s.getColumnExpression(u))&&s.setExpression&&s.setExpression(-1,u,o.call(g,h,-1,u,c,e,n,r,i,a),_e,!0)),g.removeAdjust(g._headCols,2)},e.prototype.adjustFormulaOnRemoveSheet2=function(e,t,o,n,r){return this.adjustFormulaOnRemoveSheet(e,n,r)},e.prototype.adjustFormulaOnRemoveSheet=function(e,t,o){var n,r,i,a,s,l,u,c,h=this.adjustFormulaOnRemoveSheet,p=t;if(t instanceof K.ExternalReferenceExpression)a=t.source,(e!==o&&a===o||e===o&&a!==o)&&(p=new K.ErrorExpression(He));else if(14===t.t)(n=h.call(this,e,t.argument,o))!==t.argument&&(p=new K.ParenthesesExpression(n));else if(11===t.t)(n=h.call(this,e,t.operand,o))!==t.operand&&(p=new K.UnaryOperatorExpression(t.operator,n));else if(10===t.t)s=h.call(this,e,t.left,o),l=h.call(this,e,t.right,o),(s!==t.left||l!==t.right)&&(p=new K.BinaryOperatorExpression(t.operator,s,l));else if(7===t.t){for(u=me,c=t.argCount(),i=0;i<c;i++)if(r=t.getArg(i),(n=h.call(this,e,r,o))!==r){(u=[])[i]=n;break}if(u){for(i=0;i<c;i++)r=t.getArg(i),(u[i]===_e||u[i]===me)&&(u[i]=h.call(this,e,r,o));p=new K.FunctionExpression(t.fn,u)}}return p},e.prototype.adjustFormulasOnRemoveSheet=function(e){var t=e.getCalcSourceModel(),o=e.getRowCount(),n=e.getColumnCount();this._addDependentsToAdjust(t,0,0,o,n),this.adjustFormulasOnOperator(e,this.adjustFormulaOnRemoveSheet2),this.adjustValidatorFormulasOnOperator(e,this.adjustFormulaOnRemoveSheet2,0,0,0,0,0,0,!0,!1)},e.prototype._adjustCellExpressionOnMove=function(e,t,o,n,r){var i,a,s,l,u=!!n.source,c=u?n.source:e,h=n.rowRelative,p=n.columnRelative;if((t>=0||!h)&&(o>=0||!p)){if(i=n.row+(h?t:0),a=n.column+(p?o:0),l=r.destinationContains(e,t,o,1,1),c===r._toModel&&r.destinationContains(c,i,a,1,1)&&(!h&&!p||!l))return new K.ErrorExpression(He);if(s=(u&&c===r._fromModel||!u&&e===r._fromModel)&&(!l&&r.sourceContains(r._fromModel,i,a,1,1)||l&&r.destinationContains(r._toModel,i,a,1,1)),l&&(i-=h?r.rowOffset():0,a-=p?r.colOffset():0),s&&(i+=r.rowOffset(),a+=r.colOffset()),i-=h?t:0,a-=p?o:0,r._fromModel===r._toModel?c=u?n.source:_e:(c=_e,s&&l&&u?c=r._toModel:s&&l||(s?c=r._toModel:l&&!u&&(c=r._fromModel))),i!==n.row||a!==n.column||c!=n.source)return c?new K.ExternalCellExpression(c,i,a,h,p):new K.CellExpression(i,a,h,p)}else if((t>=0||!h)&&-1===o){if(i=n.row+(h?t:0),r.destinationContains(e,t,o,1,1)&&(i-=h?r.rowOffset():0),r.sourceContains(c,i,-1,h,-1))i+=r.rowOffset();else if(r.destinationContains(c,i,-1,1,-1))return new K.ErrorExpression(He);if((i-=h?t:0)!==n.row){if(0===n.t)return new K.CellExpression(i,n.column,h,n.columnRelative);if(1===n.t)return new K.ExternalCellExpression(n.source,i,n.column,h,n.columnRelative)}}else if(-1===t&&o>=0&&!p){if(a=n.column+(p?o:0),r.destinationContains(e,t,o,1,1)&&(a-=p?r.colOffset():0),r.sourceContains(c,i,a,1,1))a+=r.colOffset();else if(r.destinationContains(c,i,a,1,1))return new K.ErrorExpression(He);if(a-=p?o:0,i!==n.row||a!==n.column){if(0===n.t)return new K.CellExpression(n.row,a,n.rowRelative,p);if(1===n.t)return new K.ExternalCellExpression(n.source,n.row,a,n.rowRelative,p)}}return n},e.prototype._adjustRangeExpressionOnMove=function(e,t,o,n,r){var i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A=!!n.source,I=A?n.source:e,D=n._getRangeType();if(D===X.cell)if(i=n.startRowRelative,a=n.startColumnRelative,s=n.endRowRelative,l=n.endColumnRelative,t>=0||!i||!s||o>=0||!a||!l){if(u=n.startRow+(i?t:0),c=n.endRow+(s?t:0),h=n.startColumn+(a?o:0),d=c-u+1,f=(p=n.endColumn+(l?o:0))-h+1,(y=r.destinationContains(e,t,o,1,1))&&(C=r._toRow-r._toColumn,w=r._toColumn-r._toRow,d+=(i?-C:0)+(s?C:0),f+=(a?-w:0)+(l?w:0)),I===r._toModel&&r.destinationContains(I,u,h,d,f)&&(!i&&!a&&!s&&!l||!y))return new K.ErrorExpression(He);if(_=(A&&I===r._fromModel||!A&&e===r._fromModel)&&(!y&&r.sourceContains(r._fromModel,u,h,d,f)||y&&r.destinationContains(r._toModel,u,h,d,f)),y&&(u-=i?r.rowOffset():0,c-=s?r.rowOffset():0,h-=a?r.colOffset():0,p-=l?r.colOffset():0),v=!1,_)u+=g=r.rowOffset(),c+=g,h+=m=r.colOffset(),p+=m;else if(r.destinationContains(I,u,h,d,f)){if(!(S=r.intersectWith(I,u,h,d,f))||S.rowCount!==d&&S.columnCount!==f)return new K.ErrorExpression(He);u=S.row+r.rowOffset(),h=S.column+r.colOffset(),c=u+S.rowCount,p=h+S.columnCount,v=!0}if(u-=i?t:0,c-=s?t:0,h-=a?o:0,p-=l?o:0,r._fromModel===r._toModel?I=A?n.source:_e:(I=_e,_&&y&&A?I=r._toModel:_&&y||(_?I=r._toModel:y&&!A&&(I=r._fromModel))),u!==n.startRow||h!==n.startColumn||c!==n.endRow||p!==n.endColumn||v||I!=n.source)return I?new K.ExternalRangeExpression(I,u,h,c,p,i,a,s,l):new K.RangeExpression(u,h,c,p,i,a,s,l)}else if(!(t>=0)&&i&&s||-1!==o){if(-1===t&&(o>=0||!a||!l)){if((h=n.startColumn+(a?o:0))>(p=n.endColumn+(l?o:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,t,o,1,1)&&(h-=a?r.colOffset():0,p-=l?r.colOffset():0),f=p-h,r.sourceContains(I,-1,h,-1,f))h+=m=r.colOffset(),p+=m;else if(r.destinationContains(I,-1,h,-1,f))return new K.ErrorExpression(He);if(p-=l?o:0,(h-=a?o:0)!==n.startColumn||p!==n.endColumn){if(2===n.t)return new K.RangeExpression(n.startRow,h,n.endRow,p,n.startRowRelative,a,n.endRowRelative,l);if(3===n.t)return new K.ExternalRangeExpression(n.source,n.startRow,h,n.endRow,p,n.startRowRelative,a,n.endRowRelative,l)}}}else{if((u=n.startRow+(i?t:0))>(c=n.endRow+(s?t:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,t,o,1,1)&&(u-=i?r.rowOffset():0,c-=s?r.rowOffset():0),d=c-u,r.sourceContains(I,u,-1,d,-1))u+=g=r.rowOffset(),c+=g;else if(r.destinationContains(I,u,-1,d,-1))return new K.ErrorExpression(He);if(c-=s?t:0,(u-=i?t:0)!==n.startRow||c!==n.endRow){if(2===n.t)return new K.RangeExpression(u,n.startColumn,c,n.endColumn,i,n.startColumnRelative,s,n.endColumnRelative);if(3===n.t)return new K.ExternalRangeExpression(n.source,u,n.startColumn,c,n.endColumn,i,n.startColumnRelative,s,n.endColumnRelative)}}else if(D===X.row){if(i=n.startRowRelative,s=n.endRowRelative,t>=0||!i||!s){if((u=n.startRow+(i?t:0))>(c=n.endRow+(s?t:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,t,o,1,1)&&(u-=i?r.rowOffset():0,c-=s?r.rowOffset():0),d=c-u,r.sourceContains(I,u,-1,d,-1))u+=g=r.rowOffset(),c+=g;else if(r.destinationContains(I,u,-1,d,-1))return new K.ErrorExpression(He);if(c-=s?t:0,(u-=i?t:0)!==n.startRow||c!==n.endRow){if(2===n.t)return(x=new K.RangeExpression).initBand(u,c,i,s,!0),x;if(3===n.t)return(R=new K.ExternalRangeExpression).initBand(n.source,u,c,i,s,!0),R}}}else if(D===X.column){if(a=n.startColumnRelative,l=n.endColumnRelative,(h=n.startColumn+(a?o:0))<(p=n.endColumn+(l?o:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,t,o,1,1)&&(h-=a?r.colOffset():0,p-=l?r.colOffset():0),f=p-h,r.sourceContains(I,-1,h,-1,f))h+=m=r.colOffset(),p+=m;else if(r.destinationContains(I,-1,h,-1,f))return new K.ErrorExpression(He);if(p-=l?o:0,(h-=a?o:0)!==n.startColumn||p!==n.endColumn){if(2===n.t)return(b=new K.RangeExpression).initBand(h,p,a,l,!1),b;if(2===n.t)return(T=new K.ExternalRangeExpression).initBand(n.source,h,p,a,l,!1),T}}return n},e.prototype.adjustFormulaOnMoveSwap=function(e,t,o,n,r,i){var a,s,l,u=this,c=u.adjustFormulaOnMoveSwap,h=n;if(0===n.t||1===n.t)h=i?u._adjustCellExpressionOnMove(e,t,o,n,r):u._adjustCellExpressionOnSwap(e,t,o,n,r);else if(2===n.t||3===n.t)h=i?u._adjustRangeExpressionOnMove(e,t,o,n,r):u._adjustRangeExpressionOnSwap(e,t,o,n,r);else if(14===n.t)s=n,(a=c.call(u,e,t,o,s.argument,r,i))!==s.argument&&(h=new K.ParenthesesExpression(a));else if(11===n.t)l=n,(a=c.call(u,e,t,o,l.operand,r,i))!==l.operand&&(h=new K.UnaryOperatorExpression(l.operator,a));else if(10===n.t){var p=n,d=c.call(u,e,t,o,p.left,r,i),f=c.call(u,e,t,o,p.right,r,i);(d!==p.left||f!==p.right)&&(h=new K.BinaryOperatorExpression(p.operator,d,f))}else if(7===n.t){for(var g,m=me,_=n,y=_.argCount(),C=0;C<y;C++)if(g=_.getArg(C),(a=c.call(u,e,t,o,g,r,i))!==g){(m=[])[C]=a;break}if(m){for(C=0;C<y;C++)g=_.getArg(C),(m[C]===_e||m[C]===me)&&(m[C]=c.call(u,e,t,o,g,r,i));h=new K.FunctionExpression(_.fn,m)}}return h},e.prototype.adjustDataValidatorFormulasOnMoveSwap=function(e,o){var n,r,i,a,s,l,u=e._fromModel.getCalcService();if(t.features.dataValidator){var c,h,p,d,f=t._DataValidatorCache.getAllValidators(),g=0,m=0;for((0===e._fromRow&&0===e._fromColumn||0===e._toRow||0===e._toColumn)&&(g=e._rowCount,m=e._columnCount,g>=e._toRow&&g<e._toRow+e._rowCount&&m>=e._toColumn&&m<e._toColumn+e._columnCount?g=e._toRow+e._rowCount:g>=e._fromRow&&g<e._fromRow+e._rowCount&&m>=e._fromColumn&&m<e._fromColumn+e._columnCount&&(g=e._fromRow+e._rowCount)),n=0;n<f.length;n++)if(c=f[n].validator,r=f[n].sheet._getSheetSource(),(p=(h=c.condition).getFormulas())&&p.length>0){for(i=0;i<p.length;i++)d=p[i],(a=u.parse(e._fromModel,d,g,m))!==(s=this.adjustFormulaOnMoveSwap(r,g,m,a,e,o))&&(l=u.unparse(e._fromModel,s,g,m),p[i]=l);h.setFormulas(p)}}},e.prototype._adjustCellExpressionOnSwap=function(e,t,o,n,r){var i,a,s=n.source||e,l=n.rowRelative,u=n.columnRelative;if((t>=0||!l)&&(o>=0||!u)){if(i=n.row+(l?t:0),a=n.column+(u?o:0),r.destinationContains(e,t,o,1,1)?(i-=l?r.rowOffset():0,a-=u?r.colOffset():0):r.sourceContains(e,i,a,1,1)&&(i+=l?r.rowOffset():0,a+=u?r.colOffset():0),r.sourceContains(s,i,a,1,1)?(i+=r.rowOffset(),a+=r.colOffset()):r.destinationContains(s,i,a,1,1)&&(i-=r.rowOffset(),a-=r.colOffset()),a-=u?o:0,(i-=l?t:0)!==n.row||a!==n.column){if(0===n.t)return new K.CellExpression(i,a,l,u);if(1===n.t)return new K.ExternalCellExpression(n.source,i,a,l,u)}}else if((t>=0||!l)&&-1===o){if(i=n.row+(l?t:0),r.destinationContains(e,t,-1,1,-1)?i-=l?r.rowOffset():0:r.sourceContains(e,i,-1,1,-1)&&(i+=l?r.rowOffset():0),r.sourceContains(s,i,-1,1,-1)?i+=r.rowOffset():r.destinationContains(s,i,-1,1,-1)&&(i-=r.rowOffset()),(i-=l?t:0)!==n.row||a!==n.column){if(0===n.t)return new K.CellExpression(i,n.column,l,n.columnRelative);if(1===n.t)return new K.ExternalCellExpression(n.source,i,n.column,l,n.columnRelative)}}else if(-1===t&&o>=0&&!u&&(a=n.column+(u?o:0),r.destinationContains(e,-1,o,-1,1)?a-=u?r.colOffset():0:r.sourceContains(e,-1,a,-1,1)&&(a+=u?r.colOffset():0),r.sourceContains(s,-1,a,-1,1)?a+=r.colOffset():r.destinationContains(s,-1,a,-1,1)&&(a-=r.colOffset()),a-=u?o:0,i!==n.row||a!==n.column)){if(0===n.t)return new K.CellExpression(n.row,a,n.rowRelative,u);if(1===n.t)return new K.ExternalCellExpression(n.source,n.row,a,n.rowRelative,u)}return n},e.prototype._adjustRangeExpressionOnSwap=function(e,t,o,n,r){var i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x=n.source||e,R=n._getRangeType();if(R===X.cell){if(h=n.startRowRelative,p=n.startColumnRelative,d=n.endRowRelative,f=n.endColumnRelative,!(t>=0)&&h&&d||!(o>=0)&&p&&f)if(!(t>=0)&&h&&d||-1!==o){if(-1===t&&(o>=0||!p||!f)){if((s=n.startColumn+(p?o:0))<(l=n.endColumn+(f?o:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,-1,o,-1,1)?(s-=y=p?r.colOffset():0,l-=f?r.colOffset():0):r.sourceContains(e,-1,o,-1,1)&&(s+=y=p?r.colOffset():0,l+=f?r.colOffset():0),c=l-s,r.sourceContains(x,-1,s,-1,c)?(s+=m=r.colOffset(),l+=m):r.destinationContains(x,-1,s,-1,c)&&(s-=m=r.colOffset(),l-=m),l-=f?o:0,(s-=p?o:0)!==n.startColumn||l!==n.endColumn){if(2===n.t)return new K.RangeExpression(n.startRow,s,n.endRow,l,n.startRowRelative,p,n.endRowRelative,f);if(3===n.t)return new K.ExternalRangeExpression(n.source,n.startRow,s,n.endRow,l,n.startRowRelative,p,n.endRowRelative,f)}}}else{if((i=n.startRow+(h?t:0))<(a=n.endRow+(d?t:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,t,-1,1,-1)?(i-=_=h?r.rowOffset():0,a-=h?r.rowOffset():0):r.sourceContains(e,t,-1,1,-1)&&(i+=_=h?r.rowOffset():0,a+=h?r.rowOffset():0),u=a-i,r.sourceContains(x,i,-1,u,-1)?(i+=g=r.rowOffset(),a+=g):r.destinationContains(x,i,-1,u,-1)&&(i-=g=r.rowOffset(),a-=g),a-=d?t:0,(i-=h?t:0)!==n.startRow||a!==n.endRow){if(2===n.t)return new K.RangeExpression(i,n.startColumn,a,n.endColumn,h,n.startColumnRelative,d,n.endColumnRelative);if(3===n.t)return new K.ExternalRangeExpression(n.source,i,n.startColumn,a,n.endColumn,h,n.startColumnRelative,d,n.endColumnRelative)}}else if(i=n.startRow+(h?t:0),a=n.endRow+(d?t:0),s=n.startColumn+(p?o:0),u=a-i,c=(l=n.endColumn+(f?o:0))-s,r.destinationContains(e,t,o,1,1)?(_=h?r.rowOffset():0,y=p?r.colOffset():0,i-=_,a-=d?r.rowOffset():0,s-=y,l-=f?r.colOffset():0):r.sourceContains(e,i,s,u,c)&&(_=h?r.rowOffset():0,y=p?r.colOffset():0,i+=_,a+=d?r.rowOffset():0,s+=y,l+=f?r.colOffset():0),r.sourceContains(x,i,s,u,c)?(i+=g=r.rowOffset(),a+=g,s+=m=r.colOffset(),l+=m):r.destinationContains(x,i,s,u,c)&&(i-=g=r.rowOffset(),a-=g,s-=m=r.colOffset(),l-=m),a-=d?t:0,s-=p?o:0,l-=f?o:0,(i-=h?t:0)!==n.startRow||s!==n.startColumn||a!==n.endRow||l!==n.endColumn){if(2===n.t)return new K.RangeExpression(i,s,a,l,h,p,d,f);if(3===n.t)return new K.ExternalRangeExpression(n.source,i,s,a,l,h,p,d,f)}}else if(R===X.row){if(h=n.startRowRelative,d=n.endRowRelative,t>=0||!h||!d){if((i=n.startRow+(h?t:0))<(a=n.endRow+(d?t:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,t,-1,1,-1)?(i-=_=h?r.rowOffset():0,a-=d?r.rowOffset():0):r.sourceContains(e,t,-1,1,-1)&&(i+=_=h?r.rowOffset():0,a+=d?r.rowOffset():0),u=a-i,r.sourceContains(x,i,-1,u,-1)?(i+=g=r.rowOffset(),a+=g):r.destinationContains(x,i,-1,u,-1)&&(i-=g=r.rowOffset(),a-=g),a-=d?t:0,(i-=h?t:0)!==n.startRow||a!==n.endRow){if(2===n.t)return(C=new K.RangeExpression).initBand(i,a,h,d,!0),C;if(3===n.t)return(w=new K.ExternalRangeExpression).initBand(n.source,i,a,h,d,!0),w}}}else if(R===X.column){if(p=n.startColumnRelative,f=n.endColumnRelative,(s=n.startColumn+(p?o:0))>(l=n.endColumn+(f?o:0)))return new K.ErrorExpression(He);if(r.destinationContains(e,-1,o,-1,1)?(s-=y=p?r.colOffset():0,l-=f?r.colOffset():0):r.sourceContains(e,-1,o,-1,1)&&(s+=y=p?r.colOffset():0,l+=f?r.colOffset():0),c=l-s,r.sourceContains(x,-1,s,-1,c)?(s+=m=r.colOffset(),l+=m):r.destinationContains(x,-1,s,-1,c)&&(s-=m=r.colOffset(),l-=m),l-=f?o:0,(s-=p?o:0)!==n.startColumn||l!==n.endColumn){if(2===n.t)return(v=new K.RangeExpression).initBand(s,l,p,f,!1),v;if(3===n.t)return(S=new K.ExternalRangeExpression).initBand(n.source,s,l,p,f,!1),S}}return n},e.prototype.adjustFormulasOnMoveSwap=function(e,o,n,r,i,a,s,l,u){var c,h,p,d,f,g,m,_=this,y=_.adjustFormulaOnMoveSwap,C=new x(e,o,n,r,i,a,s,l),w={};for(_.adjustDataValidatorFormulasOnMoveSwap(C,u);_._head;)if(c=_._head.sourceModel,h=_._head.row,p=_._head.column,w[h]&&w[h][p])_.removeAdjust(_._head,0);else{if(d=c.getExpression(h,p))if(d=y.call(_,c.getSource(),h,p,d,C,u),f=c.getArrayInfo(h,p))for(f=new t.Range(h,p,f.rowCount,f.colCount),g=h;g<h+f.rowCount;g++)for(w[g]||(w[g]={}),m=p;m<p+f.colCount;m++)c.setExpression(g,m,d,f,g===h&&m===p),w[g][m]=!0;else c.setExpression(h,p,d,f,!0);else(c.getRowExpression&&c.getRowExpression(h)||c.getColumnExpression&&c.getColumnExpression(p))&&c._addCellsToDirty(h,p,1,1);_.removeAdjust(_._head,0)}for(;_._headRows;)c=_._headRows.sourceModel,h=_._headRows.row,c.getRowExpression&&((d=c.getRowExpression(h))&&c._setRowExpression&&c._setRowExpression(h,y.call(_,c.getSource(),h,-1,d,C,u),_e)),_.removeAdjust(_._headRows,1);for(;_._headCols;)c=_._headCols.sourceModel,p=_._headCols.column,c.getColumnExpression&&((d=c.getColumnExpression(p))&&c._setColumnExpression&&c._setColumnExpression(p,y.call(_,c.getSource(),-1,p,d,C,u),_e)),_.removeAdjust(_._headCols,2)},e.prototype._addDependentsToAdjust=function(e,t,o,n,r){e.addDependents(t,o,n,r,!0,!1)},e.prototype._addCellsToAdjust=function(e,t,o,n,r){for(var i,a,s,l,u=t+n,c=o+r,h=t;h<u;h++)for(i=o;i<c;i++)s=e._getCalc(h,i),l=e._getExpr(h,i),(s||l)&&(e._setCalc(h,i,me),a=e._getCellCalc(h,i,!0),this.addAdjust(a,0))},e.prototype._addColumnsToAdjust=function(e,t,o){for(var n,r=t;-1!==r&&r<t+o;r++)(e._getCalc(-1,r)||e._getExpr(-1,r))&&(e._setCalc(-1,r,me),n=e._getColumnCalc(r,!0),this.addAdjust(n,2))},e.prototype._addRowsToAdjust=function(e,t,o){for(var n,r=t;-1!==r&&r<t+o;r++)(e._getCalc(r,-1)||e._getExpr(r,-1))&&(e._setCalc(r,-1,me),n=e._getRowCalc(r,!0),this.addAdjust(n,1))},e.prototype._addVolatitleToAdjust=function(e){for(var t,o,n,r=e.getCalcService().getAllSouceModels(),i=0;i<r.length;i++)for(o=r[i]._getAllVolatitles(),t=0;t<o.length;t++)(n=o[t])&&n instanceof A&&!this.isAdjustCell(n)&&this.addAdjust(n,0)},e.prototype.onBeforeAddRemoveRows=function(e,t){var o=e.rC(),n=e.cC();e.unlinkCellExpression(t,0,o-t,n),e.unlinkRowExpression(t,o-t),this._addDependentsToAdjust(e,t,-1,o-t,-1)},e.prototype.onAfterAddRemoveRows=function(e,t,o,n){var r=e.rC(),i=e.cC();n?e._addCellsToDirty(t,0,o,i):r+=o,this._addCellsToAdjust(e,t,0,r-t,i),this._addRowsToAdjust(e,t,r-t),this._addVolatitleToAdjust(e),this.adjustFormulasOnAddRemove(e.getSource(),t,o,!0,n),e.getCalcService().autoCalculation&&e.getCalcService().recalculateAll(!1)},e.prototype.onAfterAddRemoveColumns=function(e,t,o,n){var r=e.rC(),i=e.cC();n?e._addCellsToDirty(0,t,r,o):i+=o,this._addCellsToAdjust(e,0,t,r,i-t),this._addColumnsToAdjust(e,t,i-t),this._addVolatitleToAdjust(e),this.adjustFormulasOnAddRemove(e.getSource(),t,o,!1,n),e.getCalcService().autoCalculation&&e.getCalcService().recalculateAll(!1)},e.prototype.onBeforeAddRemoveColumns=function(e,t){var o=e.rC(),n=e.cC();e.unlinkCellExpression(0,t,o,n-t),e.unlinkColumnExpression(t,n-t),this._addDependentsToAdjust(e,-1,t,-1,n-t)},e._copyExpression=function(n,r,i,a,s){var l,u,c=n,h=e,p=h._copyExpression;if(!t.util.hasCalc()||!n)return c;var d=o.Expressions,f=q.maxRowCount,g=q.maxColumnCount,m=o.Errors.Reference,_=d.ErrorExpression,y=d.ExternalErrorExpression;if(14===n.t)(c=new d.ParenthesesExpression).argument=p.call(h,n.argument,r,i,a,s);else if(0===n.t||1===n.t){if(n.rowRelative&&(n.row+r<0||n.row+r>f)||n.columnRelative&&(n.column+i<0||n.column+i>g))return n.source?new y(n.source,m):new _(m);c=n.offset(0,0,!1)}else if(2===n.t||3===n.t||16===n.t){if((l=n).startRowRelative&&(l.startRow+r<0||l.startRow+r>f)||l.startColumnRelative&&(l.startColumn+i<0||l.startColumn+i>g)||l.endRowRelative&&(l.endRow+r<0||l.endRow+r>f)||l.endColumnRelative&&(l.endColumn+i<0||l.endColumn+i>g))return n.startSource?new d.SheetRangeErrorExpression(n.startSource,n.endSource,m):n.source?new y(n.source,m):new _(m);c=n.offset(0,0,!1)}else if(11===n.t)c=new d.UnaryOperatorExpression(n.operator,p.call(h,n.operand,r,i,a,s));else if(10===n.t)c=new d.BinaryOperatorExpression(n.operator,p.call(h,n.left,r,i,a,s),p.call(h,n.right,r,i,a,s));else if(7===n.t){if(c=new d.FunctionExpression(n.fn,[]),n.args&&n.args.length>0)for(u=0;u<n.args.length;u++)c.args[u]=p.call(h,n.args[u],r,i,a,s)}else 17===n.t&&(c=n.offsetWhenCopy(a,s));return c},e.copyFormula=function(t,n,r,i,a,s,l,u,c){var h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F=t,M=i,E=t.getSource(),N=i.getSource(),O=e;if(F&&M){var P,L={},H=n,k=r,V=a,B=s,z=l,G=u;for(n<0&&(H=0,z=ye(t.rC(),i.rC())),r<0&&(k=0,G=ye(t.cC(),i.cC())),a<0&&(V=0),s<0&&(B=0),!(t===i),F&&F.unlinkCellExpression(V,B,z,G),h=new o.CalcSourceModel(t.getCalcService(),E),p=0;p<z;p++)for(d=0;d<G;d++)F._copyExpr(h,p+H,d+k,p,d),(f=t.getSource().getSheet().getStyleObject(p+V,d+B))&&f.validator&&((P=f.validator.condition)&&P.getFormulas&&P.getFormulas().length>0&&(L[f.validator.id]=P));for(g={},m=i.getCalcService(),p=0;p<z;p++)if(!c||!N.isHiddenRow(p+V))for(_=p+V,d=0;d<G;d++)if(y=d+B,C=h._getExpr(p,d)){if(C===g)continue;if(C=O._copyExpression(h._getExpr(p,d),_,y,a-n,s-r),w=h.getArrayInfo(p,d),N)if(w){for(v=z-p<w.rowCount?z-p:w.rowCount,S=G-d<w.colCount?G-d:w.colCount,D=0;D<v;D++)for(x=0;x<S;x++)h._setExpr(p+D,d+x,C);i.setArrayFormula(_,y,v,S,m.unparseWithoutCulture(N,C,_,y))}else R=C?m.unparseWithoutCulture(N,C,_,y):_e,N.setFormula(_,y,R),(b=h._getWorkingExpr(p,d))&&(b=O._copyExpression(b,_,y,a-n,s-r),T=new Q(N,!1,_,y),b=(b=K._mappingArray(T,C,!1,0,0))===C?_e:b),M._setCellExpression(_,y,C,b,w);else M._setExpr(p+V,d+B,C),M._setArrayInfo(p+V,d+B,w)}else M&&M.getExpression(_,y)&&M._clearAllExpr(_,y);for(A in L){for(I=(P=L[A]).getFormulas(),D=0;D<I.length;D++)R=I[D],C=m.parse(t.getSource(),R,H,k),R=m.unparse(t.getSource(),C,V,B),I[D]=R;P.setFormulas(I)}}},e.prototype.onAfterRemoveName=function(e,t){var o=e._getNameCalc(t,!1);o&&(o.updateListening(!0,!1),o.addToDirty(),o.updateListeningOnRemoved())},e.prototype.adjustFormulaOnRemoveName=function(e,t,o){var n,r,i,a,s,l,u,c=this.adjustFormulaOnRemoveName,h=t;if(8===t.t||18===t.t||9===t.t){if(t.name===o&&(!t.source||t.source===e.getSource()))return t.source?new K.ExternalErrorExpression(t.source,He):new K.ErrorExpression(He)}else if(14===t.t)(n=c.call(this,e,t.argument,o))!==t.argument&&(h=new K.ParenthesesExpression(n));else if(11===t.t)(n=c.call(this,e,t.operand,o))!==t.operand&&(h=new K.UnaryOperatorExpression(t.operator,n));else if(10===t.t)a=c.call(this,e,t.left,o),s=c.call(this,e,t.right,o),(a!==t.left||s!==t.right)&&(h=new K.BinaryOperatorExpression(t.operator,a,s));else if(7===t.t){for(l=me,u=t.argCount(),i=0;i<u;i++)if(r=t.getArg(i),(n=c.call(this,e,r,o))!==r){(l=[])[i]=n;break}if(l){for(i=0;i<u;i++)r=t.getArg(i),(l[i]===_e||l[i]===me)&&(l[i]=c.call(this,e,r,o));h=new K.FunctionExpression(t.fn,l)}}return h},e.prototype.invalidName=function(e,t){if(t){var o=e.getCalcSourceModel()._getNameCalc(t.toUpperCase(),!0);o&&o.addListenersToAdjust()}},e.prototype.onAfterRemoveTable=function(e){for(var o,n,r,i,a,s,l={};this._head;)if((e=this._head.sourceModel).getSource(),o=this._head.row,n=this._head.column,l[o]&&l[o][n])this.removeAdjust(this._head,0);else{if(r=e._getExpr(o,n))if(i=e.getArrayInfo(o,n))for(i=new t.Range(o,n,i.rowCount,i.colCount),a=o;a<o+i.rowCount;a++)for(l[a]||(l[a]={}),s=n;s<n+i.colCount;s++)e.setExpression(a,s,r,i,a===o&&s===n),l[a][s]=!0;else e.setExpression(o,n,r,i,!0);else(e.getRowExpression&&e.getRowExpression(o)||e.getColumnExpression&&e.getColumnExpression(n))&&e._addCellsToDirty(o,n,1,1);this.removeAdjust(this._head,0)}},e}(),o.CalcOperatorAdjustor=S,x=function(){function e(e,t,o,n,r,i,a,s){this._fromModel=e,this._fromRow=t,this._fromColumn=o,this._toModel=n,this._toRow=r,this._toColumn=i,this._rowCount=a,this._columnCount=s}return e.prototype.rowOffset=function(){return this._toRow-this._fromRow},e.prototype.colOffset=function(){return this._toColumn-this._fromColumn},e.prototype.sourceContains=function(e,t,o,n,r){return this._fromModel===e&&(-1===this._fromRow||this._fromRow<=t&&t+n<=this._fromRow+this._rowCount)&&(-1===this._fromColumn||this._fromColumn<=o&&o+r<=this._fromColumn+this._columnCount)},e.prototype.destinationContains=function(e,t,o,n,r){return this._toModel===e&&(-1===this._toRow||this._toRow<=t&&t+n<=this._toRow+this._rowCount)&&(-1===this._toColumn||this._toColumn<=o&&o+r<=this._toColumn+this._columnCount)},e.prototype.intersectWith=function(e,t,o,n,r){var i;return this._toModel!==e?me:(i=this._createValidCellRange(e,t,o,n,r),this._createValidCellRange(e,this._fromRow,this._fromColumn,n,r).intersectWith(i))},e.prototype._createValidCellRange=function(e,t,o,r,i){return{row:-1===t?0:t,column:-1===o?0:o,rowCount:-1===t||-1===r?e.rowCount:r,columnCount:-1===o||-1===i?e.columnCount:i,intersectWith:n}},e}(),R=function(){function e(t){this.id=e.sourceId++,this._service=t,this._calcSourceModel=null}return e.prototype.getCalcService=function(){return this._service},e.prototype.setCalcService=function(e){this._service=e},e.prototype.getCalcSourceModel=function(){return this._calcSourceModel},e.prototype.setCalcSourceModel=function(e){this._calcSourceModel=e},e.prototype.getValue=function(e,t,o){return me},e.prototype.getValueByName=function(e,t){return me},e.prototype.getName=function(){return""},e.prototype.setValue=function(e,t,o){},e.prototype.setValueByName=function(e,t){},e.prototype.getReference=function(e,o,n,r){return new k(this,[new t.Range(e,o,n,r)])},e.prototype.getSheetRangeReference=function(e,o,n,r,i){return new k(this,[new t.Range(o,n,r,i)])},e.prototype.getSources=function(e){return[this]},e.prototype.referenceToArray=function(e,t,o,n,r,i){var a,s,l,u,c,h,p,d,f,g,m,_,y,C=1,w=1,v=[];G.CalcConvertedError;if(0===(c=e.getRangeCount()))return v.isError=!0,[];for(d=this.getRowCount(),f=this.getColumnCount(),o=o===_e||o,g=0;g<c;g++){if(o||(p=[],v.push(p)),0===(C=e.getRowCount(g)))return v.isError=!0,[];if(0===(w=e.getColumnCount(g)))return v.isError=!0,[];for(l=e.getRow(g),u=e.getColumn(g),C=Math.min(l+C,d)-l,w=Math.min(u+w,f)-u,_=0;_<C;_++)for(a=l+_,o||(m=[],p.push(m)),y=0;y<w;y++){if(s=u+y,h=this.getValue(a,s),n&&G.err(h))return(v=[h]).isError=!0,v;if(h=G.convertValue(h,t,!0,i),r&&h===G.CalcConvertedError)return(v=[Le]).isError=!0,v;h===me&&i||(o?v.push(h):m.push(h))}}return o||1!==c||(v=v[0]),v.rowCount=C,v.colCount=w,v.rangeCount=c,v},e.prototype.getSheetReference=function(){return this._reference=this._reference||new k(this),this._reference},e.prototype.setFormula=function(e,t,o){},e.prototype.setFormulaByName=function(e,t){},e.prototype.setArrayFormula=function(e,t,o,n,r){},e.prototype.getRowCount=function(){return 1e3},e.prototype.getColumnCount=function(){return 100},e.prototype.isHiddenRow=function(e,t){return!1},e.prototype.getParserContext=function(e,t,o,n){return new Z(this,e,t,o,n)},e.prototype.startCalculation=function(){},e.prototype.endCalculation=function(){},e.prototype.getEvaluatorContext=function(e,t,o,n,r,i,a){return o?new Q(this,o,n=n===_e?e:n,r=r===_e?t:r,i=i===_e?1:i,a=a===_e?1:a,e,t):new Q(this,o,e,t)},e.prototype.getCustomFunction=function(e){return me},e.prototype.getCustomName=function(e){return me},e.prototype.refresh=function(){},e.prototype.toJSON=function(e,t){},e.sourceId=1,e}(),o.CalcSource=R,b=function(){function e(){this._sourceModeles={},this.autoCalculation=!0,this._headNames=["_head","_headRows","_headCols","_headNamIDs"],this._tailNames=["_tail","_tailRows","_tailCols","_tailNameIDs"],this.maximumIterations=1,this.maximumChange=.01;this._parser=new q,this._evaluator=new ne,this.useR1C1=!1,this._suspended=0,this._operatorAdjustor=new S}return e.prototype.dispose=function(){this._sourceModeles={},this._globalSourceModel=me},e.prototype.getOperatorAdjustor=function(){return this._operatorAdjustor},e.prototype.getSourceModel=function(e){var t=this._sourceModeles[e.id];return t||(t=this._sourceModeles[e.id]=new T(this,e),e.setCalcSourceModel(t),e.setCalcService(this)),t},e.prototype.getGlobalSourceModel=function(e){return this._globalSourceModel||(this._globalSourceModel=new T(this,e)),this._globalSourceModel},e.prototype.setSourceModel=function(e,t){this._sourceModeles[e.id]=t,t.setCalcService(this)},e.prototype.getAllSouceModels=function(){var e=[],t=this._sourceModeles;for(var o in t)e.push(t[o]);return e},e.prototype.removeSource=function(e){this._sourceModeles[e.id]&&(this._operatorAdjustor.adjustFormulasOnRemoveSheet(e),delete this._sourceModeles[e.id])},e.prototype.clearSource=function(){this._sourceModeles={},this.clearDirties()},e.prototype.ignoreDirty=function(){return this._ignoreDirty},e.prototype.suspend=function(e){this._parseCache||(this._parseCache={}),this._suspended++,this._ignoreDirty=!!e||e},e.prototype.resume=function(e){this._suspended--,this._suspended<0&&(this._suspended=0),this.IsSuspended()||(this._parseCache=me,this._ignoreDirty=!1,this.recalculateAll(e))},e.prototype.clearDirties=function(){for(var e,t,o=this,n=[o._head,o._headRows,o._headCols,o._headNamIDs],r=0;r<n.length;r++)for(e=n[r];e;)(t=e.nextDirty)?(e.nextDirty=t.preDirty=_e,e=t):e=me;o._head=o._tail=o._headRows=o._tailRows=o._headCols=o._tailCols=o._headNamIDs=o._tailNameIDs=me},e.prototype.resumeWithoutCalc=function(){this._suspended=0,this.clearDirties()},e.prototype.IsSuspended=function(){return this._suspended>0},e.prototype.recalculate=function(e,t,o,n){var r=this.getSourceModel(e);-1===o?r._addCellsToDirty(t,0,1,r.cC()):-1===t?r._addCellsToDirty(0,o,r.rC(),1):r._addCellsToDirty(t,o,1,1),this.IsSuspended()||this.recalculateAll(!1,n)},e.prototype.recalculateByName=function(e,t){if(t){var o=this.getSourceModel(e)._getNameIDCalc(t.toUpperCase(),!0);this.addDirty(o,3),this.IsSuspended()||this.recalculateAll(!1)}},e.prototype.recalcRange=function(e,t,o,n,r){var i=this.getSourceModel(e);-1===o?i._addCellsToDirty(t,0,n,i.cC()):-1===t?i._addCellsToDirty(0,o,i.rC(),r):i._addCellsToDirty(t,o,n,r),this.IsSuspended()||this.recalculateAll(!1)},e.prototype.recalculateAll=function(e,t){var o,n,r,i,a;if(!this.IsSuspended()){for(a in this._evaluator.startCache(),n=this._sourceModeles)(o=n[a]).getSource().startCalculation(),!1!==e?(r=o.cC(),i=o.rC(),o._addColumnsToDirty(0,r),o._addRowsToDirty(0,i),o._addCellsToDirty(0,0,i,r)):!1!==t&&o._addVolatitlesToDirty();for(a in this._recalculateImp(),n)(o=n[a])._checkAndUpdateVolatitles();for(a in n)(o=n[a]).getSource().endCalculation();this._evaluator.endCache()}},e.prototype._cacheHeadDirtyColumns=function(e,t){for(var o=e.length,n=t;n;)e[o]=n,o++,n=n.nextDirty},e.prototype._recalculateImp=function(e){var t,o,n,r,i,a,s,l,u,c;void 0===e&&(e=!0);var h,p,d,f,g,m,_,y,C,w,v,S=this,x=me,R=!1;if(e){for(t=[],S._headCols&&S._cacheHeadDirtyColumns(t,S._headCols);S._headRows;){for(_=(h=S._headRows.sourceModel).cC(),d=0;d<_;d++)S.addDirty(h._getCellCalc(S._headRows.row,d,!0),0);S.removeDirty(S._headRows,1)}for(;S._headCols;){if((m=(h=S._headCols.sourceModel).rC())>0)for(p=0;p<m;p++)S.addDirty(h._getCellCalc(p,S._headCols.column,!0),0);else S._headCols.addListenersToDirty();S.removeDirty(S._headCols,2)}for(y=S._head;y;y=y.nextDirty){for(h=y.sourceModel,f=y.row,g=y.column,C=h._getRowCalc(f,!1),w=h._getColumnCalc(g,!1),v=h._getRangeCalc(!1),y.addListenersToDirty(),C&&C.addListenersToDirty(),w&&w.addListenersToDirty(),v&&v.addListenersToDirty(f,g,1,1);S._headRows;){for(_=(h=S._headRows.sourceModel).cC(),d=0;d<_;d++)S.addDirty(h._getCellCalc(S._headRows.row,d,!0),0);S.removeDirty(S._headRows,1)}for(;S._headCols;){for(o=!1,s=0;s<t.length;s++)if(t[s]==S._headCols){o=!0;break}if(o)S.removeDirty(S._headCols,2);else{for(t[t.length]=S._headCols,m=(h=S._headCols.sourceModel).rC(),p=0;p<m;p++)S.addDirty(h._getCellCalc(p,S._headCols.column,!0),0);S.removeDirty(S._headCols,2)}}}for(i=S._headNamIDs;i;i=i.nextDirty)h=i.sourceModel,i.addListenersToDirty()}for(y=S._head;y;y=x)n=(h=y.sourceModel).rC(),r=h.cC(),x=y.nextDirty,y.row<n&&y.column<r?y.delay=0:S.removeDirty(y,0);for(i=S._headNamIDs;i;i=i.nextDirty)i.delay=0;for(y=S._head;y;y=y.nextDirty)h=y.sourceModel,p=y.row,d=y.column,C=h._getRowCalc(p,!1),w=h._getColumnCalc(d,!1),v=h._getRangeCalc(!1),y.adjustDelayOfListeners(!0),C&&C.adjustDelayOfListeners(!0),w&&w.adjustDelayOfListeners(!0),v&&v.adjustDelayOfListeners(p,d,!0);for(i=S._headNamIDs;i;i=i.nextDirty)i.adjustDelayOfListeners(!0);do{for(R=!1,y=S._head;y;y=x)if(x=y.nextDirty,0===y.delay){if(h=y.sourceModel,p=y.row,d=y.column,C=h._getRowCalc(p,!1),(w=h._getColumnCalc(d,!1))&&w.delay)continue;v=h._getRangeCalc(!1),h.recalculateCell(p,d),S.removeDirty(y,0),y.adjustDelayOfListeners(!1),C&&C.adjustDelayOfListeners(!1),w&&w.adjustDelayOfListeners(!1),v&&v.adjustDelayOfListeners(p,d,!1),R=!0}for(i=S._headNamIDs;i;i=i.nextDirty)0===i.delay&&((h=i.sourceModel).recalculateNameID(i.name),S.removeDirty(i,3),i.adjustDelayOfListeners(!1),R=!0)}while(R);if(S._head){for(a=!0,s=0;a&&s<S.maximumIterations;s++)for(a=!1,y=S._head;y;y=x)x=y.nextDirty,l=y.sourceModel,p=y.row,d=y.column,u=l.getSource().getValue(p,d),l.recalculateCell(p,d),c=l.getSource().getValue(p,d),S._iterationChange(u,c)>=S.maximumChange&&(a=!0),y.nextDirty=_e,x&&(x.preDirty=_e);S._head=S._tail=_e}},e.prototype._iterationChange=function(e,t){var o=parseFloat(e),n=parseFloat(t);return we(n-o)},e.prototype.initParserContext=function(e){var t=this._parserContext;t||(this._parserContext=t=e.getParserContext(this.useR1C1,0,0,me))},e.prototype.getParserContext=function(e){var t=this._parserContext;return t||(e?this._parserContext=t=e.getParserContext(this.useR1C1,0,0,me):t=new Z(me,this.useR1C1,0,0,me)),t.setSource(e),t},e.prototype.parse=function(e,t,o,n,r,i){var a,s=this._parseCache,l=this.getParserContext(e);return l.useR1C1=!i&&this.useR1C1,l.ignoreError=r,l.row=o,l.column=n,s?(l.useR1C1||(l.useR1C1=!0,t=this._parser.a1ToR1C1(l,t)),s[t]||(a=this._parser.parse(t,l),s[t]=a,a)):this._parser.parse(t,l)},e.prototype.unparse=function(e,t,o,n){var r=this.getParserContext(e);return r.useR1C1=this.useR1C1,r.row=o,r.column=n,this._parser.unparse(t,r)},e.prototype.unparseWithoutCulture=function(e,t,o,n,r){var i,a=this.getParserContext(e);return a.row=o,a.column=n,a.useR1C1=this.useR1C1,a.source=e,r&&(a.toStandard=!0,a.useR1C1=!1),i=this._parser.unparseWithoutCulture(t,a),a.toStandard=!1,i},e.prototype.isDirtyCell=function(e){return!!e.preDirty||e===this._head},e.prototype.addDirty=function(e,t){var o=this._headNames[t],n=this._tailNames[t];e&&!e.preDirty&&e!==this[o]&&(this[o]?this[n].nextDirty=e:this[o]=e,e.preDirty=this[n],e.nextDirty=me,this[n]=e)},e.prototype.removeDirty=function(e,t){var o,n,r=this._headNames[t],i=this._tailNames[t];e&&(e.preDirty||e===this[r])&&(o=e.preDirty,n=e.nextDirty,o?o.nextDirty=n:this[r]=n,n?n.preDirty=o:this[i]=o,e.preDirty=me,e.nextDirty=me)},e.prototype.isDirtyRow=function(e){return e.preDirty||e===this._headRows},e.prototype.isDirtyColumn=function(e){return e.preDirty||e===this._headCols},e.prototype.evaluateParsedFormula=function(e,t,o,n,r,i,a,s,l,u){var c,h,p,d,f,g=e.getEvaluatorContext(o,n,r,a,s,l,u);if(c=5===arguments.length&&r?this._evaluator.evaluateExpression(t,g,i,!0):this._evaluator.evaluateExpression(t,g,i,!1),r&&arguments.length<=5)return c;if(G.ref(c)){if(h=c.getRowCount(0),p=c.getColumnCount(0),c.getRangeCount()<=0)return He;if(1!==c.getRangeCount())return Le;try{if(d=r?o-a:o-c.getRow(0),f=r?n-s:n-c.getColumn(0),1===h&&1===p)c=c.getValue(0,0,0);else if(1===h&&p>1&&f>=0&&f<p)c=c.getValue(0,0,f);else if(h>1&&1===p&&d>=0&&d<h)c=c.getValue(0,d,0);else{if(!(r&&d<h&&f<p))return r?Ve:Le;c=c.getValue(0,d,f)}}catch(e){return Le}}else if(G.arr(c))if(r){var m=c,_=m.getRowCount(),y=m.getColumnCount();if(1!=_&&o-a>=_||1!=y&&n-s>=y)return Ve;c=c.getValue(1==_?0:o-a,1==y?0:n-s)}else c=c.getValueByIndex(0);return c===_e||c===me?!1===i?c:0:c},e.prototype._getParserContext=function(e,t,o){this._parseCache;var n=this._parserContext;return n||(this._parserContext=n=e.getParserContext(this.useR1C1,0,0,me)),n.useR1C1=this.useR1C1,n.row=t,n.column=o,n},e.prototype.evaluate=function(e,t,o,n){return this._evaluator.evaluateFormula(t,e.getParserContext(this.useR1C1,o,n),e.getEvaluatorContext(o,n,!1),!1)},e}(),o.CalcService=b,(xe=o.ListenerActions||(o.ListenerActions={}))[xe.Adjust=0]="Adjust",xe[xe.dirty=1]="dirty",o.ListenerActions,T=function(){function e(e,t){this._lastNonNullRow=0,this._lastNonNullColumn=0,this._volatitleCells=[];this.dataTable={},this.dataTableByName={},this._rowDataArray=[],this._columnDataArray=[],this._defaultDataNode=me,this._source=t,this._service=e}return e.prototype.getNode=function(e,t,o){var n,r=this,i=me;return e>=0&&t>=0?(n=r.dataTable[e],o&&!n&&(n=r.dataTable[e]={},e>r._lastNonNullRow&&(r._lastNonNullRow=e)),n&&(i=n[t],o&&!i&&(i=n[t]={},t>r._lastNonNullColumn&&(r._lastNonNullColumn=t)))):-1===e&&t>=0?(i=r._columnDataArray[t],o&&!i&&(i=r._columnDataArray[t]={},t>r._lastNonNullColumn&&(r._lastNonNullColumn=t))):e>=0&&-1===t?(i=r._rowDataArray[e],o&&!i&&(i=r._rowDataArray[e]={},t>r._lastNonNullColumn&&(r._lastNonNullColumn=t))):-1===e&&-1===t&&(i=r._defaultDataNode,o&&!i&&(i=r._defaultDataNode={})),i},e.prototype.getNodeByName=function(e,t){var o=this.dataTableByName[e];return t&&!o&&(o=this.dataTableByName[e]={}),o},e.prototype._getExpr=function(e,t){var o=this.getNode(e,t);return o&&o.expr},e.prototype.getExpr=function(e,t){return this._getExpr(e,t)},e.prototype.getArray=function(e,t){return this._getArrayInfo(e,t)},e.prototype.clearAll=function(){this.clear(-1,-1,-1,-1),this.dataTable={},this.dataTableByName={},this._rowDataArray=[],this._columnDataArray=[],this._defaultDataNode=me},e.prototype.clear=function(e,t,o,n){this._clear(e,t,o,n)},e.prototype.addRows=function(e,o){var n,r=this.rC();if(!(e<0||e>r||o<0))for(t._ModelHelper.addElements(this.dataTable,r,e,o),t._ModelHelper.addElements(this._rowDataArray,r,e,o),n=0;n<o;n++)this.dataTable[e+n]&&(this.dataTable[e+n]={rs:"n"})},e.prototype.deleteRows=function(e,o){var n=this.rC();e<0||e>=n||o<=0||(e+o>n&&(o=n-e),t._ModelHelper.deleteElements(this.dataTable,n,e,o),t._ModelHelper.deleteElements(this._rowDataArray,n,e,o))},e.prototype.addColumns=function(e,o){var n,r,i=this.rC(),a=this.cC();if(!(e<0||e>a||o<0)){for(n=0;n<i;n++)(r=this.dataTable[n])&&e<a&&t._ModelHelper.addElements(r,a,e,o);t._ModelHelper.addElements(this._columnDataArray,a,e,o)}},e.prototype.deleteColumns=function(e,o){var n,r,i=this.rC(),a=this.cC();if(!(e<0||e>=a||o<0)){for(n=0;n<i;n++)(r=this.dataTable[n])&&e<a&&t._ModelHelper.deleteElements(r,a,e,o);t._ModelHelper.deleteElements(this._columnDataArray,a,e,o)}},e.prototype._setExpr=function(e,t,o){this.getNode(e,t,!0).expr=o},e.prototype._clearAllExpr=function(e,t){var o=this.getNode(e,t,!0);o&&(o.expr=_e,o.workingExpr&&(o.workingExpr=_e),o.arrayInfo&&(o.arrayInfo=_e),o.isVolatile&&this._removeVolatile(o))},e.prototype._copyExpr=function(e,o,n,r,i){var a,s=this.getNode(o,n);s&&s.expr&&(a=e.getNode(r,i,!0),s.arrayInfo&&(a.arrayInfo=new t.Range(r,i,s.arrayInfo.rowCount-(o-s.arrayInfo.row),s.arrayInfo.colCount-(n-s.arrayInfo.col))),a.expr=s.expr,s.workingExpr&&(a.workingExpr=s.workingExpr)),s&&s.isVolatile&&(a.isVolatile=!0)},e.prototype._containsNoe=function(e,t){var o=this.dataTable[e];return o&&o[t]},e.prototype._getWorkingExpr=function(e,t){var o=this.getNode(e,t);return o&&o.workingExpr},e.prototype._setWorkingExpr=function(e,t,o){this.getNode(e,t,!0).workingExpr=o},e.prototype._getArrayInfo=function(e,t){var o=this.getNode(e,t);return o&&o.arrayInfo},e.prototype._setArrayInfo=function(e,t,o){this.getNode(e,t,!0).arrayInfo=o},e.prototype._getCalc=function(e,t){var o=this.getNode(e,t);return o&&o.calc},e.prototype._setCalc=function(e,t,o){var n=this.getNode(e,t,!0);n&&(n.calc&&n.calc.isVolatile&&this._removeVolatile(n),n.calc=o,o&&(o.node=n))},e.prototype._setNode4Swap=function(e,t,o,n,r){var i;o>=0&&n>=0?((i=this.dataTable[o])||(i=this.dataTable[o]={}),i[n]=r,r&&r.calc&&delete r.calc):o>=0&&-1===n&&e>=0&&-1===t?this._rowDataArray[o]=r:n>=0&&-1===o&&t>=0&&-1===e&&(this._columnDataArray[n]=r)},e.prototype._swapNode=function(e,t,o,n){var r=this.getNode(e,t),i=this.getNode(o,n);r?this._setNode4Swap(e,t,o,n,r):i&&this._setNode4Swap(e,t,o,n,me),i?this._setNode4Swap(o,n,e,t,i):r&&this._setNode4Swap(o,n,e,t,me)},e.prototype._getAllVolatitles=function(){return this._volatitleCells},e.prototype._setVolatile=function(e){e.isVolatile||(e.isVolatile=!0,this._volatitleCells.push(e))},e.prototype._removeVolatile=function(e){var t,o,n;for(e.isVolatile=void 0,o=(t=this._volatitleCells).length,n=0;n<o;n++)if(t[n]===e)return void t.splice(n,1)},e.prototype._clearCore=function(e,t){for(var o,n=0;n<e.length;n++)(o=e[n])&&(1&t)>0&&(o.arrayInfo&&(o.arrayInfo=_e),o.expr&&(o.expr=_e),o.workingExpr&&(o.workingExpr=_e))},e.prototype.getCalcService=function(){return this._service},e.prototype.setCalcService=function(e){this._service=e},e.prototype.getSource=function(){return this._source},e.prototype.hasFormula=function(e,t){return e=e!==_e?e:-1,t=t!==_e?t:-1,!!this.getExpression(e,t)},e.prototype.setFormula=function(e,o,n,r){var i,a,s,l;if(n&&0===n.length&&(n=me),!r&&this._intersectWithArrayFormula(e,o,1,1)&&this._throwArrayPartException(),(i=this.getFormula(e,o))!==n&&(""!==i||n)&&(i||""!==n)){if(a=this.getCalcService(),s=me,a)try{s=n?a.parse(this._source,n,e>=0?e:0,o>=0?o:0,r,r):me,this.setExpression(e,o,s,_e,!1)}catch(e){if(!r)throw e}e>=0&&o>=0&&(l=""===t.Culture()||"en-us"===t.Culture(),this._source.setFormula(e,o,r||l?n:a.unparseWithoutCulture(this._source,s,e,o)))}},e.prototype.getFormula=function(e,t){var o,n,r=this.getCalcService();return r&&(o=this.getExpression(e,t))?(e=(n=this.getArrayInfo(e,t))?n.row:e,t=n?n.col:t,r.unparse(this._source,o,e,t)):me},e.prototype.setFormulaByName=function(e,o,n){var r,i,a,s,l;if(e&&(e=e.toUpperCase(),r=this,o&&0===o.length&&(o=me),(i=r.getFormulaByName(e))!==o&&(""!==i||o)&&(i||""!==o))){if(a=r.getCalcService(),s=me,a)try{s=o?a.parse(r._source,o,0,0,n):me,r.setExpressionByName(e,s,_e,!1)}catch(e){if(!n)throw e}l=""===t.Culture()||"en-us"===t.Culture(),r._source.setFormulaByName(e,n||l?o:a.unparseWithoutCulture(r._source,s,0,0))}},e.prototype.getFormulaByName=function(e){var t,o=this.getCalcService();return o&&e&&(t=this.getExpressionByName(e.toUpperCase()))?o.unparse(this._source,t,0,0):me},e.prototype._throwArrayPartException=function(){throw t.SR.Exp_ArrayFromulaPart},e.prototype.rC=function(){return Math.min(this._source.getRowCount())},e.prototype.cC=function(){return Math.min(this._source.getColumnCount())},e.prototype.setArrayFormula=function(e,o,n,r,i,a){var s,l,u,c;if(i&&0===i.length&&(i=me),this._intersectWithArrayFormula(e,o,n,r)&&this._throwArrayPartException(),e=e<0?0:e,o=o<0?0:o,(s=this.getCalcService())&&(this._clear(e,o,n,r),i)){try{l=i?s.parse(this._source,i,e,o,a,a):me}catch(e){if(!a)throw e;return}for(u=e;u<e+n;u++)for(c=o;c<o+r;c++)this.setExpression(u,c,l,new t.Range(e,o,n,r),!1);e>=0&&o>=0&&this._source.setArrayFormula(e,o,n,r,s.unparseWithoutCulture(this._source,l,e,o))}},e.prototype.getExprInfo=function(e,t,o){var n,r=me,i=this._source;return e>=i.getRowCount()||t>=i.getColumnCount()?r:(e>=0&&t>=0?((r=(n=this.getNode(e,t))&&n[o])||(r=(n=this.getNode(e,-1))&&n[o]),r||(r=(n=this.getNode(-1,t))&&n[o])):e>=0&&-1===t?r=(n=this.getNode(e,-1))&&n[o]:-1===e&&t>=0?r=(n=this.getNode(-1,t))&&n[o]:r=(n=this.getNode(-1,-1))&&n[o],r)},e.prototype.getArrayInfo=function(e,t){return this.getExprInfo(e,t,"arrayInfo")},e.prototype.getWorkingExpression=function(e,t){return this.getExprInfo(e,t,"workingExpr")},e.prototype.getExpression=function(e,t){return this.getExprInfo(e,t,"expr")},e.prototype.getWorkingExpressionByName=function(e){var t=this.getNodeByName(e);return t&&t.workingExpr},e.prototype.getExpressionByName=function(e){var t=this.getNodeByName(e);return t&&t.expr},e.prototype.setExpression=function(e,t,o,n,r){var i,a,s=this.getCalcService(),l=n!==_e&&null!==n,u=new Q(this._source,l,l?n.row:e,l?n.col:t),c=K._mappingArray(u,o,l,l?e-n.row:0,l?t-n.col:0);c=c===o?_e:c,n!==_e&&(i=n),e>=0&&t>=0?((r===_e||r)&&(a=o?s.unparseWithoutCulture(this._source,o,e>=0?e:0,t>=0?t:0):_e,this._source.setFormula(e,t,a)),this._setCellExpression(e,t,o,c,i)):e>=0&&-1===t?this._setRowExpression(e,o,c):-1===e&&t>=0&&this._setColumnExpression(t,o,c),s.autoCalculation&&!s.IsSuspended()&&s.recalculateAll(!1)},e.prototype.setExpressionByName=function(e,t,o,n){var r,i=this.getCalcService(),a=new Q(this._source,!1,0,0),s=K._mappingArray(a,t,!1,0,0);s=s===t?_e:s,(n===_e||n)&&(r=t?i.unparseWithoutCulture(this._source,t,0,0):_e,this._source.setFormulaByName(e,r)),this._setNameExpression(e,t,s),i.autoCalculation&&!i.IsSuspended()&&i.recalculateAll(!1)},e.prototype.getRowExpression=function(e){return this.getExpression(e,-1)},e.prototype.getColumnExpression=function(e){return this.getExpression(-1,e)},e.prototype._setNameExpression=function(e,t,o){var n,r=this._getNameIDCalc(e,!0);r&&(r.stopListening(),(n=this.getNodeByName(e,!0)).expr=t,o=t&&o?o:void 0,n.workingExpr=o,r.startListening(),this._service.addDirty(r,3))},e.prototype._setCellExpression=function(e,t,o,n,r){var i,a=this;(i=a._getCellCalc(e,t,!0))&&(i.stopListening(),a._setExpr(e,t,o),o?((n||a._getWorkingExpr(e,t))&&a._setWorkingExpr(e,t,n),(r||a.getArrayInfo(e,t))&&a._setArrayInfo(e,t,r)):(a._setWorkingExpr(e,t,_e),a._setArrayInfo(e,t,_e)),i.startListening(),a._service.addDirty(i,0))},e.prototype._setRowExpression=function(e,t,o){var n=this._getRowCalc(e,!0);n&&(n.stopListening(),this._setExpr(e,-1,t),(o||this._getWorkingExpr(e,-1))&&this._setWorkingExpr(e,-1,o),n.startListening(),this._service.addDirty(n,1))},e.prototype._setColumnExpression=function(e,t,o){var n=this._getColumnCalc(e,!0);n&&(n.stopListening(),this._setExpr(-1,e,t),(o||this._getWorkingExpr(-1,e))&&this._setWorkingExpr(-1,e,o),n.startListening(),this._service.addDirty(n,2))},e.prototype._clear=function(e,o,n,r){for(var i,a,s,l,u=this,c=e<0?0:e,h=o<0?0:o,p=c+(e<0?u.rC():n)-1,d=h+(o<0?u.cC():r)-1,f=(u.getCalcService(),function(e,o){if(a=u._getWorkingExpr(e,o),s=u._getExpr(e,o),a||s){var n=(l=u._getArrayInfo(e,o))?new t.Range(l.row,l.col,l.rowCount,l.colCount):_e;u.setExpression(e,o,me,n,!0)}}),g=c;g<=p&&g>=0;g++)for(o<0&&f(g,-1),i=h;i<=d&&i>=0;i++)g===c&&e<0&&f(-1,i),f(g,i);e<0&&o<0&&f(e,o)},e.prototype._intersectWithArrayFormula=function(e,t,o,n){return this._getFormulaExps(e,t,o,n,!0,!0)},e.prototype._getFormulaExps=function(e,o,n,r,i,a){for(var s,l,u,c,h,p=e<0?0:e,d=o<0?0:o,f=e<0?this.rC():n,g=o<0?this.cC():r,m=p+(0===f?1:f)-1,_=d+(0===g?1:g)-1,y=(this.getCalcService(),!1),C=[],w=[],v=this.dataTable,S=p;S<=m&&S>=0&&!(S>this._lastNonNullRow);S++)if(h=v[S])for(s=d;s<=_&&s>=0&&!(s>this._lastNonNullColumn);s++)if(c=h[s])if(l=c.arrayInfo){if(l.row<p||l.row+l.rowCount-1>m||l.col<d||l.col+l.colCount-1>_){if(i)return!0;y=!0}if(S!==l.row&&S!==p)continue;C.push(new t.Range(l.row,l.col,l.rowCount,l.colCount)),u=c.expr,w.push(u),s=l.col+l.colCount-1}else!a&&(u=c.expr)&&(C.push({row:S,col:s}),w.push(u));return!i&&{hasPart:y,ranges:C,formulas:w}},e.prototype._getNameIDCalc=function(e,t){var o=me,n=this.getNodeByName(e,t);return n&&(!(o=n.calc)&&t&&(o=new M(this,e),n.calc=o,o.node=n)),o},e.prototype._getCellCalc=function(e,t,o){var n,r,i,a=this,s=me;if(e>=0&&t>=0){if(!(r=(n=a.dataTable)[e])){if(!o)return s;r=n[e]={},e>a._lastNonNullRow&&(a._lastNonNullRow=e)}if(!(i=r[t]))return o&&(i=r[t]={},s=new A(a,e,t),i.calc=s,s.node=i,t>a._lastNonNullColumn&&(a._lastNonNullColumn=t)),s;!(s=i.calc)&&o&&(s=new A(a,e,t),i.calc=s,s.node=i,e>a._lastNonNullRow&&(a._lastNonNullRow=e),t>a._lastNonNullColumn&&(a._lastNonNullColumn=t))}return s},e.prototype._getRowCalc=function(e,t){var o=me;return e>=0&&(!(o=this._getCalc(e,-1))&&t&&(o=new I(this,e),this._setCalc(e,-1,o),e>this._lastNonNullRow&&(this._lastNonNullRow=e))),o},e.prototype._getColumnCalc=function(e,t){var o=me;return e>=0&&(!(o=this._getCalc(-1,e))&&t&&(o=new D(this,e),this._setCalc(-1,e,o),e>this._lastNonNullColumn&&(this._lastNonNullColumn=e))),o},e.prototype._getRangeCalc=function(e){return!this._rangeCalc&&e&&(this._rangeCalc=new E(this)),this._rangeCalc},e.prototype._getNameCalc=function(e,t){var o=me;return this._nameCalcs||(this._nameCalcs={}),!(o=this._nameCalcs[e])&&t&&(o=this._nameCalcs[e]=new F(this,e)),o},e.prototype._addColumnsToDirty=function(e,t){for(var o,n=Math.min(this._lastNonNullColumn,e+t-1),r=e;-1!==r&&r<=n;r++)this.isDirty(-1,r)&&(o=this._getColumnCalc(r,!0),this._service.addDirty(o,2))},e.prototype._addRowsToDirty=function(e,t){for(var o,n=Math.min(this._lastNonNullRow,e+t-1),r=e;-1!==r&&r<=n;r++)this.isDirty(r,-1)&&(o=this._getRowCalc(r,!0),this._service.addDirty(o,1))},e.prototype._addCellsToDirty=function(e,t,o,n){for(var r,i,a,s=Math.min(this._lastNonNullRow,e+o-1),l=Math.min(this._lastNonNullColumn,t+n-1),u=e;u<=s;u++)for(r=t;r<=l;r++)this._containsNoe(u,r)&&(i=this._getCellCalc(u,r,!0),this._service.addDirty(i,0));this._addRowsToDirty(e,o),this._addColumnsToDirty(t,n),(a=this._getRangeCalc(!1))&&a.addListenersToDirty(e,t,o,n)},e.prototype._addVolatitlesToDirty=function(){for(var e,t,o,n,r=this,i=r._getAllVolatitles(),a=0;a<i.length;a++)(e=i[a])&&e instanceof A&&!r._service.isDirtyCell(e)&&(t=r._getCellCalc(e.row,e.column,!0),r._service.addDirty(t,0),(o=r._getRowCalc(e.row,!1))&&!r._service.isDirtyRow(o)&&r._addRowsToDirty(e.row,1),(n=r._getColumnCalc(e.column,!1))&&!r._service.isDirtyRow(n)&&r._addColumnsToDirty(e.column,1))},e.prototype._checkAndUpdateVolatitles=function(){for(var e,t,o,n,r,i=this,a=i._getAllVolatitles(),s=!0,l=5;s&&l;){for(s=!1,l--,o=0;o<a.length;o++)(n=a[o])&&n instanceof A&&!i._service.isDirtyCell(n)&&i.recalculateCell(n.row,n.column)&&(s=!0,r=i._getCellCalc(n.row,n.column,!0),i._service.addDirty(r,0),(e=i._getRowCalc(n.row,!1))&&!i._service.isDirtyRow(e)&&i._addRowsToDirty(n.row,1),(t=i._getColumnCalc(n.column,!1))&&!i._service.isDirtyRow(t)&&i._addColumnsToDirty(n.column,1));s&&i._service._recalculateImp(!0)}},e.prototype.isDirty=function(e,t){return!(!this._getCalc(e,t)&&!this._getExpr(e,t))},e.prototype.recalculateCell=function(e,t){var o,n=this._source,r=this.getWorkingExpression(e,t)||this.getExpression(e,t);if(r){var i,a,s,l,u=n.getValue(e,t),c=!1,h=this.getArrayInfo(e,t);if(h&&(c=!0,i=h.row,a=h.col,s=h.rowCount,l=h.colCount),u===(o=this._service.evaluateParsedFormula(this._source,r,e,t,c,!0,i,a,s,l)))return;return!(u instanceof Date&&o instanceof Date&&u.valueOf()===o.valueOf())&&(n.setValue(e,t,o),!0)}return!1},e.prototype.recalculateNameID=function(e){var t,o,n=this._source,r=this.getWorkingExpressionByName(e)||this.getExpressionByName(e);if(r){if((t=n.getValueByName(e))===(o=this._service.evaluateParsedFormula(this._source,r,0,0,!1,!0,0,0,1,1)))return;if(t instanceof Date&&o instanceof Date&&t.valueOf()===o.valueOf())return;n.setValueByName(e,o)}},e.prototype._dealWithExpression=function(e,t,n,r,i,a){for(var s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O,P,L,H=this;24===r.t;)r=r.expr;for(;14===r.t;)r=r.argument;for(;24===r.t;)r=r.expr;if(17===r.t){if((s=r.getRange(t,n,!0))===me)return;r=1===s.rowCount&&1===s.columnCount?new K.CellExpression(s.row,s.column,!1,!1):new K.RangeExpression(s.row,s.column,s.row+s.rowCount-1,s.column+s.columnCount-1,!1,!1,!1,!1)}if(i&&i!==r&&(8===i.t||9===i.t)&&(F=i.name.toUpperCase(),(v=i.source||H._source).getCustomName(F)?S=v.getCalcSourceModel():(S=H._service.getGlobalSourceModel()).getSource().getCustomName(F)||v.getCalcSourceModel()._getNameCalc(F,!0).processCellListener(e,a),(M=S._getNameCalc(F,!0)).processCellListener(e,a),i=null),0===r.t||1===r.t){if(x=r,S=(v=r.source||H._source).getCalcSourceModel(),0<=t&&0<=n){if(l=x.row+(x.rowRelative?t:0),u=x.column+(x.columnRelative?n:0),!(m=S._getCellCalc(l,u,!0)))return;m.processCellListener(e,a)}else if(0<=t&&-1===n)if(l=x.row+(x.rowRelative?t:0),u=x.column,x.columnRelative){if(!(_=S._getRowCalc(l,!0)))return;_.processRowListener2(e,-u,a)}else{if(!(m=S._getCellCalc(l,u,!0)))return;m.processRowListener(e,a)}else if(-1===t&&0<=n)if(l=x.row,u=x.column+(x.columnRelative?n:0),x.rowRelative){if(!(y=S._getColumnCalc(u,!0)))return;y.processColumnListener2(e,-l,a)}else{if(!(m=S._getCellCalc(l,u,!0)))return;m.processColumnListener(e,a)}}else if(2===r.t||3===r.t)if(S=(v=r.source||H._source).getCalcSourceModel(),(b=(R=r)._getRangeType())===X.cell){if(0<=t&&0<=n)if(c=R.startRow+(R.startRowRelative?t:0),p=R.startColumn+(R.startColumnRelative?n:0),h=R.endRow+(R.endRowRelative?t:0),d=R.endColumn+(R.endColumnRelative?n:0),f=we(h-c)+1,g=we(d-p)+1,H.shouldUseRange(l,u,f,g)){if(!(T=S._getRangeCalc(!0)))return;T.processCellListener(c,p,f,g,e,a)}else for(C=c;C<=h;C++)for(w=p;w<=d;w++)(m=S._getCellCalc(C,w,!0))&&m.processCellListener(e,a);else if(0<=t&&-1===n)for(c=R.startRow+(R.startRowRelative?t:0),p=R.startColumn,h=R.endRow+(R.endRowRelative?t:0),d=R.endColumn,C=c;C<=h;C++)for(w=p;w<=d;w++)R.startColumnRelative||R.endColumnRelative?(_=S._getRowCalc(C,!0))&&_.processRowListener2(e,-w,a):(m=S._getCellCalc(C,w,!0))&&m.processRowListener(e,a);else if(-1===t&&0<=n)for(c=R.startRow,p=R.startColumn+(R.startColumnRelative?n:0),h=R.endRow,d=R.endColumn+(R.endColumnRelative?n:0),C=c;C<=h;C++)for(w=p;w<=d;w++)R.startRowRelative||R.endRowRelative?(y=S._getColumnCalc(w,!0))&&y.processColumnListener2(e,-C,a):(m=S._getCellCalc(C,w,!0))&&m.processColumnListener(e,a)}else if(b===X.row){if(0<=t&&0<=n)for(c=R.startRow+(R.startRowRelative?t:0),h=R.endRow+(R.endRowRelative?t:0),C=c;C<=h;C++)(_=S._getRowCalc(C,!0))&&_.processCellListener(e,a);else if(!(0<=t&&-1===n||-1!==t||!(0<=n)||R.startRowRelative||R.endRowRelative))for(c=R.startRow,h=R.endRow,C=c;C<=h;C++)(_=S._getRowCalc(C,!0))&&_.processColumnListener(e,a)}else if(b===X.column){if(0<=t&&0<=n)for(p=R.startColumn+(R.startColumnRelative?n:0),d=R.endColumn+(R.endColumnRelative?n:0),w=p;w<=d;w++)(y=S._getColumnCalc(w,!0))&&y.processCellListener(e,a);else if((!(0<=t)||-1!==n)&&-1===t&&0<=n)for(p=R.startColumn+(R.startColumnRelative?n:0),d=R.endColumn+(R.endColumnRelative?n:0),w=p;w<=d;w++)(y=S._getColumnCalc(w,!0))&&y.processColumnListener(e,a)}else X.sheet;else if(16===r.t)for(I=(A=r).startSource.getSources(A.endSource),O=0;O<I.length;O++)D=new K.ExternalRangeExpression(I[O],A.startRow,A.startColumn,A.endRow,A.endColumn,A.startRowRelative,A.startColumnRelative,A.endRowRelative,A.endColumnRelative),A.isFullRow?D.initBand(I[O],A.startRow,A.endRow,A.startRowRelative,A.endRowRelative,!0):A.isFullColumn&&D.initBand(I[O],A.startColumn,A.endColumn,A.startColumnRelative,A.endColumnRelative,!1),H._dealWithExpression(e,t,n,D,me,a);else if(11===r.t)H._dealWithExpression(e,t,n,r.operand,i&&11===i.t&&i.operand,a);else if(10===r.t)H._dealWithExpression(e,t,n,r.left,i&&10===i.t&&i.left,a),H._dealWithExpression(e,t,n,r.right,i&&10===i.t&&i.right,a);else if(8===r.t||9===r.t){if(v=r.source||H._source,F=r.name.toUpperCase(),v.getCustomName(F)?S=v.getCalcSourceModel():(S=H._service.getGlobalSourceModel()).getSource().getCustomName(F)||v.getCalcSourceModel()._getNameCalc(F,!0).processCellListener(e,a),!(M=S._getNameCalc(F,!0)))return;M.processCellListener(e,a),H._dealWithExpression(e,t,n,v.getCustomName(r.name),me,a)}else if(7===r.t){if((E=r).fn&&E.fn instanceof o.Functions.Function&&(E.fn.isVolatile()&&(a?H._setVolatile(e):H._removeVolatile(e)),!E.fn.precedentReference()))return;for(N=E.argCount(),O=0;O<N;O++)H._dealWithExpression(e,t,n,E.getArg(O),i&&7===i.t&&i.getArg(O),a)}else if(25===r.t||26===r.t){if(P=r,!(L=(S=(v=r.source||H._source).getCalcSourceModel())._getNameIDCalc(P.nameIdentity,!0)))return;L.processCellListener(e,a)}},e.prototype.shouldUseRange=function(e,t,o,n){return-1===e&&n>127||-1===t&&o>127||o*n>127},e.prototype.dealWithNameIDExpression=function(e,t){var o=this.getNodeByName(e);o&&(o.workingExpr||o.expr)&&this._dealWithExpression(this._getNameIDCalc(e),0,0,o.workingExpr||o.expr,o.expr,t)},e.prototype.dealWithCellExpression=function(e,t,o,n,r){for(var i,a,s,l,u=e+o,c=t+n,h=e;h<u;h++)for(i=t;i<c;i++)a=this._getWorkingExpr(h,i),s=this._getExpr(h,i),(a||s)&&((l=this._getArrayInfo(h,i))?this._dealWithExpression(this._getCellCalc(h,i),l.row,l.col,a||s,s,r):this._dealWithExpression(this._getCellCalc(h,i),h,i,a||s,s,r))},e.prototype._dealWithColumnExpression=function(e,t,o){for(var n,r=e+t,i=e;-1!==i&&i<r;i++)(n=this.getColumnExpression(i))&&this._dealWithExpression(this._getColumnCalc(i,!1),-1,i,n,n,o)},e.prototype.linkCellExpression=function(e,t,o,n){this.dealWithCellExpression(e,t,o,n,!0)},e.prototype.unlinkCellExpression=function(e,t,o,n){this.dealWithCellExpression(e,t,o,n,!1)},e.prototype.linkRowExpression=function(e,t){},e.prototype.unlinkRowExpression=function(e,t){},e.prototype.linkColumnExpression=function(e,t){this._dealWithColumnExpression(e,t,!0)},e.prototype.unlinkColumnExpression=function(e,t){this._dealWithColumnExpression(e,t,!1)},e.prototype._iterateEachCell=function(e,t,o,n,r,i){for(var a,s,l=e+o,u=t+n,c=e;c<l;c++)for(a=t;a<u;a++)(s=this._getCellCalc(c,a,!1))&&(r&&s.addListenersToAdjust(),i&&s.addListenersToDirty())},e.prototype._iterateEachRow=function(e,t,o,n){var r,i,a,s=this._rowDataArray;if(s)for(r=e;-1!==r&&r<e+t&&r<s.length;r++)(i=s[r])&&i.calc&&(a=i.calc,o&&a.addListenersToAdjust(),n&&a.addListenersToDirty())},e.prototype._iterateEachColumn=function(e,t,o,n){var r,i,a,s=this._columnDataArray;if(s)for(r=e;-1!==r&&r<e+t&&r<s.length;r++)(i=s[r])&&i.calc&&(a=i.calc,o&&a.addListenersToAdjust(),n&&a.addListenersToDirty())},e.prototype.addDependents=function(e,t,o,n,r,i){var a,s,l;(r||i)&&(a=this,0<=e&&0<=t?(a._iterateEachCell(e,t,o,n,r,i),a._iterateEachRow(e,o,r,i),a._iterateEachColumn(t,n,r,i),a._rangeCalc&&(r&&a._rangeCalc.addListenersToAdjust(e,t,o,n),i&&a._rangeCalc.addListenersToDirty(e,t,o,n))):0<=e&&-1===t?(a._iterateEachCell(e,0,o,a.cC(),r,i),a._iterateEachRow(e,o,r,i),a._rangeCalc&&(r&&a._rangeCalc.addListenersToAdjust(e,t,o,n),i&&a._rangeCalc.addListenersToDirty(e,t,o,n))):-1===e&&0<=t?(a._iterateEachCell(0,t,a.rC(),n,r,i),a._iterateEachColumn(t,n,r,i),a._rangeCalc&&(r&&a._rangeCalc.addListenersToAdjust(e,t,o,n),i&&a._rangeCalc.addListenersToDirty(e,t,o,n))):-1===e&&-1===t&&(s=a.rC(),l=a.cC(),a._iterateEachCell(0,0,s,l,r,i),a._iterateEachRow(0,s,r,i),a._iterateEachColumn(0,l,r,i),a._rangeCalc&&(r&&a._rangeCalc.addListenersToAdjust(e,t,o,n),i&&a._rangeCalc.addListenersToDirty(e,t,o,n))))},e.prototype.getAllNodes=function(){var e,t,o,n=[],r=this.dataTable,i=this._rowDataArray,a=this._columnDataArray,s=this._defaultDataNode;for(t in s&&n.push(s),i)n.push(i[t]);for(t in a)n.push(a[t]);for(o in r)for(t in e=r[o])n.push(e[t]);return n},e.prototype.toJSON=function(e){this._source.toJSON(e,this.dataTable)},e}(),o.CalcSourceModel=T;var be="cellListeners",Te="rowListeners",Ae="columnListeners",Ie="rowSliceListeners",De="columnSliceListeners",Fe=function(){function e(e){this.cellListeners=[],this.rowListeners=[],this.columnListeners=[],this.sourceModel=e}return e.prototype.hasListeners=function(){for(var e,t=this._listeners,o=0;o<t.length;o++)if((e=this[t[o]])&&e.length>0)return!0;return!1},e.prototype.processCellListener=function(e,t){var o,n=this.cellListeners;if(t)n.push(e);else for(o=0;o<n.length;o++)if(n[o]===e)return void n.splice(o,1)},e.prototype.processRowListener=function(e,t){var o,n=this.rowListeners;if(t)n.push(e);else for(o=0;o<n.length;o++)if(n[o]===e)return void n.splice(o,1)},e.prototype.processColumnListener=function(e,t){var o,n=this.columnListeners;if(t)n.push(e);else for(o=0;o<n.length;o++)if(n[o]===e)return void n.splice(o,1)},e.prototype.addListenersToAdjust=function(){for(var e,t,o,n=this._listeners,r=0;r<n.length;r++)if(e=this[n[r]])for(t=e.length,o=0;o<t;o++)e[o].addToAdjust()},e.prototype.addListenersToDirty=function(){for(var e,t,o,n,r=this._listeners,i=0;i<r.length;i++)if(e=this[r[i]])for(t=e.length,o=0;o<t;o++)(n=e[o]).preDirty||n.nextDirty||n.addToDirty()},e.prototype.adjustDelayOfListeners=function(e){for(var t,o,n,r=this._listeners,i=e?1:-1,a=0;a<r.length;a++)if(t=this[r[a]])for(o=t.length,n=0;n<o;n++)t[n].delay+=i},e.prototype.addToAdjust=function(){},e.prototype.addToDirty=function(){},e.prototype.stopListening=function(){},e.prototype.startListening=function(){},e}();o.BaseCalc=Fe,A=function(e){function t(t,o,n){e.call(this,t);this.row=o,this.column=n,this.delay=0,this._listeners=[be,Te,Ae]}return __extends(t,e),t.prototype.startListening=function(){this.sourceModel.linkCellExpression(this.row,this.column,1,1)},t.prototype.stopListening=function(){this.sourceModel.unlinkCellExpression(this.row,this.column,1,1)},t.prototype.addToAdjust=function(){this.sourceModel.getCalcService().getOperatorAdjustor().addAdjust(this,0)},t.prototype.addToDirty=function(){this.sourceModel.getCalcService().addDirty(this,0)},t}(Fe),o.CellCalc=A,I=function(e){function t(t,o){e.call(this,t);this.row=o,this._listeners=[be,Te,Ie,Ae]}return __extends(t,e),t.prototype.incrementDelay2=function(e,t){},t.prototype.decrementDelay2=function(e,t){},t.prototype.startListening=function(){this.sourceModel.linkRowExpression(this.row,1)},t.prototype.stopListening=function(){this.sourceModel.unlinkRowExpression(this.row,1)},t.prototype.processRowListener2=function(e,t,o){var n,r,i;o?(i={row:e,columnOffset:t,columnCount:1},(n=this)[r=Ie]||(n[r]=[]),n[r].push(i)):function(e,t,o){var n,r=e[t];if(r)for(n=0;n<r.length;n++)if(r[n]===o)return void r.splice(n,1)}(this,Ie,{row:e,columnOffset:t,columnCount:1})},t.prototype.addToAdjust=function(){this.sourceModel.getCalcService().getOperatorAdjustor().addAdjust(this,1)},t.prototype.addToDirty=function(){this.sourceModel.getCalcService().addDirty(this,1)},t}(Fe),o.RowCalc=I,D=function(e){function t(t,o){e.call(this,t);this.column=o,this._listeners=[be,Te,Ae,De]}return __extends(t,e),t.prototype.incrementDelay2=function(e,t){},t.prototype.decrementDelay2=function(e,t){},t.prototype.startListening=function(){this.sourceModel.linkColumnExpression(this.column,1)},t.prototype.stopListening=function(){this.sourceModel.unlinkColumnExpression(this.column,1)},t.prototype.processColumnListener2=function(e,t,o){this.processColumnListener(e,o)},t.prototype.addToAdjust=function(){this.sourceModel.getCalcService().getOperatorAdjustor().addAdjust(this,2)},t.prototype.addToDirty=function(){this.sourceModel.getCalcService().addDirty(this,2)},t}(Fe),o.ColumnCalc=D,F=function(e){function t(t,o){e.call(this,t),this.name=o,this._listeners=[be,Te,Ae]}return __extends(t,e),t.prototype.updateListening=function(e,t){for(var o,n,r,i,a,s=this._listeners,l=0;l<s.length;l++)if(o=this[s[l]])for(n=o.length,r=0;r<n;r++)a=(i=o[r]).node,i.stopListening(),a&&(!a.arrayInfo||a.arrayInfo.row===i.row&&a.arrayInfo.col===i.column)&&i.sourceModel.setExpression(i.row,i.column,a.expr,a.arrayInfo,!0)},t.prototype.updateListeningOnRemoved=function(){for(var e,t,o,n,r,i,a,s,l,u,c=this._listeners,h=this.sourceModel,p=h.getCalcService(),d=0;d<c.length;d++)if(e=this[c[d]])for(t=e.length,o=0;o<t;o++)a=(i=e[o]).sourceModel,s=i.row,l=i.col,s=s===_e?-1:s,l=l===_e?-1:l,u=a.getExpr(s,l),n=a.getArrayInfo(s,l),u&&((r=p.getOperatorAdjustor().adjustFormulaOnRemoveName(h,u,this.name))!==u&&a.setExpression(s,l,r,n,!0))},t.prototype.addToDirty=function(){for(var e,t,o,n=this._listeners,r=0;r<n.length;r++)if(e=this[n[r]])for(t=e.length,o=0;o<t;o++)e[o].addToDirty()},t}(Fe),o.NameCalc=F,M=function(e){function t(t,o){e.call(this,t);this.name=o,this.delay=0,this._listeners=[be,Te,Ae]}return __extends(t,e),t.prototype.startListening=function(){this.sourceModel.dealWithNameIDExpression(this.name,!0)},t.prototype.stopListening=function(){this.sourceModel.dealWithNameIDExpression(this.name,!1)},t.prototype.addToAdjust=function(){this.sourceModel.getCalcService().getOperatorAdjustor().addAdjust(this,3)},t.prototype.addToDirty=function(){this.sourceModel.getCalcService().addDirty(this,3)},t}(Fe),o.NameIDCalc=M,E=function(){function e(e){this.sourceModel=e,this._listeners=[be,Te,Ae]}return e.prototype.processListener=function(e,t,o,n,r,i,a){var s,l,u=this[e],c=t+","+o+","+n+","+r;if(u||(this[e]=u={}),!(s=u[c])){if(!a)return;(s=u[c]=[]).row=t,s.column=o,s.rowCount=n,s.columnCount=r}if(a){for(l=0;l<s.length;l++)if(s[l]===i)return;s.push(i)}else for(l=0;l<s.length;l++)s[l]===i&&s.splice(l,1)},e.prototype.processCellListener=function(e,t,o,n,r,i){this.processListener(be,e,t,o,n,r,i)},e.prototype.processRowListener=function(e,t,o,n,r,i,a,s,l){this.processListener(Te,e,t,o,n,r,l)},e.prototype.processColumnListener=function(e,t,o,n,r,i,a,s,l){this.processListener(Ae,e,t,o,n,r,l)},e.prototype.addListenersToAdjust=function(e,t,o,n){this.visit(0,e,t,o,n)},e.prototype.visit=function(e,t,o,n,r){for(var i,a,s,l,u,c=this._listeners,h=0;h<c.length;h++)if(i=this[c[h]])for(u in i){var p=i[u],d=p.row,f=p.column,g=p.rowCount,m=p.columnCount;if((-1===d||-1===t||d<t+n&&t<d+g)&&(-1===f||-1===o||f<o+r&&o<f+m))for(a=p.length,s=0;s<a;s++)l=p[s],0===e?l.addToAdjust():l.addToDirty()}},e.prototype.addListenersToDirty=function(e,t,o,n){this.visit(1,e,t,o,n)},e.prototype.adjustDelayOfListeners=function(e,t,o){for(var n,r,i,a,s,l,u=this._listeners,c=o?1:-1,h=0;h<u.length;h++)if(n=this[u[h]])for(r in n)if((-1===(l=i=n[r]).row||l.row<=e&&e<l.row+l.rowCount)&&(-1===l.column||l.column<=t&&t<l.column+l.columnCount))for(a=i.length,s=0;s<a;s++)i[s].delay+=c},e.prototype.startListening=function(){},e.prototype.stopListening=function(){},e}(),o.RangeCalc=E,N=function(){function e(e,t){this._error=e,this._code=t}return e.prototype.toString=function(){return this._error},e.parse=function(t){var o=e._parseCore(t);if(o===_e)throw"Incorrect error!";return o},e._parseCore=function(t){var o,n;if(typeof t!==ie&&t!==me&&""!==t)for(o=0;o<de.length;o++)if((n=de[o])===t||n===t.toUpperCase())return new e(n,fe[o]);return _e},e.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},e}(),o.CalcError=N;var Me,Ee,Ne,Oe=new N("#NULL!",0),Pe=new N("#DIV/0!",7),Le=new N("#VALUE!",15),He=new N("#REF!",23),ke=new N("#NAME?",29),Ve=new N("#N/A",42),Be=new N("#NUM!",36),ze=function(){function e(){}return e.Null=Oe,e.DivideByZero=Pe,e.Value=Le,e.Reference=He,e.Name=ke,e.NotAvailable=Ve,e.Number=Be,e}();o.Errors=ze,O=function(){function e(){}return e.prototype.getRowCount=function(){return 1},e.prototype.getColumnCount=function(){return 1},e.prototype.length=function(){return this.getRowCount()*this.getColumnCount()},e.prototype.getValueByIndex=function(e){var t=this.getColumnCount(),o=parseInt(e/t,10),n=e%t;return this.getValue(o,n)},e.prototype.getValue=function(e,t){return me},e.prototype.toArray=function(e,t,o,n,r){var i,a,s,l,u,c,h=[],p=G.CalcConvertedError;for(t=t===_e||t,i=this.getRowCount(),a=this.getColumnCount(),u=0;u<i;u++)for(t||(l=[],h.push(l)),c=0;c<a;c++){if(s=this.getValue(u,c),o&&G.err(s))return(h=[s]).isError=!0,h;if(s=G.convertValue(s,e,!1,r),n&&s===p)return(h=[s]).isError=!0,h;t?h.push(s):l.push(s)}return h.rowCount=i,h.colCount=a,h.rangeCount=1,h},e.prototype.slice=function(e,t,o,n){throw"slice function not implement."},e}(),o.CalcArray=O,P=function(e){function t(t,o){var n,r;if(e.call(this),this,n=t.length,this._array=t,this._rowCount=n,arguments.length<2)for(o=0,r=0;r<n;r++)o=Ce(t[r].length,o);this._columnCount=o}return __extends(t,e),t.prototype.getRowCount=function(){return this._rowCount},t.prototype.getColumnCount=function(){return this._columnCount},t.prototype.getValue=function(e,t){return this._array[e][t]},t.prototype.toArray=function(e,t,o,n,r){var i,a,s,l,u,c,h,p,d=[],f=this._array,g=G.CalcConvertedError;if(0===(i=f.length))return d.isError=!0,d;for(c=G.convertArray(f,e,!1),a=f[0].length,h=0;h<i;h++)for(t||(l=[],d.push(l)),u=c[h],p=0;p<a;p++){if(s=u[p],o&&G.err(s))return(d=[s]).isError=!0,d;if(s=G.convertValue(s,e,!1),n&&s===g)return(d=[Le]).isError=!0,d;t?d.push(s):l.push(s)}return d.rowCount=i,d.colCount=a,d.rangeCount=1,d},t.prototype.slice=function(e,o,n,r){var i,a,s,l=this._array,u=[];for(o=o<0?0:o,n=(e=e<0?0:e)+n>this._rowCount?this._rowCount-e:n,r=o+r>this._columnCount?this._columnCount-o:r,a=0;a<n;a++)for(i=[],u.push(i),s=0;s<r;s++)i.push(l[a+e][s+o]);return new t(u)},t}(O),o._ConcreteArray=P,L=function(){function e(){}return e.prototype.getRangeCount=function(){return 1},e.prototype.getRow=function(e){return 0},e.prototype.getColumn=function(e){return 0},e.prototype.getRowCount=function(e){return 0},e.prototype.getColumnCount=function(e){return 0},e.prototype.getValue=function(e,t,o){return me},e.prototype.isSubtotal=function(e,t,o){return!1},e.prototype.isHiddenRow=function(e,t,o){return!1},e.prototype.getSource=function(){return me},e.prototype.create=function(e){throw"create not implement."},e.prototype.toArray=function(e,t,o,n,r){var i,a,s,l,u,c,h,p,d,f=[],g=G.CalcConvertedError;if(t=t===_e||t,0===(s=this.getRangeCount()))return f.isError=!0,[];if(0===(i=this.getRowCount(0)))return f.isError=!0,[];if(0===(a=this.getColumnCount(0)))return f.isError=!0,[];for(h=0;h<s;h++)for(t||(u=[],f.push(u)),p=0;p<i;p++)for(t||(c=[],u.push(c)),d=0;d<a;d++){if(l=this.getValue(h,p,d),o&&G.err(l))return(f=[l]).isError=!0,f;if(l=G.convertValue(l,e,!0,r),n&&l===g)return(f=[Le]).isError=!0,f;t?f.push(l):c.push(l)}return t||1!==s||(f=f[0]),f.rowCount=i,f.colCount=a,f.rangeCount=s,f},e}(),o.Reference=L,H=function(e){function o(o){var n,r,i,a;if(e.call(this),!o||0===o.length)throw t.SR.Exp_InvalidArgument;for(n=me,r=0;r<o.length;r++)if(i=o[r],n){if(i.getRangeCount()!==n.getRangeCount())throw t.SR.Exp_InvalidArgument;for(a=0;a<i.getRangeCount();a++)if(i.getColumn(a)!==n.getColumn(a)||i.getColumnCount(a)!==n.getColumnCount(a)||i.getRow(a)!==n.getRow(a)||i.getRowCount(a)!==n.getRowCount(a))throw t.SR.Exp_InvalidArgument}else n=i;this._references=o.slice(0)}return __extends(o,e),o.prototype.getSheetCount=function(){return this._references.length},o.prototype.getRangeCount=function(){return this._references[0].getRangeCount()},o.prototype.getRow=function(e){return this._references[0].getRow(e)},o.prototype.getColumn=function(e){return this._references[0].getColumn(e)},o.prototype.getRowCount=function(e){return this._references[0].getRowCount(e)},o.prototype.getColumnCount=function(e){return this._references[0].getColumnCount(e)},o.prototype.getValue=function(e,t,o){return me},o.prototype.isHiddenRow=function(e,t,o){return!1},o.prototype.isSubtotal=function(e,t,o){return!1},o.prototype.getSource=function(){return me},o.prototype.toArray=function(e,t,o,n,r){for(var i,a,s,l,u=[],c=this._references,h=0;h<c.length;h++){if((i=c[h].toArray(e,t,o,n,r)).rangeCount>1)return u.isError=!0,[];t?u=u.concat(i):u.push(i[0]),a=i.rowCount,s=i.colCount,l=l||i.isError}return u.isArray=!1,u.isReference=!0,u.rowCount=a,u.colCount=s,u.isError=l,u},o}(L),o._SheetRangeReference=H,(Me=H.prototype).getSource=function(e){return this._references[e].getSource()},Me.getValue=function(e,t,o,n){return(typeof e===ie||e===me)&&(e=0),this._references[e].getValue(t,o,n)},Me.isSubtotal=function(e,t,o,n){return(typeof e===ie||e===me)&&(e=0),this._references[e].isSubtotal(t,o,n)},Me.isHiddenRow=function(e,t,o,n){return(typeof e===ie||e===me)&&(e=0),this._references[e].isHiddenRow(t,o,n)},k=function(e){function t(t,o){e.call(this);this._sheetSource=t,o?(this._ranges=o,this._rangeCount=o.length):this._rangeCount=1}return __extends(t,e),t.prototype.getRangeCount=function(){return this._rangeCount},t.prototype.getRow=function(e){return this._ranges?this._ranges[e].row:0},t.prototype.getColumn=function(e){return this._ranges?this._ranges[e].col:0},t.prototype.getRowCount=function(e){return this._ranges?this._ranges[e].rowCount:this._sheetSource.getRowCount()},t.prototype.getColumnCount=function(e){return this._ranges?this._ranges[e].colCount:this._sheetSource.getColumnCount()},t.prototype.getValue=function(e,t,o){if(t>=0||o>=0){var n=this._ranges;if(!n)return this._sheetSource.getValue(t,o);if(e<n.length)return this._sheetSource.getValue(t+n[e].row,o+n[e].col)}return He},t.prototype.isHiddenRow=function(e,t,o){return this._sheetSource.isHiddenRow(t+this.getRow(e),o)},t.prototype.isSubtotal=function(e,t,o){var n,r=this._sheetSource;return 0===e&&t<r.getRowCount()&&o<r.getColumnCount()&&((n=r.getCalcSourceModel().getExpression(t,o))&&7===n.t&&"SUBTOTAL"===n.getFunctionName().toUpperCase())},t.prototype.getSource=function(){return this._sheetSource},t.prototype.create=function(e){return new t(this._sheetSource,e)},t.prototype.toArray=function(e,t,o,n,r){return this._sheetSource.referenceToArray(this,e,t,o,n,r)},t}(L),o.SheetReference=k,V=function(e){function o(o,n,r,i,a,s,l,u){e.call(this,o,[new t.Range(n,r,i,a)]);this.Action=s,this.Operand1=l,this.Operand2=u}return __extends(o,e),o.prototype.getValue=function(t,o,n){return this.Action(e.prototype.getValue.call(this,t,o,n),this.Operand1,this.Operand2)},o}(k),o._TernaryCompositeConcreteReference=V,B=function(e){function o(o,n,r,i,a,s){e.call(this,o,[new t.Range(n,r,i,a)]),this.Action=s}return __extends(o,e),o.prototype.getValue=function(t,o,n){return this.Action(e.prototype.getValue.call(this,t,o,n))},o}(k),o._UnaryCompositeConcreteReference=B,z=function(e){function o(o,n,r,i,a,s,l,u){e.call(this,o,[new t.Range(n,r,i,a)]);this.Action=s,this.Operand1=l,this.SwitchOrder=u}return __extends(o,e),o.prototype.getValue=function(t,o,n){var r=e.prototype.getValue.call(this,t,o,n);return this.SwitchOrder?this.Action(this.Operand1,r):this.Action(r,this.Operand1)},o}(k),o._BinaryCompositeConcreteReference=z,G=function(){function e(){}return e.num=function(e){return typeof e===ae||typeof e===le||!isNaN(e)&&!isNaN(parseFloat(e))||e instanceof Date},e.err=function(e){return e instanceof N},e.arr=function(e){return e instanceof O},e.ref=function(e){return e instanceof L},e.toResult=function(e){return isNaN(e)||!isFinite(e)?Be:e},e.toArr=function(o,n,r,i,a,s){var l,u,c;if(o&&o.length&&o.rowCount&&o.colCount)return o;if(e.arr(o))(l=o.toArray(n,r,i,a,s)).isArray=!0;else if(e.ref(o))(l=o.toArray(n,r,i,a,s)).isReference=!0;else if(t.GC$.isArray(o)&&o.length>0){if(l=[],t.GC$.isArray(o[0]))return e.convertArray(o,n,!0);for(u=0;u<o.length;u++)(c=e.convertValue(o[u],n,!1))===e.CalcConvertedError&&(l.isConvertError=!0),l.push(c);l.rowCount=1,l.colCount=o.length,l.rangeCount=1}else e.arr(o)?l=[]:(o=e.convertValue(o,n,!0),i&&e.err(o)?(l=[Le]).isError=!0:o===e.CalcConvertedError?(l=[e.CalcConvertedError]).isConvertError=!0:r?(l=[]).push(o):(l=[[]])[0].push(o),l.rowCount=1,l.colCount=1,l.rangeCount=1);return l},e.convertValue=function(o,n,r,i){var a,s,l;if(e.err(o))return o;if(a={value:me},s=e.CalcConvertedError,i&&0!==n&&(o===me||o===_e))return s;switch(n){case 1:r?o=e.rD(o,a)?a.value:s:typeof o===ae||o instanceof Date||(o=s);break;case 4:typeof o===se?o=typeof(l=t._DateTimeHelper.parseLocale(o))!==ie&&l!==me?new t._DateTimeHelper(l).toOADate():s:r?o=e.rD(o,a)?a.value:s:typeof o===ae||o instanceof Date||(o=s);break;case 3:r?o=!!e.rB(o,a)&&a.value:typeof o!==le&&(o=s);break;case 2:o=o===me||o===_e?"":o.toString()}return o},e.convertArray=function(t,o,n){var r,i,a;if(!t||!t.length||!t[0].length)return(r=[]).isError=!0,[[ze.Value]];if(0===o)return t;var s,l,u,c=Re[o],h=t.length,p=t[0].length,d={value:me},f=!1,g=!1,m=e.CalcConvertedError;if(!(r=t[c]))for(r=[],t[c]=r,i=0;i<h;i++)for(s=t[i],l=r[i]=[],a=0;a<p;a++)if(u=s[a],e.err(u))f||(r.isError=!0,f=!0),l.push(u);else{switch(o){case 1:n?e.rD(u,d)?u=d.value:(g||(g=!0,r.isConvertError=!0),u=0):typeof u===ae||u instanceof Date||(g||(g=!0,r.isConvertError=!0),u=m);break;case 3:n?e.rB(u,d)?u=d.value:(g||(g=!0,r.isConvertError=!0),u=!1):typeof u!==le&&(g||(g=!0,r.isConvertError=!0),u=m);break;case 2:u=u===me||u===_e?"":u.toString()}l.push(u)}return r},e._isNaNOrInfinite=function(e){return isNaN(e)||!isFinite(e)},e.I=function(o){var n=e.D(o);if(we(n)<1e21)return parseInt(n,10);throw t.SR.Exp_InvalidCast},e.rI=function(t,o){return!!e.rD(t,o)&&(we(o.value)<1e21&&(o.value=parseInt(o.value,10),!0))},e.D=function(o){var n={value:0};if(e.rD(o,n))return n.value;throw t.SR.Exp_InvalidCast},e.rD=function(o,n){var r,i,a=me;if(typeof o===ie||o===me)return n.value=0,!0;r=typeof o;try{if(r===ae)a=o;else if(r===se){if(0===(o=o.trim()).length)return n.value=0,!0;if(i=!1,"%"===o.charAt(o.length-1)&&(i=!0,o=o.substr(0,o.length-1)),o.length>=2&&"0"===o[0]&&"x"===o[1])return!1;if(a=new Number(o).valueOf(),e._isNaNOrInfinite(a)){if(a=new Date(o),e._isNaNOrInfinite(a.valueOf()))return!1;a=t._DateTimeHelper.___toOADate(a)}i&&(a/=100)}else if(r===le)a=o?1:0;else{if(!(o instanceof Date))return!1;a=new t._DateTimeHelper(o).toOADate()}}catch(e){return!1}return n.value=a,!0},e.rB=function(o,n){try{if(typeof o===ie||o===me)return!1;if(typeof o!==le)if(o instanceof Date)o=0!==t._DateTimeHelper.___toOADate(o);else{if(!e.num(o))throw t.SR.Exp_InvalidCast;o=0!==o}}catch(e){}return n.value=o,!0},e.B=function(o){if(typeof o===ie||o===me)return!1;if(typeof o===le)return o;if(o instanceof Date)return 0!==new t._DateTimeHelper(o).toOADate();if(e.num(o))return 0!==o;if(e.err(o))return!1;throw t.SR.Exp_InvalidCast},e.S=function(o){try{if(typeof o===ie||o===me)return"";if(typeof o===le)return o?ue:ce;if(typeof o===se)return o;if(o instanceof Date)return t._DateTimeHelper.___toOADate(o).toString();if(e.arr(o))throw t.SR.Exp_InvalidCast;return o.toString()}catch(e){throw t.SR.Exp_InvalidCast}},e.DT=function(o){var n={value:me};if(e.rDT(o,n))return n.value;throw t.SR.Exp_InvalidCast},e.rDT=function(e,o){var n,r;if(typeof e===ie||e===me)o.value=t._DateTimeHelper.fromOADate(0);else if(e instanceof Date)o.value=new Date(e);else if(typeof e===se){if(!(n=t._DateTimeHelper.parseLocale(e)))if(isNaN(e)){if(n=new Date(e),isNaN(n.valueOf()))return!1;try{if((r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(t.StringHelper.Trim(e.replace(/ |\n/g,""))))&&4===r.length&&(-1===r.indexOf(n.getFullYear().toString())||-1===r.indexOf((n.getMonth()+1).toString())||-1===r.indexOf(n.getDate().toString())))return!1}catch(e){return!1}}else if(!(n=t._DateTimeHelper.fromOADate(parseFloat(e))))return!1;o.value=n}else{if(typeof e!==ae)return!1;o.value=t._DateTimeHelper.fromOADate(e)}return!0},e.CalcConvertedError={},e}(),o.Convert=G,W=function(){function e(){}return e._argumentExists=function(e,t){return e&&t<e.length&&e[t]!==o.missingArgument},e._argumentValid=function(e,t){if(!e)return!1;var n=e[t];return n!==o.missingArgument&&n!==me&&n!==_e&&!n._error},e.getArrayValue=function(e,t,o){return typeof e===ie||e===me?Le:t<e.getRowCount()&&o<e.getColumnCount()?e.getValue(t,o):o>=e.getColumnCount()&&1===e.getColumnCount()&&t<e.getRowCount()?e.getValue(t,0):t>=e.getRowCount()&&1===e.getColumnCount()&&o<e.getColumnCount()?e.getValue(0,o):Le},e.tryExtractToSingleValue=function(e){var t,o=!0;return(G.ref(e)||G.arr(e))&&((t=G.toArr(e,0,!1,!0)).isError?e=t[0]:1===t.rowCount&&1===t.colCount?e=t[0][0]:(e=t,o=!1)),{value:e,success:o}},e}(),o._Helper=W,j=function(){function e(){}return e.getLength=function(e,t){return G.arr(e)?e.getRowCount()*e.getColumnCount():G.ref(e)?(t=t||0,e.getRowCount(t)*e.getColumnCount(t)):void 0},e.getRowCount=function(e,t){return G.arr(e)?e.getRowCount():G.ref(e)?(t=t||0,e.getRowCount(t)):void 0},e.getColumnCount=function(e,t){return G.arr(e)?e.getColumnCount():G.ref(e)?(t=t||0,e.getColumnCount(t)):void 0},e.getValueByIndex=function(e,t,o){if(G.arr(e))return e.getValueByIndex(t);if(G.ref(e)){o=o||0;var n=e.getColumnCount(o);return e.getValue(o,parseInt(t/n,10),t%n)}},e.getValue=function(e,t,o,n){return G.arr(e)?e.getValue(t,o):G.ref(e)?(n=n||0,e.getValue(n,t,o)):void 0},e}(),o.CalcArrayHelper=j,o.compareStringIgnoreCase=r,function(e){function t(e,t){return e===t||we(e-t)<we(e)/281474976710656}function n(e,o){var n,r;return G.err(e)?{error:e}:G.err(o)?{error:o}:((e===_e||e===me)&&(e=0),(o===_e||o===me)&&(o=0),typeof e===se&&typeof o===se?{result:e.toString().toUpperCase()-o.toString().toUpperCase()}:typeof e===se?{result:1}:typeof o===se?{result:-1}:(n={value:0},G.rD(e,n)?(e=n.value,r={value:0},G.rD(o,r)?{result:t(e,o=r.value)?0:e-o}:{error:Le}):{error:Le}))}var i,a,s=function(){function e(e){this.name=e}return e.prototype.getName=function(){return this.name},e.prototype.compareTo=function(e){return r(this.name,e.name)},e.prototype.toString=function(){return this.getName()},e}();e.Operator=s,i=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype._evaluateSingle=function(e,t){},t.prototype._evaluateImp=function(e,t){var o,n,r,i=me;if(G.arr(e)&&(i=e),G.ref(e)&&(i=G.toArr(e,0,!1,!1)),i===_e||i===me)return this._evaluateSingle(e,t);if(i.length()<1)return Be;for(o=[],n=0;n<i.getRowCount();n++)for(o[n]=[],r=0;r<i.getColumnCount();r++)o[n][r]=this._evaluateSingle(i.getValue(n,r),t);return new P(o,i.getColumnCount())},t.prototype.evaluate=function(e,t){return this._evaluateImp(e,t)},t}(s),e.UnaryOperator=i,e.plus=new i("+"),e.plus._evaluateSingle=function(e,t){if(e===_e||e===me)return 0;var o={value:0};return G.rD(e,o)?G.D(o.value):"string"==typeof e?e:Le},e.negate=new i("-"),e.negate._evaluateSingle=function(e,t){if(e===_e||e===me)return 0;var o={value:0};return G.rD(e,o)?-o.value:Le},e.percent=new i("%"),e.percent._evaluateSingle=function(e,t){if(e===_e||e===me)return 0;var o={value:0};return G.rD(e,o)?o.value/100:Le},a=function(e){function t(t,o){e.call(this,t),this.acceptsReference=o}return __extends(t,e),t.prototype._evaluateSingle=function(e,t,o){},t.prototype.evaluate=function(e,t,o){var n,r,i,a=W.tryExtractToSingleValue(e),s=W.tryExtractToSingleValue(t);if(a.success&&s.success)return this._evaluateSingle(a.value,s.value);e=a.value,t=s.value;var l=a.success?-1:e.rowCount,u=a.success?-1:e.colCount,c=s.success?-1:t.rowCount,h=s.success?-1:t.colCount,p=-1,d=-1;if(a.success||s.success)a.success?(p=c,d=h):(p=l,d=u);else{if(1!=l&&1!=c&&l!=c||1!=u&&1!=h&&u!=h)return Ve;p=1==l?c:l,d=1==u?h:u}for(n=[],r=0;r<p;r++)for(n[r]=[],i=0;i<d;i++)n[r][i]=!a.success&&(1!==l&&l<p||1!==u&&u<d)||!s.success&&(1!==c&&c<p||1!==h&&h<d)?Ve:this._evaluateSingle(a.success?e:e[1===l?0:r][1===u?0:i],s.success?t:t[1==c?0:r][1===h?0:i]);return new P(n,d)},t}(s),e.BinaryOperator=a,e.add=new a("+",!1),e.add._evaluateSingle=function(e,t,o){var n,r;return G.err(e)?e:G.err(t)?t:((e===_e||e===me)&&(e=0),(t===_e||t===me)&&(t=0),n={value:0},G.rD(e,n)?(r={value:0},G.rD(t,r)?n.value+r.value:Le):Le)},e.subtract=new a("-",!1),e.subtract._evaluateSingle=function(e,t,o){var n,r;return G.err(e)?e:G.err(t)?t:((e===_e||e===me)&&(e=0),(t===_e||t===me)&&(t=0),n={value:0},G.rD(e,n)?(r={value:0},G.rD(t,r)?n.value-r.value:Le):Le)},e.multiply=new a("*",!1),e.multiply._evaluateSingle=function(e,t,o){var n,r;return G.err(e)?e:G.err(t)?t:((e===_e||e===me)&&(e=0),(t===_e||t===me)&&(t=0),n={value:0},G.rD(e,n)?(r={value:0},G.rD(t,r)?n.value*r.value:Le):Le)},e.divide=new a("/",!1),e.divide._evaluateSingle=function(e,t,o){var n,r;return t===_e||t===me||""===t||0===t?Pe:G.err(e)?e:G.err(t)?t:((e===_e||e===me)&&(e=0),n={value:0},G.rD(e,n)?(r={value:0},G.rD(t,r)?0===r.value?Pe:n.value/r.value:Le):Le)},e.exponent=new a("^",!1),e.exponent._evaluateSingle=function(e,t,o){var n,r;return G.err(e)?e:G.err(t)?t:((e===_e||e===me)&&(e=0),(t===_e||t===me)&&(t=0),n={value:0},G.rD(e,n)?(e=n.value,r={value:0},G.rD(t,r)?(t=r.value,0===e&&t<0?Pe:ve(e,t)):Le):Le)},e.concatenate=new a("&",!1),e.concatenate._evaluateSingle=function(e,t,n){return G.err(e)?e:G.err(t)?t:((e===_e||e===me)&&(e=""),(t===_e||t===me)&&(t=""),o.Convert.S(e)+o.Convert.S(t))},e.equal=new a("=",!1),e.equal._evaluateSingle=function(e,o,n){var r,i;return G.err(e)?e:G.err(o)?o:((e===_e||e===me)&&(e=typeof o===se?"":0),(o===_e||o===me)&&(o=typeof e===se?"":0),typeof e===se||typeof o===se?e.toString().toUpperCase()===o.toString().toUpperCase():(r={value:0},G.rD(e,r)?(e=r.value,i={value:0},G.rD(o,i)?t(e,o=i.value):Le):Le))},e.notEqual=new a("<>",!1),e.notEqual._evaluateSingle=function(t,o,n){var r=e.equal._evaluateSingle.call(this,t,o,n);return typeof r===le?!r:r},e.lessThan=new a("<",!1),e.lessThan._evaluateSingle=function(e,t,o){var r=n(e,t);return r.error?r.error:r.result<0},e.greaterThan=new a(">",!1),e.greaterThan._evaluateSingle=function(e,t,o){var r=n(e,t);return r.error?r.error:r.result>0},e.lessThanOrEqual=new a("<=",!1),e.lessThanOrEqual._evaluateSingle=function(e,t,o){var r=n(e,t);return r.error?r.error:r.result<=0},e.greaterThanOrEqual=new a(">=",!1),e.greaterThanOrEqual._evaluateSingle=function(e,t,o){var r=n(e,t);return r.error?r.error:r.result>=0},e.range=new a(":",!0),e.range.evaluate=function(e,t,o){var n;if(e===_e||e===me||t===_e||t===me||1!==e.getRangeCount()||1!==t.getRangeCount()||(!(n=e.getSource())||n!==t.getSource()))return Le;var r=e.getRow(0),i=e.getColumn(0),a=t.getRow(0),s=t.getColumn(0),l=ye(r,a),u=ye(i,s),c=Ce(r+e.getRowCount(0),a+t.getRowCount(0))-l,h=Ce(i+e.getColumnCount(0),s+t.getColumnCount(0))-u;return new k(n,[{row:l,col:u,rowCount:c,colCount:h}])},e.union=new a(",",!0),e.union.evaluate=function(e,t,o){if(e===_e||e===me||t===_e||t===me)return Le;var n=[],r=0;for(r=0;r<e.getRangeCount();r++)n.push({row:e.getRow(r),col:e.getColumn(r),rowCount:e.getRowCount(r),colCount:e.getColumnCount(r)});for(r=0;r<t.getRangeCount();r++)n.push({row:t.getRow(r),col:t.getColumn(r),rowCount:t.getRowCount(r),colCount:t.getColumnCount(r)});return new k(e.getSource(),n)},e.intersection=new a(" ",!0),e.intersection.evaluate=function(e,t,o){var n;if(e===_e||e===me||t===_e||t===me||1!==e.getRangeCount()||1!==t.getRangeCount()||(!(n=e.getSource())||n!==t.getSource()))return Le;var r=e.getRow(0),i=e.getColumn(0),a=t.getRow(0),s=t.getColumn(0),l=Ce(r,a),u=Ce(i,s),c=ye(r+e.getRowCount(0),a+t.getRowCount(0))-l,h=ye(i+e.getColumnCount(0),s+t.getColumnCount(0))-u;return new k(n,[{row:l,col:u,rowCount:c,colCount:h}])}}(o.Operators||(o.Operators={})),U=o.Operators,function(e){var o,n,r;(r=e.ArrayArgumentEvaluateMode||(e.ArrayArgumentEvaluateMode={}))[r.normal=0]="normal",r[r.allwaysExpand=1]="allwaysExpand",r[r.neverExpand=2]="neverExpand",e.ArrayArgumentEvaluateMode,o=function(){function t(e,t,o){var n=arguments.length;this._init(e,n<2?0:t,n<3?0:o),this.typeName=""}return t.prototype._init=function(e,t,o){this.name=e,this.minArgs=t,this.maxArgs=o},t.prototype.acceptsArray=function(e){return!1},t.prototype.acceptsReference=function(e){return!1},t.prototype.acceptsError=function(e){return!1},t.prototype.acceptsMissingArgument=function(e){return!1},t.prototype.isVolatile=function(){return!1},t.prototype.isContextSensitive=function(){return!1},t.prototype.isBranch=function(){return!1},t.prototype.findTestArgument=function(){return-1},t.prototype.findBranchArgument=function(e){return-1},t.prototype.expandRows=function(){return!0},t.prototype.expandColumns=function(){return!0},t.prototype.precedentReference=function(){return!0},t.prototype.returnReference=function(){return!1},t.prototype.evaluate=function(e,t){},t.prototype.evaluateWithContext=function(e,t){return this.isContextSensitive()?this.evaluate(e,t):this.evaluate(e)},t.prototype.toString=function(){return this.name},t._create=function(t,o,n){var r,i=new e.Function(t,0,255);if(o&&"function"==typeof o&&(i.evaluate=o),n)for(r in n)n.hasOwnProperty(r)&&"override"!==r&&(i[r]=n[r]);return i},t.prototype.toJSON=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==_e&&(this[t]=e[t])},t}(),e.Function=o,n=function(e){function t(t,o,n){e.call(this,t,o,n)}return __extends(t,e),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(e,t){return this.evaluateAsync(e,t)},t.prototype.evaluateAsync=function(e,t){},t.prototype.defaultValue=function(){return 0},t}(o),e.AsyncFunction=n,e._customFunctions={},e._builtInFunctions={},e.defineGlobalCustomFunction=function(o,n,r){var i,a;if(o===_e||o===me)throw t.SR.Exp_InvalidFunctionName;if(o=o.toUpperCase(),e._builtInFunctions.hasOwnProperty(o))throw t.SR.Exp_InvalidOverrideFunction;if(e._customFunctions.hasOwnProperty(o))if(i=e._customFunctions[o]){if(!r||!r.override)throw t.SR.Exp_OverrideNotAllowed}else e._customFunctions[o]=new e.Function(o,0,255),i=e[o.toUpperCase()];else i=new e.Function(o,0,255),e._customFunctions[o]=i;if(n&&"function"==typeof n&&(i.evaluate=n),r)for(a in r)r.hasOwnProperty(a)&&"override"!==a&&(i[a]=r[a]);return i},e.findGlobalFunction=function(t){return t===_e||t===me?me:(t=t.toUpperCase(),e._builtInFunctions&&e._builtInFunctions.hasOwnProperty(t)?e._builtInFunctions[t]:e._customFunctions.hasOwnProperty(t)?e._customFunctions[t]:me)}}(o.Functions||(o.Functions={})),Y=o.Functions,X={cell:0,row:1,column:2,sheet:3},function(e){var t,n,r,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O,L,H=function(){function e(){}return e.prototype.offset=function(e,t,o){return this},e}();e.Expression=H,t=function(e){function t(t){e.call(this),this.argument=t,this.t=14}return __extends(t,e),t.prototype.offset=function(e,t,o){return this.argument.offset(e,t,o)},t}(H),e.ParenthesesExpression=t,n=function(e){function t(t,o){e.call(this),this.fn=t,this.args=o,this.t=7}return __extends(t,e),t.prototype.argCount=function(){return this.args?this.args.length:0},t.prototype.getArg=function(e){return this.args?this.args[e]:me},t.prototype.getFunctionName=function(){return typeof this.fn===se?this.fn:this.fn.name},t.prototype.offset=function(e,o,n){for(var r=this.args,i=[],a=0;a<r.length;a++)i.push(r[a].offset(e,o,n));return new t(this.fn,i)},t}(H),e.FunctionExpression=n,r=function(e){function t(t){e.call(this),this.name=t,this.t=8}return __extends(t,e),t}(H),e.NameExpression=r,s=function(e){function t(t){e.call(this,t),this.t=18}return __extends(t,e),t}(r),e.BangNameExpression=s,l=function(e){function t(t,o){e.call(this,o),this.source=t,this.t=9}return __extends(t,e),t}(r),e.ExternalNameExpression=l,u=function(e){function t(t){e.call(this),this.value=t}return __extends(t,e),t}(H),e.ConstantExpression=u,c=function(e){function t(t){e.call(this,t),this.t=6}return __extends(t,e),t}(u),e.BooleanExpression=c,h=function(e){function t(t,o){e.call(this,t),this.originalValue=o,this.t=4}return __extends(t,e),t}(u),e.DoubleExpression=h,p=function(e){function t(t){e.call(this,t),this.t=5}return __extends(t,e),t}(u),e.StringExpression=p,d=function(e){function t(t){e.call(this,t),this.t=12}return __extends(t,e),t}(u),e.ErrorExpression=d,f=function(e){function t(t,o){e.call(this,o),this.source=t,this.t=13}return __extends(t,e),t}(d),e.ExternalErrorExpression=f,g=function(e){function t(t,o,n){e.call(this,n),this.startSource=t,this.endSource=o,this.t=19}return __extends(t,e),t}(d),e.SheetRangeErrorExpression=g,m=function(e){function t(t){e.call(this,t),this.t=20}return __extends(t,e),t}(d),e.BangErrorExpression=m,_=function(e){function t(t){e.call(this,new P(t)),this.t=15}return __extends(t,e),t}(u),e.ArrayExpression=_,y=function(e){function t(){e.call(this,o.missingArgument),this.t=21}return __extends(t,e),t}(u),e.MissingArgumentExpression=y,C=function(e){function t(t){e.call(this),this.operator=t}return __extends(t,e),t}(H),e.OperatorExpression=C,w=function(e){function t(t,o){e.call(this,t),this.operand=o,this.t=11}return __extends(t,e),t.prototype.offset=function(e,o,n){return new t(this.operator,this.operand.offset(e,o,n))},t}(C),e.UnaryOperatorExpression=w,v=function(e){function t(t,o,n){e.call(this,t),this.left=o,this.right=n,this.t=10}return __extends(t,e),t.prototype.offset=function(e,o,n){return new t(this.operator,this.left.offset(e,o,n),this.right.offset(e,o,n))},t}(C),e.BinaryOperatorExpression=v,S=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.getRange=function(e,t){return me},t}(H),e.ReferenceExpression=S,x=function(e){function t(t){e.call(this),this.source=t}return __extends(t,e),t}(S),e.ExternalReferenceExpression=x,R=function(e){function t(t,o,n,r){e.call(this);this.row=t,this.column=o,this.rowRelative=n,this.columnRelative=r,this.t=0}return __extends(t,e),t.prototype.getRange=function(e,t){return i.call(this,e,t)},t.prototype.offset=function(e,o,n){return new t(this.row+(this.rowRelative||n?e:0),this.column+(this.columnRelative||n?o:0),this.rowRelative,this.columnRelative)},t}(S),e.CellExpression=R,b=function(e){function t(t,o,n,r){e.call(this,t,o,n,r),this.t=22}return __extends(t,e),t.prototype.offset=function(e,o,n){return new t(this.row+(this.rowRelative||n?e:0),this.column+(this.columnRelative||n?o:0),this.rowRelative,this.columnRelative)},t}(R),e.BangCellExpression=b,T=function(e){function t(t,o,n,r,i){e.call(this,t);this.row=o,this.column=n,this.rowRelative=r,this.columnRelative=i,this.t=1}return __extends(t,e),t.prototype.getRange=function(e,t){return i.call(this,e,t)},t.prototype.offset=function(e,o,n){return new t(this.source,this.row+(this.rowRelative||n?e:0),this.column+(this.columnRelative||n?o:0),this.rowRelative,this.columnRelative)},t}(x),e.ExternalCellExpression=T,A=function(t){function o(e,o,n,r,i,a,s,l){t.call(this),0===arguments.length?this._initDefault():this.init(e,o,n,r,i,a,s,l),this.t=2}return __extends(o,t),o.prototype._initDefault=function(){var e=q.BAND_INDEX_CONST;this.init(e,e,e,e,!1,!1,!1,!1),this.isFullRow=!0,this.isFullColumn=!0},o.prototype.init=function(e,t,o,n,r,i,a,s){var l=this;r===a&&e>o?(l.startRow=o,l.endRow=e,l.startRowRelative=a,l.endRowRelative=r):(l.startRow=e,l.endRow=o,l.startRowRelative=r,l.endRowRelative=a),i===s&&t>n?(l.startColumn=n,l.endColumn=t,l.startColumnRelative=s,l.endColumnRelative=i):(l.startColumn=t,l.endColumn=n,l.startColumnRelative=i,l.endColumnRelative=s),l.isFullRow=!1,l.isFullColumn=!1},o.prototype.initBand=function(e,t,o,n,r){var i,a,s;e>t&&(i=e,e=t,t=i,a=o,o=n,n=a),s=this,r?(s.startRow=e,s.startColumn=q.BAND_INDEX_CONST,s.endRow=t,s.endColumn=q.BAND_INDEX_CONST,s.startRowRelative=o,s.startColumnRelative=!1,s.endRowRelative=n,s.endColumnRelative=!1,s.isFullRow=!0,s.isFullColumn=!1):(s.startRow=q.BAND_INDEX_CONST,s.startColumn=e,s.endRow=q.BAND_INDEX_CONST,s.endColumn=t,s.startRowRelative=!1,s.startColumnRelative=o,s.endRowRelative=!1,s.endColumnRelative=n,s.isFullRow=!1,s.isFullColumn=!0)},o.prototype._getRangeType=function(){return this.isFullRow&&this.isFullColumn?X.sheet:this.isFullRow?X.row:this.isFullColumn?X.column:X.cell},o.prototype.getRange=function(e,t){return a.call(this,e,t)},o.prototype.offset=function(t,o,n){var r=this,i=new e.RangeExpression(r.startRow+(r.isFullColumn||!r.startRowRelative&&!n?0:t),r.startColumn+(r.isFullRow||!r.startColumnRelative&&!n?0:o),r.endRow+(r.isFullColumn||!r.endRowRelative&&!n?0:t),r.endColumn+(r.isFullRow||!r.endColumnRelative&&!n?0:o),r.startRowRelative,r.startColumnRelative,r.endRowRelative,r.endColumnRelative);return i.isFullRow=r.isFullRow,i.isFullColumn=r.isFullColumn,i},o.prototype.offset2=function(t,o,n,r){var i=this,a=new e.RangeExpression(i.startRow+(i.isFullColumn?0:t),i.startColumn+(i.isFullRow?0:o),i.endRow+(i.isFullColumn?0:n),i.endColumn+(i.isFullRow?0:r),i.startRowRelative,i.startColumnRelative,i.endRowRelative,i.endColumnRelative);return a.isFullRow=i.isFullRow,a.isFullColumn=i.isFullColumn,a},o}(S),e.RangeExpression=A,I=function(t){function o(e,o,n,r,i,a,s,l){t.call(this,e,o,n,r,i,a,s,l),this.t=23}return __extends(o,t),o.prototype.offset=function(t,o,n){var r=this,i=new e.BangRangeExpression(r.startRow+(r.isFullColumn||!r.startRowRelative&&!n?0:t),r.startColumn+(r.isFullRow||!r.startColumnRelative&&!n?0:o),r.endRow+(r.isFullColumn||!r.endRowRelative&&!n?0:t),r.endColumn+(r.isFullRow||!r.endColumnRelative&&!n?0:o),r.startRowRelative,r.startColumnRelative,r.endRowRelative,r.endColumnRelative);return i.isFullRow=r.isFullRow,i.isFullColumn=r.isFullColumn,i},o}(A),e.BangRangeExpression=I,D=function(t){function o(e,o,n,r,i,a,s,l,u){t.call(this,me),1===arguments.length?this._initDefault(e):this.init(e,o,n,r,i,a,s,l,u),this.t=3}return __extends(o,t),o.prototype._initDefault=function(e){var t=q.BAND_INDEX_CONST;this.init(e,t,t,t,t,!1,!1,!1,!1),this.isFullRow=!0,this.isFullColumn=!0},o.prototype.init=function(e,t,o,n,r,i,a,s,l){var u=this;u.source=e,i===s&&t>n?(u.startRow=n,u.endRow=t,u.startRowRelative=s,u.endRowRelative=i):(u.startRow=t,u.endRow=n,u.startRowRelative=i,u.endRowRelative=s),a===l&&o>r?(u.startColumn=r,u.endColumn=o,u.startColumnRelative=l,u.endColumnRelative=a):(u.startColumn=o,u.endColumn=r,u.startColumnRelative=a,u.endColumnRelative=l)},o.prototype.initBand=function(e,t,o,n,r,i){var a,s,l=this;l.source=e,t>o&&(a=t,t=o,o=a,s=n,n=r,r=s),i?(l.startRow=t,l.startColumn=q.BAND_INDEX_CONST,l.endRow=o,l.endColumn=q.BAND_INDEX_CONST,l.startRowRelative=n,l.startColumnRelative=!1,l.endRowRelative=r,l.endColumnRelative=!1,l.isFullRow=!0):(l.startRow=q.BAND_INDEX_CONST,l.startColumn=t,l.endRow=q.BAND_INDEX_CONST,l.endColumn=o,l.startRowRelative=!1,l.startColumnRelative=n,l.endRowRelative=!1,l.endColumnRelative=r,l.isFullColumn=!0)},o.prototype._getRangeType=function(){return this.isFullRow&&this.isFullColumn?X.sheet:this.isFullRow?X.row:this.isFullColumn?X.column:X.cell},o.prototype.getRange=function(e,t){return a.call(this,e,t)},o.prototype.offset=function(t,o,n){var r=this,i=new e.ExternalRangeExpression(r.source,r.startRow+(r.isFullColumn||!r.startRowRelative&&!n?0:t),r.startColumn+(r.isFullRow||!r.startColumnRelative&&!n?0:o),r.endRow+(r.isFullColumn||!r.endRowRelative&&!n?0:t),r.endColumn+(r.isFullRow||!r.endColumnRelative&&!n?0:o),r.startRowRelative,r.startColumnRelative,r.endRowRelative,r.endColumnRelative);return i.isFullRow=r.isFullRow,i.isFullColumn=r.isFullColumn,i},o.prototype.offset2=function(t,o,n,r){var i=this,a=new e.ExternalRangeExpression(i.source,i.startRow+(i.isFullColumn?0:t),i.startColumn+(i.isFullRow?0:o),i.endRow+(i.isFullColumn?0:n),i.endColumn+(i.isFullRow?0:r),i.startRowRelative,i.startColumnRelative,i.endRowRelative,i.endColumnRelative);return a.isFullRow=i.isFullRow,a.isFullColumn=i.isFullColumn,a},o}(x),e.ExternalRangeExpression=D,F=function(t){function o(e,o,n,r,i,a,s,l,u,c){t.call(this),this.init(e,o,n,r,i,a,s,l,u,c),this.t=16}return __extends(o,t),o.prototype.init=function(e,t,o,n,r,i,a,s,l,u){var c=this;c.startSource=e,c.endSource=t,a===l&&o>r?(c.startRow=r,c.endRow=o,c.startRowRelative=l,c.endRowRelative=a):(c.startRow=o,c.endRow=r,c.startRowRelative=a,c.endRowRelative=l),s===u&&n>i?(c.startColumn=i,c.endColumn=n,c.startColumnRelative=u,c.endColumnRelative=s):(c.startColumn=n,c.endColumn=i,c.startColumnRelative=s,c.endColumnRelative=u)},o.prototype.initBand=function(e,t,o,n,r,i,a){var s,l,u=this;u.startSource=e,u.endSource=t,o>n&&(s=o,o=n,n=s,l=r,r=i,i=l),a?(u.startRow=o,u.startColumn=q.BAND_INDEX_CONST,u.endRow=n,u.endColumn=q.BAND_INDEX_CONST,u.startRowRelative=r,u.startColumnRelative=!1,u.endRowRelative=i,u.endColumnRelative=!1,u.isFullRow=!0):(u.startRow=q.BAND_INDEX_CONST,u.startColumn=o,u.endRow=q.BAND_INDEX_CONST,u.endColumn=n,u.startRowRelative=!1,u.startColumnRelative=r,u.endRowRelative=!1,u.endColumnRelative=i,u.isFullColumn=!0)},o.prototype.getRange=function(e,t){return a.call(this,e,t)},o.prototype._getRangeType=function(){return this.isFullRow&&this.isFullColumn?X.sheet:this.isFullRow?X.row:this.isFullColumn?X.column:X.cell},o.prototype.offset=function(t,o,n){var r=this,i=new e.SheetRangeExpression(r.startSource,r.endSource,r.startRow+(r.isFullColumn||!r.startRowRelative&&!n?0:t),r.startColumn+(r.isFullRow||!r.startColumnRelative&&!n?0:o),r.endRow+(r.isFullColumn||!r.endRowRelative&&!n?0:t),r.endColumn+(r.isFullRow||!r.endColumnRelative&&!n?0:o),r.startRowRelative,r.startColumnRelative,r.endRowRelative,r.endColumnRelative);return i.isFullRow=r.isFullRow,i.isFullColumn=r.isFullColumn,i},o}(S),e.SheetRangeExpression=F,M=function(e){function t(t,o){e.call(this),o!==me&&t&&this._parseStructReferenceString(o,t),this.t=17}return __extends(t,e),t.create=function(e,o,n,r,i){void 0===o&&(o=16),void 0===n&&(n=1),void 0===r&&(r=0),void 0===i&&(i=e.endColumn()-e.startColumn());var a=new t(me,me);return a._baseTable=e,a._referencePortions=o,a._columnReferenceStartInTable=r,a._columnReferenceEndInTable=i,a._referenceColumnSpecifier=n,a},t.prototype.tableName=function(){return this._baseTable.tableName()},t.prototype.baseTable=function(){return this._baseTable},t.prototype._updateCatch=function(){this._catchedTableStartColumn=this._baseTable.startColumn()},t.prototype.columnReferenceStart=function(){return this._columnReferenceStartInTable+this._baseTable.startColumn()},t.prototype.columnReferenceEnd=function(){return this._columnReferenceEndInTable+this._baseTable.startColumn()},t.prototype.referencePortions=function(){return this._referencePortions},t.prototype.referenceColumnSpecifier=function(){return this._referenceColumnSpecifier},t.prototype.source=function(){return this._baseTable.source()},t.prototype.getRange=function(e,t,o){this._updateCatch();var n,r,i,a,s=this._baseTable.startRow(),l=this._baseTable.endRow(),u=this._baseTable.hasTotalsRow(),c=this._baseTable.hasHeadersRow();switch(this._referencePortions){case 3:case 16:n=c?s+1:s,i=u?l-1:l;break;case 2:if(c)n=s,i=s;else{if(!o)return me;n=s-1,i=s-1}break;case 8:if(u)n=l,i=l;else{if(!o)return me;n=l+1,i=l+1}break;case 1:n=e,i=e;break;case 6:n=s+(o&&!c?-1:0),i=u?l-1:l;break;case 12:n=c?s+1:s,i=l+(o&&!u?1:0);break;case 14:default:n=s+(o&&!c?-1:0),i=l+(o&&!u?1:0)}return r=this.columnReferenceStart(),a=this.columnReferenceEnd(),i<n||!o&&n<s||!o&&i>l?me:{row:n,column:r,rowCount:i-n+1,columnCount:a-r+1}},t.prototype._parseStructReferenceString=function(e,o){var n,r,i,a,s,l=t,u=this,c=0,h=(o=o.trim()).charAt(c),p=l._parseTableObject(e,o,c,h);for(p.table===me&&l._throwError(),n=p.table,u._baseTable=n,c=p.charIndex,h=p.currentChar,c++,h=o.charAt(c),r=c;" "===h;)c++,h=o.charAt(c);"@"!==h&&"["!==h&&(c=r,h=o.charAt(c));for(var d=1,f=!1,g=!1,m=o.length;0!==d&&c<m;)if("["===h&&(d++,c++,h=o.charAt(c)),"#"===h)f&&d<=1&&l._throwError(),i=(p=l._parsePortion(o,c,h,d)).portion,c=p.charIndex,h=p.currentChar,d=p.lbracketLever,f?2===u._referencePortions&&3===i||2===i&&3===u._referencePortions?u._referencePortions=6:3===u._referencePortions&&8===i||3===i&&8===u._referencePortions?u._referencePortions=12:l._throwError():u._referencePortions=i,f=!0;else if("@"===h){for((d>1||f)&&l._throwError(),f=!0,u._referencePortions=1,c++,h=o.charAt(c);" "===h;)c++,h=o.charAt(c);","===h&&l._throwError()}else{for(a=c,!1;"]"!==h&&"["!==h;)if("'"===h&&c++,","===h){for(c++,h=o.charAt(c),s=c;" "===h;)c++,h=o.charAt(c);if("["===h){c=s,h=",";break}}else c++,h=o.charAt(c);if(c>a&&((g||"["===h&&d>1)&&l._throwError(),c=(p=u._parseColumnRange(o,c,h,d,a)).charIndex,h=p.currentChar,d=p.lbracketLever,g=!0),"]"===h){if(0===--d)break;c>=o.length&&l._throwError(),c++,h=o.charAt(c)}","===h&&(c++,h=o.charAt(c))}f||(u._referencePortions=16),g||(u._columnReferenceStartInTable=0,u._columnReferenceEndInTable=u._baseTable.endColumn()-u._baseTable.startColumn(),u._referenceColumnSpecifier=1)},t.prototype._parseColumnRange=function(e,o,n,r,i){var a,s,l,u,c,h,p=t,d="",f="",g=!1,m=!1;if(r>1)g=!0,r--,d=e.substring(i,o),o++,":"===(n=e.charAt(o))&&(o++,m="["===(n=e.charAt(o)),f=(a=p._getColumnEndString(e,o,n,r)).columnEndString,o=a.charIndex,n=a.currentChar,r=a.lbracketLever);else if("["===n){for(m=!0,n=e[l=o-1];" "===n;)n=e[--l];":"!==n&&p._throwError(),d=e.substring(i,l),g||(d=p._trimStart(d)),n=e.charAt(o),f=(a=p._getColumnEndString(e,o,n,r)).columnEndString,o=a.charIndex,n=a.currentChar,r=a.lbracketLever}else(this._referencePortions===_e||16===this._referencePortions)&&(g=!0),(l=(s=e.substring(i,o)).indexOf(":"))>0?(d=d=s.substring(0,l),"["!==(f=s.substring(l+1)).charAt(0)&&p._throwError()):d=s;if(u=this._getColumnIndex(d,g),f?(c=this._getColumnIndex(f,m),this._referenceColumnSpecifier=4):(c=u,this._referenceColumnSpecifier=2),u>c&&(h=u,u=c,c=h),this._columnReferenceStartInTable=u,this._columnReferenceEndInTable=c,++o<e.length)for(n=e.charAt(o);" "===n;)o++,n=e.charAt(o);return{charIndex:o,currentChar:n,lbracketLever:r}},t._trimStart=function(e){for(var t=e.length-1;t>=0&&" "===e[t];)t--;for(;t>=0&&" "!==e[t];)t--;return t>=0?e.substr(t+1,e.length-t-1):e},t._trimEnd=function(e){for(var t,o=0,n=e.length;o<n&&" "===e[o];)o++;for(t=o,o=n-1;o>t&&" "===e[o];)o++;return o>=t?e.substring(t,o+1):e},t.prototype._getColumnIndex=function(e,o){var n,r,i,a;if(e&&t._validateColumnString(e,o)){for(n="",r=0,i=e.length;r<i;r++)"'"===e[r]&&r<i-1&&"'"!==e.charAt(r+1)||(n+=e.charAt(r));return e=n,(a=this._baseTable.getColumnIndexInTable(e))<0&&t._throwError(),a}return-1},t._validateColumnString=function(e,t,o){var n,r,i;if(t)return!0;if(2===arguments.length&&!0,n="",r=n=e[0],"#"===n||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!1;for(i=1;i<e.length;i++){if(" "===(n=e[i])||","===n||":"===n||"["===n&&"'"!==r||"]"===n&&"'"!==r||"@"===n&&"'"!==r||"#"===n&&"'"!==r)return!1;r=n}return!0},t._getValidaColumnString=function(e){for(var t="",o="",n=(t=e.charAt(0),0);n<e.length;n++)("["===(t=e.charAt(n))||"]"===t||"@"===t||"#"===t||"'"===t)&&(o+="'"),o+=t;return o},t._containsInvalidateColumnString=function(e){var t,o="";if("#"===(o=e.charAt(0))||" "===o||"@"===o||" "===o||","===o||":"===o||"["===o||"]"===o)return!0;for(t=1;t<e.length;t++)if(" "===(o=e.charAt(t))||","===o||":"===o||"["===o||"]"===o||"@"===o||"#"===o)return!0;return!1},t._getColumnEndString=function(e,o,n,r){var i,a,s=!1;if("["===n)for(s=!0,r++,o++,n=e.charAt(o);" "===n;)o++,n=e.charAt(o);for(i=o;"]"!==n&&(","!==n||r>1);)"'"===n&&o++,o++,n=e.charAt(o);return o<=i&&t._throwError(),a=e.substring(i,o),r>1&&r--,s||(a=t._trimEnd(a)),{columnEndString:a,charIndex:o,currentChar:n,lbracketLever:r}},t._parsePortion=function(e,o,n,r){for(var i,a,s,l=t,u=14,c=o;"]"!==n;)"'"===n&&o++,o++,n=e.charAt(o);for(i=e.substring(c,o).toLowerCase().trim(),a=!1,s=0;s<l._structReferenceKeywordsLlowercase.length;s++)if(i===l._structReferenceKeywordsLlowercase[s]){u=l._getPortion(i),a=!0;break}if(a||l._throwError(),++o>=e.length)r--;else{for(n=e.charAt(o);" "===n;)o++,n=e.charAt(o);if(","===n){for(r<=1&&l._throwError(),o++,n=e.charAt(o);" "===n;)o++,n=e.charAt(o);for("["===n&&(r++,o++,n=e.charAt(o));" "===n;)o++,n=e.charAt(o)}r>1&&r--}return{portion:u,charIndex:o,currentChar:n,lbracketLever:r}},t._getPortion=function(e){switch(e){case"#all":return 14;case"#data":return 3;case"#headers":return 2;case"#totals":return 8;case"#this row":return 1}return 14},t._parseTableObject=function(e,t,o,n){for(var r,i,a=me,s=t.length;"["!==n&&o<s;)o++,n=t.charAt(o);return(r=o)>0?(i=t.substring(0,r),a=e.getTableByName(i)):a=e.getTableByIndex(e.row,e.column),{table:a,charIndex:o,currentChar:n}},t._throwError=function(){throw""},t.prototype.unParse=function(e,o){var n,r,i,a,s=this;if(16===s._referencePortions&&1===s._referenceColumnSpecifier)return o.content+=s._baseTable.tableName(),void(e.toStandard&&(o.content+="[]"));n=t,(!(e.source===s._baseTable.source()&&e.row>=s._baseTable.startRow()&&e.column>=s._baseTable.startColumn()&&e.row<=s._baseTable.endRow()&&e.column<=s._baseTable.endColumn())||e.toStandard)&&(o.content+=s._baseTable.tableName()),o.content+="[",16!==s._referencePortions&&(r=n._getPortionsString(s._referencePortions,1!==s._referenceColumnSpecifier,e.toStandard),o.content+=r),1!==s._referenceColumnSpecifier&&((1!==s._referencePortions||e.toStandard)&&16!==s._referencePortions&&(o.content+=", "),i=s._baseTable.getColumnName(s._columnReferenceStartInTable),i=n._getValidaColumnString(i),4===s._referenceColumnSpecifier?(a=s._baseTable.getColumnName(s._columnReferenceEndInTable),a=n._getValidaColumnString(a),o.content+="["+i+"]:["+a+"]"):o.content+=(1!==s._referencePortions||e.toStandard||n._containsInvalidateColumnString(i))&&16!==s._referencePortions?"["+i+"]":i),o.content+="]"},t._getPortionsString=function(e,t,o){switch(e){case 1:return o?"[#This Row]":"@";case 2:return t?"[#Headers]":"#Headers";case 3:return t?"[#Data]":"#Data";case 8:return t?"[#Totals]":"#Totals";case 6:return"[#Headers], [#Data]";case 12:return"[#Data], [#Totals]"}return t?"[#All]":"#All"},t.prototype.offsetWhenInsertRemoveColumn=function(e,o,n){var r,i,a=this._catchedTableStartColumn;return e<a||e===a&&n||e>this._columnReferenceEndInTable+a?this:(o=n?o:-o,r=e-a,(i=new t(me,me))._baseTable=this._baseTable,i._columnReferenceEndInTable=this._columnReferenceEndInTable+o,i._columnReferenceStartInTable=this._columnReferenceStartInTable,e<=a+this._columnReferenceStartInTable&&(i._columnReferenceStartInTable+=o,i._columnReferenceStartInTable<r&&(i._columnReferenceStartInTable=r)),i._referenceColumnSpecifier=this._referenceColumnSpecifier,i._referencePortions=this._referencePortions,i._columnReferenceEndInTable<i._columnReferenceStartInTable?new d(He):i)},t.prototype.offsetWhenCopy=function(e,o){var n,r=new t(me,me);return r._baseTable=this._baseTable,r._columnReferenceEndInTable=this._columnReferenceEndInTable,r._columnReferenceStartInTable=this._columnReferenceStartInTable,2===this._referenceColumnSpecifier&&o&&(o%=n=this._baseTable.endColumn()-this._baseTable.startColumn()+1,r._columnReferenceStartInTable+=o,r._columnReferenceStartInTable<0&&(r._columnReferenceStartInTable+=n),r._columnReferenceEndInTable=r._columnReferenceStartInTable),r._referenceColumnSpecifier=this._referenceColumnSpecifier,r._referencePortions=this._referencePortions,r},t.prototype.offset=function(e,o,n){var r=new t(me,me);return r._baseTable=this._baseTable,r._referencePortions=this._referencePortions,r._columnReferenceStartInTable=this._columnReferenceStartInTable,r._columnReferenceEndInTable=this._columnReferenceEndInTable,r._referenceColumnSpecifier=this._referenceColumnSpecifier,r},t._structReferenceKeywordsLlowercase=["#all","#data","#headers","#totals","#this row"],t}(S),e.StructReferenceExpression=M,E=function(e){function t(t){e.call(this),this.nameIdentity=t.toUpperCase(),this.t=25}return __extends(t,e),t}(H),e.NameIdentityExpression=E,N=function(e){function t(t,o){e.call(this),this.nameIdentity=o.toUpperCase(),this.source=t,this.t=26}return __extends(t,e),t}(H),e.ExternalNameIdentityExpression=N,O=function(e){function t(t,o){e.call(this),this.expr=t,this.needExpendIndexs=o,this.t=24}return __extends(t,e),t}(H),e.ExpandExpression=O,e._mappingArray=function(r,i,a,s,l){var u,c,f,g,m,_,y,C,S,x,b,I,M,E,N,P,H,k,V,B,z,G,W,j=r.row,U=r.column,Y=[],X=0;Y[X]={expr:i,acceptsArray:!1,acceptsRef:!1,index:-1};for(var K,J,Z,$,ee,oe=0,ne=0,re=!1,ie=s,ae=l,le=!1;X>=0;){if(J=(K=Y[X--]).acceptsArray,Z=K.acceptsRef,i=K.expr,$=me,i)if(7===i.t){if(f=(u=i).argCount(),typeof u.fn===se)if(r){if(!(c=r.getFunction(u.fn))){$=new d(ke);continue}if(f<c.minArgs||f>c.maxArgs){$=new d(Le);continue}u.fn=c}else $=new d(ke);if(c=u.fn,g=K.index,P=K.neeedExpendindexs,g<0?(K.noExpendCatchValue=le,K.arrayFormulaCatchValue=a,2===c.arrayArgumentEvaluateMode&&(le=!0),1===c.arrayArgumentEvaluateMode&&(a=!0),K.args=[]):(c.acceptsArray(g)?oe--:re&&(P||(P=[],K.neeedExpendindexs=P),u.getArg(g),P.push(g)),K.args.push(ee)),g==f-1){if(le=K.noExpendCatchValue,a=K.arrayFormulaCatchValue,_=!1,(m=K.args)&&m.length>0)for(y=0;y<m.length;y++)if(m[y]!==u.getArg(y)){_=!0;break}$=_?new n(u.fn,m):i,P&&P.length>0&&($=new O($,P),re=!0)}else re=!1,g++,K.index=g,c.acceptsArray(g)&&oe++,Y[++X]=K,Y[++X]={expr:u.getArg(g),acceptsArray:c.acceptsArray(g),acceptsRef:c.acceptsReference(g),index:-1}}else if(0===i.t||1===i.t){if(C=i,ne&&(C.rowRelative||C.columnRelative)){var ue,ce,he=(de=i.source||r.source).getRowCount(),pe=de.getColumnCount();ue=(ue=C.rowRelative?(C.row+r.activeRow)%q.maxRowCount%he:C.row)<0?ue+he:ue,ce=(ce=C.columnRelative?(C.column+r.activeColumn)%q.maxColumnCount%pe:C.column)<0?ce+pe:ce,i=1===i.t?new T(de,ue,ce,!1,!1):new R(ue,ce,!1,!1)}}else if(2===i.t||3===i.t||16===i.t||17===i.t){if(17===i.t){if(!(I=(S=i).getRange(j,U))){$=i,ee=i;continue}i=S.source()===r.source?new A(I.row,I.column,I.row+I.rowCount-1,I.column+I.columnCount-1):new D(S.source(),I.row,I.column,I.row+I.rowCount-1,I.column+I.columnCount-1)}if(x=i,ne&&(x.startRowRelative||x.startColumnRelative||x.endRowRelative||x.endColumnRelative)){he=(de=i.source||i.startSource||r.source).getRowCount(),pe=de.getColumnCount();var de,fe=x.startRowRelative?(x.startRow+r.activeRow)%he:x.startRow,ge=x.startColumnRelative?(x.startColumn+r.activeColumn)%pe:x.startColumn,_e=x.endRowRelative?(x.endRow+r.activeRow)%he:x.endRow,ye=x.endColumnRelative?(x.endColumn+r.activeColumn)%pe:x.endColumn;(fe=fe<0?fe+he:fe)>(_e=_e<0?_e+he:_e)&&(b=fe,fe=_e,_e=b),(ge=ge<0?ge+pe:ge)>(ye=ye<0?ye+pe:ye)&&(b=ge,ge=ye,ye=b),i=2===i.t?new A(fe,ge,_e,ye,!1,!1,!1,!1):3===i.t?new D(de,fe,ge,_e,ye,!1,!1,!1,!1):new F(de,i.endSource,fe,ge,_e,ye,!1,!1,!1,!1)}Z&&(J||!a)||r.row<0||r.column<0||(oe>0&&!a||0===oe||le?(I=x.getRange(j,U),a?!x.isFullColumn&&1!=I.rowCount&&ie>=I.rowCount||!x.isFullRow&&1!=I.columnCount&&ae>=I.columnCount?$=new d(Ve):(ue=(x.isFullColumn?0:I.row)+(1==I.rowCount?0:ie),ce=(x.isFullRow?0:I.column)+(1==I.columnCount?0:ae),$=16===i.t?new F(i.startSource,i.endSource,ue,ce,ue,ce,!1,!1,!1,!1):3===i.t?new T(i.source,ue,ce,!1,!1):new R(ue,ce,!1,!1)):I.rowCount>1&&I.columnCount>1||I.rowCount>1&&!x.isFullColumn&&(j<I.row||j>=I.row+I.rowCount)||I.columnCount>1&&!x.isFullRow&&(U<I.column||U>=I.column+I.columnCount)?$=new d(Le):(ue=x.isFullColumn||I.rowCount>1?j:I.row,ce=x.isFullRow||I.columnCount>1?U:I.column,$=16===i.t?new F(i.startSource,i.endSource,ue,ce,ue,ce,!1,!1,!1,!1):3===i.t?new T(i.source,ue,ce,!1,!1):new R(ue,ce,!1,!1))):re=!0)}else if(11===i.t)M=i,-1===K.index?(K.index=0,Y[++X]=K,Y[++X]={expr:M.operand,acceptsArray:!1,acceptsRef:!1,index:-1}):($=ee!=M.operand?new w(M.operator,ee):i,re&&((P=[]).push(0),$=new O($,P)));else if(10===i.t)N=(E=i).operator.acceptsReference,-1===K.index?(K.index=0,Y[++X]=K,Y[++X]={expr:E.left,acceptsArray:N,acceptsRef:N,index:-1}):0==K.index?(ee!=E.left&&($=new v(E.operator,ee,E.right),K.expr=$),re&&((P=[]).push(0),K.neeedExpendindexs=P,re=!1),K.index=1,Y[++X]=K,Y[++X]={expr:E.right,acceptsArray:N,acceptsRef:N,index:-1}):($=ee!=E.right?new v(E.operator,E.left,ee):E,P=K.neeedExpendindexs,re&&(P||(P=[]),P.push(1)),P&&($=new O($,P),re=!0));else if(14===i.t)H=i,-1===K.index?(K.index=0,Y[++X]=K,Y[++X]={expr:H.argument,acceptsArray:J,acceptsRef:Z,index:-1}):H.argument!==ee&&($=new t(ee));else if(8===i.t||9===i.t)k=i,1==K.index?(ne--,$=ee,K.context&&(r=K.context)):(ne++,Y[++X]={expr:i,acceptsArray:!0,acceptsRef:!0,index:1},B=r,9===i.t?(z=i.source,(B=new Q(z)).cloneFrom(r),V=z.getCustomName(k.name)):(V=r.getName(k.name),r.source.getCustomName(k.name)||(B=new te(r.source)).cloneFrom(r)),V||(V=new e.ErrorExpression(ke)),B&&(r=B),Y[++X]={expr:V,acceptsArray:!0,acceptsRef:!0,index:-1,context:r});else if(15===i.t)if(G=i,!J&&(oe>0||a))re=!0;else if(!J&&0==oe)if(ie>=G.value.RowCount&&G.value.RowCount>1||ae>=G.value.ColumnCount&&G.value.ColumnCount>1)$=new d(Ve);else try{1==G.value.RowCount&&(ie=0),1==G.value.ColumnCount&&(ae=0),"string"==typeof(W=G.value.getValue(ie,ae))?$=new p(W):"number"==typeof W&&($=new h(W)),L||(L=new o.Parser),$=L.parse(G.value.getValue(ie,ae).toString(),me)}catch(e){$=new d(Ve)}$===me&&($=i),ee=$}return $}}(o.Expressions||(o.Expressions={})),K=o.Expressions,(Ee=o.StructReferencePortions||(o.StructReferencePortions={}))[Ee.ThisRow=1]="ThisRow",Ee[Ee.Headers=2]="Headers",Ee[Ee.Data=3]="Data",Ee[Ee.Totals=8]="Totals",Ee[Ee.HeadersAndData=6]="HeadersAndData",Ee[Ee.DataAndTotals=12]="DataAndTotals",Ee[Ee.All=14]="All",Ee[Ee.NotSpecific=16]="NotSpecific",o.StructReferencePortions,(Ne=o.StructReferenceColumnSpecifier||(o.StructReferenceColumnSpecifier={}))[Ne.All=1]="All",Ne[Ne.NotSpecific=1]="NotSpecific",Ne[Ne.SingleColumn=2]="SingleColumn",Ne[Ne.ColumnRange=4]="ColumnRange";o.StructReferenceColumnSpecifier;var Ge,We,je={None:0,Sign:1,Int:2,Dot:3,Decimal:4,Exponent:5,SignExponent:6,ScientificNotation:7,Number:8},Ue={UppercaseLetter:0,LowercaseLetter:1,DecimalDigitNumber:8,OtherNumber:10,SpaceSeparator:11,Control:14,ConnectorPunctuation:18,DashPunctuation:19,OpenPunctuation:20,ClosePunctuation:21,InitialQuotePunctuation:22,FinalQuotePunctuation:23,OtherPunctuation:24,MathSymbol:25,currencySymbol:26,ModifierSymbol:27,OtherSymbol:28},Ye=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];(Ge=o.ExcelFormulaTokenType||(o.ExcelFormulaTokenType={}))[Ge.Operand=0]="Operand",Ge[Ge.Function=1]="Function",Ge[Ge.Subexpression=2]="Subexpression",Ge[Ge.Argument=3]="Argument",Ge[Ge.OperatorPrefix=4]="OperatorPrefix",Ge[Ge.OperatorInfix=5]="OperatorInfix",Ge[Ge.OperatorPostfix=6]="OperatorPostfix",Ge[Ge.Whitespace=7]="Whitespace",Ge[Ge.Unknown=8]="Unknown",o.ExcelFormulaTokenType,(We=o.ExcelFormulaTokenSubtype||(o.ExcelFormulaTokenSubtype={}))[We.Nothing=0]="Nothing",We[We.Start=1]="Start",We[We.Stop=2]="Stop",We[We.Text=3]="Text",We[We.Number=4]="Number",We[We.Logical=5]="Logical",We[We.Error=6]="Error",We[We.RangeOrName=7]="RangeOrName",We[We.Concatenation=8]="Concatenation",We[We.Intersection=9]="Intersection",We[We.Union=10]="Union",We[We.RangeOp=11]="RangeOp",o.ExcelFormulaTokenSubtype,J=function(){return function(e,t,o,n){(n===_e||n===me)&&(n=0),this.value=e,this.type=t,this.index=o,this.subType=n,this.children=[]}}(),Z=function(){function e(e,t,o,n,r){this.toStandard=!1,this.ignoreError=!1,this.source=me;this.useR1C1=t,this.row=o,this.column=n,this.option=r,this.source=e}return e.prototype.getExternalSource=function(e,t){for(var n=this.source.getCalcService().getAllSouceModels(),r=0;r<n.length;r++)if(o.compareStringIgnoreCase(n[r].getSource().getName(),t))return n[r].getSource();return me},e.prototype.getExternalSourceToken=function(e){return e.getName()},e.prototype.getTableByName=function(e){return me},e.prototype.getTableByIndex=function(e,t){return me},e.prototype.setSource=function(e){this.source=e},e}(),o.ParserContext=Z,q=function(){function n(e){typeof e!==ie&&e!==me&&n.setParserOption(e)}return n.setParserOption=function(e){n.listSeparator=w(e,"listSeparator",","),n.numberDecimalSeparator=w(e,"numberDecimalSeparator","."),n.arrayGroupSeparator=w(e,"arrayGroupSeparator",";"),n.arrayListSeparator=w(e,"arrayListSeparator",","),n._operatorInfix="\\+-*/^&=><: "+n.listSeparator},n.getParserOption=function(){return{numberDecimalSeparator:n.numberDecimalSeparator,listSeparator:n.listSeparator,arrayGroupSeparator:n.arrayGroupSeparator,arrayListSeparator:n.arrayListSeparator}},n.prototype.parse=function(e,t){var o;return t||(t=new Z(me,!1,0,0)),t.option&&n.setParserOption(t.option),o=this._parseToToken(e),this._buildExpressionTree(t,o)},n.prototype.unparse=function(e,t){if(n.unparseWithoutCulture=!1,!e)return"";t||(t=new Z(me,!1,0,0)),t.option&&n.setParserOption(t.option);var o={content:""};return this._unparseExpression(e,t,o),o.content},n.prototype.unparseWithoutCulture=function(e,t){if(n.unparseWithoutCulture=!0,!e)return"";t||(t=new Z(me,!1,0,0)),t.option&&n.setParserOption(t.option);var o={content:""};return this._unparseExpression(e,t,o),n.unparseWithoutCulture=!1,o.content},n.prototype.a1ToR1C1=function(e,t){for(var o,r,i,a,s,l,u,c,h,p,d,f,_,y=0,C=t.length,w=Ye,v=Ue,S=-1,x=-1,R=-1,b=!1,T="",A=!0,I=!0;y<C&&" "===t.charAt(y);)y++;for("="===t.charAt(y)&&y++,y=0;y<=C;y++)if(y!==C?s=32|(a=(o=t[y]).charCodeAt(0)):(o="\0",a=s=0),"$"===o)i||(b?(i=!0,r=b=!1):r&&(b=!0,A=!1));else if(a<127&&s>=96&&s<=122)i||(b?(i=!0,r=b=!1):r?h.push(s):(y>0&&"$"===t.charAt(y-1)?(S=y-1,I=!1):S=y,r=!0,h=[s]));else if(a<127&&a>=48&&a<=57||a>=127&&(w[a]===v.DecimalDigitNumber||w[a]===v.OtherNumber))i||(b=!0,!r&&S<0&&(y>0&&"$"===t.charAt(y-1)?(S=y-1,A=!1):S=y),R<0&&(R=y));else if("'"===o||'"'===o||"["===o)i=r=b=!1,S=R=-1,A=I=!0,y=(p="["===o?m(t,y,"[","]","'",!1):g(t,y,o,o,!1))?p.endIndex:C-1;else if("_"===o||"\\"===o||"?"===o||"."===o)i=!0,r=b=!1;else if(i||r||b){if((r||b)&&"!"!==o&&"("!==o&&"["!==o){if(l="",r&&b)l=t.substring(R,y);else{for(d=S-1;d>=0&&" "===t.charAt(d);)d--;if(d<=0||":"!==t.charAt(d))for(d=y;d<C&&" "===t.charAt(d);)d++;d>0&&d<C&&":"===t.charAt(d)?b&&(l=t.substr(R,y-1)):r=b=!1}if(b&&((u=parseInt(l,10))>n.maxRowCount&&(b=r=!1)),r){for(c=0,_=f=h.length-1;_>=0;_--)c+=(h[_]-96)*Math.pow(26,f-_);c>n.maxColumnCount&&(b=r=!1)}(r||b)&&(S>x+1&&(T+=t.substring(x+1,S)),x=y-1),b&&(T+="R",A&&(T+="[",u-=e.row+1),T+=u.toString(),A&&(T+="]")),r&&(T+="C",I&&(T+="[",c-=e.column+1),T+=c.toString(),I&&(T+="]"))}i=r=b=!1,S=R=-1,A=I=!0}return C>x+1&&(T+=t.substring(x+1,C)),T},n.prototype._unparseExpression=function(o,r,i){var a,s,l;if(o instanceof K.ConstantExpression)this._unparseConstantExpression(o,r,i);else if(o instanceof K.OperatorExpression)this._unParseOperatorExpressions(o,r,i);else if(o instanceof K.ReferenceExpression)this._unParseRefenceExpressions(o,r,i);else if(18===o.t)i.content+="!",i.content+=o.name;else if(9===o.t)a=o.source,this._unparseSource(a,r,i),i.content+="!",s=o.name,i.content+=s;else if(8===o.t)s=o.name,i.content+=s;else if(14===o.t)i.content+="(",this._unparseExpression(o.argument,r,i),i.content+=")";else{if(7!==o.t)throw t.SR.Exp_NotSupport;for(i.content+=o.getFunctionName(),i.content+="(",l=0;l<o.argCount();l++)0!==l&&(i.content+=n.unparseWithoutCulture?",":e.Sheets.CR.listSeparator),this._unparseExpression(o.getArg(l),r,i);i.content+=")"}},n.prototype._unparseSource=function(e,t,o){t.getExternalSourceToken&&(o.content+=this._getValidSource(t,t.getExternalSourceToken(e),t.useR1C1))},n.prototype._unparseSource2=function(e,t,o,n){var r={content:""};this._unparseSource(e,o,r);var i=this._removeApostrophe(r),a=this._removeWorkbook(r),s=a.success,l=a.workBookName,u={content:""};this._unparseSource(t,o,u),i|=this._removeApostrophe(u),l=this._removeWorkbook(u).workBookName,i?(n.content+="'",s&&(n.content+=l),n.content+=r.content,n.content+=":",n.content+=u.content,n.content+="'"):(s&&(n.content+=l),n.content+=r.content,n.content+=":",n.content+=u.content)},n.prototype._getValidSource=function(e,t,o){if(t===_e||t===me||""===t)return"";var n=this._readSheetReference(e,t,o,!0),r=t.length;return n.success?("'"===t.charAt(0)&&"'"===t.charAt(r-1)&&(t="'"+(t=(t=t.substr(1,r-2)).replace("'","''"))+"'"),t):(n=this._readSheetReference(e,"'"+t+"'",o,!0)).success?"'"+(t=t.replace("'","''"))+"'":""},n.prototype._unParseRefenceExpressions=function(e,o,n){var r,i,a,s,l,u,c,h=this,p=o.row,d=o.column;if(22===e.t)n.content+="!",r=e,h._unParseCell(o.useR1C1,p,d,r.row,r.column,r.rowRelative,r.columnRelative,n);else if(0===e.t)i=e,h._unParseCell(o.useR1C1,p,d,i.row,i.column,i.rowRelative,i.columnRelative,n);else if(1===e.t)a=e,h._unparseSource(a.source,o,n),n.content+="!",h._unParseCell(o.useR1C1,p,d,a.row,a.column,a.rowRelative,a.columnRelative,n);else if(23===e.t)n.content+="!",s=e,h._unParseRange(o.useR1C1,p,d,s.startRow,s.startColumn,s.endRow,s.endColumn,s.startRowRelative,s.startColumnRelative,s.endRowRelative,s.endColumnRelative,n,s._getRangeType());else if(2===e.t)l=e,h._unParseRange(o.useR1C1,p,d,l.startRow,l.startColumn,l.endRow,l.endColumn,l.startRowRelative,l.startColumnRelative,l.endRowRelative,l.endColumnRelative,n,l._getRangeType());else if(3===e.t)u=e,h._unparseSource(u.source,o,n),n.content+="!",h._unParseRange(o.useR1C1,p,d,u.startRow,u.startColumn,u.endRow,u.endColumn,u.startRowRelative,u.startColumnRelative,u.endRowRelative,u.endColumnRelative,n,u._getRangeType());else if(16===e.t)c=e,h._unparseSource2(c.startSource,c.endSource,o,n),n.content+="!",h._unParseRange(o.useR1C1,p,d,c.startRow,c.startColumn,c.endRow,c.endColumn,c.startRowRelative,c.startColumnRelative,c.endRowRelative,c.endColumnRelative,n,c._getRangeType());else{if(17!==e.t)throw t.SR.Exp_NotSupport;e.unParse(o,n)}},n.prototype._removeApostrophe=function(e){var t=e.content,o=t.length;return"'"===t.charAt(o-1)&&(e.content=t.substr(1,o-2),!0)},n.prototype._removeWorkbook=function(e){if("["!==e.content.charAt(0))return{success:!1,workBookName:""};var t=e.content.indexOf("]"),o=e.content.substr(0,t+1);return e.content=e.content.substr(t),{success:!0,workBookName:o}},n.prototype._unParseCell=function(e,t,o,r,i,a,s,l,u){var c,h,p,d,f,g,m,_,y;if((u===_e||u===me)&&(u=X.cell),c=n.BAND_INDEX_CONST,h=n.maxRowCount-1,(u===X.cell||u===X.row)&&r!==c&&r>-h&&r<=2*h&&(r=v(r+=a?t:0,h)),p=n.maxColumnCount-1,(u===X.cell||u===X.column)&&i!==c&&i>-p&&i<=2*p&&(i=v(i+=s?o:0,p)),this._isCellIndexsError(t,o,r,i,a,s,u))l.content+=He.toString();else if(d="",f="",e){if(d="R",r>=0&&(t!==r||!a)&&(a?d=d+"["+(r-t)+"]":d+=++r),i<0)return void(l.content+=d);if(f="C",o===i&&s||(s?f=f+"["+(i-o)+"]":f+=++i),a&&r<0||!a&&r<=0)return void(l.content+=f);l.content+=d,l.content+=f}else{if(d=""+ ++r,a||(d="$"+r),i<0)return void(l.content+=d);for(g=i,m=1,_=ge.length;m<_;m++)y=ge[_-m],i=parseInt(g/y,10),g%=y,0!==i&&(f+=String.fromCharCode(i+65-1));if(f+=String.fromCharCode(g+65),s||(f="$"+f),r<=0)return void(l.content+=f);l.content+=f,l.content+=d}},n.prototype._isCellIndexsError=function(e,t,o,n,r,i,a){var s=!1;switch(a){case X.sheet:break;case X.cell:s|=o<0,s|=n<0;break;case X.row:s|=o<0;break;case X.column:s|=n<0}return s},n.prototype._unParseRange=function(e,t,o,r,i,a,s,l,u,c,h,p,d){(d===_e||d===me)&&(d=X.cell),this._unParseCell(e,t,o,r,i,l,u,p,d);var f=n.BAND_INDEX_CONST;e&&r===a&&i===s&&(a===f||s===f)||(a!==f||s!==f)&&(p.content+=":",this._unParseCell(e,t,o,a,s,c,h,p,d))},n.prototype._unParseOperatorExpressions=function(e,o,r){var i,a,s;if(11===e.t)(i=e.operator)===U.percent?(this._unparseExpression(e.operand,o,r),r.content+=i.name):(r.content+=i.name,this._unparseExpression(e.operand,o,r));else{if(10!==e.t)throw t.SR.Exp_NotSupport;a={content:""},s={content:""},this._unparseExpression(e.right,o,s);var l=10===e.left.t,u=10===e.right.t,c=y(e.operator.name);l&&y(e.left.operator.name)>c?(a.content+="(",this._unparseExpression(e.left,o,a),a.content+=")"):this._unparseExpression(e.left,o,a),u&&y(e.right.operator.name)>c&&(s.content+="(",this._unparseExpression(e.right,o,s),s.content+="("),r.content+=a.content,r.content+=11===e.operator.t?n.listSeparator:e.operator.name,r.content+=s.content}},n.prototype._unparseConstantExpression=function(o,r,i){var a,s,l,u,c,h,p,d,f=t.SR.Exp_InvalidArray;if(5===o.t)i.content+='"',i.content+=o.value,i.content+='"';else if(4===o.t)a=o.originalValue,n.unparseWithoutCulture||(a=t._NumberHelper.replaceNormalToCultureSymble(a.toString())),i.content+=a;else if(6===o.t)i.content+=o.value?ue:ce;else if(15===o.t){if(i.content+="{",(s=o.value).getRowCount()<=0)throw f;for(u=l=n.BAND_INDEX_CONST,c=0;c<s.getRowCount();c++)for(c>=1&&(i.content+=n.unparseWithoutCulture?";":e.Sheets.CR.arrayGroupSeparator),h=0;h<s.getColumnCount();h++){if(u!==l&&(u!==s.getColumnCount()||0===s.getColumnCount()))throw f;if(0!==h&&(p=n.unparseWithoutCulture?",":e.Sheets.CR.arrayListSeparator,i.content+=p),(d=s.getValue(c,h))===_e||d===me)throw f;d instanceof K.Expression?this._unparseExpression(d,r,i):typeof d===se?(i.content+='"',i.content+=d,i.content+='"'):i.content+=typeof d===le?d?ue:ce:n.unparseWithoutCulture||typeof d!==ae?d.toString():t._NumberHelper.replaceNormalToCultureSymble(d.toString())}i.content+="}"}else if(13===o.t)this._unparseSource(o.source,r,i),i.content+="!",i.content+=o.value.toString();else if(19===o.t)this._unparseSource2(o.startSource,o.endSource,r,i),i.content+="!",i.content+=o.value.toString();else if(20===o.t)i.content+="!",i.content+=o.value.toString();else if(12===o.t)i.content+=o.value.toString();else if(21!==o.t)throw t.SR.Exp_NotSupport},n.prototype._parseToToken=function(e,o){var r,i,a,s,l,c,p,d,y,C,w,v,S;void 0===o&&(o=!0);for(var x,R,b=e.length,T=[],A=[],I=-1,D="",F=0,M=0;M<b&&" "===e.charAt(M);)M++;for("="===e.charAt(M)&&M++,F=M,r=M;r<b;r++)if('"'===(i=e.charAt(r)))(a=g(e,r,'"','"',o))?(T.push(new J(a.result,0,r+1,3)),F=(r=a.endIndex)+1):(D+=e.substring(r,b),r=b-1);else if("'"===i)(a=g(e,r,"'","'",o))?(D+="'",D+=a.result,D+="'",r=a.endIndex):(D+="'",r+=1);else if("["===i)if(a=m(e,r,"[","]","'",o))D+=a.result,D+="]",r=a.endIndex;else{if("R"===D||"r"===D||"C"===D||"c"===D)continue;D+=e.substring(r,b),r=b-1}else{if("\r"===i||"\n"===i)continue;if("#"===i)(s=_(e,r))?(l=r<b?e.charAt(r+1):"\0",r>0&&"!"===e.charAt(r-1)?D+=s.result:"#REF!"===s.result.toUpperCase()&&r<b&&(h(l)||"$"===l)?D+=s.result:(T.push(new J(s.result,0,r,6)),F=r+1),r=s.endIndex):D+=i;else if("+"===i||"-"===i)c=0===T.length?null:T[T.length-1],0!==D.length?(T.push(new J(D,0,F)),T.push(new J(i,5,r)),D="",F=r+1):(c&&7===c.type&&(T.pop(),c=T[T.length-1]),c&&(1===c.type&&2===c.subType||2===c.type&&2===c.subType||6===c.type||0===c.type)?(T.push(new J(i,5,r)),F=r+1):(T.push(new J(i,4,r)),F=r+1));else if(i===n.numberDecimalSeparator||u(i))if(D.length>0)D+=i;else if((p=f(e,r,n.numberDecimalSeparator)).result){for(d=p.endIndex,y=e.slice(r,d+1),"."!==n.numberDecimalSeparator&&(y=t._NumberHelper.replaceCultureSymbolToNormal(y));d<=b-2&&" "===e.charAt(d+1);)d++;d<=b-2&&":"===e.charAt(d+1)?(D+=y,D+=":",d++,F=r):(T.push(new J(y,0,r,4)),F=r+1),r=d}else D+=i;else if("{"===i){if(D.length>0&&o)throw t._StringHelper.format(t.SR.Exp_FormulaInvalid,[i,r]);x=new J(he,1,r,1),T.push(x),A[++I]=x,x=new J(pe,1,r,1),T.push(x),A[++I]=x,F=r+1}else if(i===n.arrayGroupSeparator&&I>=0&&(A[I].value===he||A[I].value===pe)){if(D.length>0&&(T.push(new J(D,0,F)),D=""),I<0&&o)throw t._StringHelper.format(t.SR.Exp_FormulaInvalid,[i,r]);R=A[I--],R=new J(i,R.type,r,2),T.push(R),T.push(new J(n.listSeparator,3,r)),x=new J(pe,1,r+1,1),T.push(x),A[++I]=x,F=r+1}else if("}"===i){if(D.length>0&&(T.push(new J(D,0,F)),D=""),d<0&&o)throw t._StringHelper.format(t.SR.Exp_FormulaInvalid,[i,r]);R=A[I--],R=new J(i,R.type,r,2),T.push(R),R=A[I--],R=new J(i,R.type,r,2),T.push(R),F=r+1}else if(" "===i){for(C=r,r++;r<b&&" "===D.charAt(D.length-1);)r++;D.length>0&&":"!==D.charAt(D.length-1)&&r<b&&":"!==e.charAt(r)&&(T.push(new J(D,0,F)),D="",T.push(new J("",7,C))),F=r,r--}else if(r+2<=b&&"<"===i&&"="===e.charAt(r+1)||">"===i&&"="===e.charAt(r+1)||"<"===i&&">"===e.charAt(r+1))D.length>0&&(T.push(new J(D,0,F)),D=""),T.push(new J(e.slice(r,r+2),5,r,5)),F=++r+1;else if("%"===i)D.length>0&&(T.push(new J(D,0,F)),D=""),T.push(new J(e.charAt(r),6,r)),F=r+1;else if("+"===i||"-"===i||"*"===i||"/"===i||"="===i||">"===i||"<"===i||"&"===i||"^"===i)D.length>0&&(T.push(new J(D,0,F)),D=""),T.push(new J(i,5,r)),F=r+1;else if("("===i)D.length>0?(":"===(w=D.charAt(D.length-1))||w===n.listSeparator||" "===w?(D=D.slice(0,D.length-1),T.push(new J(D,0,F,7)),T.push(new J(w,5,r-1,0)),x=new J("",2,r,1),T.push(x),A[++I]=x):(S=":",-1===(v=D.indexOf(":"))&&(v=D.indexOf(n.listSeparator),S=n.listSeparator),-1===v&&(v=D.indexOf(" "),S=" "),-1!==v&&v>0?(T.push(new J(D.substr(0,v),0,F,7)),T.push(new J(S,5,F+v,0)),D=D.slice(v+1),x=new J(D.toUpperCase(),1,F+v+1,1),T.push(x),A[++I]=x):(x=new J(D.toUpperCase(),1,r-D.length,1),T.push(x),A[++I]=x)),D=""):(x=new J("",2,r,1),T.push(x),A[++I]=x),F=r+1;else if(i===n.listSeparator||i===n.arrayListSeparator||i===n.arrayGroupSeparator)D.length>0&&(T.push(new J(D,0,F)),D=""),I<0||1!==A[I].type?T.push(new J(n.listSeparator,5,r,10)):T.push(new J(n.arrayListSeparator,3,r)),F=r+1;else if(")"===i){if(D.length>0&&(T.push(new J(D,0,F)),D=""),I<0&&o)throw t._StringHelper.format(t.SR.Exp_FormulaInvalid,[i,r]);R=A[I--],R=new J(i,R.type,r,2),T.push(R),F=r+1}else":"===i?0===D.length&&2===T[T.length-1].subType?(T.push(new J(":",5,r,11)),F=r+1):D+=":":D+=i}return D.length>0&&T.push(new J(D,0,F)),this._processTokens(T,o)},n.prototype._processTokens=function(e,o){var n,r,i,a,s,l,u,c,h=this._removeWhiteSpace(e),p=[],d=new J("",8,0,1);for(p.push(d),r=h.length,i=0;i<r;i++)if(a=h[i]){if(s=0===i?me:h[i-1],l=i===r-1?me:h[i+1],0===a.type&&0===a.subType?(u=a.value.toUpperCase())===ue||u===ce?(a.subType=5,a.value=u):a.subType=7:1===a.type&&a.value.length>0&&"@"===a.value.charAt(0)&&(a.value=a.value.substr(1)),0===p.length&&o)throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);if((n=p[p.length-1]).value===pe&&o&&3!==a.type&&6!==a.subType&&2!==a.subType&&5!==a.subType&&4!==a.subType&&3!==a.subType&&4!==a.type)throw t._StringHelper.format(t.SR.Exp_InvalidArrayAt,[a.index]);switch(a.type){case 0:if(o&&s&&(0===s.type||6===s.type||1===s.type&&2===s.subType||2===s.type&&2===s.subType))throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);break;case 1:case 2:if(a.value===he&&1===a.type&&1===a.subType&&!s)break;if(o&&(2===a.subType&&(!s||4===s.type||5===s.type)||1===a.subType&&s&&(!l||6===s.type||2===s.subType||0===s.type)))throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);if(o&&2===a.subType&&2===a.type&&1===s.subType)throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);if(o&&2===a.subType&&1===a.type&&2===s.type&&1===s.subType)throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);if(o&&1===a.subType&&s&&(1===s.type&&2===s.subType||0===s.type||6===s.type))throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);break;case 3:if(o&&(!l||!s||5===s.type||4===s.type))throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);break;case 4:if(o&&(!l||s&&6===s.type))throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);break;case 5:if(o&&(!l||!s||5===s.type||4===s.type||3===s.type||1===s.type&&1===s.subType||2===s.type&&1===s.subType))throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);break;case 6:if(o&&(!s||4===s.type||5===s.type||1===s.type&&1===s.subType||2===s.type&&1===s.subType))throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index]);break;default:if(o)throw t._StringHelper.format(t.SR.Exp_InvalidTokenAt,[a.index])}if(o)if(1===a.subType)p.push(a),n.children.push(a);else if(2===a.subType){if(0===p.length&&(c=a.value===he||a.value===pe?"}":")",o))throw t._StringHelper.format(t.SR.Exp_FormulaInvalid,[c,a.index]);p.pop()}else n.children.push(a)}return o?d.children:h},n.prototype._removeWhiteSpace=function(e){for(var t,o,n,r=[],i=e.length,a=0;a<i;a++)if(t=e[a]){if(7!==t.type){r.push(t);continue}o=0==a?me:e[a-1],n=a==i-1?me:e[a+1],o&&n&&(1===o.type&&2===o.subType||2===o.type&&2===o.subType||0===o.type)&&(1===n.type&&1===n.subType||2===n.type&&1===n.subType||0===n.type)&&r.push(new J(" ",5,t.index,9))}return r},n.prototype._buildExpressionNode=function(e,t){var o;return 1===t.type?o=t.value===he?this._buildArraryExpression(e,t):this._buildFunctionExpression(e,t):2===t.type?o=this._buildSubExpression(e,t):0===t.type&&(4===t.subType?o=new K.DoubleExpression(parseFloat(t.value),t.value):6===t.subType?o=new K.ErrorExpression(N.parse(t.value)):5===t.subType?r(t.value,ue)?o=new K.BooleanExpression(!0):r(t.value,ce)&&(o=new K.BooleanExpression(!1)):o=7===t.subType?this._buildCellReferenceOrNameExpressions(e,t.value,t.index):new K.StringExpression(t.value)),o},n.prototype._buildExpressionTree=function(e,t){for(var o,n,r,i,a,s=this._parseToBinaryOperatorList(e,t),l=3;l<s.length;)if(i=s[l],a=s[l-2],i&&5===i.type){for(;l>=3&&y(i.value)>=y(a.value);)n=s[l-3],r=s[l-1],o=new K.BinaryOperatorExpression(C(a),n,r),s.splice(l-3,3),s.splice(l-3,0,o),(l-=2)>=3&&(a=s[l-2]);l+=2}else l++;if(1===s.length)return s[0];for(l=s.length-2;l>0;l-=2)n=s[l-1],r=s[l+1],o=new K.BinaryOperatorExpression(C(s[l]),n,r),s.splice(l-1,3),s.push(o);return o},n.prototype._parseToBinaryOperatorList=function(e,t){for(var o,n,r,i,a,s=[],l=0;l<t.length;l++)if(4===(o=t[l]).type){for(n=[];4===o.type;)n.push("+"===o.value?U.plus:U.negate),o=t[++l];for(r=t[l],a=new K.UnaryOperatorExpression(n.pop(),this._buildExpressionNode(e,r));n.length>0;)a=new K.UnaryOperatorExpression(n.pop(),a);s.push(a)}else 6===o.type?(i=s[s.length-1],a=new K.UnaryOperatorExpression(U.percent,i),s.pop(),s.push(a)):5===o.type?s.push(o):(a=this._buildExpressionNode(e,o),s.push(a));return s},n.prototype._buildFunctionExpression=function(e,o){for(var n,r,i,a=[],s=[],l=0;l<o.children.length;l++)3!==(n=o.children[l]).type?s.push(n):0===s.length?a.push(new K.MissingArgumentExpression):(a.push(this._buildExpressionTree(e,s)),s=[]);if(0!==s.length?a.push(this._buildExpressionTree(e,s)):0!==o.children.length&&a.push(new K.MissingArgumentExpression),(r=Y.findGlobalFunction(o.value))||(r=e.source.getCustomFunction(o.value)),r){if((i=a.length)<r.minArgs||i>r.maxArgs)throw t._StringHelper.format(t.SR.Exp_InvalidParameters,[o.index]);return new K.FunctionExpression(r,a)}return new K.FunctionExpression(o.value,a)},n.prototype._buildSubExpression=function(e,t){return new K.ParenthesesExpression(this._buildExpressionTree(e,t.children))},n.prototype._buildArraryExpression=function(e,n){for(var r,i,a,s,l,u,c,h=[],p=-1,d=n.children,f=d.length,g=0;g<f;g++)if(c=d[g],r=0===g?me:d[g-1],3!==c.type){if(r&&3!==r.type)throw t._StringHelper.format(t.SR.Exp_InvalidArrayAt,[c.index]);if(1!==c.type||c.value!==pe)throw t._StringHelper.format(t.SR.Exp_InvalidArrayAt,[c.index]);if(-1!==p&&c.children.length!==p)throw t._StringHelper.format(t.SR.Exp_InvalidArrayColumns,[c.index]);p=c.children.length,i=[],h.push(i);var m=c.children,_=m.length,y=me;for(a=0;a<_;a++){if(3===(s=m[a]).type)y&&3!==y.type&&a!==_-1||i.push(o.missingArgument);else{if(y&&3!==y.type)throw t._StringHelper.format(t.SR.Exp_InvalidArrayAt,[c.index]);if(4===s.type){if(a+1>=_)throw t._StringHelper.format(t.SR.Exp_InvalidArrayAt,[c.index]);(l=m[a+1]).value=""+s.value+l.value,s=l,a++}else a+1<_&&6===m[a+1].type&&(l=m[a+1],s.value=""+s.value+l.value,a++);(u=this._buildExpressionNode(e,s))&&i.push(u.value)}y=s}}else if(!r||3===r.type||g===f-1)throw t._StringHelper.format(t.SR.Exp_InvalidArrayAt,[c.index]);if(0===h.length||h[0]===_e||h[0]===me||0===h[0].length)throw t._StringHelper.format(t.SR.Exp_InvalidArrayAt,[c.index]);return new K.ArrayExpression(h)},n.prototype._buildCellReferenceOrNameExpressions=function(e,o,n){var r,i,a,s=this._buildCellReferenceOrNameExpressions2(e,o,n),l=s.endIndex,u=s.expression,c=o.length;if(!u)throw t._StringHelper.format(t.SR.Exp_InvalidCellReference,[n]);if(l<=0||l>=c)return u;if(":"!==o.charAt(l))throw t._StringHelper.format(t.SR.Exp_InvalidCellReference,[n]);for(l++,(r=[]).push(u);l>0&&l<c;){if(i=l,l=(s=this._buildCellReferenceOrNameExpressions2(e,o.substr(l),n)).endIndex,!(u=s.expression))throw t._StringHelper.format(t.SR.Exp_InvalidCellReference,[n]);if(r.push(u),(l+=i)<c&&":"!==o.charAt(l))throw t._StringHelper.format(t.SR.Exp_InvalidCellReference,[n]);l++}for(u=r[0],a=1;a<r.length;a++)u=new K.BinaryOperatorExpression(U.range,u,r[a]);return u},n.prototype._buildCellReferenceOrNameExpressions2=function(e,t,n){var r,i,a,s,l,u,c,h,p,d,f,g,_,y,C,w,v;if(t===_e||t===me||""===t)return{endIndex:0,expression:me};if(r=t.length,t.length>=5&&"#REF!"===t.substr(0,5))return{endIndex:r,expression:new K.ErrorExpression(He)};if(a=(i="!"===t.charAt(0))?1:0,r<1)return{endIndex:0,expression:me};var S=-1,x="",R=0;if(i)S=a;else if("'"===t.charAt(0))S=t.indexOf("!")+1,x=t.substr(0,S-1);else if(s=t.indexOf("!"),_=t.indexOf(":"),-1!==s)if(l=t.substr(a,s-a),_<0||s<_)s<r-1&&(x=l,S=s+1);else{if((u=this._parseToCellReference(e,l,i)).expression)return u;s<r-1&&(x=l,S=s+1),R=u.endIndex}var b="",T="",A="";if(-1!==S&&x&&""!==x){if(!(c=this._readSheetReference(e,x,e.useR1C1,!1)).success)return{endIndex:R,expression:me};b=c.workBookName,T=c.startSheetName,A=c.endSheetName}else S=a;if(f=!1,(b&&""!==b||T&&""!==T)&&(f=!0,e.getExternalSource&&!(p=e.getExternalSource(b,T))))return{endIndex:R,expression:new K.ErrorExpression(He)};if(A&&""!==A&&(f=!0,e.getExternalSource&&!(d=e.getExternalSource(b,A))))return{endIndex:R,expression:new K.ErrorExpression(He)};var I=t.substr(S),D=this._parseToCellReference(e,I,i,p,d),F=D.expression;if(R=D.endIndex,F){if(f&&16!==F.t&&!(F instanceof K.ExternalReferenceExpression)&&13!==F.t&&19!==F.t&&9!==F.t)return{endIndex:r,expression:new K.ErrorExpression(He)};if(R<I.length-1){if(R=r-(I.length-R),":"!==t.charAt(R)){if(T&&""!==T){if(A&&""!==A)return{endIndex:R,expression:me};if(!e.getExternalSource)return{endIndex:R,expression:new K.ErrorExpression(He)};if(!(h=e.getExternalSource(b,T)))return{endIndex:R,expression:new K.ErrorExpression(He)};F=new K.ExternalNameExpression(h,I)}else F=new K.NameExpression(I);R=r}}else R=r}else{for(_=-1,y=0;y<t.length;y++)if("["===(g=t[y]))(C=m(t,y,"[","]","'"))&&(y=C.endIndex);else if(":"===g){_=y;break}if(i)F=new K.BangNameExpression(I);else if(T&&""!==T){if(A&&""!==A)return{endIndex:R,expression:me};if(!e.getExternalSource)return{endIndex:R,expression:new K.ErrorExpression(He)};if(!(h=e.getExternalSource(b,T)))return{endIndex:R,expression:new K.ErrorExpression(He)};F=new K.ExternalNameExpression(h,I)}else if(_>0){if(w=t.substr(0,_),e.ignoreError||this._validateName(w))return{range1EndIndex:_,endIndex:r,expression:F=new o.Expressions.BinaryOperatorExpression(o.Operators.range,new o.Expressions.NameExpression(w),this._buildCellReferenceOrNameExpressions(e,t.substr(_+1),n+_+1))};F=me}else F=new K.NameExpression(I);R=r}if(F&&(9===F.t||8===F.t))if(v=this._createStructExpression(e,I,n))F=v;else if(!e.ignoreError&&!this._validateName(I))return{endIndex:R,expression:me};return{endIndex:R,expression:F}},n.prototype._parseToCellReference=function(e,t,o,r,i){var a,s,l,u,c,h=0;if("#"===t.charAt(0)&&(h=(a=_(t,0)).endIndex+1,s=N.parse(a.result)))return{endIndex:h,expression:this._createExternalErrorExpression(s,o,r,i)};if(l=e.useR1C1?this._isR1C1CellReferance(t,e.row,e.column):this._isA1CellReferance(t),u=n.BAND_INDEX_CONST,l.success&&e.useR1C1&&l.startRow!==u&&l.startColumn===u&&l.endRow===u&&l.endColumn===u)l.endRow=l.startRow,l.endRowRelative=l.startRowRelative;else if(l.success&&e.useR1C1&&l.startColumn!==u&&l.startRow===u&&l.endRow===u&&l.endColumn===u)l.endColumn=l.startColumn,l.endColumnRelative=l.startColumnRelative;else if(!l.success||l.startRow===u&&(l.startColumn===u||l.endColumn===u)||l.startColumn===u&&l.endRow===u)return{endIndex:l.endIndex,expression:me};return c=this._createCellReferenceExpression(e,e.row,e.column,l.startRow,l.startColumn,l.endRow,l.endColumn,l.startRowRelative,l.startColumnRelative,l.endRowRelative,l.endColumnRelative,o,r,i),{endIndex:l.endIndex,expression:c}},n.prototype._createExternalErrorExpression=function(e,t,o,n){return t?new K.BangErrorExpression(e):o&&n?new K.SheetRangeErrorExpression(o,n,e):o?new K.ExternalErrorExpression(o,e):new K.ErrorExpression(e)},n.prototype._createCellReferenceExpression=function(e,t,o,r,i,a,s,l,u,c,h,p,d,f){var g,m,_,y=n.BAND_INDEX_CONST;return r!==y&&a!=y&&r>a&&(m=r,r=a,a=m,_=l,l=c,c=_),i!==y&&s!=y&&i>s&&(m=i,i=s,s=m,_=u,u=h,h=_),r-=r!==y&&l?t:0,i-=i!=y&&u?o:0,a-=a!==y&&c?t:0,s-=s!==y&&h?o:0,d&&f?(g=new K.SheetRangeExpression(d,f),r===y?g.initBand(d,f,i,s,u,h,!1):i===y?g.initBand(d,f,r,a,l,c,!0):((a===y||s===y)&&(a=r,s=i),g.init(d,f,r,i,a,s,l,u,c,h)),g):a===y&&s===y?p?d||f?me:new K.BangCellExpression(r,i,l,u):d?new K.ExternalCellExpression(d,r,i,l,u):new K.CellExpression(r,i,l,u):p?d&&f?me:(g=new K.BangRangeExpression,r===y?g.initBand(i,s,u,h,!1):i===y?g.initBand(r,a,l,c,!0):g.init(r,i,a,s,l,u,c,h),g):d?(g=new K.ExternalRangeExpression,r===y?g.initBand(d,i,s,u,h,!1):i===y?g.initBand(d,r,a,l,c,!0):g.init(d,r,i,a,s,l,u,c,h),g):(g=new K.RangeExpression,r===y?g.initBand(i,s,u,h,!1):i===y?g.initBand(r,a,l,c,!0):g.init(r,i,a,s,l,u,c,h),g)},n.prototype._readSheetReference=function(e,t,o,n){var r,i,a,s,l={success:!1,startSheetName:"",endSheetName:"",workBookName:""},u=!1,c=t.length;return"'"===t.charAt(0)&&"'"===t.charAt(c-1)&&(u=!0,t=t.substr(1,c-2)),-1!==(r=t.indexOf("["))&&(0!==r&&(l.workBookName=t.substr(0,r),"\\"!==l.workBookName.charAt(r-1)&&(l.workBookName=l.workBookName+"\\")),i=g(t,r,"[","]"),l.workBookName=l.workBookName+i.result,t=t.substr(i.endIndex+1)),-1===(a=t.indexOf(":"))?l.startSheetName=t:(l.startSheetName=t.substr(0,a),l.endSheetName=t.substr(a+1)),l.startSheetName&&""!==l.startSheetName?(this,s=this._validateWorkbook(l.workBookName,u),s=e.ignoreError&&!n||this._validateSheetName(l.startSheetName,o,u),s&=e.ignoreError&&!n||this._validateSheetName(l.endSheetName,o,u),n&&(l.startSheetName&&(l.startSheetName=l.startSheetName.replace("'","''")),l.endSheetName&&(l.endSheetName=l.endSheetName.replace("'","''"))),l.success=s,l):(l.success=!1,l)},n.prototype._isStartWithCellReference=function(e,t){return t?this._isR1C1CellReferance(e):this._isA1CellReferance(e)},n.prototype._isA1CellReferance=function(e){var t,o,r,i,a,s,l,u,c=n.BAND_INDEX_CONST,h={startRow:c,startColumn:c,endRow:c,endColumn:c,startRowRelative:!0,startColumnRelative:!0,endRowRelative:!0,endColumnRelative:!0,success:!1,endIndex:0};return t=(e=e.replace(" ","")).length,o=this._readOneA1Element(e,0),h.endIndex=o.endIndex,!o.success||h.endIndex>t?h:o.isRow?(h.startRow=o.elementIndex,h.startRowRelative=o.isRelative,":"===e.charAt(h.endIndex)?(h.endIndex++,r=this._readOneA1Element(e,h.endIndex),h.endIndex=r.endIndex,r.success&&r.isRow?(h.endRow=r.elementIndex,h.endRowRelative=r.isRelative,h.success=!0,h):h):h):(h.startColumn=o.elementIndex,h.startColumnRelative=o.isRelative,":"===e.charAt(h.endIndex)?(h.endIndex++,r=this._readOneA1Element(e,h.endIndex),h.endIndex=r.endIndex,!r.success||r.isRow?h:(h.endColumn=r.elementIndex,h.endColumnRelative=r.isRelative,h.success=!0,h)):d(e.charAt(h.endIndex))||"$"===e.charAt(h.endIndex)?(r=this._readOneA1Element(e,h.endIndex),h.endIndex=r.endIndex,r.success&&r.isRow?(h.startRow=r.elementIndex,h.startRowRelative=r.isRelative,i=h.endIndex,h.endIndex<t-1&&":"===e.charAt(h.endIndex)?"'"===e.charAt(h.endIndex+1)||(a=e.indexOf("!",h.endIndex+1),s=e.indexOf(":",h.endIndex+1),-1!==a&&(-1===s||s>a))?(h.success=!0,h):(h.endIndex++,!(l=this._readOneA1Element(e,h.endIndex)).success||l.isRow?(h.endIndex=i,h.success=!0,h):(h.endIndex=l.endIndex,h.endColumn=l.elementIndex,h.endColumnRelative=l.isRelative,(u=this._readOneA1Element(e,h.endIndex)).success&&u.isRow?(h.endIndex=u.endIndex,h.endRow=u.elementIndex,h.endRowRelative=u.isRelative,h.success=!0,h):(h.endIndex=i,h.endColumn=c,h.success=!0,h))):(h.success=!0,h)):h):h)},n.prototype._isR1C1CellReferance=function(e,t,o){var r,i,a,s,l,u,c,h,p=n.BAND_INDEX_CONST,d={startRow:p,startColumn:p,endRow:p,endColumn:p,startRowRelative:!0,startColumnRelative:!0,endRowRelative:!0,endColumnRelative:!0,success:!1,endIndex:0};return r=(e=e.replace(" ","")).length,i=this._readOneR1C1Element(e,t,o,0),d.endIndex=i.endIndex,i.success?i.isRow?(d.startRow=i.elementIndex,d.startRowRelative=i.isRelative,d.endIndex>=r?(d.success=!0,d):":"===e.charAt(d.endIndex)?(d.endIndex++,a=this._readOneR1C1Element(e,t,o,d.endIndex),d.endIndex=a.endIndex,a.success&&a.isRow?(d.endRow=a.elementIndex,d.endRowRelative=a.isRelative,d.success=!0,d):d):"C"===e.charAt(d.endIndex)||"c"===e.charAt(d.endIndex)?(a=this._readOneR1C1Element(e,t,o,d.endIndex),d.endIndex=a.endIndex,!a.success||a.isRow?d:(d.startColumn=a.elementIndex,d.startColumnRelative=a.isRelative,s=d.endIndex,d.endIndex<r-1&&":"===e.charAt(d.endIndex)?"'"===e.charAt(d.endIndex+1)||(l=e.indexOf("!",d.endIndex+1),u=e.indexOf(":",d.endIndex+1),-1!==l&&(-1===u||u>l))?(d.success=!0,d):(d.endIndex++,(c=this._readOneR1C1Element(e,t,o,d.endIndex)).success&&c.isRow?(d.endIndex=c.endIndex,d.endRow=c.elementIndex,d.endRowRelative=c.isRelative,!(h=this._readOneR1C1Element(e,t,o,d.endIndex)).success||h.isRow?(d.endIndex=s,d.success=!0,d):(d.endIndex=h.endIndex,d.endColumn=h.elementIndex,d.endColumnRelative=h.isRelative,d.success=!0,d)):(d.endIndex=s,d.success=!0,d)):(d.success=!0,d))):d):(d.startColumn=i.elementIndex,d.startColumnRelative=i.isRelative,d.endIndex>=r?(d.success=!0,d):":"===e.charAt(d.endIndex)?(d.endIndex++,a=this._readOneR1C1Element(e,t,o,d.endIndex),d.endIndex=a.endIndex,!a.success||a.isRow?d:(d.endColumn=a.elementIndex,d.endColumnRelative=a.isRelative,d.success=!0,d)):d):d},n.prototype._readOneA1Element=function(e,t){var o,r,i,a,s,l={endIndex:t,elementIndex:n.BAND_INDEX_CONST,isRow:!0,isRelative:!0,success:!1},u=e.length;if(t>=u||("$"===e.charAt(t)&&(l.isRelative=!1,t++),t>=u))return l;if(o=t,d(i=e.charAt(o))&&"0"!==i){for(l.isRow=!0;o<u&&d(i);)++o<u&&(i=e.charAt(o));if((r=parseInt(e.substr(t,o-t),10))>=1&&r<=n.maxRowCount)return l.elementIndex=r-1,l.endIndex=o,l.success=!0,l}else if(c(i)){for(l.isRow=!1;o<u&&c(i);)++o<u&&(i=e.charAt(o));if((a=e.substr(t,o-t)).length>3)return l;for(r=0,s=(a=a.toUpperCase()).length-1;s>=0;s--)r+=(a.charCodeAt(s)-64)*ge[a.length-s-1];if(r<=n.maxColumnCount)return l.elementIndex=r-1,l.endIndex=o,l.success=!0,l}return l},n.prototype._readOneR1C1Element=function(e,t,o,r){var i,a,s,l,u,c={endIndex:r,elementIndex:n.BAND_INDEX_CONST,isRow:!0,isRelative:!1,success:!1},h=e.length;if(r>=h)return c;if(i=r,"R"===(a=e.charAt(i))||"r"===a)c.isRow=!0,s=t;else{if("C"!==a&&"c"!==a)return c;c.isRow=!1,s=o}if(i++,++r>=h)return c.endIndex=r,c.elementIndex=s,c.isRelative=!0,c.success=!0,c;if("["===(a=e.charAt(i))&&(r++,i++,c.isRelative=!0),r>=h||(l=!1,a=e.charAt(i),c.isRelative&&"-"===a&&(r++,i++,l=!0),r>=h))return c;if(!d(a=e.charAt(i)))return c.isRelative?c:(c.endIndex=r,c.elementIndex=s,c.isRelative=!0,c.success=!0,c);for(;i<h&&d(a);)++i<h&&(a=e.charAt(i));if(u=parseInt(e.substr(r,i-r),10),c.isRelative){if(i>=h||"]"!==e.charAt(i))return c;i++}return u<(c.isRow?n.maxRowCount:n.maxColumnCount)?(c.isRelative?(u=l?-u:u,c.elementIndex=u+s):c.elementIndex=u-1,c.endIndex=i,c.success=!0,c):void 0},n.prototype._validateWorkbook=function(e,t){var o,r;if(e===_e||e===me||""===e)return!0;for(r=0;r<e.length;r++)if(o=e[r],t){if("*"===o||":"===o||"["===o||"]"===o||"?"===o||"'"===o&&(0===r||r>=e.length-1||"'"!==e.charAt(r+1)))return!1}else if("'"===o||"["===o||"]"===o||"?"===o||"%"===o||-1!==n._operatorInfix.indexOf(o))return!1;return!0},n.prototype._validateSheetName=function(e,t,o){var r,i,a;if(e===_e||e===me||""===e)return!0;if(!o&&u(e.charAt(0))||(r=this._isStartWithCellReference(e,t),!o&&r.success&&r.endIndex===e.length))return!1;for(a=0;a<e.length;a++)if(i=e.charAt(a),o){if("*"===i||":"===i||"["===i||"]"===i||"?"===i||"\\"===i||"/"===i)return!1}else if("'"===i||"["===i||"]"===i||"?"===i||"\\"===i||"%"===i||'"'===i||"("===i||")"===i||-1!==n._operatorInfix.indexOf(i))return!1;return!0},n.prototype._createStructExpression=function(e,o,n){if("]"===o.charAt(o.length-1))try{return new K.StructReferenceExpression(o,e)}catch(e){throw t._StringHelper.format(t.SR.Exp_FormulaInvalid,["{",n])}else{var r=e.getTableByName(o);if(r)return K.StructReferenceExpression.create(r)}return me},n.prototype._validateName=function(e){var t,o,n;if(!(e!==_e&&e!==me&&""!==e&&(t=e.length,1!==t||"R"!==e&&"r"!==e&&"C"!==e&&"c"!==e)&&(o=e.charAt(0),"_"===o||"\\"===o||c(o)||p(o))))return!1;for(n=1;n<t;n++)if("_"!==(o=e.charAt(n))&&"\\"!==o&&"?"!==o&&"."!==o&&!h(o)&&!p(o))return!1;return!0},n.prototype.parseReferenceExpressionInfos=function(e,t,o,n){var r=[];try{r=this._parseToToken(e,!1)}catch(e){}return r=this._fillBlankToTokens(r,e),this._getExpressToken(r,e,t,o,n)},n.prototype._adjustArrayTokens=function(e){for(var t,o=0,n=0;n<e.length;n++)1===(t=e[n]).type&&1===t.subType&&t.value===he?o=0:1===t.type&&1===t.subType&&t.value===pe?(0===o&&(e.splice(n,1),n--),o++):1===t.type&&2===t.subType&&"}"===t.value&&(0===--o&&(e.splice(n,1),n--));return e},n.prototype._fillBlankToTokens=function(e,o){var n,r,i,a,s;for(e.splice(0,0,new J("=",1,0,0)),i=e.length-1;i>0;i--)e[i].index===e[i-1].index&&e[i].value===e[i-1].value&&(e=t.ArrayHelper.removeByIndex(e,i));for(a=0;a<e.length-1;a++)r=this._getTokenLength(e[a]),e[a+1].index-e[a].index-r>0&&(n={index:e[a].index+r,value:o.substring(e[a].index+r,e[a+1].index),type:7},e.splice(a+1,0,n));for(r=this._getTokenLength(e[a]),e.length>0&&o.length>e[a].index+r&&(n={index:e[a].index+e[a].value.length,value:o.substring(e[a].index+e[a].value.length,o.length),type:7},e.splice(a+1,0,n)),s=0;s<e.length;s++)"("===e[s].value.trim()?(e[s].type=1,e[s].subType=1):")"===e[s].value.trim()?(e[s].type=1,e[s].subType=2):"{"===e[s].value.trim()?(e[s].type=1,e[s].subType=1):"}"===e[s].value.trim()&&(e[s].type=1,e[s].subType=2);return e},n.prototype._getTokenLength=function(e){return 1!==e.type||"ARRAY"!==e.value&&"ARRAYROW"!==e.value||"ARRAY"!==e.value&&"ARRAYROW"!==e.value?e.value.length:1},n.prototype._getExpressToken=function(e,n,r,i,a){var s,l,u,c,h,p,d,f,g,m=_e,_=r._getSheetSource(),y=r.getCalcService();for(y?(s=new o.SheetParserContext(r,y.useR1C1,i,a),m=new Q(_,!1,i,a)):s=new Z(me,!1,0,0),l=[],u=0;u<e.length;u++)try{if("["===(c=e[u]).value||t.StringUtil.startsWith(c.value,"#")||3===c.subType){l.push({text:c.value,type:c.type,subType:c.subType,canDrag:!1,ranges:c.ranges,value:c.value});continue}if(h=[],this._buildExpressionInfo(s,c,h),h.length>0){for(g=0;g<h.length;g++)if((p=h[g])instanceof J)l.push({text:p.value,type:p.type,subType:p.subType,canDrag:x,ranges:[],value:p.value});else if(p instanceof $){var C=p,w=C.expression,v=n.substring(C.startIndex,C.endIndex+1),S=[],x=!0;if(w)if(8===w.t)x=!1,m&&(d=m.getName(w.name),this._getRanges(d,S,m,i,a));else if(17===w.t)x=!1,w.source()===_?(f=w.getRange(i,a))&&S.push(this._cellRange2Range(f)):S=null;else if(w instanceof K.ReferenceExpression)if(16===w.t){var R=w.startSource,b=w.endSource,T=R.getSources(b);for(g=0;g<T.length;g++)if(T[g]===_){S.push(this._cellRange2Range(w.getRange(i,a)));break}}else w instanceof K.ExternalReferenceExpression?w.source===_?S.push(this._cellRange2Range(w.getRange(i,a))):S=null:S.push(this._cellRange2Range(w.getRange(i,a)));else S=null;else S=null;S&&S.length>0?l.push({text:v,type:0,subType:7,canDrag:x,ranges:S,value:v}):l.push({text:v,type:c.type,subType:c.subType,canDrag:x,ranges:S,value:v})}}else l.push({text:c.value,type:c.type,subType:c.subType,canDrag:!1,ranges:c.ranges,value:c.value})}catch(e){l.push({text:c.value,type:c.type,subType:c.subType,canDrag:!1,ranges:c.ranges,value:c.value})}return l},n.prototype._cellRange2Range=function(e){return new t.Range(e.row,e.column,e.rowCount,e.columnCount)},n.prototype._getRanges=function(e,t,o,n,r){var i,a,s,l,u,c;if(e){for(;14===e.t;)e=e.argument;if(this,24===e.t&&(e=e.expr),!(e instanceof K.ConstantExpression))if(e instanceof K.ExternalReferenceExpression)o.source&&e.source===o.source&&(i=e.getRange(n,r),t.push(this._cellRange2Range(i)));else if(17===e.t)e.source()===o.source&&((i=e.getRange(n,r))&&t.push(this._cellRange2Range(i)));else if(e instanceof K.ReferenceExpression)i=e.getRange(n,r),t.push(this._cellRange2Range(i));else if(9===e.t)a=me,e.source.getCalcService()&&(a=new Q(e.source,!1,n,r)),s=a.getName(e.name),this._getRanges(s,t,a,n,r);else if(8===e.t)l=o.getName(e.name),this._getRanges(l,t,o,n,r);else if(11===e.t)this._getRanges(e.operand,t,o,n,r);else if(10===e.t)this._getRanges(e.left,t,o,n,r),this._getRanges(e.right,t,o,n,r);else if(7===e.t)for(u=e,c=0;c<u.argCount();c++)this._getRanges(u.getArg(c),t,o,n,r)}},n.prototype._buildExpressionInfo=function(e,t,o){var n,r,i,a,s;if(void 0!==t&&"function"!=typeof t&&null!==t&&0===t.type){var l,u,c=t.value,h=this._buildCellReferenceOrNameExpressions2(e,c,t.index);if(null!=h&&(l=h.endIndex,10===(u=h.expression).t?(r=u.left,i=u.right,o.push(new $(t.index,t.index+h.range1EndIndex-1,r)),o.push(new $(t.index+h.range1EndIndex,t.index+l-1,i))):(n=new $(t.index,t.index+l-1,u),o.push(n)),!(l<=0||l>=c.length))&&":"==c[l])for(o.push(new J(":",5,l+t.index)),l++;l>0&&l<c.length;){if(a=l+t.index,null==(h=this._buildCellReferenceOrNameExpressions2(e,c.substring(l),t.index)))return;if(s=h.endIndex,u=h.expression,n=new $(a,a+s-1,u),o.push(n),(l+=s)>=c.length||":"!==c[l])return;o.push(new J(":",5,l+t.index)),l++}}},n.BAND_INDEX_CONST=-2147483648,n.maxRowCount=1048576,n.maxColumnCount=16384,n._isLetter=c,n._isLetterOrDigit=h,n.listSeparator=",",n.numberDecimalSeparator=".",n.arrayGroupSeparator=";",n.arrayListSeparator=",",n._operatorInfix="\\+-*/^&=><: "+n.listSeparator,n.unparseWithoutCulture=!1,n}(),o.Parser=q,$=function(){return function(e,t,o){this.startIndex=e,this.endIndex=t,this.expression=o}}(),Q=function(){function e(e,t,o,n,r,i,a,s){this.asyncId=0,this.asyncCount=0,this._expandArrayToMultiCallCount=0;var l=this;arguments.length;l.source=e,l.arrayFormulaMode=!!t,l.row=o||0,l.column=n||0,l.rowCount=r||1,l.columnCount=i||1,l.activeRow=a!==_e?a:l.row,l.activeColumn=s!==_e?s:l.column,l.rowOffset=a===_e?l.row:l.activeRow-l.row,l.columnOffset=s===_e?l.column:l.activeColumn-l.column}return e.prototype.getValue=function(e,t,o){return e?e.getValue(t,o):He},e.prototype.getReference=function(e,t,o,n,r){return e?e.getReference(t,o,n,r):He},e.prototype.getSheetRangeReference=function(e,t,o,n,r,i){return e&&t?e.getSheetRangeReference(t,o,n,r,i):He},e.prototype.getFunction=function(e){return this.source?this.source.getCustomFunction(e):me},e.prototype.getName=function(e){var t=this.source?this.source.getCustomName(e):me;return!t&&this.source&&(t=this.source.getCalcService().getGlobalSourceModel().getSource().getCustomName(e)),t},e.prototype._isExpandArrayToMultiCall=function(){return this._expandArrayToMultiCallCount>0},e.prototype._beginExpandArrayToMultiCall=function(){this._expandArrayToMultiCallCount++},e.prototype._endExpandArrayToMultiCall=function(){this._expandArrayToMultiCallCount--},e.prototype._offset=function(t,o){return new e(this.source,this.arrayFormulaMode,this.row+t,this.column+o,this.rowCount,this.columnCount,this.rowOffset,this.columnOffset)},e.prototype.SetAsyncResult=function(e,t){this.source.getCalcService()._evaluator.SetAsyncResult(e,t),this.source.refresh()},e.prototype.cloneFrom=function(e){var t=this;t.acceptsReference=e.acceptsReference,t.activeColumn=e.activeColumn,t.activeRow=e.activeRow,t.arrayFormulaMode=e.arrayFormulaMode,t.column=e.column,t.columnCount=e.columnCount,t.columnOffset=e.columnOffset,t.row=e.row,t.rowCount=e.rowCount,t.rowOffset=e.rowOffset},e}(),o.EvaluateContext=Q,ee=function(){function e(e,t){this.id=e.asyncId++,this.ctx=e,this.row=e.activeRow,this.col=e.activeColumn,this.expression=t}return e.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},e.prototype.SetAsyncResult=function(e){this.ctx.SetAsyncResult(this,e)},e}(),o.AsyncEvaluateContext=ee,te=function(e){function t(t,o,n,r,i,a,s,l){e.call(this,t,o,n,r,i,a,s,l),this._globalSource=t.getCalcService().getGlobalSourceModel().getSource()}return __extends(t,e),t.prototype.getName=function(e){return this._globalSource?this._globalSource.getCustomName(e):me},t}(Q),o.GloableEvaluateContext=te,oe=new q,ne=function(){function e(){this._aync2={},this._aync={}}return e.prototype.evaluateFormula=function(e,t,o,n){return this.evaluateExpression(oe.parse(e,t),o,n)},e.prototype.evaluateExpression=function(e,t,o,n,r){var i=this._evaluate(e,t,!!n,!!r);return i===_e||i===me?!1===o?i:0:"number"==typeof i&&i.toString().length>=15?+i.toPrecision(15):i},e.prototype._evaluate=function(e,o,n,r){var i,a,s,l,u;if(!e)throw t.SR.Exp_ExprIsNull;for(;14===e.t;)e=e.argument;return this,a=me,24===e.t&&(e=(s=e).expr,a=s.needExpendIndexs),e instanceof K.ConstantExpression?i=this._evaluateConst(e,o,n):e instanceof K.ReferenceExpression?i=this._evaluateReference(e,o,r,n):9===e.t?(l=me,e.source.getCalcService()&&(l=new Q(e.source,o.arrayFormulaMode,o.row,o.column)),l||(i=ke),i=this._evaluateName(e.name,l,o,n,r)):8===e.t?i=this._evaluateName(e.name,o,o,n,r):11===e.t?i=this._evaluateUnaryOperation(e,o,n,r,a):10===e.t?i=this._evaluateBinaryOperation(e,o,n,r,a):7===e.t?i=this._evaluateFunction(e,o,n,r,a):(25===e.t||26===e.t)&&(i=(u=e.source||o&&o.source)&&u.getValueByName(e.nameIdentity)),i},e.prototype._evaluateConst=function(e,t,o){var n=e.value;return G.arr(n)?o||t&&(t.arrayFormulaMode||t._isExpandArrayToMultiCall())?n:W.getArrayValue(n,0,0):n},e.prototype._evaluateReference=function(e,t,o,n){var r,i,a,s,l,u;if(!t)return Le;r=t.source,e instanceof K.ExternalReferenceExpression?r=e.source:17===e.t&&(r=e.source());var c=t.row,h=t.column,p=e.getRange(c,h);if(!p)return He;var d=p.row<0?0:p.row,f=p.column<0?0:p.column,g=p.rowCount,m=p.columnCount;if(o||t.arrayFormulaMode)return 16===e.t?t.getSheetRangeReference(e.startSource,e.endSource,p.row,p.column,g,m):t.getReference(r,p.row,p.column,g,m);if(n&&(g>1||m>1)){for(i=[],a=0;a<g;a++)for(i[a]=[],s=0;s<m;s++)i[a][s]=t.getValue(r,a+d,s+f);return new P(i,m)}if(g>1||m>1){if(l=t.row>=p.row&&t.row<p.row+g,u=t.column>=p.column&&t.column<p.column+m,!l&&!u)return Le;if(l&&!u&&1===m)d=t.row;else if(!l&&u&&1===g)f=t.column;else{if(1!==g&&1!==m)return Le;d=t.row,f=t.column}}else if(-1===p.row&&-1===g){if(1!==m)return Le;d=t.row}else if(-1===p.column&&-1===m){if(1!==g)return Le;f=t.column}return t.getValue(r,d,f)},e.prototype._evaluateName=function(e,t,o,n,r){if(!t||!o)return ke;var i=t.getName(e);return i?this._evaluate(i,o,n,r):ke},e.prototype._evaluateOperationArg=function(e,t,n,r){var i=this._evaluate(e,t,n,r);return G.err(i)?i:i===o.missingArgument?Ve:i},e.prototype._evaluateUnaryOperation=function(e,t,n,r,i){var a,s=!1;return i!=me&&i.length>0&&(n=!0,s=!0),a=this._evaluate(e.operand,t,n,s),G.err(a)?a:a===o.missingArgument?Ve:this._evaluateWithArgs(e,function(o){return e.operator.evaluate(o[0],t)},t,i,[a],n,r)},e.prototype._evaluateBinaryOperation=function(e,t,n,r,i){var a,s,l,u,c=[n,n],h=[e.operator.acceptsReference,e.operator.acceptsReference];if(i!=me&&i.length>0)for(l=0;l<i.length;l++)c[i[l]]=!0,h[i[l]]=!0;for(a=[e.left,e.right],s=[],l=0;l<2;l++){if(u=this._evaluate(a[l],t,c[l],h[l]),G.err(u))return u;if(u===o.missingArgument)return Ve;s[l]=u}return this._evaluateWithArgs(e,function(o){return e.operator.evaluate(o[0],o[1],t)},t,i,s,n,r)},e.prototype.startCache=function(){this._functionResultCaches={}},e.prototype.endCache=function(){this._functionResultCaches=me},e.prototype._evaluateFunction=function(e,t,n,r,i){var a,s,l,u,c,h,p,d,f,g,m,_,y;if(!e||!e.fn||"string"==typeof e.fn)return ke;var C,w=e.argCount(),v=this,S=t.asyncCount,x=e.fn,R=me;if(0===w)C=[];else{for(C=[],a=[],s=[],p=0;p<w;p++)a[p]=x.acceptsArray(p),s[p]=x.acceptsReference(p);if(i&&i.length>0){for(R=[],p=0;p<w;p++)R[p]=!0;for(p=0;p<i.length;p++)a[l=i[p]]=!0,s[l]=!0,R[l]=!(x.acceptsReference(l)&&!x.acceptsArray(l))}for(x.isBranch()&&(t.arrayFormulaMode||t._isExpandArrayToMultiCall())&&(a[x.findTestArgument()]=!0,s[x.findTestArgument()]=!0),h=-1,c=-1,x.isBranch()&&(h=x.findTestArgument(),x.acceptsArray(h)&&t._beginExpandArrayToMultiCall(),u=v._evaluate(e.getArg(h),t,a[h],s[h]),x.acceptsArray(h)&&t._endExpandArrayToMultiCall(),G.ref(u)||G.arr(u)||(c=x.findBranchArgument(u))),p=0;p<w;p++){if(h===p)d=u;else{if(c>=0&&p!==c){C[p]=null;continue}x.acceptsArray(p)&&t._beginExpandArrayToMultiCall(),d=v._evaluate(e.getArg(p),t,a[p],s[p]),x.acceptsArray(p)&&t._endExpandArrayToMultiCall()}if(!x.acceptsArray(p)&&G.arr(d)||!x.acceptsReference(p)&&G.ref(d))if(f=G.arr(d)?d:me,g=G.ref(d)?d:me,f!=me&&1==f.getRowCount()&&1==f.getColumnCount())d=f.getValue(0,0);else if(g!=me&&1==g.getRowCount(0)&&1==g.getColumnCount(0))d=g.getValue(0,0,0);else{if(m=[],_=!1,i!=me)for(y=0;y<i.length;y++)m.push(i[y]),i[y]==p&&(_=!0);_||(m.push(p),i=m)}if(G.err(d)&&!x.acceptsError(p))return d;d===o.missingArgument&&(x.acceptsMissingArgument(p)||(d=me)),C[p]=d}}return v._evaluateWithArgs(e,function(e,n){var i,a,s,l,u,c,h,p,d,f,g,m,_;if(x.isContextSensitive()){if(t.acceptsReference=r||t._isExpandArrayToMultiCall(),x instanceof Y.AsyncFunction){var y=new ee(t,n),C=t.source.getName()+"_"+t.activeRow+"_"+t.activeColumn+"_"+y.getFormula(),w=v._aync[C],R=t.source.getCalcService().currentAsync;return w!==_e&&R&&R.source===t.source.getName()&&R.row===t.activeRow&&R.col===t.activeColumn?w:(t.asyncCount++,t.asyncCount===S+1?(w=x.evaluateWithContext(e,y))===_e&&(w=x.defaultValue()):w=x.defaultValue(),v._aync2[C]!==_e?v._aync2[C]:w)}return x.evaluateWithContext(e,t)}if(i=t.arrayFormulaMode?v._functionResultCaches:me)if(a=!1,s=i[x.name+e.length])for(_=0;_<s.length;_++){if(a=!0,(l=s[_]).args.length===e.length)for(u=0;u<e.length;u++)if((c=l.args[u])!==(h=e[u])){if(!(c instanceof o.SheetReference&&h instanceof o.SheetReference)){a=!1;break}if(p=c._rangeCount,c._sheetSource!==h._sheetSource||p!==h._rangeCount){a=!1;break}for(d=0;d<p;d++)if(c.getRow(d)!==h.getRow(d)||c.getColumn(d)!==h.getColumn(d)||c.getRowCount(d)!==h.getRowCount(d)||c.getColumnCount(d)!==h.getColumnCount(d)){a=!1;break}}if(a)return l.flag++,l.value}else s=i[x.name+e.length]=[];if(f=x.evaluate(e),i){if((g=s.length)>=100){for(m=[],_=0;_<g;_++)s[_].flag>0&&m.push(s[_]);m.sort(function(e,t){return t.flag-e.flag}),g=Math.min(50,m.length),s=m.slice(0,g),i[x.name+e.length]=s}s.push({args:e,value:f,flag:0})}return f},t,i,C,n,r,R)},e.prototype.SetAsyncResult=function(e,t){var o=e.ctx,n=o.source.getName()+"_"+o.activeRow+"_"+o.activeColumn+"_"+e.getFormula();this._aync[n]=t,this._aync2[n]!=t&&(this._aync2[n]=t,o.source.getCalcService().currentAsync={source:o.source.getName(),row:e.row,col:e.col},o.source.getCalcService().recalculate(o.source,o.activeRow,o.activeColumn,!1),o.source.getCalcService().currentAsync=null)},e.prototype._evaluateWithArgs=function(e,t,o,n,r,i,a,s){var l,u,c,h,p,d,f,g,m,_,y;if(n&&n.length>0){if((l=this._expandArgs(o,e,r,n,s))==me)return Ve;var C=[],w=l[0].length,v=l[0][0].length;for(u=0;u<w;u++)for(C[u]=[],c=0;c<v;c++)try{for(h=[],p=0;p<r.length;p++)h[p]=l[p][u][c];if(f=t(h,e),G.ref(f)){if(7===e.t&&((d=e.fn).returnReference&&d.returnReference()))return f;f=this.getOneValue(o,f)}C[u][c]=f}catch(e){C[u][c]=Le}return new P(C)}try{if(f=t(r,e),o.arrayFormulaMode&&o._isExpandArrayToMultiCall())return f;if(G.arr(f)&&!i)return this.getOneValue(o,f);if(G.ref(f)&&!a){if(g=f,i&&1===g.getRangeCount()){for(m=[],_=0;_<g.getRowCount(0);_++)for(m[_]=[],y=0;y<g.getColumnCount(0);y++)m[_][y]=g.getValue(0,_,y);return new P(m,g.getColumnCount(0))}return this.getOneValue(o,f)}return f}catch(e){return Le}},e.prototype.getOneValue=function(e,t){var o,n,r,i;return G.ref(t)?(o=t).getRangeCount()>1?t=Le:(-1!=e.rowOffset||-1!=e.columnOffset?(r=1==o.getRowCount(0)?0:e.rowOffset,i=1==o.getColumnCount(0)?0:e.columnOffset):(r=1==o.getRowCount(0)?0:e.row-o.getRow(0),i=1==o.getColumnCount(0)?0:e.column-o.getColumn(0)),t=r>=o.getRowCount(0)||i>=o.getColumnCount(0)?Ve:o.getValue(0,r,i)):G.arr(t)&&(n=t,!e.arrayFormulaMode||-1==e.rowOffset&&-1==e.columnOffset?t=n.getValue(0,0):(r=1==n.getRowCount()?0:e.rowOffset,i=1==n.getColumnCount()?0:e.columnOffset,t=r>=n.getRowCount()||i>=n.getColumnCount()?Ve:n.getValue(r,i))),t},e.prototype._expandArgs=function(e,o,n,r,i){var a,s,l,u,c,h,p,d,f=1,g=1,m=-1,_=!0,y=!0,C=7===o.t?o:me;if(C==me||C.fn.expandRows()||(_=!1),C==me||C.fn.expandColumns()||(y=!1),C!=me&&C.fn.isBranch&&(e.arrayFormulaMode||e._isExpandArrayToMultiCall())){if(m=C.fn.findTestArgument(),a=[],s=!1,r)for(l=0;l<r.length;l++)a.push(r[l]),r[l]===m&&(s=!0);if(s||G.arr(n[m])||G.ref(n[m])){for(u=0;u<C.argCount();u++)u!=m&&t.ArrayHelper.indexOf(a,u)<0&&(G.arr(n[u])||G.ref(n[u]))&&a.push(u);r=a}}for(c=0;c<r.length;c++){var w=n[r[c]],v=G.arr(w)?w:null,S=G.ref(w)?w:null,x=0,R=0;if(v!=me)x=v.getRowCount(),R=v.getColumnCount();else if(S!=me){if(S.getRangeCount()>1)return me;x=_?S.getRowCount(0):1,R=y?S.getColumnCount(0):1}f=x>f?x:f,g=R>g?R:g}var b=[],T=0,A=r[T];for(h=0;h<n.length;h++){b[h]=[];var I=n[h];v=null,S=null,x=1,R=1;if(h===A){if(v=G.arr(I)?I:me,S=G.ref(I)?I:me,!(v==me&&S==me||(x=v!=me?v.getRowCount():_?S.getRowCount(0):1,R=v!=me?v.getColumnCount():y?S.getColumnCount(0):1,!(1!=x&&x!=f||1!=R&&R!=g)||-1!=m&&h!=m||e.arrayFormulaMode)))return me;A=++T<r.length?r[T]:-1}else if(i===_e&&(v=G.arr(I)?I:me,S=G.ref(I)?I:me,!(v==me&&S==me||(x=v!=me?v.getRowCount():_?S.getRowCount(0):1,R=v!=me?v.getColumnCount():y?S.getColumnCount(0):1,!(1!=x&&x!=f||1!=R&&R!=g)||-1!=m&&h!=m||e.arrayFormulaMode))))return me;if(S!=me){o.source||e.source;var D=S.getRow(0),F=S.getColumn(0);f=D+f-D,g=F+g-F}for(p=0;p<f;p++)for(b[h][p]=[],d=0;d<g;d++)b[h][p][d]=1!=x&&p>=x||1!=R&&d>=R?Ve:v!=me?v.getValue(1==x?0:p,1==R?0:d):S!=me?i==me||i[h]?S.getValue(0,1==x?0:p,1==R?0:d):S.create([new t.Range(S.getRow(0)+(1==x?0:p),S.getColumn(0)+(1==R?0:d),1,1)]):I}return b},e}(),o.Evaluator=ne}(t.Calc||(t.Calc={}));t.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){!function(o){var n,r;t.feature("calc.common",["core.stringResource","core.common","core.globalize"]);var i,a=null,s=void 0,l=(Math.min,Math.max,Math.abs,Math.pow,["v","n","s","b","d"]),u=(new Date,new o.CalcError("#NULL!",0),new o.CalcError("#DIV/0!",7),new o.CalcError("#VALUE!",15)),c=(new o.CalcError("#REF!",23),new o.CalcError("#NAME?",29),new o.CalcError("#N/A",42),new o.CalcError("#NUM!",36),function(e){function n(t){e.call(this,a),this._sheet=t}return __extends(n,e),n.prototype.startCalculation=function(){if(!this._valueCaches){var e=this.getRowCount(),t=this.getColumnCount();this._valueCaches={rowCount:e,colCount:t},this._changedCells=[]}},n.prototype.endCalculation=function(){this._valueCaches=a;var e=this._changedCells;e&&e.length>0&&this._sheet.triggerRangeChanged({sheet:this._sheet,sheetName:this._sheet.getName(),row:0,column:0,rowCount:this._sheet.getRowCount(),columnCount:this._sheet.getColumnCount(),changedCells:e,action:6}),this._changedCells=a},n.prototype.getValue=function(e,t,n){var r,i,c,h,p,d,f,g=this._sheet;return n=n===s?0:n,e<0||t<0?u:g._isValidatingCell&&g._validatingRow===e&&g._validatingColumn===t?g._validatingValue:(r=this._valueCaches,i=l[n],r?(c=r.rowCount,h=r.colCount,e>=c?a:t>=h?a:((p=r[e])||(p=r[e]={}),(d=p[t])||(d=p[t]={v:g.getValue(e,t)}),(f=d[i])===s&&(f=o.Convert.convertValue(d.v,n,!0),d[i]=f),f)):e>=this.getRowCount()?a:t>=this.getColumnCount()?a:this._sheet.getValue(e,t))},n.prototype.getReference=function(e,t,n,r){return-1===e&&-1===t?this.getSheetReference():-1===e?new o.SheetReference(this,[{row:0,rowCount:this.getRowCount(),col:t,colCount:r}]):-1===t?new o.SheetReference(this,[{row:e,rowCount:n,col:0,colCount:this.getColumnCount()}]):new o.SheetReference(this,[{row:e,rowCount:n,col:t,colCount:r}])},n.prototype.getSheetRangeReference=function(e,t,r,i,a){var s;if(this._sheet&&this._sheet.parent&&this._sheet.parent.sheets&&e instanceof n){var l,u=this._sheet.parent.sheets,c=!1,h=[];for(s=0;s<u.length;s++){if((l=u[s]._getSheetSource())===this)c=!0;else if(l===e){h.push(l.getReference(t,r,i,a));break}c&&h.push(l.getReference(t,r,i,a))}return new o._SheetRangeReference(h)}},n.prototype.getSources=function(e){var t;if(this._sheet&&this._sheet.parent&&this._sheet.parent.sheets&&e instanceof n){var o,r=this._sheet.parent.sheets,i=!1,a=[];for(t=0;t<r.length;t++){if((o=r[t]._getSheetSource())===this&&(i=!0),o===e){a.push(o);break}i&&a.push(o)}return a}},n.prototype.referenceToArray=function(e,t,n,r,i,c){var h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I=1,D=1,F=[],M=this._sheet,E=this._valueCaches,N=l[t];o.Convert.CalcConvertedError;if(0===(g=e.getRangeCount()))return F.isError=!0,[];if(E&&(m=E[C=e.getRangeCount()+"_"+e.getRow(0)+"_"+e.getColumn(0)+"_"+e.getRowCount(0)+"_"+e.getColumnCount(0)+"_"+t+"_"+n]))return(F=m.slice(0)).rowCount=m.rowCount,F.colCount=m.colCount,F.rangeCount=m.rangeCount,F;for(w=this.getRowCount(),v=this.getColumnCount(),n=n===s||n,S=0;S<g;S++){if(n||(_=[],F.push(_)),0===(I=e.getRowCount(S)))return F.isError=!0,[];if(0===(D=e.getColumnCount(S)))return F.isError=!0,[];if(d=e.getRow(S),f=e.getColumn(S),r&&(d+I>w||f+D>v))return(F=[a]).isError=!0,F;for(b=M._isValidatingCell,T=0;T<I;T++)for(h=d+T,n||(x=[],_.push(x)),E&&((y=E[h])||(y=E[h]={})),A=0;A<D;A++){if(p=f+A,b&&M._validatingRow===h&&M._validatingColumn===p)m=M._validatingValue,b=!1;else{if(E?(R=y[p])?m=R.v:(m=M.getValue(h,p),R=y[p]={v:m}):m=M.getValue(h,p),r&&o.Convert.err(m))return(F=[m]).isError=!0,F;if(R&&R[N]!==s)m=R[N];else if(m=o.Convert.convertValue(m,t,!0,c),R&&(R[N]=m),i&&R===m)return(F=[u]).isError=!0,F}m===a&&c||(n?F.push(m):x.push(m))}}return n||1!==g||(F=F[0]),F.rowCount=I,F.colCount=D,F.rangeCount=g,E&&(E[C]=F.slice(0),E[C].rowCount=I,E[C].colCount=D,E[C].rangeCount=g),F},n.prototype.getColumnCount=function(){return this._sheet.getColumnCount()},n.prototype.getRowCount=function(){return this._sheet.getRowCount()},n.prototype.isHiddenRow=function(e,t){var o=this._sheet;return!(!o.hasRowFilterOut()&&t)&&0===o.getRowHeight(e)},n.prototype.getName=function(){return this._sheet.getName()},n.prototype.setValue=function(e,o,n){var r,i,a,s,l,u,c,h,p=this._sheet,d=this._valueCaches;if(d&&((r=d[e])&&((i=r[o])&&(i.v=n,void 0!==i.b&&(i.b=void 0),void 0!==i.d&&(i.d=void 0),void 0!==i.n&&(i.n=void 0),void 0!==i.s&&(i.s=void 0)))),a=p._getModel()){var f=p.getValue(e,o),g=!1,m=p._tableManager,_=m&&m.find(e,o);_&&(s=_.showHeader()&&e===_.headerIndex(),l=_.showFooter()&&e===_.footerIndex(),s||l||(g=_._setValue(e,o,n))),u=p._bindingManager,!g&&u&&u._dataSource&&((c=u.getValue(e,o)).hasBinding&&(h=t.GC$.extend({},p.getDataItem(e)),a._updateDirty(e,o,{originalItem:h,oldValue:u.getValue(e,o).value}),u.setValue(e,o,n)),g=c.hasBinding),(!g||p.checkingChanges)&&a.setValue(e,o,n),this._changedCells?this._changedCells.push({row:e,column:o}):this._sheet.triggerCellChanged({sheet:this._sheet,sheetName:this._sheet.getName(),row:e,col:o,sheetArea:3,propertyName:"value",oldValue:f,newValue:n})}},n.prototype.getCustomFunction=function(e){return this._sheet?this._sheet._findCustomFunction(e):a},n.prototype.getCustomName=function(e){var t=this._sheet?this._sheet.getCustomName(e):a;return t?t.getExpression():a},n.prototype.getSheet=function(){return this._sheet},n.prototype.getParserContext=function(e,t,o,n){return new r(this._sheet,e,t,o,n)},n.prototype.setFormula=function(e,t,o){},n.prototype.setArrayFormula=function(e,t,o,n,r){},n.prototype.setFormulaByName=function(e,t){},n.prototype.refresh=function(){this._sheet.repaint()},n.prototype.toJSON=function(e,o){var n,r,i,a,s,l,u,c,h,p,d=o,f=e.data||{};for(l in d){for(c in u=parseInt(l,10),n=f.dataTable||{},r=d[l],a=n[l]||{},r)h=parseInt(c,10),(i=r[c])&&i.expr&&(s=a[c]||{},p=this.getCalcService().unparseWithoutCulture(this,i.expr,u,h,!0),i.arrayInfo?i.arrayInfo.row===u&&i.arrayInfo.col===h&&(s.arrayInfo=i.arrayInfo,s.formula=p):s.formula=p,t.GC$.isEmptyObject(s)||(a[c]=s));t.GC$.isEmptyObject(a)||(n[l]=a),t.GC$.isEmptyObject(n)||(f.dataTable=n)}t.GC$.isEmptyObject(f)||(e.data=f)},n}(o.CalcSource));o.SheetSource=c,n=function(e){function t(t){e.call(this,a),this._spread=t}return __extends(t,e),t.prototype.getCustomFunction=function(e){return this._spread?this._spread.getCustomFunction(e):a},t.prototype.getCustomName=function(e){var t=this._spread?this._spread.getCustomName(e):a;return t?t.getExpression():a},t}(o.CalcSource),o.SpreadSource=n,r=function(e){function t(t,o,n,r,i){e.call(this,t._getSheetSource(),o,n,r,i),this._sheet=t}return __extends(t,e),t.prototype.getExternalSource=function(t,n){var r,i,s,l=this._sheet.parent;if(t&&(!l||l.name!==t))return a;if(!l)return o.compareStringIgnoreCase(this._sheet._name,n)?this._sheet._getSheetSource():a;if((r=l.sheets)&&r.length>0)for(i=0;i<r.length;i++)if(s=r[i],o.compareStringIgnoreCase(s._name,n))return s._getSheetSource();return e.prototype.getExternalSource.call(this,t,n)},t.prototype.getExternalSourceToken=function(e){return e.getName()},t.prototype.getTableByName=function(e){return this._sheet.findTableByName(e)},t.prototype.getTableByIndex=function(e,t){return this._sheet.findTable(e,t)},t.prototype.setSource=function(e){this.source=e,e&&e.getSheet&&(this._sheet=e.getSheet())},t}(o.ParserContext),o.SheetParserContext=r,o.evaluateFormula=function(t,n,i,a,l){var u,c,h=t&&t instanceof e.Sheets.Sheet&&t,p=new o.Parser;return u=new r(h,!!l,i=i===s?0:i,a=a===s?0:a),c=p.parse(n,u),o.evaluateExpression(t,c,i,a)},o.evaluateExpression=function(e,t,o,n){var r,i=e.getCalcService();return o===s&&(o=e.getActiveRowIndex()),n===s&&(n=e.getActiveColumnIndex()),r=e._getSheetSource(),i.evaluateParsedFormula(r,t,o,n,!1,!0)},o.rangeToExpression=function(e,t,n,r,i){var a,l,u,c,h,p=e.row,d=e.col,f=e.row+e.rowCount-1,g=e.col+e.colCount-1,m=!1,_=!1,y=!1,C=!1;return arguments.length>=4&&(p-=(m=0!=(1&r))?t:0,f-=(_=0!=(4&r))?t:0,d-=(y=0!=(2&r))?n:0,g-=(C=0!=(8&r))?n:0),i&&(l=function(e,t,o){if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return 2;if(t.hasTotalsRow()&&e.row===t.endRow())return 8;if(o===e.row)return 1}else{if(t.hasHeadersRow()&&e.row===t.startRow()){if(e.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1)return 14}if(e.row===t.dataRange().row){if(e.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1)return 12}}return s}(e,i,t),h=i,u=(c=e).col===h.startColumn()&&c.colCount===h.dataRange().colCount?1:1===c.colCount?2:c.col>=h.startColumn()&&c.col+c.colCount-1<=h.endColumn()?4:s,l&&u)?o.Expressions.StructReferenceExpression.create(i,l,u,e.col-i.dataRange().col,e.col+e.colCount-i.dataRange().col-1):(e.row<0&&e.col<0?a=new o.Expressions.RangeExpression:e.row<0?(a=new o.Expressions.RangeExpression).initBand(d,g,y,C,!1):e.col<0?(a=new o.Expressions.RangeExpression).initBand(p,f,m,_,!0):a=1===e.rowCount&&1===e.colCount?new o.Expressions.CellExpression(p,d,m,y):new o.Expressions.RangeExpression(p,d,f,g,m,y,_,C),a)},o.rangeToFormula=function(e,t,n,r,i){var s=o.rangeToExpression(e,t,n,r),l=new o.ParserContext(a,!!i,t,n);return(new o.Parser).unparse(s,l)},o.rangeToFormulaWithStructReference=function(e,t,n,r,i,a,s){var l=o.rangeToExpression(t,n,r,i,s),u=new o.SheetParserContext(e,!!a,n,r);return(new o.Parser).unparse(l,u)},o.formulaToRange=function(e,o,n,r){var i,a,s,l;if(!o)return null;if(n=n||0,r=r||0,i=e.getCalcService().parse(e._getSheetSource(),o,n,r))if((a=i.source)&&17===i.t)a=i.source();else if(16===i.t){var u=i.startSource,c=i.endSource,h=u.getSources(c),p=!1;for(s=0;s<h.length;s++)if(h[s]===e._getSheetSource()){p=!0;break}i=p&&i}return!i||!i.getRange||a&&a!==e._getSheetSource()?null:(l=i.getRange(n,r))?new t.Range(l.row,l.column,l.rowCount,l.columnCount):null},o.rangesToFormula=function(e,t,n,r,i){var s,l,u,c="",h=new o.Parser,p=new o.ParserContext(a,!!i,t,n);for(e.length>1&&(c="("),s=0;s<e.length;s++)l=o.rangeToExpression(e[s],t,n,r),u=h.unparse(l,p),s>0?c+=", "+u:c=u;return e.length>1&&(c+=")"),c},(i=o.RangeReferenceRelative||(o.RangeReferenceRelative={}))[i.allAbsolute=0]="allAbsolute",i[i.startRowRelative=1]="startRowRelative",i[i.startColRelative=2]="startColRelative",i[i.endRowRelative=4]="endRowRelative",i[i.endColRelative=8]="endColRelative",i[i.rowRelative=5]="rowRelative",i[i.colRelative=10]="colRelative",i[i.allRelative=15]="allRelative",o.RangeReferenceRelative}(t.Calc||(t.Calc={}));t.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){!function(o){!function(n){function r(e,o,n){var r,i;if(e===te||e===ee)throw t.SR.Exp_InvalidFunctionName;if(e=e.toUpperCase(),Ee._builtInFunctions.hasOwnProperty(e))if(r=Ee._builtInFunctions[e]){if(!n||!n.override)throw t.SR.Exp_OverrideNotAllowed}else Ee._builtInFunctions[e]=new Ee.Function(e,0,255),r=Ee[e.toUpperCase()];else r=new Ee.Function(e,0,255),Ee._builtInFunctions[e]=r;if(o&&"function"==typeof o&&(r.evaluate=o),n)for(i in n)n.hasOwnProperty(i)&&"override"!==i&&(r[i]=n[i]);return r}function i(e){return!0}function a(e){return 0!==e}function s(e){return 1===e}function l(e){return 2===e}function u(e){return 0===e||2===e}function c(e){return 0===e||e%2==1}function h(e){return 3===e}function p(){return!0}function d(e){return 1===e||2===e}function f(){return!0}function g(e){return 0===e}function m(e,n,r){var i,a,s,l,u;if(oe.err(e))return r.value=e,!1;if(oe.ref(e)){for(i=0;i<e.getRangeCount();i++)for(a=0;a<e.getRowCount(i);a++)for(s=0;s<e.getColumnCount(i);s++)if(e instanceof o._SheetRangeReference){for(l=0;l<e.getSheetCount();l++)if((r.includeSubtotal||!e.isSubtotal(l,i,a,s))&&!1===n(e.getValue(l,i,a,s),r))return!1}else if((r.includeSubtotal||!e.isSubtotal(i,a,s))&&!1===n(e.getValue(i,a,s),r))return!1}else if(oe.arr(e)){for(u=0;u<e.length();u++)if(!1===n(e.getValueByIndex(u),r))return!1}else if(t.GC$.isArray(e))t.GC$.each(e,function(e,t){return n(t,r)});else if(!1===n(e,r))return!1;return!0}function _(){return 0}function y(e){return e>0}function C(e){return 1===e||2===e||3===e}function w(e){return 0===e}function v(e){return 0===e||1===e||2===e}function S(e){return 3!==e}function x(e){return 2===e||3===e}function R(e,t){for(;0!==t;){var o=e%t;e=t,t=o}return e}function b(e,t,o){for(var n,r,i,a,s,l,u,c,h,p=1,d=0,f=0;f<e.length;f++)for(n=oe.toArr(e[f],1,!1,!1,!1,!0),r=0;r<n.rangeCount;r++)for(i=n.rangeCount>1?n[r]:n,n.isReference&&(a=e[f].getRow(r),s=e[f].getColumn(r)),l=0;l<i.length;l++)if(t||!n.isReference||!e[f].isHiddenRow(r,l,o))for(u=i[l],c=0;c<u.length;c++)!t&&n.isReference&&e[f].isSubtotal(r,l+a,c+s)||(h=u[c])!==oe.CalcConvertedError&&(p*=oe.D(h),d++);return oe.toResult(d>0?p:0)}function T(e){var t=oe.D(e[0]);if(isNaN(t))return Ae;var o=oe.I(e[1]),n=Ee._MathHelper,r=n.pow10(ne(o));return o<0?t/=r:t*=r,t=t<0?n.approxCeiling(t-.5):n.approxFloor(t+.5),o<0?t*=r:t/=r,oe.toResult(t)}function A(e){var t,n=oe.D(e[0]);if(o._Helper._argumentExists(e,1)){if(t=oe.D(e[1]),isNaN(t))return Ae}else t=1;return 0==n||0==t?0:Ee._MathHelper.approxCeiling(n/ne(t))*ne(t)}function I(e,t,o){var n,r,i,a,s=0;if(e===te||e===ee)return s;var l=Ee._MathHelper.parseCriteria(e),u=oe.arr(t),c=oe.arr(o),h=t,p=t,d=o,f=o;if((u?1:p.getRangeCount())!=(c?1:f.getRangeCount())||(u?h.getRowCount():p.getRowCount(0))>(c?d.getRowCount():f.getRowCount(0))||(u?h.getColumnCount():p.getColumnCount(0))>(c?d.getColumnCount():f.getColumnCount(0)))return Ae;if((n=t.toArray(0,!0,!0)).isError)return n[0];if((r=o.toArray(1,!0,!0)).isError)return r[0];for(i=0;i<n.length;i++)a=n[i],l&&l(a)&&(s+=r[i]);return oe.toResult(s)}function D(e){for(var t=1,o=e;o>1;o--)t*=o;return t}function F(e){try{return!oe.B(e)}catch(e){return Ae}}function M(e,t,o){try{return oe.B(e)?t:o}catch(e){return Ae}}function E(e,t){return oe.err(e)?t!==te&&t!==ee?t:0:e!==te&&e!==ee?e:0}function N(e){return e%400==0||e%4==0&&e%100!=0||1900===e}function O(t){var o=oe.S(t[0]);if(o===te||o===ee||""===o)return Ae;try{var n=function(t){try{return e.Sheets._DateTimeHelper.parseLocale(t)}catch(e){return Ae}}(o),r=60*(60*n.getHours()+n.getMinutes())+n.getSeconds();return r/86400}catch(e){return Ae}}function P(e,t){var o,n=function(e){for(var t=e.getFullYear(),o=e.getMonth(),n=e.getDate(),r=0,i=0;i<o;i++)switch(i){case 0:case 2:case 4:case 6:case 7:case 9:case 11:r+=31;break;case 1:r+=N(t)?29:28;break;case 3:case 5:case 8:case 10:r+=30}return r+n}(e),r=new Date(e.getFullYear(),0,1).getDay();return 2===t&&((r-=1)<0&&(r=6)),(o=n-1-(6-r))<0&&(o=0),1+oe.I(o/7)+(o%7!=0?1:0)}function L(e){var t,n,r;try{t=oe.DT(e[0])}catch(e){return Ae}if(isNaN(n=oe.I(o._Helper._argumentExists(e,1)?e[1]:1)))return Ae;switch(n){case 1:r=t.getDay()+1;break;case 2:r=0===t.getDay()?7:t.getDay();break;case 3:r=0===t.getDay()?6:t.getDay()-1;break;default:return Me}return r}function H(e,t){return e-t}function k(e){var t=o._Helper,n=oe.DT(e[0]),r=oe.DT(e[1]),i=!!t._argumentExists(e,2)&&oe.B(e[2]),a=n.getDate(),s=r.getDate(),l=n.getMonth(),u=r.getMonth(),c=n.getFullYear(),h=r.getFullYear();return i?(s=31===s?30:s,a=31===a?30:a):(a=31===a?30:a,31===s&&(a<30?(s=1,++u>12&&(u=1,h++)):s=30)),30*(12*(h-c)+(u-l))+(s-a)}function V(e,n,r,i,a){var s,l,u,c,h,p,d,f,g,m=o._Helper;if(a){if(l=B(m._argumentExists(e,2)?e[2]:"0000011"),oe.err(l))return l;m._argumentExists(e,3)&&(s=oe.toArr(e[3],4,!0,!0,!1))}else m._argumentExists(e,2)&&(s=oe.toArr(e[2],4,!0,!0,!1));if(!s)return i;if(s.isError)return s[0];for(u=s.length,c=[],h=0;h<u;h++)p=s[h],d=t._DateTimeHelper._fromOADate(p),-1===c.indexOf(p)&&(f=d,!((g=l)&&g.length&&g.length>0?g[L([f,3])]:6===f.getDay()||0===f.getDay()))&&p>=n&&p<=r&&c.push(p);return i-c.length}function B(e){var t,o;if(typeof e===ve){if(7!==e.length||isNaN(parseInt(e)))return Ae}else if(!isNaN(e)){if(se(e)<1||se(e)>17)return Me;e=e.toString()}switch(t=[0,0,0,0,0,0,0],e.length){case 1:switch(e){case"1":t[5]=1,t[6]=1;break;case"2":t[6]=1,t[0]=1;break;case"3":t[0]=1,t[1]=1;break;case"4":t[1]=1,t[2]=1;break;case"5":t[2]=1,t[3]=1;break;case"6":t[3]=1,t[4]=1;break;case"7":t[4]=1,t[5]=1;break;default:return Me}break;case 2:if("1"!==e[0])return Me;switch(e[1]){case"1":t[6]=1;break;case"2":t[0]=1;break;case"3":t[1]=1;break;case"4":t[2]=1;break;case"5":t[3]=1;break;case"6":t[4]=1;break;case"7":t[5]=1;break;default:return Me}break;case 7:for(o=0;o<7;o++)t[o]=parseInt(e[o]);break;default:return Ae}return t}function z(t){var n,r,i,a,s,l,u,c,h,p,d,f,g,m,_=o._Helper,y=oe.DT(t[0]),C=oe.DT(t[1]),w=_._argumentExists(t,2)?oe.I(t[2]):0;return w<0||w>4?Me:(n=y,r=C,i=w,g=o.Functions._FinancialHelper,(m=g.__days_between_basis(n,r,i))<0&&(m=-m,s=n,n=r,r=s),1===i?(l=n.getFullYear(),u=r.getFullYear(),(c=n).setFullYear(c.getFullYear()+1),H(r,c)>0?(d=u+1-l,c=new Date(l,0,1),h=new Date(u+1,0,1),f=e.Sheets._DateTimeHelper,p=oe.I(new f(h).toOADate()-new f(c).toOADate())-365*(u+1-l)):(d=1,p=N(l)&&n.getMonth()<3||N(u)&&256*r.getMonth()+r.getDate()>=541?1:0),a=365+oe.D(p)/oe.D(d)):a=g.__annual_year_basis(new Date,i),m/a)}function G(e){return" "===e||"\t"===e||"\n"===e}function W(e){var t,o,n,r=e.toString(),i="";if(e<0&&(r=r.substr(1),i="-"),(t=r.split(".")).length<1||t.length>2)return Ae;for(o=[],2===t.length&&(o.push(t[1]),o.push(".")),n=(r=t[0]).length-3;n>=0;n-=3)o.push(r.substr(n,3)),n>0&&o.push(",");return o.push(r.substring(0,n+3)),o.reverse(),i+o.join("")}function j(e,t){if(oe.err(e))t.value=!0;else if(typeof e===ve){var n=o.CalcError._parseCore(e);t.value=n!==te&&n!==ee}t.value=!1}function U(e,t){if(oe.err(e)&&e._code!==Fe._code)t.value=!0;else if(typeof e===ve){var n=o.CalcError._parseCore(e);t.value=n!==te&&n!==ee&&n!==Fe}t.value=!1}function Y(e){if(e===te||e===ee)throw t.SR.Exp_InvalidArgument;if(e.length<1||e.length>1)throw t.SR.Exp_InvalidArgument}function X(e){return $.__stdevIncludeSubtotals(e,!0,!0)}function K(e){var t,n,r,i,a,s,l;o.Convert;if(isNaN(t=oe.D(e[1])))return Ae;if((n=oe.toArr(e[0],1,!0,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return Ae;for(r=[],i=0;i<n.length;i++)(a=n[i])!==oe.CalcConvertedError&&r.push(a);return r.sort(function(e,t){return e-t}),0===r.length?Me:t<0||1<t?Me:(l=(s=t*(r.length-1))%1,s=parseInt(s.toString(),10),0===l?r[s]:oe.D(r[s])+l*(oe.D(r[s+1])-oe.D(r[s])))}var J,Z,q,$,Q;t.feature("calc.functions",["calc.common"]);var ee=null,te=void 0,oe=o.Convert,ne=Math.abs,re=Math.sqrt,ie=Math.max,ae=Math.min,se=Math.floor,le=Math.ceil,ue=Math.sin,ce=Math.asin,he=Math.cos,pe=Math.acos,de=Math.tan,fe=Math.atan,ge=Math.atan2,me=Math.exp,_e=Math.log,ye=Math.PI,Ce=Math.random,we=Math.pow,ve="string",Se="boolean",xe="number",Re=o.Errors,be=Re.Null,Te=Re.DivideByZero,Ae=Re.Value,Ie=Re.Reference,De=Re.Name,Fe=Re.NotAvailable,Me=Re.Number,Ee=o.Functions;Ee._builtInFunctions=Ee._builtInFunctions||{},n._defineBuildInFunction=r,n.def=r,J=function(){function e(){}return e.days360=k,e.yearfrac=z,e}(),n._DateHelper=J,n.acceptsAny=i,n.acceptsNone=function(){return!1},n.acceptsNotZero=a,n.acceptsOne=s,n.acceptsTwo=l,n.acceptsZeroTwo=u,n.acceptsZeroOdd=c,n.acceptsThree=h,n.isVolatile=p,n.acceptsOneTwo=d,n.isBranch=f,n.acceptsZero=g,n.findTestArgument=_,n.acceptAboveZero=y,n.acceptsSecond=function(e){return 1===e},n.acceptsSecondOrThirdOrFourth=C,n.acceptsThird=function(e){return 2===e},n.acceptsFirstOrThird=function(e){return 0===e||2===e},n.acceptsFirstOrOne=function(e){return 0===e||1===e},n.acceptsFirstOrOdd=function(e){return 0===e||e%2==1},n.acceptsFirst=w,n.acceptsFirstOrSecondOrThird=v,n.acceptsEven=function(e){return e%2==0},n.acceptsFourth=function(e){return 3===e},n.acceptsNotFourth=S,n.acceptsFourthOrFifth=function(e){return 3===e||4===e},n.acceptsNotSecond=function(e){return 1!==e},n.acceptsThreeFour=function(e){return 3===e||4===e},n.acceptsTwoThree=x,n.acceptsPositive=function(e){return e>0},n.acceptsFour=function(e){return 4===e},n.acceptsFourFive=function(e){return 4===e||5===e},n.acceptsFive=function(e){return 5===e},n.acceptsSix=function(e){return 6===e},n.acceptsEight=function(e){return 8===e},n.acceptsSeven=function(e){return 7===e},n.acceptsNotTwo=function(e){return 2!==e},n.acceptsFiveSix=function(e){return 5===e||6===e},n.acceptsFourSixSeven=function(e){return 4===e||6===e||7===e},n.acceptsThreeFourFive=function(e){return 3===e||4===e||5===e},n.acceptsMoreThanOne=function(e){return e>=1},n.acceptsTwoThreeFour=function(e){return 2===e||3===e||4===e},n.acceptsOneTwoThree=function(e){return 1===e||2===e||3===e},Z=function(){return function(e,t){this.Key=e,this.Value=t}}(),q=function(){function t(){}return t.__isLeapYear=function(e){return e%400==0||e%4==0&&e%100!=0||1900===e},t.__compareDateTime=function(e,t){return e-t},t.__toOADate=function(t){return new e.Sheets._DateTimeHelper(t).toOADate()},t.__annual_year_basis=function(e,o){switch(o){case 0:return 360;case 1:return t.__isLeapYear(e.getFullYear())?366:365;case 2:return 360;case 3:return 365;case 4:return 360;default:return-1}},t.__getDaysInMonth=function(e,o){switch(o){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 1:return t.__isLeapYear(e)?29:28;case 3:case 5:case 8:case 10:return 30}},t.__Days_Between_BASIS_30E_360=function(e,t){var o,n,r,i,a,s;return o=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=t.getFullYear(),a=t.getMonth(),31===r&&(r=30),31===(s=t.getDate())&&(s=30),360*(i-o)+30*(a-n)+(s-r)},t.__Days_Between_BASIS_30Ep_360=function(e,t){var o,n,r,i,a,s;return o=e.getFullYear(),n=e.getMonth(),r=e.getDate(),i=t.getFullYear(),a=t.getMonth(),31===r&&(r=30),31===(s=t.getDate())&&(s=1,a++),360*(i-o)+30*(a-n)+(s-r)},t.__Days_Between_BASIS_MSRB_30_360_SYM=function(e,o){var n,r,i,a,s,l;return n=e.getFullYear(),r=e.getMonth(),i=e.getDate(),a=o.getFullYear(),s=o.getMonth(),l=o.getDate(),2===r&&t.__getDaysInMonth(n,r)===i&&(i=30),2===s&&t.__getDaysInMonth(a,s)===l&&(l=30),31===l&&i>=30&&(l=30),31===i&&(i=30),360*(a-n)+30*(s-r)+(l-i)},t.__Days_Between_BASIS_MSRB_30_360=function(e,o){var n,r,i,a,s,l;return n=e.getFullYear(),r=e.getMonth(),i=e.getDate(),a=o.getFullYear(),s=o.getMonth(),l=o.getDate(),2===r&&t.__getDaysInMonth(n,r)===i&&2===s&&t.__getDaysInMonth(a,s)===l&&(i=30,l=30),31===l&&i>=30&&(l=30),31===i&&(i=30),360*(a-n)+30*(s-r)+(l-i)},t.__days_between_basis=function(e,o,n){var r,i=1;switch(t.__compareDateTime(e,o)>0&&(r=e,e=o,o=r,i=-1),n){case 1:case 2:case 3:return i*oe.I(t.__toOADate(o)-t.__toOADate(e));case 4:return i*t.__Days_Between_BASIS_30E_360(e,o);case 5:return i*t.__Days_Between_BASIS_30Ep_360(e,o);case 6:return i*t.__Days_Between_BASIS_MSRB_30_360_SYM(e,o);default:return i*t.__Days_Between_BASIS_MSRB_30_360(e,o)}},t}(),n._FinancialHelper=q,$=function(){function e(){}return e.__dev1=function(e,t,o,n){for(var r,i,a,s,l,u,c,h,p,d=0;d<e.length;d++)for(r=oe.toArr(e[d],1,!1,!1,!1,!0),i=0;i<r.rangeCount;i++)for(a=r.rangeCount>1?r[i]:r,r.isReference&&(s=e[d].getRow(i),l=e[d].getColumn(i)),u=0;u<a.length;u++)if(o||!r.isReference||!e[d].isHiddenRow(i,u,n))for(c=a[u],h=0;h<c.length;h++)!o&&r.isReference&&e[d].isSubtotal(i,u+s,h+l)||(p=c[h])!==oe.CalcConvertedError&&(t.sumx+=p,t.sumx2+=p*p,t.n++)},e.st_normsdist=function(e){var t,o,n,r;return isNaN(t=oe.D(e[0]))?Ae:(6,0===t?n=0:(o=.5*ne(t))>=3?n=1:o<1?n=((((((((.000124818987*(r=o*o)-.001075204047)*r+.005198775019)*r-.019198292004)*r+.059054035642)*r-.151968751364)*r+.319152932694)*r-.5319230073)*r+.797884560593)*o*2:n=(((((((((((((-45255659e-12*(o-=2)+.00015252929)*o-19538132e-12)*o-.000676904986)*o+.001390604284)*o-.00079462082)*o-.002034254874)*o+.006549791214)*o-.010557625006)*o+.011630447319)*o-.009279453341)*o+.005353579108)*o-.002141268741)*o+.000535310849)*o+.999936657524,t>0?.5*(n+1):.5*(1-n))},e.__averageIncludeSubtotals=function(e,t,o){for(var n,r,i,a,s,l,u,c,h,p=0,d=0,f=(d=0,0);f<e.length;f++)for(n=oe.toArr(e[f],1,!1,!1,!1,!0),r=0;r<n.rangeCount;r++)for(i=n.rangeCount>1?n[r]:n,n.isReference&&(a=e[f].getRow(r),s=e[f].getColumn(r)),l=0;l<i.length;l++)if(t||!n.isReference||!e[f].isHiddenRow(r,l,o))for(u=i[l],c=0;c<u.length;c++)!t&&n.isReference&&e[f].isSubtotal(r,l+a,c+s)||(h=u[c])!==oe.CalcConvertedError&&(p+=h,d++);return 0===d?Te:oe.toResult(p/d)},e.__countIncludeSubtotals=function(e,t,o){for(var n,r,i,a,s,l,u,c,h,p=0,d=0;d<e.length;d++)for(n=oe.toArr(e[d],0,!1,!1,!1,!0),r=0;r<n.rangeCount;r++)for(i=n.rangeCount>1?n[r]:n,n.isReference&&(a=e[d].getRow(r),s=e[d].getColumn(r)),l=0;l<i.length;l++)if(t||!n.isReference||!e[d].isHiddenRow(r,l,o))for(u=i[l],c=0;c<u.length;c++)!t&&n.isReference&&e[d].isSubtotal(r,l+a,c+s)||null!==(h=u[c])&&""!==h&&h!==oe.CalcConvertedError&&oe.num(h)&&p++;return p},e.__countaIncludeSubtotals=function(e,t,o){for(var n,r,i,a,s,l,u,c,h,p=0,d=0;d<e.length;d++)for(n=oe.toArr(e[d],0,!1,!1,!1),r=0;r<n.rangeCount;r++)for(i=n.rangeCount>1?n[r]:n,n.isReference&&(a=e[d].getRow(r),s=e[d].getColumn(r)),l=0;l<i.length;l++)if(t||!n.isReference||!e[d].isHiddenRow(r,l,o))for(u=i[l],c=0;c<u.length;c++)!t&&n.isReference&&e[d].isSubtotal(r,l+a,c+s)||(h=u[c])!==ee&&h!==te&&p++;return p},e.__maxIncludeSubtotals=function(e,t,o){for(var n,r,i,a,s,l,u,c,h,p=!1,d=0,f=0;f<e.length;f++){if((n=oe.toArr(e[f],1,!1,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return Ae;for(r=0;r<n.rangeCount;r++)for(i=n.rangeCount>1?n[r]:n,n.isReference&&(a=e[f].getRow(r),s=e[f].getColumn(r)),l=0;l<i.length;l++)if(t||!n.isReference||!e[f].isHiddenRow(r,l,o))for(u=i[l],c=0;c<u.length;c++)!t&&n.isReference&&e[f].isSubtotal(r,l+a,c+s)||(h=u[c])!==oe.CalcConvertedError&&((!p||h>d)&&(d=h),p=!0)}return d},e.__minIncludeSubtotals=function(e,t,o){for(var n,r,i,a,s,l,u,c,h,p=!1,d=0,f=0;f<e.length;f++){if((n=oe.toArr(e[f],1,!1,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return Ae;for(r=0;r<n.rangeCount;r++)for(i=n.rangeCount>1?n[r]:n,n.isReference&&(a=e[f].getRow(r),s=e[f].getColumn(r)),l=0;l<i.length;l++)if(t||!n.isReference||!e[f].isHiddenRow(r,l,o))for(u=i[l],c=0;c<u.length;c++)!t&&n.isReference&&e[f].isSubtotal(r,l+a,c+s)||(h=u[c])!==oe.CalcConvertedError&&((!p||h<d)&&(d=h),p=!0)}return d},e.__sumIncludeSubtotals=function(e,t,o){for(var n,r,i,a,s,l,u,c,h,p=0,d=0;d<e.length;d++){if((n=oe.toArr(e[d],1,!1,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return Ae;for(r=0;r<n.rangeCount;r++)for(i=n.rangeCount>1?n[r]:n,n.isReference&&(a=e[d].getRow(r),s=e[d].getColumn(r)),l=0;l<i.length;l++)if(t||!n.isReference||!e[d].isHiddenRow(r,l,o))for(u=i[l],c=0;c<u.length;c++)!t&&n.isReference&&e[d].isSubtotal(r,l+a,c+s)||(h=u[c])!==oe.CalcConvertedError&&(p+=h)}return p},e.__stdevIncludeSubtotals=function(t,o,n){var r={sumx:0,sumx2:0,n:0},i=e.__dev1(t,r,o,n);return oe.err(i)?i:r.n<=1?Te:oe.toResult(re(ie(0,(r.n*r.sumx2-r.sumx*r.sumx)/(r.n*(r.n-1)))))},e.__stdevpIncludeSubtotals=function(t,o,n){var r={sumx:0,sumx2:0,n:0},i=e.__dev1(t,r,o,n);return oe.err(i)?i:r.n<=0?Te:oe.toResult(re(ie(0,(r.n*r.sumx2-r.sumx*r.sumx)/(r.n*r.n))))},e.__varrIncludeSubtotals=function(t,o,n){var r={sumx:0,sumx2:0,n:0},i=e.__dev1(t,r,o,n);return oe.err(i)?i:r.n<=1?Te:oe.toResult(ie(0,(r.n*r.sumx2-r.sumx*r.sumx)/(r.n*(r.n-1))))},e.__varpIncludeSubtotals=function(t,o,n){var r={sumx:0,sumx2:0,n:0},i=e.__dev1(t,r,o,n);return oe.err(i)?i:r.n<=0?Te:oe.toResult(ie(0,(r.n*r.sumx2-r.sumx*r.sumx)/(r.n*r.n)))},e.st_percentile=K,e}(),n._StatHelper=$,Q=function(){function e(){}return e.log=function(e,t){return isNaN(e)?e:isNaN(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?_e(e)/_e(t):NaN},e.log10=function(t){return e.log(t,10)},e}(),n._MathHelper=function(){function e(e){var t=se(e);return Ee._MathHelper.approxEqual(e,t+1)?t+1:t}function o(e){var t=le(e);return Ee._MathHelper.approxEqual(e,t-1)?t-1:t}function n(e){var t,o=((t=[])[0]=1,t[1]=10,t[2]=100,t[3]=1e3,t[4]=1e4,t[5]=1e5,t[6]=1e6,t[7]=1e7,t[8]=1e8,t[9]=1e9,t[10]=1e10,t[11]=1e11,t[12]=1e12,t[13]=1e13,t[14]=1e14,t[15]=1e15,t[16]=1e16,t)[e];return o!==te&&o!==ee?o:we(10,parseFloat(e))}function r(e,o){var n,r,i,a,s,l,u,c;switch(e){case 0:n=function(e,t){return e<=t},i=function(e,t){return e<=t};break;case 1:n=function(e,t){return e>=t},i=function(e,t){return e>=t};break;case 2:n=function(e,t){return e!==t},i=function(e,t){return e!==t};break;case 3:n=function(e,t){return e<t},i=function(e,t){return e<t};break;case 4:n=function(e,t){return e===t},i=function(e,t){return e===t},(a=t.RegUtil.getWildcardCriteriaFullMatch(o))&&(s=t.RegUtil.getRegIgnoreCase(a),r=function(e){return s.lastIndex=0,s.test(e)});break;case 5:n=function(e,t){return e>t},i=function(e,t){return e>t};break;default:return function(e){return!1}}l=-1,u=!0;try{c={value:0},o===te||o===ee?l=0:oe.rD(o.toString(),c)?l=c.value:u=!1}catch(e){u=!1}return function(e){var t;if((e===te||e===ee)&&(e=""),u){-1;try{if(t={value:0},oe.rD(e,t))return i(t.value,l)}catch(e){}}return a&&r?r(e.toString()):n(e.toString().toUpperCase(),o!==te&&o!==ee?o.toString().toUpperCase():"")}}function i(e){return _e(1+e)-(1+e-1-e)/(1+e)}return{approxFloor:e,approxCeiling:o,approxEqual:function(e,t){return e===t||ne(e-t)<ne(e)/281474976710656},pow10:n,parseCriteria:function(e){var t,o;if(oe.num(e))return r(4,e);var n=e!==te&&e!==ee?e.toString().toUpperCase():"",i="\0";for(t=0;t<2&&t<n.length;t++)if(o=n[t],-1!=="=><".indexOf(o))if("="===o)switch(i){case"<":return r(0,n.substring(2));case">":return r(1,n.substring(2));default:return r(4,"\0"===i?n.substring(1):e)}else{if("\0"===i){i=o;continue}if("<"===i)return">"===o?r(2,n.substring(2)):r(3,n.substring(1));if(">"===i)return r(5,n.substring(1))}else switch(i){case"<":return r(3,n.substring(1));case">":return r(5,n.substring(1))}return r(4,e)},round:function(t,r){if(isNaN(t))return Ae;var i=n(ne(r));return r<0?t/=i:t*=i,t=t<0?o(t-.5):e(t+.5),r<0?t*=i:t/=i,oe.toResult(t)},combin:function(e,t){var o,n;if(isNaN(e)||isNaN(t))return Ae;if(e<0||t<0||e<t)return Me;for(o=1,t=ae(e-t,t),n=1;n<=t;n++)o*=e-n+1,o/=n;return oe.toResult(o)},log10:Q.log10,log:Q.log,pow1p:function(e,t){var o;return o=ne(e)>.5?we(1+e,t):me(t*i(e)),isFinite(o)?isNaN(o)&&(o=5e-324):o===Number.POSITIVE_INFINITY?o=1.79769e308:o===Number.NEGATIVE_INFINITY&&(o=-1.79769e308),o},log1p:i,cosh:function(e){return(me(e)+me(-e))/2},sinh:function(e){return(me(e)-me(-e))/2}}}(),n.def("ABS",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult(ne(t))},{minArgs:1,maxArgs:1}),n.def("ACOS",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:t<-1||1<t?Me:oe.toResult(pe(t))},{minArgs:1,maxArgs:1}),n.def("ASIN",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:t<-1||1<t?Me:oe.toResult(ce(t))},{minArgs:1,maxArgs:1}),n.def("ATAN",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult(fe(t))},{minArgs:1,maxArgs:1}),n.def("ATAN2",function(e){var t,o;return isNaN(t=oe.D(e[0]))||isNaN(o=oe.D(e[1]))?Ae:0===t&&0===o?Te:oe.toResult(ge(o,t))},{minArgs:2,maxArgs:2}),n.def("COS",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult(he(t))},{minArgs:1,maxArgs:1}),n.def("CEILING",function(e){var t=oe.D(e[0]),o=oe.D(e[1]);return isNaN(t)||isNaN(o)?Ae:0===t||0===o?0:t>0&&o<0?Me:t<0&&0<o?(o=-o,Ee._MathHelper.approxFloor(t/o)*o):Ee._MathHelper.approxCeiling(t/o)*o},{minArgs:2,maxArgs:2}),n.def("ODD",function(e){var t=parseFloat(e[0]);return t<0?(t=se(t))%2==0&&(t-=1):(t=le(t))%2==0&&(t+=1),t},{minArgs:1,maxArgs:1}),n.def("EVEN",function(e){var t=parseFloat(e[0]);return t<0?(t=se(t))%2!=0&&(t-=1):(t=le(t))%2!=0&&(t+=1),t},{minArgs:1,maxArgs:1}),n.def("FLOOR",function(e){var t,o=oe.D(e[0]),n=oe.D(e[1]);return isNaN(o)||isNaN(n)?Ae:0===o||0===n?0:o>0&&n<0?Me:(t=Ee._MathHelper,o<0&&0<n?(n=-n,t.approxCeiling(o/n)*n):t.approxFloor(o/n)*n)},{minArgs:2,maxArgs:2}),n.def("LN",function(e){var t=parseFloat(e[0]);return t===te||t===ee?Ae:t<=0?Me:oe.toResult(_e(t))},{minArgs:1,maxArgs:1}),n.def("SQRT",function(e){var t=parseFloat(e[0]);return t>=0?re(t):Me},{minArgs:1,maxArgs:1}),n.def("SIN",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult(ue(t))},{minArgs:1,maxArgs:1}),n.def("TAN",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult(de(t))},{minArgs:1,maxArgs:1}),n.def("SIGN",function(e){var t=parseFloat(e[0]);return t>0?1:0===t?0:-1},{minArgs:1,maxArgs:1}),n.def("GCD",function(e){for(var t,o,n,r=0,i=0;i<e.length;i++){if((t=oe.toArr(e[i],1,!0,!0,!1)).isError)return t[0];if(t.isConvertError)return Ae;for(o=0;o<t.length;o++)if((n=t[o])!==oe.CalcConvertedError){if(n<0)return Me;r=R(r,oe.I(n))}}return r},{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("LCM",function(e){for(var t,o,n,r,i,a=1,s=[],l=0;l<e.length;l++){if((t=oe.toArr(e[l],1,!0,!0,!1)).isError)return t[0];if(t.isConvertError)return Ae;for(o=0;o<t.length;o++)if((n=t[o])!==oe.CalcConvertedError){if(n<0)return Me;if(0===n)return 0;s.push(oe.I(n))}for(r=0;r<s.length;r++)a/=R(a,i=s[r]),a*=i}return a},{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("PRODUCT",function(e){return b(e,!0,!0)},{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("POWER",function(e){var t=parseFloat(e[0]),o=parseFloat(e[1]);return we(t,o)},{minArgs:2,maxArgs:2}),n.def("MOD",function(e){var t=parseFloat(e[0]),o=parseFloat(e[1]);return 0===o?"#DIV/0!":t-o*se(t/o)},{minArgs:2,maxArgs:2}),n.def("QUOTIENT",function(e){if(oe.err(e[0]))return e[0];if(oe.err(e[1]))return e[1];var t=oe.D(e[0]),o=oe.D(e[1]);return isNaN(t)||isNaN(o)?Ae:0===o?Te:parseInt((t/o).toString(),10)},{minArgs:2,maxArgs:2}),n.def("SUBTOTAL",function(e){for(var t,n=oe.I(e[0]),r=[],i=1;i<e.length;i++)r[i-1]=e[i];return t=o.Functions._StatHelper,1===n||101===n?t.__averageIncludeSubtotals(r,!1,1===n):2===n||102===n?t.__countIncludeSubtotals(r,!1,2===n):3===n||103===n?t.__countaIncludeSubtotals(r,!1,3===n):4===n||104===n?t.__maxIncludeSubtotals(r,!1,4===n):5===n||105===n?t.__minIncludeSubtotals(r,!1,5===n):6===n||106===n?b(r,!1,6===n):7===n||107===n?t.__stdevIncludeSubtotals(r,!1,7===n):8===n||108===n?t.__stdevpIncludeSubtotals(r,!1,8===n):9===n||109===n?t.__sumIncludeSubtotals(r,!1,9===n):10===n||110===n?t.__varrIncludeSubtotals(r,!1,10===n):11===n||111===n?t.__varpIncludeSubtotals(r,!1,11===n):Ae},{minArgs:2,acceptsReference:a,acceptsArray:a}),n.def("INT",function(e){var t=parseFloat(e[0]);return t===te||t===ee?Ae:Ee._MathHelper.approxFloor(t)},{minArgs:1,maxArgs:1}),n.def("MROUND",function(e){var t=oe.D(e[0]),o=oe.D(e[1]);return isNaN(t)||isNaN(o)?Ae:0===t||0===o?0:t<0&&0<o||o<0&&0<t?Me:Ee._MathHelper.approxFloor(t/o+.5)*o},{minArgs:2,maxArgs:2}),n.def("ROUND",T,{minArgs:2,maxArgs:2}),n.def("ROUNDDOWN",function(e){var t=oe.D(e[0]);if(isNaN(t))return Ae;var o=oe.I(e[1]),n=Ee._MathHelper,r=n.pow10(ne(o));return o<0?t/=r:t*=r,t=t<0?n.approxCeiling(t):n.approxFloor(t),o<0?t*=r:t/=r,oe.toResult(t)},{minArgs:2,maxArgs:2}),n.def("ROUNDUP",function(e){var t=oe.D(e[0]);if(isNaN(t))return Ae;var o=oe.I(e[1]),n=Ee._MathHelper,r=n.pow10(ne(o));return o<0?t/=r:t*=r,t=t<0?n.approxFloor(t):n.approxCeiling(t),o<0?t*=r:t/=r,oe.toResult(t)},{minArgs:2,maxArgs:2}),n.def("TRUNC",function(e){var t=oe.D(e[0]);if(isNaN(t))return Ae;var n=o._Helper._argumentExists(e,1)?oe.I(e[1]):0,r=Ee._MathHelper,i=r.pow10(ne(n));return n<0?t/=i:t*=i,t=t<0?r.approxCeiling(t):r.approxFloor(t),n<0?t*=i:t/=i,oe.toResult(t)},{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("EXP",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult(me(t))},{minArgs:1,maxArgs:1}),n.def("LOG",function(e){var t,n=oe.D(e[0]);if(isNaN(n))return Ae;if(o._Helper._argumentExists(e,1)){if(t=oe.D(e[1]),isNaN(t))return Ae}else t=10;return n<=0||t<=0?Me:1===t?Te:oe.toResult(Q.log(n,t))},{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("LOG10",function(e){var t=oe.D(e[0]);return isNaN(t)?Ae:t<=0?Me:oe.toResult(Q.log10(t))},{minArgs:1,maxArgs:1}),n.def("SUM",function(e){var o,n,r,i,a,s;if(!e||e.length<1)throw t.SR.Exp_InvalidArgument;for(o=0,r=0;r<e.length;r++){if(i=e[r],oe.err(i))return i;if(oe.ref(i)||oe.arr(i)){if((a=oe.toArr(i,1,!0,!0,!1)).isError)return a[0]}else a=oe.toArr(i,1,!0,!0,!0);for(n=a.length,s=0;s<n;s++)a[s]!==oe.CalcConvertedError&&(o+=a[s])}return o},{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("SUMIF",function(e){var n,r,i,a,s,l,u,c,h=e[0],p=e[1];if(p===te||p===ee)throw t.SR.Exp_CriteriaIsNull;if(n=o._Helper._argumentExists(e,2)?e[2]:e[0],r=e[1],oe.ref(r))return i=r.getRowCount(0),a=r.getColumnCount(0),1===i&&1===a?I(r.getValue(0,0,0),h,n):new o._TernaryCompositeConcreteReference(r.getSource(),r.getRow(0),r.getColumn(0),i,a,I,h,n);if(s=e[1],oe.arr(s)){for(i=s.getRowCount(),a=s.getColumnCount(),l=new o._ConcreteArray(s,a),u=0;u<i;u++)for(c=0;c<a;c++)l._array[u][c]=I(s.getValue(u,c),h,n);return l}return I(p,h,n)},{minArgs:2,maxArgs:3,acceptsMissingArgument:l,acceptsReference:u,acceptsArray:u}),n.def("SUMIFS",function(e){var t,o,n,r,i,a,s=0,l=oe.toArr(e[0],1,!0,!0,!1);if(l.isError)return l[0];var u=l.length,c=l.rowCount,h=l.colCount,p=[],d=[];for(i=1;i<e.length;i+=2){if((f=oe.toArr(e[i],0,!0,!1,!1)).rowCount!==c||f.colCount!==h)return Ae;t=e[i+1],g=Ee._MathHelper.parseCriteria(t),p.push(f),d.push(g)}for(o=p.length,n=0;n<u;n++){for(r=!0,i=0;i<o;i++){var f=p[i],g=d[i],m=f[n];if(!(r=g&&g(m)))break}r&&(a=l[n])!==oe.CalcConvertedError&&(s+=a)}return oe.toResult(s)},{minArgs:3,acceptsReference:c,acceptsArray:c}),n.def("SUMPRODUCT",function(e){for(var t,o,n,r,i,a,s,l=0,u=[],c=0;c<e.length;c++){if((t=oe.toArr(e[c],1,!0,!0,!1)).isError)return t[0];if(t.isConvertError)return Ae;if(0==c)i=t.rowCount,a=t.colCount,s=t.length;else if(t.rowCount!==i||t.colCount!==a)return Ae;u.push(t)}for(c=0;c<s;c++){for(o=1,n=0;n<e.length;n++){if((r=u[n][c])===oe.CalcConvertedError){o=0;break}o*=r}l+=o}return oe.toResult(l)},{minArgs:1,acceptsReference:i,acceptsArray:i,arrayArgumentEvaluateMode:1}),n.def("SUMSQ",function(e){for(var t,o,n,r=0,i=0;i<e.length;i++){if((t=oe.toArr(e[i],1,!0,!0,!1)).isError)return t[0];if(t.isConvertError)return Ae;for(o=0;o<t.length;o++)(n=t[o])!==oe.CalcConvertedError&&(r+=n*n)}return oe.toResult(r)},{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("SUMX2MY2",function(e){var t,o,n,r,i=0,a=oe.toArr(e[0],1,!0,!0,!1);if(a.isError)return a[0];if(a.isConvertError)return Ae;if((n=oe.toArr(e[1],1,!0,!0,!1)).isError)return n[0];if(n.isConvertError)return Ae;if(a.length!==n.length)return Fe;for(r=0;r<a.length;r++)t=a[r],o=n[r],t!==oe.CalcConvertedError&&o!==oe.CalcConvertedError&&(i+=t*t-o*o);return oe.toResult(i)},{minArgs:2,maxArgs:2,acceptsReference:i,acceptsArray:i}),n.def("SUMX2PY2",function(e){var t,o,n,r,i=0,a=oe.toArr(e[0],1,!0,!0,!1);if(a.isError)return a[0];if(a.isConvertError)return Ae;if((n=oe.toArr(e[1],1,!0,!0,!1)).isError)return n[0];if(n.isConvertError)return Ae;if(a.length!==n.length)return Fe;for(r=0;r<a.length;r++)t=a[r],o=n[r],t!==oe.CalcConvertedError&&o!==oe.CalcConvertedError&&(i+=t*t+o*o);return oe.toResult(i)},{minArgs:2,maxArgs:2,acceptsReference:i,acceptsArray:i}),n.def("SUMXMY2",function(e){var t,o,n,r,i=0,a=oe.toArr(e[0],1,!0,!0,!1);if(a.isError)return a[0];if(a.isConvertError)return Ae;if((n=oe.toArr(e[1],1,!0,!0,!1)).isError)return n[0];if(n.isConvertError)return Ae;if(a.length!==n.length)return Fe;for(r=0;r<a.length;r++)t=a[r],o=n[r],t!==oe.CalcConvertedError&&o!==oe.CalcConvertedError&&(i+=(t-o)*(t-o));return oe.toResult(i)},{minArgs:2,maxArgs:2,acceptsReference:i,acceptsArray:i}),n.def("SERIESSUM",function(e){var t,o,n,r,i,a,s;if(isNaN(t=oe.D(e[0]))||isNaN(n=oe.I(e[1]))||isNaN(o=oe.I(e[2])))return Ae;if((r=oe.toArr(e[3],1,!0,!0,!0)).isError)return r[0];if(r.isConvertError)return Ae;for(i=0,a=0;a<r.length;a++){if(isNaN(s=oe.D(r[a])))return Ae;i+=s*we(t,n+a*o)}return oe.toResult(i)},{minArgs:4,maxArgs:4,acceptsReference:h,acceptsArray:h}),n.def("PI",function(e){return ye},{minArgs:0,maxArgs:0}),n.def("SQRTPI",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:t<0?Me:oe.toResult(re(t*ye))},{minArgs:1,maxArgs:1}),n.def("DEGREES",function(e){var t;return isNaN(t=parseFloat(e[0]))?Ae:180*t/ye},{minArgs:1,maxArgs:1}),n.def("RADIANS",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:ye*t/180},{minArgs:1,maxArgs:1}),n.def("COSH",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult((me(t)+me(-t))/2)},{minArgs:1,maxArgs:1}),n.def("ACOSH",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:t<1?Me:oe.toResult(_e(t+re(t*t-1)))},{minArgs:1,maxArgs:1}),n.def("SINH",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult((me(t)-me(-t))/2)},{minArgs:1,maxArgs:1}),n.def("ASINH",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:oe.toResult(_e(t+re(t*t+1)))},{minArgs:1,maxArgs:1}),n.def("TANH",function(e){var t,o,n;return isNaN(t=oe.D(e[0]))?Ae:(o=me(t),n=me(-t),oe.toResult(o-n)/(o+n))},{minArgs:1,maxArgs:1}),n.def("ATANH",function(e){var t;return isNaN(t=oe.D(e[0]))?Ae:t<=-1||1<=t?Me:oe.toResult(_e((1+t)/(1-t))/2)},{minArgs:1,maxArgs:1}),n.def("MDETERM",function(e){oe.CalcConvertedError;var t,o,n,r,i,a,s,l,u,c,h,p=oe.toArr(e[0],1,!1,!0,!0);if(p.isError)return p[0];if(p.rangeCount>1||p.rowCount!==p.colCount)return Ae;for(t=p.rowCount,o=1,n=0;n<t-1;n++){if(0===p[n][n]){for(r=!1,i=n+1;!r&&i<t;i++)if(0!==p[i][n]){for(a=n;a<t;a++)s=p[n][a],p[n][a]=p[i][a],p[i][a]=s;o*=-1,r=!0}if(!r)return 0}for(l=n+1;l<t;l++)if(0!==p[l][n])for(u=p[l][n]/p[n][n],c=n;c<t;c++)p[l][c]-=u*p[n][c]}for(h=0;h<t;h++)o*=p[h][h];return o},{minArgs:1,maxArgs:1,acceptsArray:i,acceptsReference:i}),n.def("MINVERSE",function(e){oe.CalcConvertedError;var t,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w=oe.toArr(e[0],1,!1,!0,!0);if(w.isError)return w[0];if(w.rangeCount>1||w.rowCount!==w.colCount)return Ae;for(t=w.rowCount,n=[],r=0;r<t;r++)for(n[r]=[t],i=0;i<t;i++)n[r][i]=r===i?1:0;for(a=0;a<t;a++){if(0===w[a][a]){for(s=!1,l=a+1;!s&&l<t;l++)if(0!==w[l][a]){for(u=a;u<t;u++)c=w[a][u],w[a][u]=w[l][u],w[l][u]=c;for(h=1;h<t;h++)p=n[a][h],n[a][h]=n[l][h],n[l][h]=p;s=!0}if(!s)return Me}for(d=0;d<t;d++)if(d!==a&&0!==w[d][a]){for(f=w[d][a]/w[a][a],g=a;g<t;g++)w[d][g]-=f*w[a][g];for(m=0;m<t;m++)n[d][m]-=f*n[a][m]}}for(_=0;_<t;_++)for(y=w[_][_],C=0;C<t;C++)n[_][C]/=y;return new o._ConcreteArray(n)},{minArgs:1,maxArgs:1,acceptsArray:i,acceptsReference:i}),n.def("MMULT",function(e){var t,n,r,i,a,s,l,u=oe.toArr(e[0],1,!1,!0,!0),c=oe.toArr(e[1],1,!1,!0,!0);if(u.isError||c.isError)return u.isError?u[0]:c[0];var h=u.rowCount,p=u.colCount,d=c.rowCount,f=c.colCount;if(u.isConvertError||c.isConvertError||p!==d)return Ae;for(t=[],i=0;i<h;i++)for(t[i]=n=[],r=u[i],a=0;a<f;a++){for(s=0,l=0;l<d;l++)s+=r[l]*c[l][a];n[a]=s}return new o._ConcreteArray(t)},{minArgs:2,maxArgs:2,acceptsArray:i,acceptsReference:i}),n.def("FACT",function(e){var t,o=parseInt(e[0],10),n=1;if(isNaN(o))return Ae;if(o<0||170<o)return Me;for(t=1;t<=o;t++)n*=t;return n},{minArgs:1,maxArgs:1}),n.def("FACTDOUBLE",function(e){var t,o=parseInt(e[0],10),n=1;if(isNaN(o))return Ae;if(o<0||300<o)return Me;for(t=o;t>1;t-=2)n*=t;return n},{minArgs:1,maxArgs:1}),n.def("MULTINOMIAL",function(e){for(var t,o,n,r,i=0,a=1,s=0;s<e.length;s++){if((r=oe.toArr(e[s],0,!0,!0,!1)).isError)return r[0];if(r.isConvertError)return Ae;for(t=0;t<r.length;t++){if(o=r[t],(n=oe.I(o))<0||170<n)return Me;i+=n,a*=D(n)}}return i<0||170<i?Me:D(i)/a},{minArgs:1,acceptsArray:i,acceptsReference:i}),n.def("RAND",function(e){var t=Ce();return ne(2*t-1)},{minArgs:0,maxArgs:0,isVolatile:p}),n.def("RANDBETWEEN",function(e){var t,o,n;return oe.err(e[1])?e[1]:oe.err(e[0])?e[0]:isNaN(t=oe.I(e[0]))||isNaN(o=oe.I(e[1]))?Ae:o<t?Me:(n=Ce(),oe.I(t+n*(o-t+1)))},{minArgs:2,maxArgs:2,isVolatile:p}),n.def("COMBIN",function(e){var t,o,n=parseFloat(e[0]),r=parseFloat(e[1]);if(isNaN(n)||isNaN(r))return Ae;if(n<0||r<0||n<r)return Me;for(t=1,r=ae(n-r,r),o=1;o<=r;o++)t*=n-o+1,t/=o;return oe.toResult(t)},{minArgs:2,maxArgs:2}),n.def("ROMAN",function(e){var t,n,r,i,a,s,l,u,c,h,p,d,f=o._Helper;if(oe.err(e[0]))return e[0];if(t=oe.I(e[0]),n=0,f._argumentExists(e,1)){if(oe.err(e[1]))return e[1];n="boolean"==typeof e[1]?e[1]?0:4:oe.I(e[1])}if(r=[],t<0||3999<t||n<0||4<n)return Ae;for(d=void 0,(d=[]).push(new Z("M",1e3)),d.push(new Z("D",500)),d.push(new Z("C",100)),d.push(new Z("L",50)),d.push(new Z("X",10)),d.push(new Z("V",5)),d.push(new Z("I",1)),i=d,a=0;a<i.length;a+=2){if(2<=a&&i[a-2].Value-i[a].Value<=t){for(s=a,l=a-2,u=0;u<n&&s+1<i.length&&i[l].Value-i[s+1].Value<=t;u++)s++;r.push(i[s].Key),r.push(i[l].Key),t+=i[s].Value,t-=i[l].Value}if(1<=a&&i[a-1].Value<=t&&(r.push(i[a-1].Key),t-=i[a-1].Value),1<=a&&i[a-1].Value-i[a].Value<=t){for(c=a,h=a-1,p=0;p<n&&c+1<i.length&&i[h].Value-i[c+1].Value<=t;p++)c++;r.push(i[c].Key),r.push(i[h].Key),t+=i[c].Value,t-=i[h].Value}for(;i[a].Value<=t;)r.push(i[a].Key),t-=i[a].Value}return r.join("")},{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("CEILING.PRECISE",A,{minArgs:1,maxArgs:2}),n.def("ISO.CEILING",A,{minArgs:1,maxArgs:2}),n.def("FLOOR.PRECISE",function(e){var t=oe.D(e[0]),n=o._Helper._argumentExists(e,1)?oe.D(e[1]):1;return 0==t||0==n?0:Ee._MathHelper.approxFloor(t/ne(n))*ne(n)},{minArgs:1,maxArgs:2}),n.def("AND",function(e){for(var t,o,n=0;n<e.length;n++){if((t=oe.toArr(e[n],3,!0,!0,!1)).isError)return t[0];if(t.isConvertError)return Ae;for(o=0;o<t.length;o++)if(!t[o])return!1}return!0},{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("OR",function(e){for(var t,o,n=0;n<e.length;n++){if((t=oe.toArr(e[n],3,!0,!0,!1)).isError)return t[0];if(t.isConvertError)return Ae;for(o=0;o<t.length;o++)if(t[o]&&t[o]!==oe.CalcConvertedError)return!0}return!1},{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("NOT",function(e){var t,n,r,i;if(oe.ref(e[0]))return e[0].getRangeCount()>1?Ae:new o._UnaryCompositeConcreteReference(e[0].getSource(),e[0].getRow(0),e[0].getColumn(0),e[0].getRowCount(0),e[0].getColumnCount(0),F);if(oe.arr(e[0])){var a=[],s=e[0].getRowCount(),l=e[0].getColumnCount();for(t=0;t<s;t++)for(a[t]=[l],n=0;n<l;n++)i=typeof(r=e[0].getValue(t,n)),a[t][n]=i===Se||i===xe?!r:Ae;return new o._ConcreteArray(a)}return F(e[0])},{minArgs:1,maxArgs:1}),n.def("IF",function(e){var t,n,r,i=e[0],a=e[1],s=o._Helper,l=s._argumentExists(e,2)?e[2]:2!==e.length&&0,u=s.tryExtractToSingleValue(i);if(u.success)return M(i=u.value,a,l);a=(u=s.tryExtractToSingleValue(a)).value,t=u.success,l=(u=s.tryExtractToSingleValue(l)).value;var c=u.success,h=i.getRowCount(),p=i.getColumnCount(),d=[];for(n=0;n<h;n++)for(d[n]=[p],r=0;r<p;r++)d[n][r]=M(i.getValue(n,r),t?a:s.getArrayValue(a,n,r),c?l:s.getArrayValue(l,n,r));return new o._ConcreteArray(d)},{minArgs:2,maxArgs:3,acceptsReference:d,acceptsArray:d,acceptsError:d,acceptsMissingArgument:l,isBranch:f,findTestArgument:_,findBranchArgument:function(e){if(oe.err(e))return-1;var t=!1;try{t=oe.B(e)}catch(e){}return t?1:2}}),n.def("IFERROR",function(e){var t,n=oe.err(e[0]);return!n&&oe.ref(e[0])?(t=e[0]).getRangeCount()>1?Ae:new o._BinaryCompositeConcreteReference(t.getSource(),t.getRow(0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0),E,e[1]):n?e[1]!==te&&e[1]!==ee?e[1]:0:e[0]!==te&&e[0]!==ee?e[0]:0},{minArgs:2,maxArgs:2,acceptsReference:g,acceptsError:g}),n.def("TRUE",function(e){return!0},{minArgs:0,maxArgs:0}),n.def("FALSE",function(e){return!1},{minArgs:0,maxArgs:0}),n.def("DATE",function(e){var t,o,n,r;try{return isNaN(t=oe.I(e[0]))||isNaN(o=oe.I(e[1]))||isNaN(n=oe.I(e[2]))?Ae:t<0||9999<t?Me:(t<=1899&&(t+=1900),(r=new Date(t,o-1,n))<new Date(1899,11,30)?Me:r)}catch(e){return Me}},{minArgs:3,maxArgs:3}),n.def("TIME",function(t){var o,n,r,i;try{return isNaN(o=oe.I(t[0]))||isNaN(n=oe.I(t[1]))||isNaN(r=oe.I(t[2]))?Ae:((i=e.Sheets._DateTimeHelper.fromOADate(0)).setHours(o),i.setMinutes(n),i.setSeconds(r),i.setMilliseconds(0),i.getHours()<0&&i.getMinutes()<0&&i.getSeconds()<0?Me:i)}catch(e){return Me}},{minArgs:3,maxArgs:3}),n.def("DATEVALUE",function(t){var o,n,r,i,a;try{if((o=oe.S(t[0]))===te||o===ee||""===o||((n=e.Sheets._DateTimeHelper.parseLocale(o))||(!(n=new Date(o))||isNaN(n.valueOf()))&&(n=null),!n)||(r=n.getFullYear())<1900)return Ae;var s=n.getMonth(),l=n.getDate(),u=0;for(i=1900;i<r;i++)u+=N(i)?366:365;for(a=0;a<s;a++)switch(a){case 0:case 2:case 4:case 6:case 7:case 9:case 11:u+=31;break;case 1:u+=N(r)?29:28;break;case 3:case 5:case 8:case 10:u+=30}return u+l}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("TIMEVALUE",O,{minArgs:1,maxArgs:1}),n.def("NOW",function(e){return new Date},{minArgs:0,maxArgs:0,isVolatile:p}),n.def("TODAY",function(e){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t},{minArgs:0,maxArgs:0,isVolatile:p}),n.def("HOUR",function(e){try{return oe.DT(e[0]).getHours()}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("MINUTE",function(e){try{return oe.DT(e[0]).getMinutes()}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("SECOND",function(e){try{return oe.DT(e[0]).getSeconds()}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("DAY",function(e){try{return oe.DT(e[0]).getDate()}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("MONTH",function(e){try{return oe.DT(e[0]).getMonth()+1}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("YEAR",function(e){try{return oe.DT(e[0]).getFullYear()}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("WEEKNUM",function(e){var t,n;try{t=oe.DT(e[0])}catch(e){return Ae}if(isNaN(n=oe.I(o._Helper._argumentExists(e,1)?e[1]:1)))return Ae;switch(n){case 1:case 2:return P(t,n);default:return Me}},{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("WEEKDAY",L,{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("EDATE",function(e){var t,o;try{t=oe.DT(e[0])}catch(e){return Ae}return isNaN(o=oe.I(e[1]))?Ae:(t.setMonth(t.getMonth()+o),t)},{minArgs:2,maxArgs:2}),n.def("EOMONTH",function(e){var t,o,n;try{t=oe.DT(e[0])}catch(e){return Ae}return isNaN(o=oe.I(e[1]))?Ae:(t.setMonth(t.getMonth()+o),n=function(e,t){switch(t){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 1:return N(e)?29:28;case 3:case 5:case 8:case 10:return 30}}(t.getFullYear(),t.getMonth()),t.setDate(n),t)},{minArgs:2,maxArgs:2}),n.def("WORKDAY",function(n){var r,i,a,s=o._Helper,l=oe.DT(n[0]),u=oe.I(n[1]),c=[];if(s._argumentExists(n,2)){if((c=oe.toArr(n[2],4,!0,!0,!0)).isError)return c[0];if(c.isConvertError)return Ae}if((r=[])[0]=l,r[1]=3,i=L(r),oe.err(i))return i;for(a=oe.I(i);u<0;++u){try{l.setDate(l.getDate()-1)}catch(e){return Me}0===a?a=6:a--,5===a||6===a?u--:c.indexOf(t._DateTimeHelper.___toOADate(l))>=0&&u--}for(;u>0;--u){try{l.setDate(l.getDate()+1)}catch(e){return Me}6===a?a=0:a++,5===a||6===a?u++:c.indexOf(t._DateTimeHelper.___toOADate(l))>=0&&u++}return new e.Sheets._DateTimeHelper(l).toOADate()},{minArgs:2,maxArgs:3,acceptsMissingArgument:l,acceptsArray:l,acceptsReference:l}),n.def("WORKDAY.INTL",function(e){var n,r,i,a,s=o._Helper,l=oe.DT(e[0]),u=oe.I(e[1]),c=B(s._argumentExists(e,2)?e[2]:"0000011");if(oe.err(c))return c;if("1111111"===c.join(""))return Ae;if(n=[],s._argumentExists(e,3)){if((n=oe.toArr(e[3],4,!0,!0,!0)).isError)return n[0];if(n.isConvertError)return Ae}if((r=[])[0]=l,r[1]=3,i=L(r),oe.err(i))return i;for(a=oe.I(i);u<0;++u){try{l.setDate(l.getDate()-1)}catch(e){return Me}0===a?a=6:a--,c[a]?u--:n.indexOf(t._DateTimeHelper.___toOADate(l))>=0&&u--}for(;u>0;--u){try{l.setDate(l.getDate()+1)}catch(e){return Me}6===a?a=0:a++,c[a]?u++:n.indexOf(t._DateTimeHelper.___toOADate(l))>=0&&u++}return t._DateTimeHelper.___toOADate(l)},{minArgs:2,maxArgs:4,acceptsMissingArgument:x,acceptsArray:x,acceptsReference:x}),n.def("DAYS360",k,{minArgs:2,maxArgs:3,acceptsMissingArgument:l}),n.def("NETWORKDAYS",function(t){var o,n,r,i,a,s,l,u,c,h,p=e.Sheets._DateTimeHelper,d=oe.DT(t[0]),f=oe.DT(t[1]),g=oe.I(new p(d).toOADate()),m=oe.I(new p(f).toOADate()),_=!1;return g>m&&(o=d,n=g,g=m,m=n,d=f,f=o,_=!0),i=d,a=f,s=r=m-g+1,u=e.Sheets._DateTimeHelper,c=oe.I(new u(a).toOADate()-new u(i).toOADate())%7,h=oe.I(L([i,2])+c),(r=(s-=c=(c=h>5?h-5:0)>(l=0===i.getDay()?1:2)?l:c)-2*se(s/7))<=0?0:(r=V(t,g,m,r),_?-r:r)},{minArgs:2,maxArgs:3,acceptsMissingArgument:l,acceptsArray:l,acceptsReference:l}),n.def("NETWORKDAYS.INTL",function(t){var n,r,i,a=e.Sheets._DateTimeHelper,s=oe.DT(t[0]),l=oe.DT(t[1]),u=oe.I(new a(s).toOADate()),c=oe.I(new a(l).toOADate()),h=!1;return u>c&&(n=s,r=u,u=c,c=r,s=l,l=n,h=!0),i=function(e,t,n,r){var i,a,s,l,u=B(o._Helper._argumentExists(e,2)?e[2]:"0000011");if(oe.err(u))return u;for(i=0,a=0;a<u.length;a++)1===u[a]&&i++;if(s=0,r<30){for(d=0;d<r;d++)u[(oe.I(L([t,3]))+d)%7]&&s++;return r-s}for(var c=r,h=0,p=0,d=0;d<c&&oe.I(L([t,3])+d)%7!=0;d++)h++;for(d=0;d<h;d++)u[(oe.I(L([t,3]))+d)%7]&&s++;for(d=0;d<c&&(oe.I(L([n,3]))+7-d)%7!=6;d++)p++;for(d=0;d<p;d++)u[(oe.I(L([n,3]))+7-d)%7]&&s++;return c=c-h-p,l=oe.I(c/7)*i,(r-=l)-s}(t,s,l,i=c-u+1),oe.err(i)?i:i<=0?0:(i=V(t,u,c,i,!0),h?-i:i)},{minArgs:2,maxArgs:4,acceptsMissingArgument:x,acceptsArray:x,acceptsReference:x}),n.def("YEARFRAC",z,{minArgs:2,maxArgs:3,acceptsMissingArgument:l}),n.def("DATEDIF",function(e){var o,n,r=oe.DT(e[0]),i=oe.DT(e[1]),a=oe.S(e[2]).toLocaleUpperCase();if(i<r)return Me;if((n=[])[0]=function(e,t){return t.getFullYear()-e.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0)},n[1]=function(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())+(t.getDate()<e.getDate()?-1:0)},n[2]=function(e,t){return(t.getTime()-e.getTime())/864e5},n[3]=function(e,t){var o=new Date(t.getFullYear(),t.getMonth()+(t.getDate()<e.getDate()?-1:0),e.getDate());return(t.getTime()-o.getTime())/864e5},n[4]=function(e,t){return t.getMonth()-e.getMonth()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?12:0)+(t.getDate()<e.getDate()?-1:0)},n[5]=function(e,t){return(t-new Date(t.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0),e.getMonth(),e.getDate()))/864e5},o=function(e,o){var n;switch(o){case"Y":n=0;break;case"M":n=1;break;case"D":n=2;break;case"MD":n=3;break;case"YM":n=4;break;case"YD":n=5;break;default:throw t.SR.Exp_NotSupport}return e[n]}(n,a))try{return o(r,i)}catch(e){return Ae}return Me},{minArgs:3,maxArgs:3}),n.def("CLEAN",function(e){for(var t=oe.S(e[0]),o=[],n=0;n<t.length;n++)0<=(r=t.charCodeAt(n))&&r<=31||127===r||128<=r&&r<=159||o.push(t[n]);var r;return o.join("")},{minArgs:1,maxArgs:1}),n.def("TRIM",function(e){for(var t,o=oe.S(e[0]).trim(),n=[],r=!0,i=0;i<o.length;i++)(!G(t=o.charAt(i))||r)&&n.push(t),r=!G(t);return n.join("")},{minArgs:1,maxArgs:1}),n.def("DOLLAR",function(e){var t,n,r,i,a,s=o._Helper;return isNaN(t=oe.D(e[0]))?Ae:(n=s._argumentExists(e,1)?oe.I(e[1]):2)>99?Ae:(t=oe.D(T([t,n])),a=W(r=t),r<0&&(a=a.substr(1)),(i=[]).push("$"),i.push(a),r<0&&(i.push(")"),i.unshift("(")),i.join(""))},{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("FIXED",function(e){var t,n=o._Helper;if(isNaN(t=oe.D(e[0])))return Ae;var r=n._argumentExists(e,1)?oe.I(e[1]):2,i=!!n._argumentExists(e,2)&&oe.B(e[2]),a=[],s=0;return r<0?(t/=s=oe.I(we(10,ne(r))),a[0]=t,a[1]=0):(a[0]=t,a[1]=r),t=oe.D(T(a)),r<0&&(t*=s),i?t.toString():W(t)},{minArgs:1,maxArgs:3,acceptsMissingArgument:d}),n.def("TEXT",function(e){var o=e[0],n=(t._StandardDateTimeFormatter,t._StandardNumberFormatter,oe.S(e[1]));if(""===n||n===ee||n===te)return oe.S(o);(o===ee||o===te)&&(o=0),n=function(e){var o,n,r,i;if(t.StringUtil.startsWith(e,"[$-"))return e;if(-1!==e.indexOf("[")&&-1!==e.indexOf("]"))for(o=e.indexOf("["),n=e.indexOf("]",o);-1!==o&&-1!==n;)r=e.substring(0,o),i=e.substring(n+1),n=-1===(o=(e=r.concat(i)).indexOf("["))?-1:e.indexOf("]",o);return e}(n);try{return new t.GeneralFormatter(n).Format(o)}catch(e){return Ae}},{minArgs:2,maxArgs:2}),n.def("VALUE",function(t){var o,n,r=oe,i=e.Sheets._DateTimeHelper,a=oe.S(t[0]),s=i.parseLocale(a);return s!==te&&s!==ee?(o=new i(s).toOADate(),r.err(o)?O([s]):o):isNaN(n=parseFloat(a))?Ae:n},{minArgs:1,maxArgs:1}),n.def("LOWER",function(e){return oe.S(e[0]).toLowerCase()},{minArgs:1,maxArgs:1}),n.def("UPPER",function(e){return oe.S(e[0]).toUpperCase()},{minArgs:1,maxArgs:1}),n.def("PROPER",function(e){var t,n,r,i=oe.S(e[0]),a=i.length,s=[];if(a>0)for(t=i.toUpperCase(),n=i.toLowerCase(),s[0]=t[0],r=1;r<a;)s[r]=o.Parser._isLetter(i[r-1])?n[r]:t[r],r++;return s.join("")},{minArgs:1,maxArgs:1}),n.def("CHAR",function(e){var t=oe.I(e[0]);return t<1||255<t?Ae:String.fromCharCode(t)},{minArgs:1,maxArgs:1}),n.def("CODE",function(e){var t=oe.S(e[0]);if(""===t||t===te||t===ee)return Ae;try{return t[0].charCodeAt(0)}catch(e){return Ae}},{minArgs:1,maxArgs:1}),n.def("REPLACE",function(e){var t,o,n=oe.S(e[0]),r=oe.I(e[1]),i=oe.I(e[2]),a=oe.S(e[3]);return r<1||i<0?Ae:(r=ae(r,n.length+1),i=ae(i,n.length-r+1),t=n.substring(0,r-1),o=n.substr(r-1+i),t.concat(a).concat(o))},{minArgs:4,maxArgs:4,acceptsMissingArgument:l}),n.def("SUBSTITUTE",function(e){var o,n,r,i,a,s,l=oe.S(e[0]),u=oe.S(e[1]),c=oe.S(e[2]);if(""===u||u===te||u===ee)return l;if(e.length>3){if(r=0,(n=oe.I(e[3]))<1)return Ae;for(i=0;i<n;i++){if(-1===(r=l.indexOf(u,r)))return l;r+=u.length}r-=u.length,a=l.substring(0,r),s=l.substr(r+u.length),o=a.concat(c).concat(s)}else o=t.StringUtil.replace(l,u,c);return o},{minArgs:3,maxArgs:4,acceptsMissingArgument:h}),n.def("CONCATENATE",function(e){for(var t,o,n,r,i=[],a=e.length,s=0;s<a;s++)for(o=(t=oe.toArr(e[s],0,!0,!1,!1)).length,n=0;n<o;n++)(r=t[n])!==te&&r!==ee&&i.push(oe.S(r));return i.join("")},{minArgs:2,acceptsArray:i}),n.def("LEFT",function(e){var t=o._Helper,n=oe.S(e[0]),r=t._argumentExists(e,1)?oe.I(e[1]):1;return r<0?Ae:r>=n.length?n:n.substr(0,r)},{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("MID",function(e){var t=oe.S(e[0]),o=oe.I(e[1])-1,n=oe.I(e[2]);return o<0||n<0?Ae:o>=t.length?"":t.length<o+n?t.substr(o):t.substr(o,n)},{minArgs:3,maxArgs:3}),n.def("RIGHT",function(e){var t=o._Helper,n=oe.S(e[0]),r=t._argumentExists(e,1)?oe.I(e[1]):1;return r<0?Ae:n.length<r?n:n.substr(n.length-r,r)},{minArgs:1,maxArgs:2,acceptsMissingArgument:s}),n.def("REPT",function(e){var t,o,n=oe.S(e[0]),r=oe.I(e[1]);if(r<0||32767<r*n.length)return Ae;for(t=[],o=0;o<r;o++)t.push(n);return t.join("")},{minArgs:2,maxArgs:2}),n.def("LEN",function(e){return oe.S(e[0]).length},{minArgs:1,maxArgs:1}),n.def("FIND",function(e){var t,n=o._Helper,r=oe.S(e[0]),i=oe.S(e[1]),a=n._argumentExists(e,2)?oe.I(e[2]):1;return a<1||i.length<a?Ae:-1===(t=i.indexOf(r,a-1))?Ae:t+1},{minArgs:2,maxArgs:3,acceptsMissingArgument:l}),n.def("SEARCH",function(e){var n,r,i,a=o._Helper,s=oe.S(e[0]),l=oe.S(e[1]),u=a._argumentExists(e,2)?oe.I(e[2]):1;if(--u<0)return Ae;n=-1;try{n=(r=t.RegUtil.getWildcardCriteria(s))?(i=t.RegUtil.getRegIgnoreCase(r).exec(l))!==te&&i!==ee?i.index:-1:l.toLowerCase().indexOf(s.toLowerCase(),u)}catch(e){}return-1===n?Ae:n+1},{minArgs:2,maxArgs:3,acceptsMissingArgument:l}),n.def("EXACT",function(e){return oe.S(e[0])===oe.S(e[1])},{minArgs:2,maxArgs:2}),n.def("T",function(e){var t=e[0];return"string"==typeof t?t:""},{minArgs:1,maxArgs:1}),n.def("ISERROR",function(e){Y(e);var t={value:!1};return oe.err(e[0])?t.value=!0:m(e[0],j,t),t.value},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISERR",function(e){Y(e);var t={value:!1};return oe.err(e[0])&&e[0]._code!==Fe._code?t.value=!0:oe.err(e[0])&&e[0]._code===Fe._code?t.value=!1:m(e[0],U,t),t.value},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISNA",function(e){return Y(e),!!oe.err(e[0])&&e[0]._code===Fe._code},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ERROR.TYPE",function(e){Y(e);var t=e[0];if(t!==te&&t!==ee&&oe.err(t))switch(t._code){case be._code:return 1;case Te._code:return 2;case Ae._code:return 3;case Ie._code:return 4;case De._code:return 5;case Me._code:return 6;case Fe._code:return 7}return Fe},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISNUMBER",function(e){return Y(e),oe.num(e[0])},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISEVEN",function(e){var t;return Y(e),isNaN(t=oe.D(e[0]))?Ae:Ee._MathHelper.approxFloor(ne(t))%2==0},{minArgs:1,maxArgs:1}),n.def("ISODD",function(e){var t;return Y(e),isNaN(t=oe.D(e[0]))?Ae:Ee._MathHelper.approxFloor(ne(t))%2!=0},{minArgs:1,maxArgs:1}),n.def("N",function(e){Y(e);var t=e[0];return oe.num(t)?oe.D(t):typeof t===Se?t?1:0:oe.err(t)?t:0},{minArgs:1,maxArgs:1}),n.def("ISBLANK",function(e){return Y(e),e[0]===te||e[0]===ee},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISLOGICAL",function(e){return Y(e),typeof e[0]===Se},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISTEXT",function(e){return Y(e),typeof e[0]===ve},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISNONTEXT",function(e){return Y(e),typeof e[0]!==ve},{minArgs:1,maxArgs:1,acceptsError:i}),n.def("ISREF",function(e){return Y(e),oe.ref(e[0])},{minArgs:1,maxArgs:1,acceptsError:i,acceptsReference:i}),n.def("TYPE",function(e){Y(e);var t=e[0];return typeof t===Se?4:oe.num(t)?1:typeof t===ve?2:oe.err(t)?16:oe.arr(t)?64:Ae},{minArgs:1,maxArgs:1,acceptsArray:i,acceptsError:i}),n.def("NA",function(e){return Fe},{minArgs:0,maxArgs:0}),n.def("TREND",function(e){var t,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w=oe,v=o._Helper,S=oe.toArr(e[0],0,!1,!0,!1);for(t=v._argumentExists(e,1)?oe.toArr(e[1],0,!1,!0,!1):S,n=v._argumentExists(e,2)?oe.toArr(e[2],0,!1,!0,!1):t,r=!v._argumentExists(e,3)||oe.B(e[3]),i=0;i<S.rowCount;i++)for(a=0;a<S.colCount;a++)if(!w.num(S[i][a]))return Ae;for(i=0;i<t.rowCount;i++)for(a=0;a<t.colCount;a++)if(!w.num(t[i][a]))return Ae;for(i=0;i<n.rowCount;i++)for(a=0;a<n.colCount;a++)if(!w.num(n[i][a]))return Ae;if(S.rowCount===t.rowCount&&S.colCount===t.colCount){c=t.rowCount*t.colCount;var x,R=0,b=0,T=0,A=0;for(i=0;i<t.rowCount;i++)for(a=0;a<t.colCount;a++){if(isNaN(h=oe.D(t[i][a]))||isNaN(p=oe.D(S[i][a])))return Ae;R+=h,b+=h*h,T+=p,A+=h*p}for(r?(u=(c*A-R*T)/(c*b-R*R),x=(T*b-R*A)/(c*b-R*R)):(u=A/b,x=0),d=[],i=0;i<n.rowCount;i++)for(d[i]=[],a=0;a<n.colCount;a++){if(isNaN(h=oe.D(n[i][a])))return Ae;d[i][a]=u*h+x}return new o._ConcreteArray(d)}if(1===S.colCount&&S.rowCount===t.rowCount||1===S.rowCount&&S.colCount===t.colCount){if(p=[],h=[],1===S.colCount){for(c=t.rowCount,u=t.colCount,i=0;i<c;i++){if(isNaN(s=oe.D(S[i][0])))return Ae;p[i]=s}for(i=0;i<c;i++)for(h[i]=[],a=0;a<u;a++){if(isNaN(s=oe.D(t[i][a])))return Ae;h[i][a]=s}}else{for(c=t.colCount,u=t.rowCount,h=[],p=[],i=0;i<c;i++){if(isNaN(s=oe.D(S[0][i])))return Ae;p[i]=s}for(i=0;i<c;i++)for(h[i]=[],a=0;a<u;a++){if(isNaN(s=oe.D(t[a][i])))return Ae;h[i][a]=s}}for(_=[],l=0;l<u+1;l++)_[l]=[];for(y=0;y<u+1;y++)for(C=0;C<u+2;C++)_[y][C]=0;for(l=0;l<c;l++)for(_[0][u+1]=_[0][u+1]+p[l],i=0;i<u;i++)for(_[0][i+1]=_[0][i+1]+h[l][i],_[i+1][0]=_[0][i+1],_[i+1][u+1]=_[i+1][u+1]+h[l][i]*p[l],a=i;a<u;a++)_[a+1][i+1]=_[a+1][i+1]+h[l][i]*h[l][a],_[i+1][a+1]=_[a+1][i+1];if(_[0][0]=c,r)for(i=0;i<u+1;i++){if(0===_[i][i]){for(f=!1,a=i+1;!f&&a<u+1;a++)if(0!==_[a][i]){for(l=0;l<u+2;l++)m=_[i][l],_[i][l]=_[a][l],_[a][l]=m;f=!0}if(!f)return Fe}for(g=1/_[i][i],l=0;l<u+2;l++)_[i][l]=_[i][l]*g;for(a=0;a<u+1;a++)if(a!==i)for(g=-_[a][i],l=0;l<u+2;l++)_[a][l]=_[a][l]+g*_[i][l]}else for(i=1;i<u+1;i++){if(0===_[i][i]){for(f=!1,a=i+1;!f&&a<u+1;a++)if(0!==_[a][i]){for(l=0;l<u+2;l++)m=_[i][l],_[i][l]=_[a][l],_[a][l]=m;f=!0}if(!f)return Fe}for(g=1/_[i][i],l=1;l<u+2;l++)_[i][l]=_[i][l]*g;for(a=1;a<u+1;a++)if(a!==i)for(g=-_[a][i],l=1;l<u+2;l++)_[a][l]=_[a][l]+g*_[i][l];_[0][u+1]=0}if(1===S.colCount){for(d=[],i=0;i<n.rowCount;i++){for(d[i]=[],g=_[0][u+1],a=0;a<u;a++){if(isNaN(s=oe.D(n[i][a])))return Ae;g+=_[a+1][u+1]*s}d[i][0]=g}return new o._ConcreteArray(d)}for((d=[])[0]=[],i=0;i<n.colCount;i++){for(g=_[0][u+1],a=0;a<u;a++){if(isNaN(s=oe.D(n[a][i])))return Ae;g+=_[a+1][u+1]*s}d[0][i]=g}return new o._ConcreteArray(d)}return Fe},{minArgs:1,maxArgs:4,acceptsReference:v,acceptsArray:v,acceptsMissingArgument:C}),n.def("GROWTH",function(e){o.Convert;var t,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v=o._Helper,S=oe.toArr(e[0],1,!1,!0,!0);for(t=v._argumentExists(e,1)?oe.toArr(e[1],1,!1,!0,!0):S,n=v._argumentExists(e,2)?oe.toArr(e[2],1,!1,!0,!0):t,r=!v._argumentExists(e,3)||oe.B(e[3]),s=0;s<S.rowCount;s++)for(l=0;l<S.colCount;l++)if((_=S[s][l])<=0)return Me;if(S.rowCount===t.rowCount&&S.colCount===t.colCount){c=t.rowCount*t.colCount;var x,R=0,b=0,T=0,A=0;for(s=0;s<t.rowCount;s++)for(l=0;l<t.colCount;l++)h=t[s][l],p=S[s][l],R+=h,b+=h*h,T+=p=_e(p),A+=h*p;for(r?(u=(c*A-R*T)/(c*b-R*R),x=(T*b-R*A)/(c*b-R*R)):(u=A/b,x=0),g=[],s=0;s<n.rowCount;s++)for(g[s]=[],l=0;l<n.colCount;l++)h=n[s][l],g[s][l]=me(u*h+x);return new o._ConcreteArray(g)}if(1===S.colCount&&S.rowCount===t.rowCount||1===S.rowCount&&S.colCount===t.colCount){if(p=[],h=[],1===S.colCount){for(c=t.rowCount,u=t.colCount,s=0;s<c;s++)i=S[s][0],p[s]=_e(i);for(s=0;s<c;s++)for(h[s]=[],l=0;l<u;l++)i=t[s][l],h[s][l]=i}else{for(c=t.colCount,u=t.rowCount,h=[],p=[],s=0;s<c;s++)i=S[0][s],p[s]=i;for(s=0;s<c;s++)for(h[s]=[],l=0;l<u;l++)i=t[l][s],h[s][l]=i}for(C=[],d=0;d<u+1;d++)for(C[d]=[],f=0;f<u+2;f++)C[d][f]=0;for(w=[],d=0;d<u+2;d++)w[d]=0;for(a=0;a<c;a++)for(w[u+1]=w[u+1]+p[a]*p[a],C[0][u+1]=C[0][u+1]+p[a],w[0]=C[0][u+1],s=0;s<u;s++)for(C[0][s+1]=C[0][s+1]+h[a][s],C[s+1][0]=C[0][s+1],C[s+1][u+1]=C[s+1][u+1]+h[a][s]*p[a],w[s+1]=C[s+1][u+1],l=s;l<u;l++)C[l+1][s+1]=C[l+1][s+1]+h[a][s]*h[a][l],C[s+1][l+1]=C[l+1][s+1];if(C[0][0]=c,r)for(m=0;m<u+1;m++){for(s=m;s<u+1&&0===C[s][m];)s++;if(s>=u+1)return Fe;for(y=0;y<u+2;y++)_=C[m][y],C[m][y]=C[s][y],C[s][y]=_;for(_=1/C[m][m],y=0;y<u+2;y++)C[m][y]=C[m][y]*_;for(s=0;s<u+1;s++)if(s!==m)for(_=-C[s][m],y=0;y<u+2;y++)C[s][y]=C[s][y]+_*C[m][y]}else for(m=1;m<u+1;m++){for(s=m;s<u+1&&0===C[s][m];)s++;if(s>=u+1)return Fe;for(y=1;y<u+2;y++)_=C[m][y],C[m][y]=C[s][y],C[s][y]=_;for(_=1/C[m][m],C[m][y]=C[m][y]*_,s=1;s<u+1;s++)s!==m&&(_=-C[s][m],C[s][y]=C[s][y]+_*C[m][y]);C[0][u+1]=0}if(1===S.colCount){for(g=[],s=0;s<n.rowCount;s++){for(g[s]=[],_=C[0][u+1],l=0;l<u;l++)i=n[l],_+=C[l+1][u+1]*i;g[s][0]=me(_)}return new o._ConcreteArray(g)}for((g=[])[0]=[],s=0;s<n.colCount;s++){for(_=C[0][u+1],l=0;l<u;l++)i=n[l][s],_+=C[l+1][u+1]*i;g[0][s]=me(_)}return new o._ConcreteArray(g)}return Fe},{minArgs:1,maxArgs:4,acceptsReference:S,acceptsArray:S,acceptsMissingArgument:C}),n.def("FORECAST",function(e){var t,o,n,r,i;if(isNaN(t=oe.D(e[0])))return Ae;var a,s,l,u,c=0,h=0,p=0,d=0,f=oe.toArr(e[1],1,!0,!0,!1);if(f.isError)return f[0];if((o=oe.toArr(e[2],1,!0,!0,!1)).isError)return o[0];if((n=f.length)!==o.length)return Fe;for(r=0,i=0;i<n;i++)a=f[i],s=o[i],a!==oe.CalcConvertedError&&s!==oe.CalcConvertedError&&(c+=a,h+=s,p+=s*s,d+=s*a,r++);return 0===r?Te:r*p-h*h==0?Te:(l=c/r-(u=(r*d-h*c)/(r*p-h*h))*(h/r),oe.toResult(l+u*t))},{minArgs:3,maxArgs:3,acceptsArray:y,acceptsReference:y}),n.def("AVERAGE",function(e){return $.__averageIncludeSubtotals(e,!0,!0)},{minArgs:1,acceptsArray:i,acceptsReference:i}),n.def("STDEV",X,{minArgs:1,acceptsArray:i,acceptsReference:i}),n.def("STDEV.S",X,{minArgs:1,acceptsReference:i,acceptsArray:i}),n.def("PERCENTILE",K,{minArgs:2,maxArgs:2,acceptsArray:w,acceptsReference:w}),n.def("PERCENTILE.INC",K,{minArgs:2,maxArgs:2,acceptsReference:w,acceptArray:w})}(o.Functions||(o.Functions={}));o.Functions}(t.Calc||(t.Calc={}));t.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n,r,i,a,s,l,u,c;e.feature("formatter",["core.common","core.globalize"]);var h,p,d,f,g,m=null,_=void 0,y=Math.abs,C=Math.ceil,w=Math.pow,v=Math.floor,S=Math.max,x=Math.min,R=Math.round,b={Empty:"",Format:function(){for(var e,t,o,n=[],r=0;r<arguments.length-0;r++)n[r]=arguments[r+0];if(0===arguments.length)return m;for(e=n[0],t=1;t<arguments.length;t++)o=new RegExp("\\{"+(t-1)+"\\}","gm"),e=e.replace(o,arguments[t]);return e},IsNullOrEmpty:function(e){return!e||e===b.Empty}};(p=h||(h={}))[p.None=0]="None",p[p.AllowLeadingWhite=1]="AllowLeadingWhite",p[p.AllowTrailingWhite=2]="AllowTrailingWhite",p[p.AllowInnerWhite=4]="AllowInnerWhite",p[p.AllowWhiteSpaces=7]="AllowWhiteSpaces",p[p.NoCurrentDateDefault=8]="NoCurrentDateDefault",p[p.AdjustToUniversal=16]="AdjustToUniversal",p[p.AssumeLocal=32]="AssumeLocal",p[p.AssumeUniversal=64]="AssumeUniversal",p[p.RoundtripKind=128]="RoundtripKind",t={IsDigit:function(e){var t=e.charCodeAt(0);return t>=48&&t<=57},IsWhiteSpace:function(e){var t=e.charCodeAt(0);return t>=9&&t<=13||32===t||133===t||160===t}},(d=e.FormatMode||(e.FormatMode={}))[d.CustomMode=0]="CustomMode",d[d.StandardDateTimeMode=1]="StandardDateTimeMode",d[d.StandardNumericMode=2]="StandardNumericMode",e.FormatMode,(f=e.NumberFormatType||(e.NumberFormatType={}))[f.General=0]="General",f[f.Number=1]="Number",f[f.DateTime=2]="DateTime",f[f.Text=3]="Text",e.NumberFormatType,(g=o||(o={}))[g.Hour=0]="Hour",g[g.Minute=1]="Minute",g[g.Second=2]="Second",n=function(){function t(){}return t.DateTimeFormatInfo=function(){return e._CultureInfo._currentCulture.DateTimeFormat()},t.NumberFormatInfo=function(){return e._CultureInfo._currentCulture.NumberFormat()},t.Filter=function(e,t,o){var n,r,i,a;if(e===_||e===m||""===e)return e;for(n="",r=0,i=0;i<e.length;i++)(a=e[i])===t?r++:a===o?--r<0&&(r=0):0===r&&(n+=a);return n.toString()},t.TrimSquareBracket=function(o){return o&&o!==b.Empty?(o[0]===t.LeftSquareBracket&&(o=e.StringHelper.TrimStart(o,t.LeftSquareBracket)),o[o.length-1]===t.RightSquareBracket&&(o=e.StringHelper.TrimEnd(o,t.RightSquareBracket)),o):o},t.IsOperator=function(e){return e===t.LessThanSign||e===t.GreaterThanSign||e===t.EqualsThanSign},t.TrimEscape=function(e){for(var o,n=e.length,r=!1,i="",a=0;a<n;a++)(o=e.charAt(a))===t.ReverseSolidusSign?(r=!r)||(i+=o):(r=!1,i+=o);return i},t.AddSquareBracket=function(o){if(!o)throw new Error(e.SR.Exp_TokenIsNull);return(0===o.length||o[0]!==t.LeftSquareBracket)&&(o=e.StringHelper.Insert(o,0,t.LeftSquareBracket.toString())),(0===o.length||o[o.length-1]!==t.RightSquareBracket)&&(o=e.StringHelper.Insert(o,o.length,t.RightSquareBracket.toString())),o},t.IsEquals=function(e,t,o){return!e&&!t||!(!e||!t)&&(o?e.toLowerCase()===t.toLowerCase():e===t)},t.ReplaceKeyword=function(t,o,n){var r,i;if(!t||t===b.Empty||this.IsEquals(o,n,!0))return t;for(r=t,0;(i=e.StringHelper.IndexOf(r,o,1))>-1;)r=e.StringHelper.Remove(r,i,o.length),r=e.StringHelper.Insert(r,i,n),i+n.length;return r},t.IsDecimal=function(e,o){var n=t.DecimalSeparator;return o&&(n=o.numberDecimalSeparator),e.indexOf(n)>-1},t.Split=function(o,n){var r,i,a=[];if(o===m||""===o)return a;var s=!1,l=new e._StringBuilder,u=!1;for(r=0;r<o.length;r++)'"'!=(i=o[r])||s||(u=!u),s||u||i!=n?l.append(i):(a.push(l.toString()),l.clear()),s=i==t.ReverseSolidusSign&&!s;return a.push(l.toString()),a},t.DoubleQuote='"',t.SingleQuote="'",t.Tab="\t",t.LeftSquareBracket="[",t.RightSquareBracket="]",t.LessThanSign="<",t.GreaterThanSign=">",t.EqualsThanSign="=",t.PlusSign="+",t.HyphenMinus="-",t.UnderLine="_",t.LeftParenthesis="(",t.RightParenthesis=")",t.Dollar="$",t.Comma=";",t.Space=" ",t.SolidusSign="/",t.ReverseSolidusSign="\\",t.Zero="0",t.QuestionMark="?",t.Colon=":",t.Semicolon=";",t.Sharp="#",t.CommercialAt="@",t.NumberSign="#",t.Asterisk="*",t.Exponential1="E+",t.Exponential2="E-",t.DecimalSeparator=".",t.numberGroupSeparator=",",t.percentSymbol="%",t.nanSymbol="NaN",t.FormatSeparator=";",t.negativeSign="-",t.ReplacePlaceholder="@",t.ExponentialSymbol="E",t}(),e.DefaultTokens=n,r=function(){function t(t,o,n){this._classNames=["NumberFormatBase","IFormatter","IFormatProviderSupport"],this.numberFormatInfo=m,this.dateTimeFormatInfo=m,this.cultureName="";this._initFileds(),this.partLocaleID=t,this.partDbNumberFormat=o,this.cultureName=n||e._CultureInfo._currentCulture.Name()}return t.prototype._initFileds=function(){this.numberStringConverter=m,this.numberFormatInfo=m,this.dateTimeFormatInfo=m,this.partLocaleID=m,this.partDbNumberFormat=m},t.prototype.NumberStringConverter=function(e){return 0===arguments.length?this.numberStringConverter?this.numberStringConverter:m:(this.numberStringConverter=e,e)},t.prototype.PartLocaleID=function(){return e.util.asCustomType(this.partLocaleID,"LocaleIDFormatPart")},t.prototype.PartDBNumberFormat=function(){return e.util.asCustomType(this.partDbNumberFormat,"DBNumberFormatPart")},t.prototype.DateTimeFormatInfo=function(e){return 0===arguments.length?this.dateTimeFormatInfo:(this.dateTimeFormatInfo=e,e)},t.prototype.NumberFormatInfo=function(e){return 0===arguments.length?this.numberFormatInfo:(this.numberFormatInfo=e,e)},t.prototype.CultureName=function(e){return 0===arguments.length?this.partLocaleID?this.partLocaleID.CultureInfo().Name():this.cultureName:(this.cultureName=e,e)},t.prototype.numberGroupSeparator=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().numberGroupSeparator:n.numberGroupSeparator},t.prototype.PercentSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().percentSymbol:n.percentSymbol},t.prototype.PositiveSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().positiveSign:n.NumberFormatInfo().positiveSign},t.prototype.NegativeSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().negativeSign:n.negativeSign},t.prototype.DecimalSeparator=function(){return n.DecimalSeparator},t.prototype.NaNSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().nanSymbol:n.nanSymbol},t.TrimNotSupportSymbol=function(e,o){var n,r,i,a,s;for(1===arguments.length&&(o=!0),n=!1,r="",i=0;i<e.length;i++)s=!0,'"'===(a=e[i])?n=!n:n||(o||("?"===a&&(t.IsTransform(e,i)||(s=!1)),"/"===a&&(t.IsTransform(e,i)||(s=!1))),"_"===a?t.IsTransform(e,i)||(s=!1,i++):"*"===a&&(t.IsTransform(e,i)||(s=!1))),s&&(r+=a);return r},t.IsTransform=function(t,o){if("\\"===t[o])throw new Error(e.SR.Exp_InvalidBackslash);if(o-1>0&&o-1<t.length&&"\\"===t[o-1]){if(o-2<0)return!0;if(o-2>0&&o-2<t.length)return"\\"!==t[o-2]}return!1},t.ContainsKeywords=function(e,t,o){var r,i,a,s;if(!e||e===b.Empty)return!1;if(o[e])return!0;var l,u="",c=!1,h=m;for(r=0;r<e.length;r++)'"'===(i=e[r])?c=!c:c||i!==n.UnderLine&&h!==n.UnderLine&&("E"!==i&&((l=i.charCodeAt(0))>=65&&l<=90&&(l|=32,i=String.fromCharCode(l))),u+=i),h=i;if(o[a=u])return!0;for(s=0;s<t.length;s++)if(a.indexOf(t[s])>=0)return!0;return!1},t.prototype.Format=function(e){return""},t.prototype.Parse=function(e){return m},t.prototype.FormatString=function(){return""},t.prototype.ExcelCompatibleFormatString=function(){return""},t.General="General",t.General_Lower="general",t._keywords=[t.General_Lower],t._keywordsSet={general:!0},t}(),i=function(){function t(t,o){var n=this;n.shortDatePattern="d",n.longDatePattern="D",n.FullDatePatternShortTime="f",n.FullDatePatternLongTime="F",n.GeneralDatePatternLongTimeShortTime="g",n.GeneralDatePatternLongTimeLongTime="G",n.MonthDayPattern1="m",n.MonthDayPattern2="M",n.RoundTripDatePattern1="o",n.RoundTripDatePattern2="O",n.RFC1123Pattern1="r",n.RFC1123Pattern2="R",n.SortableDatePattern="s",n.shortTimePattern="t",n.longTimePattern="T",n.UniversalSortableDatePattern="u",n.UniversalFullDatePattern="U",n.YearMonthPattern1="y",n.YearMonthPattern2="Y",n._cultureInfo=m,n._classNames=["StandardDateTimeFormatter","IFormatter"],n._formatString=t,o&&(n._cultureInfo=e._CultureInfo.getCulture(o))}return t.prototype.EvaluateFormat=function(e){var t=this;return e===t.shortDatePattern||e===t.longDatePattern||e===t.FullDatePatternShortTime||e===t.FullDatePatternLongTime||e===t.GeneralDatePatternLongTimeShortTime||e===t.GeneralDatePatternLongTimeLongTime||e===t.MonthDayPattern1||e===t.MonthDayPattern2||e===t.RoundTripDatePattern1||e===t.RoundTripDatePattern2||e===t.RFC1123Pattern1||e===t.RFC1123Pattern2||e===t.SortableDatePattern||e===t.shortTimePattern||e===t.longTimePattern||e===t.UniversalSortableDatePattern||e===t.UniversalFullDatePattern||e===t.YearMonthPattern1||e===t.YearMonthPattern2},t.prototype.Format=function(t){try{return t===_||t===m||""===t?"":new e._DateTimeHelper(t).localeFormat(this._formatString,this._cultureInfo)}catch(e){return t.toString()}},t.prototype.Parse=function(t){try{if(!t||""===t)return m;var o=e._DateTimeHelper.parseLocale(t,this._formatString,this._cultureInfo);return o||(o=new Date(t),isNaN(o.valueOf())?m:o)}catch(e){return new Date(t)}},t.prototype.FormatString=function(){return this._formatString},t.prototype.ExcelCompatibleFormatString=function(){var e="",t=n.DateTimeFormatInfo();switch(this.FormatString()){case"D":e=t.longDatePattern;break;case"d":e=t.shortDatePattern;break;case"F":e=t.fullDateTimePattern;break;case"f":e=t.longDatePattern+" "+t.shortTimePattern;break;case"G":e=t.shortDatePattern+" "+t.longTimePattern;break;case"g":e=t.shortDatePattern+" "+t.shortTimePattern;break;case"M":case"m":e=t.monthDayPattern;break;case"R":case"r":e=t.rfc1123Pattern;break;case"s":e=t.sortableDateTimePattern;break;case"T":e=t.longTimePattern;break;case"t":e=t.shortTimePattern;break;case"u":e=t.universalSortableDateTimePattern;break;case"U":e=t.fullDateTimePattern;break;case"Y":case"y":e=t.yearMonthPattern}return e?new L(e,m,m,m,m).ExcelCompatibleFormatString():m},t}(),e._StandardDateTimeFormatter=i,a=function(){function t(t,o){var n=this;n.CurrencyPattern1="c",n.CurrencyPattern2="C",n.DecimalPattern1="d",n.DecimalPattern2="D",n.ScientificPattern1="e",n.ScientificPattern2="E",n.FixedPointPattern1="f",n.FixedPointPattern2="F",n.GeneralPattern1="g",n.GeneralPattern2="G",n.NumberPattern1="n",n.NumberPattern2="N",n.PercentPattern1="p",n.PercentPattern2="P",n.RoundTripPattern1="r",n.RoundTripPattern2="R",n.HexadecimalPattern1="x",n.HexadecimalPattern2="X",n._classNames=["StandardNumberFormatter","IFormatter"],n._formatString=t,n._cultureInfo=m,o&&(n._cultureInfo=e._CultureInfo.getCulture(o))}return t.prototype.EvaluateFormat=function(e){var t,o=this;return!!(e&&e!==b.Empty&&e.length>0&&(t=e.substr(0,1),t===o.CurrencyPattern1||t===o.CurrencyPattern2||t===o.DecimalPattern1||t===o.DecimalPattern2||t===o.ScientificPattern1||t===o.ScientificPattern2||t===o.FixedPointPattern1||t===o.FixedPointPattern2||t===o.GeneralPattern1||t===o.GeneralPattern2||t===o.NumberPattern1||t===o.NumberPattern2||t===o.PercentPattern1||t===o.PercentPattern2||t===o.RoundTripPattern1||t===o.RoundTripPattern2||t===o.HexadecimalPattern1||t===o.HexadecimalPattern2))},t.prototype.Format=function(t){try{return t===m||t===_||""===t?"":new e._NumberHelper(t).localeFormat(this._formatString,this._cultureInfo)}catch(e){return t.toString()}},t.prototype.Parse=function(t){try{return t===m||t===_||""===t?m:e._NumberHelper.parseLocale(t)}catch(e){var o=parseFloat(t);return isNaN(o)||!isFinite(o)?m:o}},t.prototype.FormatString=function(){return this._formatString},t.prototype.GetPrecision=function(){var t,o,n=this.FormatString();return n&&n.length>0?(t=e.StringHelper.Remove(n,0,1),o=parseInt(t),isNaN(o)?m:o):m},t.AddDecimalPrecision=function(e,t,o){var r,i=e;if(o>0)for(i+=n.DecimalSeparator,r=0;r<o;r++)i+=t;return i},t.AddIntegralPrecision=function(e,t,o){var n,r,i=e;if(o>0){for(n="",r=0;r<o;r++)n+=t;i=n+i}return i},t.prototype.ExcelCompatibleFormatString=function(){var o,i,a,s,l=this,u=l.FormatString();return u?(o=n.NumberFormatInfo(),s=l.GetPrecision(),e.StringHelper.StartsWith(u,l.CurrencyPattern1,1)?(i=o.currencySymbol+"#,##0",a=s!==m?s:o.currencyDecimalDigits,t.AddDecimalPrecision(i,n.Zero,a)):e.StringHelper.StartsWith(u,l.DecimalPattern1,1)?(i="0",a=s!==m?s:1,t.AddIntegralPrecision(i,n.Zero,a-1)):e.StringHelper.StartsWith(u,l.ScientificPattern1,1)?(i="0","E+000",s!==m?t.AddDecimalPrecision(i,n.Zero,s)+"E+000":"0.########################################E+000"):e.StringHelper.StartsWith(u,l.FixedPointPattern1,1)?(i="0",a=s!==m?s:o.numberDecimalDigits,t.AddDecimalPrecision(i,n.Zero,a)):e.StringHelper.StartsWith(u,l.GeneralPattern1,1)?r.General:e.StringHelper.StartsWith(u,l.NumberPattern1,1)?(i="#,##0",a=s!==m?s:o.numberDecimalDigits,t.AddDecimalPrecision(i,n.Zero,a)):e.StringHelper.StartsWith(u,l.PercentPattern1,1)?(i="0",a=s!==m?s:o.numberDecimalDigits,t.AddDecimalPrecision(i,n.Zero,a)+n.percentSymbol):e.StringHelper.StartsWith(u,l.RoundTripPattern1,1)?r.General:e.StringHelper.StartsWith(u,l.HexadecimalPattern1,1)?r.General:m):m},t}(),e._StandardNumberFormatter=a,s=function(t){function o(e,o,i,a){var s;t.call(this,o,i,a),this._classNames=["NumberFormatText","IFormatter"],s=r.TrimNotSupportSymbol(e,!1),o&&(s=n.ReplaceKeyword(s,this.PartLocaleID().OriginalToken(),this.PartLocaleID().CurrencySymbol())),s=n.Filter(s,n.LeftSquareBracket,n.RightSquareBracket),s=n.TrimEscape(s),this._formatString=s}return __extends(o,t),o.prototype.Format=function(t){try{var o=e.Calc.Convert.S(t),n=e.StringHelper.Replace(this._formatString,'"',"");return n!==m&&n!==_&&(o=e.StringHelper.Replace(n,"@",o)),o}catch(e){return""}},o.prototype.Parse=function(e){return e||""},o.prototype.FormatString=function(){return this._formatString},o.EvaluateFormat=function(e){return!0},o.prototype.DefaultDateTimeNumberStringConverter=function(){},o}(r),l=function(){function e(e){this._innerFormatter=e}return e.prototype.FormatString=function(){return this._innerFormatter?this._innerFormatter.FormatString():""},e.prototype.innerFormatter=function(e){return 0===arguments.length?this._innerFormatter:(this._innerFormatter=e,this)},e.prototype.Parse=function(e){return this._innerFormatter?this._innerFormatter.Parse(e):e},e.prototype.Format=function(e){return this._innerFormatter?this._innerFormatter.Format(e):e===_||e===m?"":e.toString()},e.prototype.toJSON=function(){return this._innerFormatter.toJSON()},e.prototype.fromJSON=function(e){this._innerFormatter=new c(e.formatCached,e.formatModeType,e.customerCultureName)},e}(),e.AutoFormatter=l,u=function(){function t(t,o){var n=this;n.conditionFormatPart=m,n.colorFormatPart=m,n.localeIDFormatPart=m,n.dbNumberFormatPart=m,n.numberFormat=m,n.dateTimeFormatInfo=m,n.numberFormatInfo=m,n.formatCached=m,n._classNames=["CustomNumberFormat","IFormatter","IFormatProviderSupport"],o||(o=e._CultureInfo._currentCulture.Name()),0===arguments.length?(n.formatCached=r.General,n.numberFormat=new V):n.Init(t,o)}return t.prototype.Init=function(t,o){var r,i,a,l,u,c,h;if(t===m||t===_)throw new Error(e.SR.Exp_FormatIllegal);(r=this).formatCached=t;var p="",d="",f=!1,g=[];for(i=0;i<t.length;i++)if((a=t[i])===n.LeftSquareBracket){if(f)throw new Error(e.SR.Exp_FormatIllegal);d&&(p||(p=""),p+=d,d=""),d=a.toString(),f=!0}else if(a===n.RightSquareBracket){if(!f)throw new Error(e.SR.Exp_FormatIllegal);if(!d)throw new Error(e.SR.Exp_FormatIllegal);if(l=(d+=a).toString(),(u=e.util.asCustomType(T.Create(l),"FormatPartBase"))&&!e.util.isCustomType(u,"ABSTimeFormatPart"))r.AddPart(u);else{if(!e.util.isCustomType(u,"ABSTimeFormatPart"))throw new Error(e.SR.Exp_FormatIllegal);g.push(e.util.asCustomType(u,"ABSTimeFormatPart")),p+=d}d="",f=!1}else d+=a;if(d){if(f)throw new Error(e.SR.Exp_FormatIllegal);p+=d}if(r.localeIDFormatPart!==m&&(o=r.localeIDFormatPart.CultureInfo().Name()),c=p?p.toString():b.Empty,V.EvaluateFormat(c))r.numberFormat=new V(c,r.LocaleIDFormatPart(),r.dbNumberFormatPart,o);else if(L.EvaluateFormat(c))h=g.length>0?g:m,r.numberFormat=new L(c,h,r.LocaleIDFormatPart(),r.dbNumberFormatPart,o);else if(k.EvaluateFormat(c))r.numberFormat=new k(t,r.LocaleIDFormatPart(),r.dbNumberFormatPart,o);else{if(!s.EvaluateFormat(c))throw new Error(e.SR.Exp_FormatIllegal);r.numberFormat=new s(t,r.LocaleIDFormatPart(),r.dbNumberFormatPart,o)}},t.prototype.FormatString=function(){var e=this,t="";return e.numberFormat&&e.numberFormat.FormatString()&&(e.ColorFormatPart()&&(t+=e.ColorFormatPart().toString()),e.ConditionFormatPart()&&(t+=e.ConditionFormatPart().toString()),e.DBNumberFormatPart()&&(t+=e.DBNumberFormatPart().toString()),e.LocaleIDFormatPart()&&(t+=e.LocaleIDFormatPart().toString()),t+=e.numberFormat.FormatString()),t.toString()},t.prototype.ConditionFormatPart=function(){return this.conditionFormatPart},t.prototype.ColorFormatPart=function(){return this.colorFormatPart},t.prototype.LocaleIDFormatPart=function(){return this.localeIDFormatPart},t.prototype.DBNumberFormatPart=function(){return this.dbNumberFormatPart},t.prototype.NumberStringConverter=function(e){if(0===arguments.length)return this.numberFormat?this.numberFormat.NumberStringConverter():m;this.numberFormat&&this.numberFormat.NumberStringConverter(e)},t.prototype.ExcelCompatibleFormatString=function(){var t=this,o="";return t.numberFormat&&t.numberFormat.ExcelCompatibleFormatString()&&(e.util.isCustomType(t.numberFormat,"NumberFormatDigital")||(t.DBNumberFormatPart()&&(o+=t.DBNumberFormatPart().toString()),t.LocaleIDFormatPart()&&(o+=t.LocaleIDFormatPart().toString()),t.ConditionFormatPart()&&(o+=t.ConditionFormatPart().toString()),t.ColorFormatPart()&&(o+=t.ColorFormatPart().toString())),o+=t.numberFormat.ExcelCompatibleFormatString()),o.toString()},t.prototype.Formatter=function(){return this.numberFormat},t.prototype.DateTimeFormatInfo=function(e){return 0===arguments.length?this.Formatter().DateTimeFormatInfo():(this.Formatter().DateTimeFormatInfo(e),this.dateTimeFormatInfo=e,e)},t.prototype.NumberFormatInfo=function(e){return 0===arguments.length?this.Formatter().NumberFormatInfo():(this.Formatter().NumberFormatInfo(e),this.numberFormatInfo=e,e)},t.prototype.AddPart=function(t){if(!t)throw new Error(e.SR.Exp_PartIsNull);if(e.util.isCustomType(t,"ConditionFormatPart")){if(this.conditionFormatPart)throw new Error(e.SR.Exp_DuplicatedDescriptor);this.conditionFormatPart=e.util.asCustomType(t,"ConditionFormatPart")}else if(e.util.isCustomType(t,"ColorFormatPart")){if(this.colorFormatPart)throw new Error(e.SR.Exp_DuplicatedDescriptor);this.colorFormatPart=e.util.asCustomType(t,"ColorFormatPart")}else if(e.util.isCustomType(t,"LocaleIDFormatPart")){if(this.localeIDFormatPart)throw new Error(e.SR.Exp_DuplicatedDescriptor);this.localeIDFormatPart=e.util.asCustomType(t,"LocaleIDFormatPart")}else if(e.util.isCustomType(t,"DBNumberFormatPart")){if(this.dbNumberFormatPart)throw new Error(e.SR.Exp_DuplicatedDescriptor);this.dbNumberFormatPart=e.util.asCustomType(t,"DBNumberFormatPart")}},t.prototype.Format=function(e){return this.numberFormat.Format(e)},t.prototype.Parse=function(e){return this.numberFormat.Parse(e)},t}(),c=function(){function t(t,o,n){var i,a=this;a.formatters=m,a.formatModeType=0,a.dateTimeFormatInfo=m,a.numberFormatInfo=m,a.isSingleFormatterInfo=!0,a.isDefault=!0,a.isConstructed=!1,a.cultureName=m,a.isCustomCultureSetted=!1,a.PropertyChanged=[],a._classNames=["GeneralFormatter","IFormatter","INotifyPropertyChanged","IColorFormatter"],b.IsNullOrEmpty(t)&&(t=r.General),o||(o=0),a.formatCached=t,a.formatModeType=o,a.isDefault=a.formatCached.toLowerCase()===r.General_Lower,a.isConstructed=!1,n?(i=e._CultureInfo.getCulture(n),a.cultureName=i.Name(),a.numberFormatInfo=i.NumberFormat(),a.dateTimeFormatInfo=i.DateTimeFormat(),a.isCustomCultureSetted=!0):a.cultureName=e._CultureInfo._currentCulture.Name()}return t._needChangeDefaultFormat=function(t){if(t){var o=e._CultureInfo._currentCulture.Name().toLowerCase();return t.cultureName.toLowerCase()!==o&&!t.isCustomCultureSetted}return!0},t.DefaultNumberFormatter=function(e){return t._needChangeDefaultFormat(this.defaultNumberFormatter)&&(this.defaultNumberFormatter=new t("###################0.################",0,e)),this.defaultNumberFormatter},t.DefaultGeneralFormatter=function(e){return t._needChangeDefaultFormat(this.defaultGeneralFormatter)&&(this.defaultGeneralFormatter=new t(m,m,e)),this.defaultGeneralFormatter},t.DefaultShortDatePatternFormatter=function(e){return t._needChangeDefaultFormat(this.defaultShortDatePatternFormatter)&&(this.defaultShortDatePatternFormatter=new t(n.DateTimeFormatInfo().shortDatePattern,m,e)),this.defaultShortDatePatternFormatter},t.DefaultSXDatetimePatternFormatter=function(e){var o=n.DateTimeFormatInfo().shortDatePattern+" h:mm:ss";return t._needChangeDefaultFormat(this.defaultSXDatetimePatternFormatter)&&(this.defaultSXDatetimePatternFormatter=new t(o,m,e)),this.defaultSXDatetimePatternFormatter},t.DefaultLongTimePatternFormatter=function(e){var o=n.DateTimeFormatInfo().longTimePattern;return t._needChangeDefaultFormat(this.defaultLongTimePatternFormatter)&&(this.defaultLongTimePatternFormatter=new t(o,m,e)),this.defaultLongTimePatternFormatter},t.DefaultDMMMFormatter=function(e){return t._needChangeDefaultFormat(this.defaultDMMMFormatter)&&(this.defaultDMMMFormatter=new t("d-mmm",0,e)),this.defaultDMMMFormatter},t.DefaultMMMYYFormatter=function(e){return t._needChangeDefaultFormat(this.defaultMMMYYFormatter)&&(this.defaultMMMYYFormatter=new t("mmm-yy",0,e)),this.defaultMMMYYFormatter},t.DefaultHMMFormatter=function(e){return t._needChangeDefaultFormat(this.defaultHMMFormatter)&&(this.defaultHMMFormatter=new t("h:mm",0,e)),this.defaultHMMFormatter},t.DefaultHMMSSFormatter=function(e){return t._needChangeDefaultFormat(this.defaultHMMSSFormatter)&&(this.defaultHMMSSFormatter=new t("h:mm:ss",0,e)),this.defaultHMMSSFormatter},t.DefaultHMMSS0Formatter=function(e){return t._needChangeDefaultFormat(this.defaultHMMSS0Formatter)&&(this.defaultHMMSS0Formatter=new t("h:mm:ss.0",0,e)),this.defaultHMMSS0Formatter},t.DefaultComboNumberFormatter1=function(e){return t._needChangeDefaultFormat(this.defaultComboNumberFormatter1)&&(this.defaultComboNumberFormatter1=new t(b.Format("{0}#,##0.00;[Red]({0}#,##0.00)",n.NumberFormatInfo().currencySymbol),m,e)),this.defaultComboNumberFormatter1},t.DefaultComboNumberFormatter2=function(e){return t._needChangeDefaultFormat(this.defaultComboNumberFormatter2)&&(this.defaultComboNumberFormatter2=new t(b.Format("{0}#,##0;[Red]({0}#,##0)",n.NumberFormatInfo().currencySymbol),m,e)),this.defaultComboNumberFormatter2},t.DefaultStandardNumberFormatter=function(e){return t._needChangeDefaultFormat(this.defaultStandardNumberFormatter)&&(this.defaultStandardNumberFormatter=new t("0.00E+00",0,e)),this.defaultStandardNumberFormatter},t.DefaultStandardPercentFormatter1=function(e){return t._needChangeDefaultFormat(this.defaultStandardPercentFormatter1)&&(this.defaultStandardPercentFormatter1=new t("0.00%",0,e)),this.defaultStandardPercentFormatter1},t.DefaultStandardPercentFormatter2=function(e){return t._needChangeDefaultFormat(this.defaultStandardPercentFormatter2)&&(this.defaultStandardPercentFormatter2=new t("0%",0,e)),this.defaultStandardPercentFormatter2},t.DefaultStandardGroupNumberFormatter1=function(e){return t._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter1)&&(this.defaultStandardGroupNumberFormatter1=new t("#,##0.00",0,e)),this.defaultStandardGroupNumberFormatter1},t.DefaultStandardGroupNumberFormatter2=function(e){return t._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter2)&&(this.defaultStandardGroupNumberFormatter2=new t("#,##0",0,e)),this.defaultStandardGroupNumberFormatter2},t.prototype.findDateTimeGeneralFormatter=function(t,o,n,r){var i,a,s;if(n&&n.length>0)for(i in n)if(n.hasOwnProperty(i)&&(a=n[i],(s=e._DateTimeHelper.parseLocale(t,a))&&s-o==0))return r();return m},t.prototype.toJSON=function(){var e,t,o,n={formatModeType:this.formatModeType,formatCached:this.formatCached};for(t in this.isCustomCultureSetted&&(n.customerCultureName=this.cultureName),e={},n)o=n[t],this._isDefaultValue(t,o)||(e[t]=o);return e},t.prototype._isDefaultValue=function(e,t){switch(e){case"formatModeType":return 0===t;case"formatCached":return"General"===t;default:return!1}},t.prototype.HasFormatedColor=function(){return!this.isDefault&&(!(!this.PositiveExpression()||!this.PositiveExpression().ColorFormatPart())||(!(!this.NegativeExpression()||!this.NegativeExpression().ColorFormatPart())||(!(!this.ZeroExpression()||!this.ZeroExpression().ColorFormatPart())||!(!this.TextExpression()||!this.TextExpression().ColorFormatPart()))))},t.prototype.IsDefaultFormat=function(){return this.isDefault},t.prototype.FormatString=function(t){var o,i,a,s=this;if(0===arguments.length){switch(s.Init(),o=m,s.FormatMode()){case 0:if(s.formatters)for(i=0;i<s.formatters.length;i++)a=s.formatters[i],e.util.isCustomType(a,"CustomNumberFormat")&&(o==m?o="":o+=n.FormatSeparator,o+=a.FormatString());break;case 1:if(e.util.isCustomType(s.formatters[0],"StandardDateTimeFormatter"))return s.formatters[0].FormatString();break;case 2:if(e.util.isCustomType(s.formatters[0],"StandardNumberFormatter"))return s.formatters[0].FormatString()}return o||b.Empty}if(!t)throw new Error(e.SR.Exp_ValueIsNull);s.formatters=m,s.formatCached=t,s.isDefault=s.formatCached.toLowerCase()===r.General_Lower,s.isConstructed=!1,s.Init(),s.RaisePropertyChanged("FormatString")},t.prototype.DateTimeFormatInfo=function(t){var o,r;if(0===arguments.length)return this.Init(),this.dateTimeFormatInfo?this.dateTimeFormatInfo:n.DateTimeFormatInfo();if(this.Init(),this.dateTimeFormatInfo=t,this.formatters)for(o=0;o<this.formatters.length;o++)r=this.formatters[o],e.util.isCustomType(r,"IFormatProviderSupport")&&r.DateTimeFormatInfo(t);return this.RaisePropertyChanged("DateTimeFormatInfo"),t},t.prototype.NumberFormatInfo=function(t){var o,r;if(0===arguments.length)return this.Init(),this.numberFormatInfo?this.numberFormatInfo:n.NumberFormatInfo();if(this.Init(),this.numberFormatInfo=t,this.formatters)for(o=0;o<this.formatters.length;o++)r=this.formatters[o],e.util.isCustomType(r,"IFormatProviderSupport")&&r.NumberFormatInfo(t);return this.RaisePropertyChanged("NumberFormatInfo"),t},t.prototype.FormatMode=function(e){return 0===arguments.length?this.formatModeType:(this.formatModeType=e,this.RaisePropertyChanged("FormatMode"),e)},t.prototype.ExcelCompatibleFormatString=function(){var t,o,r;switch(this.Init(),t=m,this.FormatMode()){case 0:if(this.formatters)for(o=0;o<this.formatters.length;o++)r=this.formatters[o],e.util.isCustomType(r,"CustomNumberFormat")&&(t==m?t="":t+=n.FormatSeparator,t+=r.ExcelCompatibleFormatString());break;case 1:if(e.util.isCustomType(this.formatters[0],"StandardDateTimeFormatter"))return this.formatters[0].ExcelCompatibleFormatString();break;case 2:if(e.util.isCustomType(this.formatters[0],"StandardNumberFormatter"))return this.formatters[0].ExcelCompatibleFormatString()}return t?t.toString():b.Empty},t.prototype.PositiveExpression=function(){return this.Init(),this.formatters&&this.formatters.length>0?e.util.asCustomType(this.formatters[0],"CustomNumberFormat"):m},t.prototype.NegativeExpression=function(){return this.Init(),this.formatters&&this.formatters.length>1?e.util.asCustomType(this.formatters[1],"CustomNumberFormat"):m},t.prototype.ZeroExpression=function(){return this.Init(),this.formatters&&this.formatters.length>2?e.util.asCustomType(this.formatters[2],"CustomNumberFormat"):m},t.prototype.TextExpression=function(){return this.Init(),this.formatters&&this.formatters.length>3?e.util.asCustomType(this.formatters[3],"CustomNumberFormat"):m},t.prototype.GetFormatType=function(t){var o,n;if(this.Init(),o=this.GetFormatInfo(t),e.util.isCustomType(o,"CustomNumberFormat")){if(n=o.Formatter(),e.util.isCustomType(n,"NumberFormatDigital"))return 1;if(e.util.isCustomType(n,"NumberFormatDateTime"))return 2;if(e.util.isCustomType(n,"NumberFormatText"))return 3}else{if(e.util.isCustomType(o,"NumberFormatDigital")||e.util.isCustomType(o,"StandardNumberFormatter"))return 1;if(e.util.isCustomType(o,"NumberFormatDateTime")||e.util.isCustomType(o,"StandardDateTimeFormatter"))return 2;if(e.util.isCustomType(o,"NumberFormatText"))return 3}return 0},t.prototype.GetPreferredEditingFormatter=function(o){var n,r;return this.Init(),n=this.isCustomCultureSetted?this.cultureName:_,e.util.isType(o,"DateTime")?0===(r=new e._DateTimeHelper(o)).Hour()&&0===r.Minute()&&0===r.Second()&&0===r.Millisecond()?t.DefaultShortDatePatternFormatter(n):t.DefaultSXDatetimePatternFormatter(n):e.util.isType(o,"TimeSpan")?t.DefaultLongTimePatternFormatter(n):e.FormatConverter.IsNumber(o)?e.FormatConverter.ToDouble(o)>1e20?new t("0.##E+00",0,n):t.DefaultNumberFormatter(n):(e.util.isType(o,"string"),t.DefaultGeneralFormatter(n))},t.prototype.GetPreferredDisplayFormatter=function(o,r){var i,a,s,l,u=this;if(r||(r={value:m}),r.value=m,u.Init(),i=this.isCustomCultureSetted?this.cultureName:_,b.IsNullOrEmpty(o))return new t(m,m,i);if(a=o,s=r.value=u.Parse(a),e.util.isType(s,"DateTime")||e.util.isType(s,"TimeSpan")){if((l=u.findDateTimeGeneralFormatter(o,s,V.GeneralMonthDay(),function(){return t.DefaultDMMMFormatter(i)}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralYearMonth(),function(){return t.DefaultMMMYYFormatter(i)}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralYearMonthDay(),function(){return t.DefaultShortDatePatternFormatter(i)}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralHourMinute(),function(){return t.DefaultHMMFormatter(i)}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralHourMinuteSecond(),function(){return t.DefaultHMMSSFormatter(i)}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralHourMinuteSecondSubSecond(),function(){return t.DefaultHMMSS0Formatter(i)}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralHourMinuteWithDate(),function(){return t._needChangeDefaultFormat(t.defaultShortDatePatternHMMFormatter)&&(t.defaultShortDatePatternHMMFormatter=new t(u.DateTimeFormatInfo().shortDatePattern+" h:mm",m,i)),t.defaultShortDatePatternHMMFormatter}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralHourMinuteSecondWithDate(),function(){return t._needChangeDefaultFormat(t.defaultShortDatePatternHMMSSFormatter)&&(t.defaultShortDatePatternHMMSSFormatter=new t(u.DateTimeFormatInfo().shortDatePattern+" h:mm:ss",m,i)),t.defaultShortDatePatternHMMSSFormatter}))||(l=u.findDateTimeGeneralFormatter(o,s,V.GeneralHourMinuteSecondSubSecondWithDate(),function(){return t._needChangeDefaultFormat(t.defaultShortDatePatternHMMSS0Formatter)&&(t.defaultShortDatePatternHMMSS0Formatter=new t(u.DateTimeFormatInfo().shortDatePattern+" h:mm:ss.0",m,i)),t.defaultShortDatePatternHMMSS0Formatter})))return l}else if(e.FormatConverter.IsNumber(s)){var c=n.NumberFormatInfo(),h=c&&c.numberDecimalSeparator||n.DecimalSeparator,p=c&&c.numberGroupSeparator||n.numberGroupSeparator;if(a[0]===n.NumberFormatInfo().currencySymbol[0])return e.StringHelper.Contains(a,h)?t.DefaultComboNumberFormatter1(i):t.DefaultComboNumberFormatter2(i);if(e.StringHelper.IndexOf(a,"e",1)>-1)return t.DefaultStandardNumberFormatter(i);if(a[0].toString()===n.percentSymbol||a[a.length-1].toString()===n.percentSymbol)return e.StringHelper.Contains(a,h)?t.DefaultStandardPercentFormatter1(i):t.DefaultStandardPercentFormatter2(i);if(e.StringHelper.Contains(a,p))return e.StringHelper.Contains(a,h)?t.DefaultStandardGroupNumberFormatter1(i):t.DefaultStandardGroupNumberFormatter2(i)}return t.DefaultGeneralFormatter(i)},t.prototype.Format=function(t,o){var r,i,a,s,l,u;if(e.util.isType(t,"boolean"))return t.toString().toUpperCase();if(o&&(o.value=m),this.Init(),r=this.GetFormatInfo(t),e.util.isCustomType(r,"CustomNumberFormat")&&(i=r.ColorFormatPart(),o&&i&&(o.value=i.ForeColor())),a=0,(s=e.FormatConverter.IsNumber(t,this.NumberFormatInfo()))&&(a=e.FormatConverter.ToDouble(t)),r){if(l=m,s&&r===this.NegativeExpression())l=r.Format(y(a)),e.util.isCustomType(r,"CustomNumberFormat")&&((u=e.util.asCustomType(r,"CustomNumberFormat"))&&u.ConditionFormatPart()&&u.ConditionFormatPart().Value()>0&&a<0&&(l=n.negativeSign+l));else try{l=r.Format(t)}catch(o){e.util.isType(t,"string")&&(l=t.toString())}return l||b.Empty}return s&&a<0?n.HyphenMinus.toString():e.util.isType(t,"string")?t.toString():t===_||t===m?b.Empty:t.toString()},t.prototype.Parse=function(e){return this.Init(),this.formatters&&this.formatters.length>0?this.formatters[0].Parse(e):m},t.prototype.Init=function(){if(!this.isConstructed)switch(this.isConstructed=!0,this.formatModeType){case 0:this.InitExcelCompatibleMode(this.formatCached);break;case 1:this.InitStandardDateTimeMode(this.formatCached);break;case 2:this.InitStandardNumericMode(this.formatCached)}},t.prototype.InitStandardDateTimeMode=function(t){var o=new i(t,this.isCustomCultureSetted?this.cultureName:m);if(!o.EvaluateFormat(t))throw new Error(e.SR.Exp_FormatIllegal);this.formatters=[],this.formatters.push(o)},t.prototype.InitStandardNumericMode=function(t){var o=new a(t,this.isCustomCultureSetted?this.cultureName:m);if(!o.EvaluateFormat(t))throw new Error(e.SR.Exp_FormatIllegal);this.formatters=[],this.formatters.push(o)},t.prototype.InitExcelCompatibleMode=function(t){var o,r,i,a;if(b.IsNullOrEmpty(t))throw new Error(e.SR.Exp_FormatIllegal);if(this,this.formatters=[],this.isDefault)this.formatters.push(new u);else{if(this.isSingleFormatterInfo=!e.StringHelper.Contains(t,n.FormatSeparator.toString()),!(o=t.split(n.FormatSeparator)))throw new Error(e.SR.Exp_FormatIllegal);if(o.length<1||o.length>5)throw new Error(e.SR.Exp_FormatIllegal);for(r=0,i=0;i<o.length&&!(++r>4);i++)(a=new u(o[i],this.isCustomCultureSetted?this.cultureName:m))&&this.formatters.push(a);if(!this.PositiveExpression())throw new Error(e.SR.Exp_FormatIllegal)}},t.prototype.GetFormatInfo=function(t){var o=this;if(0===o.FormatMode()){if("string"==typeof t&&isNaN(t))return o.TextExpression()?o.TextExpression():o.PositiveExpression();if(e.FormatConverter.IsNumber(t,this.NumberFormatInfo())||e.util.isType(t,"boolean")){var n=o.PositiveExpression(),r=o.NegativeExpression(),i=e.FormatConverter.ToDouble(t),a=n&&n.ConditionFormatPart(),s=r&&r.ConditionFormatPart(),l=o.isSingleFormatterInfo?n:m;return n&&(a?n.ConditionFormatPart().IsMeetCondition(i)&&(l=n):(i>0||0===i&&!o.ZeroExpression())&&(l=n)),!l&&o.NegativeExpression()&&(s?r.ConditionFormatPart().IsMeetCondition(i)&&(l=r):i<0&&(l=r)),!l&&o.ZeroExpression()&&0===i&&(l=o.ZeroExpression()),!l&&o.ZeroExpression()&&(l=o.ZeroExpression()),!l&&o.NegativeExpression()&&(l=o.NegativeExpression()),l}}else if((1===o.FormatMode()||2===o.FormatMode())&&o.formatters&&1===o.formatters.length)return o.formatters[0];return m},t.prototype.RaisePropertyChanged=function(e){var t,o;if(this.PropertyChanged)for(t=0;t<this.PropertyChanged.length;t++)"function"==typeof(o=this.PropertyChanged[t])&&o(this,e)},t.defaultNumberFormatter=m,t.defaultGeneralFormatter=m,t.defaultShortDatePatternFormatter=m,t.defaultLongTimePatternFormatter=m,t.defaultSXDatetimePatternFormatter=m,t.defaultDMMMFormatter=m,t.defaultMMMYYFormatter=m,t.defaultHMMFormatter=m,t.defaultHMMSSFormatter=m,t.defaultHMMSS0Formatter=m,t.defaultShortDatePatternHMMFormatter=m,t.defaultShortDatePatternHMMSSFormatter=m,t.defaultShortDatePatternHMMSS0Formatter=m,t.defaultComboNumberFormatter1=m,t.defaultComboNumberFormatter2=m,t.defaultStandardNumberFormatter=m,t.defaultStandardPercentFormatter1=m,t.defaultStandardPercentFormatter2=m,t.defaultStandardGroupNumberFormatter1=m,t.defaultStandardGroupNumberFormatter2=m,t}(),e.GeneralFormatter=c;var T=function(){function e(e){this._classNames=["FormatPartBase"],this.originalToken=e}return e.prototype.OriginalToken=function(){return this.originalToken},e.prototype.SupportedPartFormat=function(){return e._supportedPartFormat||(e._supportedPartFormat=["ConditionFormatPart","ColorFormatPart","LocaleIDFormatPart"]),e._supportedPartFormat},e.Create=function(e){return A.EvaluateFormat(e)?new A(e):M.EvaluateFormat(e)?new M(e):O.EvaluateFormat(e)?new O(e):D.EvaluateFormat(e)?new D(e):I.EvaluateFormat(e)?new I(e):m},e}(),A=function(t){function o(o){var r,i,a,s;if(t.call(this,o),r=this,T.call(r,o),r._classNames.push("ConditionFormatPart"),r._initFileds(),i=n.TrimSquareBracket(o),b.IsNullOrEmpty(i))throw new Error(e.SR.Exp_TokenIllegal);for(var l="",u=0,c=m;u<i.length&&(c=i[u],n.IsOperator(c));u++)l+=c;if(!l)throw new Error(e.SR.Exp_TokenIllegal);switch(a=l,l="",a){case"<":r.compareOperator=4;break;case"<=":r.compareOperator=5;break;case"=":r.compareOperator=0;break;case">=":r.compareOperator=3;break;case">":r.compareOperator=2;break;case"<>":r.compareOperator=1;break;default:throw new Error(e.SR.Exp_TokenIllegal)}for(;u<i.length;u++){if(c=i[u],n.IsOperator(c))throw new Error(e.SR.Exp_TokenIllegal);l+=c}if(!l)throw new Error(e.SR.Exp_TokenIllegal);if(s=parseFloat(l),isNaN(s))throw new Error(e.SR.Exp_TokenIllegal);r.value=s}return __extends(o,t),o.prototype._initFileds=function(){this.value=0,this.compareOperator=m},o.prototype.CompareOperator=function(){return this.compareOperator},o.prototype.Value=function(){return this.value},o.prototype.toString=function(){var e="";switch(this.compareOperator){case 0:e+="=";break;case 2:e+=">";break;case 3:e+=">=";break;case 4:e+="<";break;case 5:e+="<=";break;case 1:e+="<>";break;default:throw new Error}return e+=this.value.toString(),n.AddSquareBracket(e)},o.prototype.IsMeetCondition=function(e){switch(this.compareOperator){case 0:return e===this.value;case 2:return e>this.value;case 3:return e>=this.value;case 4:return e<this.value;case 5:return e<=this.value;case 1:return e!==this.value}return!1},o.EvaluateFormat=function(e){if(!e||e===b.Empty)return!1;var t=n.TrimSquareBracket(e);return!(!t||t===b.Empty)&&n.IsOperator(t[0])},o}(T),I=function(t){function o(o){var r,i,a;if(t.call(this,o),this.foreColor="black",this.index=-1,this.colorName=m,this,T.call(this,o),this._classNames.push("ColorFormatPart"),!(r=n.TrimSquareBracket(o))||r===b.Empty)throw new Error(e.SR.Exp_TokenIllegal);try{return this.foreColor=r,void(this.colorName=r)}catch(e){}if(!(r.length>5)||(r=e.StringHelper.Remove(r,0,5),i=-1,a=parseInt(r,10),isNaN(a)||!((i=a)>=1&&i<=56)))throw new Error(e.SR.Exp_TokenIllegal)}return __extends(o,t),o.prototype.ForeColor=function(){return this.foreColor},o.prototype.toString=function(){if(this.index>-1)return n.AddSquareBracket("Color"+this.index);if(this.colorName)return n.AddSquareBracket(this.colorName);throw new Error},o.EvaluateFormat=function(t){if(!t||t===b.Empty)return!1;var o=n.TrimSquareBracket(t);return!(!o||o===b.Empty)&&(!(o.length<3)&&(isNaN(t[t.length-1])?t[0]!==t[1]:e.StringHelper.StartsWith(t,"Color",1)))},o}(T),D=function(t){function o(n){var r,i,a;if(t.call(this,n),r=this,T.call(r,n),r._classNames.push("ABSTimeFormatPart"),r._initFileds(),!o.EvaluateFormat(n))throw new Error(e.SR.Exp_TokenIllegal);if(r.token=n.toLowerCase(),r.token[1]===o.HoursABSContent)r.type=0;else if(r.token[1]===o.MinuteABSContent)r.type=1;else{if(r.token[1]!==o.SecondABSContent)throw new Error(e.SR.Exp_TokenIllegal);r.type=2}for(i="",a=0;a<r.token.length-2;a++)i+="0";r.formatString=i}return __extends(o,t),o.prototype._initFileds=function(){this.token=m,this.type=m,this.formatString=m},o.prototype.FormatString=function(){return this.formatString},o.prototype.TimePartType=function(){return this.type},o.prototype.Token=function(){return this.token},o.EvaluateFormat=function(e){var t,r,i,a;if(!e||e===b.Empty||(!(t=n.TrimSquareBracket(e))||t===b.Empty))return!1;for(t=t.toLowerCase(),r=m,i=0;i<t.length;i++)if(r||(r=t[i]),r!==(a=o).HoursABSContent&&r!==a.MinuteABSContent&&r!==a.SecondABSContent||r!==t[i])return!1;return!0},o.HoursABSContent="h",o.MinuteABSContent="m",o.SecondABSContent="s",o}(T),F=function(){function e(e,t){var o,n;if(this._classNames=["DBNumber"],m,o=m,e)for(this.units=[],n=0;n<e.length;n++)0===(o=e[n])?this.units.push(b.Empty):this.units.push(String.fromCharCode(o));if(t)for(this.numbers=[],n=0;n<t.length;n++)0===(o=t[n])?this.numbers.push(b.Empty):this.numbers.push(String.fromCharCode(o))}return e.ChineseDBNum1=function(){return e.chineseDBNum1||(e.chineseDBNum1=new e(e.ChineseNumberUnitLetter1,e.ChineseNumberLetterValues1)),e.chineseDBNum1},e.ChineseDBNum2=function(){return e.chineseDBNum2||(e.chineseDBNum2=new e(e.ChineseNumberUnitLetter2,e.ChineseNumberLetterValues2)),e.chineseDBNum2},e.ChineseDBNum3=function(){return e.chineseDBNum3||(e.chineseDBNum3=new e(m,e.ChineseNumberLetterValues3)),e.chineseDBNum3},e.JapaneseDBNum1=function(){return e.japaneseDBNum1||(e.japaneseDBNum1=new e(e.JapaneseNumberUnitLetter1,e.JapaneseNumberLetterValues1)),e.japaneseDBNum1},e.JapaneseDBNum2=function(){return e.japaneseDBNum2||(e.japaneseDBNum2=new e(e.JapaneseNumberUnitLetter2,e.JapaneseNumberLetterValues2)),e.japaneseDBNum2},e.JapaneseDBNum3=function(){return e.japaneseDBNum3||(e.japaneseDBNum3=new e(m,e.JapaneseNumberLetterValues3)),e.japaneseDBNum3},e.prototype.Units=function(){return this.units},e.prototype.Numbers=function(){return this.numbers},e.chineseDBNum1=m,e.chineseDBNum2=m,e.chineseDBNum3=m,e.ChineseNumberUnitLetter1=[20806,21315,30334,21313,20159,21315,30334,21313,19975,21315,30334,21313,0],e.ChineseNumberUnitLetter2=[20806,20191,20336,25342,20159,20191,20336,25342,19975,20191,20336,25342,0],e.ChineseNumberLetterValues1=[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],e.ChineseNumberLetterValues2=[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],e.ChineseNumberLetterValues3=[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],e.japaneseDBNum1=m,e.japaneseDBNum2=m,e.japaneseDBNum3=m,e.JapaneseNumberUnitLetter1=[20806,21315,30334,21313,20740,21315,30334,21313,19975,21315,30334,21313,0],e.JapaneseNumberUnitLetter2=[20806,38433,30334,25342,20740,38433,30334,25342,33836,38433,30334,25342,0],e.JapaneseNumberLetterValues1=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],e.JapaneseNumberLetterValues2=[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],e.JapaneseNumberLetterValues3=[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],e}(),M=function(t){function o(r){var i,a;if(t.call(this,r),this.token=m,this.type=0,this,this._classNames.push("DBNumberFormatPart"),!o.EvaluateFormat(r))throw new Error(e.SR.Exp_TokenIllegal);if(this.token=r,i=n.TrimSquareBracket(r),a=e.StringHelper.Remove(i,0,5),this.type=parseInt(a,10),this.type<0||this.type>3)throw new Error(e.SR.Exp_TokenIllegal)}return __extends(o,t),o.prototype.Token=function(){return this.token?this.token:b.Empty},o.prototype.Type=function(){return this.type},o.prototype.ReplaceNumberString=function(t,o,r){var i,a;if(!t||t===b.Empty)return t;var s=t,l=t,u=-1,c=-1,h=!1,p=m,d=m,f=m;for(i=t.length-1;i>=0;i--)a=l[i],!isNaN(a)||n.IsEquals(a,n.DecimalSeparator,!1)&&!h?(n.IsEquals(a,n.DecimalSeparator,!1)&&(h=!0),-1===u&&(u=i),c=i):c>-1&&u>-1&&(p=l.substr(c,u-c+1),d=parseFloat(p),isNaN(d)||(f=this.NumberString(p,o,r),s=e.StringHelper.Remove(s,c,u-c+1),s=e.StringHelper.Insert(s,c,f)),u=-1,c=-1,h=!1);return c>-1&&u>-1&&(p=l.substr(c,u-c+1),d=parseFloat(p),isNaN(d)||(f=this.NumberString(p,o,r),s=e.StringHelper.Remove(s,c,u-c+1),s=e.StringHelper.Insert(s,c,f)),u=-1,c=-1,h=!1),s},o.prototype.NumberString=function(t,n,r){var i=t.split(".");if(i){if(1===i.length)return o.FormatNumberString(i[0],n.Numbers(),r?n.Units():m);if(2===i.length)return o.FormatNumberString(i[0],n.Numbers(),r?n.Units():m)+"."+o.FormatNumberString(i[1],n.Numbers())}throw new Error(e.SR.Exp_ValueIllegal)},o.prototype.toString=function(){if(this.type>-1)return n.AddSquareBracket("DBNum"+this.type);throw new Error},o.EvaluateFormat=function(t){if(!t||t===b.Empty)return!1;var o=n.TrimSquareBracket(t);return!(!o||o===b.Empty)&&!!e.StringHelper.StartsWith(o,"DBNum",1)},o.FormatNumberString=function(e,t,n){var r,i,a,s,l,u,c,h,p=e,d=0,f=m,g=0;if(2===arguments.length){for(r="",d=0;d<p.length;d++)f=p.substr(d,1),r+=t[g=parseInt(f,10)];return r}if(3===arguments.length){if(!n)return o.FormatNumberString(e,t);var _=0,y="",C=p.length,w=!1,v=[];for(d=0;d<C;d++)(i=n.length-1-d)>-1?v.push(n[i].toString()):v.push(b.Empty);for(a=[],l=v.length-1;l>=0;l--)a[v.length-l-1]=v[l];for(v=a,s=!1,l=0;l<C;l++)f=p.substr(l,1),g=parseInt(f,10),u=b.Empty,c=b.Empty,C-l-16>0?(u=t[g],c="",s=!0):l!==C-1&&l!==C-5&&l!==C-9&&l!==C-13?"0"===f?(u="",c="",_+=1):"0"!==f&&0!==_?(u=t[0]+t[g],c=v[l],_=0):(u=t[g],c=v[l],_=0):"0"!==f&&0!==_?(u=t[0]+t[g],c=v[l],_=0):"0"!==f&&0===_||s?(u=t[g],c=v[l],_=0,s=!1):"0"===f&&_>=3?(u="",c="",_+=1):C>=11?(u="",_+=1):(u="",c=v[l],_+=1),u+c===b.Empty||(w=!1),l!==C-13||w||(c=v[l],w=!0),l!==C-9||w||(c=v[l],w=!0),l===C-1&&(c=v[l],w=!0),y=y+u+c;return h=parseInt(e,10),isNaN(h)||0!==h?y:t[0]}},o}(T),E=function(){function t(){}return t.ParseHexString=function(t){if(!t||t===b.Empty)throw new Error(e.SR.Exp_StringIllegal);return parseInt(t,16)},t.FixJapaneseChars=function(e){return e},t.GetFraction=function(e,t,o,n,r){var i,a,s,l,u,c=0,h=0,p=0,d=0;for(e>0?1==(d=e-C(e)+1)?(d=0,c=e):c=C(e)-1:e<0&&(c=C(e),d=C(e)-e),i=2,a=9,(i=w(10,t-1))<2&&(i=2),(a=w(10,t)-1)<2&&(a=2),s=!1,l=0,u=i;u<=a;u++){var f=R(u*d),g=f/u,m=y(g-d);if((!s||m<y(l-d))&&(s=!0,l=g,h=f,p=u,m<1e-5))break}return o.value=c,n.value=h,r.value=p,s},t}(),N=function(){function t(){}return t.AllowScience=function(e){return!e||!(0===e.indexOf("ja")||0===e.indexOf("zh"))},t.CreateCultureInfo=function(o){switch(o){case 1033:return e._CultureInfo.getCulture(t.EnglishUnitedStates);case 1041:return e._CultureInfo.getCulture(t.JapanneseJapan);case 2052:return e._CultureInfo.getCulture(t.ChinesePRC);default:return e._CultureInfo.currentCulture()}},t.JapanneseJapan="ja-JP",t.EnglishUnitedStates="en-US",t.ChinesePRC="zh-cn",t}(),O=function(t){function o(o){var r,i;if(t.call(this,o),this.currencySymbol=m,this.locateID=-1,this.cultureInfo=m,this.content=m,this,T.call(this,o),this._classNames.push("LocaleIDFormatPart"),!o)throw new Error(e.SR.Exp_TokenIsNull);if(o===b.Empty)throw new Error(e.SR.Exp_TokenIllegal);if(this.content=n.TrimSquareBracket(o),!(r=this.content)||r===b.Empty)throw new Error(e.SR.Exp_TokenIllegal);if(!n.IsEquals(r[0],n.Dollar,!1))throw new Error(e.SR.Exp_TokenIllegal);if((i=(r=e.StringHelper.Remove(r,0,1)).indexOf(n.HyphenMinus))>-1){if(this.currencySymbol=r.substr(0,i),r=e.StringHelper.Remove(r,0,i),!n.IsEquals(r[0],n.HyphenMinus,!1))throw new Error(e.SR.Exp_TokenIllegal);if(!((r=e.StringHelper.Remove(r,0,1)).length>0))throw new Error(e.SR.Exp_TokenIllegal);this.locateID=E.ParseHexString(r)}else this.currencySymbol=r}return __extends(o,t),o.prototype.CultureInfo=function(){var e=this;return e.cultureInfo||(e.cultureInfo=N.CreateCultureInfo(e.locateID),e.currencySymbol&&e.currencySymbol!==b.Empty&&e.cultureInfo&&!e.cultureInfo.NumberFormat().isReadOnly&&(e.cultureInfo.NumberFormat().currencySymbol=e.currencySymbol)),e.cultureInfo},o.prototype.CurrencySymbol=function(){return this.currencySymbol?this.EncodeSymbol(this.currencySymbol):b.Empty},o.prototype.AllowScience=function(){if(this.cultureInfo)return N.AllowScience(this.cultureInfo.Name())},o.prototype.GetDBNumber=function(e){switch(255&this.locateID){case 4:switch(e){case 1:return F.ChineseDBNum1();case 2:return F.ChineseDBNum2();case 3:return F.ChineseDBNum3()}break;case 17:switch(e){case 1:return F.JapaneseDBNum1();case 2:return F.JapaneseDBNum2();case 3:return F.JapaneseDBNum3()}}return m},o.prototype.toString=function(){return this.content?n.AddSquareBracket(this.content):b.Empty},o.prototype.EncodeSymbol=function(t){return e.StringHelper.Replace(t,"\\.","'.'")},o.EvaluateFormat=function(e){if(!e||e===b.Empty)return!1;var t=n.TrimSquareBracket(e);return!(!t||t===b.Empty)&&n.IsEquals(t[0],n.Dollar,!1)},o}(T),P=function(){function t(){}return t.prototype.ConvertTo=function(t,o,r,i,a){var s,l=t;return i!=m&&a!=m&&o instanceof Date&&(s=i.GetDBNumber(a.Type()),l=a.ReplaceNumberString(l,s,!0),1===a.Type()&&(l=l.replace(new RegExp("一十","g"),"十")),l=(l=l.replace(n.ReplacePlaceholder+L.YearFourDigit,new e._DateTimeHelper(o).localeFormat(L.YearFourDigit))).replace(n.ReplacePlaceholder+L.YearTwoDigit,new e._DateTimeHelper(o).localeFormat(L.YearTwoDigit)),l=a.ReplaceNumberString(l,s,!1)),l},t}(),L=function(t){function o(e,o,n,i,a){t.call(this,n,i,a),this.baseNumberStringConverter=r.prototype.NumberStringConverter,this.baseDateTimeFormatInfo=r.prototype.DateTimeFormatInfo,this.baseCultureName=r.prototype.CultureName;var s=this;s.validDateTimeFormatString=m,s.formatString=m,s.hasJD=!1,s.absoluteTime=m,s.absTimeParts=m,s.hasYearDelay=!1,s.exactlyMatch=!1,s._classNames.push("NumberFormatDateTime"),s.exactlyMatch=!1,s.formatString=s.FixFormat(r.TrimNotSupportSymbol(e)),s.absTimeParts=o,s._init(e,o,n,i)}return __extends(o,t),o.EvaluateFormat=function(e){return r.ContainsKeywords(e,o.keyWords,o.keyWordsSet())},o.prototype._init=function(t,r,i,a){var s,l,u,c=this,h={value:c.formatString},p=o;if(!p.EvaluateFormat(h.value))throw new Error(e.SR.Exp_FormatIllegal);if(s=c.ProcessAMPM(h),c.hasJD=c.Replace(h.value,p.MonthJD,'"'+p.PlaceholderMonthJD+'"',!0,!1,h,!1,!1),c.Replace(h.value,p.MonthUnabbreviated,p.StandardMonthUnabbreviated,!0,!1,h,!1,!1),c.Replace(h.value,p.MonthAbbreviation,p.StandardMonthAbbreviation,!0,!1,h,!1,!1),c.Replace(h.value,p.MonthTwoDigit,p.StandardMonthTwoDigit,!0,!1,h,!1,!1),c.Replace(h.value,p.MonthSingleDigit,p.StandardMonthSingleDigit,!0,!1,h,!1,!1),c.Replace(h.value,p.DayWeekDayAbbreviation,p.StandardDayWeekDayAbbreviation,!0,!0,h,!1,!0),c.Replace(h.value,p.DayWeekDayUnabbreviated,p.StandardDayWeekDayUnabbreviated,!0,!0,h,!1,!0),c.Replace(h.value,p.MinuteSingleDigit,p.StandardMinuteSingleDigit,!1,!0,h,!1,!1),s||(c.Replace(h.value,p.HoursSingleDigit,p.StandardHourSingleDigit,!0,!0,h,!1,!1),c.Replace(h.value,p.HoursTwoDigit,p.StandardHourTwoDigit,!0,!0,h,!1,!1)),c.Replace(h.value,p.SecondSingleDigit,p.StandardSecondSingleDigit,!0,!0,h,!1,!0),c.PartDBNumberFormat()&&c.PartLocaleID()&&(c.hasYearDelay=c.hasYearDelay||c.Replace(h.value,p.YearFourDigit,'"'+n.ReplacePlaceholder+p.YearFourDigit+'"',!0,!1,h,!1,!0),c.hasYearDelay=c.hasYearDelay||c.Replace(h.value,p.YearTwoDigit,'"'+n.ReplacePlaceholder+p.YearTwoDigit+'"',!0,!1,h,!1,!0)),c.absTimeParts)for(l=0;l<c.absTimeParts.length;l++)u=c.absTimeParts[l],c.Replace(h.value,u.token,n.ReplacePlaceholder+u.token,!0,!0,h,!1,!0);c.validDateTimeFormatString=h.value},o.prototype._isJanpaneseCulture=function(){var t=this.PartLocaleID();if(t!==m&&t.CultureInfo()!==m){if(t.CultureInfo()===e._CultureInfo.jaCulture())return!0}else if(this.CultureName()===e._CultureInfo.jaCulture().Name())return!0;return!1},o.prototype.NumberStringConverter=function(e){return 0===arguments.length?this.baseNumberStringConverter()?this.baseNumberStringConverter():o.defaultDateTimeNumberStringConverter:(this.baseNumberStringConverter(e),e)},o.prototype.AbsoluteTime=function(){return this.absoluteTime?this.absoluteTime:o.defaultAbsoluteTime},o.prototype.FormatString=function(){return this.formatString},o.prototype.DateTimeFormatInfo=function(t){return 0===arguments.length?this.baseDateTimeFormatInfo()?this.baseDateTimeFormatInfo():this.PartLocaleID()&&this.PartLocaleID().CultureInfo()?this.PartLocaleID().CultureInfo().DateTimeFormat():this.baseCultureName()?e._CultureInfo.getCulture(this.baseCultureName()).DateTimeFormat():n.DateTimeFormatInfo():(this.baseDateTimeFormatInfo(t),t)},o.prototype.ExcelCompatibleFormatString=function(){var e=this,t=e.formatString,n=o,r={value:t};return e.Replace(t,n.StandardAMPMSingleDigit,e.CurrentAMPM(),!0,!0,r,!1,!0),e.Replace(t,n.StandardMonthUnabbreviated,n.MonthUnabbreviated,!0,!1,r,!1,!0),e.Replace(t,n.StandardMonthAbbreviation,n.MonthAbbreviation,!0,!1,r,!1,!0),e.Replace(t,n.StandardMonthTwoDigit,n.MonthTwoDigit,!0,!1,r,!1,!0),e.Replace(t,n.StandardMonthSingleDigit,n.MonthSingleDigit,!0,!1,r,!1,!0),e.Replace(t,n.StandardDayWeekDayAbbreviation,n.DayWeekDayAbbreviation,!0,!0,r,!1,!0),e.Replace(t,n.StandardDayWeekDayUnabbreviated,n.DayWeekDayUnabbreviated,!0,!0,r,!1,!0),e.Replace(t,n.StandardMinuteSingleDigit,n.MinuteSingleDigit,!1,!0,r,!1,!0),e.Replace(t,n.StandardHourSingleDigit,n.HoursSingleDigit,!0,!0,r,!1,!1),e.Replace(t,n.StandardHourTwoDigit,n.HoursTwoDigit,!0,!0,r,!1,!1),e.Replace(t,n.StandardSecondSingleDigit,n.SecondSingleDigit,!0,!0,r,!1,!0),e.Replace(t,n.StandardSubSecondThreeDigit,n.SubSecondThreeDigit,!0,!0,r,!1,!0),e.Replace(t,n.StandardSubSecondTwoDigit,n.SubSecondTwoDigit,!0,!0,r,!1,!0),e.Replace(t,n.StandardSubSecondSingleDigit,n.SubSecondSingleDigit,!0,!0,r,!1,!0),r.value},o.prototype.CurrentAMPM=function(){var e;return(e=this.DateTimeFormatInfo()?this.DateTimeFormatInfo():n.DateTimeFormatInfo())&&e.amDesignator&&e.amDesignator!==b.Empty&&e.pmDesignator&&e.pmDesignator!==b.Empty?b.Format("{0}/{1}",e.amDesignator,e.pmDesignator):o.AMPMTwoDigit},o.prototype.Format=function(t){var r,i,a,s,l,u,c,h;if(e.util.isType(t,"boolean"))return t.toString().toUpperCase();var p=this,d=b.Empty,f=m;try{try{(f=e.Calc.Convert.DT(t))?t=f:d=t.toString()}catch(e){d=t.toString()}if(f&&(r=p.validDateTimeFormatString,"H"===(i=p.validDateTimeFormatString.replace(/%/g,""))||"h"===i||"m"===i||"M"===i||"d"===i||"s"===i||"y"===i?(r="%"+i,p.validDateTimeFormatString=r):r=i,d=p.PartLocaleID()&&p.PartLocaleID().CultureInfo()?new e._DateTimeHelper(f).customCultureFormat(r,p.PartLocaleID().CultureInfo()):p.CultureName()?new e._DateTimeHelper(f).customCultureFormat(r,e._CultureInfo.getCulture(p.CultureName())):new e._DateTimeHelper(f).localeFormat(r),p.hasJD&&(a=p._getMonthName(f.getMonth()),d=e.StringHelper.Replace(d,o.PlaceholderMonthJD,a.substr(0,1))),p.absTimeParts))for(s=864e5*(e._DateTimeHelper.___toOADate(f)-e._DateTimeHelper.___toOADate(p.AbsoluteTime())),l=0;l<p.absTimeParts.length;l++){switch(u=p.absTimeParts[l],c=m,u.TimePartType()){case 0:c=v(s/36e5);break;case 1:c=v(s/6e4);break;case 2:c=v(s/1e3)}c!==m&&c!==_&&(h=u.token.replace("[","\\[").replace("]","\\]"),d=e.StringHelper.Replace(d,n.ReplacePlaceholder+h,c))}}catch(o){d=e.FormatConverter.toString(t)}return p.NumberStringConverter()&&(p.NumberStringConverter()instanceof P?d=p.NumberStringConverter().ConvertTo(d,t,!1,p.PartLocaleID(),p.PartDBNumberFormat()):(p.hasYearDelay&&(d=e.StringHelper.Replace(d,n.ReplacePlaceholder+o.YearFourDigit,new e._DateTimeHelper(f).localeFormat(o.YearFourDigit)),d=e.StringHelper.Replace(d,n.ReplacePlaceholder+o.YearTwoDigit,new e._DateTimeHelper(f).localeFormat(o.YearTwoDigit))),d=p.NumberStringConverter().ConvertTo(d,t,!0,p.PartLocaleID(),p.PartDBNumberFormat()))),d},o.prototype._getMonthName=function(e){return["January","February","March","April","May","June","July","August","September","October","November","December"][e]},o.prototype.Parse=function(t){var o,n;if(!t||t===b.Empty)return m;var r=E.FixJapaneseChars(t),i=r.toLowerCase();if("true"===i)return!0;if("false"===i)return!1;if(this.validDateTimeFormatString&&(o=e._DateTimeHelper.parseExact(r,this.validDateTimeFormatString,e._CultureInfo.getCulture(this.CultureName()))))return o;if(!this.exactlyMatch)try{return(n=e.Calc.Convert.DT(r))&&!isNaN(n)?n:(n=new Date(r),isNaN(n.valueOf())?r:n)}catch(e){return r}return m},o.prototype.FixFormat=function(t){for(var r,i=t,a="",s=!1,l=(e.StringHelper.IndexOf(i,o.HoursSingleDigit[0],1)>-1||e.StringHelper.IndexOf(i,o.SecondSingleDigit[0],1),e.StringHelper.IndexOf(i,o.YearTwoDigit[0],1)>-1||e.StringHelper.IndexOf(i,o.DaySingleDigit[0],1),0);l<i.length;l++)'"'===(r=i[l])?s=!s:s||("Y"===r||"D"===r||"S"===r||"E"===r||"G"===r?r=r.toLowerCase():"M"===r&&(l>1&&(n.IsEquals("A",i[l-1],!0)||n.IsEquals("P",i[l-1],!0))||(r=r.toLowerCase()))),a+=r;return a},o.prototype.ProcessAMPM=function(t){var n,r,i,a=!1;return e.StringHelper.Contains(t.value,o.AMPMTwoDigit)&&(t.value=e.StringHelper.Replace(t.value,o.AMPMTwoDigit,o.StandardAMPMSingleDigit),a=!0),n=this.DateTimeFormatInfo(),e.StringHelper.Contains(t.value,o.AMPMSingleDigit)&&(t.value=e.StringHelper.Replace(t.value,o.AMPMSingleDigit,o.StandardAMPMSingleDigit),n&&(n.amDesignator=o.AMPMSingleDigit.substr(0,1),n.pmDesignator=o.AMPMSingleDigit.substr(2,1)),a=!0),r=this.CurrentAMPM(),e.StringHelper.Contains(t.value,r)&&(t.value=e.StringHelper.Replace(t.value,r,o.StandardAMPMSingleDigit),(i=r.split("/"))&&2===i.length&&(n.amDesignator=i[0],n.pmDesignator=i[1]),a=!0),a},o.prototype.Replace=function(t,r,i,a,s,l,u,c){var h,p,d,f,g,m,_;if(l.value=t,a||s){var y=[],C=!0,w=e.StringHelper.IndexOf(l.value,o.HoursSingleDigit[0],1)>-1||e.StringHelper.IndexOf(l.value,o.SecondSingleDigit[0],1)>-1;!(e.StringHelper.IndexOf(l.value,o.YearTwoDigit[0],1)>-1||e.StringHelper.IndexOf(l.value,o.DaySingleDigit[0],1)>-1)&&w&&(C=!1);for(var v=!1,S=0;S<l.value.length;S++){if(h=l.value[S],n.IsEquals(h,o.HoursSingleDigit[0],!0)||n.IsEquals(h,o.SecondSingleDigit[0],!0)?C=!1:(n.IsEquals(h,o.YearTwoDigit[0],!0)||n.IsEquals(h,o.DaySingleDigit[0],!0))&&(C=!0),a&&n.IsEquals(h,r[0],c)&&C||s&&n.IsEquals(h,r[0],c)&&!C){for(p=!0,d=0;d<r.length;d++)if(d+S>=t.length||!n.IsEquals(r[d],l.value[d+S],c)){p=!1;break}if(f=S+r.length-1,p&&f+1<l.value.length){for(g=l.value[f],m=-1,m=f+1;m<l.value.length&&n.IsEquals(g,l.value[m],c);m++);m>f+1&&(S=m,p=!1)}p&&!v&&e.ArrayHelper.insert(y,0,S)}'"'===h&&(v=!v)}if(y.length>0){if(!u)for(S=0;S<y.length;S++)_=y[S],l.value=e.StringHelper.Remove(l.value,_,r.length),l.value=e.StringHelper.Insert(l.value,_,i);return!0}return!1}return!1},o.keyWordsSet=function(){var e,t,n=o;if(!n._keyWordsSet){for(e={},t=0;t<n.keyWords.length;t++)e[n.keyWords[t]]=!0;n._keyWordsSet=e}return n._keyWordsSet},o.defaultDateTimeNumberStringConverter=new P,o.YearTwoDigit="yy",o.YearSingleDigit="y",o.YearFourDigit="yyyy",o.MonthSingleDigit="m",o.MonthTwoDigit="mm",o.MonthAbbreviation="mmm",o.MonthUnabbreviated="mmmm",o.MonthJD="mmmmm",o.DaySingleDigit="d",o.DayTwoDigit="dd",o.DayWeekDayAbbreviation="aaa",o.DayWeekDayUnabbreviated="aaaa",o.HoursSingleDigit="h",o.HoursTwoDigit="hh",o.MinuteSingleDigit="m",o.MinuteTwoDigit="mm",o.SecondSingleDigit="s",o.SecondTwoDigit="ss",o.SubSecondSingleDigit=".0",o.SubSecondTwoDigit=".00",o.SubSecondThreeDigit=".000",o.EraYear="e",o.AMPMTwoDigit="AM/PM",o.AMPMSingleDigit="A/P",o.StandardYearSingleDigit="%y",o.StandardMonthSingleDigit="%M",o.StandardMonthTwoDigit="MM",o.StandardMonthAbbreviation="MMM",o.StandardMonthUnabbreviated="MMMM",o.StandardAMPMSingleDigit="tt",o.StandardMinuteSingleDigit="%m",o.StandardHourSingleDigit="H",o.StandardHourTwoDigit="HH",o.StandardSecondSingleDigit="%s",o.StandardSubSecondSingleDigit=".f",o.StandardSubSecondTwoDigit=".ff",o.StandardSubSecondThreeDigit=".fff",o.StandardDayWeekDayAbbreviation="ddd",o.StandardDayWeekDayUnabbreviated="dddd",o.PlaceholderMonthJD=n.ReplacePlaceholder+"mmmmm",o.defaultAbsoluteTime=new Date(1899,11,30,0,0,0,0),o.keyWords=[o.YearSingleDigit,o.YearTwoDigit,o.YearFourDigit,o.MonthSingleDigit,o.MonthTwoDigit,o.MonthAbbreviation,o.MonthUnabbreviated,o.MonthJD,o.DaySingleDigit,o.DayTwoDigit,o.DayWeekDayAbbreviation,o.DayWeekDayUnabbreviated,o.HoursSingleDigit,o.HoursTwoDigit,o.MinuteSingleDigit,o.MinuteTwoDigit,o.SecondSingleDigit,o.SecondTwoDigit,"ggg","gg","g","ee","e"],o}(r),H=function(){function e(){}return e.prototype.ConvertTo=function(e,t,o,n,r){if(n!=m&&r!=m){var i=n.GetDBNumber(r.Type());if(i!=m)return r.ReplaceNumberString(e,i,o)}return e},e}(),k=function(o){function i(t,i,a,s){var l,u,c,h,p,d;o.call(this,i,a,s),this.baseNumberStringConverter=r.prototype.NumberStringConverter,this.baseNumberFormatInfo=r.prototype.NumberFormatInfo,this.baseCultureName=r.prototype.CultureName,(l=this).numberFormatString=m,l.fullFormatString=m,l.isGeneralNumber=!1,l.fractionIntegerFormat=m,l.fractionNumeratorFormat=m,l.fractionDenominatorFormat=m,l.excelFormatString=b.Empty,l._classNames.push("NumberFormatDigital"),u=r.TrimNotSupportSymbol(t),l.fullFormatString=n.Filter(t,n.LeftSquareBracket,n.RightSquareBracket),l.excelFormatString=u,i&&(c=u,u=n.ReplaceKeyword(c,l.PartLocaleID().OriginalToken(),l.PartLocaleID().CurrencySymbol())),l.PartDBNumberFormat()&&(l.excelFormatString=n.ReplaceKeyword(l.excelFormatString,l.PartDBNumberFormat().OriginalToken(),l.PartDBNumberFormat().toString())),(u=n.Filter(u,n.LeftSquareBracket,n.RightSquareBracket)).indexOf(n.SolidusSign)>-1&&(u=e.StringHelper.Replace(u,"\\"+n.QuestionMark,n.Zero),(h=n.Split(u,n.SolidusSign))&&2===h.length&&(l.fractionDenominatorFormat=h[1],(p=h[0])&&((d=p.lastIndexOf(n.Space))>-1?(l.fractionIntegerFormat=p.substr(0,d),l.fractionNumeratorFormat=p.substr(d+1,p.length-d-1)):l.fractionNumeratorFormat=p))),l.numberFormatString=u}return __extends(i,o),i.prototype.NumberStringConverter=function(e){return 0===arguments.length?this.baseNumberStringConverter()?this.baseNumberStringConverter():i.defaultNumberStringConverter:(this.baseNumberStringConverter(e),e)},i.prototype.FormatString=function(){return this.fullFormatString},i.prototype.NumberFormatInfo=function(t){return 0===arguments.length?this.baseNumberFormatInfo()?this.baseNumberFormatInfo():this.PartLocaleID()&&this.PartLocaleID().CultureInfo()?this.PartLocaleID().CultureInfo().NumberFormat():this.baseCultureName()?e._CultureInfo.getCulture(this.baseCultureName()).NumberFormat():n.NumberFormatInfo():(this.baseNumberFormatInfo(t),t)},i.prototype.IsGeneralNumber=function(e){return 0===arguments.length?this.isGeneralNumber:(this.isGeneralNumber=e,e)},i.prototype.ExcelCompatibleFormatString=function(){return this.excelFormatString},i.prototype.Format=function(t){var o,r,a,s,l,u,c,h,p,d;if(e.util.isType(t,"boolean"))return t.toString().toUpperCase();if(o=this,r=e.FormatConverter.ToDouble(t),isNaN(r)||!isFinite(r)||isNaN(t))return"string"==typeof t?t:m;if(a=o.NaNSymbol(),s=m,l=o.CultureName()?e._CultureInfo.getCulture(o.CultureName()):e._CultureInfo._currentCulture,o.fractionNumeratorFormat&&o.fractionDenominatorFormat){var f={value:0},g={value:0},_={value:0},y=o.fractionDenominatorFormat.length;if(i.GetFraction(r,y,f,g,_)){if((u=o.GetGCD(g.value,_.value))>1&&(g.value/=u,_.value/=u),o.fractionIntegerFormat){if(s="",1===_.value&&(f.value+=g.value,g.value=0,_.value=0),0!==f.value&&(s+=new e._NumberHelper(f.value).customCultureFormat(o.fractionIntegerFormat,l),s+=n.Space),0===f.value&&r<0&&(s+=n.negativeSign),0===r&&(s+="0"),T=o.fractionDenominatorFormat,x=parseFloat(T),isNaN(x)||x>0&&(g.value*=x/_.value,T=b.Empty,_.value=x,d=(p=C(g.value))-g.value,g.value=d<=.5&&d>=0?parseFloat(p.toString()):parseFloat((p-1).toString())),c=o.fractionNumeratorFormat,h=parseFloat(c),!isNaN(h)&&0===h){var w=c.length,v=g.value.toString(),S=v.length;w>S?c=c.substr(0,w-(w-S)):w<S&&(v=v.substr(0,S-(S-w)),g.value=parseInt(v,10))}return 0!==g.value&&(s+=new e._NumberHelper(g.value).customCultureFormat(c,l).replace(/^0*/,""),s+=n.SolidusSign,s+=new e._NumberHelper(_.value).customCultureFormat(T,l).replace(/^0*/,"")),""===s?"0":s}s="";var x,R=f.value*_.value+g.value,T=o.fractionDenominatorFormat;return(x=parseFloat(T))>0?(R*=x/_.value,T=b.Empty,_.value=x,s+=(R=(d=(p=C(R))-R)<=.5&&d>=0?parseFloat(p.toString()):parseFloat((p-1).toString()))+n.SolidusSign+_.value):(s+=new e._NumberHelper(R).customCultureFormat(o.fractionNumeratorFormat,l).replace(/^0*/,""),s+=n.SolidusSign,s+=new e._NumberHelper(_.value).customCultureFormat(o.fractionDenominatorFormat,l).replace(/^0*/,"")),""===s?"0":s}return r.toString()}return a=new e._NumberHelper(r).customCultureFormat(o.EncodeNumberFormat(o.numberFormatString),l),o.NumberStringConverter()&&(a=o.NumberStringConverter().ConvertTo(a,t,o.isGeneralNumber,o.PartLocaleID(),o.PartDBNumberFormat())),a},i.prototype.Parse=function(t){var o,r,i,a,s,l,u,h,p,d,f,g;if(t=this.TrimSpecialSymbol(t),t=this.TrimCurrencySymbol(t),!(t=e._NumberHelper.replaceCultureSymbolToNormal(t,this.NumberFormatInfo()))||t===b.Empty)return m;if(o=n.numberGroupSeparator,e.StringHelper.EndsWith(t,o)&&!isNaN(t.substr(0,t.length-o.length)))return t;if(r=E.FixJapaneseChars(t),"true"===t.toLowerCase())return!0;if("false"===t.toLowerCase())return!1;var _=n.IsDecimal(r),C=e.StringHelper.IndexOf(r,n.ExponentialSymbol,1),w=C>-1;if(this.numberFormatString){if(i={value:0},a=t=this.TrimPercentSign(t,i),w&&(a=t.substr(0,C)),a[0]===n.NumberFormatInfo().positiveSign&&(a=a.substr(1),t=t.substr(1)),(l=(s=e.StringHelper.Replace(a,n.numberGroupSeparator,"")).indexOf(n.DecimalSeparator))===s.lastIndexOf(n.DecimalSeparator)){if(u="#,##0",-1!==l)for(u+=".",h=s.length-l-1,p=0;p<h;p++)u+="0";new c(u,0,"en-us").Format(s)===a&&(t=w?s+t.substr(C):s)}if(d=parseFloat(t),f=m,d.toString()!==t&&(g=n.DecimalSeparator,_||w?_&&!w?f=new RegExp("^((\\+|-)?\\d*)"+g+"(\\d*)$","ig"):!_&&w?f=new RegExp("^((\\+|-)?\\d+)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig"):_&&w&&(f=new RegExp("^((\\+|-)?\\d*)"+g+"(\\d*)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig")):f=new RegExp("^((\\+|-)?\\d+)$","ig")),!isNaN(d)&&isFinite(d)&&(!f||f.test(t)))return i.value>0&&(d/=parseFloat((100*i.value).toString())),0!==d&&0!==y(d-v(d))&&(_=!0),w&&(_=!0),this.ToObject(d,_)}return m},i.prototype.EncodeNumberFormat=function(e){var t,o,n;if(e){for(t=e.split(""),o="",n=0;n<t.length-1;)"\\"===t[n]?(o+=t[n+1],n+=2):(o+=t[n],n++);n===t.length-1&&"\\"!==t[n]&&(o+=t[n]),e=o}return e},i.prototype.ToObject=function(e,t){return e},i.prototype.TrimPercentSign=function(t,o){if(o.value=0,!t||t===b.Empty)return t;var r=t,i=n.percentSymbol,a=t.indexOf(i);return a===t.length-1&&a===t.lastIndexOf(i)&&(r=e.StringHelper.Replace(r,i,""),o.value+=(t.length-r.length)/i.length),r},i.prototype.TrimSpecialSymbol=function(o){var r,i,a,s,l,u,c;if(!o||o===b.Empty)return o;for(r=o,i=-1,a=0;a<r.length;a++)if(t.IsDigit(r[a])){i=a;break}for(s=-1,l=r.length-1;l>-1;l--)if(t.IsDigit(r[l])){s=l;break}for(u=r.length-1;u>-1;u--)if(c=r[u],this.IsSpecialSymbol(c))t.IsWhiteSpace(c)?(u<i||s<u)&&(r=e.StringHelper.Remove(r,u,1)):r=e.StringHelper.Remove(r,u,1);else if(("-"===c||"+"===c)&&u>0&&"e"!==r[u-1]&&"E"!==r[u-1]&&"("!==r[u-1]&&r[u-1].toString()!==n.NumberFormatInfo().currencySymbol)break;return r},i.prototype.IsStandardNumberSymbol=function(e){var t,o=this.NumberFormatInfo()?this.NumberFormatInfo():n.NumberFormatInfo();return!(!o||(t=e.toString(),t!==o.currencyDecimalSeparator&&t!==o.currencyGroupSeparator&&t!==o.currencySymbol&&t!==o.nanSymbol&&t!==o.negativeInfinitySymbol&&t!==o.negativeSign&&t!==o.numberDecimalSeparator&&t!==o.numberGroupSeparator&&t!==o.percentDecimalSeparator&&t!==o.percentGroupSeparator&&t!==o.percentSymbol&&t!==o.perMilleSymbol&&t!==o.positiveInfinitySymbol&&t!==o.positiveSign))},i.prototype.IsSpecialSymbol=function(e){return!this.IsStandardNumberSymbol(e)&&!!t.IsWhiteSpace(e)},i.prototype.TrimCurrencySymbol=function(e){var t,o,r;return e?((t=this.NumberFormatInfo()?this.NumberFormatInfo():n.NumberFormatInfo())&&(o=t.currencySymbol,0===(r=e.toString().indexOf(o))&&r===e.lastIndexOf(o)&&(e=e.substr(1))),e):e},i.keyWordsSet=function(){var e,t,o=i;if(!o._keyWordsSet){for(e={},t=0;t<o.keywords.length;t++)e[o.keywords[t]]=!0;o._keyWordsSet=e}return o._keyWordsSet},i.EvaluateFormat=function(e){return r.ContainsKeywords(e,i.keywords,i.keyWordsSet())},i.GetFraction=function(e,t,o,n,r){return E.GetFraction(e,t,o,n,r)},i.prototype.GetGCD=function(e,t){if(0==e)return y(t);if(0==t)return y(e);for(var o=S(e,t),n=x(e,t),r=o%n;0!=r;)r=(o=n)%(n=r);return y(n)},i.defaultNumberStringConverter=new H,i.keywords=[n.Exponential1,n.Exponential2,n.NumberSign,n.DecimalSeparator,n.numberGroupSeparator,n.percentSymbol,n.Zero,n.SolidusSign],i}(r),V=function(t){function o(i,a,s,l){if(t.call(this,a,s,l),this.digitalFormat=m,this.exponentialDigitalFormat=m,this.fullFormatString=m,this._classNames.push("NumberFormatGeneral"),arguments.length>0){if(!o.EvaluateFormat(i))throw e.SR.Exp_FormatIllegal;if(i.indexOf(n.Zero)>=0||i.indexOf(n.NumberSign)>=0||i.indexOf(n.DecimalSeparator)>=0||i.indexOf(n.CommercialAt)>=0)throw e.SR.Exp_FormatIllegal;this.fullFormatString=i}else this.fullFormatString=r.General}return __extends(o,t),o.prototype.DigitalFormat=function(){var e;return this.digitalFormat||(e=this.fullFormatString,e=n.ReplaceKeyword(e,r.General,o.GeneralNumber),this.digitalFormat=new k(e,this.PartLocaleID(),this.PartDBNumberFormat(),this.CultureName()),this.digitalFormat.IsGeneralNumber(!0)),this.digitalFormat},o.prototype.ExponentialDigitalFormat=function(){return this.exponentialDigitalFormat||(this.exponentialDigitalFormat=new k("0.#####E+00",this.PartLocaleID(),this.PartDBNumberFormat(),this.CultureName()),this.exponentialDigitalFormat.IsGeneralNumber(!0)),this.exponentialDigitalFormat},o.prototype.FormatString=function(){return e.StringHelper.Replace(this.fullFormatString,o.GeneralPlaceholder,r.General)},o.prototype.Format=function(t){var o,r,i;if(e.FormatConverter.IsNumber(t)){if(o=!this.PartLocaleID()||this.PartLocaleID().AllowScience(),(r=e.FormatConverter.ToDouble(t))!==_&&r!==m)return y(r)>99999999999&&o||y(r)<1e-11&&0!==r?this.ExponentialDigitalFormat().Format(t):this.DigitalFormat().Format(t)}else{if(e.util.isType(t,"string"))return i=e.StringHelper.Replace(this.FormatString(),'"',""),(i=n.TrimEscape(i))?e.StringHelper.Replace(i,"General",t):t;if(e.util.isType(t,"boolean"))return t.toString().toUpperCase()}return""},o.prototype.Parse=function(t){var o,r,i,a;if(b.IsNullOrEmpty(t))return m;if(o=!1,(r=e.StringHelper.IndexOf(t,"-"))>0&&(n.IsEquals(t.charAt(r-1),n.ExponentialSymbol,!0)||(o=!0)),(e.StringHelper.Contains(t,"/")||o||e.StringHelper.Contains(t,":")||e.StringHelper.Contains(t,"-"))&&(i=e._DateTimeHelper.parseLocale(t)))return i;var s=t,l=m,u=m;if(s.charAt(0)===n.negativeSign?u=!0:s.charAt(0)===n.NumberFormatInfo().positiveSign&&(u=!1),a=!1,u&&s.length>3&&s.charAt(1)===n.LeftParenthesis&&s.charAt(s.length-1)===n.RightParenthesis&&(a=!0),u&&a){if(l=this.DigitalFormat().Parse(e.StringHelper.Remove(t,0,1)))return e.util.isType(l,"number")?y(l)*(u?-1:1):l}else if((l=this.DigitalFormat().Parse(t))!==_&&l!==m)return l;return t},o.GeneralMonthDay=function(){return["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"]},o.GeneralYearMonth=function(){return["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"]},o.GeneralYearMonthDay=function(){return["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"]},o.GeneralHourMinute=function(){return["H:m","h:m tt"]},o.GeneralHourMinuteWithDate=function(){return["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"]},o.GeneralHourMinuteSecond=function(){return["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"]},o.GeneralHourMinuteSecondSubSecond=function(){return["H:m:s.FFF","h:m:s.FFF tt"]},o.GeneralHourMinuteSecondWithDate=function(){return["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"]},o.GeneralHourMinuteSecondSubSecondWithDate=function(){return["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]},o.EvaluateFormat=function(e){if(!e||e===b.Empty)return!1;var t=r;return t.ContainsKeywords(e,t._keywords,t._keywordsSet)},o.GeneralPlaceholder="@NumberFormat",o.GeneralNumber="##################0.################",o}(r),B=function(){function e(e,t){this.formatCached=e,this.cultureName=t,this.typeName=""}return e.prototype.Format=function(e,t){return m},e.prototype.Parse=function(e){return m},e.prototype.FormatString=function(){return this.formatCached},e.prototype.toJSON=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},e.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==_&&(this[t]=e[t])},e}();e.CustomFormatterBase=B}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M;e.feature("conditionalFormat",["core.common","core.globalize","core.stringResource","core.theme","core.imageLoader"]);var E,N,O=null,P=void 0,L="undefined",H=Math.min,k=Math.max,V=Math.abs,B=Math.floor,z=e.Calc.Convert,G=e.StringHelper.TrimStart,W=function(t){var o;if(t instanceof e.Calc.Expressions.Expression)o=t;else if(t instanceof e.Range)o=j(t);else{if(!z.num(t)||isNaN(t=z.D(t)))throw e.SR.Exp_NotSupport;o=new e.Calc.Expressions.DoubleExpression(t,t.toString())}return o},j=function(t){var o=new e.Calc.Expressions.RangeExpression(t.row,t.col,t.row+t.rowCount-1,t.col+t.colCount-1);return t.row<0?o.initBand(o.startColumn,o.endColumn,o.startColumnRelative,o.endColumnRelative,!1):t.col<0&&o.initBand(o.startRow,o.startColumn,o.startRowRelative,o.endRowRelative,!0),o};(E=e.ConditionType||(e.ConditionType={}))[E.RelationCondition=0]="RelationCondition",E[E.NumberCondition=1]="NumberCondition",E[E.TextCondition=2]="TextCondition",E[E.ColorCondition=3]="ColorCondition",E[E.FormulaCondition=4]="FormulaCondition",E[E.DateCondition=5]="DateCondition",E[E.DateExCondition=6]="DateExCondition",E[E.TextLengthCondition=7]="TextLengthCondition",E[E.Top10Condition=8]="Top10Condition",E[E.UniqueCondition=9]="UniqueCondition",E[E.AverageCondition=10]="AverageCondition",E[E.CellValueCondition=11]="CellValueCondition",E[E.AreaCondition=12]="AreaCondition",e.ConditionType,(N=e.RuleType||(e.RuleType={}))[N.ConditionRuleBase=0]="ConditionRuleBase",N[N.CellValueRule=1]="CellValueRule",N[N.SpecificTextRule=2]="SpecificTextRule",N[N.FormulaRule=3]="FormulaRule",N[N.DateOccurringRule=4]="DateOccurringRule",N[N.Top10Rule=5]="Top10Rule",N[N.UniqueRule=6]="UniqueRule",N[N.DuplicateRule=7]="DuplicateRule",N[N.AverageRule=8]="AverageRule",N[N.ScaleRule=9]="ScaleRule",N[N.TwoScaleRule=10]="TwoScaleRule",N[N.ThreeScaleRule=11]="ThreeScaleRule",N[N.DataBarRule=12]="DataBarRule",N[N.IconSetRule=13]="IconSetRule",e.RuleType,t=function(){function e(){this.offsetRow=0,this.offsetCol=0}return e.prototype.evaluate=function(e,t,o,n,r){},e.prototype.toJSON=function(){return{}},e.prototype.adjustOffset=function(e,t){this.offsetRow=e,this.offsetCol=t},e.prototype._cloneToActualRanges=function(e,t){for(var o,n=[],r=0,i=t.length;r<i;r++)o=e._getActualRange(t[r]),n.push(o);return n},e}(),e.ConditionalBase=t,o=function(){function t(e){this.condition=O,this.ranges=O,this.style=O,this._priority=1,this._stopIfTrue=!1,this.style=e}return t.prototype.hasNoReference=function(){return!(this.ranges&&this.ranges.length>0)},t.prototype.evaluate=function(e,t,o,n){var r,i;return this.contains(t,o)?(this.initCondition(),r={baseRow:0,baseCol:0},this.getBaseCoordinate(r),this.condition.adjustOffset(t-r.baseRow,o-r.baseCol),i=O,this.condition.evaluate(e,t,o,n)&&(i=this.getExpected()),this.condition.adjustOffset(0,0),i):O},t.prototype.contains=function(e,t){var o,n,r=this.ranges;if(r)for(o=r.length,n=0;n<o;n++)if(this.ranges[n].contains(e,t))return!0;return!1},t.prototype.createCondition=function(){return null},t.prototype.initCondition=function(){this.condition||(this.condition=this.createCondition())},t.prototype.priority=function(){return this._priority},t.prototype.stopIfTrue=function(e){return 0===arguments.length?this._stopIfTrue:(this._stopIfTrue=e,this)},t.prototype.getExpected=function(){return this.style},t.prototype.reset=function(){this.ranges=O,this.condition=O,this.style=O,this._stopIfTrue=!1,this._priority=1},t.prototype.intersects=function(e,t,o,n){var r,i,a=this.ranges;if(a)for(r=a.length,i=0;i<r;i++)if(a[i].intersect(e,t,o,n))return!0;return!1},t.prototype.isScaleRule=function(){return!1},t.prototype.getBaseCoordinate=function(e){var t;if(e.baseRow=Number.MAX_VALUE,e.baseCol=Number.MAX_VALUE,this,this.ranges&&this.ranges.length>0)for(t=0;t<this.ranges.length;t++){var o=this.ranges[t],n=o.row,r=o.col;n=-1===n?0:n,r=-1===r?0:r,e.baseRow=H(n,e.baseRow),e.baseCol=H(r,e.baseCol)}else e.baseRow=0,e.baseCol=0},t.prototype._addRows=function(t,o){var n,r,i;if(this.ranges)for(n=this.ranges.length,r=0;r<n;r++){if(-1===(i=this.ranges[r]).row)continue;i.row>=t?this.ranges[r]=new e.Range(i.row+o,i.col,i.rowCount,i.colCount):i.row<t&&t<i.row+i.rowCount&&(this.ranges[r]=new e.Range(i.row,i.col,i.rowCount+o,i.colCount))}},t.prototype._addColumns=function(t,o){var n,r,i;if(this.ranges)for(n=this.ranges.length,r=0;r<n;r++){if(-1===(i=this.ranges[r]).col)continue;i.col>=t?this.ranges[r]=new e.Range(i.row,i.col+o,i.rowCount,i.colCount):i.col<t&&t<i.col+i.colCount&&(this.ranges[r]=new e.Range(i.row,i.col,i.rowCount,i.colCount+o))}},t.prototype._removeRows=function(t,o){var n,r,i,a,s,l,u,c;if(this.ranges){for(n=[],r=this.ranges.length,i=0;i<r;i++){if(-1===(a=this.ranges[i]).row)continue;a.row>t?a.row+a.rowCount<=t+o?n.push(a):this.ranges[i]=new e.Range(a.row-o,a.col,a.rowCount,a.colCount):a.row<=t&&t<a.row+a.rowCount&&(0===(s=new e.Range(a.row,a.col,a.rowCount-H(a.row+a.rowCount-t,o),a.colCount)).colCount||0===s.rowCount?n.push(a):this.ranges[i]=s)}for(l=n.length,u=0;u<l;u++)c=n[u],e.ArrayHelper.remove(this.ranges,c)}},t.prototype._removeColumns=function(t,o){var n,r,i,a,s,l,u,c;if(this.ranges){for(n=[],r=this.ranges.length,i=0;i<r;i++){if(-1===(a=this.ranges[i]).col)continue;a.col>t?a.col+a.colCount<=t+o?n.push(a):this.ranges[i]=new e.Range(a.row,a.col-o,a.rowCount,a.colCount):a.col<=t&&t<a.col+a.colCount&&(0===(s=new e.Range(a.row,a.col,a.rowCount,a.colCount-H(a.col+a.colCount-t,o))).colCount||0===s.rowCount?n.push(a):this.ranges[i]=s)}for(l=n.length,u=0;u<l;u++)c=n[u],e.ArrayHelper.remove(this.ranges,c)}},t.prototype._isDefaultValue=function(e,t){switch(e){case"ranges":case"style":return t===O;case"priority":return 1===t;case"stopIfTrue":return!1===t;default:return!1}},t.prototype.toJSON=function(){},t.prototype.fromJSON=function(e,t){},t}(),e.ConditionRuleBase=o,n=function(t){function o(e,o,n){t.call(this);this.conditionType="RelationCondition",this.compareType=1,this.item1=O,this.item2=O,this.ignoreBlank=!1,this._dict=O,this.compareType=e,this.item1=o,this.item2=n}return __extends(o,t),o.prototype.adjustOffset=function(e,t){this.item1&&this.item1.adjustOffset&&this.item1.adjustOffset(e,t),this.item2&&this.item2.adjustOffset&&this.item2.adjustOffset(e,t)},o.prototype.create=function(e,t,n){return new o(e,t,n)},o.prototype._getActualValue=function(e,t,o,n,r){if(e&&t&&"ColorCondition"===t.conditionType){var i=e.getActualStyle(o,n);i&&(0===t.compareType?r=i.backColor:1===t.compareType&&(r=i.foreColor))}return r},o.prototype.evaluate=function(e,t,o,n,r){var i,a,s=this;return s.item1&&(s.item1.ignoreBlank=s.ignoreBlank,i=arguments.length<5?s._getActualValue(e,s.item1,t,o,n):n),s.item2&&(s.item2.ignoreBlank=s.ignoreBlank,a=arguments.length<5?s._getActualValue(e,s.item2,t,o,n):r),1===s.compareType?!!(s.item1!==P&&s.item1!==O&&s.item1.evaluate(e,t,o,i))&&(s.item2!==P&&s.item2!==O&&s.item2.evaluate(e,t,o,a)):0===s.compareType&&(!!(s.item1!==P&&s.item1!==O&&s.item1.evaluate(e,t,o,i))||s.item2!==P&&s.item2!==O&&s.item2.evaluate(e,t,o,a))},o.prototype.reset=function(){this.ignoreBlank=!1,this.compareType=1,this.item1=O,this.item2=O},o.prototype._getConditionTypeDictionary=function(){if(!this._dict){var e={};e[0]=o,e[1]=a,e[2]=l,e[3]=u,e[4]=h,e[5]=p,e[6]=f,e[7]=g,e[8]=_,e[9]=w,e[10]=S,e[11]=i,e[12]=F,this._dict=e}return this._dict},o.prototype.toJSON=function(){var t,o,n={compareType:this.compareType,item1:this.item1?this.item1.toJSON():O,item2:this.item2?this.item2.toJSON():O,conType:0,ignoreBlank:this.ignoreBlank},r={};for(t in n)o=n[t],this._isDefaultValue(t,o)||(r[t]=o);return e.GC$.isEmptyObject(r)?P:r},o.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":return!1===t;case"item1":case"item2":return t===O;default:return!1}},o.prototype.fromJSON=function(e,t){var o;if(e){if(this,e.compareType!==O&&e.compareType!==P&&(this.compareType=e.compareType),e.item1!==O&&e.item1!==P){var n=O,r=this._getConditionTypeDictionary(),i=e.item1.conType;typeof i===L&&(i=0),(o=r[i])&&(n=new o).fromJSON(e.item1,t),this.item1=n}if(e.item2!==O&&e.item2!==P){n=O,r=this._getConditionTypeDictionary();var a=e.item2.conType;typeof a===L&&(a=0),(o=r[a])&&(n=new o).fromJSON(e.item2,t),this.item2=n}e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank)}},o.prototype.getFormulas=function(){var e=[];return this.item1&&this.item1.getFormulas&&(e=this.item1.getFormulas()),this.item2&&this.item2.getFormulas&&(e=e.length>0?e.concat(this.item2.getFormulas()):this.item2.getFormulas()),e},o.prototype.setFormulas=function(e){var t,o=this;o.item1&&o.item1.getFormulas&&o.item2&&o.item2.getFormulas?(0!==(t=o.item1.getFormulas().length)&&o.item1.setFormulas(e.slice(0,t)),o.item2.setFormulas(e.slice(t))):o.item1&&o.item1.setFormulas?o.item1.setFormulas(e):o.item2&&o.item2.setFormulas&&o.item2.setFormulas(e)},o}(t),e.RelationCondition=n,r=function(t){function o(o,n,r,i){t.call(this,i),this.operator=o,this.value1="string"==typeof n?e.GC$.trim(n):n,this.value2="string"==typeof r?e.GC$.trim(r):r}return __extends(o,t),o.prototype.createCondition=function(){var e,t,o,r,a,s,l,u=this,c=u.isFormula(u.value1)?G(u.value1,"="):O,h=(u.isFormula(u.value1)||u.value1,u.isFormula(u.value2)?G(u.value2,"="):O),p=(u.isFormula(u.value2)||u.value2,u.operator),d=O;return 6===p?((e=new i(3,u.value1,c)).treatNullValueAsZero=!0,(t=new i(5,u.value2,h)).treatNullValueAsZero=!0,o=new n(1,e,t),(r=new i(5,u.value1,c)).treatNullValueAsZero=!0,(a=new i(3,u.value2,h)).treatNullValueAsZero=!0,s=new n(1,r,a),new n(0,o,s)):7===p?((e=new i(4,u.value1,c)).treatNullValueAsZero=!0,(t=new i(2,u.value2,h)).treatNullValueAsZero=!0,o=new n(0,e,t),(r=new i(2,u.value1,c)).treatNullValueAsZero=!0,(a=new i(4,u.value2,h)).treatNullValueAsZero=!0,s=new n(0,r,a),new n(1,o,s)):(0===p?d=0:2===p?d=2:3===p?d=3:4===p?d=4:5===p?d=5:1===p&&(d=1),d!==O?((l=new i(d,u.value1,c)).treatNullValueAsZero=!0,l):O)},o.prototype.reset=function(){this.operator=6,this.value1=O,this.value2=O,this.style=O,this._stopIfTrue=!1,this._priority=1},o.prototype.isFormula=function(e){return e!==P&&e!==O&&"="===e[0]},o.prototype.toJSON=function(){var t,o,n={ruleType:1,ranges:this.ranges,style:this.style,operator:this.operator,value1:this.value1,value2:this.value2,priority:this._priority,stopIfTrue:this._stopIfTrue},r={};for(t in n)o=n[t],this._isDefaultValue(t,o)||(r[t]=o);return e.GC$.isEmptyObject(r)?P:r},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.operator!==O&&t.operator!==P&&(this.operator=t.operator),t.value1!==O&&t.value1!==P&&(this.value1=t.value1),t.value2!==O&&t.value2!==P&&(this.value2=t.value2),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.CellValueRule=r,i=function(t){function o(e,o,n){t.call(this);this.compareType=O,this.treatNullValueAsZero=!1,this.compareType=e,this.expected=o,this.formula=n}return __extends(o,t),o.prototype.getExpected=function(e,t,o,n){var r,i;return this.formula&&this.formula.length>0?(r=e.getCalcService())?(i=r.parse(e._getSheetSource(),this.formula,t-this.offsetRow,o-this.offsetCol),r.evaluateParsedFormula(e._getSheetSource(),i,t,o,!1)):this.expected:this.expected},o.prototype.evaluate=function(e,t,o,n){var r=this.getExpected(e,t,o);return this.checkCondition(r,n)},o.prototype.isSatisfyingCondition=function(e){var t=this.getExpected(O,0,0);return this.checkCondition(t,e)},o.prototype.checkCondition=function(e,t){var o,n,r,i,a,s,l=this,u=0,c=!1;if("boolean"==typeof e)switch(o=e,l.compareType){case 0:return t===e;case 1:return t!==e;case 2:return l._compareBool(o,t)<0;case 3:return l._compareBool(o,t)<=0;case 4:return l._compareBool(o,t)>0;case 5:return!!l._compareBool(o,t)}try{t===P||t===O?l.treatNullValueAsZero?(c=!0,u=0):(c=!1,u=t):(i={value:void 0},"boolean"!=typeof t&&z.rD(t,i)?(u=i.value,c=!isNaN(u)):c=!1)}catch(e){c=!1}if(!(t!==P&&t!==O||e!==P&&e!==O))switch(l.compareType){case 0:case 3:case 5:return!0;case 1:case 2:case 4:default:return!1}if(c){n=0,r=!1;try{i={value:void 0},z.rD(e,i)&&(n=i.value,r=!0)}catch(e){}if(!r){switch(l.compareType){case 0:return!1;case 1:return!0}return!1}switch(l.compareType){case 0:return u===n;case 1:return u!==n;case 2:return u>n;case 3:return u>=n;case 4:return u<n;case 5:return u<=n}}else if("string"==typeof t){if(a=O,"string"!=typeof e){switch(l.compareType){case 0:return!1;case 1:return!0}return!1}switch(a=e,s=t,l.compareType){case 0:return s===a;case 1:return s!==a;case 2:return a<s;case 3:return a<=s;case 4:return a>s;case 5:return a>=s}}return!1},o.prototype._compareBool=function(e,t){return e===t?0:!1===e&&!0===t?-1:1},o.prototype._isDefaultValue=function(e,t){switch(e){case"treatNullValueAsZero":return!1===t;default:return!1}},o.prototype.toJSON=function(){var t,o,n={compareType:this.compareType,expected:this.expected,formula:this.formula,conType:11,treatNullValueAsZero:this.treatNullValueAsZero},r={};for(t in n)o=n[t],this._isDefaultValue(t,o)||(r[t]=o);return e.GC$.isEmptyObject(r)?P:r},o.prototype.fromJSON=function(e,t){if(e){e.compareType!==O&&e.compareType!==P&&(this.compareType=e.compareType),e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.formula!==O&&e.formula!==P&&(this.formula=e.formula),e.treatNullValueAsZero!==O&&e.treatNullValueAsZero!==P&&(this.treatNullValueAsZero=e.treatNullValueAsZero)}},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.CellValueCondition=i,a=function(t){function o(o,n,r){t.call(this);this.compareType=0,this.conditionType="NumberCondition",this.ignoreBlank=!1,this.integerValue=!1,this.compareType=o,this.expected=n,this.formula="string"==typeof r?G(e.GC$.trim(r),"="):r}return __extends(o,t),o.prototype.evaluate=function(e,t,o,n){var r=this.getExpected(e,t,o);return this.integerValue&&(r=isNaN(r)?O:parseInt(r,10)),this.checkCondition(r,n)},o.prototype.checkCondition=function(e,t){var o;if((t===P||t===O||""===t)&&this.ignoreBlank)return!0;if(isNaN(t))return!1;if(e===P||e===O){if(this.ignoreBlank)return!0;e=0}o=0;try{o=parseFloat(t)}catch(e){return!1}if(!0===this.integerValue&&!1===(o-B(o)==0))return!1;switch(this.compareType){case 0:return o===e;case 1:return o!==e;case 2:return o>e;case 3:return o>=e;case 4:return o<e;case 5:return o<=e}return!1},o.prototype.getExpected=function(e,t,o){var n;return this.formula&&this.formula.length>0?(n=e.getCalcService())?n.evaluate(e._getSheetSource(),this.formula,t,o):this.expected:this.expected},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.compareType=0,this.integerValue=!1},o.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":case"integerValue":return!1===t;default:return!1}},o.prototype.toJSON=function(){var t,o,n={compareType:this.compareType,expected:this.expected,formula:this.formula,conType:1,ignoreBlank:this.ignoreBlank,integerValue:this.integerValue},r={};for(t in n)o=n[t],this._isDefaultValue(t,o)||(r[t]=o);return e.GC$.isEmptyObject(r)?P:r},o.prototype.fromJSON=function(e,t){if(e){e.compareType!==O&&e.compareType!==P&&(this.compareType=e.compareType),e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.formula!==O&&e.formula!==P&&(this.formula=e.formula),e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank),e.integerValue!==O&&e.integerValue!==P&&(this.integerValue=e.integerValue)}},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.NumberCondition=a,s=function(t){function o(e,o,n){t.call(this,n),this.text=o,this.operator=e}return __extends(o,t),o.prototype.createCondition=function(){var e,t,o;switch(this.operator){case 2:e=2;break;case 3:e=4;break;case 0:e=6;break;case 1:e=7;break;default:e=0}return t=this.isFormula(this.text)?this.text:O,(o=new l(e,this.text,t)).ignoreCase=!0,o.useWildCards=2!==this.operator&&3!==this.operator,o},o.prototype.reset=function(){this.operator=0,this.text="",this.style=O,this._stopIfTrue=!1,this._priority=1},o.prototype.isFormula=function(e){return e!==P&&e!==O&&"="===e[0]},o.prototype.toJSON=function(){var t,o,n={ruleType:2,ranges:this.ranges,style:this.style,operator:this.operator,text:this.text,priority:this._priority,stopIfTrue:this._stopIfTrue},r={};for(t in n)o=n[t],this._isDefaultValue(t,o)||(r[t]=o);return e.GC$.isEmptyObject(r)?P:r},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.operator!==O&&t.operator!==P&&(this.operator=t.operator),t.text!==O&&t.text!==P&&(this.text=t.text),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.SpecificTextRule=s,l=function(t){function o(o,n,r){t.call(this);var i=this;i.forceValue2Text=!1,i.useWildCards=!0,i.regex=O,i.ignoreCase=!1,i.conditionType="TextCondition",i.questionMarkWildcard="?",i.questionMarkWildcardRegularExpression=".",i.asteriskWildcard="*",i.asteriskWildcardRegularExpression="[.\n]*",i.ignoreBlank=!1,i.compareType=o,i.expected=n,i.formula="string"==typeof r?G(e.GC$.trim(r),"="):r}return __extends(o,t),o.prototype.evaluate=function(e,t,o,n){var r,i=this,a=O;if(!0===i.forceValue2Text||"string"==typeof n||"number"==typeof n)a=n!==P&&n!==O?n.toString():"";else{if(n instanceof Date)return 2!==i.compareType&&4!==i.compareType&&6!==i.compareType&&(3===i.compareType||5===i.compareType||7===i.compareType);a=n!==P&&n!==O?n.toString():""}if(i.ignoreBlank&&(a===P||a===O||""===a))return!0;if(r=i.getExpectedString(e,t,o),i.hasWildcard(r)&&"number"==typeof n)return 3===i.compareType||7===i.compareType||5===i.compareType||1===i.compareType;switch(i.compareType){case 0:return i.isEquals(r,a);case 1:return!i.isEquals(r,a);case 2:return i.isStartWith(r,a);case 3:return!i.isStartWith(r,a);case 4:return i.isEndWith(r,a);case 5:return!i.isEndWith(r,a);case 6:return i.isContains(r,a);case 7:return!i.isContains(r,a)}return!1},o.prototype.getExpectedString=function(e,t,o){var n=this.getExpected(e,t,o);return n===P||n===O?O:n.toString()},o.prototype.getExpected=function(e,t,o){var n,r;return this.formula&&this.formula.length>0?(n=e.getCalcService())?(r=n.parse(e._getSheetSource(),this.formula,t-this.offsetRow,o-this.offsetCol),n.evaluateParsedFormula(e._getSheetSource(),r,t,o,!1,!1)):this.expected:this.expected},o.prototype.hasWildcard=function(e){return e!==P&&e!==O&&""!==e&&(e.indexOf(this.asteriskWildcard)>-1||e.indexOf(this.questionMarkWildcard)>-1)},o.prototype.isEquals=function(e,t){var o,n,r;return this.useWildCards&&this.hasWildcard(e)?!(!(o=this.createEqualsRegex(e))||(n=t===P&&t===O?"":t,o.lastIndex=-1,n===P||n===O))&&n.search(o)>-1:t!==P&&t!==O&&""!==t?(r=e!==P&&e!==O?e:"",this.ignoreCase?r.toLowerCase()===t.toLowerCase():r===t):e===P||e===O||""===e},o.prototype.createEqualsRegex=function(e){var t,o,n,r;if(this.regex)return this.regex;t=e=this.encodeExpression(e),o=new RegExp("\\"+this.questionMarkWildcard,"g"),t=t.replace(o,this.questionMarkWildcardRegularExpression),o=new RegExp("\\"+this.asteriskWildcard,"g"),t=t.replace(o,this.asteriskWildcardRegularExpression),n=O;try{r=this.ignoreCase?"ig":"g",n=new RegExp("^"+t+"$",r)}catch(e){return O}return n},o.prototype.encodeExpression=function(e){if(!e)return O;var t=e;return(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\^/g,"\\^")).replace(/\$/g,"\\$")).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")).replace(/\[/g,"\\[")).replace(/\]/g,"\\]")).replace(/\{/g,"\\{")).replace(/\}/g,"\\}")).replace(/\./g,"\\.")).replace(/\+/g,"\\+")).replace(/\|/g,"\\|")},o.prototype.isStartWith=function(e,t){var o,n,r;return this.useWildCards&&this.hasWildcard(e)?!(!(n=this.createStartWithRegex(e))||(o=t===P||t===O?"":t,n.lastIndex=-1,o===P||o===O))&&o.search(n)>-1:t!==P&&t!==O&&""!==t?e!==P&&e!==O&&(r=e,o=t,this.ignoreCase&&(r=r.toLowerCase(),o=o.toLowerCase()),o.slice(0,r.length)===r):e===P||e===O||""===e},o.prototype.createStartWithRegex=function(e){var t,o,n,r;if(this.regex)return this.regex;t=e=this.encodeExpression(e),o=new RegExp("\\"+this.questionMarkWildcard,"g"),t=t.replace(o,this.questionMarkWildcardRegularExpression),o=new RegExp("\\"+this.asteriskWildcard,"g"),t=t.replace(o,this.asteriskWildcardRegularExpression),n=O;try{r=this.ignoreCase?"ig":"g",n=e[0]===this.asteriskWildcard?new RegExp(t,r):new RegExp("^"+t,r)}catch(e){return O}return n},o.prototype.isEndWith=function(e,t){var o,n,r;return this.useWildCards&&this.hasWildcard(e)?!(!(n=this.createEndWithRegex(e))||(o=t===P||t===O?"":t,n.lastIndex=-1,o===P||o===O))&&o.search(n)>-1:t!==P&&t!==O&&""!==t?e!==P&&e!==O&&(r=e,o=t,this.ignoreCase&&(r=r.toLowerCase(),o=o.toLowerCase()),o.slice(-r.length)===r):e===P||e===O||""===e},o.prototype.createEndWithRegex=function(e){var t,o,n,r;if(this.regex)return this.regex;t=e=this.encodeExpression(e),o=new RegExp("\\"+this.questionMarkWildcard,"g"),t=t.replace(o,this.questionMarkWildcardRegularExpression),o=new RegExp("\\"+this.asteriskWildcard,"g"),t=t.replace(o,this.asteriskWildcardRegularExpression),n=O;try{r=this.ignoreCase?"ig":"g",n=e[e.length-1]===this.asteriskWildcard?new RegExp(t,r):new RegExp(t+"$",r)}catch(e){return O}return n},o.prototype.isContains=function(e,t){var o,n,r;return this.useWildCards&&this.hasWildcard(e)?!(!(n=this.createContainsRegex(e))||(o=t===P||t===O?"":t,n.lastIndex=-1,o===P||o===O))&&o.search(n)>-1:t!==P&&t!==O&&""!==t?(r=e===P||e===O?"":e,o=t,this.ignoreCase&&(r=r.toLowerCase(),o=o.toLowerCase()),o.indexOf(r)>-1):e===P||e===O||""===e},o.prototype.createContainsRegex=function(e){var t,o,n,r;if(this.regex)return this.regex;t=e=this.encodeExpression(e),o=new RegExp("\\"+this.questionMarkWildcard,"g"),t=t.replace(o,this.questionMarkWildcardRegularExpression),o=new RegExp("\\"+this.asteriskWildcard,"g"),t=t.replace(o,this.asteriskWildcardRegularExpression),n=O;try{r=this.ignoreCase?"ig":"g",n=new RegExp(t,r)}catch(e){return O}return n},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.compareType=0,this.useWildCards=!0,this.ignoreCase=!1,this.forceValue2Text=!1},o.prototype._isDefaultValue=function(e,t){switch(e){case"forceValue2Text":return!1===t;case"useWildCards":return!0===t;case"ignoreCase":return!1===t;case"regex":return t===O;case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={compareType:this.compareType,expected:this.expected,formula:this.formula,forceValue2Text:this.forceValue2Text,useWildCards:this.useWildCards,ignoreCase:this.ignoreCase,regex:this.regex,conType:2,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){if(e){e.compareType!==O&&e.compareType!==P&&(this.compareType=e.compareType),e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.formula!==O&&e.formula!==P&&(this.formula=e.formula),e.forceValue2Text!==O&&e.forceValue2Text!==P&&(this.forceValue2Text=e.forceValue2Text),e.useWildCards!==O&&e.useWildCards!==P&&(this.useWildCards=e.useWildCards),e.ignoreCase!==O&&e.ignoreCase!==P&&(this.ignoreCase=e.ignoreCase),e.regex!==O&&e.regex!==P&&(this.regex=e.regex),e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank)}},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.TextCondition=l,u=function(t){function o(e,o){t.call(this),this.conditionType="ColorCondition",this.ignoreBlank=!1,this.compareType=e,this.expected=o}return __extends(o,t),o.prototype.evaluate=function(e,t,o,n){return this.isEqualsColor(e,n)},o.prototype.isEqualsColor=function(e,t){var o,n,r=this.getColorFromString(this.expected);if(r!==P&&r!==O&&""!==r){if((o=this.getColorFromString(t))!==P&&o!==O&&""!==o)return o.a===r.a&&o.r===r.r&&o.g===r.g&&o.b===r.b;if(0===this.compareType?e&&e.getDefaultStyle&&(n=e.getDefaultStyle().backColor):1===this.compareType&&e&&e.getDefaultStyle&&(n=e.getDefaultStyle().foreColor),n)return r.a===n.a&&r.r===n.r&&r.g===n.g&&r.b===n.b}else if(this.ignoreBlank)return!0;return!1},o.prototype.getColorFromString=function(t){return t===P||t===O||""===t?O:e._Color.parse(t)},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.compareType=0},o.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={compareType:this.compareType,expected:this.expected,conType:3,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){e&&(e.compareType!==O&&e.compareType!==P&&(this.compareType=e.compareType),e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank))},o}(t),e.ColorCondition=u,c=function(t){function o(o,n){if(t.call(this,n),o&&"string"!=typeof o)throw new Error(e.SR.Exp_InvalidArgument);this.formula=o}return __extends(o,t),o.prototype.createCondition=function(){var e,t,o,n=this.ranges,r=new h(4,this.formula&&""!==this.formula?this.formula:O);if(n&&n.length>0){for(e=n[0].row,t=n[0].col,o=1;o<n.length;o++)e=e>n[o].row?n[o].row:e,t=t>n[o].col?n[o].col:t;e=-1===e?0:e,t=-1===t?0:t,r._baseRow=e,r._baseCol=t}return r},o.prototype.reset=function(){this.formula=O,this.style=O,this._stopIfTrue=!1,this._priority=1},o.prototype.isFormula=function(e){return e&&"="===e[0]},o.prototype.toJSON=function(){var e,t,o={ruleType:3,ranges:this.ranges,style:this.style,formula:this.formula,priority:this._priority,stopIfTrue:this._stopIfTrue},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.formula!==O&&t.formula!==P&&(this.formula=t.formula),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.FormulaRule=c,h=function(t){function o(o,n){var r,i;t.call(this),this.expected=O,this.ignoreBlank=!1,this.conditionType="FormulaCondition",this._baseRow=O,this._baseCol=O,this._expr=O,this.customValueType=o,"string"==typeof(r=n)&&(r="="===(i=e.GC$.trim(r))[0]?i.substr(1):i),this.formula=r}return __extends(o,t),o.prototype.evaluate=function(t,o,n,r){var i,a;if(!e.util.hasCalc())return!1;if(this,4===this.customValueType){if(i=this.getExpected(t,o,n),this.ignoreBlank&&(i===P||i===O||""===i))return!0;try{return z.B(i)}catch(e){return!1}}else switch(a=z.err,this.customValueType){case 0:return r===P||r===O||""===r;case 1:return r!==P&&r!==O&&""!==r;case 2:return a(r);case 3:return!a(r)}return!1},o.prototype.getExpected=function(t,o,n){var r,i,a,s,l,u,c,h,p,d=this;if(d.formula&&d.formula.length>0){if(!(r=t.getCalcService()))return d.expected;if(d._expr||((d._baseRow===P||d._baseRow===O)&&(d._baseCol===P||d._baseCol===O)&&(d._baseRow=o,d._baseCol=n),d._expr=r.parse(t._getSheetSource(),d.formula,d._baseRow,d._baseCol)),i=r.evaluateParsedFormula(t._getSheetSource(),d._expr,o,n,!0),z.ref(i)){for(a=i.getRowCount(0),s=i.getColumnCount(0),l=[],u=0;u<a;u++)for(l[u]=[],c=0;c<s;c++)l[u][c]=i.getValue(0,u,c);i=l}else if(z.arr(i)){for(a=i.getRowCount(),s=i.getColumnCount(),l=[],u=0;u<a;u++)for(l[u]=[],c=0;c<s;c++)l[u][c]=i.getValue(u,c);i=l}return i instanceof Array?(a=i.length,s=i[0].length,1===a&&1===s?i[0][0]:(h=o-d._baseRow,p=n-d._baseCol,h<a&&p<s?i[h][p]:e.Calc.Errors.NotAvailable)):i}return d.expected},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.customValueType=0,this._expr=O,this._baseRow=O,this._baseCol=O},o.prototype._isDefaultValue=function(e,t){switch(e){case"expected":return t===O;case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={customValueType:this.customValueType,expected:this.expected,formula:this.formula,conType:4,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){if(e){e.customValueType!==O&&e.customValueType!==P&&(this.customValueType=e.customValueType),e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.formula!==O&&e.formula!==P&&(this.formula=e.formula),e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank)}},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0],this._expr=null},o}(t),e.FormulaCondition=h,p=function(t){function o(o,n,r){t.call(this);this.conditionType="DateCondition",this.ignoreBlank=!1,this.compareType=o,this.expected=n,this.formula="string"==typeof r?G(e.GC$.trim(r),"="):r}return __extends(o,t),o.prototype.evaluate=function(e,t,o,n){var r,i=this;if((n===P||n===O||""===n)&&i.ignoreBlank)return!0;if(!(n instanceof Date))return!1;if((r=i.getExpectedDateTime(e,t,o))===P||r===O)return!!i.ignoreBlank;switch(i.compareType){case 0:return i.isEquals(r,n);case 1:return!i.isEquals(r,n);case 4:return i.isAfter(r,n);case 5:return i.isAfter(r,n)||i.isEquals(r,n);case 2:return i.isBefore(r,n);case 3:return i.isBefore(r,n)||i.isEquals(r,n)}return!1},o.prototype.getExpectedDateTime=function(t,o,n){var r=this.getExpected(t,o,n);return r instanceof Date?r:"string"==typeof r?e._DateTimeHelper.parseLocale(r):O},o.prototype.getExpected=function(e,t,o){var n,r;return this.formula&&this.formula.length>0?(n=e.getCalcService())?(r=n.parse(e._getSheetSource(),this.formula,t-this.offsetRow,o-this.offsetCol),n.evaluateParsedFormula(e._getSheetSource(),r,t,o,!1)):this.expected:this.expected},o.prototype.isEquals=function(e,t){return e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},o.prototype.isAfter=function(e,t){return t>this.createDayEnding(e)},o.prototype.createDayEnding=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)},o.prototype.isBefore=function(e,t){return t<this.createDayBeginning(e)},o.prototype.createDayBeginning=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.compareType=0},o.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={compareType:this.compareType,expected:this.expected,formula:this.formula,conType:5,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){if(t){t.compareType!==O&&t.compareType!==P&&(this.compareType=t.compareType),t.expected!==O&&t.expected!==P&&(this.expected="string"===e.GC$.getType(t.expected)?new Date(t.expected):t.expected),t.formula!==O&&t.formula!==P&&(this.formula=t.formula),t.ignoreBlank!==O&&t.ignoreBlank!==P&&(this.ignoreBlank=t.ignoreBlank)}},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.DateCondition=p,d=function(t){function o(e,o){t.call(this,o),this.type=e}return __extends(o,t),o.prototype.createCondition=function(){return new f(this.type)},o.prototype.reset=function(){this.type=0,this.style=O,this._stopIfTrue=!1,this._priority=1},o.prototype.toJSON=function(){var e,t,o={ruleType:4,ranges:this.ranges,style:this.style,type:this.type,priority:this._priority,stopIfTrue:this._stopIfTrue},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.type!==O&&t.type!==P&&(this.type=t.type),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.DateOccurringRule=d,f=function(e){function t(t){e.call(this);this.ignoreBlank=!1,this.formula=O,this.expectTypeId=0,this.conditionType="DateExCondition",this.expected=t}return __extends(t,e),t.prototype.evaluate=function(e,t,o,n){var r=this.getExpectedInt(e,t,o);return r!==P&&r!==O&&this.checkCondition(r,n)},t.prototype.getExpectedInt=function(e,t,o){var n=this.getExpected(e,t,o);return n=parseInt(n,10),isNaN(n)?O:n},t.prototype.getExpected=function(e,t,o){var n,r;return this.formula&&this.formula.length>0?(n=e.getCalcService())?(r=n.parse(e._getSheetSource(),this.formula,t-this.offsetRow,o-this.offsetCol),n.evaluateParsedFormula(e._getSheetSource(),r,t,o,!1)):this.expected:this.expected},t.prototype.checkCondition=function(e,t){var o,r,i,a,s,l,u,c,h,d,f,g,m,_=this,y=t;if(_.ignoreBlank&&(y===P||y===O||""===y))return!0;try{y=z.DT(y)}catch(e){return!1}if(0===_.expectTypeId){var C=O,w=O,v=new Date,S=new Date(v.getFullYear(),v.getMonth(),v.getDate(),v.getHours(),v.getMinutes(),v.getSeconds(),v.getMilliseconds());switch(e){case 3:S.setDate(S.getDate()-6),C=new Date(S.getFullYear(),S.getMonth(),S.getDate(),0,0,0,0),w=new Date(v.getFullYear(),v.getMonth(),v.getDate(),23,59,59,999);break;case 1:S.setDate(S.getDate()-1),C=new Date(S.getFullYear(),S.getMonth(),S.getDate(),0,0,0,0),w=new Date(S.getFullYear(),S.getMonth(),S.getDate(),23,59,59,999);break;case 0:C=new Date(v.getFullYear(),v.getMonth(),v.getDate(),0,0,0,0),w=new Date(v.getFullYear(),v.getMonth(),v.getDate(),23,59,59,999);break;case 2:S.setDate(S.getDate()+1),C=new Date(S.getFullYear(),S.getMonth(),S.getDate(),0,0,0,0),w=new Date(S.getFullYear(),S.getMonth(),S.getDate(),23,59,59,999);break;case 8:(r=v).setDate(v.getDate()-v.getDay()-7),(i=S).setDate(S.getDate()-S.getDay()-1),C=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0),w=new Date(i.getFullYear(),i.getMonth(),i.getDate(),23,59,59,999);break;case 7:(a=v).setDate(v.getDate()-v.getDay()),(s=S).setDate(S.getDate()-S.getDay()+6),C=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),w=new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59,999);break;case 9:(l=v).setDate(v.getDate()-v.getDay()+7),(u=S).setDate(S.getDate()-S.getDay()+13),C=new Date(l.getFullYear(),l.getMonth(),l.getDate(),0,0,0,0),w=new Date(u.getFullYear(),u.getMonth(),u.getDate(),23,59,59,999);break;case 5:(c=v).setDate(1),c.setMonth(v.getMonth()-1),(h=S).setDate(0),C=new Date(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0,0),w=new Date(h.getFullYear(),h.getMonth(),h.getDate(),23,59,59,999);break;case 4:(d=v).setDate(1),(f=S).setDate(1),f.setMonth(S.getMonth()+1),f.setDate(0),C=new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0,0),w=new Date(f.getFullYear(),f.getMonth(),f.getDate(),23,59,59,999);break;case 6:(g=v).setDate(1),g.setMonth(v.getMonth()+1),(m=S).setDate(1),m.setMonth(S.getMonth()+2),m.setDate(0),C=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0),w=new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59,59,999)}if(C!==P&&C!==O&&w!==P&&w!==O){var x=new p(5,C,O),R=new p(3,w,O);return new n(1,x,R).evaluate(O,0,0,y)}}else if(1===_.expectTypeId){if((o=_.getExpectedInt(O,0,0))!==P&&o!==O)return _.isEqualsYear(o,y)}else if(2===_.expectTypeId){if((o=_.getExpectedInt(O,0,0))!==P&&o!==O)return _.isEqualsQuarter(o,y)}else if(3===_.expectTypeId){if((o=_.getExpectedInt(O,0,0))!==P&&o!==O)return _.isEqualsMonth(o,y)}else if(4===_.expectTypeId){if((o=_.getExpectedInt(O,0,0))!==P&&o!==O)return _.isEqualsWeek(o,y)}else if(5===_.expectTypeId&&((o=_.getExpectedInt(O,0,0))!==P&&o!==O))return _.isEqualsDay(o,y);return!1},t.prototype.isEqualsYear=function(e,t){return e===t.getFullYear()},t.prototype.isEqualsQuarter=function(e,t){switch(e){case 0:return t.getMonth()>=0&&t.getMonth()<=2;case 1:return t.getMonth()>=3&&t.getMonth()<=5;case 2:return t.getMonth()>=6&&t.getMonth()<=8;case 3:return t.getMonth()>=9&&t.getMonth()<=11}return!1},t.prototype.isEqualsMonth=function(e,t){return e===t.getMonth()},t.prototype.isEqualsWeek=function(e,t){return e===t.getDay()},t.prototype.isEqualsDay=function(e,t){return e===t.getDate()},t.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.expectTypeId=0},t.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":return!1===t;case"formula":return t===O;case"expectTypeId":return 0===t;default:return!1}},t.prototype.toJSON=function(){var e,t,o={ignoreBlank:this.ignoreBlank,formula:this.formula,expected:this.expected,expectTypeId:this.expectTypeId,conType:6},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},t.prototype.fromJSON=function(e,t){if(e){e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank),e.formula!==O&&e.formula!==P&&(this.formula=e.formula),e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.expectTypeId!==O&&e.expectTypeId!==P&&(this.expectTypeId=e.expectTypeId)}},t.fromDay=function(e){var o=new t(e);return o.expectTypeId=5,o},t.fromMonth=function(e){var o=new t(e);return o.expectTypeId=3,o},t.fromQuarter=function(e){var o=new t(e);return o.expectTypeId=2,o},t.fromWeek=function(e){var o=new t(e);return o.expectTypeId=4,o},t.fromYear=function(e){var o=new t(e);return o.expectTypeId=1,o},t.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},t.prototype.setFormulas=function(e){this.formula=e[0]},t}(t),e.DateExCondition=f,g=function(t){function o(o,n,r){t.call(this);this.ignoreBlank=!1,this.conditionType="TextLengthCondition",this.compareType=o,this.expected=n,this.formula="string"==typeof r?G(e.GC$.trim(r),"="):r}return __extends(o,t),o.prototype.evaluate=function(e,t,o,n){if(n===P||n===O||""===n)return this.ignoreBlank;var r=n===P||n===O?0:n.toString().length,i=this.getExpectedInt(e,t,o);if("number"==typeof i)switch(this.compareType){case 0:return r===i;case 2:return r>i;case 3:return r>=i;case 4:return r<i;case 5:return r<=i;case 1:return r!==i}return!1},o.prototype.getExpectedInt=function(e,t,o){var n=this.getExpected(e,t,o);return n=parseInt(n,10),isNaN(n)?O:n},o.prototype.getExpected=function(e,t,o){var n,r;return this.formula&&this.formula.length>0?(n=e.getCalcService())?(r=n.parse(e._getSheetSource(),this.formula,t-this.offsetRow,o-this.offsetCol),n.evaluateParsedFormula(e._getSheetSource(),r,t,o,!1)):this.expected:this.expected},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.compareType=0},o.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={compareType:this.compareType,expected:this.expected,formula:this.formula,conType:7,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){if(e){e.compareType!==O&&e.compareType!==P&&(this.compareType=e.compareType),e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.formula!==O&&e.formula!==P&&(this.formula=e.formula),e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank)}},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.TextLengthCondition=g,m=function(t){function o(e,o,n){t.call(this,n),this.type=e,this.rank=o}return __extends(o,t),o.prototype.createCondition=function(){return new _(this.type,this.rank,this.ranges)},o.prototype.reset=function(){this.type=0,this.rank=10,this.style=O,this._stopIfTrue=!1,this._priority=1},o.prototype.toJSON=function(){var e,t,o={ruleType:5,ranges:this.ranges,style:this.style,type:this.type,rank:this.rank,priority:this._priority,stopIfTrue:this._stopIfTrue},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.type!==O&&t.type!==P&&(this.type=t.type),t.rank!==O&&t.rank!==P&&(this.rank=t.rank),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.Top10Rule=m,_=function(t){function o(e,o,n){t.call(this);this.isPercent=!1,this.ignoreBlank=!1,this.conditionType="Top10Condition",this.formula=O,this.expected=o,this.type=e,this.ranges=n}return __extends(o,t),o.prototype.evaluate=function(t,o,n,r){var i,a,s;if(r===P||r===O||""===r)return this.ignoreBlank;if((i=this.getExpectedInt(t,o,n))!==P&&i!==O&&(a=O,0===this.type?a=this.getMaxValues(t,i,this.ranges):1===this.type&&(a=this.getMinValues(t,i,this.ranges)),a)){s=0;try{s=this._toDouble(r)}catch(e){return!1}if(e.ArrayHelper.contains(a,s))return!0}return!1},o.prototype.getExpectedInt=function(e,t,o){var n=this.getExpected(e,t,o);return n=parseInt(n,10),isNaN(n)||!isFinite(n)?O:n},o.prototype.getExpected=function(e,t,o){var n,r;return this.formula&&this.formula.length>0?(n=e.getCalcService())?(r=n.parse(e._getSheetSource(),this.formula,t,o),n.evaluateParsedFormula(e._getSheetSource(),r,t,o,!1)):this.expected:this.expected},o.prototype.adjustRange=function(t,o){return new e.Range(t.row,t.col,Math.min(t.rowCount,o.getRowCount()),Math.min(t.colCount,o.getColumnCount()))},o.prototype.getMaxValues=function(t,o,n){var r,i,a,s,l,u=[];if(!n)return u;var c,h,p,d,f,g,m,_=this._cloneToActualRanges(t,n),y=Number.MAX_VALUE,C=0,w=_.length;for(r=0;r<w;r++)for(c=_[r],h=(c=this.adjustRange(c,t)).rowCount,p=c.colCount,i=0;i<h;i++)for(d=i+c.row,a=0;a<p;a++)if(f=a+c.col,g=t.getValue(d,f),m=this._toDouble(g),typeof g!==L&&g!==O&&typeof m!==L&&m!==O)try{if(C<o)u.push(m),m<y&&(y=m),C++;else if(m>y&&(e.ArrayHelper.remove(u,y),u.push(m),e.ArrayHelper.indexOf(u,y)<0))for(y=m,s=0,l=u.length;s<l;s++)u[s]<y&&(y=u[s])}catch(e){}return u},o.prototype.getMinValues=function(t,o,n){var r,i,a,s,l,u=[];if(!n)return u;var c,h,p,d,f,g,m,_=this._cloneToActualRanges(t,n),y=-Number.MAX_VALUE,C=0,w=_.length;for(r=0;r<w;r++)for(c=_[r],h=(c=this.adjustRange(c,t)).rowCount,p=c.colCount,i=0;i<h;i++)for(d=i+c.row,a=0;a<p;a++)if(f=a+c.col,g=t.getValue(d,f),m=this._toDouble(g),typeof g!==L&&g!==O&&typeof m!==L&&m!==O)try{if(C<o)u.push(m),m>y&&(y=m),C++;else if(m<y&&(e.ArrayHelper.remove(u,y),u.push(m),e.ArrayHelper.indexOf(u,y)<0))for(y=m,s=0,l=u.length;s<l;s++)u[s]>y&&(y=u[s])}catch(e){}return u},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.type=0,this.isPercent=!1,this.ranges=O},o.prototype._toDouble=function(t){return("number"==typeof t||t instanceof Date)&&e.util.hasCalc()?z.D(t):O},o.prototype._isDefaultValue=function(e,t){switch(e){case"formula":return t===O;case"isPercent":case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={expected:this.expected,formula:this.formula,type:this.type,isPercent:this.isPercent,ignoreBlank:this.ignoreBlank,ranges:this.ranges,conType:8},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r,i;if(t&&(n=this,t.expected!==O&&t.expected!==P&&(n.expected=t.expected),t.formula!==O&&t.formula!==P&&(n.formula=t.formula),t.type!==O&&t.type!==P&&(n.type=t.type),t.isPercent!==O&&t.isPercent!==P&&(n.isPercent=t.isPercent),t.ignoreBlank!==O&&t.ignoreBlank!==P&&(n.ignoreBlank=t.ignoreBlank),t.ranges))for(n.ranges=[],r=0;r<t.ranges.length;r++)i=t.ranges[r],n.ranges.push(new e.Range(i.row,i.col,i.rowCount,i.colCount))},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.Top10Condition=_,y=function(t){function o(e){t.call(this,e)}return __extends(o,t),o.prototype.createCondition=function(){return new w(!1,this.ranges)},o.prototype.toJSON=function(){var e,t,o={ruleType:6,ranges:this.ranges,style:this.style,priority:this._priority,stopIfTrue:this._stopIfTrue},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.UniqueRule=y,C=function(t){function o(e){t.call(this,e)}return __extends(o,t),o.prototype.createCondition=function(){return new w(!0,this.ranges)},o.prototype.toJSON=function(){var e,t,o={ruleType:7,ranges:this.ranges,style:this.style,priority:this._priority,stopIfTrue:this._stopIfTrue},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.DuplicateRule=C,w=function(t){function o(e,o){t.call(this);this.conditionType="UniqueCondition",this.ignoreBlank=!1,this.formula=O,this.expected=e,this.ranges=o}return __extends(o,t),o.prototype.evaluate=function(t,o,n,r){var i,a,s=r;return s===P||s===O||""===s?this.ignoreBlank:(e.util.hasCalc()&&z.num(s)&&(s=z.D(s)),(i=this.getExpectedBoolean(t,o,n))!==P&&i!==O&&((a=this.getDuplicated(t,this.ranges))!==P&&a!==O&&e.ArrayHelper.contains(a,s)?!0===i:!0!==i))},o.prototype.getExpectedBoolean=function(e,t,o){var n=this.getExpected(e,t,o);try{return z.B(n)}catch(e){return O}},o.prototype.getExpected=function(e,t,o){var n,r;return this.formula&&this.formula.length>0?(n=e.getCalcService())?(r=n.parse(e._getSheetSource(),this.formula,t-this.offsetRow,o-this.offsetCol),n.evaluateParsedFormula(e._getSheetSource(),r,t,o,!1)):this.expected:this.expected},o.prototype.adjustRange=function(t,o){return new e.Range(t.row,t.col,Math.min(t.rowCount,o.getRowCount()),Math.min(t.colCount,o.getColumnCount()))},o.prototype.getDuplicated=function(t,o){var n,r,i,a,s,l,u,c,h=[],p=[],d=this._cloneToActualRanges(t,o);if(d){for(n=d.length,r=0;r<n;r++)for(i=d[r],i=this.adjustRange(i,t),a=0;a<i.rowCount;a++)for(s=a+i.row,l=0;l<i.colCount;l++)u=l+i.col,(c=t.getValue(s,u,3))!==P&&c!==O&&e.util.hasCalc()&&z.num(c)&&(c=z.D(c)),h.push(c);h.sort();for(var f=0,g=0,m=h.length,_=h[f];g<m;)h[g]!==_&&(g!==f+1&&p.push(_),_=h[f=g]),g++;f!==m-1&&p.push(_)}return h=O,p},o.prototype._containsKey=function(e,t){for(var o=e.length,n=0;n<o;n++)if(e[n].key===t)return!0;return!1},o.prototype.reset=function(){this.expected=O,this.ignoreBlank=!1,this.ranges=O},o.prototype._isDefaultValue=function(e,t){switch(e){case"formula":return t===O;case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={expected:this.expected,formula:this.formula,ranges:this.ranges,conType:9,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.expected!==O&&t.expected!==P&&(this.expected=t.expected),t.formula!==O&&t.formula!==P&&(this.formula=t.formula),t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.ignoreBlank!==O&&t.ignoreBlank!==P&&(this.ignoreBlank=t.ignoreBlank)}},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.UniqueCondition=w,v=function(t){function o(e,o){t.call(this,o),this.type=e}return __extends(o,t),o.prototype.createCondition=function(){return new S(this.type,this.ranges)},o.prototype.reset=function(){this.type=0,this.style=O,this._stopIfTrue=!1,this._priority=1},o.prototype.toJSON=function(){var e,t,o={ruleType:8,ranges:this.ranges,style:this.style,type:this.type,priority:this._priority,stopIfTrue:this._stopIfTrue},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.style&&(this.style=new e.Style,this.style.fromJSON(t.style,o)),t.type!==O&&t.type!==P&&(this.type=t.type),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),t.stopIfTrue!==O&&t.stopIfTrue!==P&&(this._stopIfTrue=t.stopIfTrue)}},o}(o),e.AverageRule=v,S=function(t){function o(e,o){t.call(this);this.conditionType="AverageCondition",this.ignoreBlank=!1,this._expr=O,this._stdevExpr=O,this.type=e,this.ranges=o}return __extends(o,t),o.prototype.evaluate=function(t,o,n,r){var i,a;if(!e.util.hasCalc())return!1;if(this,this.ignoreBlank&&(r===P||r===O||""===r))return!0;i=z.D,this._rebuildFormula();var s=this.getExpectedDouble(t,o,n),l=O,u=this._stdevExpr?this._getExpectedByExpression(t,this._stdevExpr,o,n):O;if(u!==P&&u!==O)try{l=i(u)}catch(e){l=NaN}if(z.num(r)&&(a=i(r),!isNaN(s)))switch(this.type){case 0:return a>s;case 1:return a<s;case 2:return a>=s;case 3:return a<=s;case 4:return!isNaN(l)&&a>s+l;case 5:return!isNaN(l)&&a<s-l;case 6:return!isNaN(l)&&a>s+2*l;case 7:return!isNaN(l)&&a<s-2*l;case 8:return!isNaN(l)&&a>s+3*l;case 9:return!isNaN(l)&&a<s-3*l}return!1},o.prototype._rebuildFormula=function(){var e=this;e.ranges&&(e._expr=e._createExpression("AVERAGE",e.ranges),(4===e.type||5===e.type||6===e.type||7===e.type||8===e.type||9===e.type)&&(e._stdevExpr=e._createExpression("STDEV",e.ranges)))},o.prototype._createExpression=function(t,o){var n,r,i;if(!e.util.hasCalc())return O;var a=e.Calc.Expressions,s=e.Calc.Functions.findGlobalFunction(t);if(s){for(n=[],r=o.length,i=0;i<r;i++)n[i]=W(o[i]);return new a.FunctionExpression(s,n)}return O},o.prototype.getExpectedDouble=function(e,t,o){var n=this.getExpected(e,t,o);try{return z.D(n)}catch(e){return NaN}},o.prototype.getExpected=function(e,t,o){var n,r=e.getCalcService();return r?(n=r.unparseWithoutCulture(O,this._expr,t,o),this._expr=r.parse(e._getSheetSource(),n,t,o),r.evaluateParsedFormula(e._getSheetSource(),this._expr,t,o,!1)):O},o.prototype._getExpectedByExpression=function(e,t,o,n){var r,i=e.getCalcService();return i?(r=i.unparseWithoutCulture(O,t,o-this.offsetRow,n-this.offsetCol),t=i.parse(e._getSheetSource(),r,o,n),i.evaluateParsedFormula(e._getSheetSource(),t,o,n,!1)):O},o.prototype.reset=function(){this.ignoreBlank=!1,this.type=0,this.ranges=O,this._expr=O,this._stdevExpr=O},o.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={type:this.type,ranges:this.ranges,conType:10,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r;if(t){if(this,t.type!==O&&t.type!==P&&(this.type=t.type),t.ranges)for(this.ranges=[],n=0;n<t.ranges.length;n++)r=t.ranges[n],this.ranges.push(new e.Range(r.row,r.col,r.rowCount,r.colCount));t.ignoreBlank!==O&&t.ignoreBlank!==P&&(this.ignoreBlank=t.ignoreBlank)}},o}(t),e.AverageCondition=S,x=function(){return function(e,t){this.type=e,this.value=t}}(),e.ScaleValue=x,R=function(t){function o(e,o,n){t.call(this,O);this.expected=[],this.lowestValueCached=O,this.highestValueCached=O,this.cached=!1,this._oldRanges=O,this.scales=[e,o,n]}return __extends(o,t),o.prototype.stopIfTrue=function(){return this._stopIfTrue},o.prototype.isScaleRule=function(){return!0},o.prototype.createCondition=function(){return O},o.prototype._calculateLowestValueEx=function(e){var t=(new _).getMinValues(e,1,this.ranges);return t.length>0?t[0]:O},o.prototype._calculateHighestValueEx=function(e){var t=(new _).getMaxValues(e,1,this.ranges);return t.length>0?t[0]:O},o.prototype._cloneRanges=function(t){for(var o,n=[],r=t.length,i=0;i<r;i++)o=t[i],n.push(new e.Range(o.row,o.col,o.rowCount,o.colCount));return n},o.prototype._rangesChanged=function(){var e,t,o=this._oldRanges,n=this.ranges;if(!o)return o=this._oldRanges=this._cloneRanges(n),!1;if(o.length!==(e=n.length))return!0;for(t=0;t<e;t++)if(!o[t].equals(n[t]))return!0;return!1},o.prototype._tryCache=function(e){var t=this;t._rangesChanged()&&(t._clearCache(),t._oldRanges=t._cloneRanges(t.ranges)),!1===t.cached&&(t.lowestValueCached=t._calculateLowestValueEx(e),t.highestValueCached=t._calculateHighestValueEx(e),t.cached=!0)},o.prototype._clearCache=function(){this.lowestValueCached=O,this.highestValueCached=O,this.cached=!1},o.prototype._calculateFormula=function(e,t,o,n){var r,i;return n&&n.length>0?(r=e.getCalcService())?(i=r.parse(e._getSheetSource(),n,t,o),r.evaluateParsedFormula(e._getSheetSource(),i,t,o,!1)):O:O},o.prototype._isFormula=function(e){return e&&"="===e[0]},o.prototype._trimFormula=function(e){return e===P||e===O||""===e?O:"="===e[0]?e.substr(1):e},o.prototype._calculateValue=function(e,t,o,n){var r=O;if(this._isFormula(n))r=this._calculateFormula(e,t,o,this._trimFormula(n.toString()));else try{r=z.D(n)}catch(e){r=NaN}return r},o.prototype._getHighestValue=function(e){return this._tryCache(e),this.highestValueCached},o.prototype._getLowestValue=function(e){return this._tryCache(e),this.lowestValueCached},o.prototype._calculatePercent=function(e,t,o,n){var r,i,a=this._calculateValue(e,t,o,n);return!isNaN(a)&&0<=a&&a<=100&&(r=this._getLowestValue(e),i=this._getHighestValue(e),typeof r!==L&&r!==O&&typeof i!==L&&i!==O)?r+(i-r)*a/100:O},o.prototype._calculatePercentile=function(e,t,o,n){var r,i=this._calculateValue(e,t,o,n);if(!isNaN(i)&&0<=i&&i<=100){var a=0,s=this.ranges,l=s.length;for(r=0;r<l;r++){var u=this._createExpression("PERCENTILE",[e._getActualRange(s[r]),i/100]),c=e.getCalcService(),h=c.unparseWithoutCulture(O,u,t,o),p=(u=c.parse(e._getSheetSource(),h,t,o),c.evaluateParsedFormula(e._getSheetSource(),u,t,o,!1));try{a+=z.D(p)}catch(e){}}return a/l}return O},o.prototype._getActualValue=function(e,t,o,n,r){var i,a,s=this.scales[n];if(s)switch(s.type){case 6:return this._calculateValue(e,t,o,s.value);case 2:return this._getHighestValue(e);case 1:return this._getLowestValue(e);case 0:return this._calculateValue(e,t,o,s.value);case 3:return this._calculatePercent(e,t,o,s.value);case 4:return this._calculatePercentile(e,t,o,s.value);case 7:return(i=this._getHighestValue(e))<0?0:i;case 5:return(a=this._getLowestValue(e))>0?0:a}return O},o.prototype._evaluate2Scale=function(e,t,o){return e===t&&e===o?1:e<=t?0:e>=o?1:(e-t)/(o-t)},o.prototype.evaluate=function(e,t,o,n){if(this._tryCache(e),this.contains(t,o)){if(n===P||n===O)return O;try{var r=z.D(n),i=this._getActualValue(e,t,o,0),a=this._getActualValue(e,t,o,1),s=this._getActualValue(e,t,o,2);if(isNaN(a)){if(!isNaN(i)&&!isNaN(s))return i>s?O:this._evaluate2Scale(r,i,s)}else if(!isNaN(i)&&!isNaN(s)&&!isNaN(a))return i>s?O:r<i?0:r>=s?2:(this._evaluate2Scale(a,i,s),i<=r&&r<=a?this._evaluate2Scale(r,i,a):1+this._evaluate2Scale(r,i,s))}catch(e){return O}}return O},o.prototype._evaluateColor=function(t,o,n){if(0<=t&&t<=1){var r=e._Color.parse(o),i=e._Color.parse(n),a=r.a*(1-t)+i.a*t,s=r.r*(1-t)+i.r*t,l=r.g*(1-t)+i.g*t,u=r.b*(1-t)+i.b*t;return new e._Color(parseFloat(a/255),parseInt(s,10),parseInt(l,10),parseInt(u,10)).toString()}return O},o.prototype._createExpression=function(t,o){var n,r,i;if(!e.util.hasCalc())return O;var a=e.Calc.Expressions,s=e.Calc.Functions.findGlobalFunction(t);if(s){for(n=[],r=o.length,i=0;i<r;i++)n[i]=W(o[i]);return new a.FunctionExpression(s,n)}return O},o.prototype._addRows=function(e,o){t.prototype._addRows.call(this,e,o),this._clearCache()},o.prototype._addColumns=function(e,o){t.prototype._addColumns.call(this,e,o),this._clearCache()},o.prototype._removeRows=function(e,o){t.prototype._removeRows.call(this,e,o),this._clearCache()},o.prototype._removeColumns=function(e,o){t.prototype._removeColumns.call(this,e,o),this._clearCache()},o}(o),e.ScaleRule=R,b=function(t){function o(o,n,r,i,a,s){var l,u,c=o,h=n,p=r,d=i,f=a,g=s;0===arguments.length&&(c=1,h=O,p=new e._Color(0,255,255,255).toString(),d=2,f=O,g=new e._Color(255,99,190,123).toString()),l=new x(c,h),u=new x(d,f),t.call(this,l,O,u),this.expected[0]=p,this.expected[2]=g}return __extends(o,t),o.prototype.evaluate=function(e,t,o,n){var r,i;if(n!==P&&n!==O){r=NaN;try{z.num(n)&&(r=z.D(n))}catch(e){return O}if(isNaN(r))return O;var a=this._getActualValue(e,t,o,0),s=this._getActualValue(e,t,o,2);if(a!==P&&a!==O&&s!==P&&s!==O)return i=this._evaluate2Scale(r,a,s),this._evaluateColor(i,this.expected[0],this.expected[2])}return O},o.prototype._init=function(){this.scales=new Array(3),this.scales[0]=new x(1,O),this.scales[2]=new x(2,O),this.expected=new Array(3),this.expected[0]=new e._Color(0,255,255,255).toString(),this.expected[2]=new e._Color(255,99,190,123).toString()},o.prototype.reset=function(){this.ranges=O,this.condition=O,this.style=O,this._stopIfTrue=!1,this._priority=1,this._init()},o.prototype.getMinimumType=function(){var e=this.scales;return e&&3===e.length?e[0].type:O},o.prototype.setMinimumType=function(e){var t=this.scales;t&&3===t.length&&(t[0].type=e)},o.prototype.getMinimumValue=function(){var e=this.scales;return e&&3===e.length?e[0].value:O},o.prototype.setMinimumValue=function(e){var t=this.scales;t&&3===t.length&&(t[0].value=e)},o.prototype.getMinimumColor=function(){return this.expected&&3===this.expected.length?this.expected[0]:O},o.prototype.setMinimumColor=function(e){this.expected&&3===this.expected.length&&(this.expected[0]=e)},o.prototype.getMaximumType=function(){var e=this.scales;return e&&3===e.length?e[2].type:O},o.prototype.setMaximumType=function(e){var t=this.scales;t&&3===t.length&&(t[2].type=e)},o.prototype.getMaximumValue=function(){var e=this.scales;return e&&3===e.length?e[2].value:O},o.prototype.setMaximumValue=function(e){var t=this.scales;t&&3===t.length&&(t[2].value=e)},o.prototype.getMaximumColor=function(){return this.expected&&3===this.expected.length?this.expected[2]:O},o.prototype.setMaximumColor=function(e){this.expected&&3===this.expected.length&&(this.expected[2]=e)},o.prototype._isDefaultValue=function(e,t){switch(e){case"ranges":return t===O;case"priority":return 1===t;case"stopIfTrue":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={ruleType:10,ranges:this.ranges,minType:this.getMinimumType(),minValue:this.getMinimumValue(),minColor:this.getMinimumColor(),maxType:this.getMaximumType(),maxValue:this.getMaximumValue(),maxColor:this.getMaximumColor(),priority:this._priority},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r,i;if(t){if(n=this,t.ranges)for(n.ranges=[],r=0;r<t.ranges.length;r++)i=t.ranges[r],n.ranges.push(new e.Range(i.row,i.col,i.rowCount,i.colCount));t.minType!==O&&t.minType!==P&&n.setMinimumType(t.minType),t.minValue!==O&&t.minValue!==P&&n.setMinimumValue(t.minValue),t.minColor!==O&&t.minColor!==P&&n.setMinimumColor(t.minColor),t.maxType!==O&&t.maxType!==P&&n.setMaximumType(t.maxType),t.maxValue!==O&&t.maxValue!==P&&n.setMaximumValue(t.maxValue),t.maxColor!==O&&t.maxColor!==P&&n.setMaximumColor(t.maxColor),t.priority!==O&&t.priority!==P&&(n._priority=t.priority),n._stopIfTrue=!1}},o}(R),e.TwoScaleRule=b,T=function(t){function o(o,n,r,i,a,s,l,u,c){var h=o,p=n,d=r,f=i,g=a,m=s,_=l,y=u,C=c;0===arguments.length&&(h=1,p=O,d=new e._Color(255,248,105,107).toString(),f=4,g=50,m=new e._Color(255,255,235,132).toString(),_=2,y=O,C=new e._Color(255,99,190,123).toString()),t.call(this,new x(h,p),new x(f,g),new x(_,y)),this.expected[0]=d,this.expected[1]=m,this.expected[2]=C}return __extends(o,t),o.prototype.evaluate=function(e,t,o,n){var r,i,a=this;if(a._evaluator=e,n!==P&&n!==O){r=NaN;try{z.num(n)&&(r=z.D(n))}catch(e){return O}if(isNaN(r))return O;var s=a._getActualValue(e,t,o,0),l=a._getActualValue(e,t,o,1),u=a._getActualValue(e,t,o,2);if(s!==P&&s!==O&&u!==P||u!==O&&l!==P&&l!==O)return s>u?O:r<=s||s===u?r>=u?a.expected[2]:a.expected[0]:r>=u?a.expected[2]:s<=r&&r<=l?(i=a._evaluate2Scale(r,s,l),a._evaluateColor(i,a.expected[0],a.expected[1])):(i=a._evaluate2Scale(r,l,u),a._evaluateColor(i,a.expected[1],a.expected[2]))}return O},o.prototype._init=function(){this.scales=new Array(3),this.scales[0]=new x(1,O),this.scales[1]=new x(4,50),this.scales[2]=new x(2,O),this.expected=new Array(3),this.expected[0]=new e._Color(255,248,105,107).toString(),this.expected[1]=new e._Color(255,255,235,132).toString(),this.expected[2]=new e._Color(255,99,190,123).toString()},o.prototype.reset=function(){this.ranges=O,this.condition=O,this.style=O,this._init(),this._evaluator=O,this._stopIfTrue=!1,this._priority=1},o.prototype.getMinimumType=function(){var e=this.scales;return e&&3===e.length?e[0].type:O},o.prototype.setMinimumType=function(e){var t=this.scales;t&&3===t.length&&(t[0].type=e)},o.prototype.getMinimumValue=function(){var e=this.scales;return e&&3===e.length?e[0].value:O},o.prototype.setMinimumValue=function(e){var t=this.scales;t&&3===t.length&&(t[0].value=e)},o.prototype.getMinimumColor=function(){return this.expected&&3===this.expected.length?this.expected[0]:O},o.prototype.setMinimumColor=function(e){this.expected&&3===this.expected.length&&(this.expected[0]=e)},o.prototype.getMidpointType=function(){var e=this.scales;return e&&3===e.length?e[1].type:O},o.prototype.setMidpointType=function(e){var t=this.scales;t&&3===t.length&&(t[1].type=e)},o.prototype.getMidpointValue=function(){var e=this.scales;if(e&&3===e.length){if(this._evaluator){if(2===e[1].type)return this._getHighestValue(this._evaluator);if(1===e[1].type)return this._getLowestValue(this._evaluator)}return e[1].value}return O},o.prototype.setMidpointValue=function(e){var t=this.scales;t&&3===t.length&&(t[1].value=e)},o.prototype.getMidpointColor=function(){return this.expected&&3===this.expected.length?this.expected[1]:O},o.prototype.setMidpointColor=function(e){this.expected&&3===this.expected.length&&(this.expected[1]=e)},o.prototype.getMaximumType=function(){var e=this.scales;return e&&3===e.length?e[2].type:O},o.prototype.setMaximumType=function(e){var t=this.scales;t&&3===t.length&&(t[2].type=e)},o.prototype.getMaximumValue=function(){var e=this.scales;return e&&3===e.length?e[2].value:O},o.prototype.setMaximumValue=function(e){var t=this.scales;t&&3===t.length&&(t[2].value=e)},o.prototype.getMaximumColor=function(){return this.expected&&3===this.expected.length?this.expected[2]:O},o.prototype.setMaximumColor=function(e){this.expected&&3===this.expected.length&&(this.expected[2]=e)},o.prototype._isDefaultValue=function(e,t){switch(e){case"ranges":return t===O;case"priority":return 1===t;case"stopIfTrue":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o=this,n={ruleType:11,ranges:o.ranges,minType:o.getMinimumType(),minValue:o.getMinimumValue(),minColor:o.getMinimumColor(),midType:o.getMidpointType(),midValue:o.getMidpointValue(),midColor:o.getMidpointColor(),maxType:o.getMaximumType(),maxValue:o.getMaximumValue(),maxColor:o.getMaximumColor(),priority:o._priority},r={};for(e in n)t=n[e],o._isDefaultValue(e,t)||(r[e]=t);return r},o.prototype.fromJSON=function(t,o){var n,r,i;if(t){if(n=this,t.ranges)for(n.ranges=[],r=0;r<t.ranges.length;r++)i=t.ranges[r],n.ranges.push(new e.Range(i.row,i.col,i.rowCount,i.colCount));t.minType!==O&&t.minType!==P&&n.setMinimumType(t.minType),t.minValue!==O&&t.minValue!==P&&n.setMinimumValue(t.minValue),t.minColor!==O&&t.minColor!==P&&n.setMinimumColor(t.minColor),t.midType!==O&&t.midType!==P&&n.setMidpointType(t.midType),t.midValue!==O&&t.midValue!==P&&n.setMidpointValue(t.midValue),t.midColor!==O&&t.midColor!==P&&n.setMidpointColor(t.midColor),t.maxType!==O&&t.maxType!==P&&n.setMaximumType(t.maxType),t.maxValue!==O&&t.maxValue!==P&&n.setMaximumValue(t.maxValue),t.maxColor!==O&&t.maxColor!==P&&n.setMaximumColor(t.maxColor),t.priority!==O&&t.priority!==P&&(n._priority=t.priority),n._stopIfTrue=!1}},o}(R),e.ThreeScaleRule=T,A=function(t){function o(o,n,r,i,a){var s,l,u=o,c=n,h=r,p=i,d=a;0===arguments.length&&(u=5,c=O,h=7,p=O,d=new e._Color(255,99,142,198).toString()),s=new x(u,c),l=new x(h,p),t.call(this,s,O,l),this._init(d)}return __extends(o,t),o.prototype._init=function(e){var t=this;t._gradient=!0,t._color=e,t._showBorder=!1,t._borderColor="black",t._dataBarDirection=0,t._negativeFillColor="red",t._useNegativeFillColor=!0,t._negativeBorderColor="black",t._useNegativeBorderColor=!1,t._axisPosition=0,t._axisColor="black",t._showBarOnly=!1},o.prototype.reset=function(){var t=this;t.ranges=O,t.condition=O,t.style=O,t._init(new e._Color(255,99,142,198).toString()),t._stopIfTrue=!1,t._priority=1,t.scales=[],t.scales[0]=new x(5,O),t.scales[2]=new x(7,O),t.expected=[]},o.prototype._calcuteMinValue=function(e,t,o,n,r){var i,a,s,l=this.scales[n],u=O;if(l){if(6!==l.type&&4!==l.type)return this._getActualValue(e,t,o,0,r);for(i=0;i<this.ranges.length;i++)if(this.ranges[i].intersect(t,-1,1,-1)){u=this.ranges[i];break}if(u)return a=-1===(a=u.row)?0:a,s=-1===(s=u.col)?0:s,this._getActualValue(e,a,s,0,r)}return O},o.prototype._calcuteMaxValue=function(e,t,o,n,r){var i,a,s,l=this.scales[n],u=O;if(l){if(6!==l.type&&4!==l.type)return this._getActualValue(e,t,o,2,r);for(i=0;i<this.ranges.length;i++)if(this.ranges[i].intersect(t,-1,1,-1)){u=this.ranges[i];break}if(u)return a=-1===(a=u.row)?0:a,s=-1===(s=u.col)?0:s,this._getActualValue(e,a,s,2,r)}return O},o.prototype._evaluateNoneScale=function(e,t,o,n){return 0,o===t?e<t?[0,0]:e>o?[1,0]:[.5,0]:e>=o?[1,0]:e<=t?[0,0]:[(e-t)/(o-t),0]},o.prototype._evaluateMidScale=function(e,t,o,n){var r,i,a;return n=.5,r=V(o-t),o>0&&t>=0?o===t?[.5,n]:e>=o?[.5,n]:e<=t?[t/o*.5,n]:[.5*V(e/o),n]:o>0&&t<0?(i=o>V(t)?.5:o/r,a=o>V(t)?t/r:-.5,e>0?e>=o?[i,n]:[e/o*i,n]:e<0?e<=t?[a,n]:[e/t*a,n]:[0,n]):o<=0&&t<0?o===t?[-.5,n]:e>=o?[-o/t*.5,n]:e<=t?[-.5,n]:[-e/t*.5,n]:0===o&&0===t?[0,n]:[-1,n=-1]},o.prototype._evaluateAutoScale=function(e,t,o,n){var r=V(o-t);return o>0&&t>=0?(n=0,t===o?e<t?[0,n]:e>o?[1,n]:[.5,n]:e<=t?[0,n]:e>=o?[1,n]:[(e-t)/r,n]):o>0&&t<0?(n=V(t)/r,e>=o?[1-n,n]:e<=t?[-n,n]:0===e?[0,n]:[+e/r,n]):o<=0&&t<0?(n=1,o===t?e<t?[-1,n]:e>o?[0,n]:[-.5,n]:e>=o?[-0,n]:e<=t?[-1,n]:[(e-o)/r,n]):0===o&&0===t?(n=.5,e>0?[.5,n]:e<0?[-.5,n]:[0,n]):[-1,n=-1]},o.prototype._evaluateScale=function(e,t,o,n){return 0===this._axisPosition?this._evaluateAutoScale(e,t,o,n):1===this._axisPosition?this._evaluateMidScale(e,t,o,n):this._evaluateNoneScale(e,t,o,n)},o.paintDataBar=function(t,o,n,r,i,a){var s,l,u=new e.Rect(n+2,r+2,i-4,a-4),c=u.x,h=u.y,p=B(V(u.width*o.scale)),d=u.height;if(0===o.axisLocation)o.scale<=0&&(p=0);else if(1===o.axisLocation)o.scale<0?c=c+u.width-p:p=0;else{var f=B(u.width*o.axisLocation+c)+.5,g=u.y,m=a-1;for(t.lineWidth=1,t.strokeStyle=o.axisColor,t.beginPath(),s=0;s<=m;s+=2)1===o.direction?(t.moveTo(2*n+i-f,g+s),t.lineTo(2*n+i-f,g+s+1)):(t.moveTo(f,g+s),t.lineTo(f,g+s+1));t.stroke(),o.scale>0?c=f+1:o.scale<0?c=f-p:p=0}if(o.showBorder&&(c=B(c)+.5,p-=1,h+=.5,d-=1),p>=0&&d>=0){if(l=o.fillColor,o.isGradient){.9,l=1===o.direction?t.createLinearGradient(2*n+i-c-p,h,2*n+i-c,h):t.createLinearGradient(c,h,c+p,h);var _=e._Color.parse(o.fillColor),y=new e._Color(_.a,B(229.5+_.r*(1-.9)),B(229.5+_.g*(1-.9)),B(229.5+_.b*(1-.9))).toString(),C=o.scale<0?1-.9:.9,w=o.fillColor,v=o.scale<0?1:0;1===o.direction?(l.addColorStop(C,w),l.addColorStop(v,y)):(l.addColorStop(C,y),l.addColorStop(v,w))}t.fillStyle!==l&&(t.fillStyle=l),1===o.direction?t.fillRect(2*n+i-c-p,h,p,d):t.fillRect(c,h,p,d),o.showBorder&&p>0&&d>0&&(t.strokeStyle=o.borderColor,1===o.direction?t.strokeRect(2*n+i-c-p,h,p,d):t.strokeRect(c,h,p,d))}},o.prototype.evaluate=function(t,o,n,r){var i,a,s,l,u,c=r;if(c!==O&&c!==P){i=NaN;try{z.num(c)&&(i=z.D(c))}catch(e){return O}if(isNaN(i))return O;var h=this,p=h._calcuteMinValue(t,o,n,0,r),d=h._calcuteMaxValue(t,o,n,2,r);if(p instanceof Date&&(p=new e._DateTimeHelper(p).toOADate()),d instanceof Date&&(d=new e._DateTimeHelper(d).toOADate()),p!==O&&p!==P&&d!==O&&d!==P)return p>d&&(a=d,d=p,p=a),!(l=h._evaluateScale(i,p,d,s))||l.length<2?O:(u=l[0],s=l[1],{fillColor:i<0&&h._useNegativeFillColor?h._negativeFillColor:h._color,borderColor:i<0&&h._useNegativeBorderColor?h._negativeBorderColor:h._borderColor,showBorder:h._showBorder,axisColor:h._axisColor,isGradient:h._gradient,direction:h._dataBarDirection,axisLocation:s,scale:u,showBarOnly:h._showBarOnly})}return O},o.prototype.minimumType=function(e){var t=this.scales;return 0===arguments.length?t&&3===t.length?t[0].type:O:(t&&3===t.length&&(t[0].type=e),this)},o.prototype.minimumValue=function(e){var t=this.scales;return 0===arguments.length?t&&3===t.length?t[0].value:O:(t&&3===t.length&&(t[0].value=e),this)},o.prototype.maximumType=function(e){var t=this.scales;return 0===arguments.length?t&&3===t.length?t[2].type:O:(t&&3===t.length&&(t[2].type=e),this)},o.prototype.maximumValue=function(e){var t=this.scales;return 0===arguments.length?t&&3===t.length?t[2].value:O:(t&&3===t.length&&(t[2].value=e),this)},o.prototype.gradient=function(e){return 0===arguments.length?this._gradient:(this._gradient=e,this)},o.prototype.color=function(e){return 0===arguments.length?this._color:(this._color=e,this)},o.prototype.showBorder=function(e){return 0===arguments.length?this._showBorder:(this._showBorder=e,this)},o.prototype.borderColor=function(e){return 0===arguments.length?this._borderColor:(this._borderColor=e,this)},o.prototype.dataBarDirection=function(e){return 0===arguments.length?this._dataBarDirection:(this._dataBarDirection=e,this)},o.prototype.negativeFillColor=function(e){return 0===arguments.length?this._negativeFillColor:(this._negativeFillColor=e,this)},o.prototype.useNegativeFillColor=function(e){return 0===arguments.length?this._useNegativeFillColor:(this._useNegativeFillColor=e,this)},o.prototype.negativeBorderColor=function(e){return 0===arguments.length?this._negativeBorderColor:(this._negativeBorderColor=e,this)},o.prototype.useNegativeBorderColor=function(e){return 0===arguments.length?this._useNegativeBorderColor:(this._useNegativeBorderColor=e,this)},o.prototype.axisPosition=function(e){return 0===arguments.length?this._axisPosition:(this._axisPosition=e,this)},o.prototype.axisColor=function(e){return 0===arguments.length?this._axisColor:(this._axisColor=e,this)},o.prototype.showBarOnly=function(e){return 0===arguments.length?this._showBarOnly:(this._showBarOnly=e,this)},o.prototype._isDefaultValue=function(e,t){switch(e){case"ranges":return t===O;case"gradient":return!0===t;case"showBorder":return!1===t;case"borderColor":return"black"===t;case"dataBarDirection":return 0===t;case"negativeFillColor":return"red"===t;case"useNegativeFillColor":return!0===t;case"negativeBorderColor":return"black"===t;case"useNegativeBorderColor":return!1===t;case"axisPosition":return 0===t;case"axisColor":return"black"===t;case"showBarOnly":return!1===t;case"priority":return 1===t;case"stopIfTrue":return!1===t}},o.prototype.toJSON=function(){var e,t,o=this,n={ruleType:12,ranges:o.ranges,minType:o.minimumType(),minValue:o.minimumValue(),maxType:o.maximumType(),maxValue:o.maximumValue(),gradient:o.gradient(),color:o.color(),showBorder:o.showBorder(),borderColor:o.borderColor(),dataBarDirection:o.dataBarDirection(),negativeFillColor:o.negativeFillColor(),useNegativeFillColor:o.useNegativeFillColor(),negativeBorderColor:o.negativeBorderColor(),useNegativeBorderColor:o.useNegativeBorderColor(),axisPosition:o.axisPosition(),axisColor:o.axisColor(),showBarOnly:o.showBarOnly(),priority:o._priority},r={};for(e in n)t=n[e],o._isDefaultValue(e,t)||(r[e]=t);return r},o.prototype.fromJSON=function(t,o){var n,r,i;if(t){if(n=this,t.ranges)for(n.ranges=[],r=0;r<t.ranges.length;r++)i=t.ranges[r],n.ranges.push(new e.Range(i.row,i.col,i.rowCount,i.colCount));t.minType!==O&&t.minType!==P&&n.minimumType(t.minType),t.minValue!==O&&t.minValue!==P&&n.minimumValue(t.minValue),t.maxType!==O&&t.maxType!==P&&n.maximumType(t.maxType),t.maxValue!==O&&t.maxValue!==P&&n.maximumValue(t.maxValue),t.gradient!==O&&t.gradient!==P&&n.gradient(t.gradient),t.color!==O&&t.color!==P&&n.color(t.color),t.showBorder!==O&&t.showBorder!==P&&n.showBorder(t.showBorder),t.borderColor!==O&&t.borderColor!==P&&n.borderColor(t.borderColor),t.dataBarDirection!==O&&t.dataBarDirection!==P&&n.dataBarDirection(t.dataBarDirection),t.negativeFillColor!==O&&t.negativeFillColor!==P&&n.negativeFillColor(t.negativeFillColor),t.useNegativeFillColor!==O&&t.useNegativeFillColor!==P&&n.useNegativeFillColor(t.useNegativeFillColor),t.negativeBorderColor!==O&&t.negativeBorderColor!==P&&n.negativeBorderColor(t.negativeBorderColor),t.useNegativeBorderColor!==O&&t.useNegativeBorderColor!==P&&n.useNegativeBorderColor(t.useNegativeBorderColor),t.axisPosition!==O&&t.axisPosition!==P&&n.axisPosition(t.axisPosition),t.axisColor!==O&&t.axisColor!==P&&n.axisColor(t.axisColor),t.showBarOnly!==O&&t.showBarOnly!==P&&n.showBarOnly(t.showBarOnly),t.priority!==O&&t.priority!==P&&(n._priority=t.priority),n._stopIfTrue=!1}},o}(R),e.DataBarRule=A,I=function(){return function(e,t,o){this.isGreaterThanOrEqualTo=e,this.iconValueType=t,this.iconValue=o}}(),e.IconCriterion=I,D=function(t){function o(e){var o=e;0===arguments.length&&(o=0),t.call(this,O,O,O),this._init(o)}return __extends(o,t),o.prototype._initIconSetType=function(e){var t=this;t._iconSetType=e,t._iconSetType>=0&&t._iconSetType<=9?(t._iconCriteria=new Array(2),t._iconCriteria[0]=new I(!0,4,33),t._iconCriteria[1]=new I(!0,4,67)):t._iconSetType>=10&&t._iconSetType<=14?(t._iconCriteria=new Array(3),t._iconCriteria[0]=new I(!0,4,25),t._iconCriteria[1]=new I(!0,4,50),t._iconCriteria[2]=new I(!0,4,75)):t._iconSetType>=15&&t._iconSetType<=19?(t._iconCriteria=new Array(4),t._iconCriteria[0]=new I(!0,4,20),t._iconCriteria[1]=new I(!0,4,40),t._iconCriteria[2]=new I(!0,4,60),t._iconCriteria[3]=new I(!0,4,80)):t._iconSetType>19&&(t._iconCriteria=[])},o.prototype._init=function(e){this._showIconOnly=!1,this._reverseIconOrder=!1,this._initIconSetType(e)},o.prototype._modifyIconIndex=function(e){var t=this._iconCriteria.length+1;return this._reverseIconOrder&&t>2?t-1-e:e},o.prototype._getActualValue=function(e,t,o,n){var r=this._iconCriteria[n];if(r)switch(r.iconValueType){case 7:case 1:return this._calculateValue(e,t,o,r.iconValue);case 4:return this._calculatePercent(e,t,o,r.iconValue);case 5:return this._calculatePercentile(e,t,o,r.iconValue)}return O},o.paintIconSet=function(t,n,r,i,a,s,l,u){var c,h=r+1,p=i+2;n.showIconOnly&&(1==l.hAlign?h=r+a/2-8:2==l.hAlign&&(h=r+a-16-2)),1==l.vAlign?p=i+s/2-8:2==l.vAlign&&(p=i+s-16-2),c=o.getIcon(n.iconSetType,n.iconIndex);try{c&&u&&("string"===e.GC$.getType(c)?u.getState(c)?t.drawImage(u.getImage(c),h,p,16,16):u.addImage(c):u.getState(c.image)?t.drawImage(u.getImage(c.image),c.x,c.y,c.w,c.h,h,p,16,16):u.addImage(c.image))}catch(e){}},o.prototype.evaluate=function(e,t,o,n){var r,i,a,s,l,u,c,h=this,p=n;if(p===O||p===P)return O;r=NaN;try{z.num(p)&&"boolean"!=typeof p&&(r=z.D(p))}catch(e){return O}if(isNaN(r))return O;var d=0,f=h._iconSetType,g=h._iconCriteria;if(f>=0&&f<=9?d=3:f>=10&&f<=14?d=4:f>=15&&f<=19&&(d=5),!g)return 0;for(i=Number.MAX_VALUE,a=h._showIconOnly,u=d-1;u>0;u--){if(!(u<g.length+1))return{iconSetType:f,iconIndex:h._modifyIconIndex(0),showIconOnly:a};if((l=(s=g[u-1])&&s.iconValue)===O||typeof l===L)return{iconSetType:f,iconIndex:h._modifyIconIndex(0),showIconOnly:a};if((c=h._getActualValue(e,t,o,u-1))===O||typeof c===L)return{iconSetType:f,iconIndex:h._modifyIconIndex(0),showIconOnly:a};if(s.isGreaterThanOrEqualTo){if(r<i&&r>=c)return{iconSetType:f,iconIndex:h._modifyIconIndex(u),showIconOnly:a}}else if(r<i&&r>c)return{iconSetType:f,iconIndex:h._modifyIconIndex(u),showIconOnly:a}}return{iconSetType:f,iconIndex:h._modifyIconIndex(0),showIconOnly:a}},o.prototype.reset=function(){var e=this;e.ranges=O,e.condition=O,e.style=O,e._showIconOnly=!1,e._reverseIconOrder=!1,e._iconSetType=0,e._iconCriteria=O,e._stopIfTrue=!1,e._priority=1,e.scales=[],e.expected=[]},o.prototype.iconSetType=function(e){return 0===arguments.length?this._iconSetType:(this._initIconSetType(e),this)},o.prototype.reverseIconOrder=function(e){return 0===arguments.length?this._reverseIconOrder:(this._reverseIconOrder=e,this)},o.prototype.showIconOnly=function(e){return 0===arguments.length?this._showIconOnly:(this._showIconOnly=e,this)},o.prototype.iconCriteria=function(){return this._iconCriteria},o.prototype._isDefaultValue=function(e,t){switch(e){case"showIconOnly":case"reverseIconOrder":return!1===t;case"priority":return 1===t;case"stopIfTrue":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={ruleType:13,ranges:this.ranges,iconSetType:this.iconSetType(),iconCriteria:this.iconCriteria(),showIconOnly:this.showIconOnly(),reverseIconOrder:this.reverseIconOrder(),priority:this._priority},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(t,o){var n,r,i,a;if(t){if(this,t.ranges)for(this.ranges=[],i=0;i<t.ranges.length;i++)n=t.ranges[i],this.ranges.push(new e.Range(n.row,n.col,n.rowCount,n.colCount));if(t.iconSetType!==O&&t.iconSetType!==P&&this._initIconSetType(t.iconSetType),t.iconCriteria!==O&&t.iconCriteria!==P)for(r=t.iconCriteria.length,i=0;i<r;i++)a=t.iconCriteria[i],this._iconCriteria[i]=new I(a.isGreaterThanOrEqualTo,a.iconValueType,a.iconValue);t.showIconOnly!==O&&t.showIconOnly!==P&&this.showIconOnly(t.showIconOnly),t.reverseIconOrder!==O&&t.reverseIconOrder!==P&&this.reverseIconOrder(t.reverseIconOrder),t.priority!==O&&t.priority!==P&&(this._priority=t.priority),this._stopIfTrue=!1}},o._getImageSrc=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAQgCAYAAADvxtzfAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAANyVJREFUeF7tfQl8TFf7/6CvVsXaIkqrtVZqKxq0SCyxxxpr0ailtUYoYilCrLWEqC0h9i2xJyKSEJSiUcQWW4tGFRFEJJlkMs//+Z577yzJzGQm+v5/fd93ns/n+7nnnvN8v2e59z5z7ty5Z1R/u7m4uDR1dXWlFi1aDJOzrDeFfPv2bbJZxJCswGqRnOSYmJg8RZjjgTKxk5MMREVHmRVRyDoBzmhnKBIVFU2RR45QRMThXCIKWckTArCcIhERERQeFk4HDhwwEgFu3bqVnksAllPkwP4DtHfvXgoNDdHlGSKXACynSEhIKO3YsYO2bt1KGzdtovXB6ykwMNC8ACynCMibNm2k4PUSefXq1ZYFYIYiIK8PDtaRf/zxR6sEdOeG0myFvDxguWUBQzKgI69cSQHLA8jff5l5Ac50MSRbQi6Bnj17FkKmLZCpdjM0UwNlCTJNb3wO6C7XvGBSAKaIKJctAswRjg+HDh2i/fv3U4h8dZoVgBm2JDIyksLDw2nf3n20a9cu2rJlS94CiD6KQNjBg7R3zx7auWMnbd68mdavW2dZwJAM7N4dStu3b6dNGzdSUFAQreRrwqxATnJoaCht27aNNmzYQGsD1/LVuJKWLfM3LZCTrPQ3eH2wLs8QRgI5yTu4v5u4v+vk/ioEQx+dQE6y0t9A7q+hMx+ZdoaxQidgSNb1d60UOA3JwplNEdEJGKoCa9asMUtWjPNF4JF3c4tYIiuGACQnJTMUyYts1hSRfJHt9k+xlLUuHi8DmxPj5KMVLg5ytnUmyEEuROnXKWXN57aJGJIVvFjlbJ1ITrL2N2+9yIp6JkVeBroEpaxuLF1MLwObGZEF7ozR5T33/8RIhNPBzxZUpBcrG0oCogVrmuhFmKy9PZLxjV5kcVUhAnLy/Aoi78WKuvrLGSIpqz7Ti4B8czDRjYG6vGcLP6Dk+e+R9uWldOw/X1ZTLwCDyIuAunqRmwOIEvqQ9noPXZ4hnnGrZKreIPLcv6bOSXutO9E1d6LLbYniWxBdakp00VkS+KFSbgEYRJ4trqIXudKWtPEtZXIjogv1RX7yvPKmBWBChEdaCMhkrSB/StrztUX+U793zQukrnWplzy/vNQKmaxFzb8y+bzUxaezipsWkMjvSWQANf/KZNQcx+Rfqon8pJlvmxjEda4uuprzwJPphXMLvPixPr0IqMNnX01xmDDSyQsqUPLcMpQ8uxQ99S1GSTOKUNL3henJ1ILmx+B/2XCN4zLFlYaLRTeQfNbhxMGxx+HDETA5iAgUyhmYF3AkZJqxKde8ctlKAWYUaW8N5cubr9BrHpIAH06ZktskEelsVMhaJmuv9SDt1Q4iH+eE7G5sCF2IPgggQkCuWcs1a68wGZc15+PEkil6U8gIYXASAmg2ggpqBvliY0mAz06ZJpmOzEFUT+5vVLOWydrz9SQBPsVlqp6MMK4jJ3Czr/OAgSznGUIXkXRk/iBRCkWzMdoGZBxewytVFxNBxkeZUpBztCXnKoQoZRgrcMUqAsZkbrbos5wHR5CFM5sSrXDZiwwUGn20GZAR5g3JiiHwIHbIu7lFAHzQmCKbNUMRfNTZRFZMiPCHbb7Idvs3WIl1Dh4l1xWNKx74tu0zd5BLrCt675vY4VR8zduJxVfYIGJIXnEhiLAttvytxLcXWyGSk9zuWCedSNEfCie+PfdN8yKG5ICLgdQ6pr2AGwP7yH9r1r8S35xhQsSIfGkNuUS65cLyS2uFSOFpbyS+6VNIL2JIXh6/mh1X0zJGk3BXhovYIh95KIPfG98VSizkLYvwoaISgYw1Ran4yrep2yl38o9fSZ/u/5zqy/C/vFLkF570Bv1rfCF6w7sgFRptZn7gsPQtWnplBTmFNqRPQj8jp92f8X4AFfZ5wzQhpxX94S1acnUZVdlRl6pur8Ooy/vL0WzrBN6e9yYtvuZP72+uSe9vceKtEy25tpQKjbVySlNkdmFalLCEym2oRuWCq1FZBvYLjbJS4K0ZhemHG4uoVNBHVHrdR2K7iPcLDi9gnUDhqW+wwA9UfO0HOmC/wDfWCkwqRAtvLsyFAkNV1gn8i0cbA4bjjGYX+JYB8mArBexm+TtF2cWywdHwyxgFNgsoDyuAfAlERUXRkagjdOSI9LTDZoGIQ4cE8E1mvgQOHDwgnnAoTzlsFti9e7cO+RLAk40d2yWYFTD3hTwImzdtok2MzZs26wRyQogoX3+dOXNGOCrAl5HrghgGX0oC8IM/eEIAllNk9epVtGr1avFgQoFZsmI5RQJWBFBAwAqxzZOsWE6Rpf7SN7hWkRXLKWITWTFDEZvJiiki+SLbTW/KIPI1U1jOss0g8FoiIBueCzaLgJjzbDQSQWZegIBZEUMHSwiUHxfkElEETp0+TcdPnKDomGg6FBEhPU8KCRHPWzdsCGaBtbRq5apcIiYEYsQz5/0HJIFtEBDPWyGwklYEGMcGvcApFjgutUAIyC2AQHDwBrkF0uMhky3IC6bGQDeIeUERyUW2xhSBfJFhIOWbDAMx32TYa5FhfLYZPwqym3WGyxQjn68jYEi2+QTKSbbpFDZFxjzRKhFTZMwNxRyRY4NFEVNkZW6o4CDPF82K5CQryDlHVJBLBDs5AUdpfrjdaI6YE9z63NcJCkDYvFmaH27irSIgu1g2RSAIc8R1QQL5Eli9ynh+aLOANEeUkC8B/6VLeY64lPzleaLNAosXL9YhXwI5YZOAOcgudrPGHgz7ksxBdrFsfwzuQ3TnTi5YLXB3YHdByAoJ1QH797/ubZ3A7T7ukgDHgqxtOyhz23ax/3v/btYJ3OjRRhAyN26izA0SsH+zZ3vrBK65uwqCek0QqXlupF4TKPavd25pncDldl8IQsayFZSxPIC3AWL/cvum1glccmssCOkLf6CMBYsYP4h95Msuervi4uRw+YtamguNaz6EA4DDBUKa72xK9/VjzBb7yD/a+BOBsHJvvTzw7hsJQuSScw0PEFOjDgtHBWlTpgm8mjzNKD9x5TIKr+5Ie0v+q7YQgJ2p/ZHHL80+pZeRh4TTq/ETGBNlID1B5P+hI6v0ZMVO1HD0+Mm5JqVEhEsio8cKpDIE+Ud/82TFoj8o7QGnF4cOClLq8FHG5KIWyIodciwiRJ6HH7C+5py2r3Qhj32lCj2+7jPW+ppz2u4SKtESm2q2W25LXd+SHk1W5f+p18v1LpQS+HlWvkVeBjWjjMshlBL0Rf5EXq7l4JJ+XRIJNCHy1NeBnvqVpuR5ZSl5QUV6trgyPfevQS8CalPKygaCqDx/NCmSNLOIzsESxMNr3uYSefJ9YcnpXCXpxxnna5MWP1S55CI98cUDazyHxaPzO3xl5hRJmvaGTkAbV50F6pD2gjNp4zkyX20vfkYjHiFD4PYo3U+NhMjqxq9USVMLGrfgV24BC9AlV+nhrWELWEDfgqaaRz6qdqonU1SSQB4wGoPVzhJZjAELPJlSgJ5wV5Kmv0U4KniqnzwXR6WCICgiSD//sZ6ebI09W/i+jvzMv6ZtZBiecAvyDx/aTobhNwZP5znmjwxL9itF+SbbLf9WhOHJCGHEyUAaeSizaM6MhOrVq1OvXr1o2rRpAkgjD2Wyj0nzKlKkiGb8+PEUGxsrgFtfQNlHGXzgK1H05la0aFENfk4NR/zIecWKFTRr1iyazViwYIH4pTTK4ANfcCSqZPFo6rFjx2jVqlXk5+dHM2fOpKnTptKECRPIy8uLxo4dS/Pnzxc+8AVHoqpUTcuXLy/U8TPjuXPnSuSpEnnMmDE0bNgw6t9/APXt00c8a4AvOOBCwAeDBOUlS5aQr69vDvJQGsDkHh49qEP79uTNLYEvOOBCwB9NxA/b0cRpCnm0XPOA/tSjh0Ru4eJCLfjeCb7ggAsBPzhitOfNm0cTDZo9QCF3aM83XS7UyNmZGtSvL3xRzlxfCAxu3bq1aNaiRYtYmclDQeZmi5o76Mh1atchV24FfMFhLk4uVRk+LGp80YABQtNRs4eoGWRXHbkGn0w4nPAFB1wIwPxdZGUMZN++fUWfDcnVq1UjrzFewge+4EhUyUow4keMGCEOEe7cO7u7i2a6NGsmtkv5Xhpl8IGvzDGyCoyzzlwjfrcOZ4z2zp07RBp5KIMP4wMQTBmutnGMRFw87twKQL6QEhkTZB+rzInRUQbSdrPWFi9eXISvd89Jk3xCvL2940aOHBk3ePDQkP79+3t6eHhYPgIcSJynT5+e4OMzmcaNG0cjR42kIUOGiOuiZ8+e1KlTp4Q2bdqYjokcvryYrPGZ7CPIo0aOoiFDh/DlPIB6MblzZ3dya+NGzZo11TRs1Mg4JnIQcZv+/XTNZF3NTBY19+eae4mTqY2bGzVv3ozPxs/42qit+bjqx/qYyDXHKzWP5JqHDuEoJDe7c+fO1IZrbt68uUSuw1dljepUqVIlKSbOmDGjqb7Zxn1GzW5t2lAzQearEuTqNejDDz8kR46JpUqVaqqaxMNtasBwNbq5tdHXXLeuiAcgI6C+88475ODg4KPiQ+U/Stdng5q5z81En6Waq9eoQZU+rCTIpd8pTcWKFaO33nrLX8XXtx9GW0/uLJqtG7A6XLMgKzXryFSoUCFfFdc8WN9sJivN/oxrrss1iz5LNb9T+h09+Q3xuxxP1aBBg8p49PJQS2RltA0GrJJM5j4r5DcKCbI+Jrp3cvfHoVJGu658qKQBc6TSBjXLZEAfEznmleAzLP4zpWbus+Fo68hSs4HcMbFx48YV6tSpfdbwUJWWyW++9aZhzeZjYsWKFYvwGTbO0dEx0XjAxC+hbIuJfJI4FS5cuCMfKntMtMYmz91J5mBNuXA4dvpWLigOeZXbBWQHc7Cm/PXNlLICa8rz7GNe5XYB2cEcrCm3299hpkZXgTXleR7nvMrtArKDOVhT/jdYrRAyCzZTNSsQfDj2mH4tFwwFLI6BXYANjubABkdzEHy7/Q1manQVWFOe53HOq9wuIDuYgzXlf4OZugoVWFOOhKV4kGe5XUByMAtryu32d5ip0VXAZuoqVCD4cLR0nOFoMR7YBdjgaA5scDQHwX99M1WzAmvKkbA0BnmW2wUkB7Owptxuf4eZGl0F1pQjYfE451VuF5AczMKa8tc3U8oKrClHwmIf8yq3C0gOZmFNud3+Zjt9+nSRY8eOecbExIQciYqKi4w8EhcRERESFhHhuXPnTstPuaKPH3eOPno0AW+W4YcaypKoeCHk4MGDtP/AgYQ9e/aYfu58NDbWK+boUY1EjiaumSIOH6bwcJDDQKa9e/fhnQ4Nt8T4uXNsbKwbyGKhxegoOnwkUiIfCqeDYUyWl0XFCyF4VW3Hjh2abdu26Z87Mzle1CzIR+iwIHPNOrKoWZCxhiJ+TrF161bpuTMPWFOFHKnUjGYb1byHdoWE6slbtopfBW3cuLGpKioqxicqWu4zD1juPu+hkF1M3rmLtm8zIlNwcLCPKjIqyl+MtqiZ+wzy/v26mrGi684du2ib1GzxasrGDZtow/pg/PDFXxUZGemnb/ZB8SuXfQYDJmqWm70JZFHzBrGOZNDaIF8VH+PBumYb9Fki6waMm72FyZvEao7r162ndYFBtHbtWk8IlOGa1YK8T+rzLh15h9xnJotmo2YmBzF5zVo1d0F67sxkf5M1K2RpwGTyOvGm4drVa/XPnXft2lUiNDQ0XiyBC/I2ueZNClmqOShQR45fs2aN8XNnrrXC9h07zhoN2IaN4u1Kw5qZeJZh+rkzixTZunnrOD5UiQp5nb7mRK55An4lIrtbNh4gp6CgoI7AulXr7M+d/27rues1Xpr0vPyNl2f8tydHXBlh29qKMJAHXf6WAJtFvrw01Kv/xcHU/+IQgQEXB6cNuDhM/4Zdz7hhuX5nppjHuYFeveIGUK+4gRJ+Gaj2OP+V/tezXX7qWa/z6d6P3X/uLX5rZ2idT/X24jJS4H6qt9r9dB89uc3Jrg3cjnV+6hbbhdyOd9a4He+iE2kd29mrzfEupID31a2OuRv/brdptJvHF0faaJpFtSWgKdKRbT2bH2nrpc9jRLVRM0z/6LfBIRePBuHNNQ3DXahhmCuDt5xuoKTDXNT1w1zxYw7z5rTP2eOTvY00tfY2ptr7GhO2tXjLaXWtfc6WyYpV3VnPo3rop5rqIQ2oemh9qhZaX11tZ33ryIp9tK22x0fba2s+3F5H/eG22p3lbNvso511nSvvcjL7E0K7/Q+Yt6pIMa9insXGFAtx8CoWByCNPJTJXqatuHdxZ4cxxRNqza9N3bd7kPfx8QJIIw9l8JHdjY1r8Xp3QhnN8KhRtP0pz0oYwY830XqGso8y+MBXpklWfExxt7ITy2mW3lwuHBf+sUQEzl7nB1C3c33I41x/Gn9lMv2YuJZmXp5DZSeV04Aj01F78Xg0dWvSDvru1mT68tIg6vkrk8/2oU6ne5BzREuqtK0WtQh3p+o7G1Dbg10IHEF2GOPQ9KMZlUXN3170ovanulObE12o5bFOIo2Y8P7WT2jiuen0KiuNttzZSZ2P9iFwwGWB4j4YpLm3fxCO3572piGnRtOH22tTlZ31RI377oeTYuF/HCH3o73FwIKrcvAq7j/s8Lc08+Yc6n98mHBKzXpFLbm5bSO6093U+yIvMzuTZp6fLyppF92DwAEXo+/31YFBLDBXFEb/FSsIf6U/ogxNhkgnvnpAnSJ7i/JK3LK1f64ncJjrizEY3CrQjbY93Un1DjQVTb6ZclsQYUf/PEGf7GpMH/AgglxrdxMx2OCIk8thtEOZMhPKqoMSg2nitWlUZden9Pn+tvQo/QnNvbhEV+tH2+uK9NBzowm+4IArHQnui+uaFkK5+09fCkKNnQ1FrR/tqMsDWofJtajlYXfa8mQ7wVf0X7FSk0qVwHH9OnyIOJxjLk2gzw66UtWQ+ixQh2qGNqaRv44XZfCBLzgyXbIi3kUqOIwpdrZxwOcUcGelcF71IIgRKNLIQxl8So0pZSbgSlfiOK4hERdPx42dBJBGHpdNyPOKVIwHyKnY2GIdAaTlbLtZZf+9MXHmrTmiDD7wtSkmunGIc4lpT/3ODKYt7ANfcATZMCbOubeQ+jG5F5O7MrkjyMc7k8vRDvR5ZGsx8cKFBt9cMREBZciVEdRTNLuvnhzTgZqAfMiF6h74nBqHu3FLd+aOiesfb5T6jJpP9RCR2RU1H0HNrlSHyTX3NKJqfInjCs0VEzHaSs0go89odgNB/oLJzlR1V336kOOD2ZjYk0fb7YTc7CNu3Gwm72fybj3ZYkycnDBDrpnJXHNdJjtxzdWYbHVM7HtmkFSz3Gz02eaY6H3Zh5zDWthj4v+YubpPoGETlmORyeGMh2KxSQl7VF+rashu5g0C7JzIzhHFllegxodb0ldXh1KdjQ2J8+5xmTPDjRHLOCnT9CYLnCwZ+CEBjQ+3EgIuh9sgX80icSh3+rGW8JNpesst0JI8IRDBAtwCXAvdfulL7aM6WyvQShI43FYS2JYfgWtDpC4Igdq2CshdkAUqWdsChyXlQYjg9HDeXqi+8hMjAbdD7S0IsCMXXuWtp6qnqpBqkMqF02c572GFoBrUYEsjkB9yHt6iMDYICJGcNlhVlQlxjBjGbyxq+qo0K2BoPVXm14qzSsCS/ZcIfDthZf4F7KZS4d01oE+fPjR0kCd9NbCfeMer35cDqFcfvkPr0ZO6dOlGHTq0o1ZuralzJ3fhD+gE/P2XC3zJpJ4e3cm9Uwdq2bIlOTdqQnXq1KLKH1Wn9xzLU/GSJfDKMhVQFdQL9O3dh5Yt9ceODu+3rET1vBqS88zPqYanE5Wq9Y5ROdDFvSu2KtWQrwfTgC/7i8wi775NLX5sS/1+5aneuYHU9ee+1OEkT3tiu1DV4TWpwBtijWUB+X1Xleqrr74Sr+Uis9Wa9jTg1yH0zeUxNCLem/qeG0Rtj3cjV572fMEzl/cHVJYFClJz12aSAAasU6dOVLlzNep3fhCNuvIdBf21kXYl76ZZt+dTh+M9xLSnMd+Ef3HIjRxqFKeCqgLk6iIL9OvXj1q1akVNFrhQ73Nf0XfXp9Ke5wfoYEoEreRb/k7He9JnPGdyPtSCWh11pxoTa4tW6LrQu3dvaty4MTVf05q6nO5Nnue/pSX3Aijo4UYad3kKNYtsLyZcEMFY1JrbgFQFVOTq2lwSQP9r165N9b535v52FU4dTvSkTid6UdPIdnxL/AV9sreR6EL7E93ooxHVjbvQpUsXqlKlCpVtXp5aHO0ovsFsFNGKGhxsTvW45tr7moh5cqujnVigO735/tviPGjuKncB7zU7OjqKfjVc+QU1j24nRrwJi+BDphkLolXuP/WkGt+L/xsQwHuA4OPVPCpeXPw1ChUuWZg+W9mM2vGhAzqc7E6dfvKgtrFdqco4Jx0Z0B1GnJI4PZUCoIyrI33i14BqL/mMPvL6mN6qaFwOuHcxuBYKFCjA/VKJbSHZAfsYbeSJrZyvwOhiUoBjC7g2x7aFvG0mRhyvcKPM0F8I2O1vNu3p00U0EZGe2WHhIZr9++M0obvjMnfsDFFv2eKpzeu5szY62jn78JGE7PBDpNl/gDS795Bm5y7K2rKNsjZsoMy1gQmZq1aZvnfWHIn20hyO1GSHHaJshbxDIW9kchBlrlxNGcuWazIWLTG+d86KjnYTZK5ZIu+lLJmcCXJgEKmZrF4WQBmLl1D6vAWadN85+ntnJsdLzT5ImtAcNTM5c+UqHTlj/kJK95tLaTNmSvfOdCiqqQY17zNutlIzmq1etlxHzvCbQ+kzZlLa1O8pbdKkpipN2CEfZcCy5AHLDEaf13GzpZrVi5YyeQFlzAbZl9IFeTKljZvko+I++wuyqHkrZYGsq5nJSrMFmWue9j2lT5pCad9NpFRvb39VVsheP+OaMWByzYJsULMgc81MfuU9nl6NGeurUm/fOdi4ZkOyUrOv1GcfmTyWyV5jKXXUKE8Vn11l1MEb1FLN8qFCn+fxgBn0OV0hSzVT6sjR6pTRo6V7Z/Xadf6i2csxYPJoz56rr1lp9thxgvxq1BiufbT+3pnWrCmR4b88XjpUC/g465stDdgErhlkb0FmxCcPy/Fs7tXixRXS5y08q/RZd6i45jRudppS88gxZ9PGjDF976xdvLhI2gzfcelTpyXqmi1qxoCNTuRBm6D19rbu3jll/Hin1LHjO6aOGtuRB8t+75xPQ+jC3xEDpsOYGRtWvXr1F127dqXvvvtOAGnkoUxyMW2Ob7/99hEsZRAWFiaWLYmPjxdAGnkogw98JYqBFStW7CgWHo2OjqbHjx/L3+3rDXkogw98ZZrOhqGpR48epczMTJmS21AGEfgyZ7hEVamK8PTmGZqYlJQku5q3J0+eiO6Aw1zxEL8pBun06dOyS952/PhxMbDMbQIBz2+//ZYuX74sF+dtFy9eJHDAFQKYK1+9elUuztsuXbpE4CgCTTF1wXK31hq6K69uKrpQhI9tMv4qITU1VXYxbykpKeJvFcBhru6XEMO/+OILoZydnS275jaNRkM//fQTwRcciaq3GCym8fPPP5tsCfJAhg98JYqxYV2c2AYNGtD69euFM44McPLkSbHsD8rgI/uaNVwwT6tWrUrt2rUTQBp5cpnVlu/L2W56+4fEROwjjOU7JnKRAM5C/MTM5pjIZTpgdRKI2BQTudwIn376qW0xUSEaAkuhWR0TFZIhsPSZPSbaY6LdrDd7TJSNy3T4X42JCskQWF/R6piokAyxcOFC62OiQlKARbjwI3CrYyKX6VC4cGGxvqJNMZHzBbD0F8g2x0QsuIg/MLDHxP9Us8dE2bhMh//2mCivEWsVTMbE2bNn53I0B5MxEXEOUUdxMgeLMRHKb0gLDZqEVTERi/OaaolNMTEwMFA4Ix7aY+J/uv0fx0SELqRtjokIWfIZZwSrYiJOV8Q93jeJPGNi3bp1c5FywmxMxKWsOOUFkzFRXvrZKthjoj0m2u1vsNdejQVE4/VgbDSbBeCoQNm3WcCQ8B8ggAIFyr7NApYIOfdzWV6EnPsiQ4Eph7z2bSbk3P9vEVCQn3275cNeexBBNDqMtprNAnBUoOzbLGDxTMzL/v8LoECBsm+zgCVCzv1clhch577xei9seRFy7guBMTsfvp7A4FV3X0/AcI2bvAg594VAu5EXXk9ABzYUKLBm3275sNceRBCND6ONZrMAHBUo+zYLWD4T87D/AwET14bNAl67rA8wuY2JIzcn2iAARwXy/rC192wTMIyJ2H619I5tAoYxEds+c27YJmC07hdvu025apuAYUzEtpP3JdsEdDCxD0cFpvbtlg977UEE0fgw2mi2C5g4L2wWsBQf8jYmjtr65+sJjNhoPsDkNjgqkPeHBd63TcCwz9h+veJ32wQMYyK2A5bctiCAAgXyvmFMxLbvvJuWBSzFRGx7zrxuWcBSTMS26+QrlgUsxURsO38Xb1nAUkzEtqOX+RgpHHSwYh9EBaLcbvmwHINquzFxjOHFZrMxcfR2fYDJ2+CoQN4fufmBbQI548O3wX/YJmAYE7EdGmhwuedp7GgYE7H9eqXB1ZvLUKBA3jeMidgO9DeIF7mMCyzFRGy/XHjLsoClmIitUcARCQXyvqWYiK3HDH2IExm2xERsjSIWErbERGy7TLhsLGBLTMS20ziDfSRsiYnYth9z0VhAh/zs2y23na6oKnKshMozpqQq5GhJVRyANPJQJruZtujiKmcmJPzyeW26NWYo/bUmQABp5KEMPrK7sXGh1/H3imoeLJ1P9McfEn77TYK8jzL4wFemScaqbicqFtO8OhkrHLWXL1P2kSjSHJBfmGNknz0ryuADX3BkukoVU0IVj6bS/fukPfUzZR+SX08MZfL2HZS1cTNlBq2jLN6ne/dEt8AR5GOlVE1Pf/K+1MwLF0m8JLhvP2WFhJJm23Ymb5LeLvxxJWX4+5Mm8ojwBQdcVUwplQ8Gie7/wc0+IsiakBAmyy8Irg2kzB9/pIwl/pSxYCGpeYuWggMumu//x8LZRHd+o+y9+0izK0R6NTF4A6nXBJJ6BZMX4+XAhZQxy4/Sv59B2uvXCRxwIeB3d6YPC9yRyVspcz3IaykzYIUgp+P9Ppmc5jOFtDduEDjM9VUdLaEafLVfV9GsrF2hlLUumDJXryH18hXSW3bzFlC672xKmzZdvJ6Hd97gCw5OLtUJB1WZ4xWKqTOv8KE7cZLUq1YzeTllLFpMGXPnCXL6VCZPmkyvxk+gTD4S8AUHXHEk0JfLvTqKQ5S1Yyepf1gkkWfOkt7tm8jkcd/xUVhGdPcuwVf0X7GoUqoSnBF/f850cYiy+FCpecTTpk5jsg/3fTpl7T8oyuADX3BkumTRpVUV+BQ9e7GTK6WfOS2ctdeuCSCNPJTBh8mm3+3D1caDOo6RiIsnYciXAuJC4jyueUKeV6Ri3CInrq0jgLScbbd/q/3ernXju1066c8uE/ZbB7fm97p2WCTv6g3k5G++yUr1Hk/3unUKkrONDORnI0ZohE/XjivkbMn+GtD/Ac51wJSIQlZ8UsaM1d5s16KKXKxSYefpkMFppkRykl96jaXf3duMF0RDyykC3O/RJcwqsmKmRKwmKyZEhg7NMCSnjh1nHRkm+jx8RLahAGDu6BjZ7U6tWxn2WbyabK1ITjL6fLdLh7k5x8SkiCmy0mdTA5tLxPBEMjXaEEka/PUrxSfXiXSrTZv32SHV0qFSRED+vVO7EXK23iDyW8f2Q+VdkwaR253aDJJ37fZvs3/WPFGbkCCg7Fs9T8w6HEnpPKXBdAZAOisqSpRZnifevSf9yjkzkzJ4aqcIZPJEk7RaqYx9zM4Ts3hymXVMWpAVBIgIsmyZmD+yD3xNzBPvU/qcuaLGrJM/SQylVjaQRXfYx+Q8UXvtuq7JQPZvv8tUoqwzZ43K4JtrnojRVhwMmy1M7o5OwNw8EWsf5OqzQXcgAh+z88SssHBdv5U+AzqR7GwxiObniXyIsniyaUg2FEEZfPKeJx4My30iHYoQZTbOE68LIG2fJ/7HWlh1x3bh1R0pvEZZ4whkjSnkRzu2kM0iCvnZsWjS3rxF6Rd+tV5EISfHHn2Qfeq0uIPNPn/eOhHDmjUnTgiyAiHy63nzIjry0SjKijlKmbgB3cq3v1hsBneyjOxz51gkLreIjhxzRIR0NW62Bdbxjfc6g/0g0vBlnR73i15kl0pVCDs3p06g7MtXxL2hBL75NIKSt4y0t27RX6sChIhowaGqjk7YeRC0WoT1ND++6dRhrgwpreGBTYo+cgr+aLkQgCki2VeuUtaRKEqbPJVeTeYbT94qQPOf7dktajYiK6aI3AsOvJEVESktYwN4jSNN7Al6tnuXebJiiojmwgXKCj9EqcNHUVZ0DD3btSNvsmK6MeGByk64YbrPeZkicmPUMOtrzmmKSL7IdnsNwwpFtHy5Z/aixSGaOfPjNLNmx2mmfB+i/m6SZ54rE2mXr3LW+i9P0P6wmLLnzScmU9bU7ylr4iTK5NNZ/c3IhMzBg03PE7UBP3plL12myTYkT2PyBB8me5P62xGU8fUQSu83QJPRvbdxRNIGBLgJ8iImz51P2b6zSWNEHklqiUxpHr3pVacumpdt2uvnidn+y+KVmkHOmjadMtHsMTJ5EJO/HEDpTE5z70av2nSgV64t5bXC/P2b6sjcbMOaM9FsJmd8OZDSe3DN7l1lcit6+XkzSmnQqKlKs3CRj+gzasaACTIPGNeskNMMyKlMTv28Ob1s0JhS6jTwUXGf/QVZ1IzR1jdb1CyarZBbM7kZvWzI5LoN6PnHdfxVWb6z/dBnHXn4CKnP/bhmXZ/bU6pLa3rZBM0GuT6l1KxDL6rV9FVppk4fbDTag4ZKA8bNTuskDZhCFs3mml9IZHpRuZqnSjt5chn1aG915nCpzzhU6R69mMzNbis3uwn3Gc2uo5Cd6NmH1dQpjlXltcK+HeEvnSRKs+U+o2b9gFGKE5OrOtHzytXp+QdVDNYKGzasRFrfAfEYMP1oy2S5ZqnPTP5IkOOTK1fOsVaYh0eFNPcuZ41qVsioWfS5Oj37oMpZJptZK6yxR5GXrq3G8YAlpih9lslcc+KzDypPuF+xonXzxJR69ZxefFy344tqH3dM+aCqfZ6Yl2Fh3hHjA+hQdcfh4dUcH+LTSEK5PRE13rNunW12TgyvVi7i6eQpRHvDKDtkH931HID8ewerlXMOr1rWLax6udiwauVMr/CMAnyUqxcsIS0LaFngGV+hLKpmxKH86uCBwk+m6c1IYCEEwvUC3IKMOQtIG7qfkpcvz1sgQwgYtMBWAakFLBDKAhxYbW8Bj4EYRBZ4PmFiDoEAywJ/9uuLQYsQh7N6uQtXunUUAmpZ4PEPP5gXgCMfpqvs4InJJ89OXPhcOIvzInmiD/0xBUfE8SGXW7/O9uEqZapKh9Axhsm/YcojFxmbOQFD2+XkZF9n25KBbF9n+zVNWaX3n7XOdtcmTWj+V560YfQYmty1GzWW3vM0gsl1th1LlaLDfn6kwaPjA/spa9cuysST36B1tLCHBxUuVEgnYHKd7WhM92KiKPvCz5R98QxpIsNJjWew0oq2NLNdB1nAxDrbX7VuTVlhHM5+OUXaZ78TpdwnzaWfKXPDBkHGA9xXywKo/vvvm15neycH0ax9+yn7zAnSJv9O2hf3SPPrKb5/DqR0noxmLFoi7qUDBwwUrci1znYs912sLbt/L2lOHyPNmVjKDN1JGTzA6XPnUQaLZK4Ppv0jRppeZzuYZ2p4VC76vI7v2teulcnzKW32HHHjnblxMy3p3sP0OtvdGjTk0V4vDRju1LlG1JzGN91ovhplLFDt3XfFeWByne1Ib54nL1/BNfPtPh6ZM7CPp+H4EmLLQPGmtYDJdbZLvv02hQz9htSr1kgLEgdLRHXwRgrgpsNHgcV1tjt+Uou2ff01RfGZuLpnL6pRpoxROWBfZ/t/w0aMGOEAyLu225gxY/wAedc28/b2rjBx4sRUAGk523obPXp00L59+whAWs62zry8vOpNnTpV8+DBAwKQRp5cbNrYoQb3tx9jIeMq/uP62rVrAkgjTy7rB1+ZJpo6nTNfzpkzRywuhb9oPn/+PD18+FCs1AMgjTyUwQe+4ICLwSrCiZNYFAFrAiUkJNCZM2fFGkEghB8Kp5ijMSIPZfCBLzjgilYM4/tGzriA/3S+e/cuhXNoxz8t79u7T2zxT9Ph4WGiDD5cexw4gqwYC5RhJGCNixs3boh/WDYE8lAGH/jKNGPjgnZYOOH27du0afNm8QfJmzdvElvkYSEF+MjuuW3UqFGeG/hTCAsrhYaG0sWLF8QaukjHx18ilMFHds9t3DdfnDh//vkn/fbbb2KwAKSRhzL4yO65jQs3YZBQE4/wS95fDCCNPHkAN8nuuY37d5LxlDGdSaXlbBzq0siTy3JP9xVj9X6WLl+UwUfetZs19mhGmdeLiU9nl8p/TEzyK10heWHF/MfEp34lg9JjvPIXE5/5laiXvKSqRpsUZX1MfDLrnRpP55TslzS75MKns0tezfh5BtFfG/OOiUyYzs19+Xx1fUrd04vST/Bc8fpqouRo0v7uk3dMvL+4YpEkv5InX4V5Ej0/wbVuIO29WaS9PYq0NwZaFxOT55cqkTS71IW0qJFET0JJe60Laa+4CVgdE1PmOJThriSkH59A9DCQtL/WJPrVybaYyCdOu5QNLtyNYKIzJUl7tpRtMTHJr4Rn6t4+RPf9iM7XILo307aY+NSvlC9OHkqOpOw/9xMG1qaYyAKbMJBoxdN5777ko2NbTMThTPIr9RTnxvMZxW2PiTgTcQnLu7nMHhPzYRhQS4OapyEmAvKubabERABpOdt6U2IigLScbZ0ZxkQAaeTJxabNXEwEkEaeKGMf+Mq0vGMigDTyUAYf+IIDrumYeF8fEwXujBZxEmXwgS844IpW5IqJV5WY2EZsCVuOkyiDD1/2ceAIsmI5YyLiofZ8TYYTpzk+ch7K4ANfmWZs+pi4nojjIZ0xAMfJlI0teDBL2RYTBX7lNOehDD6ye24zFRMBpJEnnVSlbIuJANLIkwfQ9piINPJEGfvI2bktr5iIMvjIu3b7/2IVvSsWKfM6QbXspHKxZSeWixP/qmmrlZ1Ytt8XK5oSUGaiY6418iwamv3BtEoPVt8LpDX3g+j97yslc3d0Z2aeVnai47zB4UMp8NF6CnoUTEiXm1hupVxs2cpPKv/BJ/NqZW5+tI3GJ/jQuIRJtPnxNnKaV0tT5rv3LEdmWLmJjlu/PzeDZt+ZT1/+8jX1Y/jdWUDIKzfJEQtQmrcyk8o3bbG2Fa3jUO5+oje1j+1O7WJ7UNeTfWjD4y3UdGVzdKWj7J7D+FA5Ti5/cdmtFfTV2W+oUXhLRisdhsaNpkXXl5LjpPK3nGaYeFyCQ9V9hwctuLOEPg51phohn8ngdOhnVDO0ES29t4LgU25SOR+ZJhkOUeUZVZLXPdhALQ93Fv/lbApto3oQfCrPqJxaekpF/QcuDlHv0L7ib5jx/9U//L7MJIIebhA+Hjt78Vg4bpXpOO7lrr43pQI1XPqZVYAvH5GHMl26aMr7lG9gC17rIrPbv8OOOZVxCPu4fANbsNPwZwR4khnh9D791NHFKsAXT0dluvhx39Yr3/H05s4d4tsz8W6fKfCNo/C55jMWz171EepgtYoVohpWT828eIHwF3xZm7dSpsAWgSwFBw8SfNg3+bBTjhjJTfK57D2ctHyXhpfi1KvXUMaqNeJbfgVavv2FD54KyzS94ZlqeI3yt15EHaas0N2UsXARpctAOnP7Tko9fozCP37vIp4KyzRj4351PNOzI0/prlH67LmUNm0GpeF1vFmzxRj80r87116+qexu2nhAjzzavpkyQ3ZLr6F4f0eZu0IJeRhs2c28hVV7r94xlwaa7GtXKU38PnEaIX2sxWeZByqXN/M/7zkMh+j2vJmUffIn8WtRpPlcmScX5204RJF1KydnxJ2j9HNn6HCdyg9wtsrF1hkO1c892hMQXrWs7RMr8etRPHevXg5ryObP0Gyji8ZudvtnW9IcB6cns0o0sAWPZhSvKpFnlViZNLsE5QuzSszju/biJ8Wd6sMfbYI2cS0EwvjuvXhs1vnBRNf7MwbI25xQ8rEdQFpG5s8DuRXF9/PtbvHeT2aXOM1NirMFaPljv2JmJp12s9v/ud33VhV5NKWg55MpBUKeTCkYJ6FACPJQJruZtqQpKufHUwomPFtRh1IPDKaMX5YKII08lMFHdje2x9MKej2Z6aBJPzWHKP22hFdXGDy9k/dRBh/4yjTJkiYXcnviW0KjSYySnF8ck677xHlE92cyfIme7hNl8IEvODJdpeJ+xqOplH6T6MkOogeLmYw36KYT3Z3Ak8vRRLeGSGJpN0S3wBHkR1NVTZN/+ECq+VkkkxcR/YF3174n+h1knsHe4oCT0JcIX8j9yS1jX3DAVT2ZWtAHg0Tpt6Rm/+FHdG8ak79j8giim4OY3Ifoameiy2687SpaCg643PwC/uknuGmv4pk8m5s8lei38US3hzPZk0NYLya5M7kV0cUviH5tQJTyM4EDLreggF9aDDcVAnenMHksk7/hSfdXTO7J5I5E8S2Z/DmT6xOd/4To5S8EDgv4qh5PLTg4ZTv3DV24x7XfGsZkBE8PoisdmNyCyY2Z/ClRnBOnG/FA3iRwcHKp/pysKsMfFGpt8nkivkOnGxx9r3VncnsmuxJdALke0S81ic5V4Up42su+4IArjgT6krKFa+NDRPgS9kpbokvNmcy1/VqHawa5Mgtzq9ISCL6i/4olT1KVwHFNi+Uu4HDiUF1uw/0FuQaLNOTzgg8vl8EHvuDIdMn4HK/A43H2xXpX0jyMlYR4tCnltEgjD2XwYbLpOTOuNnYYx0jExfNyd18BcSFxHtc8Ic8rUrGkySqnx1MKdQSQlrPtZoul7Clc8+Xmt/oDSMvZ1ltaWMG9GdEqyohREdJytvWWduhfezOO/osApOVs6y09oujejNiipGYgLWdbb+mRpfeqT7xD6hOlCWk523pLi3IMzDxVgQCk5WzrLf3oR7Mzf67Ks7GqhLScbb1lnq71TdYvdSjrXB1CWs623rLON+qcdb4xZcUxOC1nW2+Z8a4umostKfNc82yk5ez/JEuPVg3JiFKdAZCWs603Jt0U1wIDaTnbenvtFtjtNewfNk/kmYiAvG/9PPGv9ZQa60ipx0oLpJ/iicXDtaLM8jyRJw90x0tMa1KOvEmkzSSt+k96dexdniN8xpMuniuyj/l54p8rpDlRvIskIJYsSGOBd1iAZ2fnearzx0Lha2KeyLPUaz14auMipjeSgJYo6wULlJbmSedrcxnPm3iSlXue+PKcTG4m5oMpUUWYryFtxp88reEugIwnwHEfm5knYrQxsbrYlNGEXkY7cPPVpH2VwM5lmczzQ8zUfqlubp7IXbjCM1ImY3b26mhJrvkd3hanjJOO0kwtjsmY9pmdJz7wl6d2DSn9eBk+CEmU/fw0qU++xzXzbO1cNZ6Ez7E0T+TDiEPFU9r04+9S9st40vy1gwW4BSBf50m3VfPEB0tJfbqKIKpPlqOsM1x74hJRlo95IoPT9nniP97wMtDICQH0dKbD8Ke+Dg8ZJDCz6J4ns4pZ924fkxOTfB0iNBEF+UaLrw2OSuqYjsR595JmFHdO8i3qljSzaCxvTb9VhgI6oSIBIRBM2Ze+hoCaxeNQ/mqPu/CTaXozKxAvBO7RWY5Y92ZS1qXp1grw3Sl34fUEHrGA1IV7dC6/LVAEzlayTiDrYCEQInA4eXshLfQLWUBqQWbcJEsCDvee+ha9mjSrmCftUhVK9nVw4f2zOC80RyvwtN8D58bDpzOLWf9uH743xSFkYgyfA78lzXDI/7t9NENlf7fPkoFsf7fvNU15M+if9W5ftzZVaOGkJrRpoStNHV6HmtR716gcMP1uX5miFLmRJ1t3xktTvhs8XxDf5PWgxRM+ocL/KqgTMPlu39GtHiJ40KNgxmZOT+eJRW9p+nO5Hc0ZrbxlaOLdPs8ePA+6PZZnpat5JnKV5wW3iB5v5Rb047ljGwHN5W7UwKm46Xf7QgLciG6NkCacaVdYgCdejzdx83tKU0BuASUMpLUzpT9NzfVu38ltPE/C14B3vCWRh2u4RWO45tY8e+PZGb6gu/E17VnW0PS7fZsWfC7Vhhkrvg7Et3rx+CKSyRd4rnylk5iELfSuavrdvh5tKrITvvrEV4FMxKxVnvbRRe7C9b6kTRhE1T+QzgOT7/Zd2MPNvcIfbVc6Sn1G8zGAmOLdHEqhS+oJP8Dku31lS79JcaFMuDGI4SmNCW+1CV/Txjm1dWTA4rt9vdqWp7CVjejnbU1p24K6VLtaUaNywP5un92sskczVI4WP9bzssdTC2wV94b5MdyVPp1fnp4tc3qFuxk523rju5O4jLhllHkrhO9WCuT9+xNDezK5YL/nq52JMn4XSNneVbpPtsZ44Bxwf5R1ew9pf/MWyH5yhu8Ti1+SXSzb4ykF5qFG1Ky9PYIxXKRfRXoRWia7mTbczj3h2Tlq1HIgMULKVXq6oMJDtFB2z20YrLSYSVLtHFC117rJWw6unIdBRQtld2MTX0Qs/ojo1U3SXm4tQPJWSvNnBos8W90o85GPSnpwrxj1VBXiE+ZCxnn+LGAnPMnRcijXIiIbprks6244Pfn+X+EyVTI+5sN0hy2uFtF5BfjSgSHy5DT7vNzdj7tSSHpsLg7btDcSoSwErAAGmSfld8R1In1rpXxjlQemFozlgV6jwOyXUtabSvX/AOf1iiJEERHsAAAAAElFTkSuQmCC"},o.getIcon=function(e,t){var n,r=[["0,160,16,16","0,180,16,16","0,80,16,16",O,O],["0,100,16,16","0,120,16,16","0,140,16,16",O,O],["0,900,16,16","0,920,16,16","0,880,16,16",O,O],["0,820,16,16","0,840,16,16","0,860,16,16",O,O],["0,780,16,16","0,1000,16,16","0,420,16,16",O,O],["0,680,16,16","0,940,16,16","0,400,16,16",O,O],["0,800,16,16","0,1020,16,16","0,440,16,16",O,O],["0,740,16,16","0,1040,16,16","0,400,16,16",O,O],["0,720,16,16","0,980,16,16","0,380,16,16",O,O],["0,700,16,16","0,960,16,16","0,360,16,16",O,O],["0,160,16,16","0,40,16,16","0,60,16,16","0,80,16,16",O],["0,100,16,16","0,0,16,16","0,20,16,16","0,140,16,16",O],["0,220,16,16","0,340,16,16","0,460,16,16","0,760,16,16",O],["0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16",O],["0,200,16,16","0,680,16,16","0,940,16,16","0,400,16,16",O],["0,160,16,16","0,40,16,16","0,180,16,16","0,60,16,16","0,80,16,16"],["0,100,16,16","0,0,16,16","0,120,16,16","0,20,16,16","0,140,16,16"],["0,580,16,16","0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16"],["0,480,16,16","0,500,16,16","0,520,16,16","0,540,16,16","0,560,16,16"],["0,240,16,16","0,260,16,16","0,280,16,16","0,300,16,16","0,320,16,16"]],i=o._getImageSrc(),a=r[e][t];return a?{image:i,x:(n=a.split(","))[0],y:n[1],w:n[2],h:n[3]}:O},o}(R),e.IconSetRule=D,F=function(t){function o(o,n){t.call(this),this.ignoreBlank=!1,this.expected="string"==typeof o?o:"",this.formula="string"==typeof n?G(e.GC$.trim(n),"="):n}return __extends(o,t),o.prototype._concatArray=function(e,t){var o,n;if(1===t.length)if((o=t[0])instanceof Array)for(n=0;n<o.length;n++)e.push(o[n]);else e.push(o);else for(n=0;n<t.length;n++)(o=t[n])instanceof Array?o.length>0&&e.push(o[0]):e.push(o)},o.prototype.getValidList=function(e,t,o){for(var n=[],r=this.getValidListImp(e,t,o),i=0,a=r.length;i<a;i++)n.push(r[i].value);return n},o.prototype.getValidListImp=function(t,o,n){var r,i,a,s,l,u=[];if(this.formula&&this.formula.length>0)(r=this.getExpected(t,o,n))instanceof Array?this._concatArray(u,r):u.push(r);else if(this.expected&&this.expected.length>0&&(i=this.expected.split(",")))for(a=0;a<i.length;a++)(s=i[a])!==P&&s!==O&&""!==s&&((l=e.GC$.trim(s))!==P&&l!==O&&""!==l&&u.push({text:l,value:l}));return u},o.prototype._equals=function(e,t){return e instanceof Date&&t instanceof Date?e.valueOf()===t.valueOf():e===t},o.prototype.evaluate=function(t,o,n,r){var i,a,s,l,u;if(r===P||r===O||""===r)return!0===this.ignoreBlank;if(i=this.getValidList(t,o,n))for(a=0;a<i.length;a++){if(!((s=i[a])!==P&&s!==O||r!==P&&r!==O))return!0;if(s!==P&&s!==O)if(this.formula){if(this._equals(s,r))return!0}else if(l=t.getActualStyle(o,n),u=e.util.parseText2Value(l,s,!0),this._equals(u,r))return!0}return!1},o.prototype.getExpected=function(e,t,o){var n,r,i,a,s,l,u,c,h,p=[];if(this.formula){if(!(u=e.getCalcService()))return p;if(c=u.parse(e._getSheetSource(),this.formula,t-this.offsetRow,o-this.offsetCol),h=u.evaluateParsedFormula(e._getSheetSource(),c,t,o,!0),z.ref(h)){n=h.getRowCount(0),r=h.getColumnCount(0);var d=h.getRow(0),f=h.getColumn(0),g=h._sheetSource&&h._sheetSource._sheet;for(i=0;i<n;i++)for(p[i]=[],a=0;a<r;a++)s=h.getValue(0,i,a),l=g?g.getText(d+i,f+a):s,p[i][a]={value:s,text:l}}else if(z.arr(h))for(n=h.getRowCount(),r=h.getColumnCount(),i=0;i<n;i++)for(p[i]=[],a=0;a<r;a++)s=h.getValue(i,a),p[i][a]={value:s,text:s}}else p.push({value:this.expected,text:this.expected});return p},o.prototype._isDefaultValue=function(e,t){switch(e){case"ignoreBlank":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={expected:this.expected,formula:this.formula,conType:12,ignoreBlank:this.ignoreBlank},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){e&&(e.expected!==O&&e.expected!==P&&(this.expected=e.expected),e.formula!==O&&e.formula!==P&&(this.formula=e.formula),e.ignoreBlank!==O&&e.ignoreBlank!==P&&(this.ignoreBlank=e.ignoreBlank))},o.fromSource=function(e){return new o(e,O)},o.fromFormula=function(e){return new o("",e)},o.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},o.prototype.setFormulas=function(e){this.formula=e[0]},o}(t),e.AreaCondition=F,M=function(){function t(e){this.rules=[],this._ruleTypes=O,this._cellRuleCache={},this.worksheet=e}return t.prototype.getRule=function(e){return this.rules[e]},t.prototype.count=function(){return this.rules.length},t.prototype._cloneToActualRanges=function(e){for(var t,o=[],n=this.worksheet,r=e.length,i=0;i<r;i++)t=n._getActualRange(e[i]),o.push(t);return o},t.prototype._cloneToRanges=function(t){for(var o,n,r=[],i=this.worksheet,a=0,s=t.length;a<s;a++)o=t[a],n=new e.Range(o.row,o.col,o.rowCount,o.colCount),0===o.row&&o.rowCount===i.getRowCount()&&(n.row=-1),0===o.col&&o.colCount===i.getColumnCount()&&(n.col=-1),r.push(n);return r},t.prototype._resetCache=function(){var e;if(this._cellRuleCache={},this._cellRuleCache,this.rules)for(e=0;e<this.rules.length;e++)this._addCache(this.rules[e])},t.prototype.clearCellRuleCache=function(){this._cellRuleCache={}},t.prototype._addCache=function(e){for(var t,o,n,r,i,a,s=this._cellRuleCache,l=this._cloneToActualRanges(e.ranges),u=this.worksheet,c=u.getRowCount(),h=u.getColumnCount(),p=0;p<l.length;p++){var d=l[p],f=d.row,g=d.col,m=d.rowCount,_=d.colCount;for(f+m-1>=c&&(m=c-f),g+_-1>=h&&(_=h-g),t=0;t<m;t++)for((n=s[i=t+f])||(s[i]=n={}),o=0;o<_;o++)(r=n[a=o+g])||(n[a]=r=[]),r.push(e)}},t.prototype._removeCache=function(e){for(var t,o,n,r,i,a,s,l,u=this._cellRuleCache,c=this._cloneToActualRanges(e.ranges),h=0;h<c.length;h++)for(t=c[h],o=0;o<t.rowCount;o++)if(a=u[o+t.row])for(n=0;n<t.colCount;n++)if(s=a[l=n+t.col]){for(r=[],i=0;i<s.length;i++)s[i]!==e&&r.push(s[i]);0===r.length&&(r=P),a[l]=r}},t.prototype._removeCacheByRange=function(e,t,o,n){for(var r,i,a=this._cellRuleCache,s=0;s<o;s++)if(i=a[s+e])for(r=0;r<n;r++)i[r+t]=P},t.prototype.addSpecificTextRule=function(e,t,o,n){var r=new s(e,t,o);return r.ranges=n,this.addRule(r)},t.prototype.addCellValueRule=function(e,t,o,n,i){var a=new r(e,t,o,n);return a.ranges=i,this.addRule(a)},t.prototype.addDateOccurringRule=function(e,t,o){var n=new d(e,t);return n.ranges=o,this.addRule(n)},t.prototype.addFormulaRule=function(e,t,o){var n=new c(e,t);return n.ranges=o,this.addRule(n)},t.prototype.addTop10Rule=function(e,t,o,n){var r=new m(e,t,o);return r.ranges=n,this.addRule(r)},t.prototype.addUniqueRule=function(e,t){var o=new y(e);return o.ranges=t,this.addRule(o)},t.prototype.addDuplicateRule=function(e,t){var o=new C(e);return o.ranges=t,this.addRule(o)},t.prototype.addAverageRule=function(e,t,o){var n=new v(e,t);return n.ranges=o,this.addRule(n)},t.prototype.add3ScaleRule=function(e,t,o,n,r,i,a,s,l,u){var c=new T(e,t,o,n,r,i,a,s,l);return c.ranges=u,this.addRule(c)},t.prototype.add2ScaleRule=function(e,t,o,n,r,i,a){var s=new b(e,t,o,n,r,i);return s.ranges=a,this.addRule(s)},t.prototype.addDataBarRule=function(e,t,o,n,r,i){var a=new A(e,t,o,n,r);return a.ranges=i,this.addRule(a)},t.prototype.addIconSetRule=function(e,t){var o=new D(e);return o.ranges=t,this.addRule(o)},t.prototype.addRule=function(t){if(this.worksheet){var o=this;return this.worksheet._bindToAutoRefresh(function(t){if(!t)throw new Error(e.SR.Exp_RuleIsNull);for(var n=0;n<o.rules.length;n++)o.rules[n]._priority++;return t._priority=1,o.rules.push(t),o._addCache(t),t})(t)}},t.prototype.removeRule=function(t){if(this.worksheet){var o=this;this.worksheet._bindToAutoRefresh(function(t){t&&(o._removeCache(t),e.ArrayHelper.remove(o.rules,t))})(t)}},t.prototype._removeRange=function(t,o,n,r,i){var a,s,l,u,c,h,p,d;if(!t.intersect(o,n,r,i))return[t];var f=t.row,g=t.row+t.rowCount-1,m=t.col,_=t.col+t.colCount-1,y=o,C=o+r-1,w=n,v=n+i-1,S=[];return-1!==f&&-1!==m&&-1!==y&&-1!==w&&(w-m>0&&y-f>0&&(a=new e.Range(f,m,y-f,w-m),S.push(a)),H(v,_)-k(w,m)>=0&&y-f>0&&(s=new e.Range(f,k(w,m),y-f,H(v,_)-k(w,m)+1),S.push(s)),_-v>0&&y-f>0&&(l=new e.Range(f,v+1,y-f,_-v),S.push(l)),w-m>0&&H(C,g)-k(y,f)>=0&&(u=new e.Range(k(y,f),m,H(C,g)-k(y,f)+1,w-m),S.push(u)),_-v>0&&H(C,g)-k(y,f)>=0&&(c=new e.Range(k(y,f),v+1,H(C,g)-k(y,f)+1,_-v),S.push(c)),w-m>0&&g-C>0&&(h=new e.Range(C+1,m,g-C,w-m),S.push(h)),H(v,_)-k(w,m)>=0&&g-C>0&&(p=new e.Range(C+1,k(w,m),g-C,H(v,_)-k(w,m)+1),S.push(p)),_-v>0&&g-C>0&&(d=new e.Range(C+1,v+1,g-C,_-v),S.push(d))),S.length>0?S:O},t.prototype.removeRuleByRange=function(t,o,n,r){if(this.worksheet){var i=this;this.worksheet._bindToAutoRefresh(function(t,o,n,r){var a,s,l,u,c,h,p,d,f,g,m=[];if(i.rules)for(i._removeCacheByRange(t,o,n,r),a=0,s=i.rules.length;a<s;a++)if((l=i.rules[a])&&l.ranges&&l.intersects(t,o,n,r)){for(u=[],h=0,p=(c=i._cloneToActualRanges(l.ranges)).length;h<p;h++)(d=i._removeRange(c[h],t,o,n,r))&&(u=u.concat(d));u.length>0?l.ranges=i._cloneToRanges(u):m.push(l)}for(f=0,g=m.length;f<g;f++)e.ArrayHelper.remove(i.rules,m[f])})(t,o,n,r)}},t.prototype.clearRule=function(){if(this.worksheet){var e=this;this.worksheet._bindToAutoRefresh(function(){e.rules.length=0,e._resetCache()})()}},t.prototype.getRules=function(e,t){var o,n,r,i,a,s,l,u=this.rules;if(0===arguments.length||0===u.length)return u;if(e=void 0===e?-1:e,t=void 0===t?-1:t,o=this._cellRuleCache,n=[],-1!==e&&-1!==t){if((i=o[e])&&(s=i[t]))for(l=0;l<s.length;l++)n.push(s[l])}else if(-1===e){for(r in o)if(s=o[r][t])for(l=0;l<s.length;l++)n.push(s[l])}else if(i=o[e])for(a in i)for(s=i[a],l=0;l<s.length;l++)n.push(s[l]);return n},t.prototype.containsRule=function(t,o,n){return!(!t||!e.ArrayHelper.contains(this.rules,t))&&t.contains(o,n)},t.prototype._clearNullRefRules=function(){var e,t;if(this.rules)for(e=this.count()-1;e>-1;e--)(t=this.rules[e]).hasNoReference()&&this.removeRule(t)},t.prototype._addRows=function(e,t){var o,n,r;if(this.rules&&this.worksheet)for(o=this.rules.length,n=0;n<o;n++)(r=this.rules[n])&&r._addRows(e,t);this._resetCache()},t.prototype._addColumns=function(e,t){var o,n,r;if(this.rules&&this.worksheet)for(o=this.rules.length,n=0;n<o;n++)(r=this.rules[n])&&r._addColumns(e,t);this._resetCache()},t.prototype._removeRows=function(e,t){var o,n,r;if(this.rules&&this.worksheet)for(o=this.rules.length,n=0;n<o;n++)(r=this.rules[n])&&r._removeRows(e,t);this._resetCache()},t.prototype._removeColumns=function(e,t){var o,n,r;if(this.rules&&this.worksheet)for(o=this.rules.length,n=0;n<o;n++)(r=this.rules[n])&&r._removeColumns(e,t);this._resetCache()},t.prototype._clearCache=function(){var e,t,o,n=this.rules;if(n!=O&&n.length>0)for(t=0,o=n.length;t<o;t++)(e=n[t])instanceof R&&e._clearCache()},t.prototype.toJSON=function(){for(var e,t=[],o=0;o<this.rules.length;o++)e=this.rules[o],t.push(e?e.toJSON():O);return 0===t.length?P:{rules:t}},t.prototype.fromJSON=function(e,t){var o,n,r,i;if(e&&e.rules){for(this.rules=[],o=0;o<e.rules.length;o++)n=e.rules[o],r=O,n&&((i=this._getRuleTypes()[n.ruleType])&&(r=new i).fromJSON(n,t)),r&&this.rules.push(r);this._resetCache()}},t.prototype._getRuleTypes=function(){if(!this._ruleTypes){var e={};e[0]=o,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=m,e[6]=y,e[7]=C,e[8]=v,e[9]=R,e[10]=b,e[11]=T,e[12]=A,e[13]=D,this._ruleTypes=e}return this._ruleTypes},t}(),e.ConditionalFormats=M}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){var o;t.feature("dataValidator",["core.common"]);var n=null,r=void 0,i=t.StringHelper.TrimStart;o=function(){function o(e){this.id=o._validatorId++,this._init(),e&&(this.condition=e,this.condition.ignoreBlank=this.ignoreBlank)}return o.prototype.IgnoreBlank=function(e){return arguments.length<=0?this.ignoreBlank:(this.ignoreBlank=e,this.condition&&(this.condition.ignoreBlank=e),this)},o.prototype._init=function(){var e=this;e.errorStyle=0,e.ignoreBlank=!0,e.inCellDropdown=!0,e.showInputMessage=!0,e.showErrorMessage=!0,e.inputTitle="",e.errorTitle="",e.inputMessage="",e.errorMessage="",e.comparisonOperator=6,e.condition=n,e.type=0},o.prototype.value1=function(){var e=this.condition&&this.condition.item1?this.condition.item1:this.condition;return e?e.formula&&e.formula.length>0?"="+i(t.GC$.trim(e.formula.toString().toUpperCase()),"="):e.expected:n},o.prototype.value2=function(){var e=this.condition&&this.condition.item2?this.condition.item2:this.condition;return e?e.formula&&e.formula.length>0?"="+i(t.GC$.trim(e.formula.toString().toUpperCase()),"="):e.expected:n},o.prototype.isValid=function(e,t,o,i){var a,s,l;if(this.condition){if(this.IgnoreBlank(this.ignoreBlank),this.condition.ignoreBlank&&(i===r||i===n||""===i))return!0;if(a=i,i!==r&&i!==n)switch(this.type){case 0:return!0;case 2:case 1:(s=function(e){if(e===r||e===n)return 0;if("number"==typeof e)return e;if("string"==typeof e){var t=parseFloat(e);if(!isNaN(t)&&t.toString()===e.toString())return t}return n}(i))!==r&&s!==n&&(a=s);break;case 4:case 5:(s=(l=i)instanceof Date?l:"string"==typeof l?new Date(l):n)!==r&&s!==n&&(a=s)}return this.condition.evaluate(e,t,o,a,a)}return!0},o.prototype.reset=function(){this._init()},o.prototype.getValidList=function(e,o,r){if(!t.features.conditionalFormat)return n;return this.condition!=n&&3===this.type&&this.condition instanceof t.AreaCondition?this.condition.getValidList(e,o,r):n},o.prototype._isDefaultValue=function(e,t){switch(e){case"errorStyle":return 0===t;case"ignoreBlank":case"inCellDropdown":case"showInputMessage":case"showErrorMessage":return!0===t;case"inputTitle":case"errorTitle":case"inputMessage":case"errorMessage":return""===t;case"comparisonOperator":return 6===t;case"type":return 0===t;case"condition":return t===n;default:return!1}},o.prototype.toJSON=function(){var e,o,n=this,i={errorStyle:n.errorStyle,ignoreBlank:n.ignoreBlank,inCellDropdown:n.inCellDropdown,showInputMessage:n.showInputMessage,showErrorMessage:n.showErrorMessage,inputTitle:n.inputTitle,errorTitle:n.errorTitle,inputMessage:n.inputMessage,errorMessage:n.errorMessage,comparisonOperator:n.comparisonOperator,type:n.type,condition:n.condition?n.condition.toJSON():n.condition},a={};for(e in i)o=i[e],n._isDefaultValue(e,o)||(a[e]=o);return t.GC$.isEmptyObject(a)?r:a},o.prototype.fromJSON=function(e,o){var i;if(e){if(i=this,t.features.conditionalFormat&&e.condition!==n&&e.condition!==r){var a=n,s=i._getConditionTypes()[e.condition.conType];s&&(a=new s).fromJSON(e.condition,o),i.condition=a}e.type!==n&&e.type!==r&&(i.type=e.type),e.comparisonOperator!==n&&e.comparisonOperator!==r&&(i.comparisonOperator=e.comparisonOperator),e.errorStyle!==n&&e.errorStyle!==r&&(i.errorStyle=e.errorStyle),e.ignoreBlank!==n&&e.ignoreBlank!==r&&(i.ignoreBlank=e.ignoreBlank),e.inCellDropdown!==n&&e.inCellDropdown!==r&&(i.inCellDropdown=e.inCellDropdown),e.showInputMessage!==n&&e.showInputMessage!==r&&(i.showInputMessage=e.showInputMessage),e.showErrorMessage!==n&&e.showErrorMessage!==r&&(i.showErrorMessage=e.showErrorMessage),e.inputTitle!==n&&e.inputTitle!==r&&(i.inputTitle=e.inputTitle),e.errorTitle!==n&&e.errorTitle!==r&&(i.errorTitle=e.errorTitle),e.inputMessage!==n&&e.inputMessage!==r&&(i.inputMessage=e.inputMessage),e.errorMessage!==n&&e.errorMessage!==r&&(i.errorMessage=e.errorMessage)}},o.prototype.clone=function(){var t=new e.Sheets.DefaultDataValidator;return t.fromJSON(this.toJSON()),t},o.prototype._getConditionTypes=function(){if(!this._dict){var e={};e[0]=t.RelationCondition,e[1]=t.NumberCondition,e[2]=t.TextCondition,e[3]=t.ColorCondition,e[4]=t.FormulaCondition,e[5]=t.DateCondition,e[6]=t.DateExCondition,e[7]=t.TextLengthCondition,e[8]=t.Top10Condition,e[9]=t.UniqueCondition,e[10]=t.AverageCondition,e[11]=t.CellValueCondition,e[12]=t.AreaCondition,this._dict=e}return this._dict},o.getImageSrc=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},o.isFormula=function(e){return e&&"="===e[0]},o.createNumberValidator=function(e,r,a,s){var l;if(!t.features.conditionalFormat)return n;var u,c,h=o.isFormula(r)?i(r,"="):n,p=o.isFormula(r)?n:r,d=o.isFormula(a)?i(a,"="):n,f=o.isFormula(a)?n:a,g=n;t.ComparisonOperator,t.GeneralCompareType,t.RelationCompareType;switch(e){case 6:(u=new t.NumberCondition(3,p,h)).integerValue=s,(c=new t.NumberCondition(5,f,d)).integerValue=s,g=new t.RelationCondition(1,u,c);break;case 7:(u=new t.NumberCondition(4,p,h)).integerValue=s,(c=new t.NumberCondition(2,f,d)).integerValue=s,g=new t.RelationCondition(0,u,c);break;case 0:(g=new t.NumberCondition(0,p,h)).integerValue=s;break;case 1:(g=new t.NumberCondition(1,p,h)).integerValue=s;break;case 2:(g=new t.NumberCondition(2,p,h)).integerValue=s;break;case 3:(g=new t.NumberCondition(3,p,h)).integerValue=s;break;case 4:(g=new t.NumberCondition(4,p,h)).integerValue=s;break;case 5:(g=new t.NumberCondition(5,p,h)).integerValue=s}return(l=new o(g)).type=s?1:2,l.comparisonOperator=e,l},o.createDateValidator=function(e,r,a){var s;if(!t.features.conditionalFormat)return n;var l,u,c=o.isFormula(r)?i(r,"="):n,h=o.isFormula(r)?n:r,p=o.isFormula(a)?i(a,"="):n,d=o.isFormula(a)?n:a,f=n;t.ComparisonOperator,t.DateCompareType,t.RelationCompareType;switch(e){case 6:l=new t.DateCondition(5,h,c),u=new t.DateCondition(3,d,p),f=new t.RelationCondition(1,l,u);break;case 7:l=new t.DateCondition(2,h,c),u=new t.DateCondition(4,d,p),f=new t.RelationCondition(0,l,u);break;case 0:f=new t.DateCondition(0,h,c);break;case 1:f=new t.DateCondition(1,h,c);break;case 2:f=new t.DateCondition(4,h,c);break;case 3:f=new t.DateCondition(5,h,c);break;case 4:f=new t.DateCondition(2,h,c);break;case 5:f=new t.DateCondition(3,h,c)}return(s=new o(f)).type=4,s.comparisonOperator=e,s},o.createTextLengthValidator=function(e,r,a){var s;if(!t.features.conditionalFormat)return n;var l,u,c=o.isFormula(r)?i(r,"="):n,h=o.isFormula(r)?n:r,p=o.isFormula(a)?i(a,"="):n,d=o.isFormula(a)?n:a,f=n;t.ComparisonOperator,t.GeneralCompareType,t.RelationCompareType;switch(e){case 6:l=new t.TextLengthCondition(3,h,c),u=new t.TextLengthCondition(5,d,p),f=new t.RelationCondition(1,l,u);break;case 7:l=new t.TextLengthCondition(4,h,c),u=new t.TextLengthCondition(2,d,p),f=new t.RelationCondition(0,l,u);break;case 0:f=new t.TextLengthCondition(0,h,c);break;case 1:f=new t.TextLengthCondition(1,h,c);break;case 2:f=new t.TextLengthCondition(2,h,c);break;case 3:f=new t.TextLengthCondition(3,h,c);break;case 4:f=new t.TextLengthCondition(4,h,c);break;case 5:f=new t.TextLengthCondition(5,h,c)}return(s=new o(f)).type=6,s.comparisonOperator=e,s},o.createFormulaValidator=function(e){if(!t.features.conditionalFormat)return n;var r=new o(new t.FormulaCondition(4,i(e,"=")));return r.type=7,r},o.createFormulaListValidator=function(e){if(!t.features.conditionalFormat)return n;var r=new o(t.AreaCondition.fromFormula(e));return r.type=3,r},o.createListValidator=function(e){if(!t.features.conditionalFormat)return n;var r=new o(t.AreaCondition.fromSource(e));return r.type=3,r},o._validatorId=1,o}(),t.DefaultDataValidator=o}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n,r;e.feature("celltype",["core.common","core.sheet_action","core.basecelltype"]);var i,a,s,l,u=null,c=void 0,h=Math.max,p=Math.min,d=Math.floor,f=Math.round,g=window.document,m="position",_="absolute",y="margin",C="font",w="left",v="top",S="alphabetic",x="gcUIElement",R="tabindex",b="none",T=".gcEditingInput",A="keydown"+T,I="keyup"+T,D="mousedown"+T,F="mouseup"+T,M="mouseout"+T,E="mousemove"+T,N="click"+T,O="width",P="height",L="padding",H="hidden",k="overflow",V="resize",B="border",z="outline",G="box-shadow",W="box-sizing",j="color",U="white-space",Y="background-color",X="z-index";(i=e.EditorValueType||(e.EditorValueType={}))[i.Text=0]="Text",i[i.Index=1]="Index",i[i.Value=2]="Value",e.EditorValueType,(a=e.CheckBoxTextAlign||(e.CheckBoxTextAlign={}))[a.top=0]="top",a[a.bottom=1]="bottom",a[a.left=2]="left",a[a.right=3]="right",e.CheckBoxTextAlign,(s=e.HyperLinkTargetType||(e.HyperLinkTargetType={}))[s.Blank=0]="Blank",s[s.Self=1]="Self",s[s.Parent=2]="Parent",s[s.Top=3]="Top",e.HyperLinkTargetType,t=function(t){function o(){t.call(this);this.allowOverflow=!1,this.typeName="5",this._checkboxSize=12,this._caption="",this._textTrue="",this._textIndeterminate="",this._textFalse="",this._textAlign=3,this._isThreeState=!1}return __extends(o,t),o.prototype.paintValue=function(t,o,n,r,i,a,s,l){var h;if(t){t.save(),t.rect(n,r,i,a),t.clip(),t.beginPath();var p=this,f=this.getText(o,l),g=0,m=0,_=l.sheet;_&&(g=_._getStringWidthByCanvas(f,s.font),m=_._getFontHeight(s.font),f&&(m*=f.split(/\r\n|\r|\n/).length));var y=p._checkboxSize/2,C=new e.Rect(++n,++r,--i,--a),v=parseInt((n+p._getCheckBoxLeft(s,C,g)).toString()),x=parseInt((r+p._getCheckBoxTop(s,C,m)).toString()),R=w,b=v+1;1===s.hAlign?(R="center",b+=y):2===s.hAlign&&(R="right",b+=2*y),(h=s.font)&&t.font!==h&&(t.font=h),s.foreColor&&(t.fillStyle=s.foreColor);var T=s.textDecoration,A=l.fontInfo.fontSize,I=A>8?d((A-8)/5+2):1,D=m/2-A/2+I-1;t.textBaseline!==S&&(t.textBaseline=S),2===p._textAlign?(t.textAlign="right",t.fillText(f,v+1-2,x+y+m/2-D),T&&p._renderTextDecoration(t,T,v+1-2,x+y+m/2-D,g,A,I)):0===p._textAlign&&(t.textAlign=R,t.fillText(f,b,x-2-D),T&&p._renderTextDecoration(t,T,b,x-2-D,g,m)),t.save(),t.strokeStyle="black",t.strokeRect(v+.5,x+.5,2*y+.05,2*y+.05),t.fillStyle="white",t.fillRect(v+1,x+1,2*y-1,2*y-1),!p._isThreeState||o!==u&&o!==c?1==!!o&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(v+3,x+y),t.lineTo(v+y,x+2*y-3.5),t.lineTo(v+2*y-1.5,x+3),t.stroke()):(t.beginPath(),t.fillStyle="green",t.rect(v+3,x+3,2*(y-2.5),2*(y-2.5)),t.fill()),t.restore(),s.foreColor&&(t.fillStyle=s.foreColor),3===p._textAlign?(t.textAlign=w,t.fillText(f,v+1+2*y+2,x+y+m/2-D),T&&p._renderTextDecoration(t,T,v+1+2*y+2,x+y+m/2-D,g,A,I)):1===p._textAlign&&(t.textAlign=R,t.fillText(f,b,x+2*y+2+m-D),T&&p._renderTextDecoration(t,T,b,x+2*y+2+m-D,g,A,I)),t.restore()}},o.prototype.getText=function(e,t){return this._getDisplayText(e)},o.prototype.focus=function(e,t){e&&e.focus()},o.prototype._formatEditorValue=function(e,t,o,n){return o},o.prototype._getCheckBoxLeft=function(t,o,n,r){var i,a=o.x-1,s=o.width+1,l=0,u=0;return 0===this._textAlign||1===this._textAlign?(u=a+5,1===t.hAlign?u=a+s/2-this._checkboxSize/2:2===t.hAlign&&(u=a+s-5-this._checkboxSize)):2===this._textAlign?(l=this._checkboxSize+n,u=a+5+n,1===t.hAlign?u=a+s/2-l/2+n:2===t.hAlign&&(u=a+s-5-l+n)):(l=this._checkboxSize+n,u=a+5,1===t.hAlign?u=a+s/2-l/2:2===t.hAlign&&(u=a+s-5-l)),i=u-a,r&&e.util.browser.msie&&(i-=3),i},o.prototype._getCheckBoxTop=function(t,o,n,r){var i,a=o.y-1,s=o.height+1,l=0,u=0;return 0===this._textAlign?(l=this._checkboxSize+n,u=a+5+n,1===t.vAlign?u=a+s/2-l/2+n:2===t.vAlign&&(u=a+s-5-l+n)):1===this._textAlign?(l=this._checkboxSize+n,u=a+5,1===t.vAlign?u=a+s/2-l/2:2===t.vAlign&&(u=a+s-5-l)):(u=a+5,1===t.vAlign?u=a+s/2-this._checkboxSize/2:2===t.vAlign&&(u=a+s-5-this._checkboxSize)),i=u-a,r&&e.util.browser.msie&&(i-=3),i},o.prototype.createEditorElement=function(t){var o,n,r,i=g.createElement("div"),a=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,s=e.util.getPreferredZIndex(a)+1e3,l=e.GC$(i);return l.css(m,_).css(y,"0").css(L,"0").css(k,H).css(V,b).css(B,"2px #5292f7 solid").css(z,b).css(G,"1px 2px 5px rgba(0,0,0,0.4)").css(W,"content-box").css(X,s).attr(R,1).attr(x,"gcEditingInput"),(o=e.GC$(g.createElement("input"))).attr("type","checkbox"),l.append(o),(n=e.GC$(g.createElement("span"))).css(m,_).css(C,"normal 11pt calibri").css("cursor","default").css(U,"nowrap"),l.append(n),(r=e.GC$(g.createElement("div"))).css(m,_).css(Y,"green").css(O,2*(this._checkboxSize/2-2.5)).css(P,2*(this._checkboxSize/2-2.5)),l.append(r),i},o.prototype._getNextState=function(e){return this._isThreeState?e!==u&&e!==c&&(1!=!!e||u):!e},o.prototype.setEditorValue=function(t,o,n){t&&t.children[0]&&t.children[1]&&t.children[2]&&(n&&n.sheet&&n.sheet._startEditByKeydown||(o=this._getNextState(o)),this._isThreeState?o===u||o===c?(t.children[0].checked=!1,e.GC$(t.children[2]).show()):(t.children[0].checked=!!o,e.GC$(t.children[2]).hide()):t.children[0].checked=!!o,e.GC$(t.children[1]).text(this._getDisplayText(o)))},o.prototype.getEditorValue=function(t,o){return t&&t.children[0]&&t.children[1]&&t.children[2]?this._isThreeState&&e.GC$(t.children[2]).isVisible()?u:t.children[0].checked:u},o.prototype._triggerButtonClicked=function(e,t,o,n){var r=e.parent;r&&r.triggerButtonClicked({sheet:e,sheetName:e._name,row:t,col:o,sheetArea:n})},o.prototype.activateEditor=function(t,o,n,r){var i,a=t&&r&&r.sheet;if(a){var s=e.GC$(t),l=a._eventHandler._getCanvasPosition(),u=a.getBounds();s.css(v,l.top+u.y+n.y-2).css(w,l.left+u.x+n.x-2).css(Y,o.backColor?o.backColor:"white"),i=this,s.bind(D,function(t){e.util.cancelDefault(t)}),s.bind(F,function(e){var s=i.getEditorValue(t,r);i.setEditorValue(t,s,r),i.updateEditor(t,o,n,r),i._triggerButtonClicked(a,a._activeRowIndex,a._activeColIndex,r.sheetArea)}),s.bind(A,function(t){if(!(32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey))return i._isKeyDown=!0,e.util.cancelDefault(t),!1;8!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||e.util.cancelDefault(t)}),s.bind(I,function(e){if(i._isKeyDown&&32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey){i._isKeyDown=!1;var s=i.getEditorValue(t,r);i.setEditorValue(t,s,r),i.updateEditor(t,o,n,r),i._triggerButtonClicked(a,a._activeRowIndex,a._activeColIndex,r.sheetArea)}}),t.children[0]&&e.GC$(t.children[0]).bind("click",function(t){e.util.cancelDefault(t)})}},o.prototype.updateEditor=function(t,o,n,r){var i,a,s,l,c,h,p,d,f,g=t&&r&&r.sheet;if(g){e.GC$(t).width(n.width).height(n.height);var m=e.GC$(t),_=g._render,y=g._eventHandler._getCanvasPosition(),S=g.getBounds();m.css(v,y.top+S.y+n.y-2).css(w,y.left+S.x+n.x-2);var x=t.children[0],R=t.children[1],b=t.children[2];if(x&&R&&b){a=(i=e.GC$(R)).text(),o.foreColor&&i.css(j,o.foreColor),s=u,s=o.font?o.font:_._getDefaultFont(),g._zoomFactor>1&&(s=_._getZoomFont(s)),i.css(C,s),l=g._getStringWidth(a,s),c=g._getFontHeight(s),a&&(c*=a.split(/\r\n|\r|\n/).length);var T=this,A=T._getCheckBoxLeft(o,n,l,!0),I=T._getCheckBoxTop(o,n,c,!0);e.GC$(x).css("margin-left",A).css("margin-top",I),h=0,p=0,0===T._textAlign?(h=x.offsetLeft,1===o.hAlign?h=x.offsetLeft+T._checkboxSize/2-l/2:2===o.hAlign&&(h=x.offsetLeft+T._checkboxSize-l),p=x.offsetTop-c):1===T._textAlign?(h=x.offsetLeft,1===o.hAlign?h=x.offsetLeft+T._checkboxSize/2-l/2:2===o.hAlign&&(h=x.offsetLeft+T._checkboxSize-l),p=x.offsetTop+x.offsetHeight):2===T._textAlign?(h=x.offsetLeft-l-2,p=x.offsetTop+T._checkboxSize/2-c/2):(h=x.offsetLeft+x.offsetWidth+2,p=x.offsetTop+T._checkboxSize/2-c/2),e.util.browser.msie&&(h+=3,p+=3),i.css(w,h).css(v,p),T._isThreeState?(d=x.offsetLeft+(x.offsetWidth-b.offsetWidth)/2,f=x.offsetTop+(x.offsetHeight-b.offsetHeight)/2,e.GC$(b).css(w,d).css(v,f).toggle().toggle()):e.GC$(b).hide(),o.textDecoration&&T._setEditStatusTextDecoration(i,o.textDecoration)}}},o.prototype.caption=function(e){return 0===arguments.length?this._caption:(this._caption=e,this)},o.prototype.textTrue=function(e){return 0===arguments.length?this._textTrue:(this._textTrue=e,this)},o.prototype.textIndeterminate=function(e){return 0===arguments.length?this._textIndeterminate:(this._textIndeterminate=e,this)},o.prototype.textFalse=function(e){return 0===arguments.length?this._textFalse:(this._textFalse=e,this)},o.prototype._getDisplayText=function(e){return!this._isThreeState||e!==u&&e!==c?1==!!e?this._textTrue||this._caption:this._textFalse||this._caption:this._textIndeterminate||this._caption},o.prototype.textAlign=function(e){return 0===arguments.length?this._textAlign:(this._textAlign=e,this)},o.prototype.isThreeState=function(e){return 0===arguments.length?this._isThreeState:(this._isThreeState=e,this)},o.prototype.getHitInfo=function(e,t,o,n,r){if(r){var i=r.sheetArea;if(i===u||i===c||3===i)return{x:e,y:t,row:r.row,col:r.col,cellRect:n,sheetArea:i,isReservedLocation:!0,sheet:r.sheet}}return u},o.prototype.processMouseDown=function(e){if(!e)return!1;e.isReservedLocation&&(this._isMouseDownReservedLocation=!0)},o.prototype.processMouseUp=function(t){var o;if(!t)return!1;if(this,o=t.sheet,this._isMouseDownReservedLocation&&o&&t.isReservedLocation){this._isMouseDownReservedLocation=!1;var n=t.row,r=t.col,i=t.sheetArea,a=o._getModel(i).getNode(n,r,!0);if(!a._isFirstMouseUp){if(i===u||i===c||3===i){var s=o.getValue(n,r,i),l={row:n,col:r,newValue:this._getNextState(s),autoFormat:!0},h=new e.UndoRedo.CellEditUndoAction(o,l);o._doCommand(h)}return this._triggerButtonClicked(o,n,r,t.sheetArea),a._isFirstMouseUp=!0,a._mouseupToken=window.setTimeout(function(){delete a._isFirstMouseUp,a._mouseupToken&&(window.clearTimeout(a._mouseupToken),delete a._mouseupToken)},250),!0}delete a._isFirstMouseUp,a._mouseupToken&&(window.clearTimeout(a._mouseupToken),delete a._mouseupToken)}return!1},o.prototype.processMouseLeave=function(e){if(!e)return!1;this._isMouseDownReservedLocation=!1},o.prototype.isReservedKey=function(e,t){return!(32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey)},o.prototype.processKeyUp=function(t,o){var n=o.sheet;if(!n)return!1;var r=n.getActiveRowIndex(),i=n.getActiveColumnIndex(),a=n._getSheetArea(n.activeRowViewportIndex,n.activeColViewportIndex),s=n.getValue(r,i,a),l={row:r,col:i,newValue:this._getNextState(s),autoFormat:!0},u=new e.UndoRedo.CellEditUndoAction(n,l);return n._doCommand(u),this._triggerButtonClicked(n,r,i,o.sheetArea),!0},o.prototype.getAutoFitWidth=function(t,o,n,r,i){var a=e.CellTypeContext.getAutoFitWidth(t,this._getDisplayText(t),n,r,i);return 0===this._textAlign||1===this._textAlign?a=h(a,this._checkboxSize):a+=this._checkboxSize,a+5+2},o.prototype.getAutoFitHeight=function(t,o,n,r,i){var a=e.CellTypeContext.getAutoFitHeight(t,this._getDisplayText(t),n,r,i);return 0===this._textAlign||1===this._textAlign?a+=this._checkboxSize:a=h(a,this._checkboxSize),a+5},o.prototype._cancelDefaultKeydown=function(t){32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||e.util.cancelDefault(t)},o.prototype.isImeAware=function(e){return!1},o.prototype._isDefaultValue=function(e,t){switch(e){case"caption":case"textTrue":case"textIndeterminate":case"textFalse":return""===t;case"textAlign":return 3===t;case"isThreeState":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={typeName:this.typeName,caption:this.caption(),textTrue:this.textTrue(),textIndeterminate:this.textIndeterminate(),textFalse:this.textFalse(),textAlign:this.textAlign(),isThreeState:this.isThreeState()},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){if(e){e.caption&&this.caption(e.caption),e.textTrue&&this.textTrue(e.textTrue),e.textIndeterminate&&this.textIndeterminate(e.textIndeterminate),e.textFalse&&this.textFalse(e.textFalse),e.textAlign!==u&&e.textAlign!==c&&this.textAlign(e.textAlign),e.isThreeState!==u&&e.isThreeState!==c&&this.isThreeState(e.isThreeState)}},o}(e.TextCellType),e.CheckBoxCellType=t,(l=e.ButtonState||(e.ButtonState={}))[l.Normal=0]="Normal",l[l.Hover=1]="Hover",l[l.Pressed=2]="Pressed",e.ButtonState,o=function(t){function o(){t.call(this);var e=this;e.allowOverflow=!1,e.typeName="6",e._marginTop=2,e._marginRight=2,e._marginBottom=2,e._marginLeft=2,e._text="",e._buttonBackColor=u,e._buttonBorderColor="#707070",e._buttonHoverColor="#A6F4FF",e._buttonPressedColor="#34B4E3",e._buttonState=0,e._eventNameSpace=".buttonCellType"}return __extends(o,t),o.prototype.paintValue=function(e,o,n,r,i,a,s,l){var u,c,h;if(e){var p=this,d=n+p._marginLeft,f=r+p._marginTop,g=i-p._marginLeft-p._marginRight,m=a-p._marginTop-p._marginBottom;g-2>0&&m-2>0&&(d+g>n&&d<n+i&&f+m>r&&f<r+a)&&(e.save(),(d<n||d+g>n+i||f<r||f+m>r+a)&&(e.rect(n,r,i,a),e.clip()),e.beginPath(),(u=p._buttonBorderColor)&&e.strokeStyle!==u&&(e.strokeStyle=u),e.strokeRect(d+.5,f+.5,g-1,m-1),2===p._buttonState?c=p._buttonPressedColor:1===p._buttonState?c=p._buttonHoverColor:(c=p._buttonBackColor)||((h=e.createLinearGradient(n+i/2,r,n+i/2,r+a)).addColorStop(.125,"#F6FAFB"),h.addColorStop(1,"#D2DBEB"),c=h),e.fillStyle!==c&&(e.fillStyle=c),e.fillRect(d+1,f+1,g-2,m-2),e.restore(),p._text&&t.prototype.paintValue.call(this,e,p._text,d,f,g,m,s,l))}},o.prototype.focus=function(e,t){e&&e.focus()},o.prototype._formatEditorValue=function(e,t,o,n){return o},o.prototype.createEditorElement=function(t){var o,n,r=g.createElement("div"),i=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,a=e.util.getPreferredZIndex(i)+1e3,s=e.GC$(r);return s.css(m,_).css(y,"0").css(L,"0").css(k,H).css(V,b).css(B,"2px #5292f7 solid").css(z,b).css(G,"1px 2px 5px rgba(0,0,0,0.4)").css(W,"content-box").css("user-select",b).css(X,a).attr(R,1).attr(x,"gcEditingInput"),(o=e.GC$(g.createElement("div"))).css(m,_).css(k,H).css(B,"1px "+this._buttonBorderColor+" solid"),s.append(o),(n=e.GC$(g.createElement("span"))).css(m,_).css(U,"nowrap").css(C,"normal 11pt calibri").css("cursor","default"),o.append(n),r},o.prototype.setEditorValue=function(t,o,n){var r=t&&t.children[0]&&t.children[0].children[0];r&&e.GC$(r).html(this._text)},o.prototype.getEditorValue=function(e,t){return e?e._oldValue:u},o.prototype._triggerButtonClicked=function(e,t,o,n){var r=e.parent;r&&r.triggerButtonClicked({sheet:e,sheetName:e._name,row:t,col:o,sheetArea:n})},o.prototype._setButtonBackgroundColor=function(e,t){e.removeClass("gradientButton"),t?e.css(Y,t):e.addClass("gradientButton")},o.prototype.activateEditor=function(t,o,n,r){var i,a,s,l=t&&r&&r.sheet;if(l){var u=e.GC$(t),c=l._eventHandler._getCanvasPosition(),h=l.getBounds();u.css(v,c.top+h.y+n.y-2).css(w,c.left+h.x+n.x-2).css(Y,o.backColor?o.backColor:"white"),i=this,(a=t.children[0])&&(s=e.GC$(a),u.bind(A,function(t){if(!(32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey))return i._isKeyDown||i._setButtonBackgroundColor(s,i._buttonPressedColor),i._isKeyDown=!0,e.util.cancelDefault(t),!1;8!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||e.util.cancelDefault(t)}),u.bind(I,function(e){!i._isKeyDown||32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||(i._isKeyDown=!1,i._setButtonBackgroundColor(s,i._buttonBackColor),i._triggerButtonClicked(l,l._activeRowIndex,l._activeColIndex,r.sheetArea))}),s.bind(D,function(e){2!==e.button&&(i._isMouseDown=!0,i._setButtonBackgroundColor(s,i._buttonPressedColor))}),s.bind(F,function(e){2!==e.button&&(i._isMouseDown=!1,i._setButtonBackgroundColor(s,i._buttonHoverColor))}),s.bind(N,function(e){i._triggerButtonClicked(l,l._activeRowIndex,l._activeColIndex,r.sheetArea)}),s.bind(E,function(e){i._isMouseDown?i._setButtonBackgroundColor(s,i._buttonPressedColor):i._setButtonBackgroundColor(s,i._buttonHoverColor)}),s.bind(M,function(e){var t=e.relatedTarget;t!==a&&t!==a.children[0]&&i._setButtonBackgroundColor(s,i._buttonBackColor)}))}},o.prototype.updateEditor=function(t,o,n,r){var i,a,s,l,c,h,p,d,f,g,m=t&&r&&r.sheet;if(m){var _=e.GC$(t),y=m._render,S=m._eventHandler._getCanvasPosition(),x=m.getBounds();_.css(v,S.top+x.y+n.y-2).css(w,S.left+x.x+n.x-2).width(n.width).height(n.height),(i=t.children[0])&&(a=this,(s=e.GC$(i)).width(n.width-a._marginLeft-a._marginRight).height(n.height-a._marginTop-a._marginBottom).css("margin-top",a._marginTop-1).css("margin-left",a._marginLeft-1),a._setButtonBackgroundColor(s,a._buttonBackColor),(l=i.children[0])&&(c=e.GC$(l),o.foreColor&&c.css(j,o.foreColor),h=u,h=o.font?o.font:y._getDefaultFont(),m._zoomFactor>1&&(h=y._getZoomFont(h)),c.css(C,h),p=m._getStringWidth(a._text,h),d=m._getFontHeight(h),a._text&&(d*=a._text.split(/\r\n|\r|\n/).length),f=0,1===o.vAlign?f=s.height()/2-d/2:2===o.vAlign&&(f=s.height()-d),g=0,1===o.hAlign?g=s.width()/2-p/2:2===o.hAlign&&(g=s.width()-p),c.css(v,f).css(w,g),o.textDecoration&&a._setEditStatusTextDecoration(c,o.textDecoration)))}},o.prototype.marginTop=function(e){return 0===arguments.length?this._marginTop:(this._marginTop=e,this)},o.prototype.marginRight=function(e){return 0===arguments.length?this._marginRight:(this._marginRight=e,this)},o.prototype.marginBottom=function(e){return 0===arguments.length?this._marginBottom:(this._marginBottom=e,this)},o.prototype.marginLeft=function(e){return 0===arguments.length?this._marginLeft:(this._marginLeft=e,this)},o.prototype.text=function(e){return 0===arguments.length?this._text:(this._text=e,this)},o.prototype.buttonBackColor=function(e){return 0===arguments.length?this._buttonBackColor:(this._buttonBackColor=e,this)},o.prototype.buttonState=function(e){return 0===arguments.length?this._buttonState:(this._buttonState=e,this)},o.prototype.getHitInfo=function(e,t,o,n,r){var i;if(!r)return u;if(((i=r.sheetArea)===u||i===c||3===i)&&n){var a=n.x+this._marginLeft,s=n.x+n.width-this._marginRight,l=n.y+this._marginTop,h=n.y+n.height-this._marginBottom,p={x:e,y:t,row:r.row,col:r.col,cellRect:n,sheetArea:i,sheet:r.sheet};return a<=e&&e<=s&&l<=t&&t<=h&&(p.isReservedLocation=!0),p}return u},o.prototype.processMouseDown=function(e){if(!e)return!1;var t=e.sheet;return!(!t||!e.isReservedLocation||this._isMouseDownReservedLocation)&&(this._isMouseDownReservedLocation=!0,this._buttonState=2,t.repaint(e.cellRect),!0)},o.prototype.processMouseUp=function(e){var t;if(!e)return!1;if(this,t=e.sheet,this._isMouseDownReservedLocation&&t&&e.isReservedLocation){this._buttonState=0,t.repaint(e.cellRect),this._isMouseDownReservedLocation=!1;var o=e.row,n=e.col,r=e.sheetArea,i=t._getModel(r).getNode(o,n,!0);if(!i._isFirstMouseUp)return this._triggerButtonClicked(t,o,n,e.sheetArea),i._isFirstMouseUp=!0,i._mouseupToken=window.setTimeout(function(){delete i._isFirstMouseUp,i._mouseupToken&&(window.clearTimeout(i._mouseupToken),delete i._mouseupToken)},250),!0;delete i._isFirstMouseUp,i._mouseupToken&&(window.clearTimeout(i._mouseupToken),delete i._mouseupToken)}return!1},o.prototype.processMouseLeave=function(e){if(!e)return!1;var t=e.sheet;t&&this._isMouseDownReservedLocation&&(this._buttonState=0,t.repaint(e.cellRect),this._isMouseDownReservedLocation=!1)},o.prototype.processKeyDown=function(t,o){var n,r=o&&o.sheet;if(!r)return!1;if(!(n=this)._isKeyPressed){var i=r.getActiveRowIndex(),a=r.getActiveColumnIndex(),s=r.getCellRect(i,a,r.activeRowViewportIndex,r.activeColViewportIndex);return n._buttonState=2,r.repaint(s),r._bind(e.Events.SelectionChanged+n._eventNameSpace,function(t,o){r._unbind(e.Events.SelectionChanged+n._eventNameSpace),n._isKeyPressed=!1,n._buttonState=0,r.repaint(s)}),n._isKeyPressed=!0,!0}return!1},o.prototype.processKeyUp=function(t,o){var n=o.sheet;if(!n)return!1;if(this,this._isKeyPressed){var r=n.getActiveRowIndex(),i=n.getActiveColumnIndex(),a=n.getCellRect(r,i,n.activeRowViewportIndex,n.activeColViewportIndex);return this._buttonState=0,n.repaint(a),n._unbind(e.Events.SelectionChanged+this._eventNameSpace),this._triggerButtonClicked(n,r,i,o.sheetArea),this._isKeyPressed=!1,!0}return!1},o.prototype.isReservedKey=function(e,t){return!(32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey)},o.prototype.getAutoFitWidth=function(t,o,n,r,i){return e.CellTypeContext.getAutoFitWidth(t,this._text,n,r,i)+this._marginLeft+this._marginRight},o.prototype.getAutoFitHeight=function(t,o,n,r,i){return e.CellTypeContext.getAutoFitHeight(t,this._text,n,r,i)+this._marginTop+this._marginBottom},o.prototype._cancelDefaultKeydown=function(t){32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||e.util.cancelDefault(t)},o.prototype.isImeAware=function(e){return!1},o.prototype._isDefaultValue=function(e,t){switch(e){case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":return 2===t;case"text":return""===t;case"buttonBackColor":return t===u;default:return!1}},o.prototype.toJSON=function(){var e,t,o={typeName:this.typeName,marginTop:this.marginTop(),marginRight:this.marginRight(),marginBottom:this.marginBottom(),marginLeft:this.marginLeft(),text:this.text(),buttonBackColor:this.buttonBackColor()},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){if(e){e.marginTop!==u&&e.marginTop!==c&&this.marginTop(e.marginTop),e.marginRight!==u&&e.marginRight!==c&&this.marginRight(e.marginRight),e.marginBottom!==u&&e.marginBottom!==c&&this.marginBottom(e.marginBottom),e.marginLeft!==u&&e.marginLeft!==c&&this.marginLeft(e.marginLeft),e.text&&this.text(e.text),e.buttonBackColor&&this.buttonBackColor(e.buttonBackColor)}},o}(e.TextCellType),e.ButtonCellType=o,n=function(t){function o(){t.call(this);this.allowOverflow=!1,this.typeName="8",this._link="",this._linkColor="#0066cc",this._visitedLinkColor="#3399ff",this._text="",this._linkToolTip="",this._id=o._getUniqueId(),this._target=0}return __extends(o,t),o.prototype.paintValue=function(t,o,n,r,i,a,s,l){var u,c,p,g,m,_,y,C,v,x,R;if(t&&(u=this.getText(o,l))){u=u.replace(/\s+/g," ");var b=!1,T=l.sheet._getModel().getNode(l.row,l.col),A=T&&T.hyperlinkInfo;A&&(this._id===A.id?b=A.visited:delete T.hyperlinkInfo),t.save(),t.beginPath(),(c=b?this._visitedLinkColor:this._linkColor)&&t.fillStyle!==c&&(t.fillStyle=c),(p=s.font)&&t.font!==p&&(t.font=p);var I=s.hAlign,D=s.vAlign,F=t.measureText(u).width,M=l.lineHeight,E=this._calcPosition(new e.Rect(n,r,i,a),F,M,I,D),N={x:n,y:r,width:i,height:a};(E.x+F>N.width||E.y+M>N.height)&&(t.rect(N.x,N.y,N.width,N.height),t.clip(),t.beginPath()),g=2,m=w,1===I?F<i-3&&(g=i/2,m="center"):2===I&&F<i-3&&(g=i-2,m="right"),t.textAlign!==m&&(t.textAlign=m);var O=e.util.browser.mozilla?5:2,P=S,L=l.fontInfo.fontSize,H=L>8?d((L-8)/5+2):1,k=M/2-L/2+H-1;O+=M-k,1===D?M<a&&(O=e.util.browser.mozilla?a/2+1:e.util.browser.msie?a/2+.5:a/2,d(O)!==O&&(O+=.5),O+=M/2-k):2===D&&(O=a-2.5-k),t.textBaseline!==P&&(t.textBaseline=P),t.fillText(u,n+g,r+O),(_=s.textDecoration)&&this._renderTextDecoration(t,_,n+g,r+O,F,L,H),C=(y=n+E.x)+F,2===I||(y+=1,C+=1),v=r+E.y+M,2===s.vAlign&&(v-=.5),v-=h(0,f(M/9)-1),d(v)===v&&(v+=.5),x=v,t.beginPath(),R=this._linkColor,b&&(R=this._visitedLinkColor),R&&t.strokeStyle!==R&&(t.strokeStyle=R),t.lineWidth=1,t.moveTo(y,v),t.lineTo(C,x),t.stroke(),t.restore()}},o.prototype.getText=function(e,t){return this._text||e},o.prototype.createEditorElement=function(t){var o,n,r=g.createElement("div"),i=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,a=e.util.getPreferredZIndex(i)+1e3,s=e.GC$(r);switch(s.css(y,"0").css(L,"0").css(B,b).css(m,_).css(k,H).css(W,"content-box").css(U,"nowrap").css(X,a).attr(x,"gcEditor").attr(R,1).css(z,b),this._target){case 0:o="_blank";break;case 1:o="_self";break;case 2:o="_parent";break;case 3:o="_top"}return n=g.createElement("a"),e.GC$(n).css(y,"0").css(z,b).css("display","block").attr("target",o).appendTo(s),r},o.prototype._triggerButtonClicked=function(e,t,o,n){var r=e.parent;r&&(e._startEditByKeydown||r.triggerButtonClicked({sheet:e,sheetName:e._name,row:t,col:o,sheetArea:n}))},o.prototype.activateEditor=function(t,o,n,r){var i,a,s,l,c;if(t&&n){var h=r&&r.sheet,p=e.GC$(t),d=o&&o.backColor||"white";if(p.css(Y,d),h){var f=h._eventHandler._getCanvasPosition(),C=h.getBounds(),S=f.top+C.y+n.y,R=f.left+C.x+n.x;p.css(v,S).css(w,R)}p.bind("keydown",function(t){8!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||e.util.cancelDefault(t)}),i=this,(a=t.firstChild)&&(s=e.GC$(a)).bind("click",function(){if(s.css(j,i._visitedLinkColor),h){var e=h._activeRowIndex,t=h._activeColIndex;h._getModel().getNode(e,t,!0).hyperlinkInfo={id:i._id,visited:!0},i._triggerButtonClicked(h,e,t,r.sheetArea)}}),l=g.createElement("div"),e.GC$(l).css(y,"0").css(m,_).css(k,H).css(W,"content-box").attr(x,"gcEditingInput").css("border-width","1px").css("border-style","solid").css(Y,d),(c=h&&h._getHost())&&c.insertBefore(l,u),i._clip=l,i._actived=!0}},o.prototype.deactivateEditor=function(o,n){var r,i,a=n&&n.sheet;this._clip&&((r=a&&a._getHost())&&r.removeChild(this._clip)),o&&(e.GC$(o).unbind("keydown"),(i=o.firstChild)&&e.GC$(i).unbind("click")),t.prototype.deactivateEditor.call(this,o,n),this._actived=!1,a&&a.repaint()},o.prototype.updateEditor=function(t,o,n,r){var i,a,s,l,c;if(t&&n){var h=this,p=r&&r.sheet,d=p&&p._render,f=t,g=e.GC$(f),m=t.firstChild;if(m&&(i=e.GC$(m),h._link&&i.attr("href",h._link),(a=h._text||h._link)&&i.text(a),i.attr("title",h._linkToolTip),s=!1,(l=p?p._getModel().getNode(p._activeRowIndex,p._activeColIndex):u)&&l.hyperlinkInfo&&(h._id===l.hyperlinkInfo.id?s=l.hyperlinkInfo.visited:delete l.hyperlinkInfo),s?i.css(j,h._visitedLinkColor):i.css(j,h._linkColor),!(c=o&&o.font?o.font:u)&&d&&(c=d._getDefaultFont()),d&&p._zoomFactor>1&&(c=d._getZoomFont(c)),c&&i.css(C,c)),o&&p){g.css("max-width",n.width-2),g.css("max-height",n.height-2);var _=p._eventHandler._getCanvasPosition(),y=p.getBounds(),S=_.top+y.y+n.y,x=_.left+y.x+n.x,R=h._calcPosition(n,g.width(),g.height(),o.hAlign,o.vAlign);g.css(v,S+R.y).css(w,x+R.x),h._clip&&e.GC$(h._clip).css(v,S).css(w,x).height(n.height-3).width(n.width-3).css("border-color",o.backColor||"white"),o.textDecoration&&h._setEditStatusTextDecoration(g,o.textDecoration)}}},o.prototype.getEditorValue=function(e,t){return this._link},o.prototype.setEditorValue=function(e,t,o){this._link=t},o.prototype._formatEditorValue=function(e,t,o,n){return o},o.prototype.getHitInfo=function(e,t,o,n,r){if(r){var i=r.sheetArea;if((i===u||i===c||3===i)&&o&&n)return{x:e,y:t,row:r.row,col:r.col,cellStyle:o,cellRect:n,sheetArea:i,isFocusAware:!0,sheet:r.sheet}}return u},o.prototype.processMouseDown=function(e){if(e){var t=e.sheet;t&&!t.isEditing()&&(e.isReservedLocation=!!this._isHitHyperlink(e,t),e.isReservedLocation&&(this._isMouseDownLink=!0))}},o.prototype.processMouseUp=function(e){var t,o;if(e&&((t=e.sheet)&&!t.isEditing())){if(this,e.isReservedLocation=!!this._isHitHyperlink(e,t),e.isReservedLocation&&this._isMouseDownLink){if(o=t.getValue(e.row,e.col,e.sheetArea))switch(this._target){case 0:window.open(o,"_blank");break;case 1:window.open(o,"_self");break;case 2:window.open(o,"_parent");break;case 3:window.open(o,"_top")}t._getModel(e.sheetArea).getNode(e.row,e.col,!0).hyperlinkInfo={id:this._id,visited:!0},t.repaint(e.cellRect),this._triggerButtonClicked(t,e.row,e.col,e.sheetArea)}this._isMouseDownLink=!1}},o.prototype.processMouseMove=function(e){var t,o,n;e&&(t=e.sheet)&&(t.isEditing()&&t.getActiveRowIndex()===e.row&&t.getActiveColumnIndex()===e.col||(e.isReservedLocation=!!this._isHitHyperlink(e,t),e.isReservedLocation?(this._showLinkToolTip(t,e),(n=t._getCanvas())&&(o=t.getValue(e.row,e.col,e.sheetArea),n.style.cursor=o?"pointer":"text")):(this._hideLinkToolTip(t),(n=t._getCanvas())&&(n.style.cursor="default"))))},o.prototype.processMouseLeave=function(e){var t,o;this._isMouseDownLink=!1,t=e.sheet,this._hideLinkToolTip(t),t&&((o=t._getCanvas())&&(o.style.cursor="default"))},o.prototype._isHitHyperlink=function(e,t){var o,n=e.cellStyle,r=e.cellRect,i=t._render,a=e.x,s=e.y,l=this._text||this._link;if(l||(l=t.getValue(e.row,e.col,e.sheetArea)),!l)return!1;l=l.replace(/\s+/g," "),o=n&&n.font?n.font:i._getDefaultFont(),t._zoomFactor>1&&(o=i._getZoomFont(o));var u=this._getLinkRect(l,n.hAlign,n.vAlign,o,r,t),c=r.x+u.x,h=p(r.x+u.x+u.width,r.x+r.width),d=r.y+u.y,f=p(r.y+u.y+u.height,r.y+r.height);return c<=a&&a<h&&d<=s&&s<f},o.prototype._showLinkToolTip=function(t,o){var n,r,i;if(this._linkToolTip){n=this._getLinkToolTipElement(),(r=e.GC$(n)).text(this._linkToolTip);var a=t._eventHandler._getCanvasPosition(),s=a.left+o.x,l=a.top+o.y+20;0===r.parent().length()&&((i=t&&t._getHost())&&i.insertBefore(n,u),r.css(v,l).css(w,s))}},o.prototype._hideLinkToolTip=function(e){if(this._linkToolTipElement){var t=e&&e._getHost();t&&this._linkToolTipElement.parentElement===t&&t.removeChild(this._linkToolTipElement),this._linkToolTipElement=u}},o.prototype._getLinkToolTipElement=function(){if(!this._linkToolTipElement){var t=g.createElement("div");t.className="gcHyperLinkCellTypeToolTip",e.GC$(t).css(m,_).css(y,"0").css(L,2).css(B,"1px #c0c0c0 solid").css(G,"1px 2px 5px rgba(0,0,0,0.4)").css(W,"content-box").css(Y,"#ffffff").css(C,"9pt Arial"),this._linkToolTipElement=t}return this._linkToolTipElement},o.prototype._getLinkRect=function(t,n,r,i,a,s){var l,u,c=o._getEditorElement(s),h=e.GC$(c),p=c.firstChild;p&&((l=e.GC$(p)).text(t||""),i&&l.css(C,i));var d=h.width(),f=h.height(),g={x:0,y:0,width:d,height:f};return a&&(u=this._calcPosition(a,d,f,n,r),g.x=u.x,g.y=u.y),g},o.prototype._calcPosition=function(e,t,o,n,r){var i=1,a=1,s=e.width-3,l=e.height-3;return 1===n?i+=h(0,(s-t)/2):2===n&&(i+=h(0,s-t)),1===r?a+=h(0,(l-o)/2):2===r&&(a+=h(0,l-o)),{x:i,y:a}},o.prototype.isReservedKey=function(e,t){return!(32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey)},o.prototype.processKeyUp=function(e,t){var o=t.sheet;if(!o)return!1;var n=o.getActiveRowIndex(),r=o.getActiveColumnIndex(),i=o._getSheetArea(o.activeRowViewportIndex,o.activeColViewportIndex),a=o.getValue(n,r,i),s=o.getCellRect(n,r,o.activeRowViewportIndex,o.activeColViewportIndex);if(a)switch(a=a.toString(),this._target){case 0:window.open(a,"_blank");break;case 1:window.open(a,"_self");break;case 2:window.open(a,"_parent");break;case 3:window.open(a,"_top")}return o._getModel(i).getNode(n,r,!0).hyperlinkInfo={id:this._id,visited:!0},o.repaint(s),this._triggerButtonClicked(o,n,r,t.sheetArea),!0},o.prototype.linkColor=function(e){return 0===arguments.length?this._linkColor:(this._linkColor=e,this)},o.prototype.visitedLinkColor=function(e){return 0===arguments.length?this._visitedLinkColor:(this._visitedLinkColor=e,this)},o.prototype.text=function(e){return 0===arguments.length?this._text:(this._text=e,this)},o.prototype.linkToolTip=function(e){return 0===arguments.length?this._linkToolTip:(this._linkToolTip=e,this)},o.prototype.target=function(e){return 0===arguments.length?this._target:(this._target=e,this)},o.prototype.getAutoFitWidth=function(e,t,o,n,r){var i=r&&r.sheet;if(i){var a=i._render,s=this._text||e,l=o&&o.font?o.font:a._getZoomFont(a._getDefaultFont());return this._getLinkRect(s,o.hAlign,o.vAlign,l,null,i).width}return 0},o.prototype.getAutoFitHeight=function(e,t,o,n,r){var i=r&&r.sheet;if(i){var a=this._text||e,s=i._render,l=o&&o.font?o.font:s._getDefaultFont();return n>1&&(l=s._getZoomFont(l)),this._getLinkRect(a,o.hAlign,o.vAlign,l,null,i).height}return 0},o.prototype.isImeAware=function(e){return!1},o.prototype._isDefaultValue=function(e,t){switch(e){case"linkColor":return"#0066cc"===t;case"visitedLinkColor":return"#3399ff"===t;case"text":case"linkToolTip":return""===t;case"target":return 0===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={typeName:this.typeName,linkColor:this._linkColor,visitedLinkColor:this._visitedLinkColor,text:this._text,linkToolTip:this._linkToolTip,target:this._target},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){if(e){e.linkColor!==c&&e.linkColor!==u&&(this._linkColor=e.linkColor),e.visitedLinkColor!==c&&e.visitedLinkColor!==u&&(this._visitedLinkColor=e.visitedLinkColor),e.text!==c&&e.text!==u&&(this._text=e.text),e.linkToolTip!==c&&e.linkToolTip!==u&&(this._linkToolTip=e.linkToolTip),e.target!==c&&e.target!==u&&(this._target=e.target)}},o._getUniqueId=function(){return(this._id===c||this._id===u)&&(this._id=0),"id_"+this._id++},o._getEditorElement=function(e){var t,n;return this._editorElement||(n=(t=o.prototype.createEditorElement({sheet:e})).style,g.body.insertBefore(t,u),n.visibility=H,n.top="-10000px",n.left="-10000px",t.className="gcHyperLinkCellTypeEditor",this._editorElement=t),this._editorElement},o}(e.TextCellType),e.HyperLinkCellType=n,r=function(t){function o(){t.call(this),this.typeName=""}return __extends(o,t),o.prototype.paint=function(t,o,n,r,i,a,s,l){var u,h,p,d,f,g,m;t&&(e.CellTypeContext.paintBackground(t,n,r,i,a,s.backColor,s.backgroundImage,s.backgroundImageLayout,l.imageLoader),(2===(u=l.sheetArea)||1===u)&&(h=0,l.visualState!==c&&(h=l.visualState),p="columnHeader",2===u&&(p="rowHeader"),d=this.getThemeStyle(l.visualState,"gc-"+p+"-"+e.VisualState[h].toLowerCase()),e.HeaderCellType.prototype._paintGridline(t,n,r,i,a,s,p,d,u)),f=e.CellTypeContext.paintConditionalFormats(t,o,n,r,i,a,s,l),l.showBarIconOnly=f,e.CellTypeContext.paintSparkline(t,n,r,i,a,l.sparkline),g=e.CellTypeContext.paintSparklineEx(t,o,n,r,i,a,l.sheet),l.cellOverflowLayout||f||g||(m=new e.Rect(n,r,i,a),e.CellTypeContext.adjustRectForIconSet(s.hAlign,l.sheet,l.row,l.col,l.sheetArea,m),this.paintValue(t,o,m.x,m.y,m.width,m.height,s,l)))},o.prototype.createEditorElement=function(e){},o.prototype.getEditorValue=function(e,t){},o.prototype.setEditorValue=function(e,t,o){},o.prototype.activateEditor=function(t,o,n,r){var i,a=t&&r&&r.sheet;if(a){i=a._eventHandler,this.isImeAware(r)&&i._resetFocusHolder();var s=i._getCanvasPosition(),l=a.getBounds(),u=s.top+l.y+n.y-2,c=s.left+l.x+n.x-2;e.GC$(t).css("top",u).css("left",c)}},o.prototype.deactivateEditor=function(e,t){var o,n;e&&((o=e._editingLocator)&&((n=t&&t.sheet&&t.sheet._getHost())&&n.removeChild(o)))},o.prototype.updateEditor=function(t,o,n,r){t&&e.GC$(t).width(n.width).height(n.height)},o.prototype.updateImeMode=function(e,o,n){t.prototype.updateImeMode.call(this,e,o,n)},o.prototype.getHitInfo=function(e,t,o,n,r){return null},o.prototype.processMouseDown=function(e){},o.prototype.processMouseMove=function(e){},o.prototype.processMouseUp=function(e){},o.prototype.processMouseEnter=function(e){},o.prototype.processMouseLeave=function(e){},o.prototype.isReservedKey=function(e,t){return!1},o.prototype.processKeyDown=function(e,t){return!1},o.prototype.processKeyUp=function(e,t){return!1},o.prototype.isEditingValueChanged=function(e,t,o){return e!==t},o.prototype.getAutoFitWidth=function(t,o,n,r,i){return e.CellTypeContext.getAutoFitWidth(t,o,n,r,i)},o.prototype.getAutoFitHeight=function(t,o,n,r,i){return e.CellTypeContext.getAutoFitHeight(t,o,n,r,i)},o.prototype.isImeAware=function(e){return!1},o.prototype.toJSON=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},o.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==c&&(this[t]=e[t])},o}(e.BaseCellType),e.CustomCellType=r;var K=17,J=20,Z=1,q=function(t){function o(){t.call(this);this.typeName="7",this._editorValueType=0,this._items=[],this._itemHeight=22,this._maxDropDownItems=J,this._editable=!1,this._autoFormatValue=!1,this._hasInPlaceEditor=!1}return __extends(o,t),o.prototype.editorValueType=function(e){return 0===arguments.length?this._editorValueType:(this._editorValueType=e,this)},o.prototype.items=function(e){return 0===arguments.length?this._items:(this._items=e,this)},o.prototype.itemHeight=function(e){return 0===arguments.length?this._itemHeight:(this._itemHeight=e,this)},o.prototype.maxDropDownItems=function(e){return 0===arguments.length?this._maxDropDownItems:(this._maxDropDownItems=e,this)},o.prototype.editable=function(e){return 0===arguments.length?this._editable:(this._editable=e,this)},o.prototype.isReservedKey=function(e,t){return!!this._hasInPlaceEditor},o.prototype.paint=function(t,o,n,r,i,a,s,l){var u,c,h;t&&(e.CellTypeContext.paintBackground(t,n,r,i,a,s.backColor,s.backgroundImage,s.backgroundImageLayout,l.imageLoader),u=e.CellTypeContext.paintConditionalFormats(t,o,n,r,i,a,s,l),l.showBarIconOnly=u,e.CellTypeContext.paintSparkline(t,n,r,i,a,l.sparkline),c=e.CellTypeContext.paintSparklineEx(t,o,n,r,i,a,l.sheet),l.cellOverflowLayout||u||c||(h=new e.Rect(n,r,i,a),e.CellTypeContext.adjustRectForIconSet(s.hAlign,l.sheet,l.row,l.col,l.sheetArea,h),this.paintValue(t,o,h.x,h.y,h.width,h.height,s,l)))},o.prototype.paintValue=function(e,o,n,r,i,a,s,l){var u=K,c=h(0,i-u-1);3===s.hAlign&&(s.hAlign=0),s.wordWrap&&(s.wordWrap=!1),c>0&&a>0&&t.prototype.paintValue.call(this,e,this.getText(o,l),n,r,c,a,s,l),e.save(),(u>i||u>a)&&(e.rect(n,r,i,a),e.clip()),e.beginPath(),e.beginPath(),e.lineWidth=2,e.fillStyle="#000000",e.moveTo(n+i-u+4,r+(a-2)/2-2.5),e.lineTo(n+i-u+7,r+(a-2)/2+3.5),e.lineTo(n+i-u+10,r+(a-2)/2-2.5),e.fill(),e.restore()},o.prototype.getText=function(e,t){return e},o.prototype.createEditorElement=function(t){var o,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,r=e.util.getPreferredZIndex(n)+1e3,i=t.sheet.defaults,a=new ee(0,0,i.colWidth,i.rowHeight,r);return a.editorValueType(this._editorValueType),a.items(this._items),a.itemHeight(this._itemHeight),a.maxDropDownItems(this._maxDropDownItems),a.editable(this._editable),o=a.getComboBox(),Object.defineProperty(o,"comboBox",{value:a,writable:!1}),o},o.prototype.getEditorValue=function(e,t){var o=e.comboBox;return o&&(this._autoFormatValue=!o._isEditorValueInItems),o&&o.editorValue()},o.prototype.setEditorValue=function(e,t,o){var n=e.comboBox;n&&n.editorValue(t)},o.prototype.focus=function(e,t){if(e){var o=e.comboBox;o&&o.focus()}},o.prototype.selectAll=function(e,t){if(e){var o=e.comboBox;o&&o.selectAll()}},o.prototype.activateEditor=function(t,o,n,r){var i=r.sheet,a=(r.row,r.col,t.comboBox);a&&(a.editorValueType(this._editorValueType),a.items(this._items),a.itemHeight(this._itemHeight),a.maxDropDownItems(this._maxDropDownItems),a.editable(this._editable),a._dropDownList.bind(Q,function(t,o){var n,r=i._getKeyAction(o.keyCode,!1,!1,!1,!1);r?(((n=r.action)===e.SpreadActions.navigationLeft||n===e.SpreadActions.navigationRight)&&(i._editorStatus=1),n.apply(i)):!0===o.isMouse&&!0===a._isDisplayMode&&i.endEdit()}),a._comboBoxEditor.bind(Q,function(e,t){!0===t.isMouse&&i.endEdit()}),a._dropDownButton.bind(Q,function(e,t){!0===t.isMouse&&i.endEdit()})),this._hasInPlaceEditor=!0},o.prototype.deactivateEditor=function(e,t){var o,n,r;if(e&&(o=e.comboBox)){var i=o._dropDownList,a=o._comboBoxEditor,s=o._dropDownButton;i.unbind(Q),a.unbind(Q),s.unbind(Q),o.closeDropDownList(),o._isDisplayMode=!1,(n=e._editingLocator)&&((r=t&&t.sheet&&t.sheet._getHost())&&r.removeChild(n))}this._hasInPlaceEditor=!1},o.prototype.updateEditor=function(e,t,o,n){var r,i,a,s,l=e&&n&&n.sheet;l&&(r=e.comboBox,t&&r&&(i=l._render,r.updateStyle(t.backColor,t.foreColor,i._getZoomFont(t.font||i._getDefaultFont()))),o&&r&&(a=l._eventHandler._getCanvasPosition(),s=l.getBounds(),r.updateLocationAndSize(a.left+s.x+o.x-1,a.top+s.y+o.y-1,o.width+1,o.height+1)))},o.prototype.updateImeMode=function(e,t,o){if(this.isImeAware()){var n=e.comboBox,r=n&&n._comboBoxEditor;r&&r.updateImeMode(this._getImeModeString(t))}},o.prototype.format=function(e,o,n,r){var i,a,s,l;if(e===u||e===c)return"";var h=this._editorValueType,p=this._items;if(p&&(i=p.length,0!==h))if(1===h)0<=(a=parseInt(e))&&a<i&&((l=p[a])!==c&&l!==u&&(e=l.hasOwnProperty("text")?l.text:l));else if(2===h)for(s=0;s<i;s++)if((l=p[s])&&l.hasOwnProperty("value")&&l.value===e){e=l.text;break}return t.prototype.format.call(this,e,o,n)},o.prototype.parse=function(e,o,n){var r,i,a,s=this._editorValueType,l=this._items,u=t.prototype.parse.call(this,e,o);if(l){if(r=l.length,0===s)return u;if(1===s){for(i=0;i<r;i++)if((a=l[i])&&a.hasOwnProperty("text")&&a.text===u||a===u)return i}else if(2===s)for(i=0;i<r;i++)if((a=l[i])&&a.hasOwnProperty("text")&&a.text===u)return a.value}return u},o.prototype.getHitInfo=function(e,t,o,n,r){var i,a,s,l;return r?(i=r.sheetArea,a=r.sheet,i!==u&&i!==c&&3!==i||!n?u:(s=n.x+n.width,l={x:e,y:t,row:r.row,col:r.col,cellStyle:o,cellRect:n,sheetArea:i,sheet:a},s-K<=e&&e<s&&(l.isReservedLocation=!0),l)):u},o.prototype.processMouseDown=function(t){var o,n,r=t.sheet,i=t.sheetArea;(i===u||i===c||3===i)&&t.isReservedLocation&&r&&(r.startEdit(),(n=(o=r._editor)&&o.comboBox)&&(e.util.browser&&e.util.browser.mozilla&&(n._dropDownButton._showTime=(new Date).valueOf()),n.showDropDownList(),n._isDisplayMode=!0))},o.prototype.getAutoFitWidth=function(t,o,n,r,i){return e.CellTypeContext.getAutoFitWidth(t,o,n,r,i)+K},o.prototype.getAutoFitHeight=function(t,o,n,r,i){return e.CellTypeContext.getAutoFitHeight(t,o,n,r,i)},o.prototype.isImeAware=function(e){return!0},o.prototype._isDefaultValue=function(e,t){switch(e){case"editorValueType":return 0===t;case"items":return t===[];case"itemHeight":return 22===t;case"editable":return!1===t;default:return!1}},o.prototype.toJSON=function(){var e,t,o={typeName:this.typeName,editorValueType:this.editorValueType(),items:this.items(),itemHeight:this.itemHeight(),maxDropDownItems:this.maxDropDownItems(),editable:this.editable()},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},o.prototype.fromJSON=function(e,t){e&&(e.editorValueType!==u&&e.editorValueType!==c&&this.editorValueType(e.editorValueType),e.items!==u&&e.items!==c&&this.items(e.items),e.itemHeight!==u&&e.itemHeight!==c&&this.itemHeight(e.itemHeight),e.maxDropDownItems!==u&&e.maxDropDownItems!==c&&this.maxDropDownItems(e.maxDropDownItems),e.editable!==u&&e.editable!==c&&this.editable(e.editable))},o}(e.BaseCellType);e.ComboBoxCellType=q;var $="keydown",Q="EndEdit"+T,ee=function(){function t(t,o,n,r,i){var a,s,l=this;l._DOMObject=g.createElement("div"),l._DOMObject.className="gcComboBox",l._bindEvent(),l._setDefaultCSS(i),e.GC$(l._DOMObject).css(w,t).css(v,o).css(O,n).css(P,r),a=h(0,n-K),l._comboBoxEditor=new te(this,0,0,a,r),l._comboBoxEditor.appendTo(this._DOMObject),l._dropDownButton=new oe(this,a,0,n-a,r),l._dropDownButton.appendTo(this._DOMObject),(s=new ne(0,r-2*Z,n-2*Z,r,i)).bind(s.CloseDropDown,function(){l._comboBoxEditor.focus()}),s.bind(s.ShowDropDown,function(){l._comboBoxEditor.focus()}),s.bind(s.SelectedIndexChanged,function(e){l.onSelectedIndexChanged(e)}),s.appendTo(this._DOMObject),l._dropDownList=s,l._editorValueType=0,l._items=[]}return t.prototype._bindEvent=function(){var t=this;e.GC$(this._DOMObject).bind($,function(e){t._onKeydown.call(t,e)})},t.prototype._onKeydown=function(e){this._dropDownList&&this._dropDownList._onKeydown(e)},t.prototype._setDefaultCSS=function(t){e.GC$(this._DOMObject).css(m,_).css(X,t||0).attr(x,"gcComboBox")},t.prototype.getComboBox=function(){return this._DOMObject},t.prototype.updateLocationAndSize=function(t,o,n,r){var i,a;e.GC$(this._DOMObject).css(w,t).css(v,o).css(O,n).css(P,r),i=h(0,n-K),this._comboBoxEditor.updateLocationAndSize(0,0,i,r),this._dropDownButton.updateLocationAndSize(i,0,n-i,r),(a=this._dropDownList).updateLocation(0,r-2*Z),a.width(n-2*Z),a._updateItemWidth()},t.prototype.updateStyle=function(e,t,o){this._comboBoxEditor.updateStyle(e,t,o),this._dropDownButton.updateStyle(e,t,o),this._dropDownList.updateStyle(e,t,o)},t.prototype.isDropDownListShown=function(){return this._dropDownList.isShown()},t.prototype.showDropDownList=function(){this._dropDownList.show()},t.prototype.closeDropDownList=function(){this._dropDownList.close()},t.prototype.toggleDropDownListShow=function(){this._dropDownList.toggleShow()},t.prototype.items=function(e){return 0===arguments.length?this._items:(this._items=e,this._dropDownList.items(e),this)},t.prototype.itemHeight=function(e){return 0===arguments.length?this._dropDownList.itemHeight():(this._dropDownList.itemHeight(e),this)},t.prototype.maxDropDownItems=function(e){return 0===arguments.length?this._dropDownList.itemCountPerPage():(this._dropDownList.itemCountPerPage(e),this)},t.prototype.editable=function(e){return 0===arguments.length?this._comboBoxEditor.editable():(this._comboBoxEditor.editable(e),this)},t.prototype.editorValueType=function(e){return 0===arguments.length?this._editorValueType:(this._editorValueType=e,this)},t.prototype.editorValue=function(e){return 0===arguments.length?this._editorValue:(e!==this._editorValue&&(this._editorValue=e,this._updateEditorValue(e)),this)},t.prototype._updateEditorValue=function(e){var t=this.valueToText(e);this._comboBoxEditor.text(t),this._dropDownList.selectByText(t)},t.prototype.valueToText=function(e){var t,o,n,r,i=this._items,a=i.length,s=this._editorValueType;switch(this._isEditorValueInItems=!0,s){case 1:(t=(r=i[e])&&r.hasOwnProperty("text")?r.text:r)===c&&(t=e,this._isEditorValueInItems=!1);break;case 0:for(t=e,o=0;o<a&&!((r=i[o])&&r.hasOwnProperty("text")&&r.text===e||r===e);o++);o>=a&&(this._isEditorValueInItems=!1);break;case 2:for(n=0;n<a;n++)if((r=i[n])&&r.hasOwnProperty("value")&&r.value===e){t=r.text;break}n>=a&&(t=e,this._isEditorValueInItems=!1)}return(e===u||e===c)&&(t=""),t},t.prototype.textToValue=function(e){var t,o,n,r=this._items,i=r.length,a=this._editorValueType,s=e;if(0!==a)if(1===a)for(t=0;t<i;t++)((n=r[t])&&n.hasOwnProperty("text")&&n.text===e||n===e)&&(s=t);else if(2===a)for(o=0;o<i;o++)(n=r[o])&&n.hasOwnProperty("text")&&n.text===e?s=n.value:n===e&&(s=c);return s},t.prototype.onSelectedIndexChanged=function(e){var t=this._dropDownList,o=t.selectedIndex(),n=t.getSelectedValue(o,this._items,this._editorValueType);n!==u&&n!==c&&this.editorValue(n)},t.prototype.autoSelectByText=function(e){var t,o,n,r;if(e){for(n=(o=this._items).length,t=0;t<n&&((r=o[t]).hasOwnProperty("text")&&(r=r.text),r.toString().substr(0,e.length)!==e);t++);t>=n&&(t=-1)}else t=-1;this._dropDownList.setSelectedIndexInternal(t)},t.prototype.focus=function(){this._comboBoxEditor.focus()},t.prototype.selectAll=function(){this._comboBoxEditor.selectAll()},t}(),te=function(){function t(e,t,o,n,r){var i=this;i._comboBox=e,i._editable=!1,i._divObject=g.createElement("div"),i._textareaObject=g.createElement("textarea"),i._DOMObject=i._divObject,i._DOMObject.className="gcComboBoxEditor",i._setDefaultCSS(),i._bindEvent(),i.updateLocationAndSize(t,o,n,r)}return t.prototype._setDefaultCSS=function(){var t=Z+"px solid black";e.GC$(this._DOMObject).css(y,0).css(k,"hidden").css(V,b).css(m,_).css("border-bottom",t).css("border-left",t).css("border-top",t).css(L,"2px 0px 0px 4px").css(z,b).css(Y,"white").css(U,"nowrap").css(W,"content-box").attr(x,"gcComboBoxEditor").attr(R,-1)},t.prototype._bindEvent=function(){var t=this;e.GC$(this._textareaObject).bind("keyup",function(e){var o,n=t._DOMObject.value;t._text=n,o=t._comboBox.textToValue(n),t._comboBox.editorValue(o),t._comboBox.autoSelectByText(n),t._removeTip()}).bind("mouseover",function(){t._updateTip()}).bind("mouseout",function(){t._removeTip()}),e.GC$(this._divObject).bind("click",function(e){t._comboBox._isDisplayMode?t._trigger(Q,{isMouse:!0}):t._comboBox.toggleDropDownListShow()}).bind("mouseover",function(){t._updateTip()}).bind("mouseout",function(){t._removeTip()})},t.prototype._removeTip=function(){e.GC$(this._DOMObject).removeAttr("title")},t.prototype._updateTip=function(){if(this._comboBox&&this._comboBox._dropDownList){var t=this._comboBox._dropDownList.measureText(this._text),o=e.GC$(this._DOMObject);t>o.width()+4?o.attr("title",this._text):o.removeAttr("title")}},t.prototype.updateLocationAndSize=function(t,o,n,r){n-=Z,r-=2*Z,e.GC$(this._DOMObject).css(w,t).css(v,o).css(O,n-4).css(P,r-2)},t.prototype._getLocationAndSize=function(){var t=e.GC$(this._DOMObject);return{left:parseInt(t.css(w)),top:parseInt(t.css(v)),width:parseInt(t.css(O)),height:parseInt(t.css(P))}},t.prototype._getStyle=function(){var t=e.GC$(this._DOMObject);return{backColor:t.css(Y),foreColor:t.css(j),font:t.css(C)}},t.prototype.updateStyle=function(t,o,n){e.GC$(this._DOMObject).css(Y,t).css(j,o).css(C,n)},t.prototype.appendTo=function(e){e.appendChild(this._DOMObject)},t.prototype.editable=function(e){return 0===arguments.length?this._editable:this._editable!==e?(this._editable=e,this._changeEditor(e),this):void 0},t.prototype._changeEditor=function(t){var o=this,n=o._comboBox.getComboBox(),r=o._getLocationAndSize(),i=o._getStyle();n.removeChild(o._DOMObject),o._DOMObject=t?o._textareaObject:o._divObject,e.GC$(o._DOMObject).appendTo(n),o._setDefaultCSS(),o.updateStyle(i.backColor,i.foreColor,i.font),o.updateLocationAndSize(r.left,r.top,r.width,r.height)},t.prototype.text=function(e){if(0===arguments.length)return this._text;e!==this._text&&(this._text=e,"DIV"===this._DOMObject.tagName.toUpperCase()?this._DOMObject.textContent=e:this._DOMObject.value=e)},t.prototype.focus=function(){var e=this._DOMObject;e.focus(),"TEXTAREA"===e.tagName.toUpperCase()&&(e.selectionStart=e.value.length)},t.prototype.updateImeMode=function(t){e.GC$(this._DOMObject).css("ime-mode",t)},t.prototype.selectAll=function(){var e=this._DOMObject;"TEXTAREA"===e.tagName.toUpperCase()&&e.select()},t.prototype.bind=function(t,o,n){e.GC$(this._DOMObject).bind(t,o,n)},t.prototype.unbind=function(t,o){e.GC$(this._DOMObject).unbind(t,o)},t.prototype._trigger=function(t,o){e.GC$(this._DOMObject).trigger(t,o)},t}(),oe=function(){function t(e,t,o,n,r){this._comboBox=e,this._DOMObject=g.createElement("div"),this._DOMObject.className="gcDropDownButton",this._setDefaultCSS(),this._bindEvent();var i=g.createElement("canvas");i.className="gcDropDownButtonIcon",this._canvas=i,this.updateLocationAndSize(t,o,n,r),this._DOMObject.appendChild(i)}return t.prototype._setDefaultCSS=function(){var t=Z+"px solid black";e.GC$(this._DOMObject).css("border-top",t).css("border-right",t).css("border-bottom",t).css(m,_).css(Y,"white").css(W,"content-box").attr(x,"gcDropDownButton")},t.prototype._bindEvent=function(){var t=this;e.GC$(this._DOMObject).bind("click",function(e){var o;t._showTime!==c&&(o=t._showTime,t._showTime=c,(new Date).valueOf()-o<100)||(t._comboBox._isDisplayMode?t._trigger(Q,{isMouse:!0}):t._comboBox.toggleDropDownListShow())})},t.prototype._paintIcon=function(){var e=this._canvas;if(e){var t=e.width,o=e.height,n=e.getContext("2d");n.beginPath(),n.lineWidth=2,n.fillStyle="#000000",n.moveTo(t-K+4,(o-2)/2-2.5),n.lineTo(t-K+7,(o-2)/2+3.5),n.lineTo(t-K+10,(o-2)/2-2.5),n.fill()}},t.prototype.updateLocationAndSize=function(t,o,n,r){n-=Z,r-=2*Z,e.GC$(this._DOMObject).css(w,t).css(v,o).css(O,n).css(P,r),e.GC$(this._canvas).attr(O,n).attr(P,r),this._paintIcon()},t.prototype.updateStyle=function(t,o,n){e.GC$(this._DOMObject).css(Y,t).css(j,o).css(C,n)},t.prototype.appendTo=function(e){e.appendChild(this._DOMObject)},t.prototype.bind=function(t,o,n){e.GC$(this._DOMObject).bind(t,o,n)},t.prototype.unbind=function(t,o){e.GC$(this._DOMObject).unbind(t,o)},t.prototype._trigger=function(t,o){e.GC$(this._DOMObject).trigger(t,o)},t}(),ne=function(t){function o(o,n,r,i,a){t.call(this,o,n,r,i,a),this._itemCount=0,this.SCROLLBAR_SIZE=18,this.HOVER_COLOR="lightgrey",this.SELECTED_COLOR="#1E90FF",this.ShowDropDown="ShowDropDown"+T,this.CloseDropDown="CloseDropDown"+T,this.SelectedIndexChanged="SelectedIndexChanged"+T,this._DOMObject.className="gcDropDownList",this._divList=g.createElement("div"),this._divList.className="gcDivList",this._DOMObject.appendChild(this._divList),this._scrollablePanel=new e.ScrollablePanel(this._DOMObject,this._divList),this._itemHeight=22,this._itemCountPerPage=J,this._selectedIndex=-1}return __extends(o,t),o.prototype._show=function(){t.prototype._show.call(this),this._bindEvent(),this._isNeedVScrollbar=!1,this._updateItemHeight(),this._updateItemWidth(),this._isNeedVScrollbar&&(this._scrollablePanel.verticalSmallChange(e.GC$(this._divList.children).height()),this._scrollablePanel.refreshLayout(!1)),this._addSelectedEffect(),this._trigger(this.ShowDropDown,{})},o.prototype._close=function(){this._unbindEvent(),this._removeSelectedEffect(),t.prototype._close.call(this),this._trigger(this.CloseDropDown,{})},o.prototype.items=function(e){return 0===arguments.length?this._items:e?(this._items=e,this._updateItems(),this):void 0},o.prototype._updateItems=function(){this._removeDivListItems(),this._addAllItems()},o.prototype._appendMeasureSpanToBody=function(){this._measureSpan=g.createElement("span"),e.GC$(this._measureSpan).css("display","none").css(C,this.font()),g.body.appendChild(this._measureSpan)},o.prototype._removeMeasureSpanFromBody=function(){g.body.removeChild(this._measureSpan)},o.prototype._measureTextWidth=function(t){return this._measureSpan.textContent=t,e.GC$(this._measureSpan).width()+2+4},o.prototype._measureTextHeight=function(t){return this._measureSpan.textContent=t,e.GC$(this._measureSpan).height()},o.prototype._addAllItems=function(){var e,t,o,n=this._items;if(n)for(e=0,t=n.length;e<t;e++)o=n[e],this._addItem(o.hasOwnProperty("text")?o.text:o)},o.prototype._addItem=function(t){var o,n,r="gcItem"+this._itemCount,i=g.createElement("div");i.className=r,(o=g.createElement("span")).textContent=t.toString(),o.style.paddingLeft="4px",i.appendChild(o),this._divList.appendChild(i),this._itemCount++,n=this,e.GC$(i).bind("click",function(e){n._onMouseClickItem(this,e)}).bind("mouseover",function(e){n._onMouseEnterItem(this,e)}).bind("mouseout",function(e){n._onMouseLeaveItem(this,e)})},o.prototype._onMouseClickItem=function(t,o){var n=e.GC$(t).index();this.selectedIndex(n),this.close(),this._trigger(Q,{isMouse:!0})},o.prototype._onMouseEnterItem=function(t,o){var n=e.GC$(t);t.oldBackColor=n.css(Y),n.css(Y,this.HOVER_COLOR)},o.prototype._onMouseLeaveItem=function(t,o){e.GC$(t).css(Y,t.oldBackColor||"")},o.prototype._addSelectedEffect=function(){var t=this._selectedIndex;0<=t&&t<this._itemCount&&(e.GC$(this._divList.children[t]).css(Y,this.SELECTED_COLOR),this.scrollToIndex(t))},o.prototype._removeSelectedEffect=function(){var t=this._selectedIndex;0<=t&&t<this._itemCount&&e.GC$(this._divList.children[t]).css(Y,"")},o.prototype._bindEvent=function(){var t=this;e.GC$(this._DOMObject).bind($,function(e){t._onKeydown.call(t,e)})},o.prototype._unbindEvent=function(){e.GC$(this._DOMObject).unbind($)},o.prototype._onKeydown=function(e){this._navigation(e)},o.prototype._navigation=function(t){if(!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)){var o=this.isShown(),n=this._itemCount,r=this._selectedIndex,i=0;switch(t.which){case 38:r>=0&&r<n&&(i=r-1),i>=0&&i<n&&this.selectedIndex(i),o&&this.scrollToIndex(i),e.util.cancelDefault(t);break;case 40:r>=0&&r<n&&(i=r+1),i>=0&&i<n&&this.selectedIndex(i),o&&this.scrollToIndex(i),e.util.cancelDefault(t);break;case 13:this.selectedIndex(this._selectedIndex),this.close(),this._trigger(Q,{keyCode:t.keyCode}),e.util.cancelDefault(t);break;case 27:this.close(),this._trigger(Q,{keyCode:t.keyCode}),e.util.cancelDefault(t);break;case 37:case 39:case 9:this.selectedIndex(this._selectedIndex),this.close(),this._trigger(Q,{keyCode:t.keyCode}),e.util.cancelDefault(t)}}},o.prototype._removeDivListItems=function(){for(;this._divList.firstChild;)this._divList.removeChild(this._divList.firstChild);this._itemCount=0},o.prototype.getSelectedValue=function(e,t,o){var n,r=t[e];if(r!==u&&r!==c)switch(o){case 1:n=e;break;case 0:n=r.hasOwnProperty("text")?r.text:r;break;case 2:r.hasOwnProperty("value")&&(n=r.value)}return n},o.prototype.setSelectedIndexInternal=function(e){this._removeSelectedEffect(),this._selectedIndex=e,this._addSelectedEffect()},o.prototype.selectedIndex=function(e){if(0===arguments.length)return this._selectedIndex;0<=e&&e<this._itemCount&&(this.setSelectedIndexInternal(e),this._trigger(this.SelectedIndexChanged,{}))},o.prototype.selectByText=function(e){var t,o,n=this._items;if(n){for(t=0;t<n.length&&((o=n[t]).hasOwnProperty("text")&&(o=o.text),e!==o);t++);this.setSelectedIndexInternal(t)}},o.prototype.itemCountPerPage=function(e){if(0===arguments.length)return this._itemCountPerPage;e>0&&(this._itemCountPerPage=e)},o.prototype._recalcHeight=function(e,t){var o,n=this._itemCount;n<=t?o=n*e:(o=t*e,this._isNeedVScrollbar=!0),this.height(o)},o.prototype.measureText=function(e){this._appendMeasureSpanToBody();var t=this._measureTextWidth(e);return this._removeMeasureSpanFromBody(),t},o.prototype.getLongestItemWidth=function(){var e,t,o,n,r,i;if(this._appendMeasureSpanToBody(),e=0,o=this._items)for(n=0,r=o.length;n<r;n++)i=o[n],(t=this._measureTextWidth(i.hasOwnProperty("text")?i.text:i))>e&&(e=t);return this._removeMeasureSpanFromBody(),e},o.prototype._updateWidth=function(){t.prototype._updateWidth.call(this),this._scrollablePanel.refreshLayout(!1)},o.prototype._updateHeight=function(){t.prototype._updateHeight.call(this),this._scrollablePanel.refreshLayout(!1)},o.prototype.itemHeight=function(e){if(0===arguments.length)return this._itemHeight;e>0&&(this._itemHeight=e)},o.prototype._updateItemHeight=function(){var t,o;this._appendMeasureSpanToBody(),((t=this._items[0])===u||t===c)&&(t=""),o=h(this._itemHeight,this._measureTextHeight(t)),e.GC$(this._divList.children).css(P,o),this._recalcHeight(o,this._itemCountPerPage),this._removeMeasureSpanFromBody()},o.prototype._updateItemWidth=function(){var e=this.getLongestItemWidth(),t=this.SCROLLBAR_SIZE;this.width()<e+t&&this.width(e+t)},o.prototype.scrollToIndex=function(e){if(e>=0&&e<this._itemCount){var t=this._divList.childNodes[e];this._scrollablePanel.scrollChildIntoView(t)}},o.prototype.bind=function(t,o,n){e.GC$(this._DOMObject).bind(t,o,n)},o.prototype.unbind=function(t,o){e.GC$(this._DOMObject).unbind(t,o)},o.prototype._trigger=function(t,o){e.GC$(this._DOMObject).trigger(t,o)},o}(function(){function t(t,o,n,r,i){this._DOMObject=g.createElement("div"),this._isShown=!1,this._setDefaultCSS(i),this._width=n,this._height=r,e.GC$(this._DOMObject).css(O,n).css(P,r),this.updateLocation(t,o)}return t.prototype._setDefaultCSS=function(t){e.GC$(this._DOMObject).css(m,_).css(B,"1px solid").css(Y,"white").css(X,t||0).css(z,b).css("display","none").css("cursor","default").css(W,"content-box").attr(x,"gcDropDownWindow").attr(R,-1)},t.prototype.show=function(){this.isShown(!0)},t.prototype.close=function(){this.isShown(!1)},t.prototype.toggleShow=function(){this.isShown(!this._isShown)},t.prototype.isShown=function(e){return 0===arguments.length?this._isShown:(e!==this._isShown&&(this._isShown=e,this._updateIsShown()),this)},t.prototype._updateIsShown=function(){this._isShown?this._show():this._close()},t.prototype._show=function(){e.GC$(this._DOMObject).show()},t.prototype._close=function(){e.GC$(this._DOMObject).hide()},t.prototype.width=function(e){if(0===arguments.length)return this._width;e>0&&(this._width=e,this._updateWidth())},t.prototype._updateWidth=function(){e.GC$(this._DOMObject).css(O,this._width)},t.prototype.height=function(e){if(0===arguments.length)return this._height;e>0&&(this._height=e,this._updateHeight())},t.prototype._updateHeight=function(){e.GC$(this._DOMObject).css(P,this._height)},t.prototype.font=function(e){if(0===arguments.length)return this._font;this._font=e,this._updateFont()},t.prototype._updateFont=function(){e.GC$(this._DOMObject).css(C,this._font)},t.prototype.updateLocation=function(t,o){e.GC$(this._DOMObject).css(w,t).css(v,o)},t.prototype.updateStyle=function(t,o,n){e.GC$(this._DOMObject).css(Y,t).css(j,o),this.font(n)},t.prototype.appendTo=function(e){e.appendChild(this._DOMObject)},t}())}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){var o,n,r;t.feature("filter_ui",["core.common","core.stringResource","core.spreadpanelex"]);var i,a="undefined",s="sortASC",l="sortDES",u="filterOK",c="filterCancel",h="filterSearch",p="filterCheckAll",d="filterUnCheckAll",f="filter-item",g="filter-item-container",m="filter-item-input",_="filter-item-text",y="filter-button",C="filter-sort",w="ui-state-hover",v=".gcScrollbar",S=Math.floor,x=Math.max,R=Math.round,b=Math.ceil,T=Math.abs;(i=t._FilterButtonState||(t._FilterButtonState={}))[i.noSortFilter=0]="noSortFilter",i[i.ascend=1]="ascend",i[i.descend=2]="descend",i[i.filter=3]="filter",i[i.filterAscend=4]="filterAscend",i[i.filterDescend=5]="filterDescend",i[i.sortAscending=6]="sortAscending",i[i.sortDescending=7]="sortDescending",i[i.checkAll=8]="checkAll",i[i.unCheckAll=9]="unCheckAll",t._FilterButtonState,o=function(){function e(e,t,o,n,r,i,a,s){this.rowFilter=e,this.row=t,this.col=o,this.sheetArea=n,this.x=r,this.y=i,this.width=a,this.height=s}return e.prototype.getState=function(){var e,t=0,o=this.rowFilter;return o?(e=o.getSortState(this.col),o.isColumnFiltered(this.col)?0===e?t=3:1===e?t=4:2===e&&(t=5):0===e?t=0:1===e?t=1:2===e&&(t=2),t):t},e}(),t._FilterButtonInfo=o,n=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.find=function(e,t,o){for(var n,r=this.length,i=0;i<r;i++)if((n=this[i])&&n.row===e&&n.col===t&&n.sheetArea===o)return n;return null},t}(t._XArray),t._FilterButtonInfoModel=n,r=function(o){function n(e,n,r){o.call(this,e,t.util.getPreferredZIndex(n&&n.parent&&n.parent._host)),this._allValues=[],this._searchedValues=[],this._allCheckedValues=[],this._inputElements=[],this._spanElements=[],this._itemOuterDivs=[];this.sheet=n,this.filterButtonInfo=r,this.init()}return __extends(n,o),n.prototype.init=function(){var e=this;e._containerWidth=237,e._containerHeight=318,e._itemContainerWidth=191,e._itemContainerHeight=150,e._itemDivMargin=2,e._itemDivBorder=1,e._itemDivHeight=20,e._itemHeight=e._itemDivHeight+2*e._itemDivBorder+e._itemDivMargin,e._touchContainerWidth=257,e._touchContainerHeight=355,e._defaultScrollbarSize=e.sheet.parent?e.sheet.parent._getScrollbarSize():18,e.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,e._itemValueCache=[],e._firstOpenCache=[],e.elementList=[],e.activeItemIndex=0,e.container=e.getContainer(),e._createTableLayout(),e._initFilterPanel()},n.prototype.open=function(){var e,t=this.sheet,o=t.parent;t&&(e=!(!o||!o.useTouchLayout)&&o.useTouchLayout(),this._useTouchLayout=e,this._initData(this.filterButtonInfo.col),this._initLayout(),this._updateItemCache(),this._attachEvent())},n.prototype._initLayout=function(){var e=this;e.sheet;e._initFilterItemsLayout(),e.container.appendTo(e.getHost()),e.container.hide(),e.show(function(){t.GC$("#"+s).focus()}),e._useTouchLayout&&e._updateFilterPanel(e._touchContainerWidth,e._touchContainerHeight);var o=e.container.width(),n=(e.container.height(),e.filterButtonInfo.x+e.filterButtonInfo.width-o-6),r=e.filterButtonInfo.y+e.filterButtonInfo.height;e.container.css({left:n,top:r}),e.resetDialogPosition(),e._initFirstOpenCache()},n.prototype._updateFilterPanel=function(e,o){var n,r,i,a,s,l,c,p=e-this._containerWidth,f=o-this._containerHeight;if(!(p<=0||f<=0)){this.container.css({width:e+"px",height:o+"px"}),n=parseFloat(t.GC$("."+C).css("padding-top"))+f/30,t.GC$("."+C).css("padding",n+"px 6px");var g=t.GC$("."+y),m=parseFloat(g.css("width"))+p/4,_=parseFloat(g.css("height"))+f/8;g.css({width:m+"px",height:_+"px"}),r=t.GC$("#"+u),i=parseFloat(r.css("margin-left"))+p/2,r.css("margin-left",i+"px");var w=t.GC$("#"+h),v=parseFloat(w.css("width"))+p,S=parseFloat(w.css("height"))+f/8;w.css({height:S+"px",width:v+"px"}),a=t.GC$(".filter-check-outerDiv"),s=parseFloat(a.css("margin-top"))+f/10,a.css("margin-top",s+"px"),l=t.GC$("#"+d),c=parseFloat(l.css("margin-left"))+p,t.GC$("#"+d).css("margin-left",c+"px")}},n.prototype.close=function(){o.prototype.close.call(this);t.GC$(this._itemSpanElement).remove(),t.GC$(this._itemInputElement).remove(),this.sheet&&this.sheet.setFocus()},n.prototype._initFilterPanel=function(){var e,o,r,i,a=this,f=a.table.getElement(0).children,m=f[0],_=f[1],C=f[2],w=f[3],v=f[4],S=a._getSortLink(s,t.SR.SortAscending).css("margin-top","6px"),x=a._getSortLink(l,t.SR.SortDescending);t.GC$(m.children[0]).append(t.GC$(document.createElement("img")).attr("src",n.getImageSrc(6))),t.GC$(_.children[0]).append(t.GC$(document.createElement("img")).attr("src",n.getImageSrc(7))),t.GC$(m.children[1]).append(S),t.GC$(_.children[1]).append(x),a.elementList.push(S.getElement(0)),a.elementList.push(x.getElement(0)),a.searchOuterDiv=t.GC$(document.createElement("div")).css({margin:0,padding:0}).addClass("search-outer-div ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix"),e=t.GC$(document.createElement("div")).appendTo(a.searchOuterDiv),o=t.GC$(document.createElement("input")).attr({type:"search",placeholder:t.SR.Search,id:h}).appendTo(e),a.elementList.push(o.getElement(0));var R=t.GC$(document.createElement("div")).appendTo(a.searchOuterDiv).addClass("filter-check-outerDiv"),b=a._getCheckLink(p,t.SR.CheckAll,"check-image ui-icon ui-icon-check"),T=a._getCheckLink(d,t.SR.UncheckAll,"uncheck-image ui-icon ui-icon-closethick");R.append(b).append(T),t.GC$(C.children[1]).append(a.searchOuterDiv),a.itemList=t.GC$(document.createElement("div")).addClass(g).css({width:a._itemContainerWidth,height:a._itemContainerHeight,"box-sizing":"content-box"}),t.GC$(w.children[1]).append(a.itemList),r=t.GC$(document.createElement("button")).text(t.SR.OK).css({"font-size":"1em"}).addClass(y+" filter-button-default ui-button ui-state-default ui-corner-all btn btn-default").attr({id:u}),i=t.GC$(document.createElement("button")).text(t.SR.Cancel).css({"font-size":"1em"}).addClass(y+" filter-button-default ui-button ui-state-default ui-corner-all btn btn-default").attr({id:c}),t.GC$(v.children[1]).append(r).append(i),a.elementList.push(r.getElement(0)),a.elementList.push(i.getElement(0))},n.prototype._createTableLayout=function(){var e,o,n,r,i,a;for(this.table=t.GC$(document.createElement("table")).css({padding:0,display:"table"}).attr({cellspacing:0,cellpadding:0}).addClass("layout-table"),e=0;e<5;e++){for((o=document.createElement("tr")).style.border="0px",o.style.margin="0px",o.style.padding="0px",n=t.GC$(o),r=0;r<3;r++)(i=document.createElement("td")).style.border="0px",i.style.margin="0px",i.style.padding="0px",a=t.GC$(i).appendTo(n),0===r?a.addClass("layout-table-first-column"):2===r?a.addClass("layout-table-last-column"):1===r&&(0===e?a.addClass("filter-sort-asc-container sort-container ui-menu-item"):1===e&&a.addClass("filter-sort-desc-container sort-container ui-menu-item"));n.appendTo(this.table)}this.table.appendTo(this.container),this.container.css({"box-shadow":"rgba(0, 0, 0, 0.4) 2px 4px 5px",padding:"2px",width:this._containerWidth+"px",height:this._containerHeight+"px","box-sizing":"content-box"}).addClass("filter-dialog-style no-user-select")},n.prototype._updateItemCache=function(){for(var e=this._allValues,t=0,o=e.length;t<o;t++)this._itemValueCache.push(e[t])},n.prototype._stopBubble=function(e){return e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0,!1},n.prototype._itemsWrapMouseWheel=function(e){var o,n,r,i;(typeof e.wheelDelta===a||null===e.wheelDelta)&&(typeof e.detail===a||null===e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),o=e.detail?e.detail:e.wheelDelta/-40,t.util.isMacOS()&&(typeof(n=e.wheelDeltaY)!==a&&(o=((o=n/-40)>=0?1:-1)*b(T(o))));var s=this._spanElements,l=s.length,u=this._searchedValues,c=u.length,h=0;s&&l>0&&(r=t.GC$(s[0]).text(),h=t.GC$.inArray(r,u)),(i=h+o)>c-l&&(i=c-l),i<0&&(i=0),this._updateItemsLayout(i),t.util.cancelDefault(e)},n.prototype._attachEvent=function(){var o,n,r=this;r._itemsWrap&&(r._itemsWrap.addEventListener("mousewheel",function(e){r._itemsWrapMouseWheel(e)},!1),r._itemsWrap.addEventListener("DOMMouseScroll",function(e){r._itemsWrapMouseWheel(e)},!1)),o=!1,t.GC$("#"+s).bind("mouseup",function(e){o&&(o=!1,r._sortByUser(!0),r.close(),t.util.cancelDefault(e))}).bind("mousedown",function(e){t.util.cancelDefault(e),o=!0}),n=!1,t.GC$("#"+l).bind("mouseup",function(e){n&&(n=!1,r._sortByUser(!1),r.close(),t.util.cancelDefault(e))}).bind("mousedown",function(e){t.util.cancelDefault(e),n=!0}),t.GC$("."+C).bind("mouseover",function(){t.GC$(".filter-hover").removeClass(w+" filter-item-hover"),t.GC$(this).addClass("filter-hover ui-state-hover form-control well filter-item-hover")}).bind("mouseout",function(){t.GC$(this).removeClass("filter-hover ui-state-hover form-control well filter-item-hover")}),t.GC$("#"+p).bind("mousedown",function(e){t.util.cancelDefault(e)}).bind("mouseup",function(e){var o=r._getVisibleItems();t.GC$(o).find("input").prop("checked",!0),r._allCheckedValues=r._searchedValues.concat([]),r._setButtonState(),t.util.cancelDefault(e)}),t.GC$("#"+d).bind("mousedown",function(e){t.util.cancelDefault(e)}).bind("mouseup",function(e){var o=r._getVisibleItems();t.GC$(o).find("input").prop("checked",!1),r._allCheckedValues.length=0,r._setButtonState(),t.util.cancelDefault(e)}),t.GC$("."+f).bind("mouseover",function(){t.GC$(".filter-hover").removeClass(w+" filter-item-hover"),t.GC$(this).addClass("filter-hover ui-state-hover form-control well filter-item-hover")}).bind("mouseout",function(){t.GC$(this).removeClass("filter-hover ui-state-hover form-control well filter-item-hover")}).bind("click",function(e){t.GC$(this).find("input").getElement(0).click()}),t.GC$("."+f).find("input").bind("click",function(e){r._stopBubble(e);var o=t.GC$(this).parent().getElement(0);r._updateActiveItemIndex(o),r._setButtonState()}),e.Sheets.Key,t.GC$("#"+h).bind("keydown",function(e){13===(e.which||e.keyCode)&&e.preventDefault()}).bind("keyup",function(e){switch(e.keyCode){case 9:case 37:case 38:case 39:case 40:return;default:r._searchHandler(e),r._setButtonState()}}).bind("search",function(e){r._searchHandler(e),r._setButtonState()}),t.GC$("."+y).bind("mouseover",function(){t.GC$(this).addClass("filter-button-hover ui-state-hover")}).bind("mouseout",function(){t.GC$(this).removeClass("filter-button-hover ui-state-hover")}),t.GC$("."+y).bind("mousedown",function(){t.GC$(this).removeClass("filter-button-hover "+w).addClass("filter-button-active")}).bind("mouseout",function(){t.GC$(this).removeClass("filter-button-active")}),t.GC$("#"+u).bind("click",function(){var e=r._allCheckedValues;r._updateData(e),r._filter(e),r.close()}),t.GC$("#"+c).bind("click",function(){r.close()}),r.container.bind("mousewheel",function(e){t.util.cancelDefault(e)}).bind("DOMMouseScroll",function(e){t.util.cancelDefault(e)}).bind("keydown.ui-filter-dialog",function(e){r._filterKeyDown(e)}).bind("keyup.ui-filter-dialog",function(e){t.util.cancelDefault(e)})},n.prototype._getVisibleItems=function(){var e=this._itemOuterDivs,t=[];return e.forEach(function(e){e.style&&"none"!==e.style.display&&t.push(e)}),t},n.prototype._filterKeyDown=function(e){var o,n,r,i,h,p,d,f,g,m,_,y,C,v,S,x,R,b=this,T=e.which||e.keyCode;if(27===T||13===T||38===T||40===T||9===T)if(n=(o=t.GC$(".filter-item-hover")).getElement(0),27===T)b.close(),t.util.cancelDefault(e);else if(13===T){if(1!==o.length())return;(r=o.attr("id"))===s?(b._sortByUser(!0),b.close()):r===l?(b._sortByUser(!1),b.close()):r===u?(i=b._allCheckedValues,b._updateData(i),b._filter(i),b.close()):r===c?b.close():((h=o.find("input")).length()>0&&h.trigger("click"),b._updateActiveItemIndex(n))}else if(38===T||40===T||9===T){if(d=b._searchedValues,0===o.length())p=b.elementList[0];else{for(o.removeClass(w+" filter-item-hover"),f=b.elementList.concat([]),g=0;g<d.length;g++)f.splice(-2,0,d[g]);if(9===T){if(m=b.elementList.concat([]),d[b.activeItemIndex]&&m.splice(-2,0,d[b.activeItemIndex]),_=t.GC$.inArray(n,b._itemOuterDivs),e.shiftKey){if(_>=0)p=b.elementList[2];else if((_=t.GC$.inArray(n,m))>=0)for(p=m[_-1];_>0&&b._isElementDisabled(p);)p=m[_-1],_--;typeof p===a&&(p=m[m.length-1])}else if(_>=0)y=b.elementList[3],p=b._isElementDisabled(y)?b.elementList[4]:b.elementList[3];else if((_=t.GC$.inArray(n,m))>=0)for(C=m.length,p=m[_+1];b._isElementDisabled(p)&&_<C;)p=m[_+1],_++;typeof p===a&&(p=m[0])}else if(v=n,t.GC$.inArray(v,b._itemOuterDivs)>=0&&(v=t.GC$(v).find("span.filter-item-text").text()),S=t.GC$.inArray(v,f),x=f.length,S>=0){if(40===T)for(p=f[S+1],-1!==t.GC$.inArray(p,d)&&-1===t.GC$.inArray(v,d)&&(p=f[(S+=b.activeItemIndex)+1]);S<x&&b._isElementDisabled(p);)p=f[S+1],S++;else{for(p=f[S-1],-1!==t.GC$.inArray(p,d)&&-1===t.GC$.inArray(v,d)&&(p=f[S=b.activeItemIndex+3]);S>0&&b._isElementDisabled(p);)p=f[S-1],S--;typeof p===a&&(p=f[f.length-1])}typeof p===a&&(p=f[0])}}"string"==typeof p?(R=b._hoverToTargetFilterItem(p,d))&&(o=R):(o=t.GC$(p)).focus(),o.addClass("filter-hover "+w+" filter-item-hover"),t.util.cancelDefault(e)}},n.prototype._hoverToTargetFilterItem=function(e,o){var n=t.GC$.inArray(e,o),r=null;if(n>=0){this.activeItemIndex=n;var i=this._spanElements,a=t.GC$(i[0]).text(),s=t.GC$.inArray(a,o);n<s?(this._updateItemsLayout(n),r=t.GC$(i[0]).parent()):r=this._indexOfCurrentItemList(e,i)>=0?this._getVisibleHoverItem(e,s+1):this._getVisibleHoverItem(e,n-i.length+1),r.find("input").focus()}return r},n.prototype._indexOfCurrentItemList=function(e,o){for(var n=0,r=o.length;n<r;n++)if(t.GC$(o[n]).text()===e)return n;return-1},n.prototype._getVisibleHoverItem=function(e,o){for(var n,r,i,a=null,s=this._spanElements,l=this._searchedValues.length;;){if((n=this._indexOfCurrentItemList(e,s))>=0){if(a=t.GC$(s[n]).parent(),r=this._scrollbarH,i=!0,this._showHorizontalScrollbar&&r&&a.length>0&&"none"!==a.css("display")){var u=a.offset().top+this._itemHeight,c=r.getScrollbar();u>t.GC$(c).offset().top&&(i=!1)}if(i)break}if(this._updateItemsLayout(o),++o>l-1)break}return a},n.prototype._updateActiveItemIndex=function(e){var o,n,r,i=this._searchedValues,a=this._allCheckedValues,s=t.GC$(e).find("span.filter-item-text");s&&(o=s.text(),(n=t.GC$.inArray(o,a))>=0?a.splice(n,1):a.push(o),(r=t.GC$.inArray(o,i))>=0&&(this.activeItemIndex=r))},n.prototype._isElementDisabled=function(e){return"string"!=typeof e&&(0!==(e=t.GC$(e)).length&&!!(e.hasClass("ui-button-disabled")||e.hasClass(" ui-state-disabled")||e.hasClass("filter-button-disable")))},n.prototype._filter=function(e){var t,o,n=this.sheet;if(n){t=n.isPaintSuspended();try{if(n.isPaintSuspended(!0),!(o=this.filterButtonInfo.rowFilter))return;var r=this.filterButtonInfo.col,i=o.table&&o.table(),a=i?r-i.range().col:-1;e&&(i?n.triggerTableFiltering({sheet:n,sheetName:n._name,table:i,tableCol:a,filterValues:e}):n.triggerRangeFiltering({sheet:n,sheetName:n._name,col:r,filterValues:e})),o.filter(r),e&&(i?n.triggerTableFiltered({sheet:n,sheetName:n._name,table:i,tableCol:a,filterValues:e}):n.triggerRangeFiltered({sheet:n,sheetName:n._name,col:r,filterValues:e}))}finally{n.isPaintSuspended(t)}}},n.prototype._updateData=function(e){var o,n,r,i=this.filterButtonInfo.col,a=this.filterButtonInfo.rowFilter;if(a&&t.features.conditionalFormat&&(a.removeFilterItems(i),e.length!==this._allValues.length))for(o=0;o<e.length;o++)(n=e[o])===t.SR.Blanks&&(n=""),(r=new t.TextCondition(0,n,null)).useWildCards=!1,a.addFilterItem(i,r)},n.prototype._searchHandler=function(e){var o,n,r=t.GC$("#"+h),i=t.GC$.trim(r.val().toLowerCase()),a=t.GC$("."+g).find("input"),s=a.parent();i?(s.hide(),a.prop("checked",!1),o=new RegExp(i.replace(this.rEscape,"\\$&").replace("*",".*").replace("?",".?").replace("~","\\~"),"gi"),n=[],t.GC$.map(this._itemValueCache,function(e,t){-1!==e.search(o)&&n.push(e)}),this._searchedValues=n.concat([]),this._allCheckedValues=n.concat([]),this.activeItemIndex=0,this._updateItemsLayout(0)):(s.show(),this._firstOpenCache&&0!==this._firstOpenCache.length?(a.prop("checked",!1),this._searchedValues=this._allValues.concat([]),this._allCheckedValues=this._firstOpenCache.concat([]),this._updateItemsLayout(0)):this._initFirstOpenCache())},n.prototype._getSortLink=function(e,o){var n=t.GC$(document.createElement("a"));return n.attr({id:e,href:"javascript:void(0)"}).text(o).addClass(C+" ui-corner-all").css({display:"block",padding:"5px 6px",cursor:"default",margin:"2px 0px 1px 2px","text-decoration":"none","text-align":"left","font-size":"12px",outline:"none",height:"inherit"}),n},n.prototype._getCheckLink=function(e,o,n){var r=t.GC$(document.createElement("span")).addClass("check-uncheck-all "+n),i=t.GC$(document.createElement("span")).text(o),a=t.GC$(document.createElement("a"));return a.attr({href:"javascript:void(0)",id:e}).css("float","left").css({"margin-left":"7px",padding:"0","font-size":"12px",height:"16px"}).addClass("filter-check filter-check-style").append(r).append(i),a},n.prototype._initData=function(e){var t,o=this.filterButtonInfo.rowFilter;o&&(this._getItemsData(o,e),(t=this._allValues).sort(function(e,t){return e>t?1:e<t?-1:0}),this._allValues=t,this._searchedValues=t.concat([]),o.isColumnFiltered(e)||(this._allCheckedValues=t.concat([])))},n.prototype._getItemsData=function(e,o){var n,r,i,a=this.sheet,s=[],l=[],u={},c=a._getActualRange(e.range);if(o<c.col||o>c.col+c.colCount-1)return this._allValues=s,void(this._allCheckedValues=l);for(n=!1,r=c.row;r<c.row+c.rowCount;r++)""!==(i=a.getText(r,o))?u[i]||a.getRowVisible(r,3,!0)&&(a.getRowHeight(r,3)>0?(s.push(i),u[i]=!0,l.push(i)):(!e.isFiltered()||e.isLastFilteredColumn(o)&&e._isRowfilteredOutByColumn(r,o))&&(s.push(i),u[i]=!0)):n||(n=!0,s.push(t.SR.Blanks),a.getRowHeight(r,3)>0&&l.push(t.SR.Blanks));this._allValues=s,this._allCheckedValues=l},n.prototype._initFilterItemsLayout=function(){var e,o,n,r,i,a,s,l,u,c=this,h=0,p=c._itemContainerWidth,d=c._itemContainerHeight;c._useTouchLayout&&(e=c._touchContainerWidth-c._containerWidth,h=(o=c._touchContainerHeight-c._containerHeight)/4,p+=e,d+=o/2,c._itemContainerHeight=d,c._itemContainerWidth=p,c.itemList.css({width:p+"px",height:d+"px"}),c._itemHeight+=h),c.defaultItemWidth=p-2*c._itemDivMargin-2*c._itemDivBorder,n=document.createElement("div"),c._itemsWrap=n,n.className="filter-item-wrapper";var g=c._allValues,y=c._itemHeight,C=R(d/y),w=0,v=0;for(r=0,i=g.length;r<i;r++)a=g[r],w+=y,r>=C||(v=x(c._getItemWidthByText(a),v),(s=document.createElement("div")).className=f+" ui-corner-all no-user-select",t.GC$(s).css({display:"block",padding:h/2,"border-width":c._itemDivBorder+"px",margin:c._itemDivMargin+"px",height:c._itemDivHeight+"px","box-sizing":"content-box"}).attr("unselectable","on"),n.appendChild(s),c._itemOuterDivs.push(s),(l=document.createElement("input")).className=m,l.setAttribute("type","checkbox"),l.setAttribute("value",a),l.style.margin="3px",l.style.padding="0",s.appendChild(l),c._inputElements.push(l),(u=document.createElement("span")).className=_,u.innerHTML=t.StringUtil.escapeHtml(a),c._spanElements.push(u),s.appendChild(u));c._maxItemWidth=v,c._totalItemsHeight=w,c.itemList.empty();var S=document.createElement("table"),b=document.createElement("tr"),T=document.createElement("tr"),A=document.createElement("td"),I=document.createElement("td"),D=document.createElement("td"),F=document.createElement("td");c._hScrollbarTd=F,c._vScrollbarTd=D,t.GC$(b).css({border:0,margin:0,padding:0}),t.GC$(T).css({border:0,margin:0,padding:0}),t.GC$(A).css({border:0,margin:0,padding:0}),t.GC$(D).css({border:0,margin:0,padding:0}),t.GC$(F).css({border:0,margin:0,padding:0}),t.GC$(I).css({border:0,margin:0,padding:0}),b.appendChild(A),b.appendChild(D),T.appendChild(F),T.appendChild(I),S.appendChild(b),S.appendChild(T),A.appendChild(n),t.GC$(S).css({width:p,height:d,border:0,margin:0,padding:0}).attr({cellspacing:0,cellpadding:0,border:0}),c._refreshScrollbar(),c.itemList.append(S),c._setItemWidth(),c._setCheckedValues()},n.prototype._updateItemsLayout=function(e){for(var o,n=this,r=n._searchedValues,i=n._spanElements,a=n._inputElements,s=0,l=n._itemHeight,u=e,c=0,h=i.length;c<h;c++){var p=i[c],d=a[c],f=r[e++];p&&f&&""!==f?(t.GC$(p).parent().show(),p.innerHTML=t.StringUtil.escapeHtml(f),d.setAttribute("value",f),s=x(n._getItemWidthByText(f),s)):(p.innerHTML="",d.setAttribute("value",""),t.GC$(p).parent().hide())}n._maxItemWidth=s,n._totalItemsHeight=r.length*l,n._refreshScrollbar(),(o=n._scrollbarV)&&o.value(u),n._setItemWidth(),n._setCheckedValues()},n.prototype._refreshScrollbar=function(){var e,o,n,r=this,i=r._maxItemWidth,a=r._totalItemsHeight,s=r._itemContainerWidth,l=r._itemContainerHeight,u=r._itemHeight,c=r._defaultScrollbarSize,h=s-c,p=l-c,d=r._searchedValues,f=r._isNeedScrollbars(i,a,s,l),g=f.isNeedVScroll,m=f.isNeedHScroll;g?(m||(p+=c),r._scrollbarV||r._createVerticalScrollbar(),e=S(p/u),(o=r._scrollbarV).width(c),o.height(p),o.minimum(0),o.maximum(d.length-e),o.pageValue(e),o.smallChange(1),o.largeChange(e-1),o.refreshLayout(),t.GC$(r._vScrollbarTd).show(),r._showVerticalScrollbar=!0):(t.GC$(r._vScrollbarTd).hide(),r._showVerticalScrollbar=!1),m?(g||(h+=c),r._scrollbarH||r._createHorizontalScrollbar(),(n=r._scrollbarH).width(h),n.height(c),n.minimum(0),n.maximum(i-h),n.pageValue(h),n.smallChange(u),n.largeChange(h),n.refreshLayout(),t.GC$(r._hScrollbarTd).show(),r._showHorizontalScrollbar=!0):(t.GC$(r._hScrollbarTd).hide(),r._showHorizontalScrollbar=!1),m||g||(p=l,h=s),t.GC$(r._itemsWrap).css({width:h,height:p,overflow:"hidden"})},n.prototype._vscrollDelegate=function(e){this._updateItemsLayout(e)},n.prototype._hscrollDelegate=function(e){t.GC$("."+f).css("left",0-e)},n.prototype._createVerticalScrollbar=function(){var e,o=this;o._scrollbarV=new t.Scrollbar(!1),e=o._scrollbarV.getScrollbar(),o._vScrollbarTd.appendChild(e),t.GC$(e).bind("scroll"+v,function(e,t){t.scrollEventType;var n,r=t.scrollOrientation;if(e.data=o,1===r)switch(n=t.newValue,t.scrollEventType){case 0:case 1:case 2:case 3:case 5:o._vscrollDelegate(n)}})},n.prototype._createHorizontalScrollbar=function(){var e,o=this;o._scrollbarH=new t.Scrollbar(!0),e=o._scrollbarH.getScrollbar(),o._hScrollbarTd.appendChild(e),t.GC$(e).bind("scroll"+v,function(e,t){t.scrollEventType;var n,r=t.scrollOrientation;if(e.data=o,0===r)switch(n=t.newValue,t.scrollEventType){case 0:case 1:case 2:case 3:case 5:o._hscrollDelegate(n)}})},n.prototype._isNeedScrollbars=function(e,t,o,n){var r=this._defaultScrollbarSize,i=o-r,a=n-r,s={isNeedHScroll:!1,isNeedVScroll:!1};return e>o&&(s.isNeedHScroll=!0,s.isNeedVScroll=t>a),t>n&&(s.isNeedVScroll=!0,s.isNeedHScroll=e>i),s},n.prototype._getItemWidthByText=function(e){var o,n,r,i,a,s,l,u=this;return u._itemSpanElement||((o=document.createElement("input")).className=m,o.setAttribute("type","checkbox"),u._itemInputElement=o,(n=document.createElement("span")).className=_,u._itemSpanElement=n,document.body.insertBefore(o,null),document.body.insertBefore(n,null),r=parseFloat(t.GC$(o).css("margin-left"))+parseFloat(t.GC$(o).css("margin-right")),isNaN(r)&&(r=0),i=parseFloat(t.GC$(o).css("padding-left"))+parseFloat(t.GC$(o).css("padding-right")),isNaN(i)&&(i=0),a=parseFloat(t.GC$(n).css("margin-left"))+parseFloat(t.GC$(n).css("margin-right")),isNaN(a)&&(a=0),s=parseFloat(t.GC$(n).css("spanPadding-left"))+parseFloat(t.GC$(n).css("spanPadding-right")),isNaN(s)&&(s=0),u._itemInputWidth=t.GC$(o).width()+r+i,u._itemSpanPartWidth=a+s,o.style.display="none",n.style.display="none"),(l=u._itemSpanElement).innerHTML=t.StringUtil.escapeHtml(e),t.GC$(l).width()+u._itemInputWidth+u._itemSpanPartWidth+1+2*u._itemDivMargin+2*u._itemDivBorder},n.prototype._setItemWidth=function(){var e,o=t.GC$(this._itemOuterDivs),n=this._showVerticalScrollbar;e=this._showHorizontalScrollbar?this._maxItemWidth:n?this.defaultItemWidth-this._defaultScrollbarSize:this.defaultItemWidth,o.css("width",e)},n.prototype._ArrayToDic=function(e){var o={};return t.GC$.each(e,function(e,t){o[t]=t}),o},n.prototype._setCheckedValues=function(){var e=this._allCheckedValues,o=this._ArrayToDic(e);this._inputElements.forEach(function(e){var n=t.GC$(e),r=n.val();null!==o[r]&&typeof o[r]!=a?n.prop("checked",!0):n.prop("checked",!1)})},n.prototype._sortByUser=function(e){var t,o,n,r,i=this.filterButtonInfo.rowFilter;i&&(o=(t=this.sheet)._name,t)&&t.canDoSort()&&(n=this.filterButtonInfo.col,t.triggerRangeSorting({sheet:t,sheetName:o,col:n,ascending:e}),r=t.isPaintSuspended(),t.isPaintSuspended(!0),i.sortColumn(n,e),t.isPaintSuspended(r),t.triggerRangeSorted({sheet:t,sheetName:o,col:n,ascending:e}))},n.prototype._setButtonState=function(){var e=this._allCheckedValues.length,o=t.GC$("#"+u),n="ui-button-disabled ui-state-disabled",r="filter-button-disable";e>0?o.prop("disabled",!1).removeClass(n+" "+r):o.prop("disabled",!0).addClass(n+" "+r)},n.prototype._initFirstOpenCache=function(){this._firstOpenCache=this._allCheckedValues.concat([])},n.getImageSrc=function(e){return 0===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAABy0lEQVR42pyST2gTQRTGv9nEpCnqTasHES8VLCioiFDIYYum+I/ebFXQm1BbsdSDhKgoXhS8tLQSqAhexIInETwJIqJiexJEZXupwRJNbRsy2Z3dzHxesjGEChs/eMx7A+837817giQAYCD3cZuScqG8Wtj19tG5n/iHhBAkKcLYCh3fdSd04HXCq5xHG2oAdOAdNIG3qAJ5tW1A/9hrm8ZsV+7vDLTe2nsmP9AWwATuXe27330lLwvLkloHY5EBR0dexkB0xxKp9Ieno8MbOjYP1ZRMHz77YE8kAMk35V/fkpWSc6L3dL7Tl6uPAaAm155EAYhwjFHVOsY4AEwPXXkG7W+0EqmCodlRW17oCkrO5Pjc55lon7i2mBqenc7ETTmLFWdvaenLpijJDUBcywsAYFRwu/jja1dMWNfWKf2WEOJ43T8ihLgHACAJkpgZvNQ3kTnJG/u6Z8O7ZgNwAACbzCb5dxNVLPnQW3aKyY7EKABM2XZPcwUk5wG8qIfvSL5qtJAfHLnvF+Z2GsPr2fefipPH0luq5aXsOi3frJ+5xhSm+k/1VErOxRWlqgkrfujO/t191ZqxLeB5azbJeSFELnz9v/agVX8GAIjG5r9I9yjkAAAAAElFTkSuQmCC":7===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgVjMuNS41Tib51gAAAXlJREFUOE9jYACCqRH5a6eGZu6cHl00d2pUwa6J7r4Xe4w1U0ByWMB/DLHJnoHbQIKzI1PEp3r6vKjVU72HQzNIGNOA6W5uYiCZmUHxM+v0Vf836KuHkWQASPGciGznSe6+/+v01Vbh0YzdBeBwiC560GWi+aLVXEccxJ/i6KhNdBjMCM/u7be3+99hpJEK0jTJ01a0y1hjKVEGTHH31e4w1vxSrqP0tVZPbXazodqKSl2VV9W6KnOJMoCAf4mLRpAq/+pTEh4F+79aJSwGxwjJseBZdHCVa/b2/1YR00vJMsAtd+c957T1D42De17iMKARKO4NTUiuQLoLrs694IAT0PbvNrFzNYwDOv9bRc4IwGKIMVQzKCWCsBNcDVDzaafUdbfMwiZNMwnq/mIeNvkgDldsgWo+hqyZ2TVr+0egIRIgQcuomb7G/h3/zaOmaeFxBcJ2l6xtx8xDJ/6wDJ+cYhU2g8vYv/M9yABj//aLOFxRTUbU49YCALt6h216b0oVAAAAAElFTkSuQmCC":8===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAKBJREFUOE+l0cENwjAMBdCM0BEYhZG6AjdvwQhMUvXQI0KcKo6IY2/9v0qQnVilFoenJF+2q6RJRP7ihhFuGOGGO851Zg4/9PCGi8oOD+iAzQM8c7bRRTX9pStMmbnGd1Nhwz2vbOD+ATcwteagjPBSZuAVTmBqzUHhnTnkA2wkPmJT2wRKGbLk1avZHUAcwldv/n/hhhFuGOGGEW54nKQVV2qyDejeW7YAAAAASUVORK5CYII=":9===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAHpJREFUOE+lz8ENgDAMA8COxEiMkxWYgkmYhCGgllpkUz8aeJyQrVQJJSJ+sWWGLTNsmWHLaq22amkZX2T0MiuB7ASPOMusBIKNh9Evekh4weaTDOfDUDTYdBnTF/AjbOYssxJIf9Q39ouG35DwhS0zbJlhywxbzotyAztMtZGgPPrJAAAAAElFTkSuQmCC":""},n}(t.BaseDialog),t._GcFilterDialog=r}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n;e.feature("filter",["core.common","core.stringResource","filter_ui"]);var r=null,i=void 0,a=function(){function t(e){this.range=e,this.reset(),this.typeName=""}return t.prototype.filterButtonVisible=function(e,t){var o,n,r,a=this,s=a.sheet,l=a._getStartCol(),u=a._getEndCol();switch(arguments.length){case 0:for(r=l;r<u;r++)if(!0===(o=a.filterButtonVisibleInfo[r])||void 0===o)return!0;return!1;case 1:if("number"==typeof(n=arguments[0]))return e>=l&&e<u&&a.filterButtonVisibleInfo[e]===i&&(a.filterButtonVisibleInfo[e]=!0),a.filterButtonVisibleInfo[e];if("boolean"==typeof n){for(r=l;r<u;r++)a.filterButtonVisibleInfo[r]=n;return s&&s.invalidate(),a}case 2:return e>=l&&e<u&&a.filterButtonVisibleInfo[e]!==t&&(a.filterButtonVisibleInfo[e]=t),s&&s.invalidate(),a}},t.prototype._getStartCol=function(){var e=this.range;return e.row<0?0:e.col},t.prototype._getEndCol=function(){var e=this.range,t=this.sheet;return e.row<0?t.getColumnCount():e.col+e.colCount},t.prototype.getShowFilterButton=function(){return this.filterButtonVisible()},t.prototype.setShowFilterButton=function(e){this.filterButtonVisible(e)},t.prototype.addFilterItem=function(t,o){var n,a;if(o===i||o===r)throw new Error(e.SR.Exp_FilterItemIsNull);if(t<-1||t>=this.sheet.getColumnCount())throw new Error(e.SR.Exp_InvalidColumnIndex);this.range&&(t<(n=this.sheet._getActualRange(this.range)).col||t>=n.col+n.colCount||((a=this.filterItemMap[t])||(a=[]),a.push(o),this.filterItemMap[t]=a))},t.prototype.addAverageFilter=function(t,o){if(e.features.conditionalFormat){var n=new e.AverageCondition(o);this.addFilterItem(t,n)}},t.prototype.addBackgroundFilter=function(t,o){if(e.features.conditionalFormat){var n=new e.ColorCondition(0,o);this.addFilterItem(t,n)}},t.prototype.addDateFilter=function(t,o,n){if(e.features.conditionalFormat){var r=new e.DateCondition(o,n);this.addFilterItem(t,r)}},t.prototype.addForegroundFilter=function(t,o){if(e.features.conditionalFormat){var n=new e.ColorCondition(1,o);this.addFilterItem(t,n)}},t.prototype.addNumberFilter=function(t,o,n){if(e.features.conditionalFormat){var r=new e.NumberCondition(o,n);this.addFilterItem(t,r)}},t.prototype.addTextFilter=function(t,o,n){if(e.features.conditionalFormat){var r=new e.TextCondition(o,n);this.addFilterItem(t,r)}},t.prototype.addTop10Filter=function(t,o,n){if(e.features.conditionalFormat){var r=new e.Top10Condition(o,n);this.addFilterItem(t,r)}},t.prototype.removeFilterItems=function(e){this.removeFilterItemsInternal(e),this.unfilter(e)},t.prototype.removeFilterItemsInternal=function(e){this._removeFilteredItems(e),this.filterItemMap[e]&&this.filterItemMap.splice(e,1,r)},t.prototype.unfilter=function(e){var t=this;t.sheet&&t.sheet._bindToAutoRefresh(function(e){var o,n,a;if(e!==r&&e!==i)t._unfilterColumn(e),t.reFilter();else if(o=t.filteredColumns)for(n=o.length-1;n>=0;n--)t._unfilterColumn(o[n]);t.sheet.refreshObjectsAboveSheet(),a=t.getFilterArgs(1,e),t.filterHandler&&t.filterHandler(a),t.onFilter(a)})(e)},t.prototype._filterColumn=function(e){var t,o,n,r,i,a=this;if(a._unfilterColumn(e),a.filterItemMap[e]){if(!a.range)return;if(a.range&&-1!==a.range.col&&(e<a.range.col||e>a.range.col+a.range.colCount-1))return;for(t=a.range.row,o=a.range.rowCount,-1===t&&(t=0,o=a.sheet.getRowCount()),{},n=a._getRowDataCache(e,t,o),r=a._FilterRowsWithTextEquals(t,o,e,n),i=t;i<t+o;i++)a.isRowFilteredOut(i)||a._filterRowByCell(r,i,e,n);a._setColumnFilteredState(e,!0)}},t.prototype._getRowDataCache=function(e,t,o){var n,r,i,a,s,l,u,c={};for(i=(n=this._getItemType(e)).length,a=t;a<t+o;a++){for(s={},l=0;l<i;l++)switch(r=n[l]){case"T":s[r]=this.sheet.getText(a,e);break;case"BC":(u=this.sheet.getActualStyle(a,e))&&(s[r]=u.backColor);break;case"FC":(u=this.sheet.getActualStyle(a,e))&&(s[r]=u.foreColor);break;case"V":s[r]=this.sheet.getValue(a,e)}c[a]=s}return c},t.prototype._getItemType=function(t){for(var o,n=[],r=this.filterItemMap[t],i=r.length,a=0;a<i;a++)"RelationCondition"===(o=r[a]).conditionType||o instanceof e.RelationCondition?(o.item1&&("TextCondition"===o.item1.conditionType||"TextLengthCondition"===o.item1.conditionType?-1===e.ArrayHelper.indexOf(n,"T")&&n.push("T"):"ColorCondition"===o.item1.conditionType?0===o.item1.compareType?-1===e.ArrayHelper.indexOf(n,"BC")&&n.push("BC"):1===o.item1.compareType&&-1===e.ArrayHelper.indexOf(n,"FC")&&n.push("FC"):-1===e.ArrayHelper.indexOf(n,"V")&&n.push("V")),o.item2&&("TextCondition"===o.item2.conditionType||"TextLengthCondition"===o.item2.conditionType?-1===e.ArrayHelper.indexOf(n,"T")&&n.push("T"):"ColorCondition"===o.item2.conditionType?0===o.item2.compareType?-1===e.ArrayHelper.indexOf(n,"BC")&&n.push("BC"):1===o.item2.compareType&&-1===e.ArrayHelper.indexOf(n,"FC")&&n.push("FC"):-1===e.ArrayHelper.indexOf(n,"V")&&n.push("V"))):"TextCondition"===o.conditionType||"TextLengthCondition"===o.conditionType?-1===e.ArrayHelper.indexOf(n,"T")&&n.push("T"):"ColorCondition"===o.conditionType?0===o.compareType?-1===e.ArrayHelper.indexOf(n,"BC")&&n.push("BC"):1===o.compareType&&-1===e.ArrayHelper.indexOf(n,"FC")&&n.push("FC"):-1===e.ArrayHelper.indexOf(n,"V")&&n.push("V");return n},t.prototype.filter=function(e){var t=this,o=t.sheet;o&&o._bindToAutoRefresh(function(e){var n,a,s;if(e!==r&&e!==i){if(!t.filterItemMap[e])return;t._filterColumn(e)}else if(n=t.filterItemMap)for(a=0;a<n.length;a++)n[a]&&n[a].length>0&&t._filterColumn(a);o.refreshObjectsAboveSheet(),s=t.getFilterArgs(0,e),t.filterHandler&&t.filterHandler(s),t.onFilter(s)})(e)},t.prototype.getFilterArgs=function(e,t){var o,n,r,i,a=this.sheet,s=this.range,l=[],u=[];if(s)for(o=s.row,n=s.rowCount,-1===o&&(o=0,n=a.getRowCount()),r=o,i=o+n;r<i;r++)this.isRowFilteredOut(r)?u.push(r):l.push(r);return{action:e,sheet:a,range:s,filteredRows:l,filteredOutRows:u,column:t}},t.prototype.onFilter=function(e){},t.prototype.isHideRowFilter=function(){return!1},t.prototype.isFiltered=function(){return this.filteredColumns.length>0},t.prototype.isColumnFiltered=function(t){return e.ArrayHelper.contains(this.filteredColumns,t)},t.prototype.isRowFilteredOut=function(e){var t,o;return!!this.isFiltered()&&(!!(t=this.range)&&((!t||-1===t.row||!(e<t.row||e>t.row+t.rowCount-1))&&!(this.filteredInRowsWithColIndexs&&(o=this.filteredInRowsWithColIndexs[e],o&&o.length>=this.filteredColumns.length))))},t.prototype.reset=function(){this.unfilter(),this.filterItemMap=[],this.filteredColumns=[],this.filteredItems=[],this.filteredInRowsWithColIndexs={},this.filterButtonVisibleInfo={},this.sortInfo=r},t.prototype.isFilterHeader=function(e,t,o){var n,r=!1;return this.range&&(n=this.sheet._getActualRange(this.range,o),1===o&&e===this.sheet.getRowCount(o)-1&&n.row-1<0?t>=n.col&&t<n.col+n.colCount&&(r=!0):3===o&&e===n.row-1&&t>=n.col&&t<n.col+n.colCount&&(r=!0)),r},t.prototype.isLastFilteredColumn=function(e){var t=this.filteredColumns.length;return t>0&&this.filteredColumns[t-1]===e},t.prototype.getFilterItems=function(e){var t=this.filterItemMap[e];return t||(t=[]),t},t.prototype.getFilteredItems=function(){return this.filteredItems},t.prototype.sortColumn=function(e,t){var o=this,n=o.sheet;n&&n._bindToAutoRefresh(function(e,t){var r,i=n._getActualRange(o.range),a=n.isPaintSuspended();n.isPaintSuspended(!0),r=n.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:e,ascending:t}]),n.isPaintSuspended(a),r&&(o.sortInfo={index:e,ascending:t},o.isColumnFiltered(e)&&o.reFilter())})(e,t)},t.prototype.getSortState=function(e){var t=0;return this.sortInfo&&this.sortInfo.index===e&&(t=this.sortInfo.ascending?1:2),t},t.prototype.reFilter=function(){var e,t;if(this.filteredInRowsWithColIndexs={},(this.filteredItems||this.filteredItems.length>0)&&(this.filteredItems.length=0),this.filteredColumns||this.filteredColumns.length>0)for(e=(e=[]).concat(this.filteredColumns),this.filteredColumns.length=0,t=0;t<e.length;t++)this.filter(e[t])},t.prototype.openFilterDialog=function(e){},t.prototype._addFilteredInRowsWithColumnIndex=function(t,o){var n,a=this.filteredInRowsWithColIndexs[t];a===i||a===r?a=[o]:((n=e.ArrayHelper).contains(a,o)&&n.remove(a,o),a.push(o)),this.filteredInRowsWithColIndexs[t]=a},t.prototype._addFilteredItem=function(t){e.ArrayHelper.contains(this.filteredItems,t)||this.filteredItems.push(t)},t.prototype._unfilterColumn=function(e){var t=this.sheet;this.range&&(t._getActualRange(this.range),this.isColumnFiltered(e)&&(this._setColumnFilteredState(e,!1),this._removeFilteredInRowsWithColumnIndex(e),this._removeFilteredItems(e)))},t.prototype._setColumnFilteredState=function(t,o){if(o){if(this.filteredColumns.length>0){if(this.filteredColumns[this.filteredColumns.length-1]===t)return;e.ArrayHelper.remove(this.filteredColumns,t)}this.filteredColumns.push(t)}else e.ArrayHelper.remove(this.filteredColumns,t)},t.prototype._removeFilteredItems=function(t){var o,n,r,i;if(this.filterItemMap[t]){for(o=[],n=[],r=0;r<this.filterItemMap.length;r++)r===t?o=o.concat(this.filterItemMap[r]):n=n.concat(this.filterItemMap[r]);for(r=0;r<o.length;r++)i=o[r],e.ArrayHelper.contains(n,i)||e.ArrayHelper.remove(this.filteredItems,i)}},t.prototype._removeFilteredInRowsWithColumnIndex=function(t){var o,n;for(o in this.filteredInRowsWithColIndexs)o&&((n=this.filteredInRowsWithColIndexs[o])&&e.ArrayHelper.contains(n,t)&&(e.ArrayHelper.remove(n,t),0===n.length&&(this.filteredInRowsWithColIndexs[o]=i)))},t.prototype._FilterRowsWithTextEquals=function(t,o,n,r){for(var i,a,s,l={},u=this.filterItemMap[n],c=[],h=0;h<u.length;h++)(i=u[h])instanceof e.TextCondition&&(0===(a=i).compareType&&!1===a.forceValue2Text&&!1===a.useWildCards&&!1===a.ignoreCase&&!1===a.ignoreBlank)?l[a.expected]=a:c.push(i);for(s=t;s<t+o;s++)this.isRowFilteredOut(s)||l[r[s].T]&&(this._addFilteredInRowsWithColumnIndex(s,n),this._addFilteredItem(i));return c},t.prototype._filterRowByCell=function(t,o,n,r){for(var i,a,s,l=this,u=0;u<t.length;u++)if("RelationCondition"===(i=t[u]).conditionType||i instanceof e.RelationCondition?(i.item1&&(a=l._getActualValueFromCache(i.item1,o,n,r),"Top10Condition"===i.item1.conditionType||i.item1 instanceof e.Top10Condition?i.item1.ranges=l._getReviseRanges(n,l.range):("AverageCondition"===i.item1.conditionType||i.item1 instanceof e.AverageCondition)&&(i.item1.ranges=l._getReviseRanges(n,l.range))),i.item2&&(s=l._getActualValueFromCache(i.item2,o,n,r),"Top10Condition"===i.item2.conditionType||i.item2 instanceof e.Top10Condition?i.item2.ranges=l._getReviseRanges(n,l.range):("AverageCondition"===i.item2.conditionType||i.item2 instanceof e.AverageCondition)&&(i.item2.ranges=l._getReviseRanges(n,l.range)))):(a=l._getActualValueFromCache(i,o,n,r),"Top10Condition"===i.conditionType||i instanceof e.Top10Condition?i.ranges=l._getReviseRanges(n,l.range):("AverageCondition"===i.conditionType||i instanceof e.AverageCondition)&&(i.ranges=l._getReviseRanges(n,l.range))),i.evaluate(l.sheet,o,n,a,s)){l._addFilteredInRowsWithColumnIndex(o,n),l._addFilteredItem(i);break}},t.prototype._getActualValueFromCache=function(e,t,o,n){var i=r;return"TextCondition"===e.conditionType||"TextLengthCondition"===e.conditionType?i=n[t].T:"ColorCondition"===e.conditionType?0===e.compareType?i=n[t].BC:1===e.compareType&&(i=n[t].FC):i=n[t].V,i},t.prototype._getReviseRanges=function(t,o){var n,r=[];return o&&((n=this.sheet._getActualRange(o)).col<=t&&t<n.col+n.colCount&&r.push(new e.Range(n.row,t,n.rowCount,1))),r},t.prototype._getCandindateDataItems=function(e,t){var o,n,r,i=this.sheet,a=[],s={},l=i._getActualRange(this.range);if(e<l.col||e>l.col+l.colCount-1)return a;for(o=!1,n=l.row;n<l.row+l.rowCount;n++)""!==(r=i.getText(n,e))?s[r]||(this.isRowFilteredOut(n)&&(!this.isFiltered()||this.isLastFilteredColumn(e)&&this._isRowfilteredOutByColumn(n,e))?(a.push(r),s[r]=!0):i.getRowHeight(n,3)>0&&(a.push(r),s[r]=!0)):o=!0;return o&&t&&(t.hasBlank=!0),a},t.prototype._isRowfilteredOutByColumn=function(t,o){var n,r,i;return 0!==this.filteredColumns.length&&(!!this.filteredInRowsWithColIndexs&&(n=-1,(r=e.ArrayHelper.indexOf(this.filteredColumns,o))>0&&(n=this.filteredColumns[r-1]),i=this.filteredInRowsWithColIndexs[t],n>-1?!(!i||0===i.length)&&n===i[i.length-1]:!i||0===i.length))},t.prototype._addRows=function(t,o){var n,r,a,s,l,u,c,h,p;if(this.range){if(n=this.sheet.getRowCount()-o-1,this.range.row>-1&&(n=(r=this.range).row+r.rowCount-1,r.row>=t?this._setRangeInternal(new e.Range(r.row+o,r.col,r.rowCount,r.colCount)):r.row<t&&t<r.row+r.rowCount&&this._setRangeInternal(new e.Range(r.row,r.col,r.rowCount+o,r.colCount))),a=this.filteredInRowsWithColIndexs,this.isFiltered()&&a){for(l in s=[],a)a.hasOwnProperty(l)&&s.push(parseInt(l));for(s.sort(),u=0,c=s.length;u<c;u++)(h=s[u])>=t&&h<=n&&(p=a[h],a[h+o]=p,a[h]=i)}this.reFilter()}},t.prototype._addColumns=function(t,o){var n,r,i,a,s,l,u=this;if(u.range){if(t>=0&&u._isSortted()){for(r=0,i=0;i<o;i++)(n=i+t)<=u._sorttedColumn()&&r++;u._sorttedColumn(u._sorttedColumn()+r)}var c=-1,h=0,p=u.range;for(p.col>-1&&(p.col>=t?(c=u.range.col,u._setRangeInternal(new e.Range(p.row,p.col+o,p.rowCount,p.colCount)),h=u.range.colCount):p.col<t&&t<p.col+p.colCount&&(c=t,h=p.colCount-(t-p.col),u._setRangeInternal(new e.Range(p.row,p.col,p.rowCount,p.colCount+o)))),c<0&&(c=0,h=u.sheet.getColumnCount()-o),n=c+h-1;n>=c;n--)n>=t&&(a=n+o,(s=e.ArrayHelper.indexOf(u.filteredColumns,n))>=0&&(u.filteredColumns[s]=a),(l=u.filterItemMap[n])&&l.length>0&&(e.ArrayHelper.remove(u.filterItemMap,n),u.filterItemMap[a]=l));u.reFilter()}},t.prototype._removeRows=function(t,o){var n,a,s,l,u,c,h,p=this;if(p.range){if(n=0,a=p.sheet.getRowCount()+o-1,p.range.row>-1&&(n=(s=p.range).row,a=s.row+s.rowCount-1,s.row>=t?s.row===t+1?p._setRangeInternal(r):s.row+s.rowCount<=t+o?p._setRangeInternal(r):s.row<t+o?p._setRangeInternal(new e.Range(t,s.col,s.row+s.rowCount-(t+o),s.colCount)):p._setRangeInternal(new e.Range(s.row-o,s.col,s.rowCount,s.colCount)):s.row<t&&t<s.row+s.rowCount&&p._setRangeInternal(new e.Range(s.row,s.col,s.rowCount-Math.min(s.row+s.rowCount-t,o),s.colCount))),l=p.filteredInRowsWithColIndexs,p.isFiltered()&&l)for(u=n;u<=a;u++){if(u<t)continue;u<t+o?l[u]=i:(h=l[c=u])&&(l[c-o]=h,l[c]=i)}p.reFilter()}},t.prototype._setRangeInternal=function(e){this.range=e},t.prototype._updateRange=function(e){var t,o,n,a=this,s=a.sheet,l=a.range;if(l)if(e){if(!e.equals(l)){var u=l.col,c=l.colCount,h=e.col,p=e.colCount;if((!(u<0)||!(h<0))&&a.isFiltered())for(u<0&&(u=0,c=s.getColumnCount()),h<0&&(h=0,p=s.getColumnCount()),o=0;o<c;o++)h<=(t=u+o)&&t<h+p||a.removeFilterItems(t);var d=l.row,f=l.rowCount,g=e.row,m=e.rowCount;if((!(d<0)||!(g<0))&&a.isFiltered()&&a.filteredInRowsWithColIndexs)for(d<0&&(d=0,f=s.getRowCount()),g<0&&(g=0,m=s.getRowCount()),o=0;o<f;o++)g<=(n=d+o)&&n<g+m||(a.filteredInRowsWithColIndexs[n]=i)}}else a.reset();a._isSortted()&&(e&&e.contains(-1,a._sorttedColumn())||(a.sortInfo=r)),a._setRangeInternal(e)},t.prototype._removeColumns=function(t,o){var n,i,a,s,l,u=this;if(u.range){t>=0&&u._isSortted()&&(t<=u._sorttedColumn()&&u._sorttedColumn()<t+o?u._sorttedColumn(-1):u._sorttedColumn()>=t&&u._sorttedColumn(u._sorttedColumn()-o));var c=u.range,h=c.col,p=c.colCount;for(h<0?(h=0,p=u.sheet.getColumnCount()+o):p=u.range.colCount,n=t+o,i=h;i<h+p;i++)i>=t&&(i<n?u.removeFilterItems(i):(a=i-o,(s=e.ArrayHelper.indexOf(u.filteredColumns,i))>=0&&(u.filteredColumns[s]=a),(l=u.filterItemMap[i])&&l.length>0&&(e.ArrayHelper.remove(u.filterItemMap,i),u.filterItemMap[a]=l)));c.col>=0&&(t<c.col?n<=c.col?u._setRangeInternal(new e.Range(c.row,c.col-o,c.rowCount,c.colCount)):n<=c.col+c.colCount?u._setRangeInternal(new e.Range(c.row,t,c.rowCount,c.col+c.colCount-n)):u._setRangeInternal(r):t<c.col+c.colCount&&(n<=c.col+c.colCount?u._setRangeInternal(new e.Range(c.row,c.col,c.rowCount,c.colCount-o)):u._setRangeInternal(new e.Range(c.row,c.col,c.rowCount,t-c.col)))),u.reFilter()}},t.prototype._isSortted=function(){return!!this.sortInfo&&(this.sortInfo.index>-1&&0!==this.getSortState(this.sortInfo.index))},t.prototype._sorttedColumn=function(e){return 0===arguments.length?this.sortInfo?this.sortInfo.index:-1:(this.sortInfo?this.sortInfo.index=e:this.sortInfo={index:e,ascending:!1},this)},t.prototype._clear=function(t,o,n,r){var i,a,s;this.range&&(i=new e.Range(t,o,n,r),this.filterButtonVisible()?(a=this.range.row-1,s=this.range.rowCount+1,a<0&&(a=-1,s=-1),i.containsRange(new e.Range(a,this.range.col,s,this.range.colCount))&&this.unfilter()):i.containsRange(this.range)&&this.unfilter())},t.prototype._getConditionTypeDictionary=function(){if(!this._ruleTypeDictionary){var t={};t[0]=e.RelationCondition,t[1]=e.NumberCondition,t[2]=e.TextCondition,t[3]=e.ColorCondition,t[4]=e.FormulaCondition,t[5]=e.DateCondition,t[6]=e.DateExCondition,t[7]=e.TextLengthCondition,t[8]=e.Top10Condition,t[9]=e.UniqueCondition,t[10]=e.AverageCondition,t[11]=e.CellValueCondition,t[12]=e.AreaCondition,this._ruleTypeDictionary=t}return this._ruleTypeDictionary},t.prototype.fromJSON=function(t,o){var n,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x;if(t){if(n=this,(a=t.range)&&(n.range=new e.Range(a.row,a.col,a.rowCount,a.colCount)),s=t.filterItemMap,l=n.filterItemMap,e.features.conditionalFormat&&s)for(x=0;x<s.length;x++)if((u=s[x].conditions)&&0!==u.length)for(c=0;c<u.length;c++)(h=u[c])&&((p=n._getConditionTypeDictionary()[h.conType])&&((d=new p).fromJSON(h,o),(g=l[f=s[x].index])||(g=l[f]=[]),g.push(d)));if(t.filteredColumns?m=t.filteredColumns:t.filteredColMap&&(m=t.filteredColMap),m)for(x=0;x<m.length;x++)(_=m[x])!==i&&_!==r&&n.filteredColumns.push(_);if((y=t.sortInfo)&&(n.sortInfo={index:y.index,ascending:y.ascending}),(C=t.showFilterButton)!==i)if((w=t.filterButtonVisibleInfo)!==i)n.filterButtonVisibleInfo=w;else if(n.range)for(v=n._getStartCol(),S=n._getEndCol(),x=v;x<S;x++)n.filterButtonVisibleInfo[x]=C}},t.prototype.toJSON=function(){var e,t,o,n,i,a,s,l,u,c,h,p,d,f={},g=this.range;for(g&&(f.range=g),(e=this.typeName)&&(f.typeName=e),t=[],o=0,n=0;o<this.filterItemMap.length;o++)if(i=this.filterItemMap[o]){for(a=[],s=0;s<i.length;s++)l=i[s],a.push(l?l.toJSON():r);t[n++]={index:o,conditions:a}}if(t.length>0&&(f.filterItemMap=t),(u=this.filteredColumns).length>0&&(f.filteredColumns=u),(c=this.sortInfo)&&(f.sortInfo=c),h=this.filterButtonVisibleInfo){for(d in f.filterButtonVisibleInfo=h,p=!1,h)if(h[d]){p=!0;break}f.showFilterButton=p}return f},t.prototype.canDoFilter=function(){return!this.sheet||!this.sheet.isProtected||this.sheet.protectionOption().allowFilter},t}();e.RowFilterBase=a,t=function(t){function o(e){t.call(this,e)}return __extends(o,t),o.prototype.isHideRowFilter=function(){return!0},o.prototype.updateRowVisibleInfo=function(e,t){var o,n,r,i,a,s,l=this.sheet;if(l&&l.filterRowsVisibleInfo){for(o=[],n=l.filterRowsVisibleInfo,r=0,i=e.length;r<i;r++)n.setRowVisible(e[r],!0)&&o.push(e[r]);for(a=0,s=t.length;a<s;a++)n.setRowVisible(t[a],!1)&&o.push(t[a]);l.recalcRows(o)}},o.prototype.onFilter=function(e){this.updateRowVisibleInfo(e.filteredRows,e.filteredOutRows),this.sheet&&this.sheet._invalidateVScrollbar()},o.prototype.openFilterDialog=function(t){if(this.canDoFilter()){var o=this.sheet,n=new e._GcFilterDialog(o.parent._getContainerDiv(),o,t);o._filterDialiog=n,n.open()}},o}(a),e.HideRowFilter=t,o=function(){function e(){this.reset()}return e.prototype.getRowVisible=function(e){var t=!0,o=this.rowsVisibleInfo[e];return o!==i&&o!==r&&(t=o),t},e.prototype.setRowVisible=function(e,t){var o=this.rowsVisibleInfo[e];return o!==i&&o!==r&&t?(delete this.rowsVisibleInfo[e],this.filterOutRowCount--,!0):!t&&t!=o&&(this.rowsVisibleInfo[e]=t,this.filterOutRowCount++,!0)},e.prototype.reset=function(){this.rowsVisibleInfo={},this.filterOutRowCount=0},e.prototype.hasFilterOut=function(){return 0!==this.filterOutRowCount},e}(),e.FilterRowsVisibleInfo=o,n=function(e){function t(t){e.call(this),this._table=t,t&&(this.sheet=t._getSheet())}return __extends(t,e),t.prototype._getStartCol=function(){return 0},t.prototype._getEndCol=function(){return this.range.colCount},t.prototype.table=function(e){if(0===arguments.length)return this._table;this._table=e,e&&(this.sheet=e._getSheet())},t.prototype._addRows=function(t,o){e.prototype._addRows.call(this,t,o),this._table&&this._setRangeInternal(this._table.dataRange())},t.prototype._removeRows=function(t,o){e.prototype._removeRows.call(this,t,o),this._table&&this._setRangeInternal(this._table.dataRange())},t}(t),e._TableFilter=n}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){function t(t,o,n,r){return new e.Range(t,o,n,r)}function o(t){return new e._DateTimeHelper(t)}function n(t){return"string"!=typeof t&&e.FormatConverter.IsNumber(t)}function r(t){return e._DateTimeHelper.fromOADate(t)}e.feature("fill",["core.common","core.globalize","core.stringResource"]);var i,a,s=null,l=void 0,u=Math.abs,c=Math.min,h=Math.floor;(i=e.FillType||(e.FillType={}))[i.Direction=0]="Direction",i[i.Linear=1]="Linear",i[i.Growth=2]="Growth",i[i.Date=3]="Date",i[i.Auto=4]="Auto",e.FillType,(a=e.FillDateUnit||(e.FillDateUnit={}))[a.Day=0]="Day",a[a.Weekday=1]="Weekday",a[a.Month=2]="Month",a[a.Year=3]="Year",e.FillDateUnit;var p=function(){return function(e){this._sheet=e}}(),d=function(){function t(e){this._indexes=[],this._innerValues=[],this._type=s,this._startIndex=e===l||e===s?-1:e}return t.prototype.dataCount=function(){return this._innerValues.length},t.prototype.values=function(){var e,t,o,n;if(this._innerValues.length>0){for(e=[],t=0;t<this._innerValues.length;t++)o=this._innerValues[t],n="object"===this._type?this.toDateTime(o):o,e.push(n);return e}return[]},t.prototype.indexes2=function(){var t,o,n,r=this._indexes.length;if(r>0&&e.util.hasCalc()){for(-1===(t=this._startIndex)&&(t=this._indexes[0]),(o=new Array(1))[0]=new Array(r),n=0;n<r;n++)o[0][n]=this._indexes[n]-t+1;return new e.Calc._ConcreteArray(o,r)}return s},t.prototype.values2=function(){var t,o=this._innerValues.length;return o>0&&e.util.hasCalc()?(t=[this._innerValues],new e.Calc._ConcreteArray(t,o)):s},t.prototype.insert=function(t,o,r){if(!n(r))throw new Error(e.SR.Exp_NumberOnly);(this._type===l||this._type===s)&&(this._type=r instanceof Date?"date":"number"),e.ArrayHelper.insert(this._indexes,t,o),e.ArrayHelper.insert(this._innerValues,t,this.toDouble(r))},t.prototype.add=function(e,t){(this._type===l||this._type===s)&&(this._type=t instanceof Date?"date":"number"),this._indexes.push(e),this._innerValues.push(this.toDouble(t))},t.prototype.toActualValue=function(e){return"date"===this._type?this.toDateTime(e):e},t.prototype.toDouble=function(t){return e.FormatConverter.ToDouble(t)},t.prototype.toDateTime=function(t){var o=s;if(t instanceof Date)o=t;else if(e.util.hasCalc())try{o=e.Calc.Convert.DT(t)}catch(e){o=t}return o},t}(),f=function(){function t(){}return t.bindStandardFunction=function(t,o,n,r,i,a){return function(t,n,r,i){if(!e.util.hasCalc())return s;var a=e.Calc.Functions.findGlobalFunction(o).evaluate([n,r,i]).getValue(0,0);return"number"==typeof a&&a.toString().length>=13?+a.toPrecision(13):a}(0,r,i,a)},t.TREND=function(e,o,n,r){return t.bindStandardFunction(this,"Trend",e,o,n,r)},t.GROWTH=function(e,o,n,r){return t.bindStandardFunction(this,"Growth",e,o,n,r)},t}(),g=function(){function i(e){this._worksheet=e,this._fillCache=new p(e)}return i.prototype.fillLinear=function(e,t,o,n){o!==l&&o!==s||n!==l&&n!==s?this.seriesFillRange(e,t,1,o,n,s):this.seriesTrendFillRange(e,t,1)},i.prototype.fillGrowth=function(e,t,o,n){o!==l&&o!==s||n!==l&&n!==s?this.seriesFillRange(e,t,2,o,n,s):this.seriesTrendFillRange(e,t,2)},i.prototype.fillDate=function(e,t,o,n,r){this.seriesFillRange(e,t,3,n,r,o)},i.prototype.seriesTrendFillRange=function(t,o,n,r){var i,a,s,l,u,c=this,h=c.fixRange(t),p=h.row,d=h.col,f=h.rowCount,g=h.colCount;if(c._worksheet._getSpanModel().hasSpans(p,d,f,g))throw new Error(e.SR.Exp_RangeContainsMergedCell);if(1===o){for(l=p;l<p+f;l++)if((i=c.getSeriesSource(l,d,1,g,o))&&i.dataCount()>0&&((a=c.calcSeriesTrendData(i,g,n))&&a.length>0))for(s=0;s<a.length;s++){if(r)return i.toActualValue(a[s]);c.copyCell(c._worksheet,l,i._indexes[0],l,d+s,i.toActualValue(a[s]),n)}}else if(0===o)for(u=d;u<d+g;u++)if((i=c.getSeriesSource(p,u,f,1,o))&&i.dataCount()>0&&((a=c.calcSeriesTrendData(i,f,n))&&a.length>0))for(s=0;s<a.length;s++){if(r)return i.toActualValue(a[s]);c.copyCell(c._worksheet,i._indexes[0],u,p+s,u,i.toActualValue(a[s]),n)}},i.prototype.getSeriesSource=function(e,t,o,r,i){var a,l,u,c=s;if(1===i)for(l=t+r-1;l>=t;)n(a=this._worksheet.getValue(e,l))&&(c||(c=new d(t)),c.insert(0,l,a)),l--;else if(0===i)for(u=e+o-1;u>=e;)n(a=this._worksheet.getValue(u,t))&&(c||(c=new d(e)),c.insert(0,u,a)),u--;return c},i.prototype.calcSeriesTrendData=function(t,o,n){var r,i;if(t&&t.dataCount()>0&&e.util.hasCalc()&&(1===n||2===n)){for(r=[],1===t.dataCount()&&(1===n?t.add(t._indexes[0]+1,t.toActualValue(t._innerValues[0]+1)):2===n&&t.add(t._indexes[0]+1,t.values()[0])),i=0;i<o;i++)1===n?r.push(f.TREND(this._worksheet,t.values2(),t.indexes2(),i+1)):2===n&&r.push(f.GROWTH(this._worksheet,t.values2(),t.indexes2(),i+1));return r}return s},i.prototype.fillAuto=function(t,o,n){var r,i=this._worksheet,a=this.fixRange(t),s=a.row,l=a.col,u=a.rowCount,c=a.colCount,h=this.fixRange(i._eventHandler._dragFillStartRange);if(h){if(this._worksheet._getSpanModel().hasPartSpans(h.row,h.col,h.rowCount,h.colCount)||this._worksheet._getSpanModel().hasPartSpans(s,l,u,c))throw new Error(e.SR.Exp_ChangeMergedCell);return r=!0,(s<h.row||l<h.col)&&(r=!1),this.autoFillRange(h,u,c,o,n,r)}},i.prototype.fixRange=function(e){var o=e.row,n=e.col,r=e.rowCount,i=e.colCount;return-1===o&&(o=0,r=this._worksheet.getRowCount()),-1===n&&(n=0,i=this._worksheet.getColumnCount()),t(o,n,r,i)},i.prototype.autoFillRange=function(e,o,n,r,i,a){var l,u,c,p,d=a?1:-1;if(1===r){if(l=h(n/e.colCount),u=n%e.colCount,l>1&&!i)for(p=1;p<l;p++)c=t(e.row,e.col+p*d*e.colCount,e.rowCount,e.colCount),this.copyRange(e,c,r,4,i);if(i&&l>1&&0===u&&(l-=1,u=e.colCount),l>0&&u>0)return c=t(e.row,a?e.col+l*e.colCount:e.col-l*e.colCount+e.colCount-u,e.rowCount,u),this.copyRange(e,c,r,4,i,a,s,a?0:e.colCount-u)}else if(0===r){if(l=h(o/e.rowCount),u=o%e.rowCount,l>1&&!i)for(p=1;p<l;p++)c=t(e.row+p*d*e.rowCount,e.col,e.rowCount,e.colCount),this.copyRange(e,c,r,4,i,s,s,s,!0);if(i&&l>1&&0===u&&(l-=1,u=e.rowCount),l>0&&u>0)return c=t(a?e.row+l*e.rowCount:e.row-l*e.rowCount+e.rowCount-u,e.col,u,e.colCount),this.copyRange(e,c,r,4,i,a,a?0:e.rowCount-u,s,!0)}},i.prototype.copyRange=function(e,t,o,r,i,a,l,u,c){var h,p,f,g,m,_,y,C,w,v,S,x=this._worksheet,R=s,b=s;if(1===o)for(h=0;h<e.rowCount;h++){for(R=s,b=s,g=e.row+h,m=t.row+h,u=u||0,p=0;p<e.colCount;)if(f=e.col+p,_=t.col+p-u,y=s,(C=x.getFormula(g,f))&&""!==C||(y=x.getValue(g,f)),4===r&&n(y)&&(R||(R=new d),w=s,w=y instanceof Date?"date":"number",b||(b=w),b===w))R.add(f,y),p++;else if(y&&R&&R.dataCount()>0){if(S=this.autoFillRowTrendValues(e,t,g,m,R,i,a,u),i&&S!==s)return S;R=s,b=s}else if(v=x._getSpanModel().find(g,f)){if(v.row===g)if(i){if(_===t.col+t.colCount-1)return y}else _<t.col+t.colCount&&_>=t.col&&this.copyCell(x,g,f,m,_,y,r);p+=v.colCount}else{if(i){if(a&&_===t.col+t.colCount-1)return y;if(!a&&_===t.col)return y}else _<t.col+t.colCount&&_>=t.col&&this.copyCell(x,g,f,m,_,y,r);p++}if(R&&R.dataCount()>0&&(S=this.autoFillRowTrendValues(e,t,g,m,R,i,a,u),i&&S!==s))return S}else if(0===o)for(p=0;p<e.colCount;p++){for(R=s,b=s,f=e.col+p,_=t.col+p,l=l||0,h=0;h<e.rowCount;)if(g=e.row+h,m=t.row+h-l,y=s,(C=x.getFormula(g,f))&&""!==C||(y=x.getValue(g,f)),4===r&&n(y)&&(R||(R=new d),w=s,w=y instanceof Date?"date":"number",b||(b=w),b===w))R.add(g,y),h++;else if(y&&R&&R.dataCount()>0){if(S=this.autoFillColumnTrendValues(e,t,f,_,R,i,a,l,c),i&&S!==s)return S;R=s,b=s}else if(v=x._getSpanModel().find(g,f)){if(v.col===f)if(i){if(m===t.row+t.rowCount-1)return y}else m<t.row+t.rowCount&&m>=t.row&&(c&&x.isRowFilterOut(m)||this.copyCell(x,g,f,m,_,y,r));h+=v.rowCount}else{if(i){if(a&&m===t.row+t.rowCount-1)return y;if(!a&&m===t.row)return y}else m<t.row+t.rowCount&&m>=t.row&&(c&&x.isRowFilterOut(m)||this.copyCell(x,g,f,m,_,y,r));h++}if(R&&R.dataCount()>0&&(S=this.autoFillColumnTrendValues(e,t,f,_,R,i,a,l,c),i&&S!==s))return S}return s},i.prototype.autoFillRowTrendValues=function(t,o,n,r,i,a,l,u){var c,h,p,d,g,m,_,y,C,w,v=this._worksheet;if(i&&i.dataCount()>0&&e.util.hasCalc())if(m=(o.col-t.col)/t.colCount,this.isArithmeticProgression(i._indexes,i._innerValues)){for(_=i.values2(),y=new Array(1),c=i.dataCount(),y[0]=new Array(c),h=0;h<c;h++)y[0][h]=h+1;for(C=new e.Calc._ConcreteArray(y,c),h=0;h<c;h++)if(p=f.TREND(v,_,C,c*m+h+1),g=(d=i._indexes[h])+m*t.colCount,a){if(l&&g===o.col+o.colCount-1)return i.toActualValue(p);if(!l&&g===o.col)return i.toActualValue(p)}else g<o.col+o.colCount&&g>=o.col&&this.copyCell(v,n,d,r,g,i.toActualValue(p),4)}else for(w=i._indexes[0],c=i._indexes[i.dataCount()-1]-w+1,1===i.dataCount()&&i.add(i._indexes[0]+1,i.toActualValue(i._innerValues[0]+1)),h=0;h<c;h++)if(p=f.TREND(v,i.values2(),i.indexes2(),c*m+h+1),g=(d=w+h)+m*t.colCount,a){if(g===o.col+o.colCount-1)return i.toActualValue(p)}else g<o.col+o.colCount&&g>=o.col&&this.copyCell(v,n,d,r,g,i.toActualValue(p),4);return s},i.prototype.copyCell=function(t,o,n,r,i,a,l){var u,c,h;(t.hasFormula(o,n)||t.hasFormula(r,i))&&(t.setFormula(r,i,s),(0===l||4===l)&&(t.getFormula(o,n)&&t._copyFormula(o,n,r,i,1,1))),t.setValue(r,i,a),(u=t.getCompositeStyle(o,n))?((c=new e.Style).copyFrom(u),t.setStyleWithoutLocked(r,i,c,3)):t.setStyleWithoutLocked(r,i,s,3),t._getSpanModel().isEmpty()||(t.removeSpan(r,i,3),(h=t._getSpanModel().find(o,n))&&t._addSpanImp(r,i,h.rowCount,h.colCount,3))},i.prototype.autoFillColumnTrendValues=function(t,o,n,r,i,a,l,u,c){var h,p,d,g,m,_,y,C,w,v,S=this._worksheet;if(i&&i.dataCount()>0&&e.util.hasCalc())if(_=(o.row-t.row-u)/t.rowCount,this.isArithmeticProgression(i._indexes,i._innerValues)){for(y=i.values2(),C=new Array(1),h=i.dataCount(),C[0]=new Array(h),p=0;p<h;p++)C[0][p]=p+1;for(w=new e.Calc._ConcreteArray(C,h),p=0;p<h;p++)if(d=f.TREND(S,y,w,h*_+p+1),m=(g=i._indexes[p])+_*t.rowCount,a){if(l&&m===o.row+o.rowCount-1||!l&&m===o.row)return i.toActualValue(d)}else m<o.row+o.rowCount&&m>=o.row&&(c&&S.isRowFilterOut(m)||this.copyCell(S,g,n,m,r,i.toActualValue(d),4))}else for(v=i._indexes[0],h=i._indexes[i.dataCount()-1]-v+1,1===i.dataCount()&&i.add(i._indexes[0]+1,i.toActualValue(i._innerValues[0]+1)),p=0;p<h;p++)if(d=f.TREND(S,i.values2(),i.indexes2(),h*_+p+1),m=(g=v+p)+_*t.rowCount,a){if(m+u===o.row+o.rowCount-1)return i.toActualValue(d)}else m<o.row+o.rowCount&&m>=o.row&&(c&&S.isRowFilterOut(m)||this.copyCell(S,v,n,m,r,i.toActualValue(d),4));return s},i.prototype.isArithmeticProgression=function(e,t){var o,n,r,i;if(e.length!==t.length)return!1;if((o=t.length)<=1)return!1;if(2===o)return!0;for(n=e[1]-e[0],r=t[1]-t[0],i=2;i<o;i++)if(e[i]-e[i-1]!==n||t[i]-t[i-1]!==r)return!1;return!0},i.prototype.fillAutobyDirection=function(e,t){var o=this.fixRange(e),n=o.row,r=o.col,i=o.rowCount,a=o.colCount,s=this.getDirectionFillSourceRange(n,r,i,a,t);s&&this.directionFillRange(s,n,r,i,a,t)},i.prototype.directionFillRange=function(o,n,r,i,a,s){var l,u,c,p=e.SR.Exp_TargetContainsMergedCells,d=e.SR.Exp_MergedCellsIdentical;if(0===s){if(this._worksheet._getSpanModel().hasSpans(n,r,i,a-o.colCount))throw new Error(p);if(l=h(a/o.colCount),0!==a%o.colCount)throw new Error(d);if(l>1)for(c=1;c<l;c++)u=t(o.row,o.col-c*o.colCount,o.rowCount,o.colCount),this.copyRange(o,u,1,0)}else if(1===s){if(this._worksheet._getSpanModel().hasSpans(n,r+o.colCount,i,a-o.colCount))throw new Error(p);if(l=h(a/o.colCount),0!==a%o.colCount)throw new Error(d);if(l>1)for(c=1;c<l;c++)u=t(o.row,o.col+c*o.colCount,o.rowCount,o.colCount),this.copyRange(o,u,1,0)}else if(2===s){if(this._worksheet._getSpanModel().hasSpans(n,r,i-o.rowCount,a))throw new Error(p);if(l=h(i/o.rowCount),0!==i%o.rowCount)throw new Error(d);if(l>1)for(c=1;c<l;c++)u=t(o.row-c*o.rowCount,o.col,o.rowCount,o.colCount),this.copyRange(o,u,0,0)}else if(3===s){if(this._worksheet._getSpanModel().hasSpans(n+o.rowCount,r,i-o.rowCount,a))throw new Error(p);if(l=h(i/o.rowCount),0!==i%o.rowCount)throw new Error(d);if(l>1)for(c=1;c<l;c++)u=t(o.row+c*o.rowCount,o.col,o.rowCount,o.colCount),this.copyRange(o,u,0,0)}},i.prototype.getDirectionFillSourceRange=function(e,o,n,r,i){var a=s;return 0===i?a=t(e,o+r-1,n,1):1===i?a=t(e,o,n,1):2===i?a=t(e+n-1,o,1,r):3===i&&(a=t(e,o,1,r)),this.inflateCellRange(a)},i.prototype.inflateCellRange=function(e){var t=this._worksheet.getSpans();return t&&e&&(e=this._worksheet._cellRangeInflate(t,e)),e},i.prototype.seriesFillRange=function(t,o,n,r,i,a){var s,l,u,c,h,p=this,d=p.fixRange(t),f=d.row,g=d.col,m=d.rowCount,_=d.colCount;if(p._worksheet._getSpanModel().hasSpans(f,g,m,_))throw new Error(e.SR.Exp_RangeContainsMergedCell);if(1===o){for(c=f;c<f+m;c++)if((s=p.getSeriesSource(c,g,1,1,o))&&s.dataCount()>0&&((l=p.calcSeriesData(s,_,n,r,i,a))&&l.length>0))for(u=0;u<l.length;u++)p.copyCell(p._worksheet,c,s._indexes[0],c,g+u,s.toActualValue(l[u]),n)}else if(0===o)for(h=g;h<g+_;h++)if((s=p.getSeriesSource(f,h,1,1,o))&&s.dataCount()>0&&((l=p.calcSeriesData(s,m,n,r,i,a))&&l.length>0))for(u=0;u<l.length;u++)p.copyCell(p._worksheet,s._indexes[0],h,f+u,h,s.toActualValue(l[u]),n)},i.prototype.calcSeriesData=function(e,t,o,n,r,i){var a;if(e&&e.dataCount()>0){var u=[],c=e._innerValues[0],h=c;for(a=0;a<t;a++)(r===l||r===s||h<=r)&&(u.push(h),1===o?h+=n:2===o?h*=n:3===o&&i!==l&&i!==s&&(h=this.getNextDateValue(i,c,h,n,a+1)));return u}return s},i.prototype.getNextDateValue=function(e,t,n,i,a){var s,l,p=n;if(0===e)p=o((s=r(n)).setDate(s.getDate()+i)).toOADate();else if(1===e){for(s=r(n),l=u(i);l>0;)i>0?s.setDate(s.getDate()+c(1,l)):s.setDate(s.getDate()-c(1,l)),6!==s.getDay()&&0!==s.getDay()&&(l-=1);p=o(s).toOADate()}else 2===e?p=o((s=r(t)).setMonth(s.getMonth()+h(a*i))).toOADate():3===e&&(p=o((s=r(t)).setFullYear(s.getFullYear()+h(a*i))).toOADate());return p},i}();e.FillImp=g}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){var t,o,n,r;(t=e.Sheets||(e.Sheets={})).feature("fill_ui",["core.common","core.sheet_action","core.stringResource"]),(r=t._FillSmartTag||(t._FillSmartTag={}))[r.Tag=0]="Tag",r[r.Down=1]="Down",t._FillSmartTag,o=function(e){function o(o,n,r){e.call(this,o,t.util.getPreferredZIndex(n&&n.parent&&n.parent._host)),this.eventNameSpace=".ui-fill",this.fillKeyDown="keydown"+this.eventNameSpace,this.sheet=n,this.fillInfo=r,this._initTagDialog()}return __extends(o,e),o.prototype._initTagDialog=function(){this.tagContainer=this.getContainer().addClass("smart-tag-default tag-container no-user-select ui-widget-header btn btn-default"),this.smartTag=t.GC$(document.createElement("img")).attr("src",o.getImageSrc(0)).css("float","left").appendTo(this.tagContainer),this.smartTagDown=t.GC$(document.createElement("img")).attr("src",o.getImageSrc(1)).css("float","left").css("display","none").appendTo(this.tagContainer)},o.prototype._registerEvent=function(){var e,o=this,n=t.util.device(),r=t.util.browser.safari&&(n.ipad||n.iphone);o.tagContainer.bind("mouseover",function(){var e=o.sheet._isTouchMode,n=e?"38px":"32px",i=e?"24px":"18px";o.menuDialog&&o.menuDialog.isOpen()||(t.GC$(this).addClass("ui-state-hover smart-tag-hover"),t.GC$(this).css({width:n,height:i}),r||o.smartTagDown.show())}).bind("mouseout",function(){var e=o.sheet._isTouchMode,n=e?"24px":"18px",i=e?"24px":"18px";o.menuDialog&&o.menuDialog.isOpen()||(t.GC$(this).removeClass("ui-state-hover smart-tag-hover"),t.GC$(this).css({width:n,height:i}),r||o.smartTagDown.hide())}),e=function(){var e="ui-state-active smart-tag-active";o.menuDialog&&o.menuDialog.isOpen()?(r&&o.smartTagDown.hide(),t.GC$(this).removeClass(e),o._closeMenu()):(r&&o.smartTagDown.show(),t.GC$(this).addClass(e),o._openMenu(),o._initData())},o.tagContainer.bind("click",e),t.GC$(document).bind(o.fillKeyDown,function(e){27===e.keyCode&&(o.menuDialog&&o.menuDialog.isOpen()?o._closeMenu():o.close(),t.util.cancelDefault(e))})},o.prototype.open=function(){var e,t,o=this,n=o.sheet;if(o.tagContainer){e=o.fillInfo.x,t=o.fillInfo.y,o.tagContainer.css({left:e,top:t}),o.show(),o._registerEvent();var r=n._isTouchMode,i=r?"3px":"0px",a=r?"24px":"18px";o.smartTag.css("margin",i),o.smartTagDown.css("height",a),o._reset(),n.parent}},o.prototype._initData=function(){var e,o=this.fillInfo.fillType;this.menuContainer&&(e=this.menuContainer.find("input[type=radio]").getElement(o))&&!1===e.checked&&(e.checked=!0,t.GC$(e).trigger("change"))},o.prototype._openMenu=function(){var e=this;e.menuDialog||(e.menuDialog=new n(e.sheet.parent._getContainerDiv(),e.sheet),e.menuContainer=e.menuDialog.getContainer()),e.menuDialog.fillType=this.fillInfo.fillType;var t=e.tagContainer,o=t.css("left"),r=t.css("top"),i=parseFloat(r);isNaN(i)||(r=i+t.height()+2),e.menuContainer.css({left:o,top:r}),e.menuDialog.show(),e.menuDialog._attachEvent(),e.menuDialog.smartTagContainer.unbind("fillTypeChanged").bind("fillTypeChanged",function(t,o){e.fillInfo.fillType=o})},o.prototype._closeMenu=function(){this.menuDialog&&(this.menuDialog._dettachEvent(),this.menuDialog.close())},o.prototype._reset=function(){this.menuDialog&&(this.menuDialog.isOpen()&&this.tagContainer.trigger("click"),this.tagContainer.trigger("mouseout"))},o.prototype.close=function(){this._reset(),t.GC$(document).unbind(this.fillKeyDown),e.prototype.close.call(this),this.sheet&&this.sheet.setFocus()},o.getImageSrc=function(e){return 0===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAFJJREFUeNrclEEKACAIBOfp/Xy7i4WSRnRYBIVRVhFJVIhyEAxllQa5E/wBSnsU6Rza2nugqNmASi57C/KKNg/Iqn+iVWzx6M4bOdUEAAD//wMAAYRMfiNaiqEAAAAASUVORK5CYII=":1===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAASCAYAAACXScT7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGCSURBVHjafNFPKKRxHAbw5/v7GYdBYUQjLm5SkoNykCQHtcx431/KgdKumJvSrAO7Nwc3RQ5kd3OkHJC/hUJREluonVcToqRh3sRFPA6M1Mbhc3z6Pj1fkMRHQNJL0uPeul731lU37o1y49cqHr8GvvgWQRLBsmpM/P0j4XAXiooKcXl1CZDEzl4EJBEwAZBUwWAQsVgsFSRR11gmM8trimSa3WypzZ31l5v2/vfk/4oAcv9aSGyUSz4gg/AIAOET0YQswIQWaNrnH+2OeSaY0BJN2+wDTi/OpCrwkxX1vW8q63p5cnaaB+Z/09u7x0nFJTVMiEajPsNCQaC6Ryb8THKcw/Tikho6zj//0RGUNV6gMZ1H8fmpH5iTHDlwsiOhO7FrN5RdP6aBIUj/pvJ2bkFbkxAzBzELELNCQQqgrJ5ST1/jqmYOJcHa7dYYGV5TrQ3d+vfUU+b7IfrOIRCGBYD0o1VGmaHaB6DZkqvMD2hUfF1UAISkvE/+yqbCZ89+HgBtwgFOrBUzJgAAAABJRU5ErkJggg==":""},o}(t.BaseDialog),t._GcFillDialog=o,n=function(e){function o(o,n){e.call(this,o,t.util.getPreferredZIndex(n&&n.parent&&n.parent._host)),this.sheet=n,this.init()}return __extends(o,e),o.prototype.init=function(){this.itemClass="fill-type-item",this.menuClass="wijspread-fill-menu-container",this.smartTagContainer=t.GC$(".tag-container"),this._initMenuDialog()},o.prototype.show=function(){e.prototype.show.call(this)},o.prototype._initMenuDialog=function(){var e=this;e.menuContainer=e.getContainer(),e.menuContainer.addClass(e.menuClass),e.copyCells=e._createMenuItem("smartMenuCopyCells",e.itemClass,t.SR.CopyCells,"0",!0).appendTo(e.menuContainer),e.fillSeries=e._createMenuItem("smartMenuFillSeries",e.itemClass,t.SR.FillSeries,"1").appendTo(e.menuContainer),e.fillFormattingOnly=e._createMenuItem("smartMenuFillFormattingOnly",e.itemClass,t.SR.FillFormattingOnly,"2").appendTo(e.menuContainer),e.fillWithoutFormatting=e._createMenuItem("smartMenuFillWithoutFormatting",e.itemClass,t.SR.FillWithoutFormatting,"3").appendTo(e.menuContainer)},o.prototype._createMenuItem=function(e,o,n,r,i){var a=this.sheet._isTouchMode,s=a?"160px":"150px",l=a?"25px":"20px",u=t.GC$(document.createElement("div")).css({display:"block",width:s,height:l,padding:0,margin:0}).addClass("smartMenu-item-default "+o+" ui-state-default btn btn-default"),c=t.GC$(document.createElement("div")).addClass("menu-item-input").appendTo(u),h=t.GC$(document.createElement("div")).addClass("menu-item-text").appendTo(u),p=t.GC$(document.createElement("input")).attr({id:e,value:r,type:"radio",name:"fill-group",style:"display:none"}).appendTo(c);return t.GC$(document.createElement("span")).text(n).appendTo(h),i?(c.addClass("check-image ui-icon ui-icon-check"),p.prop("checked","checked")):p.prop("checked",""),u},o.prototype._attachEvent=function(){var e=this;t.GC$("."+e.itemClass).bind("mouseover",function(){t.GC$(this).addClass("ui-state-hover smartMenu-item-hover")}).bind("mouseout",function(){t.GC$(this).removeClass("ui-state-hover smartMenu-item-hover")}).bind("click",function(){var o,n=t.GC$(this).find("input[type=radio]"),r=n.getElement(0);r.checked=!0,n.trigger("change"),e.smartTagContainer.trigger("click"),e.smartTagContainer.trigger("mouseout"),t.GC$(this).removeClass("ui-state-hover smartMenu-item-hover"),o=parseInt(r.getAttribute("value"),10),e._changeFill(o)}),e.menuContainer.find("input[type=radio]").bind("change",function(){var e="ui-icon ui-icon-check check-image";t.GC$(".menu-item-input").removeClass(e),t.GC$(this).parent().addClass(e)})},o.prototype._dettachEvent=function(){t.GC$("."+this.itemClass).unbind("mouseover").unbind("mouseout").unbind("click"),this.menuContainer.find("input[type=radio]").unbind("change")},o.prototype._changeFill=function(e){var o,n;if(this.fillType!==e){this.fillType=e,(o=this.sheet)._skipCloseDragFillSmartTag=!0,o.suspendEvent();try{t.SpreadActions.undo.call(o)}finally{o.resumeEvent()}o._skipCloseDragFillSmartTag=!1,n=new t.UndoRedo.FillUndoAction(o,e,o._eventHandler._currentFillRange),o._doCommand(n),this.smartTagContainer.trigger("fillTypeChanged",e)}},o.prototype.isOpen=function(){return t.GC$("."+this.menuClass).length()>0},o}(t.BaseDialog);e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){var o,n,r;t.feature("search",["core.common","core.sheet_ui","core.stringResource"]);var i,a,s,l,u=null,c=Math.max,h=Math.min;(i=t.EnumeratorOption||(t.EnumeratorOption={}))[i.All=0]="All",i[i.HasValue=1]="HasValue",i[i.HasStyle=2]="HasStyle",t.EnumeratorOption,o=function(){function o(t,o){if(this.actualEndRow=-1,this.isActualEndRowSet=!1,this.isBlockRange=!1,this.options=1,!t)throw new Error(e.Sheets.SR.Exp_SheetIsNull);var n=this;n.worksheet=t,n.sheetArea=o.sheetArea,n.searchOrder=o.searchOrder,n.rowStart=o.rowStart,n.columnStart=o.columnStart,n.rowEnd=o.rowEnd,n.columnEnd=o.columnEnd,n.findBeginRow=o.findBeginRow,n.findBeginColumn=o.findBeginColumn,n.init(),n.block=n.worksheet}return o.prototype.init=function(){this.currentRow=-1,this.currentColumn=-1},o.prototype.moveNext=function(){var e=this;if(-1===e.currentRow&&-1===e.currentColumn&&e.rowStart<=e.rowEnd&&e.columnStart<=e.columnEnd&&(e.currentRow=e.findBeginRow,e.currentColumn=e.findBeginColumn,e.isIndexAcceptable(e.currentRow,e.currentColumn)&&!e.skipCurrent()))return!0;if(e.rowStart<=e.rowEnd&&e.columnStart<=e.columnEnd)for(;e.tryMoveNext();)if(!e.skipCurrent())return!0;return e.currentRow=-1,e.currentColumn=-1,!1},o.prototype.isIndexAcceptable=function(e,t){return!(!((1&this.options)>0&&this.block)||this.block.getValue(e,t,this.sheetArea)===u&&this.block.getFormula(e,t,this.sheetArea)===u&&this.block.getTag(e,t,this.sheetArea)===u)||0===this.options},o.prototype.skipCurrent=function(){return!1},o.prototype.tryMoveNext=function(){var e,t,o=this,n=o.currentRow,r=o.currentColumn,i=!1;return(1&o.options)>0&&(e={value:n},t={value:r},o.nextValue(e,t)&&(n=e.value,r=t.value,i=!0)),1===o.options&&(i?(o.currentRow=n,o.currentColumn=r):(o.currentRow=-1,o.currentColumn=-1)),!(-1===o.currentRow&&-1===o.currentColumn)},o.prototype.nextValue=function(e,t){for(;this.next(e,t);)if(this.isIndexAcceptable(e.value,t.value))return!0;return!1},o.prototype.nextZOrder=function(e,t,o){var n,r,i;if(e){if(-1!==(n=this.getNextNonEmptyColumnInRow(e,t.value,o.value+1))&&(o.value=n,this.isZOrderOver(t.value,o.value)))return!0;do{if(-1===(r=e.nextNonNullRow(t.value))||r>this.rowEnd?t.value=-1:(-1!==r&&(t.value=r),-1!==r&&r<t.value&&(t.value=r)),-1!==t.value){o.value=t.value===this.rowStart||this.isBlockRange?this.columnStart-1:-1;do{if(-1===(i=this.getNextNonEmptyColumnInRow(e,t.value,o.value+1))||i>this.columnEnd?o.value=-1:(-1!==i&&(o.value=i),-1!==i&&i<o.value&&(o.value=i)),-1!==o.value)return this.isZOrderOver(t.value,o.value)}while(-1!==o.value)}}while(-1!==t.value)}return!1},o.prototype.getNextNonEmptyColumnInRow=function(e,t,o){for(var n=o;n<=this.columnEnd;n++)if(e.getValue(t,n)!==u)return n;return-1},o.prototype.isZOrderOver=function(e,t){var o=this;return o.isBlockRange?e>=o.rowStart&&e<=o.getActualEndRow()&&t>=o.columnStart&&t<=o.actualEndColumn():!(e>o.getActualEndRow()||e===o.getActualEndRow()&&(t<0||t>o.actualEndColumn())||e<o.rowStart||e===o.rowStart&&t<o.columnStart)},o.prototype.getActualEndRow=function(){var e,t,o,n=this;return n.isActualEndRowSet?n.actualEndRow:(e=-1,t=!1,(1&n.options)>0&&n.block&&(o=n.block.getRowCount(n.sheetArea)-1,e=c(e,o),t=!0),e=t?h(e,n.rowEnd):n.rowEnd,n.actualEndRow=e,n.isActualEndRowSet=!0,n.actualEndRow)},o.prototype.actualEndColumn=function(){return this.columnEnd},o.prototype.next=function(e,t){var o,n,r=this;return 0===r.searchOrder?(o=r.getActualEndColumnZOrder(e.value),t.value+1<=o?(t.value+=1,r.isZOrderOver(e.value,t.value)):e.value+1<=r.getActualEndRow()&&(e.value+=1,t.value=r.isBlockRange?r.columnStart:0,r.isZOrderOver(e.value,t.value))):1===r.searchOrder&&(n=r.getActualEndRowNOrder(t.value),e.value+1<=n?(e.value+=1,r.isNOrderOver(e.value,t.value)):t.value+1<=r.actualEndColumn()&&(t.value+=1,e.value=r.isBlockRange?r.rowStart:0,r.isNOrderOver(e.value,t.value)))},o.prototype.getActualEndColumnZOrder=function(e){var t,o,n=this;return e>=n.rowStart&&e<=n.rowEnd?(t=-1,o=!1,(1&n.options)>0&&n.block&&(t=c(t,n.block.getColumnCount(n.sheetArea)-1),o=!0),e===n.rowEnd||n.isBlockRange?o?h(t,n.columnEnd):n.columnEnd:o?c(t,n.worksheet.getColumnCount(n.sheetArea)-1):n.worksheet.getColumnCount(n.sheetArea)-1):-1},o.prototype.getActualEndRowNOrder=function(e){var t,o,n=this;return e>=n.columnStart&&e<=n.columnEnd?(t=-1,o=!1,(1&n.options)>0&&n.block&&(t=c(t,n.rowEnd),o=!0),e===n.columnEnd||n.isBlockRange?o?h(t,n.rowEnd):n.rowEnd:o?c(t,n.worksheet.getRowCount(n.sheetArea)-1):n.worksheet.getRowCount(n.sheetArea)-1):-1},o.prototype.isNOrderOver=function(e,t){var o=this;return o.isBlockRange?e>=o.rowStart&&e<=o.getActualEndRow()&&t>=o.columnStart&&t<=o.actualEndColumn():!(t>o.actualEndColumn()||t===o.actualEndColumn()&&(e<0||e>o.getActualEndRow())||t<o.columnStart||t===o.columnStart&&e<o.rowStart)},o.prototype.current=function(){var e=this;return 0<=e.currentRow&&e.currentRow<e.worksheet.getRowCount(e.sheetArea)&&0<=e.currentColumn&&e.currentColumn<e.worksheet.getColumnCount(e.sheetArea)?new t.Cell(e.worksheet,e.currentRow,e.currentColumn,e.sheetArea):u},o}(),t.CellsEnumerator=o,n=function(){return function(){var e=this;e.startSheetIndex=-1,e.endSheetIndex=-1,e.searchString=u,e.searchFlags=0,e.searchOrder=0,e.searchTarget=1,e.sheetArea=3,e.rowStart=-1,e.columnStart=-1,e.rowEnd=-1,e.columnEnd=-1,e.findBeginRow=-1,e.findBeginColumn=-1}}(),t.SearchCondition=n,r=function(){return function(){this.searchFoundFlag=0,this.foundSheetIndex=-1,this.foundRowIndex=-1,this.foundColumnIndex=-1,this.foundString=u}}(),t.SearchResult=r,(a=t.SearchFlags||(t.SearchFlags={}))[a.None=0]="None",a[a.IgnoreCase=1]="IgnoreCase",a[a.ExactMatch=2]="ExactMatch",a[a.UseWildCards=4]="UseWildCards",a[a.BlockRange=8]="BlockRange",t.SearchFlags,(s=t.SearchOrder||(t.SearchOrder={}))[s.ZOrder=0]="ZOrder",s[s.NOrder=1]="NOrder",t.SearchOrder,(l=t.SearchFoundFlags||(t.SearchFoundFlags={}))[l.None=0]="None",l[l.CellText=1]="CellText",l[l.CellTag=4]="CellTag",l[l.CellFormula=8]="CellFormula",t.SearchFoundFlags}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){var t,o;e.feature("binding",["core.common"]);var n=null,r="undefined",i="function",a=function(){function e(e){this._source=e,this.__cellBindingSource__=!0}return e.prototype.setValue=function(e,t){this._source&&e&&o.setValueByPath(this._source,e,t)},e.prototype.getValue=function(e){return this._source&&e?o.getValueByPath(this._source,e):n},e.prototype.getSource=function(){return this._source},e}();e.CellBindingSource=a,t=function(){function t(e){this._init(),this._sheet=e}return t.prototype.bind=function(t){var o=this,n=o._dataSource;n&&e.GC$.isFunction(n.dispose)&&n.dispose(),o._unSubscribeHandlers(o._dataSourceSubscriptions),o._unSubscribeHandlers(o._dataItemSubscriptions),o._init(),o._dataSource=t,t&&(o._dataSourceType=o._getDataSourceType(t),o._dataItemType=o.getDataItemType(),o._sheet&&(t.subscribe&&o._dataSourceSubscriptions.push(t.subscribe(o._dataChangedhandler,o)),t.currentPosition&&t.currentPosition.subscribe&&o._dataSourceSubscriptions.push(t.currentPosition.subscribe(o._currentPositionChangedhandler,o)),o.doDataItemChanged()),o._fields=o._getFieldsInfo())},t.prototype.doDataItemChanged=function(){var t,o,i;if(this._sheet&&this._dataSource){var a=this._sheet,s=this._dataSource,l=this._dataSourceType;if(s&&e.GC$.getType(window.ko)!==r&&(this._unSubscribeHandlers(this._dataItemSubscriptions),t=n,3===l?(s.currentPosition&&(-1<=(o=a.getActiveRowIndex())&&o<s.count()&&s.currentPosition(o)),t=s.currentItem()):4===l||(t=s[a.getActiveColumnIndex()]),t))for(i in t)t[i]&&e.GC$.isFunction(t[i].subscribe)&&this._dataItemSubscriptions.push(t[i].subscribe(this._activeDataItemChangedhandler,n,n))}},t.prototype._activeDataItemChangedhandler=function(){this._sheet&&this._sheet.repaint()},t.prototype._unSubscribeHandlers=function(t){var o,n;if(t)for(o in t)(n=t[o])&&e.GC$.isFunction(n.dispose)&&n.dispose()},t.prototype.getRowCount=function(){return this._getDataLength()},t.prototype.getColumnCount=function(){var t,o,n;return this._fields?this._fields.length:(t=this._dataSource)&&(o=t[0],"null"===(n=e.GC$.getType(o))||"string"===n||"number"===n)?1:0},t.prototype.getSource=function(){return this._dataSource},t.prototype.getFields=function(){return this._fields},t.prototype.getDataItem=function(e){if(!this._dataSource)return n;var t=this._dataSource,o=this._dataSourceType;return 1===o?t[e]:4===o?n:2===o?t()[e]:3===o?t.item(e):n},t.prototype.getDataItemType=function(){var e,t,o;if(!this._dataItemType)for(e=this.getRowCount(),t=0;t<e;t++)if(o=this.getDataItem(t)){o.entityAspect&&o.entityType&&(this._dataItemType=o.entityType),this._dataItemType=o.constructor;break}return this._dataItemType},t.prototype.getValue=function(t,i){var a,s,l,u={value:n,hasBinding:!1};if(!this._dataSource)return u;var c,h,p=this._sheet,d="function",f=this._dataSource,g=this._dataSourceType;if(4!==g){if(t<0||this.getRowCount()<=t||(a=p?p.getColumnCount():this.getColumnCount(),i<0||a<=i))return u;p?(c=p._sheetModelManager.getColInfos()._getItems()[i])&&(h=c.name):this._fields&&(h=this._fields[i])}if(1===g){if(typeof(l=f[t])===r||l===n)return u;if(c&&typeof c.value===d)return{value:c.value(l),hasBinding:!0};if(h)return{value:o.getValueByPath(l,h),hasBinding:!0};if(("string"===e.GC$.getType(l)||e.GC$.isNumeric(l))&&0===i)return{value:l,hasBinding:!0}}else if(2===g){if(typeof(l=f()[t])===r||l===n)return u;if(c&&typeof c.value===d)return{value:c.value(l),hasBinding:!0};if(h)return{value:o.getValueByPath(l,h),hasBinding:!0};if(("string"===e.GC$.getType(l)||e.GC$.isNumeric(l))&&0===i)return{value:l,hasBinding:!0}}else if(4===g){if(s=p?p.getBindingPath(t,i):n)return{value:f.getValue(s),hasBinding:!0}}else if(3===g){if(typeof(l=f.item(t))===r||l===n)return u;if(c&&typeof c.value===d)return{value:c.value(l),hasBinding:!0};if(h)return{value:f.getProperty(l,h),hasBinding:!0}}return u},t.prototype.setValue=function(t,a,s){var l,u,c,h;if(!this._dataSource)return!1;var p,d,f=this._sheet,g=this._dataSource,m=this._dataSourceType;e._DataSourceType;if(4!==m){if(t<0||this.getRowCount()<=t||(l=f?f.getColumnCount():this.getColumnCount(),a<0||l<=a))return!1;f?(p=f._sheetModelManager.getColInfos()._getItems()[a])&&(d=p.name):this._fields&&(d=this._fields[a])}return u=!1,1===m?(h=g[t])!==n&&typeof h!==r&&(p&&typeof p.value===i?(p.value(h,s),u=!0):d?(o.setValueByPath(h,d,s),u=!0):("string"===e.GC$.getType(h)||e.GC$.isNumeric(h))&&0===a&&(g[t]=s,u=!0)):2===m?(h=g()[t])!==n&&typeof h!==r&&(p&&typeof p.value===i?(p.value(h,s),u=!0):d?(o.setValueByPath(h,d,s),u=!0):("string"===e.GC$.getType(h)||e.GC$.isNumeric(h))&&0===a&&(g()[t]=s,u=!0)):4===m?(c=f?f.getBindingPath(t,a):n)&&(g.setValue(c,s),u=!0):3===m&&((h=g.item(t))!==n&&typeof h!==r&&(p&&typeof p.value===i?(p.value(h,s),u=!0):d&&(g.setProperty(h,d,s),u=!0))),u},t.prototype.addItems=function(e,t){var o,r;if(this._dataSource&&!(e>this.getRowCount())){var i=this._dataSource,a=this._dataSourceType,s=this.getDataItemType();if(3===a){if(!this._dataViewUpdating){if(this._updatingDataView=!0,s){for(o=0;o<t;o++)r=s.createEntity?s.createEntity():new s,i.add(r);i.commitEdit()}this._updatingDataView=!1}}else if(4!==a)for(o=0;o<t;o++)s?(r=s.createEntity?s.createEntity():new s,i.splice(e,0,r)):i.splice(e,0,n)}},t.prototype.removeItems=function(e,t){var o,n=this.getRowCount();if(this._dataSource&&!(e>=n)){var r=this._dataSource,i=this._dataSourceType,a=Math.min(t,n-e);if(3===i){if(!this._dataViewUpdating){for(this._updatingDataView=!0,o=0;o<a;o++)r.remove(r.item(e));this._updatingDataView=!1}}else 4===i||e<n&&r.splice(e,a)}},t.isDataViewSource=function(e){var t=window.wijmo;return t&&t.data&&t.data.isDataView&&t.data.isDataView(e)},t.isCellBindingSource=function(e){return a&&e instanceof a||e&&e.hasOwnProperty("__cellBindingSource__")},t.prototype._init=function(){this._dataSource=n,this._dataSourceType=0,this._dataItemType=n,this._fields=n,this._dataSourceSubscriptions=[],this._dataItemSubscriptions=[]},t.prototype._getDataSourceType=function(e){if(e){var o=window.ko;if(t.isDataViewSource(e))return 3;if(o&&o.isObservable(e))return 2;if(t.isCellBindingSource(e))return 4;if(e&&!isNaN(e.length))return 1}return 0},t.prototype._getDataLength=function(){var e,t=this._dataSource,o=this._dataSourceType;return t?(e=0,1===o?e=t.length:2===o?e=t().length:4===o||3===o&&(e=t.count()),e):0},t.prototype._getFieldsInfo=function(){var e,t,o=this._dataSource,r=this._dataSourceType,i=0,a=n;if(1===r){if(o.length>0&&((e=this._getProperties(o[0]))&&e.length>0))for(i=e.length,a=[],t=0;t<i;t++)a.push(e[t])}else if(2===r){if(o().length>0&&((e=this._getProperties(o()[0]))&&e.length>0))for(i=e.length,a=[],t=0;t<i;t++)a.push(e[t])}else if(4!==r&&3===r&&(o.count(),(e=o.getProperties())&&e.length>0))for(i=e.length,a=[],t=0;t<i;t++)a.push(e[t].name);return a},t.prototype._getProperties=function(t){var o=window.ko,n=[];for(var i in t)e.GC$.isFunction(t[i])?typeof o!==r&&o.isObservable(t[i])&&n.push(i):n.push(i);return n},t.prototype._dataChangedhandler=function(e){var t,o=this;o._updatingDataView||o._sheet&&(t=o._sheet)._bindToAutoRefresh(function(e){var r,i,a,s;if(e){if(o._dataViewUpdating=!0,!isNaN(e.length)&&(t._setRowCountInternal(e.length),(o._fields===n||void 0===o._fields)&&0===t._sheetModelManager.getColInfos()._getItems().length&&(o._fields=o._getFieldsInfo(),t.setColumnCount(o.getColumnCount()),r=t._sheetModelManager.getColInfos(),i=o.getFields())))for(a=0,s=i.length;a<s;a++)r._setItem(a,{name:i[a]});o._dataViewUpdating=!1}})(e)},t.prototype._currentPositionChangedhandler=function(e){var t,o;this._dataSource&&this._sheet&&(t=this._sheet,o=this._dataSource,t._bindToAutoRefresh(function(e){if(o.currentPosition){var n=o.currentPosition();t._activeRowIndex!==n&&t._setActiveCellAndSelection(n,t._activeColIndex,void 0,void 0,2)}})(e))},t.prototype.toJSON=function(){var e,t=this._dataSource;return t?(2===(e=this._dataSourceType)?t=t():4===e?t=t.getSource():3===e&&(t=t.local),{type:e,source:t}):n},t.prototype.fromJSON=function(e,t){var o,n,r=e&&e.source;r&&(2===(o=e.type)?(n=window.ko)&&n.observableArray&&this.bind(n.observableArray(r)):4===o?this.bind(new a(r)):this.bind(r))},t}(),e._BindingManager=t,o=function(){function e(){}return e.setValueByPath=function(e,t,o){var n,i;if(e&&t){var a=window.ko,s=t.split("."),l=s.length;for(n=0;n<l&&(i=s[n],e);n++)n===l-1?"function"==typeof e[i]?(typeof a===r||!a.isObservable(e[i])||a.isWriteableObservable(e[i]))&&e[i](o):e[i]=o:e="function"==typeof e[i]?e[i]():e[i]}},e.getValueByPath=function(e,t){var o;if(!e||!t)return n;var i=t.split("."),a=i.length,s=0;do{if((e="function"==typeof e[o=i[s]]?e[o]():e[o])===n||typeof e===r)return n}while(++s<a);return e},e}(),e._BindingHelper=o}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(t){var o,n,r,i,a;t.feature("table",["core.common","core.stringResource"]);var s=null,l=void 0,u=Math.min,c=Math.floor,h="bold 11pt calibri",p="undefined",d="Column",f=function(){function n(e,t,n,r,i,a){var u,c,h=this;for((h=this)._name=s,h._row=-1,h._col=-1,h._rowCount=-1,h._colCount=-1,h._style=s,h._showHeader=!0,h._showFooter=!1,h._highlightFirstColumn=!1,h._highlightLastColumn=!1,h._bandRows=!0,h._bandColumns=!1,h._bindingManager=s,h._columns=s,h._rowFilter=s,h._owner=s,h._slicerData=s,e!==l&&(h._name=e),t!==l&&(h._row=t),n!==l&&(h._col=n),r!==l&&(h._rowCount=r),i!==l&&(h._colCount=i),a!==l&&(h._style=a),h._autoGenerateColumns=!0,h._columns=[],u=0;u<h._colCount;u++)c=new o(u+1),h._columns.push(c)}return n.prototype.range=function(){return new t.Range(this._row,this._col,this._rowCount,this._colCount)},n.prototype.dataRange=function(){var e=this._showHeader?this._row+1:this._row,o=this._showHeader?this._rowCount-1:this._rowCount;return this._showFooter&&o--,new t.Range(e,this._col,o,this._colCount)},n.prototype.name=function(e){return 0===arguments.length?this._name:(this._name=e,this)},n.prototype.headerIndex=function(){return this._showHeader?this._row:-1},n.prototype.footerIndex=function(){return this._showFooter?this._row+this._rowCount-1:-1},n.prototype.showHeader=function(e){var t,o,n=this;return 0===arguments.length?n._showHeader:n._showHeader===e?n:((n._showHeader=e)?(n._row>0&&(n._row=n._row-1,n._rowCount=n._rowCount+1),n._syncHeader(),n._getSheet().invalidate()):(t=n._row,n._row=n._row+1,n._rowCount=n._rowCount-1,n._clearSheetRow(t),n._resetFilter()),(o=n._getSheet())&&o.recalcRange(n._row+(e?0:-1),n._col,1,n._colCount),n)},n.prototype.showFooter=function(e){var t,o,n=this;return 0===arguments.length?n._showFooter:n._showFooter===e?n:(t=n._getSheet(),(n._showFooter=e)?((!t||n._row+n._rowCount<t.getRowCount())&&(n._rowCount=n._rowCount+1),n._syncFooter()):(o=n._row+n._rowCount-1,n._rowCount=n._rowCount-1,n._clearSheetRow(o)),t&&t.recalcRange(n._row+n._rowCount+(e?-1:0),n._col,1,n._colCount),n)},n.prototype.bandRows=function(e){return 0===arguments.length?this._bandRows:(this._bandRows=e,this)},n.prototype.bandColumns=function(e){return 0===arguments.length?this._bandColumns:(this._bandColumns=e,this)},n.prototype.highlightFirstColumn=function(e){return 0===arguments.length?this._highlightFirstColumn:(this._highlightFirstColumn=e,this)},n.prototype.highlightLastColumn=function(e){return 0===arguments.length?this._highlightLastColumn:(this._highlightLastColumn=e,this)},n.prototype.style=function(e){return 0===arguments.length?this._style:(this._style=e,this)},n.prototype.rowFilter=function(){return!this._rowFilter&&t.features.filter&&(this._rowFilter=new t._TableFilter(this),this._rowFilter._updateRange(this.dataRange())),this._rowFilter},n.prototype.autoGenerateColumns=function(e){return 0===arguments.length?this._autoGenerateColumns:(this._autoGenerateColumns=e,this)},n.prototype.bindColumns=function(e){var t,n,r;if(e)for(t=u(this._colCount,e.length),n=0;n<t;n++)(r=this._columns[n])||(r=new o(this._newAutoId()),this._columns[n]=r),r.name(e[n].name()),r.dataField(e[n].dataField())},n.prototype.bindingPath=function(e){return 0===arguments.length?this._bindingPath:(this._bindingPath=e,this._applyBindingPath(),this)},n.prototype.refresh=function(){},n.prototype.getColumnName=function(e){var o,n,r=this._columns;return r&&0<=e&&e<r.length&&(o=r[e])?((n=o.name())!==s&&(n=t.util.toString(n)),n):s},n.prototype.setColumnName=function(e,t){var n,r,i,a,s=this;return s._hasColumnName(t)?s:((n=s._columns)&&0<=e&&e<n.length&&((r=n[e])||(r=s._columns[e]=new o(s._newAutoId())),i=r.name(),r.name(t),s._showHeader&&((a=s._getSheet())&&a.setText(s.headerIndex(),s._col+e,t)),s._slicerData)&&s._slicerData.onColumnNameChanged(i,r.name()),s)},n.prototype.getColumnFormula=function(e){var t,o,n=this._columns;return n&&0<=e&&e<n.length&&(t=n[e])?(o=t.formula())?o.toUpperCase():o:s},n.prototype.setColumnFormula=function(e,t){var o,n,r=this._columns;return r&&0<=e&&e<r.length&&(t&&"="===t[0]&&(t=t.substring(1)),(o=r[e])&&o.formula(t),this._showFooter&&((n=this._getSheet())&&n.setFormula(this.footerIndex(),this._col+e,t))),this},n.prototype.setColumnDataFormula=function(e,t){var o,n=this._columns;return n&&0<=e&&e<n.length&&(t&&"="===t[0]&&(t=t.substring(1)),(o=n[e])&&this._setColumnDataAreaFormulaCore(o,t)),this},n.prototype.getColumnValue=function(e){var t,o,n=this._columns;return n&&0<=e&&e<n.length&&(t=n[e])?this._showFooter&&t.formula()&&(o=this._getSheet())?o.getValue(this.footerIndex(),this._col+e):t.value():s},n.prototype.setColumnValue=function(e,t){var o,n,r=this._columns;return r&&0<=e&&e<r.length&&((o=r[e])&&o.value(t),this._showFooter&&((n=this._getSheet())&&n.setValue(this.footerIndex(),this._col+e,t))),this},n.prototype.filterButtonVisible=function(e,t){var o,n,r,i=this._owner.getSheet(),a=this.rowFilter();if(!(e<0||e>=this._colCount))switch(arguments.length){case 0:return a.filterButtonVisible();case 1:if("number"==typeof(o=arguments[0]))return a.filterButtonVisible(o);if("boolean"==typeof o){for(n=i.isPaintSuspended(),i.isPaintSuspended(!0),r=0;r<this._colCount;r++)a.filterButtonVisible(r,o);return i.isPaintSuspended(n),this}case 2:return a.filterButtonVisible(e,t),this}},n.prototype.getSlicerData=function(){var t=e.Sheets.TableSlicerData;return!this._slicerData&&t&&(this._slicerData=new t(this)),this._slicerData},n.prototype.hasSlicerData=function(){return!!this._slicerData},n.prototype._setColumnDataAreaFormulaCore=function(e,t,o){var n,r;if(void 0===o&&(o=!1),o||e.dataAreaFormula()!==t){this,e.dataAreaFormula(t),!1,(n=this._owner.getSheet()).suspendCalcService();var i=this._getColumnIndex(e)+this._col,a=this._row,s=this._rowCount;for(this.showHeader()&&(a++,s--),this.showFooter()&&s--,r=a;r<a+s;r++)n.setFormula(r,i,t);n.resumeCalcService(!1)}},n.prototype._getColumnIndex=function(e){for(var t=0;t<this._columns.length;t++)if(this._columns[t]===e)return t;return-1},n.prototype._setOwner=function(e){this._owner=e},n.prototype._getSheet=function(){return this._owner?this._owner.getSheet():s},n.prototype._bind=function(e){var t,n,r,i,a,s,l,u,c,h,p,d,f=this,g=f._autoGenerateColumns;if(f._resetFilter(),(t=f._getSheet())&&(n=f.dataRange(),t.clear(n.row,n.col,n.rowCount,n.colCount,3,17),!g))for(i=0,a=(r=f._columns).length;i<a;i++)if(s=r[i].dataAreaFormula())for(l=0,u=n.rowCount;l<u;l++)t.setFormula(n.row+l,n.col+i,s);if(g&&(c=f.range(),f._clear(c.row,c.col,c.rowCount,c.colCount)),f._bindingManager=e,e){var m=f._bindingManager,_=m.getRowCount(),y=m.getColumnCount();if(f._showHeader&&_++,f._showFooter&&_++,f._rowCount=_,g)for(f._colCount=y,f._columns=[],h=m.getFields(),p=0;p<f._colCount;p++)d=new o(p+1),f._columns[p]=d,h&&(d.name(h[p]),d.dataField(h[p]))}f._rowFilter&&f._rowFilter._updateRange(f.dataRange())},n.prototype._getDataSourceCol=function(e){var t,o,n,r,i,a=this._bindingManager;if(a&&(t=a.getFields()))for(n=(o=this._columns[e-this.startColumn()])&&o.dataField(),r=0,i=t.length;r<i;r++)if(t[r]===n)return r;return-1},n.prototype.hasBinding=function(){return!!this._bindingManager},n.prototype._getValue=function(e,t){var o,n=this._bindingManager,r=e-this.dataRange().row;return n&&r<n.getRowCount()&&(o=this._getDataSourceCol(t))>=0?{hasBinding:!0,value:n.getValue(r,o).value}:{hasBinding:!1,value:void 0}},n.prototype._setValue=function(e,t,o){var n,r,i,a,s=this._bindingManager,u=e-this.dataRange().row,c=!1;return s&&(n=this._getDataSourceCol(t))>=0?((r=this._getSheet())&&((i=r._sheetModelManager.getDataModel())&&((a=s.getValue(u,n)).hasBinding&&a.value!==o&&i._updateDirty(e,t,{oldValue:a.value}),i.setValue(e,t,l))),s.setValue(u,n,o),c=!0):n=t-this._col,c},n.prototype._compose=function(e,o,n){var r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T=this,A=T._style;if(A&&!((r=T._getSheet())&&r.getRowHeight(e)<=0)){var I=T.headerIndex(),D=T.footerIndex(),F=T._showHeader?e===T._row+1:e===T._row,M=T._showFooter?e===T._row+T._rowCount-2:e===T._row+T._rowCount-1,E=o===T._col,N=o===T._col+T._colCount-1,O=T._showHeader?e===I:e===T._row,P=T._showFooter?e===D:e===T._row+T._rowCount-1,L=A.highlightLastColumnStyle(),H=A.highlightFirstColumnStyle();if(I===e)i=A.lastHeaderCellStyle(),N&&T._highlightLastColumn&&i&&i._compose(n,!0,!0,!0,!0),a=A.firstHeaderCellStyle(),E&&T._highlightFirstColumn&&a&&a._compose(n,!0,!0,!0,!0),(s=A.headerRowStyle())&&s._compose(n,!0,E,!0,N),N&&T._highlightLastColumn&&L&&L._compose(n,!0,!0,!1,!0),E&&T._highlightFirstColumn&&H&&H._compose(n,!0,!0,!1,!0);else if(D===e)l=A.lastFooterCellStyle(),N&&T._highlightLastColumn&&l&&l._compose(n,!0,!0,!0,!0),u=A.firstFooterCellStyle(),E&&T._highlightFirstColumn&&u&&u._compose(n,!0,!0,!0,!0),(c=A.footerRowStyle())&&c._compose(n,!0,E,!0,N),N&&T._highlightLastColumn&&L&&L._compose(n,!1,!0,!0,!0),E&&T._highlightFirstColumn&&H&&H._compose(n,!1,!0,!0,!0);else{if(N&&T._highlightLastColumn&&L&&L._compose(n,O,!0,P,!0),E&&T._highlightFirstColumn&&H&&H._compose(n,O,!0,P,!0),h=T._showHeader?e-T._row-1:e-T._row,p=o-T._col,t._CacheMgr._cached&&t._CacheMgr._visibleRowIndexCache){for(d=t._CacheMgr._visibleRowIndexCache,m=T.dataRange().row;-1===d[m];)m++;if(m>e)return;h=d[e]-d[m]}else if(r){for(f=0,g=0,m=T.dataRange().row;m<e;m++)r.getRowHeight(m)>0&&f++;for(_=T._col;_<o;_++)r.getColumnWidth(_)>0&&g++;h=f,p=g}if(T.bandRows()&&(S=(y=A.firstRowStripSize())+A.secondRowStripSize())>0){var k=h%S,V=A.firstRowStripStyle(),B=A.secondRowStripStyle();k<y&&V?(C=0===k,w=M||k===y-1,V._compose(n,C,E,w,N)):k>=y&&B&&(C=k===y,w=M||k===S-1,B._compose(n,C,E,w,N))}if(T.bandColumns()&&(S=(v=A.firstColumnStripSize())+A.secondColumnStripSize())>0){k=p%S;var z=A.firstColumnStripStyle(),G=A.secondColumnStripStyle();k<v&&z?(x=0===k,R=N||k===v-1,z._compose(n,F,x,M,R)):k>=v&&G&&(x=k===v,R=N||k===S-1,G._compose(n,F,x,M,R))}}(b=A.wholeTableStyle())&&b._compose(n,O,E,P,N)}},n.prototype._moveTo=function(e,o){var n,r,i,a,s,l=this;if((e!==l._row||o!==l._col)&&(n=l._getSheet())){if(e<0||n.getRowCount()<e+l._rowCount)throw new Error(t.SR.Exp_TableMoveOutOfRange);if(o<0||n.getColumnCount()<o+l._colCount)throw new Error(t.SR.Exp_TableMoveOutOfRange);if(r=l._owner)for(a=0,s=(i=r.getTables()).length;a<s;a++)if(i[a]===l){i.splice(a,1),l._clearSheetModelFormula();break}n.moveTo(l._row,l._col,e,o,l._rowCount,l._colCount,3),i&&a<=s&&(l._moveToCore(e,o),i.splice(a,0,l),l._syncSheetModelFormula())}},n.prototype._moveToCore=function(e,t){this._row=e,this._col=t,this._updateFilter()},n.prototype._clearSheetModelFormula=function(e,t){var o,n,r,i,a=this._getSheet();if(a){var u=this._columns,c=this.footerIndex(),h=this.range(),p=this.dataRange();for((e===s||e===l)&&(e=0,t=u.length);e<t;e++)if(o=u[e],n=h.col+e,o&&o.formula()&&c>=0&&(a.setFormula(c,n,s),a.setValue(c,n,s)),o&&o.dataAreaFormula())for(r=0,i=p.rowCount;r<i;r++)a.setFormula(p.row+r,n,s),a.setValue(p.row+r,n,s)}},n.prototype._syncSheetModelFormula=function(){var e,t,o,n,r,i,a=this._getSheet();if(a){var s=this._columns,l=this.footerIndex(),u=this.range(),c=this.dataRange();for(e=0,t=s.length;e<t;e++)if(o=s[e],n=u.col+e,o.formula()&&l>=0&&a.setFormula(l,n,o.formula()),o.dataAreaFormula())for(r=0,i=c.rowCount;r<i;r++)a.setFormula(c.row+r,n,o.dataAreaFormula())}},n.prototype._resize=function(e,n){var r,i,a,s,l,u,c,h,p,d,f=this,g=f.dataRange();if(!e.equals(f.range())){var m=e.row,_=e.col,y=e.rowCount,C=e.colCount,w=f._showHeader,v=f._showFooter,S=0;if(w&&(S+=1),v&&(S+=1),y<S||C<1)throw new Error(t.SR.Exp_TableResizeOutOfRange);if((r=f._getSheet())&&(m+y>r.getRowCount()||_+C>r.getColumnCount()))throw new Error(t.SR.Exp_TableResizeOutOfRange);if(m!==f._row)throw new Error(t.SR.Exp_TableResizeInvalidRange);if(!e.intersect(f._row,f._col,f._rowCount,f._colCount))throw new Error(t.SR.Exp_TableResizeInvalidRange);var x=f._columns,R=_,b=_+C-1,T=f._col,A=f._col+f._colCount-1;if(f._col=_,f._colCount=C,R<T){for(i=0,a=R;a<T;a++)s=new o(f._newAutoId()),x.splice(i++,0,s);w&&f._syncHeader(R,T-R),v&&f._syncFooter(R,T-R)}else R<=A&&(f._clearSheetModelFormula(T,R),x.splice(0,R-T));if(b>A){for(a=A+1;a<=b;a++)s=new o(f._newAutoId()),x.push(s);w&&f._syncHeader(A+1,b-A),v&&f._syncFooter(A+1,b-A)}else b>=T&&(f._clearSheetModelFormula(b,A),x.splice(x.length-(A-b),A-b));y!==f._rowCount&&(l=f._bindingManager,u=f.dataRange(),l?y>f._rowCount?(c=u.row+u.rowCount,h=y-f._rowCount,r&&r.addRows(c,h),v||(n||f._updateDataSourceOnAddRows(c,h),f._rowCount=y,f._updateFormulaOnAddRows(c,h))):r&&(p=f._rowCount-y,r.deleteRows(u.row+u.rowCount-p,p)):(v&&(f._syncFooter(),d=f.footerIndex()),f._rowCount=y,v&&(f._syncSheetByFooter(),f._clearSheetRow(d)))),f._updateFilter(),f.onTableResized(g,f.dataRange())}},n.prototype.onTableResized=function(e,t){var o=this._slicerData;if(o){var n=e.row+e.rowCount,r=e.col+e.colCount,i=t.row+t.rowCount,a=t.col+t.colCount;i<n&&o.onRowsDeleted(t.rowCount,n-i),i>n&&o.onRowsAdded(e.rowCount,i-n),t.col>e.col&&o.onColumnsDeleted(0,t.col-e.col),a<r&&o.onColumnsDeleted(t.colCount,r-a),t.col<e.col&&o.onColumnsAdded(0,e.col-t.col),a>r&&o.onColumnsAdded(e.col+e.colCount-t.col,a-r)}},n.prototype._updateFilter=function(){var e=this._rowFilter;e&&(e._updateRange(this.dataRange()),e.reFilter())},n.prototype._resetFilter=function(){var e=this._rowFilter;e&&(e.unfilter(),e.reset())},n.prototype._hasColumnName=function(e){var o;for(e!==s&&(e=t.util.toString(e)),o=0;o<this._colCount;o++)if(e===this.getColumnName(o))return!0;return!1},n.prototype._getHeaderName=function(e){var o,n,r,i;return this._showHeader&&this._columns?(o=e-this._col,n=this._columns,0<=o&&o<n.length&&(r=n[o])?((i=r.name())!==l&&i!==s&&(i=t.util.toString(i)),i):s):s},n.prototype._setHeaderName=function(e,t){var o,n,r,i,a,s,l,u,c,h;if(this._showHeader&&this._columns&&(o=e-this._col,n=this._columns,0<=o&&o<n.length&&(r=n[o]))){for((i=this._getSheet())&&((a=i._sheetModelManager.getDataModel())&&a._updateDirty(this._row,e,{oldValue:r.name()})),s=r.name(),r.name(t),l=0,u=n.length;l<u;l++)(h=(c=n[l])&&c.dataAreaFormula())&&h.indexOf(s)>=0&&c.dataAreaFormula(h.replace(new RegExp(s,"g"),r.name()));this._slicerData&&this._slicerData.onColumnNameChanged(s,r.name())}},n.prototype._setFooterFormula=function(e,t){var o,n,r;this._showFooter&&this._columns&&(o=e-this._col,n=this._columns,0<=o&&o<n.length&&((r=n[o])&&r.formula(t)))},n.prototype._setFooterValue=function(e,t){var o,n,r,i,a;this._showFooter&&this._columns&&(o=e-this._col,n=this._columns,0<=o&&o<n.length&&((r=n[o])&&(t!==r.value()&&((i=this._getSheet())&&((a=i._sheetModelManager.getDataModel())&&a._updateDirty(this._row+this._rowCount-1,e,{oldValue:r.value()}))),r.value(t))))},n.prototype._newAutoId=function(){var e;if(!this._columns||0===this._columns.length)return-1;var t,o=this._columns,n=[],r=o.length;for(e=0;e<r;e++)(t=o[e])&&t.isAutoId()&&n.push(t.id());if(n.sort(function(e,t){return e-t}),(r=n.length)>0){for(e=0;e<r;e++)if(n[e]!==e+1)return e+1;return r+1}return 1},n.prototype._syncHeader=function(e,o){var n,r,i,a,c;if(this._showHeader&&this._columns&&(n=this._getSheet())){var h,p=this.headerIndex(),d=this._col,f=this._columns;(e===l||e===s)&&(e=0),(o===l||o===s)&&(o=f.length);var g=u(f.length,e+o),m=n._getModel(3);if(m)for(i=e;i<g;i++)(h=f[i])&&(a=this._owner._tableList,(c=t.util.inArray(this,a))>-1&&a.splice(c,1),r=n.getText(p,d+i),c>-1&&a.splice(c,0,this),n.setFormula(p,d+i,s),r?(n._recalcCell(m,p,d+i),h.name(r)):n.setText(p,d+i,h.name()))}},n.prototype._syncFooter=function(e,t){var o,n,r,i,a;if(this._showFooter&&this._columns&&(o=this._getSheet())){var c,h=this.footerIndex(),p=this._col,d=this._columns;for((e===l||e===s)&&(e=0),(t===l||t===s)&&(t=d.length),n=u(d.length,e+t),a=e;a<n;a++)(c=d[a])&&((r=o.getFormula(h,p+a))?c.formula(r):o.setFormula(h,p+a,c.formula()),(i=o.getValue(h,p+a))!==l&&i!==s?c.value(i):o.setValue(h,p+a,c.value()))}},n.prototype._clearHeader=function(e,t){var o,n,r,i,a;if(this._showHeader&&this._columns)for(o=this._columns,(e===l||e===s)&&(e=0),(t===l||t===s)&&(t=o.length),r=u(o.length,e+t),i=e;i<r;i++)(n=o[i])&&(a=n.name(),n.name(s),this._slicerData)&&this._slicerData.onColumnNameChanged(a,n.name())},n.prototype._clearDataRange=function(e){this._getSheet();var t,o,n=this.dataRange();if(n.containsRange(e)){var r=e.row,i=e.col,a=e.rowCount,l=e.colCount;for(t=0;t<a;t++)for(o=0;o<l;o++)this._setValue(r+t,i+o,s),this._slicerData&&this._slicerData.onDataChanged(r+t-n.row,i+o-n.col,"")}},n.prototype._clearFooter=function(e,t){var o,n,r,i;if(this._showFooter&&this._columns)for(o=this._columns,(e===l||e===s)&&(e=0),(t===l||t===s)&&(t=o.length),r=u(o.length,e+t),i=e;i<r;i++)(n=o[i])&&(n.formula(s),n.value(s))},n.prototype._syncSheetByFooter=function(){var e,t;if(this._showFooter&&this._columns&&(e=this._getSheet())){var o,n,r=this._columns,i=r.length,a=this._col,s=this.footerIndex();for(t=0;t<i;t++)(o=r[t])&&(n=a+t,e.setValue(s,n,o.value()),e.setFormula(s,n,o.formula()))}},n.prototype._clearSheetRow=function(e){var t,o,n,r,i=this._getSheet();if(i&&!(e<0)&&!(i.getRowCount()<=e))for(t=this._col,o=this._colCount,r=0;r<o;r++)n=t+r,i.setFormula(e,n,s),i.setValue(e,n,s)},n.prototype._addRows=function(e,t,o){var n=this,r=!1;if(e>=n._row+n._rowCount)return r;var i=n.dataRange().row,a=n.endRow(),s=(n._columns,n._row),l=n._row+n._rowCount-1;return e<=s?n._row+=t:e<=l&&(o||(r=n._updateDataSourceOnAddRows(e,t)),n._rowCount+=t,n._updateFormulaOnAddRows(e,t)),e>=i&&e<=a&&n._slicerData&&n._slicerData.onRowsAdded(e-i,t),n._rowFilter&&n._rowFilter._addRows(e,t),r},n.prototype._updateDataSourceOnAddRows=function(e,t){var o=this._row,n=this._bindingManager;return!!n&&(n.addItems(e-(this.showHeader()?o+1:o),t),!0)},n.prototype._updateFormulaOnAddRows=function(e,t){var o,n,r,i,a=this._columns,s=this._owner.getSheet();for(s.suspendCalcService(),o=0;o<a.length;o++)if(n=a[o].dataAreaFormula())for(r=o+this._col,i=e;i<e+t;i++)s.setFormula(i,r,n);s.resumeCalcService(!1)},n.prototype._addColumns=function(e,t){var n,r,i,a,s=this;if(!(e>=s._col+s._colCount)){if(n=s._col,e<=s._col)s._col+=t;else if(e<s._col+s._colCount&&(s._colCount+=t,r=s._columns))for(i=0;i<t;i++)a=new o(s._newAutoId()),r.splice(e+i-s._col,0,a);s._rowFilter&&s._rowFilter._addColumns(e,t),e>=n&&s._slicerData&&s._slicerData.onColumnsAdded(e-n,t)}},n.prototype._removeRows=function(e,t,o){var n,r=this,i=!1;if(e>=r._row+r._rowCount)return i;var a=r.dataRange(),s=a.row,l=a.rowCount,c=r._row,h=r._row+r._rowCount-1;return e<c?e+t>c||(r._row-=t):e===c?r._showHeader||(r._rowCount-=u(h-e+1,t),o||(n=r._bindingManager)&&(n.removeItems(e-(r.showHeader()?c+1:c),u(h-e+1,t)),i=!0)):e<=h&&(r._rowCount-=u(h-e+1,t),o||(n=r._bindingManager)&&(n.removeItems(e-(r.showHeader()?c+1:c),u(h-e+1,t)),i=!0),e===h&&r._showFooter&&(r._showFooter=!1)),r._rowFilter&&r._rowFilter._removeRows(e,t),e>=s&&e<s+l&&r._slicerData&&r._slicerData.onRowsDeleted(e-s,t),i},n.prototype._removeColumns=function(e,t){var o,n=this;if(!(e>=n._col+n._colCount)){var r=n._col,i=n._col,a=n._col+n._colCount-1;e<i?e+t<=i?n._col-=t:(n._col=e,n._colCount-=e+t-i,(o=n._columns)&&o.splice(0,e+t-i)):(n._colCount-=u(a-e+1,t),(o=n._columns)&&o.splice(e-i,u(a-e+1,t))),n._rowFilter&&n._rowFilter._removeColumns(e,t),e>=r&&n._slicerData&&n._slicerData.onColumnsDeleted(e-r,t)}},n.prototype._clear=function(e,o,n,r){var i,a,s,l,u,c,h=this,p=n,d=r,f=h._getSheet();f&&(p=f.getRowCount(),d=f.getColumnCount());var g=e<0?0:e,m=o<0?0:o,_=e<0?p:n,y=o<0?d:r,C=new t.Range(g,m,_,y),w=h.headerIndex();h._showHeader&&g<=w&&w<g+_&&(i=new t.Range(w,h._col,1,h._colCount),(c=C.getIntersect(i,p,d))&&h._clearHeader(c.col-h._col,c.colCount)),a=h.dataRange(),(s=C.getIntersect(a,p,d))&&h._clearDataRange(s),l=h.footerIndex(),h._showFooter&&g<=l&&l<g+_&&(u=new t.Range(l,h._col,1,h._colCount),(c=C.getIntersect(u,p,d))&&h._clearFooter(c.col-h._col,c.colCount)),h._rowFilter&&h._rowFilter._clear(e,o,n,r)},n.prototype._copy=function(e,t,o,n,r,i){},n.prototype._move=function(e,t,o,n,r,i){},n.prototype._isDefaultValue=function(e,t){switch(e){case"name":return t===s;case"row":case"col":case"rowCount":case"colCount":return-1===t;case"showHeader":return!0===t;case"showFooter":case"highlightFirstColumn":case"highlightLastColumn":return!1===t;case"bandRows":return!0===t;case"bandColumns":return!1===t;case"style":case"columns":case"rowFilter":return t===s;case"autoGenerateColumns":return!0===t;default:return!1}},n.prototype.toJSON=function(){var e,o,n=this,r={name:n._name,row:n._row,col:n._col,rowCount:n._rowCount,colCount:n._colCount,showHeader:n._showHeader,showFooter:n._showFooter,highlightFirstColumn:n._highlightFirstColumn,highlightLastColumn:n._highlightLastColumn,bandRows:n._bandRows,bandColumns:n._bandColumns,style:n._style?n._style.toJSON():s,columns:n._columns,autoGenerateColumns:n._autoGenerateColumns,bindingPath:n._bindingPath,rowFilter:n._rowFilter?n._rowFilter.toJSON():s},i={};for(e in r)o=r[e],n._isDefaultValue(e,o)||(i[e]=o);return t.GC$.isEmptyObject(i)?l:i},n.prototype.fromJSON=function(e,n){var i,a,s,l,u,c,h,d;if(e){if(i=this,typeof e.name!==p&&(i._name=e.name),typeof e.row!==p&&(i._row=e.row),typeof e.col!==p&&(i._col=e.col),typeof e.rowCount!==p&&(i._rowCount=e.rowCount),typeof e.colCount!==p&&(i._colCount=e.colCount),typeof e.showHeader!==p&&(i._showHeader=e.showHeader),typeof e.showFooter!==p&&(i._showFooter=e.showFooter),typeof e.highlightFirstColumn!==p&&(i._highlightFirstColumn=e.highlightFirstColumn),typeof e.highlightLastColumn!==p&&(i._highlightLastColumn=e.highlightLastColumn),typeof e.bandRows!==p&&(i._bandRows=e.bandRows),typeof e.bandColumns!==p&&(i._bandColumns=e.bandColumns),e.style&&((a=new r).fromJSON(e.style,n),i._style=a),typeof e.autoGenerateColumns!==p&&(i._autoGenerateColumns=e.autoGenerateColumns),n?(e.dataSource&&t.features.binding&&(i._bindingManager=new t._BindingManager,i._bindingManager.bind(e.dataSource)),e.dataBinding&&t.features.binding&&(i._bindingManager=new t._BindingManager,i._bindingManager.fromJSON(e.dataBinding,n))):e.bindingPath&&(i._bindingPath=e.bindingPath,l=(s=i._getSheet())&&s.getDataSource(),t.CellBindingSource&&l instanceof t.CellBindingSource&&((u=t._BindingHelper.getValueByPath(l.getSource(),e.bindingPath))&&(i._bindingManager=new t._BindingManager,i._bindingManager.bind(u)))),e.columns){var f,g,m=e.columns,_=m.length,y=[];for(c=0;c<_;c++)g=m[c],(f=new o(i._newAutoId())).fromJSON(g,n),y.push(f);for(i._columns=y,c=0;c<_;c++)(f=y[c]).isAutoId()||f.id(i._newAutoId())}e.rowFilter&&t.features.filter&&(h=e.rowFilter,(d=new t._TableFilter).table(i),d.fromJSON(h,n),i._rowFilter=d,i._rowFilter.reFilter())}},n.prototype.startRow=function(){return this._row},n.prototype.startColumn=function(){return this._col},n.prototype.endRow=function(){return this._row+this._rowCount-1},n.prototype.endColumn=function(){return this._col+this._colCount-1},n.prototype.hasHeadersRow=function(){return this._showHeader},n.prototype.hasTotalsRow=function(){return this._showFooter},n.prototype.tableName=function(){return this._name},n.prototype.getColumnIndexInTable=function(e){for(var t,o=0;o<this._columns.length;o++)if((t=this._columns[o]).name()===e||t.name().toString().toLowerCase()===e.toLowerCase())return o;return-1},n.prototype.source=function(){return this._owner.getSheet()._getSheetSource()},n.prototype._applyBindingPath=function(){var e,o,n,r,i,a,l=this._getSheet();if(l&&(e=this._bindingPath,o=l.getDataSource(),e&&t.CellBindingSource&&o instanceof t.CellBindingSource&&(n=t._BindingHelper.getValueByPath(o.getSource(),e)))){var u=this.dataRange(),c=u.row,h=(u.col,u.rowCount),p=(u.colCount,new t._BindingManager);p.bind(n),r=p.getRowCount(),p.getColumnCount();try{i=l.isPaintSuspended(),l.isPaintSuspended(!0),this._bindingManager=s,r>h?l.addRows(c+h,r-h):r<h&&l.deleteRows(c+r,h-r),this._bind(p),(a=l.getCalcService())&&!a.IsSuspended()&&l.recalcAll()}finally{l.isPaintSuspended(i)}}},n.prototype.clone=function(){var e=new n,t=JSON.stringify(this.toJSON());return e._setOwner(this._owner),e.fromJSON(JSON.parse(t)),e},n.prototype.copyDataSourceImp=function(e){var o=new t._BindingManager;o.bind(e),this._bindingManager=o},n.prototype.copyDataSource=function(e){if(!e.bindingPath()){var t=e._bindingManager;t&&this.copyDataSourceImp(t.getSource())}},n.prototype.resetBindingManager=function(){this._bindingManager=s},n.prototype.getSource=function(){var e=this._bindingManager;return e?e.getSource():s},n.prototype.getSourceRowCount=function(){var e=this._bindingManager;return e?e.getRowCount():0},n.prototype.sort=function(e,t){var o,n=this._getSheet(),r=this.dataRange(),i=this.rowFilter();n&&0<=e&&e<r.colCount&&(o=n.isPaintSuspended(),n.isPaintSuspended(!0),n.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:e+r.col,ascending:t}]),i&&(i.sortInfo={index:e+r.col,ascending:t}),n.isPaintSuspended(o))},n}();t.SheetTable=f,o=function(){function e(e){this._id=e,this._name=d+this._id,this._dataField=s,this._fformula=s,this._fvalue=s}return e.prototype.id=function(e){return 0===arguments.length?this._id:(this._id=e,this._name||(this._name=d+this._id),this)},e.prototype.isAutoId=function(){return this._id>0},e.prototype.name=function(e){return 0===arguments.length?this._name:(this._name=e||d+this._id,this)},e.prototype.dataField=function(e){return 0===arguments.length?this._dataField:(this._dataField=e,this)},e.prototype.value=function(e){return 0===arguments.length?this._fvalue:(this._fvalue=e,this)},e.prototype.dataAreaFormula=function(e){return 0===arguments.length?this._dataAreaFormula:(this._dataAreaFormula=e,this)},e.prototype.formula=function(e){return 0===arguments.length?this._fformula:(this._fformula=e,this)},e.prototype._isDefaultValue=function(e,t){switch(e){case"name":case"dataField":case"footerFormula":case"footerValue":return t===s;default:return!1}},e.prototype.toJSON=function(){var e,o,n={id:this._id,name:this._name,dataField:this._dataField,footerFormula:this._fformula,dataAreaFormula:this._dataAreaFormula,footerValue:this._fvalue},r={};for(e in n)o=n[e],this._isDefaultValue(e,o)||(r[e]=o);return t.GC$.isEmptyObject(r)?l:r},e.prototype.fromJSON=function(e,t){var o,n,r,i,a;e&&(this,(o=e.id?e.id:e._id)!==l&&(this._id=o),(n=e.name?e.name:e._name)!==l&&(this._name=n),e.dataField!==l&&(this._dataField=e.dataField),(r=t?e.fformula?e.fformula:e._fformula:e.footerFormula)!==l&&(this._fformula=r),(i=e.dataAreaFormula?e.dataAreaFormula:e._dataAreaFormula)!==l&&(this._dataAreaFormula=i),(a=t?e.fvalue?e.fvalue:e._fvalue:e.footerValue)!==l&&(this._fvalue=a))},e}(),t.TableColumnInfo=o,n=function(){function e(e,t,o,n,r,i,a,s,l,u){var c=this;c.backColor=e,c.foreColor=t,c.font=o,c.borderLeft=n,c.borderTop=r,c.borderRight=i,c.borderBottom=a,c.borderHorizontal=s,c.borderVertical=l,c.textDecoration=u}return e.prototype._compose=function(e,t,o,n,r){var i=this;typeof i.backColor!==p&&typeof e.backColor===p&&(e.backColor=i.backColor),typeof i.foreColor!==p&&typeof e.foreColor===p&&(e.foreColor=i.foreColor),typeof i.font!==p&&typeof e.font===p&&(e.font=i.font),o&&typeof i.borderLeft!==p&&typeof e.borderLeft===p&&(e.borderLeft=i.borderLeft),t&&typeof i.borderTop!==p&&typeof e.borderTop===p&&(e.borderTop=i.borderTop),r&&typeof i.borderRight!==p&&typeof e.borderRight===p&&(e.borderRight=i.borderRight),n&&typeof i.borderBottom!==p&&typeof e.borderBottom===p&&(e.borderBottom=i.borderBottom),n||typeof i.borderHorizontal===p||typeof e.borderBottom!==p||(e.borderBottom=i.borderHorizontal),r||typeof i.borderVertical===p||typeof e.borderRight!==p||(e.borderRight=i.borderVertical),typeof i.textDecoration!==p&&typeof e.textDecoration===p&&(e.textDecoration=i.textDecoration)},e.prototype.toJSON=function(){var e,o,n=this,r={backColor:n.backColor,foreColor:n.foreColor,font:n.font,borderLeft:n.borderLeft&&n.borderLeft.toJSON(),borderTop:n.borderTop&&n.borderTop.toJSON(),borderRight:n.borderRight&&n.borderRight.toJSON(),borderBottom:n.borderBottom&&n.borderBottom.toJSON(),borderHorizontal:n.borderHorizontal&&n.borderHorizontal.toJSON(),borderVertical:n.borderVertical&&n.borderVertical.toJSON(),textDecoration:n.textDecoration},i={};for(e in r)(o=r[e])===l||"object"==typeof o&&t.GC$.isEmptyObject(o)||(i[e]=o);return i},e.prototype.fromJSON=function(e,o){var n,r,i,a,s,l,u;e&&(n=this,typeof e.backColor!==p&&(n.backColor=e.backColor),typeof e.foreColor!==p&&(n.foreColor=e.foreColor),typeof e.font!==p&&(n.font=e.font),typeof e.borderLeft!==p&&((r=new t.LineBorder).fromJSON(e.borderLeft,o),n.borderLeft=r),typeof e.borderTop!==p&&((i=new t.LineBorder).fromJSON(e.borderTop,o),n.borderTop=i),typeof e.borderRight!==p&&((a=new t.LineBorder).fromJSON(e.borderRight,o),n.borderRight=a),typeof e.borderBottom!==p&&((s=new t.LineBorder).fromJSON(e.borderBottom,o),n.borderBottom=s),typeof e.borderHorizontal!==p&&((l=new t.LineBorder).fromJSON(e.borderHorizontal,o),n.borderHorizontal=l),typeof e.borderVertical!==p&&((u=new t.LineBorder).fromJSON(e.borderVertical,o),n.borderVertical=u),typeof e.textDecoration!==p&&(n.textDecoration=e.textDecoration))},e}(),t.TableStyleInfo=n,r=function(){function e(){this._lastFooterCellStyle=s,this._init()}return e.prototype.name=function(e){return 0===arguments.length?this._name:(this._name=e,this)},e.prototype.wholeTableStyle=function(e){return 0===arguments.length?this._wholeTableStyle:(this._wholeTableStyle=e,this)},e.prototype.headerRowStyle=function(e){return 0===arguments.length?this._headerRowStyle:(this._headerRowStyle=e,this)},e.prototype.footerRowStyle=function(e){return 0===arguments.length?this._footerRowStyle:(this._footerRowStyle=e,this)},e.prototype.firstRowStripStyle=function(e){return 0===arguments.length?this._firstRowStripStyle:(this._firstRowStripStyle=e,this)},e.prototype.secondRowStripStyle=function(e){return 0===arguments.length?this._secondRowStripStyle:(this._secondRowStripStyle=e,this)},e.prototype.firstRowStripSize=function(e){return 0===arguments.length?this._firstRowStripSize:(this._firstRowStripSize=e,this)},e.prototype.secondRowStripSize=function(e){return 0===arguments.length?this._secondRowStripSize:(this._secondRowStripSize=e,this)},e.prototype.firstColumnStripStyle=function(e){return 0===arguments.length?this._firstColumnStripStyle:(this._firstColumnStripStyle=e,this)},e.prototype.secondColumnStripStyle=function(e){return 0===arguments.length?this._secondColumnStripStyle:(this._secondColumnStripStyle=e,this)},e.prototype.firstColumnStripSize=function(e){return 0===arguments.length?this._firstColumnStripSize:(this._firstColumnStripSize=e,this)},e.prototype.secondColumnStripSize=function(e){return 0===arguments.length?this._secondColumnStripSize:(this._secondColumnStripSize=e,this)},e.prototype.highlightFirstColumnStyle=function(e){return 0===arguments.length?this._highlightFirstColumnStyle:(this._highlightFirstColumnStyle=e,this)},e.prototype.highlightLastColumnStyle=function(e){return 0===arguments.length?this._highlightLastColumnStyle:(this._highlightLastColumnStyle=e,this)},e.prototype.firstHeaderCellStyle=function(e){return 0===arguments.length?this._firstHeaderCellStyle:(this._firstHeaderCellStyle=e,this)},e.prototype.lastHeaderCellStyle=function(e){return 0===arguments.length?this._lastHeaderCellStyle:(this._lastHeaderCellStyle=e,this)},e.prototype.firstFooterCellStyle=function(e){return 0===arguments.length?this._firstFooterCellStyle:(this._firstFooterCellStyle=e,this)},e.prototype.lastFooterCellStyle=function(e){return 0===arguments.length?this._lastFooterCellStyle:(this._lastFooterCellStyle=e,this)},e.prototype.buildInName=function(e){return 0===arguments.length?this._buildInName:(this._buildInName=e,this)},e.prototype._init=function(){var e=this;e._name=s,e._headerRowStyle=s,e._footerRowStyle=s,e._wholeTableStyle=s,e._highlightLastColumnStyle=s,e._highlightFirstColumnStyle=s,e._firstRowStripStyle=s,e._secondRowStripStyle=s,e._firstColumnStripStyle=s,e._secondColumnStripStyle=s,e._firstHeaderCellStyle=s,e._lastHeaderCellStyle=s,e._firstFooterCellStyle=s,e._lastFooterCellStyle=s,e._firstRowStripSize=1,e._secondRowStripSize=1,e._firstColumnStripSize=1,e._secondColumnStripSize=1},e.prototype._cloneTableStyleInfo=function(e){if(e){var t=new n,o=JSON.stringify(e.toJSON());return t.fromJSON(JSON.parse(o)),t}return s},e.prototype._copyFrom=function(e){var t=this;t._name=e._name,t._headerRowStyle=t._cloneTableStyleInfo(e._headerRowStyle),t._footerRowStyle=t._cloneTableStyleInfo(e._footerRowStyle),t._wholeTableStyle=t._cloneTableStyleInfo(e._wholeTableStyle),t._highlightLastColumnStyle=t._cloneTableStyleInfo(e._highlightLastColumnStyle),t._highlightFirstColumnStyle=t._cloneTableStyleInfo(e._highlightFirstColumnStyle),t._firstRowStripStyle=t._cloneTableStyleInfo(e._firstRowStripStyle),t._secondRowStripStyle=t._cloneTableStyleInfo(e._secondRowStripStyle),t._firstColumnStripStyle=t._cloneTableStyleInfo(e._firstColumnStripStyle),t._secondColumnStripStyle=t._cloneTableStyleInfo(e._secondColumnStripStyle),t._firstHeaderCellStyle=t._cloneTableStyleInfo(e._firstHeaderCellStyle),t._lastHeaderCellStyle=t._cloneTableStyleInfo(e._lastHeaderCellStyle),t._firstFooterCellStyle=t._cloneTableStyleInfo(e._firstFooterCellStyle),t._lastFooterCellStyle=t._cloneTableStyleInfo(e._lastFooterCellStyle),t._firstRowStripSize=e._firstRowStripSize,t._secondRowStripSize=e._secondRowStripSize,t._firstColumnStripSize=e._firstColumnStripSize,t._secondColumnStripSize=e._secondColumnStripSize,t._buildInName=e._buildInName},e.prototype._isDefaultValue=function(e,t){switch(e){case"name":case"headerRowStyle":case"footerRowStyle":case"wholeTableStyle":case"highlightLastColumnStyle":case"highlightFirstColumnStyle":case"firstRowStripStyle":case"secondRowStripStyle":case"firstColumnStripStyle":case"secondColumnStripStyle":case"firstHeaderCellStyle":case"lastHeaderCellStyle":case"firstFooterCellStyle":case"lastFooterCellStyle":return t===s;case"firstRowStripSize":case"secondRowStripSize":case"firstColumnStripSize":case"secondColumnStripSize":return 1===t;default:return!1}},e.prototype.toJSON=function(){var e,o,n,r,i,a=this;if(a._buildInName)return{buildInName:a._buildInName};for(r in e={name:a._name,firstRowStripSize:a._firstRowStripSize,secondRowStripSize:a._secondRowStripSize,firstColumnStripSize:a._firstColumnStripSize,secondColumnStripSize:a._secondColumnStripSize},o=a._headerRowStyle,e.headerRowStyle=o?o.toJSON():o,o=a._footerRowStyle,e.footerRowStyle=o?o.toJSON():o,o=a._wholeTableStyle,e.wholeTableStyle=o?o.toJSON():o,o=a._highlightLastColumnStyle,e.highlightLastColumnStyle=o?o.toJSON():o,o=a._highlightFirstColumnStyle,e.highlightFirstColumnStyle=o?o.toJSON():o,o=a._firstRowStripStyle,e.firstRowStripStyle=o?o.toJSON():o,o=a._secondRowStripStyle,e.secondRowStripStyle=o?o.toJSON():o,o=a._firstColumnStripStyle,e.firstColumnStripStyle=o?o.toJSON():o,o=a._secondColumnStripStyle,e.secondColumnStripStyle=o?o.toJSON():o,o=a._firstHeaderCellStyle,e.firstHeaderCellStyle=o?o.toJSON():o,o=a._lastHeaderCellStyle,e.lastHeaderCellStyle=o?o.toJSON():o,o=a._firstFooterCellStyle,e.firstFooterCellStyle=o?o.toJSON():o,o=a._lastFooterCellStyle,e.lastFooterCellStyle=o?o.toJSON():o,n={},e)i=e[r],a._isDefaultValue(r,i)||(n[r]=i);return t.GC$.isEmptyObject(n)?l:n},e.prototype.fromJSON=function(e,t){var o,r,a,s,l,u,c,h,d,f,g,m,_,y,C,w,v,S,x,R;if(e){if(o=this,e.buildInName)return void o._copyFrom(i.getBuildInStyle(e.buildInName));typeof(r=typeof e.name!==p?e.name:e._name)!==p&&(o._name=r),typeof(a=typeof e.firstRowStripSize!==p?e.firstRowStripSize:e._firstRowStripSize)!==p&&(o._firstRowStripSize=a),typeof(s=typeof e.secondRowStripSize!==p?e.secondRowStripSize:e._secondRowStripSize)!==p&&(o._secondRowStripSize=s),typeof(l=typeof e.firstColumnStripSize!==p?e.firstColumnStripSize:e._firstColumnStripSize)!==p&&(o._firstColumnStripSize=l),typeof(u=typeof e.secondColumnStripSize!==p?e.secondColumnStripSize:e._secondColumnStripSize)!==p&&(o._secondColumnStripSize=u),typeof(c=typeof e.headerRowStyle!==p?e.headerRowStyle:e._headerRowStyle)!==p&&((R=new n).fromJSON(c,t),o._headerRowStyle=R),typeof(h=typeof e.footerRowStyle!==p?e.footerRowStyle:e._footerRowStyle)!==p&&((R=new n).fromJSON(h,t),o._footerRowStyle=R),typeof(d=typeof e.wholeTableStyle!==p?e.wholeTableStyle:e._wholeTableStyle)!==p&&((R=new n).fromJSON(d,t),o._wholeTableStyle=R),typeof(f=typeof e.highlightLastColumnStyle!==p?e.highlightLastColumnStyle:e._highlightLastColumnStyle)!==p&&((R=new n).fromJSON(f,t),o._highlightLastColumnStyle=R),typeof(g=typeof e.highlightFirstColumnStyle!==p?e.highlightFirstColumnStyle:e._highlightFirstColumnStyle)!==p&&((R=new n).fromJSON(g,t),o._highlightFirstColumnStyle=R),typeof(m=typeof e.firstRowStripStyle!==p?e.firstRowStripStyle:e._firstRowStripStyle)!==p&&((R=new n).fromJSON(m,t),o._firstRowStripStyle=R),typeof(_=typeof e.secondRowStripStyle!==p?e.secondRowStripStyle:e._secondRowStripStyle)!==p&&((R=new n).fromJSON(_,t),o._secondRowStripStyle=R),typeof(y=typeof e.firstColumnStripStyle!==p?e.firstColumnStripStyle:e._firstColumnStripStyle)!==p&&((R=new n).fromJSON(y,t),o._firstColumnStripStyle=R),typeof(C=typeof e.secondColumnStripStyle!==p?e.secondColumnStripStyle:e._secondColumnStripStyle)!==p&&((R=new n).fromJSON(C,t),o._secondColumnStripStyle=R),typeof(w=typeof e.firstHeaderCellStyle!==p?e.firstHeaderCellStyle:e._firstHeaderCellStyle)!==p&&((R=new n).fromJSON(w,t),o._firstHeaderCellStyle=R),typeof(v=typeof e.lastHeaderCellStyle!==p?e.lastHeaderCellStyle:e._lastHeaderCellStyle)!==p&&((R=new n).fromJSON(v,t),o._lastHeaderCellStyle=R),typeof(S=typeof e.firstFooterCellStyle!==p?e.firstFooterCellStyle:e._firstFooterCellStyle)!==p&&((R=new n).fromJSON(S,t),o._firstFooterCellStyle=R),typeof(x=typeof e.lastFooterCellStyle!==p?e.lastFooterCellStyle:e._lastFooterCellStyle)!==p&&((R=new n).fromJSON(x,t),o._lastFooterCellStyle=R)}},e}(),t.TableStyle=r,i=function(){function e(){}return e.light1=function(){return e._getLightStyle(1)},e.light2=function(){return e._getLightStyle(2)},e.light3=function(){return e._getLightStyle(3)},e.light4=function(){return e._getLightStyle(4)},e.light5=function(){return e._getLightStyle(5)},e.light6=function(){return e._getLightStyle(6)},e.light7=function(){return e._getLightStyle(7)},e.light8=function(){return e._getLightStyle(8)},e.light9=function(){return e._getLightStyle(9)},e.light10=function(){return e._getLightStyle(10)},e.light11=function(){return e._getLightStyle(11)},e.light12=function(){return e._getLightStyle(12)},e.light13=function(){return e._getLightStyle(13)},e.light14=function(){return e._getLightStyle(14)},e.light15=function(){return e._getLightStyle(15)},e.light16=function(){return e._getLightStyle(16)},e.light17=function(){return e._getLightStyle(17)},e.light18=function(){return e._getLightStyle(18)},e.light19=function(){return e._getLightStyle(19)},e.light20=function(){return e._getLightStyle(20)},e.light21=function(){return e._getLightStyle(21)},e.medium1=function(){return e._getMediumStyle(1)},e.medium2=function(){return e._getMediumStyle(2)},e.medium3=function(){return e._getMediumStyle(3)},e.medium4=function(){return e._getMediumStyle(4)},e.medium5=function(){return e._getMediumStyle(5)},e.medium6=function(){return e._getMediumStyle(6)},e.medium7=function(){return e._getMediumStyle(7)},e.medium8=function(){return e._getMediumStyle(8)},e.medium9=function(){return e._getMediumStyle(9)},e.medium10=function(){return e._getMediumStyle(10)},e.medium11=function(){return e._getMediumStyle(11)},e.medium12=function(){return e._getMediumStyle(12)},e.medium13=function(){return e._getMediumStyle(13)},e.medium14=function(){return e._getMediumStyle(14)},e.medium15=function(){return e._getMediumStyle(15)},e.medium16=function(){return e._getMediumStyle(16)},e.medium17=function(){return e._getMediumStyle(17)},e.medium18=function(){return e._getMediumStyle(18)},e.medium19=function(){return e._getMediumStyle(19)},e.medium20=function(){return e._getMediumStyle(20)},e.medium21=function(){return e._getMediumStyle(21)},e.medium22=function(){return e._getMediumStyle(22)},e.medium23=function(){return e._getMediumStyle(23)},e.medium24=function(){return e._getMediumStyle(24)},e.medium25=function(){return e._getMediumStyle(25)},e.medium26=function(){return e._getMediumStyle(26)},e.medium27=function(){return e._getMediumStyle(27)},e.medium28=function(){return e._getMediumStyle(28)},e.dark1=function(){return e._getDarkStyle(1)},e.dark2=function(){return e._getDarkStyle(2)},e.dark3=function(){return e._getDarkStyle(3)},e.dark4=function(){return e._getDarkStyle(4)},e.dark5=function(){return e._getDarkStyle(5)},e.dark6=function(){return e._getDarkStyle(6)},e.dark7=function(){return e._getDarkStyle(7)},e.dark8=function(){return e._getDarkStyle(8)},e.dark9=function(){return e._getDarkStyle(9)},e.dark10=function(){return e._getDarkStyle(10)},e.dark11=function(){return e._getDarkStyle(11)},e.customStyles=function(){var t=e._customStyles;return t||s},e.addCustomStyles=function(o){var n,r,i;if(o){for(e._customStyles||(e._customStyles=[]),r=(n=e._customStyles).length,i=0;i<r;i++)if(n[i].name()===o.name())throw new Error(t.SR.Exp_TableStyleAddCustomStyleError);n.push(o)}},e.removeCustomStyle=function(o){var n,r;return!!o&&(!!((n=e._customStyles)&&(r=t.util.inArray(o,n),r>-1))&&(n.splice(r,1),!0))},e.removeCustomStyleByName=function(t){var o,n,r=e._customStyles;if(r)for(o=r.length,n=0;n<o;n++)if(r[n].name()===t)return r.splice(n,1),!0;return!1},e.getBuildInStyle=function(t){var o=e[t.toLowerCase()];return o?o():new r},e._getLightStyle=function(t){var o,n,r=t-1;if(typeof e._lights===p&&(e._lights={}),e._lights[r])return e._lights[r];switch(o=s,c(r/7)){case 0:o=e._createLightA(r%7);break;case 1:o=e._createLightB(r%7);break;case 2:o=e._createLightC(r%7)}return o?(n="Light"+t,o.name(n),o.buildInName(n),e._lights[r]=o,o):s},e._createLightA=function(o){var i,a,s,l,u,c,p=e._getTheme(o),d=p+" 80",f=p,g=new r,m=new n;return m.borderBottom=new t.LineBorder(f,1),m.font=h,m.foreColor=f,g.headerRowStyle(m),(i=new n).borderTop=new t.LineBorder(f,1),i.borderBottom=new t.LineBorder(f,1),i.foreColor=f,g.wholeTableStyle(i),(a=new n).backColor=d,g.firstRowStripStyle(a),(s=new n).font=h,s.foreColor=f,g.highlightFirstColumnStyle(s),(l=new n).font=h,l.foreColor=f,g.highlightLastColumnStyle(l),(u=new n).backColor=d,g.firstColumnStripStyle(u),(c=new n).borderTop=new t.LineBorder(f,1),c.font=h,c.foreColor=f,g.footerRowStyle(c),g},e._createLightB=function(o){var i,a,s,l,u,c,p,d,f=e._getTheme(o),g=new r,m=new n;return m.backColor=f,m.font=h,m.foreColor="white",g.headerRowStyle(m),(i=new n).borderLeft=new t.LineBorder(f,1),i.borderTop=new t.LineBorder(f,1),i.borderBottom=new t.LineBorder(f,1),i.borderRight=new t.LineBorder(f,1),g.wholeTableStyle(i),(a=new n).borderTop=new t.LineBorder(f,1),g.firstRowStripStyle(a),(s=new n).borderTop=new t.LineBorder(f,1),g.secondRowStripStyle(s),(l=new n).borderLeft=new t.LineBorder(f,1),g.firstColumnStripStyle(l),(u=new n).borderLeft=new t.LineBorder(f,1),g.secondColumnStripStyle(u),(c=new n).font=h,g.highlightFirstColumnStyle(c),(p=new n).font=h,g.highlightLastColumnStyle(p),(d=new n).borderTop=new t.LineBorder(f,6),d.font=h,g.footerRowStyle(d),g},e._createLightC=function(o){var i,a,s,l,u,c,p=e._getTheme(o),d=p+" 80",f=p,g=new r,m=new n;return m.borderBottom=new t.LineBorder(f,2),m.font=h,g.headerRowStyle(m),(i=new n).borderLeft=new t.LineBorder(f,1),i.borderTop=new t.LineBorder(f,1),i.borderRight=new t.LineBorder(f,1),i.borderBottom=new t.LineBorder(f,1),i.borderHorizontal=new t.LineBorder(f,1),i.borderVertical=new t.LineBorder(f,1),g.wholeTableStyle(i),(a=new n).backColor=d,g.firstRowStripStyle(a),(s=new n).backColor=d,g.firstColumnStripStyle(s),(l=new n).font=h,g.highlightFirstColumnStyle(l),(u=new n).font=h,g.highlightLastColumnStyle(u),(c=new n).borderTop=new t.LineBorder(f,6),c.font=h,g.footerRowStyle(c),g},e._getMediumStyle=function(t){var o,n,r=t-1;if(typeof e._mediums===p&&(e._mediums={}),e._mediums[r])return e._mediums[r];switch(o=s,c(r/7)){case 0:o=e._createMediumA(r%7);break;case 1:o=e._createMediumB(r%7);break;case 2:o=e._createMediumC(r%7);break;case 3:o=e._createMediumD(r%7)}return o?(n="Medium"+t,o.name(n),o.buildInName(n),e._mediums[r]=o,o):s},e._createMediumA=function(o){var i,a,s,l,u,c,p=e._getTheme(o),d=p+" 20",f=p,g=p+" 80",m=new r,_=new n;return _.backColor=f,_.font=h,_.foreColor="white",m.headerRowStyle(_),(i=new n).borderHorizontal=new t.LineBorder(d,1),i.borderLeft=new t.LineBorder(d,1),i.borderRight=new t.LineBorder(d,1),i.borderBottom=new t.LineBorder(d,1),i.borderTop=new t.LineBorder(d,1),m.wholeTableStyle(i),(a=new n).backColor=g,m.firstRowStripStyle(a),(s=new n).backColor=g,m.firstColumnStripStyle(s),(l=new n).font=h,m.highlightFirstColumnStyle(l),(u=new n).font=h,m.highlightLastColumnStyle(u),(c=new n).borderTop=new t.LineBorder(d,6),c.font=h,c.foreColor="black",m.footerRowStyle(c),m},e._createMediumB=function(o){var i,a,s,l,u,c,p=e._getTheme(o),d="white",f=p,g=p+" 60",m=p+" 80",_=new r,y=new n;return y.backColor=f,y.borderBottom=new t.LineBorder(d,2),y.borderVertical=new t.LineBorder(d,1),y.font=h,y.foreColor="white",_.headerRowStyle(y),(i=new n).borderHorizontal=new t.LineBorder(d,1),i.borderVertical=new t.LineBorder(d,1),i.backColor=m,_.wholeTableStyle(i),(a=new n).backColor=g,_.firstRowStripStyle(a),(s=new n).backColor=g,_.firstColumnStripStyle(s),(l=new n).backColor=f,l.foreColor="white",l.font=h,_.highlightFirstColumnStyle(l),(u=new n).backColor=f,u.foreColor="white",u.font=h,_.highlightLastColumnStyle(u),(c=new n).borderTop=new t.LineBorder(d,2),c.borderVertical=new t.LineBorder(d,1),c.backColor=f,c.foreColor="white",c.font=h,_.footerRowStyle(c),_},e._createMediumC=function(o){var i,a,s,l,u,c,p,d,f=e._getTheme(o),g=0===o?"black":"#D3D3D3",m=new r,_=new n;return _.backColor=f,_.borderTop=new t.LineBorder("black",2),_.borderBottom=new t.LineBorder("black",2),_.font=h,_.foreColor="white",m.headerRowStyle(_),(i=new n).borderLeft=new t.LineBorder(g,1),i.borderRight=new t.LineBorder(g,1),i.borderTop=new t.LineBorder("black",2),i.borderVertical=new t.LineBorder(g,1),0===o&&(i.borderHorizontal=new t.LineBorder(g,1)),i.borderBottom=new t.LineBorder("black",2),m.wholeTableStyle(i),(a=new n).backColor="#D3D3D3",m.firstRowStripStyle(a),(s=new n).backColor="#D3D3D3",m.firstColumnStripStyle(s),(l=new n).backColor=f,l.foreColor="white",m.highlightFirstColumnStyle(l),(u=new n).backColor=f,u.foreColor="white",m.highlightLastColumnStyle(u),(c=new n).backColor=f,c.font=h,c.foreColor="white",m.firstFooterCellStyle(c),(p=new n).backColor=f,p.font=h,p.foreColor="white",m.lastFooterCellStyle(p),(d=new n).foreColor="black",d.borderTop=new t.LineBorder("black",6),m.footerRowStyle(d),m},e._createMediumD=function(o){var i,a,s,l,u,c,p=e._getTheme(o),d=p,f=p+" 40",g=p+" 80",m=p+" 60",_=p+" 80",y=new r,C=new n;return C.backColor=g,C.borderVertical=new t.LineBorder(f,1),C.borderLeft=new t.LineBorder(f,1),C.borderTop=new t.LineBorder(f,1),C.borderRight=new t.LineBorder(f,1),C.borderBottom=new t.LineBorder(f,1),C.font=h,C.foreColor="black",y.headerRowStyle(C),(i=new n).borderVertical=new t.LineBorder(f,1),i.borderHorizontal=new t.LineBorder(f,1),i.borderLeft=new t.LineBorder(f,1),i.borderTop=new t.LineBorder(f,1),i.borderRight=new t.LineBorder(f,1),i.borderBottom=new t.LineBorder(f,1),i.backColor=g,y.wholeTableStyle(i),(a=new n).backColor=m,y.firstRowStripStyle(a),(s=new n).backColor=m,y.firstColumnStripStyle(s),(l=new n).font=h,y.highlightFirstColumnStyle(l),(u=new n).font=h,y.highlightLastColumnStyle(u),(c=new n).backColor=_,c.foreColor="black",c.font=h,c.borderLeft=new t.LineBorder(f,1),c.borderTop=new t.LineBorder(d,2),c.borderRight=new t.LineBorder(f,1),c.borderBottom=new t.LineBorder(f,1),c.borderVertical=new t.LineBorder(f,1),y.footerRowStyle(c),y},e._getDarkStyle=function(t){var o,n,r=t-1;if(typeof e._darks===p&&(e._darks={}),e._darks[r])return e._darks[r];switch(o=s,c(r/7)){case 0:o=e._createDarkA(r%7);break;case 1:o=e._createDarkB(r%7)}return o!=s?(n="Dark"+t,o.name(n),o.buildInName(n),e._darks[r]=o,o):s},e._createDarkA=function(o){var i,a,s,l,u,c,p=e._getTheme(o),d=0===o?p+" 25":p+" -25",f=0===o?p+" 50":p,g=0===o?p:p+" -50",m=new r,_=new n;return _.backColor="black",_.font=h,_.foreColor="white",_.borderBottom=new t.LineBorder("white",2),m.headerRowStyle(_),(i=new n).backColor=f,i.foreColor="white",m.wholeTableStyle(i),(a=new n).backColor=d,m.firstRowStripStyle(a),(s=new n).backColor=d,m.firstColumnStripStyle(s),(l=new n).font=h,l.borderRight=new t.LineBorder("white",2),l.backColor=d,l.foreColor="white",m.highlightFirstColumnStyle(l),(u=new n).font=h,u.borderLeft=new t.LineBorder("white",2),u.backColor=d,u.foreColor="white",m.highlightLastColumnStyle(u),(c=new n).backColor=g,c.font=h,c.foreColor="white",c.borderTop=new t.LineBorder("white",2),m.footerRowStyle(c),m},e._createDarkB=function(o){e._getTheme(o);var i,a,s,l,u,c,p=e._getHeaderColor(o),d=e._getStripColor(o),f=e._getTableBackground(o),g=f,m=new r,_=new n;return _.backColor=p,_.foreColor="white",m.headerRowStyle(_),(i=new n).backColor=f,m.wholeTableStyle(i),(a=new n).backColor=d,m.firstRowStripStyle(a),(s=new n).backColor=d,m.firstColumnStripStyle(s),(l=new n).font=h,m.highlightFirstColumnStyle(l),(u=new n).font=h,m.highlightLastColumnStyle(u),(c=new n).backColor=g,c.font=h,c.borderTop=new t.LineBorder("black",6),m.footerRowStyle(c),m},e._getTableBackground=function(e){return 0===e?"Background 1 -15":1===e?"Accent 1 80":2===e?"Accent 3 80":3===e?"Accent 5 80":""},e._getStripColor=function(e){return 0===e?"Background 1 -35":1===e?"Accent 1 60":2===e?"Accent 3 60":3===e?"Accent 5 60":""},e._getHeaderColor=function(e){return 0===e?"Text 1":1===e?"Accent 2":2===e?"Accent 4":3===e?"Accent 6":""},e._getTheme=function(e){return 0===e?"Text 1":"Accent "+e},e}(),t.TableStyles=i,a=function(){function e(e){this._sheet=e,this._tableList=[],this._updateDataSourceSuspended=!1}return e.prototype.suspendUpdateDataSource=function(){this._updateDataSourceSuspended=!0},e.prototype.resumeUpdateDataSource=function(){this._updateDataSourceSuspended=!1},e.prototype.isUpdateDataSourceSuspended=function(){return this._updateDataSourceSuspended},e.prototype.resetTablesBindingManager=function(){for(var e,t=this.getTables(),o=0,n=t.length;o<n;o++)(e=t[o]).bindingPath()&&e.resetBindingManager()},e.prototype.getSheet=function(){return this._sheet},e.prototype.getCount=function(){return this._tableList.length},e.prototype.getTables=function(){return this._tableList},e.prototype.clearTables=function(){var e,t,o=this._tableList,n=this._sheet,r=n.isPaintSuspended();n.isPaintSuspended(!0);try{for(e=0,t=o.length;e<t;e++)this.remove(o[e],!0),this.onTableRemoved(o[e])}finally{n.isPaintSuspended(r)}},e.prototype.add=function(e){var o,n,r;if(e){for(this,o=this._tableList.length,r=0;r<o;r++)if((n=this._tableList[r])&&n.name()===e.name())throw new Error(t.SR.Exp_TableHasSameNameError);return e._setOwner(this),e._applyBindingPath(),this._tableList.push(e),e.showHeader()&&e._syncHeader(),e.showFooter()&&e._syncFooter(),this.onTableAdded(e),e}},e.prototype.remove=function(e,o){var n,r,i;if(e){if((n=t.util.inArray(e,this._tableList))>-1){if(this._tableList.splice(n,1),!1!==o){var a=e.range(),l=this._sheet,u=l.isPaintSuspended();l.isPaintSuspended(!0);try{var c=a.row,h=a.row+a.rowCount,p=a.col,d=a.col+a.colCount;for(r=c;r<h;r++)for(i=p;i<d;i++)l.setFormula(r,i,s),l.setValue(r,i,s)}finally{l.isPaintSuspended(u)}}return this.onTableRemoved(e),e}return s}},e.prototype.find=function(e,t){var o,n,r,i=this._tableList.length;if(0===i)return s;for(n=0;n<i;n++)if((r=(o=this._tableList[n]).range()).row<=e&&e<r.row+r.rowCount&&r.col<=t&&t<r.col+r.colCount)return o;return s},e.prototype.findByRange=function(e,t,o,n){var r,i,a,l=this._tableList.length;if(0===l)return s;for(r=[],a=0;a<l;a++)(i=this._tableList[a]).range().intersect(e,t,o,n)&&r.push(i);return r},e.prototype.findByName=function(e){for(var t,o=this._tableList.length,n=0;n<o;n++)if((t=this._tableList[n]).name().toLowerCase()===e.toLowerCase())return t;return s},e.prototype.has=function(e,t,o,n){for(var r=this._tableList.length,i=0;i<r;i++)if(this._tableList[i].range().intersect(e,t,o,n))return!0;return!1},e.prototype.addRows=function(e,o){for(var n,r,i,a,s,l,u=this._tableList,c=[],h=0,p=u.length;h<p;h++)n=(d=u[h]).getSource(),t.ArrayHelper.contains(c,n)?d._addRows(e,o,!0):d._addRows(e,o,this.isUpdateDataSourceSuspended())&&c.push(n);if(!this.isUpdateDataSourceSuspended())try{for(i=(r=this._sheet).isPaintSuspended(),r.isPaintSuspended(!0),this.suspendUpdateDataSource(),h=0,p=u.length;h<p;h++){var d,f=(d=u[h]).getSourceRowCount(),g=d.dataRange();f>0&&f!==g.rowCount&&(a=f,d.showHeader()&&(a+=1),d.showFooter()&&(a+=1),s=d.range(),l=new t.Range(s.row,s.col,a,g.colCount),d._resize(l,this.isUpdateDataSourceSuspended()))}}finally{this.resumeUpdateDataSource(),r.isPaintSuspended(i)}},e.prototype.addColumns=function(e,t){for(var o=this._tableList.length,n=0;n<o;n++)this._tableList[n]._addColumns(e,t)},e.prototype.removeRows=function(e,o){for(var n,r,i,a,s,l=this._tableList,u=[],c=[],h=0,p=l.length;h<p;h++){var d=(g=l[h]).getSource(),f=g.range();e<=f.row&&f.row+f.rowCount<=e+o||(t.ArrayHelper.contains(u,d)?g._removeRows(e,o,!0):g._removeRows(e,o,this.isUpdateDataSourceSuspended())&&u.push(d),c.push(g))}if(this._tableList=c,!this.isUpdateDataSourceSuspended())try{for(r=(n=this._sheet).isPaintSuspended(),n.isPaintSuspended(!0),this.suspendUpdateDataSource(),l=this._tableList,h=0,p=l.length;h<p;h++){var g,m=(g=l[h]).getSourceRowCount(),_=g.dataRange();m>0&&m!==_.rowCount&&(i=m,g.showHeader()&&(i+=1),g.showFooter()&&(i+=1),a=g.range(),s=new t.Range(a.row,a.col,i,_.colCount),g._resize(s,this.isUpdateDataSourceSuspended()))}}finally{this.resumeUpdateDataSource(),n.isPaintSuspended(r)}},e.prototype.removeColumns=function(e,t){for(var o,n,r=[],i=this._tableList.length,a=0;a<i;a++)e<=(o=(n=this._tableList[a]).range()).col&&o.col+o.colCount<=e+t||(n._removeColumns(e,t),r.push(n));this._tableList=r},e.prototype.clear=function(e,o,n,r,i){var a,l,u,c,h=new t.Range(e,o,n,r),p=[];if(1==(1&i)){for(u=[],a=this._tableList.length,c=0;c<a;c++)l=this._tableList[c],h.containsRange(l.range())?p.push(l):u.push(l);for(a=u.length,c=0;c<a;c++)(l=u[c])._clear(e,o,n,r);this._tableList=u}if(2==(2&i))for(a=this._tableList.length,c=0;c<a;c++)l=this._tableList[c],h.containsRange(l.range())&&l.style(s);for(c=0;c<p.length;c++)this.onTableRemoved(p[c]);return p},e.prototype.onTableRemoved=function(e){e&&e.hasSlicerData()&&e.getSlicerData().onTableRemoved(e)},e.prototype.onTableAdded=function(e){e&&e.hasSlicerData()&&e.getSlicerData().onTableAdded(e)},e.prototype.copy=function(e,t,o,n,r,i){for(var a=this._tableList.length,s=0;s<a;s++)this._tableList[s]._copy(e,t,o,n,r,i)},e.prototype.move=function(e,t,o,n,r,i){for(var a=this._tableList.length,s=0;s<a;s++)this._tableList[s]._move(e,t,o,n,r,i)},e.prototype.getNoConflictTableName=function(e){for(var t=1;this.findByName(e);)e="table"+t,t++;return e},e.prototype.toJSON=function(){var e,t,o=this._tableList;if(!o||0===o.length)return l;for(e=[],t=0;t<o.length;t++)e.push(o[t].toJSON());return 0===e.length?l:e},e.prototype.fromJSON=function(e,t){var o,n,r;if(e&&0!==e.length)for(o=0;o<e.length;o++)n=e[o],(r=new f)._setOwner(this),r.fromJSON(n,t),this._tableList.push(r)},e}(),t._SheetTableManager=a}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){var t,o,n,r,i,a,s;e.feature("group",["core.common","core.stringResource"]);var l,u=null,c=void 0,h=Math.max,p=Math.min,d="undefined",f="gc-group",g="gc-group-box";(l=e.GroupState||(e.GroupState={}))[l.Expanded=0]="Expanded",l[l.Collapsed=1]="Collapsed",e.GroupState,t=function(){function e(e,t,o,n){var r=this;r.model=u,r.children=u,r.parent=u,r.start=0,r.end=0,r.level=0,r.model=e,r.start=t,r.end=o,r.level=n}return e.prototype.getState=function(){return this.model?this.model.getState(this):0},e.prototype.setState=function(e){this.model&&this.model.expand(this.level,0===e)},e.prototype.contains=function(e){return this.start<=e&&e<=this.end},e.prototype.addChild=function(e){e&&(this.children||(this.children=[]),this.children.push(e),e.parent=this)},e}(),e.RangeGroupInfo=t,o=function(){function e(){this.count=0}return e.prototype.addRef=function(){this.count++},e.prototype.release=function(){this.count--},e.prototype.isWorking=function(){return this.count>0},e}(),e.WorkingState=o,n=function(){function n(e){this.head=u,this.tail=u,this.items=u,this._rootCached=u,this.direction=1,this.suspendAddingGroup=new o,this.items=new Array(e),this._empty=!0}return n.prototype.setDirection=function(e){this.direction=e},n.prototype.getDirection=function(){return this.direction},n.prototype._getCount=function(){var e=this.items;return e?e.length:0},n.prototype.group=function(t,o){var n,i,a,s=this;if(!s._isIndexValid(t))throw new Error(e.SR.Exp_InvalidIndex);if(!s._isIndexValid(t+o-1))throw new Error(e.SR.Exp_InvalidCount);for(s._rootCached=u,n=0;n<o;n++)i=t+n,a=s._getModelIndexFromViewIndex(i),s.items[a]?s.items[a].level++:s.items[a]=new r;s._rootCached=s.createRangeGroup(),s._empty=!1,s.groupChangeHandler&&s.groupChangeHandler()},n.prototype.ungroupRange=function(t,o){var n,r,i,a,s,l,h,p=this;if(!p._isIndexValid(t))throw new Error(e.SR.Exp_InvalidIndex);if(!p._isIndexValid(t+o-1))throw new Error(e.SR.Exp_InvalidCount);var d=!1,f=u,g=-1;if(1===p.direction){if(g=t+o,d=p._isIndexValid(g)){var m=t+o-1,_=m,y=u;do{n=p._getModelIndexFromViewIndex(m),(y=p.items[n])!==c&&y!==u&&(_=m),m--}while((y===c||y===u)&&m>=t);y!==c&&y!==u&&((f=p._findImp(p._rootCached,_,y.level))&&(g=f.end+1),d=f&&(f.end===t+o-1||1===p.getState(f)))}}else if(0===p.direction&&(g=t-1,d=p._isIndexValid(g))){var C=t,w=C,v=u;do{r=p._getModelIndexFromViewIndex(C),(v=p.items[r])!==c&&v!==u&&(w=C),C++}while((v===c||v===u)&&C<t+o);v!==c&&v!==u&&((f=p._findImp(p._rootCached,w,v.level))&&(g=f.start-1),d=f&&(f.start===t||1===p.getState(f)))}for(p._rootCached=u,i=0;i<o;i++)a=t+i,s=p._getModelIndexFromViewIndex(a),p.items[s]&&p.items[s].level>-1&&p.items[s].level--;d&&(l=p._getModelIndexFromViewIndex(g),(h=p.items[l])&&h.level===f.level&&(p.items[l]=u)),p._rootCached=p.createRangeGroup(),p.groupChangeHandler&&p.groupChangeHandler()},n.prototype.ungroup=function(){var e;this._rootCached=u,e=this._getCount(),this.items=new Array(e),this._rootCached=this.createRangeGroup(),this._empty=!0,this.groupChangeHandler&&this.groupChangeHandler()},n.prototype._expand=function(t,o,n){if(!this._isIndexValid(t))throw new Error(e.SR.Exp_InvalidIndex);if(o<-1)throw new Error(e.SR.Exp_InvalidLevel);var r=this.find(t,o);r&&this.expandGroup(r,n)},n.prototype.expand=function(t,o){if(t<-1)throw new Error(e.SR.Exp_InvalidLevel);for(var n=new i(this);n.moveNext();)this._expand(n.current,t,o)},n.prototype.expandGroup=function(t,o){if(!t)throw new Error(e.SR.Exp_GroupInfoIsNull);var n=-1;switch(this.direction){case 0:n=t.start-1;break;case 1:n=t.end+1}this.setCollapsed(n,!o)},n.prototype.isCollapsed=function(e){var t,o=this.getLevel(e);if(o>-1)for(t=this._findImp(this._rootCached,e,o);t;){if(1===t.getState())return!0;t=t.parent}return!1},n.prototype.find=function(t,o){var n=this._rootCached;if(n){if(-1===o)return n;if(!this._isIndexValid(t))throw new Error(e.SR.Exp_InvalidIndex);return this._findImp(n,t,o)}return u},n.prototype.getLevel=function(t){if(!this._isIndexValid(t))throw new Error(e.SR.Exp_InvalidIndex);var o=this._getModelIndexFromViewIndex(t),n=this.items[o];return n?n.level:-1},n.prototype.getCollapsed=function(e){var t=this._getModelIndexFromViewIndex(e),o=this.items[t];return!!o&&!!o.collapsed},n.prototype.setCollapsed=function(e,t){var o,n,i=this,a=!1;if(e<0)(o=i.head)||(o=i.head=new r),o.collapsed!==t&&(o.collapsed=t,a=!0);else if(e>-1&&e<i._getCount()){var s=i._getModelIndexFromViewIndex(e),l=i.items,c=l[s];c||((c=l[s]=new r).level=-1),c.collapsed!==t&&(c.collapsed=t,a=!0)}else e>=i._getCount()&&((n=i.tail)||(n=i.tail=new r),n.collapsed!==t&&(n.collapsed=t,a=!0));a&&(i._rootCached=u,i.refresh(),i.groupChangeHandler&&i.groupChangeHandler())},n.prototype.getMaxLevel=function(){for(var e,t,o=-1,n=this.items,r=n.length,i=0;i<r;i++)typeof(t=(e=n[i])&&e.level)!==d&&t>o&&(o=t);return o},n.prototype._move=function(t,o,n){var i,a,s,l,c;if(n>0){if(t<0&&(t=0),o<0&&(o=0),t===o)return;for(i=[],a=e.ArrayHelper.nextNonEmptyIndex(this.items,t-1);a>=0&&a<t+n;)s=new r(this.items[a]),i.push({index:a-t,value:s}),a=e.ArrayHelper.nextNonEmptyIndex(this.items,a);if(e.ArrayHelper.clear(this.items,t,n),e.ArrayHelper.clear(this.items,o,n),i.length>0)for(l=0;l<i.length;l++)c=i[l],this.items[o+c.index]=c.value;this._rootCached=u,this.refresh()}},n.prototype._copy=function(t,o,n){var i,a,s,l,c;if(n>0){if(t<0&&(t=0),o<0&&(o=0),t===o)return;for(i=[],a=e.ArrayHelper.nextNonEmptyIndex(this.items,t-1);a>=0&&a<t+n;)s=new r(this.items[a]),i.push({index:a-t,value:s}),a=e.ArrayHelper.nextNonEmptyIndex(this.items,a);if(e.ArrayHelper.clear(this.items,o,n),i.length>0)for(l=0;l<i.length;l++)c=i[l],this.items[o+c.index]=c.value;this._rootCached=u,this.refresh()}},n.prototype._add=function(e,t){var o,n,i,a,s,l,c=this;if(t>0){for(n=(o=c._getModelIndexFromViewIndex(e))>1?c.items[o-1]:u,i=0;i<t;i++)c.items.splice(o,0,n?new r(n):u);if(!c.suspendAddingGroup.isWorking()&&e>0&&(a=c._getModelIndexFromViewIndex(e-1),s=u,s=a<0?c.head:c.items[a]))for(l=0;l<t;l++)c.items[e+l]=new r({collapsed:s.collapsed,level:s.level});c._rootCached=u,c.refresh()}},n.prototype._remove=function(e,t){t>0&&(this.items.splice(e,t),this._rootCached=u,this.refresh())},n.prototype.equals=function(e){var t,o=this,n=e;if(n){if(!o.items&&n.items&&n.items.length>0||!n.items&&o.items&&o.items.length>0||!o.rangeGroupItemInfoEquals(o.head,n.head)||!o.rangeGroupItemInfoEquals(o.tail,n.tail))return!1;if(o.items&&n.items){if(o.direction!==n.direction||o.items.length!==n.items.length)return!1;for(t=0;t<o.items.length;t++)if(!o.items[t]&&n.items[t]||o.items[t]&&!n.items[t])return!1}return!0}return!1},n.prototype._isEmpty=function(){return this._empty},n.prototype.refresh=function(){this._isEmpty()||(this._rootCached=this.createRangeGroup())},n.prototype._setCount=function(e){var t,o,n,i=this;if(i.items||(i.items=new Array(e)),i._rootCached=u,e<(t=i._getCount()))i.items.splice(e,t-e);else if(e>t)if(o=i.items[i.items.length-1])for(n=0;n<e-t;n++)i.items.push(new r(o));else i.items=i.items.concat(new Array(e-t));i.refresh()},n.prototype.getState=function(e){var t,o,n,r=-1;switch(this.direction){case 1:r=e.end+1;break;case 0:r=e.start-1}return t=u,o=this._getCount(),r<0&&(t=this.head),r>-1&&r<o?(n=this._getViewIndexFromModelIndex(r),t=this.items[n]):r>=o&&(t=this.tail),t&&t.collapsed?1:0},n.prototype._setLevel=function(e,t){var o,n=this;e<0?(n.head||(n.head=new r),n.head.level=t):e>-1&&e<n._getCount()?(o=n._getModelIndexFromViewIndex(e),n.items[o]||(n.items[o]=new r,n.items[o].level=-1),n.items[o].level=t):e>=n._getCount()&&(n.tail||(n.tail=new r),n.tail.level=t),n._rootCached=u,n.refresh()},n.prototype.suspendAdding=function(){this.suspendAddingGroup.addRef()},n.prototype.resumeAdding=function(){this.suspendAddingGroup.release()},n.prototype._getViewIndexFromModelIndex=function(e){return e},n.prototype._getModelIndexFromViewIndex=function(e){return e},n.prototype.rangeGroupItemInfoEquals=function(e,t){return e?!!t&&(e.level===t.level&&e.collapsed===t.collapsed):!t},n.prototype.createRangeGroup=function(){for(var e,o=new t(this,0,this._getCount()-1,-1),n=new i(this);n.moveNext();)(e=this._createRangeGroup(n,0))&&e.level>-1&&o.addChild(e);return o},n.prototype._createRangeGroup=function(e,o){var n,r=u;do{var i=e.current,a=this._getModelIndexFromViewIndex(i),s=this.items[a],l=e.nextToCurrent();if(!(s.level<o)&&(s.level>=o&&(r||(r=new t(this,i,i,o))),s.level>o&&(n=this._createRangeGroup(e,o+1),e.current>-1?(i=e.current,l=e.nextToCurrent()):(i=n.end,l=-1),r.addChild(n)),i>r.end&&(r.end=i),this.isGroupEnd(i,l,o)))return r}while(e.moveNext());return r},n.prototype.isGroupEnd=function(e,t,o){var n,r,i,a,s=this._getModelIndexFromViewIndex(e),l=this.items[s];if(!this._isIndexValid(t)||(n=this._getModelIndexFromViewIndex(t),!(r=this.items[n])))return!0;if(r.level<l.level){if((i=l.level-r.level)===(a=l.level-o))return!1;if(a>=0&&a<i)return!0}return!1},n.prototype._isIndexValid=function(e){return e>=-1&&e<this._getCount()},n.prototype._findImp=function(e,t,o){var n,r,i,a;if(e)for((n=[]).unshift(e);n.length>0;){if((e=n.pop()).level===o&&e.contains(t))return e;if((i=(r=e.children)&&r.length)>0)for(a=0;a<i;a++)n.unshift(r[a])}return u},n.prototype.fromJSON=function(e,t){var o,n,i,a,s;if(e){if(this,o=this.items,e.itemsData)for(n=e.itemsData.length,i=0;i<n;i++)if((a=e.itemsData[i]).count>0&&a.index>=0&&a.info){for(s=0;s<a.count&&!(a.index+s>=o.length);s++)o[a.index+s]=new r(a.info);this._empty=!1}e.direction!==u&&e.direction!==c&&(this.direction=e.direction),e.head&&(this.head=e.head),e.tail&&(this.tail=e.tail),this._rootCached=u,this.refresh()}},n.prototype.toJSON=function(){for(var t,o,n,r,i=[],a=-1,s=this.items,l=0;l<s.length;l++)s[l]&&(a>=0&&l===i[a].count+i[a].index&&s[l].level===i[a].info.level&&s[l].collapsed===i[a].info.collapsed?i[a].count++:i[++a]={index:l,count:1,info:s[l]});for(n in o={},t={itemsData:i,direction:this.direction,head:this.head,tail:this.tail})r=t[n],this._isDefaultValue(n,r)||(o[n]=r);return e.GC$.isEmptyObject(o)?c:o},n.prototype._isDefaultValue=function(e,t){switch(e){case"head":case"tail":return t===u;case"direction":return 1===t;case"itemsData":return 0===t.length;default:return!1}},n}(),e.RangeGroup=n,r=function(){return function(e){this!==e&&e&&(this.level=e.level,this.collapsed=e.collapsed),e||(this.level=0,this.collapsed=!1)}}(),e.RangeGroupItemInfo=r,i=function(){function e(e){this.isEOF=!1,this.rangeGroup=u,this.current=-1,this.rangeGroup=e}return e.prototype.nextToCurrent=function(){return this.current+1},e.prototype.moveNext=function(){var e,t,o,n=this;if(n.isEOF||!n.rangeGroup||!n.rangeGroup.items)return!1;for(e=!1,t=n.current+1;t<n.rangeGroup.items.length;t++)if(o=n.rangeGroup._getModelIndexFromViewIndex(t),n.rangeGroup.items[o]){e=!0,n.current=t;break}return e||(n.current=-1),n.current>-1||(n.isEOF=!0,!1)},e.prototype.reset=function(){this.isEOF=!1,this.current=-1},e}(),e.GroupedItemIndexEnumerator=i,a=function(){function t(e,t,o,n){var r=this;r.PADDING=2,r.LINE_SIZE=2,r.STARTLINE_SIZE=6,r._groupLineInfos=u,r._groupDotInfos=u,r._groupButtonInfos=u,r._sheet=e,r._rowGroup=t,r._viewportIndex=o,r._maxLevel=typeof n===d?t?e.rowRangeGroup.getMaxLevel():e.colRangeGroup.getMaxLevel():n}return t.prototype.createGroupInfo=function(){var e,t;if(this._groupLineInfos=[],this._groupDotInfos=[],this._groupButtonInfos=[],e=this._rowGroup,-1!==this._maxLevel){var o,n=this._sheet._getGroupLayout(),r=this._calcMinWidthOrHeight({width:n.width,height:n.height},e),i=this.getGroupsByLevel(0,e),a=i.length;if(a>0)for(t=0;t<a;t++)o=i[t],this._measureGroups(o,r)}},t.prototype.paintGroups=function(e){this._rowGroup?this._paintRowGroups(e):this._paintColumnGroups(e)},t.prototype._calcMinWidthOrHeight=function(e,t){var o,n=this._maxLevel;return o=t?(e.width-2*this.PADDING)/(n+2):(e.height-2*this.PADDING)/(n+2),h(0,o)},t.prototype._measureGroups=function(t,o){var n,r,i,a,s,l,c,d,f,g,m,_,y,C,w,v,S,x,R,b=this,T=b._rowGroup,A=b.getGroupDirection(T),I=b.getViewportStartIndex(T),D=b.getViewportEndIndex(T),F=t.start,M=t.end;if(0===t.getState()){if(a=!0,(s=t.parent)&&(0===A&&F===s.start||1===A&&M===s.end)&&(a=!1),a&&(n={isExpanded:!0,level:t.level,paintLine:!0},1===A?(r=M+1)>=I&&r<=D&&(n.index=r,n.lineDirection=1,b._groupButtonInfos.push(n)):0===A&&((r=F-1)>=I&&r<=D&&(n.index=r,n.lineDirection=0,b._groupButtonInfos.push(n)))),F<=D&&M>=I){for(l=h(I,F),c=p(D,M),a&&(d={start:l,end:c,level:t.level,startLine:u},(1===A&&l===F||0===A&&c===M)&&(d.startLine=!0),b._groupLineInfos.push(d)),f=[],i=l;i<=c;i++)f.push(i);if((m=(g=t.children)&&g.length)>0)for(i=0;i<m;i++){var E=g[i],N=E.start,O=E.end;if(1===E.getState())for(_=N;_<=O;_++)e.ArrayHelper.remove(f,_);1===A?e.ArrayHelper.remove(f,O+1):0===A&&e.ArrayHelper.remove(f,N-1),b._measureGroups(E,o)}if(y=!0,m>0)for(C=0;C<m;C++)if(w=g[C]){if(v=w.start,S=w.end,v===F&&S===M){y=!1;break}if(1===A&&S===M||0===A&&v===F)for(x=v;x<=S;x++)e.ArrayHelper.remove(f,x)}if(y&&f.length>0)for(i=0;i<f.length;i++)R={index:f[i],level:t.level+1},b._groupDotInfos.push(R)}}else 1===t.getState()&&(n={isExpanded:!1,level:t.level},1===A?(r=M+1)>=I&&r<=D&&(n.index=r,n.lineDirection=1,b._groupButtonInfos.push(n)):0===A&&((r=F-1)>=I&&r<=D&&(n.index=r,n.lineDirection=0,b._groupButtonInfos.push(n))))},t.prototype._paintRowGroups=function(t){var o,n,r,i,a,s,l,c,d,m,_,y,C,w,v,S,x=this;if(-1!==x._maxLevel){var R=x._sheet,b=R._getGroupLayout(),T=x._calcMinWidthOrHeight({width:b.width,height:b.height},!0);if(0!==T){t.save();var A,I,D,F,M=x.STARTLINE_SIZE,E=x.PADDING,N=x.LINE_SIZE,O=h(0,(T-M)/2)+E,P=R._getRowLayout(x._viewportIndex,3),L=e.ThemeStyleHelper.getCssClassThemeStyle(f).color,H=e.ThemeStyleHelper.getCssClassThemeStyle(g);if(t.fillStyle=L,(n=(o=x._groupDotInfos)&&o.length)>0)for(D=0;D<n;D++)r=o[D],(F=P.findRow(r.index))&&F.height>=N&&(A=r.level*T+O,I=F.y+h(0,(F.height-N)/2),i=N,a=N,t.fillRect(b.x+A+.5,b.y+I,i,a));var k=R.rowRangeGroup.direction,V=x._groupLineInfos,B=V&&V.length;if(B>0)for(D=0;D<B;D++){var z=V[D],G=z.start,W=z.end,j=u,U=u;do{j=P.findRow(G),G++}while(!j&&G<=W);do{U=P.findRow(W),W--}while(!U&&W>=G);(j||U)&&(!j&&U?j=U:j&&!U&&(U=j),A=z.level*T+O,I=j.y,1===k&&(I+=1),s=N,l=h(0,U.y+U.height-j.y),t.fillRect(b.x+A+.5,b.y+I,s,l),z.startLine&&((c=p(M,T-N))>0&&(0===k&&(I=I+l-N),I>=j.y&&I<U.y+U.height&&t.fillRect(b.x+A+.5,b.y+I,c,N))))}if((m=(d=x._groupButtonInfos)&&d.length)>0)for(D=0;D<m;D++)_=d[D],!(F=P.findRow(_.index))||F&&F.height<=0||(y=h(0,(F.height-T)/2),A=_.level*T+E,I=F.y+y,C=T,w=p(T,F.height),t.strokeStyle=H.borderTopColor,t.lineWidth=1,t.fillStyle=H.backgroundColor,t.fillRect(b.x+A,b.y+I,C,w),t.strokeRect(b.x+A+.5,b.y+I,C,w),t.fillStyle=L,_.isExpanded||t.fillRect(b.x+A+C/2-1+.5,b.y+I+4,2,w-8),t.fillRect(b.x+A+4+.5,b.y+I+w/2-1,C-8,2),_.paintLine&&w<F.height&&(A=_.level*T+O,I=F.y,v=N,S=y,0===_.lineDirection&&(I+=y+w,S=F.height-w-y),t.fillRect(b.x+A+.5,b.y+I,v,S)));t.stroke(),t.beginPath(),t.restore()}}},t.prototype._paintColumnGroups=function(t){var o,n,r,i,a,s,l,c,d,m,_,y,C,w,v,S,x=this;if(-1!==x._maxLevel){var R=x._sheet,b=R._getGroupLayout(),T=x._calcMinWidthOrHeight({width:b.width,height:b.height},!1);if(0!==T){var A,I,D,F,M=x.STARTLINE_SIZE,E=x.PADDING,N=x.LINE_SIZE,O=h(0,(T-M)/2)+E,P=R._getColumnLayout(x._viewportIndex,3),L=e.ThemeStyleHelper.getCssClassThemeStyle(f).color,H=e.ThemeStyleHelper.getCssClassThemeStyle(g);for(t.save(),t.fillStyle=L,n=(o=x._groupDotInfos).length,D=0;D<n;D++)r=o[D],(F=P.findCol(r.index))&&F.width>=N&&(A=F.x+h(0,(F.width-N)/2),I=r.level*T+O,i=N,a=N,t.fillRect(b.x+A,b.y+I+.5,i,a));var k=R.colRangeGroup.direction,V=x._groupLineInfos,B=V.length;for(D=0;D<B;D++){var z=V[D],G=z.start,W=z.end,j=u,U=u;do{j=P.findCol(G),G++}while(!j&&G<=W);do{U=P.findCol(W),W--}while(!U&&W>=G);(j||U)&&(!j&&U?j=U:j&&!U&&(U=j),A=j.x,1===k&&(A+=1),I=z.level*T+O,s=h(0,U.x+U.width-j.x),l=N,t.fillRect(b.x+A,b.y+I+.5,s,l),z.startLine&&((c=p(M,T-N))>0&&(0===k&&(A=A+s-N),A>=j.x&&A<U.x+U.width&&t.fillRect(b.x+A,b.y+I+.5,N,c))))}for(m=(d=x._groupButtonInfos).length,D=0;D<m;D++)_=d[D],!(F=P.findCol(_.index))||F&&F.width<=0||(y=h(0,(F.width-T)/2),A=F.x+y,I=_.level*T+E,C=p(T,F.width),w=T,t.strokeStyle=H.borderTopColor,t.lineWidth=1,t.fillStyle=H.backgroundColor,t.fillRect(b.x+A,b.y+I,C,w),t.strokeRect(b.x+A,b.y+I+.5,C,w),t.fillStyle=L,_.isExpanded||t.fillRect(b.x+A+C/2-1,b.y+I+4.5,2,w-8),t.fillRect(b.x+A+4,b.y+I+w/2-.5,C-8,2),_.paintLine&&C<F.width&&(A=F.x,I=_.level*T+O,v=y,S=N,0===_.lineDirection&&(A+=y+C,v=F.width-C-y),t.fillRect(b.x+A,b.y+I+.5,v,S)));t.beginPath(),t.restore()}}},t.prototype.getRowOrColumnStartIndex=function(e){var t,o,n,r,i=this._sheet,a=this._viewportIndex;if(e){if((t=i._getRowLayout(a))&&t.length>0)return o=t[0].row,h(0,o-1)}else if((n=i._getColumnLayout(a))&&n.length>0)return r=n[0].col,p(0,r-1);return-1},t.prototype.getRowOrColumnCount=function(e){var t,o,n,r,i=this._sheet,a=this._viewportIndex;if(e){if((t=i._getRowLayout(a))&&t.length>0)return o=t[t.length-1].row,p(i.getRowCount(),o+2)}else if((n=i._getColumnLayout(a))&&n.length>0)return r=n[n.length-1].col,p(i.getColumnCount(),r+2);return-1},t.prototype.getGroupsByLevel=function(e,t){for(var o,n=[],r=this.getRowOrColumnStartIndex(t),i=this.getRowOrColumnCount(t),a=t?this._sheet.rowRangeGroup:this._sheet.colRangeGroup;r<i;)(o=a.find(r,e))?(r=o.end+1,n.push(o)):r++;return n},t.prototype.getGroupDirection=function(e){return e?this._sheet.rowRangeGroup.direction:this._sheet.colRangeGroup.direction},t.prototype.getViewportStartIndex=function(e){var t=this._sheet,o=this._viewportIndex;if(e){if(0===o)return 0;if(1===o)return t.getFrozenRowCount();if(2===o)return t.getRowCount()-t.getFrozenTrailingRowCount()}else{if(0===o)return 0;if(1===o)return t.getFrozenColumnCount();if(2===o)return t.getColumnCount()-t.getFrozenTrailingColumnCount()}return-1},t.prototype.getViewportEndIndex=function(e){var t=this._sheet,o=this._viewportIndex;if(e){if(0===o)return t.getFrozenRowCount()-1;if(1===o)return t.getRowCount()-t.getFrozenTrailingRowCount()-1;if(2===o)return t.getRowCount()-1}else{if(0===o)return t.getFrozenColumnCount()-1;if(1===o)return t.getColumnCount()-t.getFrozenTrailingColumnCount()-1;if(2===o)return t.getColumnCount()-1}return-1},t.prototype._processTouch=function(e){e&&this._sheet._isTouchMode&&(e.x-=2,e.y-=2,e.width+=4,e.height+=4)},t.prototype.getRowGroupButton=function(t,o){var n,r,i,a;if(-1===this._maxLevel)return u;var s=this._sheet,l=s._getGroupLayout(),c=this._calcMinWidthOrHeight({width:l.width,height:l.height},!0);if(0===c)return u;var d,f,g=s._getRowLayout(this._viewportIndex,3),m=this._groupButtonInfos,_=m&&m.length;if(_>0)for(n=0;n<_;n++)if(r=m[n],(i=g.findRow(r.index))&&(!i||!(i.height<=0))){a=h(0,(i.height-c)/2),d=r.level*c+this.PADDING,f=i.y+a;var y=c,C=p(y,i.height),w=new e.Rect(l.x+d+.5,l.y+f+.5,y,C);if(this._processTouch(w),w.contains(t,o))return r}return u},t.prototype.getColGroupButton=function(t,o){var n,r,i,a;if(-1===this._maxLevel)return u;var s=this._sheet,l=s._getGroupLayout(),c=this._calcMinWidthOrHeight({width:l.width,height:l.height},!1);if(0===c)return u;var d,f,g=s._getColumnLayout(this._viewportIndex,3),m=this._groupButtonInfos,_=m&&m.length;if(_>0)for(n=0;n<_;n++)if(r=m[n],(i=g.findCol(r.index))&&(!i||!(i.width<=0))){a=h(0,(i.width-c)/2),d=i.x+a,f=r.level*c+this.PADDING;var y=c,C=p(y,i.width),w=new e.Rect(l.x+d+.5,l.y+f+.5,C,y);if(this._processTouch(w),w.contains(t,o))return r}return u},t}(),e._RangeGroupPresenter=a,s=function(){function t(e,t,o){this._sheet=u,this._rowGroup=u,this._maxLevel=-1,this.PADDING=2,this._sheet=e,this._rowGroup=t,this._maxLevel=typeof o===d?t?e.rowRangeGroup.getMaxLevel():e.colRangeGroup.getMaxLevel():o}return t.prototype.paintGroupHeader=function(t){var o=this._sheet,n=this._maxLevel;if(o&&!(n<0)){var r=this._rowGroup,i=o._getGroupLayout(),a=this._calcMinWidthOrHeight({width:i.width,height:i.height},r);if(0!==a){var s,l,u,c,p,d,m,_,y,C=n+2,w=o._getSheetLayout(),v=e.ThemeStyleHelper.getCssClassThemeStyle(f),S=e.ThemeStyleHelper.getCssClassThemeStyle(g);if(t.fillStyle=v.backgroundColor,t.strokeStyle=S.borderTopColor,t.font="8.25pt Arial",t.lineWidth=1,r){if(t.fillRect(i.x,i.y,i.width,w.height),t.strokeRect(i.x-.5,i.y-.5,i.width,w.height+1),t.strokeRect(i.x-.5,w.headerY-.5,i.width,w.colHeaderHeight),o.colHeaderVisible&&w.colHeaderHeight>=a)for(s=this.PADDING,l=h(0,w.headerY+(w.colHeaderHeight-a)/2),u=0;u<C;u++)c=a-1,p=i.x+s+.5,d=i.y+l,t.fillStyle=S.backgroundColor,t.fillRect(p,d,c,c),t.strokeRect(p,d,c,c),t.fillStyle=S.color,m=""+(u+1),_=t.measureText(m).width,y=o._getFontHeight(t.font),c>=_&&a>=y&&(t.textBaseline="middle",t.fillText(m,p+(c-_)/2,d+c/2)),s+=a}else if(t.fillRect(i.x,i.y,w.width,i.height),t.strokeRect(i.x-.5,i.y-.5,w.width+1,i.height),t.strokeRect(w.headerX-.5,i.y-.5,w.rowHeaderWidth,i.height),o.rowHeaderVisible&&w.rowHeaderWidth>=a)for(s=h(0,w.headerX+(w.rowHeaderWidth-a)/2),l=this.PADDING,u=0;u<C;u++)c=a-1,p=i.x+s,d=i.y+l+.5,t.fillStyle=S.backgroundColor,t.fillRect(p,d,c,c),t.strokeRect(p,d,c,c),t.fillStyle=S.color,m=""+(u+1),_=t.measureText(m).width,y=o._getFontHeight(t.font),c>=_&&a>=y&&(t.textBaseline="middle",t.fillText(m,p+(c-_)/2,d+c/2)),l+=a}}},t.prototype.getGroupButton=function(t,o){var n,r,i,a,s,l=this._sheet,c=this._maxLevel;if(!l||c<0)return u;var p=this._rowGroup,d=l._getGroupLayout(),f=this._calcMinWidthOrHeight({width:d.width,height:d.height},p);if(0===f)return u;if(n=c+2,s=l._getSheetLayout(),p){if(l.colHeaderVisible&&s.colHeaderHeight>=f)for(r=this.PADDING,i=h(0,s.headerY+(s.colHeaderHeight-f)/2),a=0;a<n;a++){if(new e.Rect(d.x+r,d.y+i,f,f).contains(t,o))return{index:a};r+=f}}else if(l.rowHeaderVisible&&s.rowHeaderWidth>=f)for(r=h(0,s.headerX+(s.rowHeaderWidth-f)/2),i=this.PADDING,a=0;a<n;a++){if(new e.Rect(d.x+r,d.y+i,f,f).contains(t,o))return{index:a};i+=f}return u},t.prototype._calcMinWidthOrHeight=function(e,t){var o,n=this._maxLevel;return o=t?(e.width-2*this.PADDING)/(n+2):(e.height-2*this.PADDING)/(n+2),h(0,o)},t}(),e._RangeGroupHeaderPresenter=s}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){function t(e,t,o,n,r){if(e)return r?r.call(t,t[o]):t[o];var i=t[o];return t[o]=n,r&&r.call(t,i!==n),t}var o,n,r,i,a,s,l;e.feature("sparkline",["core.common","core.theme","core.sheet_model"]);var u,c,h,p,d=null,f=void 0,g=Math.min,m=Math.floor,_=Math.max,y=Math.abs,C=Math.PI,w="undefined",v={Black:"black",Blue:"Blue",Brown:"Brown"},S={FromArgb:function(t,o,n,r){return new e._Color(t,o,n,r).toString()}};e.__invalidValuePlaceHolder={},(u=e.EmptyValueStyle||(e.EmptyValueStyle={}))[u.Gaps=0]="Gaps",u[u.Zero=1]="Zero",u[u.Connect=2]="Connect",e.EmptyValueStyle,(c=e.SparklineAxisMinMax||(e.SparklineAxisMinMax={}))[c.individual=0]="individual",c[c.group=1]="group",c[c.custom=2]="custom",e.SparklineAxisMinMax,o=function(){function o(e){var t,o=this;if(e)for(t in e)t&&(o[t]=e[t]);else o._axisColor=v.Black,o._firstMarkerColor=S.FromArgb(255,149,179,215),o._highMarkerColor=v.Blue,o._lastMarkerColor=S.FromArgb(255,149,179,215),o._lowMarkerColor=v.Blue,o._markersColor=S.FromArgb(255,36,64,98),o._negativeColor=v.Brown,o._seriesColor=S.FromArgb(255,36,64,98),o.displayEmptyCellsAs=0,o.rightToLeft=!1,o.displayHidden=!1,o.displayXAxis=!1,o._showFirst=!1,o._showHigh=!1,o._showLast=!1,o._showLow=!1,o._showNegative=!1,o._showMarkers=!1,o.manualMax=0,o.manualMin=0,o.maxAxisType=0,o.minAxisType=0,o.groupMaxValue=0,o.groupMinValue=0,o.lineWeight=1;o._worksheet=d}return o.prototype.axisColor=function(e){return t(0===arguments.length,this,"_axisColor",e)},o.prototype.firstMarkerColor=function(e){return t(0===arguments.length,this,"_firstMarkerColor",e)},o.prototype.highMarkerColor=function(e){return t(0===arguments.length,this,"_highMarkerColor",e)},o.prototype.lastMarkerColor=function(e){return t(0===arguments.length,this,"_lastMarkerColor",e)},o.prototype.lowMarkerColor=function(e){return t(0===arguments.length,this,"_lowMarkerColor",e)},o.prototype.markersColor=function(e){return t(0===arguments.length,this,"_markersColor",e)},o.prototype.negativeColor=function(e){return t(0===arguments.length,this,"_negativeColor",e)},o.prototype.seriesColor=function(e){return t(0===arguments.length,this,"_seriesColor",e)},o.prototype.showFirst=function(e){return t(0===arguments.length,this,"_showFirst",e)},o.prototype.showHigh=function(e){return t(0===arguments.length,this,"_showHigh",e)},o.prototype.showLast=function(e){return t(0===arguments.length,this,"_showLast",e)},o.prototype.showLow=function(e){return t(0===arguments.length,this,"_showLow",e)},o.prototype.showNegative=function(e){return t(0===arguments.length,this,"_showNegative",e)},o.prototype.showMarkers=function(e){return t(0===arguments.length,this,"_showMarkers",e)},o.prototype.clone=function(){var e=this,t=new o;return t._axisColor=e._axisColor,t._firstMarkerColor=e._firstMarkerColor,t._highMarkerColor=e._highMarkerColor,t._lastMarkerColor=e._lastMarkerColor,t._lowMarkerColor=e._lowMarkerColor,t._markersColor=e._markersColor,t._negativeColor=e._negativeColor,t._seriesColor=e._seriesColor,t.displayEmptyCellsAs=e.displayEmptyCellsAs,t.rightToLeft=e.rightToLeft,t.displayHidden=e.displayHidden,t.displayXAxis=e.displayXAxis,t._showFirst=e._showFirst,t._showHigh=e._showHigh,t._showLast=e._showLast,t._showLow=e._showLow,t._showNegative=e._showNegative,t._showMarkers=e._showMarkers,t.manualMax=e.manualMax,t.manualMin=e.manualMin,t.maxAxisType=e.maxAxisType,t.minAxisType=e.minAxisType,t.groupMaxValue=e.groupMaxValue,t.groupMinValue=e.groupMinValue,t.lineWeight=e.lineWeight,t},o.prototype._setThemeContext=function(e){this._worksheet=e},o.prototype._getActualColor=function(t){var o=this._worksheet;return o?function(t,o){if(o&&t){var n=e._ThemeContext.getColor(o,t);if(n)return n}return t}(this[t](),o):d},o.prototype._isDefaultValue=function(e,t){switch(e){case"axisColor":return t===v.Black;case"firstMarkerColor":return t===S.FromArgb(255,149,179,215);case"highMarkerColor":return t===v.Blue;case"lastMarkerColor":return t===S.FromArgb(255,149,179,215);case"lowMarkerColor":return t===v.Blue;case"markersColor":return t===S.FromArgb(255,36,64,98);case"negativeColor":return t===v.Brown;case"seriesColor":return t===S.FromArgb(255,36,64,98);case"displayEmptyCellsAs":return 0===t;case"rightToLeft":case"displayHidden":case"displayXAxis":case"showFirst":case"showHigh":case"showLast":case"showLow":case"showNegative":case"showMarkers":return!1===t;case"manualMax":case"manualMin":case"maxAxisType":case"minAxisType":return 0===t;case"lineWeight":return 1===t;default:return!1}},o.prototype.toJSON=function(){var t,o,n=this,r={axisColor:n._axisColor,firstMarkerColor:n._firstMarkerColor,highMarkerColor:n._highMarkerColor,lastMarkerColor:n._lastMarkerColor,lowMarkerColor:n._lowMarkerColor,markersColor:n._markersColor,negativeColor:n._negativeColor,seriesColor:n._seriesColor,displayEmptyCellsAs:n.displayEmptyCellsAs,rightToLeft:n.rightToLeft,displayHidden:n.displayHidden,displayXAxis:n.displayXAxis,showFirst:n._showFirst,showHigh:n._showHigh,showLast:n._showLast,showLow:n._showLow,showNegative:n._showNegative,showMarkers:n._showMarkers,manualMax:n.manualMax,manualMin:n.manualMin,maxAxisType:n.maxAxisType,minAxisType:n.minAxisType,lineWeight:n.lineWeight},i={};for(t in r)o=r[t],n._isDefaultValue(t,o)||(i[t]=o);return e.GC$.isEmptyObject(i)?f:i},o}(),e.SparklineSetting=o,(h=e.SparklineType||(e.SparklineType={}))[h.line=0]="line",h[h.column=1]="column",h[h.winloss=2]="winloss",e.SparklineType,(p=e.DataOrientation||(e.DataOrientation={}))[p.Vertical=0]="Vertical",p[p.Horizontal=1]="Horizontal",e.DataOrientation,n=function(){function n(e,t){this.displayDateAxis=!1,this._sparklineGroupManager=d,this._innerList=[],this._axisReference=d,this._axisOrientation=1,this.setting=t,this.sparklineType=e}return n.prototype.add=function(e){e&&(this._innerList.push(e),e.group(this),this._adjustGroupMaxMinValue(),this.onGroupChanged())},n.prototype.clear=function(){this._innerList&&0!==this._innerList.length&&(this._innerList=[])},n.prototype.remove=function(t){return e.ArrayHelper.remove(this._innerList,t),t.onSparklineChanged(),t._group=this.clone(),this._adjustGroupMaxMinValue(),this.onGroupChanged(),this._innerList},n.prototype.contains=function(t){return e.ArrayHelper.contains(this._innerList,t)},n.prototype.onGroupChanged=function(){var e,t;if(this._innerList)for(e=0;e<this._innerList.length;e++)(t=this._innerList[e])&&t.onSparklineChanged()},n.prototype.clone=function(){var e=this.setting?this.setting.clone():d,t=new n(this.sparklineType,e);return t.displayDateAxis=this.displayDateAxis,t._axisReference=this._axisReference,t._axisOrientation=this._axisOrientation,t},n.prototype.dateAxisData=function(e){return 0===arguments.length?t(!0,this,"_axisReference",e):t(!1,this,"_axisReference",e,function(e){e&&this.onGroupChanged()})},n.prototype.dateAxisOrientation=function(e){return 0===arguments.length?t(!0,this,"_axisOrientation",e):t(!1,this,"_axisOrientation",e,function(e){e&&this.onGroupChanged()})},n.prototype.count=function(){return this._innerList.length},n.prototype._adjustGroupMaxMinValue=function(){var e,t=this;if(t.setting){t.setting.groupMaxValue=-Number.MAX_VALUE,t.setting.groupMinValue=Number.MAX_VALUE;var o=1===t.setting.maxAxisType,n=1===t.setting.minAxisType,r=!1;if(o||n)for(e=0;e<t._innerList.length;e++){var i=t._innerList[e],a=t._getMaxMinValues(i),s=a.min,l=a.max;o&&t.setting.groupMaxValue<l&&(t.setting.groupMaxValue=l,r=!0),n&&t.setting.groupMinValue>s&&(t.setting.groupMinValue=s,r=!0)}return r}},n.prototype._getMaxMinValues=function(t){var o,n,r,i,a=-Number.MAX_VALUE,s=Number.MAX_VALUE,l=t.data();if(l)for(o=t._provideValues(l,t.dataOrientation(),!1),n=0;n<o.length;n++)(r=o[n])===e.__invalidValuePlaceHolder&&(r=0),"number"==typeof r&&(a=a<(i=r)?i:a,s=s>i?i:s);return{min:s,max:a}},n.prototype._isDefaultValue=function(e,t){switch(e){case"setting":return t===d;case"displayDateAxis":return!1===t;case"axisReference":return t===d;case"axisOrientation":return 1===t;case"sparklines":return 0===t.length;default:return!1}},n.prototype.toJSON=function(){var t,o,n={setting:this.setting?this.setting.toJSON():d,displayDateAxis:this.displayDateAxis,sparklineType:this.sparklineType,axisReference:this._axisReference,axisOrientation:this._axisOrientation,sparklines:this._innerList},r={};for(t in n)o=n[t],this._isDefaultValue(t,o)||(r[t]=o);return e.GC$.isEmptyObject(r)?f:r},n.prototype.fromJSON=function(e,t){var n,r,i,s,l,u,c,h;if(e){if((n=this).setting=new o,e.setting)for(i in r=e.setting,n.setting)n.setting.hasOwnProperty(i)&&(r.hasOwnProperty(i)?n.setting[i]=r[i]:"_"===i.substr(0,1)&&(s=i.substr(1),r.hasOwnProperty(s)&&(n.setting[i]=r[s])));if(e.displayDateAxis!==f&&e.displayDateAxis!==d&&(n.displayDateAxis=e.displayDateAxis),e.sparklineType!==f&&e.sparklineType!==d&&(n.sparklineType=e.sparklineType),e.axisReference!==f&&e.axisReference!==d&&(n._axisReference=e.axisReference),e.axisOrientation!==f&&e.axisOrientation!==d&&(n._axisOrientation=e.axisOrientation),e.sparklines)for(n._innerList=[],u=(l=e.sparklines).length,c=0;c<u;c++)(h=new a).fromJSON(l[c],t),n.add(h)}},n}(),e.SparklineGroup=n,r=function(){return function(e,t,o,n){var r=this;r.X=e,r.Y=t,r.Width=o,r.Height=n,r.Left=r.X,r.Right=r.Left+r.Width,r.Top=r.Y,r.Bottom=r.Y+r.Height}}(),e._PositionRect=r,i=function(){function o(e){this._minItemHeight=2,this.info=e,this._clearCache()}return o.prototype.sparklineInfo=function(e){return t(0===arguments.length,this,"info")},o.prototype.paint=function(e,t,o,n,r){this._clearCache();var i=this._getWorksheet(),a=this.info,s=this._getCachedValues(),l=a.dateAxisData()?this._getCachedDatetimes():[],u=i._zoomFactor;a.setting()._setThemeContext(i),this._paintCore(e,t,o,n,r,s,l,u)},o.prototype._paintCore=function(e,t,o,n,r,i,a,s){e.save(),e.rect(t,o,n,r),e.clip(),e.beginPath();0===this.info.sparklineType()&&this._paintLines(e,t,o,n,r,i,a,s),this._paintDataPoints(e,t,o,n,r,i,a,s),this._paintAxis(e,t,o,n,r,i,a,s),e.restore()},o.prototype._clearCache=function(){this._cachedMinDatetime=Number.MAX_VALUE,this._cachedMaxDatetime=-Number.MAX_VALUE,this._cachedMinValue=Number.MAX_VALUE,this._cachedMaxValue=-Number.MAX_VALUE,this._cachedIndexMapping=d,this._cachedValues=d,this._cachedDatetimes=d},o.prototype._getWorksheet=function(){var e=this.info,t=e&&e.group(),o=t&&t._sparklineGroupManager;if(o)return o._sheet},o.prototype._getSpace=function(e,t){return 0===this.info.sparklineType()?3+this._getLineWeight(t)+1:3},o.prototype._leftSpace=function(e){return this._getSpace("left",e)},o.prototype._rightSpace=function(e){return this._getSpace("right",e)},o.prototype._topSpace=function(e){return this._getSpace("top",e)},o.prototype._bottomSpace=function(e){return this._getSpace("bottom",e)},o.prototype._getCachedValues=function(){var e=this._cachedValues;if(!e){var t=this.info,o=t.data(),n=t.dataOrientation();e=this._cachedValues=t._provideValues(o,n)}return e},o.prototype._getCachedDatetimes=function(){var e=this._cachedDatetimes;if(!e){var t=this.info,o=t.group(),n=o.dateAxisData(),r=o.dateAxisOrientation();e=this._cachedDatetimes=t._provideValues(n,r,!0)}return e},o.prototype._getCachedIndexMaping=function(t,o){var n,r,i,a,s,l,u,c=this._cachedIndexMapping;if(c)return c;if(c=this._cachedIndexMapping=[],n=e.__invalidValuePlaceHolder,r=t.length,this.sparklineInfo().displayDateAxis()){var h=o.length,p=g(r,h),m=[];for(p>0&&(m=o.slice(0,p)),m.sort(function(e,t){return e===t?0:(e===n&&(e=0),t===n&&(t=0),e-t)}),s=m.length,i=0;i<s;i++)if(typeof(l=m[i])!==w&&l!==d){for(u=e.ArrayHelper.indexOf(o,l);e.ArrayHelper.contains(c,u);)u=e.ArrayHelper.indexOf(o,l,u+1);isNaN(l)||((a=t[u])!==f&&a!==d&&isNaN(a)&&a!==n||c.push(u))}}else for(i=0;i<r;i++)typeof(a=t[i])!==w&&a!==d&&isNaN(a)&&a!==n||c.push(i);return c},o.prototype._getValue=function(t,o){var n=o[t];return typeof n===w||n===d?1===this.sparklineInfo().setting().displayEmptyCellsAs&&(n=0):n===e.__invalidValuePlaceHolder&&(n=0),n},o.prototype._paintLines=function(e,t,o,n,r,i,a,s){var l,u,c,h,p,f,g,m,_,y,C,v,S,x,R=this._getCachedIndexMaping(i,a),b=R.length-1;for(b<0&&(b=0),h=this.linePos=[],y=this.sparklineInfo().setting().displayEmptyCellsAs,l=0;l<b;l++)if(typeof(p=this._getValue(R[l],i))!==w&&p!==d){if(g=l+1,typeof(f=this._getValue(R[g],i))===w||f===d)if(1===y)f=0;else if(2===y)for(g=l+2;g<=b;g++)if(typeof(C=i[R[g]])!==w&&C!==d){f=C;break}typeof f!==w&&f!==d?(m=this._getDataPointPosition(R[l],{Width:n,Height:r},i,a,s),_=this._getDataPointPosition(R[g],{Width:n,Height:r},i,a,s),v=m.Width/2,u={X:m.X+v,Y:m.Y+v},c={X:_.X+v,Y:_.Y+v},h[l]={P1:u,P2:c}):l++}if((S=h.length)>0)for(e.strokeStyle=this.info.setting()._getActualColor("seriesColor"),e.lineCap="round",e.lineWidth=this._getLineWeight(s),l=0;l<S;l++)(x=h[l])&&(e.beginPath(),u=x.P1,c=x.P2,e.moveTo(t+u.X,o+u.Y),e.lineTo(t+c.X,o+c.Y),e.stroke(),e.closePath())},o.prototype._getDataPointColor=function(t,o,n){var r,i=d,a=(Number.MAX_VALUE,Number.MAX_VALUE,this._getValue(t,o)),s=this.info.setting(),l=this._cachedMinValue,u=this._cachedMaxValue,c=this._getCachedIndexMaping(o,n),h=c.length,p=this.info,g=p.group();return typeof a!==w&&a!==d&&((l===Number.MAX_VALUE||u===-Number.MAX_VALUE)&&this._getMaxMinValue(o),a===l&&s.showLow()&&(i=s._getActualColor("lowMarkerColor")),(typeof i===w||i===d)&&(a===u&&s.showHigh()&&(i=s._getActualColor("highMarkerColor"))),(typeof i===w||i===d)&&(g.displayDateAxis?0===e.ArrayHelper.indexOf(c,t)&&s.showFirst()&&(i=s._getActualColor("firstMarkerColor")):0===t&&s.showFirst()&&(i=s._getActualColor("firstMarkerColor"))),(typeof i===w||i===d)&&(g.displayDateAxis?e.ArrayHelper.indexOf(c,t)===h-1&&s.showLast()&&(i=s._getActualColor("lastMarkerColor")):t===h-1&&s.showLast()&&(i=s._getActualColor("lastMarkerColor"))),(typeof i===w||i===d)&&a<0&&s.showNegative()&&(i=s._getActualColor("negativeColor")),(typeof i===w||i===d)&&(0===(r=p.sparklineType())?s.showMarkers()&&(i=s._getActualColor("markersColor")):1===r?i=s._getActualColor("seriesColor"):2===r&&(i=s._getActualColor("seriesColor")))),i===f||i===d?"Transparent":i},o.prototype._paintDataPoints=function(e,t,o,n,r,i,a,s){for(var l,u,c,h,p,d,f,g,_,y={Width:n,Height:r},w=this._getCachedIndexMaping(i,a),v=w.length,S=this.info.sparklineType(),x=0;x<v;x++)l=w[x],u=this._getDataPointColor(l,i,a),c=this._getDataPointPosition(l,y,i,a,s),e.fillStyle!==u&&(e.fillStyle=u),0===S?(e.save(),h=t+c.X+c.Width/2,p=o+c.Y+c.Height/2,e.translate(h,p),e.rotate(C/4),e.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),e.restore()):(d=t+c.X+c.Width/4,d=m(d),f=o+c.Y,g=c.Width/2,_=c.Height,e.fillRect(d,f,g,_))},o.prototype._paintAxis=function(e,t,o,n,r,i,a,s){var l=this.info.setting();if(l.displayXAxis&&this._hasAxis(i,a)){var u={Width:n,Height:r},c=this._leftSpace(s),h=u.Width-this._rightSpace(s),p=m(this._getAxisY(u,i,s))+.5,d=p,f=l._getActualColor("axisColor"),g=s;g<1&&(g=1),e.strokeStyle!==f&&(e.strokeStyle=f),e.lineWidth!==g&&(e.lineWidth=g),e.beginPath(),e.moveTo(t+c,o+p),e.lineTo(t+h,o+d),e.stroke()}},o.prototype._hasAxisNormal=function(e){var t,o=this._getActualMaxValue(e);return o===-Number.MAX_VALUE||(t=this._getActualMinValue(e))===Number.MAX_VALUE||(o===t||o*t<=0)},o.prototype._hasAxis=function(e,t){var o,n,r,i,a=this._hasAxisNormal(e);if(2!==this.info.sparklineType())return a;if(n=(o=this._getCachedIndexMaping(e,t)).length,!a&&n>0)for(i=0;i<n;i++)if(typeof(r=e[o[i]])!==w&&r!==d)return!0;return a},o.prototype._getMinDatetime=function(e,t){var o=this._cachedMinDatetime;return(isNaN(o)||o===Number.MAX_VALUE)&&this._getMaxMindatetimes(e,t),this._cachedMinDatetime},o.prototype._getMaxDatetime=function(e,t){var o=this._cachedMaxDatetime;return(isNaN(o)||o===-Number.MAX_VALUE)&&this._getMaxMindatetimes(e,t),this._cachedMaxDatetime},o.prototype._getMaxMindatetimes=function(e,t){for(var o,n,r,i=new Date(0,0,0),a=Number.MAX_VALUE,s=this._getCachedIndexMaping(e,t),l=s.length,u=0;u<l;u++)n=t[o=s[u]],isNaN(n)||((r=this._getValue(o,e))!==d&&typeof r===w||isNaN(r))||typeof n!==w&&n!==d&&(n>i&&(i=n),n<a&&(a=n));this._cachedMaxDatetime=i,this._cachedMinDatetime=a},o.prototype._calcItemWidth=function(e,t,o,n){for(var r,i,a,s,l,u=this._getMinDatetime(t,o),c=this._getMaxDatetime(t,o),h=[],p=this._getCachedIndexMaping(t,o),f=p.length,g=0;g<f;g++)typeof(r=o[p[g]])===w||r===d||isNaN(r)||r&&h.push(r);if(h.sort(function(e,t){return e-t}),(i=h.length)>1&&u!==c){for(a=Number.MAX_VALUE,s=0,g=1;g<i;g++)(r=h[g]-h[g-1])<a&&r>0&&(a=r),s+=r;return(l=(e.Width-this._leftSpace(n)-this._rightSpace(n))*a/s/2)<2&&(l=2),l}return(e.Width-this._leftSpace(n)-this._rightSpace(n))/2},o.prototype._getItemWidth=function(e,t,o,n){var r;return this.info.displayDateAxis()?this._calcItemWidth(e,t,o,n):(r=this._getCachedIndexMaping(t,o).length,(e.Width-this._leftSpace(n)-this._rightSpace(n))/r)},o.prototype._getItemX=function(t,o,n,r,i){var a,s,l,u,c,h,p=this._leftSpace(i);return this.sparklineInfo().displayDateAxis()?(a=this._getItemWidth(t,n,r,i),(s=this._getMaxDatetime(n,r))===(l=this._getMinDatetime(n,r))?p+a/2:(u=r[o])?(c=t.Width-p-this._rightSpace(i),p+m((u-l)/(s-l)*(c-=a))):0):(a=this._getItemWidth(t,n,r,i),h=e.ArrayHelper.indexOf(this._getCachedIndexMaping(n,r),o),m(p+a*h))},o.prototype._getCanvasSize=function(e,t){var o,n=e.Width-this._leftSpace(t)-this._rightSpace(t);return n=_(n,0),o=e.Height-this._topSpace(t)-this._bottomSpace(t),{Width:n,Height:o=_(o,0)}},o.prototype._getMaxMinValue=function(e){for(var t,o=e.length,n=0;n<o;n++)typeof(t=e[n])!==w&&t!==d&&("number"!=typeof t&&(t=0),t<this._cachedMinValue&&(this._cachedMinValue=t),t>this._cachedMaxValue&&(this._cachedMaxValue=t))},o.prototype._getActualMaxValue=function(e){var t,o;return this._cachedMaxValue!==-Number.MAX_VALUE&&this._cachedMaxValue||this._getMaxMinValue(e),0===(o=(t=this.info.setting()).maxAxisType)?this._cachedMaxValue:1===o?t.groupMaxValue:2===o?t.manualMax:this._cachedMaxValue},o.prototype._getActualMinValue=function(e){var t,o;return this._cachedMinValue!==Number.MAX_VALUE&&this._cachedMinValue||this._getMaxMinValue(e),0===(o=(t=this.info.setting()).minAxisType)?this._cachedMinValue:1===o?t.groupMinValue:2===o?t.manualMin:void 0},o.prototype._getItemHeightNormal=function(e,t,o,n){var r,i=this._getCanvasSize(e,n),a=this._getActualMaxValue(o),s=this._getActualMinValue(o),l=a-s;if(a===s){if(0===a)return 0;l=y(a)}return(r=o[t])||(r=0),r*(i.Height/l)},o.prototype._getItemHeight=function(e,t,o,n){var r,i,a,s=this.info,l=s.sparklineType();if(0===l)return this._getItemHeightNormal(e,t,o,n);if(1===l){if((typeof(r=o[t])===w||r===d)&&1===s.setting().displayEmptyCellsAs)return 0;if((i=this._getItemHeightNormal(e,t,o,n))>-this._minItemHeight&&i<this._minItemHeight){if(r>0)return i+this._minItemHeight;if(r<0)return i-this._minItemHeight}return i}return 2===l?typeof(r=o[t])===w||r===d||0===r||isNaN(r)?0:(a=this._getCanvasSize(e,n),r>=0?a.Height/2:-a.Height/2):void 0},o.prototype._getAxisYNormal=function(e,t,o){var n,r,i=this._getCanvasSize(e,o),a=this._getActualMaxValue(t),s=this._getActualMinValue(t);if(a===-Number.MAX_VALUE||s===Number.MAX_VALUE)return e.Height/2;if(n=a-s,a===s){if(0===a)return e.Height/2;n=a,a<0&&(a=0)}return r=i.Height/n,this._topSpace(o)+a*r},o.prototype._getAxisY=function(e,t,o){return 2===this.info.sparklineType()?e.Height/2:this._getAxisYNormal(e,t,o)},o.prototype._getItemVisibleHeightNormal=function(e,t,o,n){var r,i,a=this._getCanvasSize(e,n),s=this._getActualMaxValue(o),l=this._getActualMinValue(o),u=s-l;if(s===l){if(0===s)return 0;u=s}return r=a.Height/u,(typeof(i=this._getValue(t,o))===w||i===d)&&(i=0),s!==l&&s*l>0?(0,i>=0?(i-l)*r:(i-s)*r):i*r},o.prototype._getItemVisibleHeight=function(e,t,o,n){var r,i,a,s=this.info.sparklineType();return 0===s?this._getItemVisibleHeightNormal(e,t,o,n):1===s?(r=this._getItemVisibleHeightNormal(e,t,o,n))>-(i=this._minItemHeight)&&r<i&&((typeof(a=this._getValue(t,o))===w||a===d)&&(a=0),0!==a)?a>0?r+i:r-i:r:2===s?this._getItemHeight(e,t,o,n):void 0},o.prototype._getDataPointPositionNormal=function(e,t,o,n,i){var a,s,l,u,c=this,h=c._getItemWidth(t,o,n,i),p=c._getItemX(t,e,o,n,i);h<0&&(h=0),(h=m(h))%2==1&&(h+=1);var d=c._getItemHeight(t,e,o,i),f=c._getAxisY(t,o,i),g=c._getActualMaxValue(o),C=c._getActualMinValue(o),w=0;return g<0&&C<0?w=_(c._topSpace(i),f):(w=f,d>=0&&(w=f-d)),a=c._getItemVisibleHeight(t,e,o,i),s=new r(p,w,h,y(a)),0!==d&&(l=c._topSpace(i),s.Y<l&&s.Bottom<l+1?s.Height=m(s.Height+1):(u=t.Height-c._bottomSpace(i),s.Bottom>u&&s.Y>u-1&&(s.Y=u-a,s.Height=a))),s},o.prototype._getLineWeight=function(e){var t=this.info.setting().lineWeight*e;return t<1&&(t=1),t},o.prototype._getDataPointPosition=function(e,t,o,n,i){var a,s,l=this._getLineWeight(i);if(++l<2&&(l=2),a=this._getDataPointPositionNormal(e,t,o,n,i),0===this.info.sparklineType()&&(a.X=a.X+(a.Width-l)/2,typeof(s=this._getValue(e,o))!==w&&s!==d?(s>=0?a.Y-=l/2:a.Y=a.Bottom-l/2,a.Width=l,a.Height=l):(a.Width=0,a.Height=0)),this.info.group().setting.rightToLeft){var u=a.X,c=t.Width-u-a.Width;a=new r(c,a.Y,a.Width,a.Height)}return a},o}(),e.SparklineRender=i,a=function(){function t(e,t,o,r,a,s){this.row=e,this.column=t,this._dataOrientation=r,this._data=o,this._group=new n(a,s),this._group.add(this),this._renderer=new i(this)}return t.prototype.group=function(e){var t,o=this;return 0===arguments.length?((t=o._group)||((t=new n).add(o),o._group=t),t):(e!==o._group&&(o._group&&o._group.remove(o),o._group=e,o._group&&(o._group.contains(o)||o._group.add(o)),o.onSparklineChanged()),o)},t.prototype.sparklineType=function(e){return 0===arguments.length?this.group().sparklineType:(this.group().sparklineType!==e&&(this.group().sparklineType=e,this.onSparklineChanged()),this)},t.prototype.onSparklineChanged=function(){var e=this._getWorksheet();e&&(this,e.triggerSparklineChanged({sheet:e,sheetName:e._name,sparkline:this}))},t.prototype.setting=function(e){return 0===arguments.length?this.group().setting:(this.group().setting=e,this)},t.prototype.data=function(e){return 0===arguments.length?this._data:(this._data!==e&&(this._data=e,this.onSparklineChanged()),this)},t.prototype.dataOrientation=function(e){return 0===arguments.length?this._dataOrientation:(this._dataOrientation!==e&&(this._dataOrientation=e,this.onSparklineChanged()),this)},t.prototype.dateAxisData=function(e){return 0===arguments.length?this.group().dateAxisData():(this.group().dateAxisData(e),this)},t.prototype.dateAxisOrientation=function(e){return 0===arguments.length?this.group().dateAxisOrientation():(this.group().dateAxisOrientation(e),this)},t.prototype.displayDateAxis=function(e){return 0===arguments.length?this.group().displayDateAxis:(this.group().displayDateAxis=e,this)},t.prototype.clone=function(){var e=new t;return e.row=this.row,e.column=this.column,e.data(this.data()),e.dataOrientation(this.dataOrientation()),e.group(this.group().clone()),e},t.prototype.paintSparkline=function(e,t,o,n,r){this._renderer.paint(e,t,o,n,r)},t.prototype._provideValues=function(t,o,n){var r,i,a,s,l,u,c,h,p,g,m=this._getWorksheet(),_=[];if(!m)return _;for(g=t,r=1===o?g.colCount:g.rowCount,i=0;i<r;i++)c=m,h=i,p=t,a=1===o?c.getValue(p.row,p.col+h):c.getValue(p.row+h,p.col),!this.setting().displayHidden&&(s=m,l=i,u=t,1===o?s.getColumnWidth(u.col+l)<=0||s.getRowHeight(u.row)<=0:s.getRowHeight(u.row+l)<=0||s.getColumnWidth(u.col)<=0)?a=NaN:a!==d&&a!==f&&(n?a="number"==typeof a?e._DateTimeHelper.fromOADate(a):Date.parse(a):"number"!=typeof a&&(a=e.__invalidValuePlaceHolder)),_.push(a);return _},t.prototype._getWorksheet=function(){return this.group()&&this.group()._sparklineGroupManager?this.group()._sparklineGroupManager._sheet:d},t.prototype._isDefaultValue=function(e,t){switch(e){case"axisReference":return t===d;case"axisOrientation":return 1===t;default:return!1}},t.prototype.toJSON=function(){var e,t,o={row:this.row,col:this.column,orientation:this._dataOrientation,data:this._data,type:this._group.sparklineType,setting:this._group.setting,axisReference:this._group._axisReference,axisOrientation:this._group._axisOrientation},n={};for(e in o)t=o[e],this._isDefaultValue(e,t)||(n[e]=t);return n},t.prototype.fromJSON=function(t,o){var n;t&&(this,t.row!==f&&t.row!==d&&(this.row=t.row),t.col!==f&&t.col!==d&&(this.column=t.col),t.orientation!==f&&t.orientation!==d&&(this._dataOrientation=t.orientation),t.data&&(n=t.data,this._data=new e.Range(n.row,n.col,n.rowCount,n.colCount)))},t}(),e.Sparkline=a,s=function(){function o(e,t){this._groups=[],this._sheet=e,this.evaluator=t}return o.prototype.groups=function(e){return t(0===arguments.length,this,"_groups")},o.prototype.add=function(e){this.groups().push(e),e._sparklineGroupManager=this,e._adjustGroupMaxMinValue()},o.prototype.remove=function(t){e.ArrayHelper.remove(this.groups(),t)},o.prototype.contains=function(t){return e.ArrayHelper.contains(this.groups(),t)},o.prototype.count=function(){return this.groups().length},o.prototype._addRows=function(e,t){for(var o,n,r,i,a,s=0;s<this._groups.length;s++)for((o=this._groups[s]).displayDateAxis&&(n=this._addRowRange(e,t,o.dateAxisData()),o.dateAxisData(n)),r=0;r<o._innerList.length;r++)e<=(i=o._innerList[r]).row&&(i.row+=t),a=this._addRowRange(e,t,i.data()),i.data(a)},o.prototype._addColumns=function(e,t){for(var o,n,r,i,a,s=0;s<this._groups.length;s++)for((o=this._groups[s]).displayDateAxis&&(n=this._addColumnRange(e,t,o.dateAxisData()),o.dateAxisData(n)),r=0;r<o._innerList.length;r++)e<=(i=o._innerList[r]).column&&(i.column+=t),a=this._addColumnRange(e,t,i.data()),i.data(a)},o.prototype._removeRows=function(e,t){for(var o,n,r,i,a,s,l=0;l<this._groups.length;l++){if((o=this._groups[l]).displayDateAxis){if((n=this._removeRowRange(e,t,o.dateAxisData()))===d||n===f){o.clear(),this.remove(o);continue}o.dateAxisData(n)}for(r=(r=[]).concat(o._innerList),i=0;i<r.length;i++)(a=r[i]).row>=e&&a.row<e+t?o.remove(a):(e<=a.row&&(a.row-=t),(s=this._removeRowRange(e,t,a.data()))!==d&&s!==f?a.data(s):o.remove(a));o.count()<=0&&this.remove(o)}},o.prototype._removeColumns=function(e,t){for(var o,n,r,i,a,s,l=0;l<this._groups.length;l++){if((o=this._groups[l]).displayDateAxis){if((n=this._removeColumnRange(e,t,o.dateAxisData()))===d||n===f){o.clear(),this.remove(o);continue}o.dateAxisData(n)}for(r=(r=[]).concat(o._innerList),i=0;i<r.length;i++)(a=r[i]).column>=e&&a.column<e+t?o.remove(a):(e<=a.column&&(a.column-=t),(s=this._removeColumnRange(e,t,a.data()))!==d&&s!==f?a.data(s):o.remove(a));o.count()<=0&&this.remove(o)}},o.prototype.clear=function(e,t,o,n){var r,i,a,s,l,u;if(0!==arguments.length)for(a=e;a<e+o;a++)for(s=t;s<t+n;s++)(l=this._find(a,s))&&((u=l.group()).remove(l),0===u.count()&&this.remove(u));else{for(r=0;r<this._groups.length;r++)(i=this._groups[r])&&(i.SparklineGroupManager=d);this._groups=[]}},o.prototype._find=function(e,t){for(var o,n,r,i=0;i<this._groups.length;i++)for(o=this._groups[i],n=0;n<o.count();n++)if((r=o[n])&&r.row===e&&r.column===t)return r;return d},o.prototype._copy=function(t,o,n,r,i,a,s){var l,u,c,h,p=this._sheet;if(p){for(var g,m=new e._GcSheetModel(i,a,d),_=n-t,y=r-o,C=p._getModel(),w=p.getRowCount(),v=p.getColumnCount(),S=0;S<i;S++)if(!s||!p.isRowFilterOut(n+S))for(g=0;g<a;g++)(l=C.getSparkline(t+S,o+g))&&((u=l.clone()).row=n+S,u.column=r+g,(c=u.dateAxisData())!==d&&c!==f&&this._canOffset(c,_,y,w,v)&&u.dateAxisData(c.offset(y,_)),(h=u.data())!==f&&h!==d&&this._canOffset(h,_,y,w,v)&&u.data(h.offset(y,_)),this.add(u.group()),m.setValue(S,g,u));for(S=0;S<i;S++)if(!s||!p.isRowFilterOut(n+S))for(g=0;g<a;g++)C.setSparkline(n+S,r+g,m.getValue(S,g))}},o.prototype._canOffset=function(e,t,o,n,r){var i=this._getExpressionRange(e);if(i){var a=i.row<0?0:i.row,s=i.col<0?0:i.col,l=i.row<0?n:i.rowCount,u=i.col<0?r:i.colCount;return!(a+t<0||s+o<0||a+l+t>n||s+u+o>r)}return!1},o.prototype._move=function(t,o,n,r,i,a){var s,l,u,c,h,p=this._sheet;if(p){for(this._moveDataRange(t,o,n,r,i,a),s=p._getModel(),l=new e._GcSheetModel(i,a,d),u=0;u<i;u++)for(c=0;c<a;c++)(h=s.getSparkline(t+u,o+c))&&(h.row=n+u,h.column=r+c,l.setValue(u,c,h)),s.setSparkline(t+u,o+c,d);for(u=0;u<i;u++)for(c=0;c<a;c++)s.setSparkline(n+u,r+c,l.getValue(u,c))}},o.prototype._moveDataRange=function(t,o,n,r,i,a){var s,l,u,c,h,p,d,f,g,m=new e.Range(t,o,i,a),_=n-t;for(s=r-o,l=0;l<this._groups.length;l++)for(u=this._groups[l],c=0;c<u._innerList.length;c++)(h=u._innerList[c])&&(p=h.dateAxisData(),(d=this._getExpressionRange(p))&&m.containsRange(d)&&m.contains(h.row,h.column)&&h.dateAxisData(p.offset(s,_)),f=h.data(),(g=this._getExpressionRange(f))&&m.containsRange(g)&&m.contains(h.row,h.column)&&h.data(f.offset(s,_)))},o.prototype._getExpressionRange=function(e){return e},o.prototype._swap=function(e,t,o,n,r,i){},o.prototype._exCopy=function(e,t,o,n,r,i,a,s){var l,u,c,h,p,g,m=this._sheet;if(m){if(e===m)return void this._copy(t,o,n,r,i,a);var _=n-t,y=r-o,C=e._getModel(),w=m._getModel(),v=m.getRowCount(),S=m.getColumnCount();for(l=0;l<i;l++)if(!s||!m.isRowFilterOut(n+l))for(u=0;u<a;u++)(c=C.getSparkline(t+l,o+u))?((h=c.clone()).row=n+l,h.column=r+u,(p=h.dateAxisData())!==f&&p!==d&&this._canOffset(p,_,y,v,S)&&h.dateAxisData(p.offset(y,_)),(g=h.data())!==f&&g!==d&&this._canOffset(g,_,y,v,S)&&h.data(g.offset(y,_)),this.add(h.group()),w.setSparkline(n+l,r+u,h)):w.setSparkline(n+l,r+u,d)}},o.prototype._exMove=function(e,t,o,n,r,i,a){var s,l,u,c,h,p,f,g=this._sheet;if(g){if(e===g)return void this._move(t,o,n,r,i,a);for(s=e._getModel(),l=g._getModel(),this._exMoveDataRange(e,t,o,n,r,i,a),u=0;u<i;u++)for(c=0;c<a;c++)(h=s.getSparkline(t+u,o+c))?(h.row=n+u,h.column=r+c,f=(p=h.group()).clone(),p.remove(h),p.count()<=0&&e._sparklineGroupManager.remove(p),f.add(h),this.add(f),l.setSparkline(n+u,r+c,h)):l.setSparkline(n+u,r+c,d),s.setSparkline(t+u,o+c,d)}},o.prototype._exMoveDataRange=function(t,o,n,r,i,a,s){var l,u,c,h,p,d,f,g,m=this._sheet;if(t&&m){if(t===m)return void this._moveDataRange(o,n,r,i,a,s);var _=new e.Range(o,n,a,s),y=r-o,C=i-n;for(l=0;l<t._sparklineGroupManager._groups.length;l++)for(u=t._sparklineGroupManager._groups[l],c=0;c<u._innerList.length;c++)(h=u._innerList[c])&&(p=h.dateAxisData(),(d=this._getExpressionRange(p))&&this._sameSource(t,p)&&_.containsRange(d)&&_.contains(h.row,h.column)&&h.dateAxisData(p.offset(C,y)),f=h.data(),(g=this._getExpressionRange(f))&&this._sameSource(t,f)&&_.containsRange(g)&&_.contains(h.row,h.column)&&h.data(f.offset(C,y)))}},o.prototype._sameSource=function(e,t){return!0},o.prototype._addRowRange=function(t,o,n){return n?t>n.row+n.rowCount-1?n:t>n.row?new e.Range(n.row,n.col,n.rowCount+o,n.colCount):new e.Range(n.row+o,n.col,n.rowCount,n.colCount):d},o.prototype._addColumnRange=function(t,o,n){return n?t>n.col+n.colCount-1?n:t>n.col?new e.Range(n.row,n.col,n.rowCount,n.colCount+o):new e.Range(n.row,n.col+o,n.rowCount,n.colCount):d},o.prototype._removeColumnRange=function(t,o,n){var r=this._rangeSubCat(n.col,n.col+n.colCount-1,t,t+o-1);return r?new e.Range(n.row,r.start,n.rowCount,r.end-r.start+1):d},o.prototype._removeRowRange=function(t,o,n){var r=this._rangeSubCat(n.row,n.row+n.rowCount-1,t,t+o-1);return r?new e.Range(r.start,n.col,r.end-r.start+1,n.colCount):d},o.prototype._rangeSubCat=function(e,t,o,n){var r,i,a,s,l,u=-1;if(n<e)return{start:u=e-(i=n-o+1),end:t-i};if(o>t)return{start:u=e,end:t};if(o<=e){for(a=t-e+1,s=0,r=e;r<=n&&r<=t;r++)s++;return{start:u=o,end:u+a-s-1}}for(l=0,r=e;r<=t;r++)-1===u&&(r<o||r>n)&&(u=r),(r<o||r>n)&&l++;return-1!==u&&l>0?{start:u,end:u+l-1}:d},o.prototype.toJSON=function(){var e,t,o=this._groups;if(!o||0===o.length)return f;for(e=[],t=0;t<o.length;t++)e.push(o[t].toJSON());return 0===e.length?f:e},o.prototype.fromJSON=function(e,t){var o,r,i;if(e&&0!==e.length)for(o=0;o<e.length;o++)r=e[o],(i=new n).fromJSON(r,t),this.add(i)},o}(),e.WorksheetSparklineGroupManager=s,l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(a),e.SparklineValue=l}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S;e.feature("touch",["core.common","core.sheet_action","core.sheet_model","core.sheet_border"]);var x=null,R=void 0,b=Math.abs,T=Math.min,A=Math.max,I=Math.pow,D=Math.atan2,F=Math.PI,M=Math.round,E=Math.sqrt,N=Math.atan,O=Math.log,P=Math.floor,L="undefined",H=function(){function o(){this._elements=[],this._pressedPointers={length:0},this._checkPointerIntervalId=-1,this._manipulationProcessor=new k,this._tapEventProcesser=new V}return o.prototype.ManipulationStarting=function(e){var t=this._manipulationProcessor;t&&(t.ManipulationStarting=e)},o.prototype.ManipulationStarted=function(e){var t=this._manipulationProcessor;t&&(t.ManipulationStarted=e)},o.prototype.ManipulationCompleted=function(e){var t=this,o=t._manipulationProcessor;o&&(o.ManipulationCompleted=function(o){if(e){e(o);var n=t._touchMouseMessageFilter;n&&n.postProcessManipulationComplete()}})},o.prototype.ManipulationInertiaStarting=function(e){var t=this._manipulationProcessor;t&&(t.ManipulationInertiaStarting=e)},o.prototype.ManipulationDelta=function(e){var t=this._manipulationProcessor;t&&(t.ManipulationDelta=e)},o.prototype.Tapped=function(e){var t=this._tapEventProcesser;t&&(t.Tapped=e)},o.prototype.DoubleTapped=function(e){var t=this._tapEventProcesser;t&&(t.DoubleTapped=e)},o.prototype.RightTapped=function(e){var t=this._tapEventProcesser;t&&(t.RightTapped=e)},o.prototype.TouchOperatorStart=function(e){this.touchOperatorStart=e},o.prototype.TouchOperatorEnd=function(e){this.touchOperatorEnd=e},o.prototype._getOffsetRelativeToDownElement=function(t,o){var n,r,i,a={left:0,top:0};return t!==(n=o?o.element:this._downElement.element)&&(r=e.GC$(t).offset(),i=e.GC$(n).offset(),a.left=r.left-i.left,a.top=r.top-i.top),a},o.prototype.msPointerDown=function(o,n){var r,i,a;(n.pointerType===n.MSPOINTER_TYPE_TOUCH||"touch"===n.pointerType)&&(r=this._getOffsetRelativeToDownElement(n.target,o),this._down(o,n.target,n.pointerId,new t(n.offsetX+r.left,n.offsetY+r.top),n.timeStamp)&&e.util.cancelDefault(n),"sheet"===this._downElement.eventFlag&&(i=n.pageX-(n.offsetX+r.left),a=n.pageY-(n.offsetY+r.top),window.gcGlobal.canvasOffset={top:a,left:i}))},o.prototype.msPointerMove=function(o){if(o.pointerType===o.MSPOINTER_TYPE_TOUCH||"touch"===o.pointerType){if(this._pressedPointers[o.pointerId]===R)return!1;var n=this._getOffsetRelativeToDownElement(o.target);this._move(o.pointerId,new t(o.offsetX+n.left,o.offsetY+n.top),o.timeStamp)&&e.util.cancelDefault(o)}},o.prototype.msPointerUp=function(o){if(o.pointerType===o.MSPOINTER_TYPE_TOUCH||"touch"===o.pointerType){if(this._pressedPointers[o.pointerId]===R)return!1;var n=this._getOffsetRelativeToDownElement(o.target);this._up(o.pointerId,new t(o.offsetX+n.left,o.offsetY+n.top))&&e.util.cancelDefault(o)}},o.prototype.msPointerCancel=function(o){if(o.pointerType===o.MSPOINTER_TYPE_TOUCH||"touch"===o.pointerType){if(this._pressedPointers[o.pointerId]===R)return!1;var n=this._getOffsetRelativeToDownElement(o.target);this._cancel(o.pointerId,new t(o.offsetX+n.left,o.offsetY+n.top))&&e.util.cancelDefault(o)}},o.prototype._getElementOffset=function(t){var o=e.GC$(t).offset();return o?(isNaN(document.body.clientTop)||(o.top+=document.body.clientTop),isNaN(document.body.clientLeft)||(o.left+=document.body.clientLeft)):o={top:0,left:0},o},o.prototype.touchStart=function(o,n){for(var r,i,a=this._getElementOffset(o.element),s=!1,l=0;l<n.changedTouches.length;l++)r=n.changedTouches[l],i=e.util.browser.mozilla?(new Date).valueOf():n.timeStamp,s=this._down(o,n.target,r.identifier,new t(r.pageX-a.left,r.pageY-a.top),i)||s;s&&e.util.cancelDefault(n)},o.prototype.touchMove=function(o){for(var n,r,i=this._getElementOffset(this._downElement.element),a=!1,s=0;s<o.changedTouches.length;s++)n=o.changedTouches[s],r=e.util.browser.mozilla?(new Date).valueOf():o.timeStamp,a=this._move(n.identifier,new t(n.pageX-i.left,n.pageY-i.top),r)||a;a&&e.util.cancelDefault(o)},o.prototype.touchEnd=function(o){for(var n,r=this._getElementOffset(this._downElement.element),i=!1,a=0;a<o.changedTouches.length;a++)n=o.changedTouches[a],i=this._up(n.identifier,new t(n.pageX-r.left,n.pageY-r.top))||i;i&&e.util.cancelDefault(o)},o.prototype.touchCancel=function(o){for(var n,r=this._getElementOffset(this._downElement.element),i=!1,a=0;a<o.changedTouches.length;a++)n=o.changedTouches[a],i=this._cancel(n.identifier,new t(n.pageX-r.left,n.pageY-r.top))||i;i&&e.util.cancelDefault(o)},o.prototype._startCheckPointer=function(){-1===this._checkPointerIntervalId&&(this._checkPointerIntervalId=setInterval(this._checkCancelPointer,200))},o.prototype._endCheckPointer=function(){-1!==this._checkPointerIntervalId&&(clearInterval(this._checkPointerIntervalId),this._checkPointerIntervalId=-1)},o.prototype._checkCancelPointer=function(){var e,t;if(!this._manipulationProcessor||3!==this._manipulationProcessor._process){var o=(new Date).valueOf(),n=[],r=this._pressedPointers,i=0;for(e in r)o-r[e].time>200&&n.push(r[e]),i++;for(t=0;t<n.length;t++)this._cancel(n[t].id,n[t].position),delete r[n[t].id];i===n.length&&this._endCheckPointer()}},o.prototype._fixPosition=function(t){var o,n;if(this._downElement===this._manipulationElement)return t;o=e.GC$(this._downElement.element).offset(),n=e.GC$(this._manipulationElement.element).offset(),t.X+=o.left-n.left,t.Y+=o.top-n.top},o.prototype._setCaptureElement=function(e,t){var o,n,r=this,i=r._elements;for(r._manipulationElement=x,r._touchMouseMessageFilter=x,o=0;o<i.length;o++)if(i[o]===e){var a=i[o],s=x,l=x;if(a.canDoManipulation&&!a.canDoManipulation()){for(o=0;o<i.length;o++)if((n=i[o])!==a&&n.level>=0&&n.level<a.level&&(!n.canDoManipulation||n.canDoManipulation())){s=n;break}if(s===x)return!1}if(a.canDoTap&&!a.canDoTap()){for(o=0;o<i.length;o++)if((n=i[o])!==a&&n.level>=0&&n.level<a.level&&(!n.canDoTap||n.canDoTap())){l=n;break}if(l===x)return!1}s===x&&(s=a),l===x&&(l=a),r._downElement=a,r._manipulationElement=s,r._tapElement=l,r.ManipulationStarting(s.manipulationStarting||x),r.ManipulationStarted(s.manipulationStarted||x),r.ManipulationDelta(s.manipulationDelta||x),r.ManipulationInertiaStarting(s.manipulationInertiaStarting||x),r.ManipulationCompleted(s.manipulationCompleted||x),r.Tapped(l.tapped||x),r.DoubleTapped(l.doubleTapped||x),r.RightTapped(l.rightTapped||x),r.TouchOperatorStart(s.touchOperatorStart||x),r.TouchOperatorEnd(s.touchOperatorEnd||x),s.messageFilter&&(r._touchMouseMessageFilter=a.messageFilter);break}return!0},o.prototype._down=function(e,t,o,n,r){var i=this;return i._pressedPointers[o]===R&&(!(0===i._pressedPointers.length&&!i._setCaptureElement(e,t))&&(i._manipulationElement!==x&&typeof i._manipulationElement!==L&&(i._pressedPointers.length>=i._manipulationElement.maxPointer||(!i._touchMouseMessageFilter||!i._touchMouseMessageFilter.preProcessPointerDown())&&(i._fixPosition(n),i._touchMouseMessageFilter&&0===i._pressedPointers.length&&i._touchMouseMessageFilter.preProcessManipulationStarting(),i._pressedPointers[o]={id:o,time:(new Date).valueOf(),position:n},i._pressedPointers.length++,i._manipulationProcessor&&(i._manipulationProcessor.PreviewPointerDown(t,o,n,r),i._manipulationProcessor.PointerDown(o,n,i._pressedPointers.length,r)),1===i._pressedPointers.length&&i._tapEventProcesser&&i._tapEventProcesser.PointerDown(n),1===i._pressedPointers.length&&i.touchOperatorStart&&i.touchOperatorStart({Position:n}),!0))))},o.prototype._move=function(e,t,o){return this._pressedPointers[e]!==R&&((!this._touchMouseMessageFilter||!this._touchMouseMessageFilter.preProcessPointerMove())&&(this._fixPosition(t),this._pressedPointers[e]={id:e,time:(new Date).valueOf(),position:t},this._manipulationProcessor&&this._manipulationProcessor.PointerMove(e,t,o),!0))},o.prototype._up=function(e,t){var o=this;return o._pressedPointers[e]!==R&&(delete o._pressedPointers[e],o._pressedPointers.length--,(!o._touchMouseMessageFilter||!o._touchMouseMessageFilter.preProcessPointerUp())&&(o._fixPosition(t),o._manipulationProcessor&&(o._manipulationProcessor.PreviewPointerUp(e),o._manipulationProcessor.PointerUp(e)),0===o._pressedPointers.length&&o._tapEventProcesser&&(o._tapEventProcesser.PreviewPointerUp(t),o._tapEventProcesser.PointerUp(t)),0===o._pressedPointers.length&&o.touchOperatorEnd&&o.touchOperatorEnd({Position:t}),o._touchMouseMessageFilter&&0===o._pressedPointers.length&&0===o._manipulationProcessor._process&&o._touchMouseMessageFilter.postProcessManipulationComplete(),!0))},o.prototype._cancel=function(e,t){return this._up(e,t)},o.prototype.attachDettach=function(t,o){var n=this,r=t.element,i=n._elements,a=e.ArrayHelper.indexOf(i,t);if((!(a>=0)||!o)&&(!(a<0)||o)){var s="."+t.eventFlag,l=".gcSheet",u="MSPointerDown"+l,c="MSPointerMove"+l+s,h="MSPointerUp"+l+s,p="MSPointerCancel"+l+s,d="MSLostPointerCapture"+l+s,f="pointerdown"+l,g="pointermove"+l+s,m="pointerup"+l+s,_="LostPointerCapture"+l+s,y="pointercancel"+l+s,C="touchstart"+l,w="touchmove"+l,v="touchend"+l,S="touchcancel"+l,R=window.navigator.msPointerEnabled||window.navigator.pointerEnabled;o?R?(r.style.msTouchAction!==x&&typeof r.style.msTouchAction!==L&&(r.style.msTouchAction="none"),r.style.touchAction!==x&&typeof r.style.touchAction!==L&&(r.style.touchAction="none"),function(t,o){e.GC$(r).bind(u,function(e){n.msPointerDown(t,e)}).bind(f,function(e){n.msPointerDown(t,e)})}.call(n,t),e.GC$(document).bind(c,function(e){n.msPointerMove(e)}).bind(h,function(e){n.msPointerUp(e)}).bind(g,function(e){n.msPointerMove(e)}).bind(m,function(e){n.msPointerUp(e)}).bind(p,function(e){n.msPointerCancel(e)}).bind(d,function(e){n.msPointerCancel(e)}).bind(_,function(e){n.msPointerCancel(e)}).bind(y,function(e){n.msPointerCancel(e)})):(function(t,o){e.GC$(r).bind(C,function(e){n.touchStart(t,e)})}.call(n,t),e.GC$(r).bind(w,function(e){n.touchMove(e)}).bind(v,function(e){n.touchEnd(e)}).bind(S,function(e){n.touchCancel(e)})):R?(e.GC$(r).unbind(u).unbind(f),e.GC$(document).unbind(c).unbind(g).unbind(h).unbind(m).unbind(p).unbind(y).unbind(d).unbind(_)):e.GC$(r).unbind(C).unbind(w).unbind(v).unbind(S),o?i.push(t):i.splice(a,1)}},o.prototype.dispose=function(){for(var e=this._elements,t=e.length-1;t>=0;t--)this.attachDettach(e[t],!1)},o}();e.TouchEventProvider=H;var k=function(){function e(){var e=this;e._totalTranslateX=0,e._totalTranslateY=0,e._totalScale=1,e._totalRotation=0,e._totalExpansion=0,e._process=0,e._workingModes=511,e._manipulatorPointers=new ne,e._minimumScaleRotateRadius=20,e._deltaHistory=new J}return e.prototype.PreviewPointerDown=function(e,t,o,n){var r,i=this;3===i._process&&i.Complete(!0),i._isScroll=2===i._process&&1===i._manipulatorPointers.Count(),i._originalSource=e,(r=new oe(t)).PreviousPoint=o,r.InitialPoint=o,i._manipulatorPointers.Add(r),i._lastTime=n,i._manipulatorPointers.Count()>1&&(i.TranslateXLocked=!1,i.TranslateYLocked=!1,1===i._process&&i.StartManipulation())},e.prototype.PointerDown=function(e,t,o,n){0===this._process&&1===o&&this.Starting(this._manipulatorPointers.ItemAt(0).InitialPoint)},e.prototype.PointerMove=function(e,t,o){var n,r,i,a,s,l,u=this;if(0!==u._workingModes&&u._manipulatorPointers.Contains(e)){if(1===u._process&&1===u._manipulatorPointers.Count()){if(n=u.IsPinned(),!u.SupportsMode(1)&&!u.SupportsMode(2)&&!n)return;if(z.AreClose(t,u._manipulatorPointers.Find(e).InitialPoint))return;r=b(t.X-u._manipulatorPointers.Find(e).InitialPoint.X),i=b(t.Y-u._manipulatorPointers.Find(e).InitialPoint.Y),u.SetTranslateRails(r,i)}if(!(o-u._lastTime<z.ManipulationDeltaInterval)){if(u._manipulatorPointers.Find(e).CurrentPoint=t,(a=u._manipulatorPointers.Count())>1)for(s=0;s<a;s++)if(!(l=u._manipulatorPointers.ItemAt(s)).CurrentPoint)return;for(u.PointerMoveCore(o),u._lastTime=o,a=u._manipulatorPointers.Count(),s=0;s<a;s++)(l=u._manipulatorPointers.ItemAt(s)).PreviousPoint=l.CurrentPoint,l.CurrentPoint=x}}},e.prototype.PointerUp=function(e){this._needFireEvents&&(this.OnManipulationCompleted(this._needFireEvents),this._needFireEvents=x)},e.prototype.PreviewPointerUp=function(e){var t=this;t._manipulatorPointers.Contains(e)&&(t._manipulatorPointers.Remove(e),2===t._process?0===t._manipulatorPointers.Count()&&(t.SupportsMode(64)||t.SupportsMode(256)||t.SupportsMode(128)?t.StartInertia():t.Complete(!0)):2===t._process||3===t._process?t.Complete(!0):1===t._process&&t.Complete(!1))},e.prototype.PointerMoveCore=function(e){var o,n,r,i,a,s,l,u,c,h,p,d=this,f=d.CalculateTranslate();if(o=f.translateX,n=f.translateY,s=f.position,a=(l=d.CalculateRotationAndScale()).rotation,i=l.scale,r=l.expansion,d._totalTranslateX+=o,d._totalTranslateY+=n,d._totalScale*=i,d._totalRotation+=a,d._totalExpansion+=r,(u=new K).expansion=r,u.rotation=a,u.timeStamp=e-d._lastTime,u.translateX=o,u.translateY=n,d._deltaHistory.Enqueue(u),d._lastPosition=s,1===d._process||2===d._process){if(1===d._process&&d.StartManipulation())return;if((c=new te).Expansion=r,c.Rotation=a,c.Scale=i,c.Translation=new t(o,n),h=new Z(d._deltaHistory),p=new se(d._originalSource,d.GetCumulative(),c,!1,s,h),d.OnManipulationDelta(p),p.IsComplete)return void d.Complete(!0)}},e.prototype.StartManipulation=function(){var e;return this._process=2,e=new ue(this._originalSource,this._manipulatorPointers.Count(),this.GetCumulative(),this._manipulatorPointers.ItemAt(0).InitialPoint),this.OnManipulationStarted(e),!!e.IsComplete&&(this.Complete(!0),!0)},e.prototype.SetTranslateRails=function(e,t){var o=B.GetTranslateLocked(e,t);this.TranslateXLocked=o.translateXLocked,this.TranslateYLocked=o.translateYLocked},e.prototype.CalculateTranslate=function(){var e=this.GetAveragePoint(),o=e.currentAveragePoint,n=e.previousAveragePoint,r=new t(o.X,o.Y);return{translateX:o.X-n.X,translateY:o.Y-n.Y,position:r}},e.prototype.CalculateRotationAndScale=function(){var e,t=0,o=1,n=0;return this.SupportsMode(16)&&1===this._manipulatorPointers.Count()&&this.IsPinned()&&(t=this.CalculateSingleManipulatorRotation(this._manipulatorPointers.ItemAt(0).CurrentPoint,this._manipulatorPointers.ItemAt(0).PreviousPoint,this._pivot)),this._manipulatorPointers.Count()>1&&(t=(e=this.CalculateMultiManipulatorRotationAndScale()).rotation,o=e.scale,n=e.expansion),{rotation:t=t/F*180,scale:o,expansion:n}},e.prototype.CalculateMultiManipulatorRotationAndScale=function(){for(var e=this,o=e.GetAveragePoint(),n=o.currentAveragePoint,r=o.previousAveragePoint,i=e.IsPinned(),a=i?e._pivot.Center:new t(0,0),s=0,l=1,u=0,c=0,h=0,p=0,d=0,f=e._manipulatorPointers.Count(),g=0;g<f;g++){var m=e._manipulatorPointers.ItemAt(g).CurrentPoint,_=e._manipulatorPointers.ItemAt(g).PreviousPoint,y=e.GetLength(m,n),C=e.GetLength(_,r),w=i?new t(_.X-a.X,_.Y-a.Y):new t(_.X-r.X,_.Y-r.Y),v=i?new t(m.X-a.X,m.Y-a.Y):new t(m.X-n.X,m.Y-n.Y),S=e.GetLength(_,a),x=e.GetLength(m,a);C>=e._minimumScaleRotateRadius&&y>=e._minimumScaleRotateRadius&&(h++,p+=y,d+=C,(!i||S>=e._minimumScaleRotateRadius)&&x>=e._minimumScaleRotateRadius&&(s+=e.AngleBetween(w,v),c++))}return s=c>0&&e.SupportsMode(16)?s/c:0,h>0&&e.SupportsMode(32)?(e._isScroll||(l=p/d),u=(p-d)/h,e._lastDistance=p/h):e._lastDistance=0,{rotation:s,scale:l,expansion:u}},e.prototype.CalculateSingleManipulatorRotation=function(e,o,n){var r=new t(n.Center.X,n.Center.Y),i=new t(o.X-r.X,o.Y-r.Y),a=new t(e.X-r.X,e.Y-r.Y),s=T(1,I(this.GetLength(o,r)/n.Radius,4)),l=this.AngleBetween(i,a);return isNaN(l)?0:l*s},e.prototype.AngleBetween=function(e,t){var o=D(t.Y,t.X)-D(e.Y,e.X);return o>F?o-=2*F:o<-F&&(o+=2*F),o},e.prototype.SupportsMode=function(e){return 0!=(this._workingModes&e)},e.prototype.GetLength=function(e,t){return E((t.X-e.X)*(t.X-e.X)+(t.Y-e.Y)*(t.Y-e.Y))},e.prototype.GetAveragePoint=function(){for(var e,o,n=0,r=0,i=0,a=0,s=this._manipulatorPointers.Count(),l=0;l<s;l++)n+=(e=this._manipulatorPointers.ItemAt(l)).PreviousPoint.X,r+=e.PreviousPoint.Y,i+=e.CurrentPoint.X,a+=e.CurrentPoint.Y;return o=new t(n/s,r/s),{currentAveragePoint:new t(i/s,a/s),previousAveragePoint:o}},e.prototype.IsPinned=function(){return this._pivot&&!isNaN(this._pivot.Radius)},e.prototype.Starting=function(e){var t=new ce(this._originalSource,this._workingModes,x,e);return t.Mode=511,this.OnManipulationStarting(t),this.ManipulationMode=t.Mode,0===t.Mode?(this.Complete(!1),!1):(this._workingModes=t.Mode,this._pivot=t.Pivot,this._process=1,!0)},e.prototype.Complete=function(e){var o,n=this,r=3===n._process;n._process=0,n._inertiaTimer&&(clearInterval(n._inertiaTimer),n._inertiaTimer=x),e&&(o=new ae(n._originalSource,n.GetCumulative(),r,t.Round(n._lastPosition),new Z(n._deltaHistory)),3===n._process?n._needFireEvents=o:n.OnManipulationCompleted(o)),n._deltaHistory.Clear(),n._manipulatorPointers.Clear(),n._pivot=x,n._totalTranslateX=0,n._totalTranslateY=0,n._totalScale=1,n._totalRotation=0,n._totalExpansion=0,n.TranslateXLocked=!1,n.TranslateYLocked=!1,n._workingModes=0},e.prototype.StartInertia=function(){var e,t,o=this,n=new ee,r=new Z(o._deltaHistory);n.CurrentTranslateXVelocity=o.SupportsMode(64)?r.Linear().X:0,n.CurrentTranslateYVelocity=o.SupportsMode(64)?r.Linear().Y:0,n.CurrentExpansionVelocity=o.SupportsMode(256)?r.Expansion():0,n.CurrentRotationVelocity=o.SupportsMode(128)?r.Angular():0,0!==n.CurrentTranslateXVelocity||0!==n.CurrentTranslateYVelocity||0!==n.CurrentExpansionVelocity||0!==n.CurrentRotationVelocity?(n.TranslateBehavior=new Q(n.CurrentTranslateXVelocity,n.CurrentTranslateYVelocity),n.ExpansionBehavior=new q(n.CurrentExpansionVelocity),n.RotationBehavior=new $(n.CurrentRotationVelocity),r=new Z(x,n.CurrentTranslateXVelocity,n.CurrentTranslateYVelocity,n.CurrentRotationVelocity,n.CurrentExpansionVelocity),e=new le(o._originalSource,o.GetCumulative(),new te,r,n.ExpansionBehavior,n.RotationBehavior,n.TranslateBehavior),o.OnManipulationInertiaStarting(e),n.TranslateBehavior=e.TranslationBehavior,n.ExpansionBehavior=e.ExpansionBehavior,n.RotationBehavior=e.RotationBehavior,n.TranslateBehavior.XDeceleration<=0&&n.TranslateBehavior.YDeceleration<=0&&n.TranslateBehavior.SetDecelerationInternal(.003),n.ExpansionBehavior.DecelerationInternal()<=0&&n.ExpansionBehavior.SetDecelerationInternal(.002),n.RotationBehavior.DecelerationInternal()<=0&&n.RotationBehavior.SetDecelerationInternal(.003),t=(new Date).valueOf(),n.StartTime=t,n.LastTime=t,n.DeltaXRemainder=0,n.DeltaYRemainder=0,o._process=3,o._inertiaTimer=setInterval(function(){try{o.InertiaTick(n)}catch(e){}},20)):o.Complete(!0)},e.prototype.InertiaTick=function(e){var o,n,r,i,a=this,s=(new Date).valueOf(),l=(e.StartTime,s-e.LastTime);if(0!==l){var u=e.CurrentTranslateXVelocity,c=e.CurrentTranslateYVelocity,h=e.CurrentExpansionVelocity,p=e.CurrentRotationVelocity;e.CurrentTranslateXVelocity=a.GetInertiaCurrentVelocity(l,e.TranslateBehavior.XDeceleration,e.CurrentTranslateXVelocity),e.CurrentTranslateYVelocity=a.GetInertiaCurrentVelocity(l,e.TranslateBehavior.YDeceleration,e.CurrentTranslateYVelocity),e.CurrentExpansionVelocity=a.GetInertiaCurrentVelocity(l,e.ExpansionBehavior.DecelerationInternal(),e.CurrentExpansionVelocity),e.CurrentRotationVelocity=a.GetInertiaCurrentVelocity(l,e.RotationBehavior.DecelerationInternal(),e.CurrentRotationVelocity),u=(u+e.CurrentTranslateXVelocity)/2,c=(c+e.CurrentTranslateYVelocity)/2,h=(h+e.CurrentExpansionVelocity)/2,p=(p+e.CurrentRotationVelocity)/2,e.LastTime=s,o=!1,a.IsZero(u)&&a.IsZero(c)&&a.IsZero(h)&&a.IsZero(p)&&(o=!0);var d=l*u,f=l*c,g=l*h,m=l*p,_=1;if(a._lastDistance>0&&(a._lastDistance+2*g<0&&(g=-a._lastDistance/2+1),0!==a._lastDistance&&(_=(a._lastDistance+2*g)/a._lastDistance)),a._totalExpansion+=g,a._totalRotation+=m,a._totalTranslateX+=d,a._totalTranslateY+=f,a._totalScale*=_,a._lastDistance+=g,a._lastPosition=new t(a._lastPosition.X+d,a._lastPosition.Y+f),e.DeltaXRemainder+=d,e.DeltaYRemainder+=f,o){if(d=M(e.DeltaXRemainder),f=M(e.DeltaYRemainder),a.IsZero(d)&&a.IsZero(f))return void a.Complete(!0)}else b(e.DeltaXRemainder)>=1&&(d=e.DeltaXRemainder,e.DeltaXRemainder-=d),b(e.DeltaYRemainder)>=1&&(f=e.DeltaYRemainder,e.DeltaYRemainder-=f);if((n=new te).Translation=new t(d,f),n.Scale=_,n.Expansion=g,n.Rotation=m,r=new Z(x,e.CurrentTranslateXVelocity,e.CurrentTranslateYVelocity,e.CurrentRotationVelocity,e.CurrentExpansionVelocity),i=new se(a._originalSource,a.GetCumulative(),n,!0,t.Round(a._lastPosition),r),a.OnManipulationDelta(i),i.IsComplete)return void a.Complete(!0);o&&a.Complete(!0)}},e.prototype.GetInertiaCurrentVelocity=function(e,t,o){return this.IsZero(o)?0:(((n=o<0?o+t*e:o-t*e)<0&&o>0||n>0&&o<0)&&(n=0),n);var n},e.prototype.GetCumulative=function(){var e=new te;return e.Expansion=this._totalExpansion,e.Rotation=this._totalRotation,e.Scale=this._totalScale,e.Translation=new t(this._totalTranslateX,this._totalTranslateY),e},e.prototype.IsZero=function(e){return b(e)<=2.220446049250313e-16},e.prototype.GetManipulationData=function(e,t,o,n){var r,i=this,a=new te,s=new te,l=0,u=0,c=0,h=0,p=i.SupportsMode(4)&&i.TranslateXLocked,d=i.SupportsMode(8)&&i.TranslateYLocked;return i.SupportsMode(1)&&!d&&(!e||i.SupportsMode(64))&&(a.Translation.X=t.Translation.X,s.Translation.X=o.Translation.X,l=n.Linear().X),i.SupportsMode(2)&&!p&&(!e||i.SupportsMode(64))&&(a.Translation.Y=t.Translation.Y,s.Translation.Y=o.Translation.Y,u=n.Linear().Y),!i.SupportsMode(32)||e&&!i.SupportsMode(256)?(a.Scale=t.Scale,s.Scale=1):(a.Scale=t.Scale,a.Expansion=t.Expansion,s.Scale=o.Scale,s.Expansion=o.Expansion,h=n.Expansion()),i.SupportsMode(16)&&(!e||i.SupportsMode(128))&&(a.Rotation=t.Rotation,s.Rotation=o.Rotation,c=n.Angular()),r=new Z(x,l,u,c,h),new re(a,s,r)},e.prototype.OnManipulationStarting=function(e){this.ManipulationStarting&&e&&this.ManipulationStarting(e)},e.prototype.OnManipulationStarted=function(e){this.ManipulationStarted&&e&&this.ManipulationStarted(e)},e.prototype.OnManipulationCompleted=function(e){if(this.ManipulationCompleted&&e){var t=this.GetManipulationData(!1,e.Cumulative,e.Cumulative,e.Velocities);e.Cumulative=t.Cumulative,e.Velocities=t.Velocities,this.ManipulationCompleted(e)}},e.prototype.OnManipulationInertiaStarting=function(e){if(this.ManipulationInertiaStarting&&e){var t=this.GetManipulationData(!1,e.Cumulative,e.Delta,e.Velocities);e.Cumulative=t.Cumulative,e.Delta=t.Delta,e.Velocities=t.Velocities,this.ManipulationInertiaStarting(e)}},e.prototype.OnManipulationDelta=function(e){if(this.ManipulationDelta&&e){var t=this.GetManipulationData(e.IsInertia,e.Cumulative,e.Delta,e.Velocities);e.Cumulative=t.Cumulative,e.Delta=t.Delta,e.Velocities=t.Velocities,this.ManipulationDelta(e)}},e}(),V=function(){function e(){}return e.prototype.PointerDown=function(e){var t,o=this;o._pointerCount++,o._pointerCount>1||(t=(new Date).valueOf(),o._firstDownPosition&&z.DoubleTappedAreClose(e,o._firstDownPosition)&&t-o._lastDownTimestamp<z.DoubleTappedTimeOffset?o._count++:(o._firstDownPosition=e,o._count=1),o._lastDownPosition=e,o._lastDownTimestamp=t)},e.prototype.PointerUp=function(e){this._needFireEvents&&(this._needFireEvents instanceof he?this.OnTapped(this._needFireEvents):this._needFireEvents instanceof pe&&this.OnRightTapped(this._needFireEvents),this._needFireEvents=x)},e.prototype.PreviewPointerUp=function(e){var t,o=this;o._pointerCount--,o._pointerCount>0||(t=(new Date).valueOf(),z.AreClose(e,o._lastDownPosition)?t-o._lastDownTimestamp>z.RightTappedTimeOffset?o._needFireEvents=new pe(o._lastDownPosition):o._count>1?(o._count=0,o.OnDoubleTapped(new de(o._firstDownPosition)),o._firstDownPosition=x):o._needFireEvents=new he(o._lastDownPosition):o._firstDownPosition=x)},e.prototype.PointerCancel=function(){this._firstDownPosition=x},e.prototype.OnTapped=function(e){this.Tapped&&e&&this.Tapped(e)},e.prototype.OnDoubleTapped=function(e){this.DoubleTapped&&e&&this.DoubleTapped(e)},e.prototype.OnRightTapped=function(e){this.RightTapped&&e&&this.RightTapped(e)},e}(),B=function(){function e(){}return e.GetTranslateLocked=function(e,t){var o,n=!1,r=!1;return 0!==e&&((o=N(t/e)/F*180)<20&&(n=!0)),0===e?r=!0:(o=N(t/e)/F*180)>75&&o<105&&(r=!0),{translateXLocked:n,translateYLocked:r}},e}(),z=function(){function e(){}return e.AreClose=function(t,o){if(!t||!o)return!1;var n=e.TappedMaxOffset,r=e.TappedMaxOffset,i=e.TappedMaxDistance,a=e.TappedMaxDistance,s=t.X-o.X,l=t.Y-o.Y;return b(s)<n&&b(l)<r&&E(s*s+l*l)<T(i,a)},e.DoubleTappedAreClose=function(t,o){if(!t||!o)return!1;var n=e.DoubleTappedMaxOffset,r=e.DoubleTappedMaxOffset,i=e.DoubleTappedMaxDistance,a=e.DoubleTappedMaxDistance,s=t.X-o.X,l=t.Y-o.Y;return b(s)<n&&b(l)<r&&E(s*s+l*l)<T(i,a)},e.TouchScrollOnRails=function(t){t?(e.TappedMaxOffset=13,e.TappedMaxDistance=15):(e.TappedMaxOffset=3,e.TappedMaxDistance=4)},e.TappedMaxOffset=13,e.TappedMaxDistance=15,e.DoubleTappedMaxOffset=13,e.DoubleTappedMaxDistance=15,e.DoubleTappedTimeOffset=400,e.RightTappedTimeOffset=1e3,e.ManipulationDeltaInterval=20,e}();e.TouchHelper=z,t=function(){function e(e,t){this.X=e,this.Y=t}return e.Round=function(t){return t?new e(M(t.X),M(t.Y)):new e(-1,-1)},e}(),e.TouchPoint=t;var G,W,j,U,Y,X,K=function(){return function(){}}(),J=function(){function e(){this._count=0,this._start=0,this._maxCount=10,this._history=new Array(this._maxCount)}return e.prototype.GetVelocity=function(e){var t,o,n,r=this;if(0===r._count)return 0;r.Item(r._count-1).timeStamp;var i=0,a=(1+r._count)*r._count/2;for(t=r._count-1;t>=0;t--)o=0,0===e?o=r.Item(t).translateX:1===e?o=r.Item(t).translateY:2===e?o=r.Item(t).expansion:3===e&&(o=r.Item(t).rotation),n=r.GetSingleVelocity(o,r.Item(t).timeStamp),i+=n*=t+1;return i/a},e.prototype.GetSingleVelocity=function(e,t){return e/t},e.prototype.Item=function(e){return this._history[this.GetInnerListIndex(e)]},e.prototype.Last=function(){return this._history[this._count-1]},e.prototype.Enqueue=function(e){var t,o,n=this;for(10===n._count&&n.Dequeue(),n._count++,n._history[n.GetInnerListIndex(n._count-1)]=e,t=z.ManipulationDeltaInterval*n._maxCount,o=0;o<n._count;o++)e.timeStamp-n._history[o].timeStamp>t&&(n.Dequeue(),o--)},e.prototype.Dequeue=function(){this._start++,this._start===this._maxCount&&(this._start=0),this._count--},e.prototype.Clear=function(){this._count=0},e.prototype.GetInnerListIndex=function(e){return(this._start+e)%this._maxCount},e}(),Z=function(){function e(e,o,n,r,i){e?this._history=e:(this._linear=new t(o,n),this._angular=r,this._expansion=i)}return e.prototype.Linear=function(){return this._linear||(this._linear=new t(this._history.GetVelocity(0),this._history.GetVelocity(1))),this._linear},e.prototype.Angular=function(){return(this._angular===x||typeof this._angular===L)&&(this._angular=this._history.GetVelocity(3)),this._angular},e.prototype.Expansion=function(){return(this._expansion===x||typeof this._expansion===L)&&(this._expansion=this._history.GetVelocity(2)),this._expansion},e}(),q=function(){function e(e){this._initialVelocity=e,this._decelerationInternal=0}return e.prototype.DecelerationInternal=function(){return isNaN(this.DesiredExpansion)||0===this.DesiredExpansion?isNaN(this.DesiredDeceleration)?this._decelerationInternal:this.DesiredDeceleration:.5*this._initialVelocity*this._initialVelocity/this.DesiredExpansion},e.prototype.SetDecelerationInternal=function(e){this._decelerationInternal=e},e}(),$=function(){function e(e){this._initialVelocity=e,this._decelerationInternal=0}return e.prototype.DecelerationInternal=function(){return isNaN(this.DesiredRotation)||0===this.DesiredRotation?isNaN(this.DesiredDeceleration)?this._decelerationInternal:this.DesiredDeceleration:.5*this._initialVelocity*this._initialVelocity/this.DesiredRotation},e.prototype.SetDecelerationInternal=function(e){this._decelerationInternal=e},e}(),Q=function(){function e(e,t){var o=this;o._initialXVelocity=e,o._initialYVelocity=t,o.XDeceleration=0,o.YDeceleration=0,o._decelerationInternal=0,o._velocity=E(o._initialXVelocity*o._initialXVelocity+o._initialYVelocity*o._initialYVelocity)}return e.prototype.UpdateXYDecelerations=function(){var e=this;isNaN(e.DesiredDisplacement)||0===e.DesiredDisplacement?isNaN(e.DecelerationInternal())||0===e.DecelerationInternal()?(e.XDeceleration=0,e.YDeceleration=0):(e.XDeceleration=e.DecelerationInternal()*b(e._initialXVelocity)/e._velocity,e.YDeceleration=e.DecelerationInternal()*b(e._initialYVelocity)/e._velocity):(e.XDeceleration=.5*e._velocity*b(e._initialXVelocity)/e.DesiredDisplacement,e.YDeceleration=.5*e._velocity*b(e._initialYVelocity)/e.DesiredDisplacement)},e.prototype.SetDesiredDeceleration=function(e){this.DesiredDeceleration=e,this.UpdateXYDecelerations()},e.prototype.SetDesiredDisplacement=function(e){this.DesiredDisplacement=e,this.UpdateXYDecelerations()},e.prototype.DecelerationInternal=function(){return this.IsDefault()?this._decelerationInternal:this.DesiredDeceleration},e.prototype.SetDecelerationInternal=function(e){this._decelerationInternal=e,this.UpdateXYDecelerations()},e.prototype.IsDefault=function(){return isNaN(this.DesiredDeceleration)&&isNaN(this.DesiredDisplacement)},e}(),ee=function(){return function(){}}(),te=function(){return function(){this.Translation=new t(0,0),this.Scale=0,this.Rotation=0,this.Expansion=0}}(),oe=(function(){}(),function(){return function(e){this.ID=e}}()),ne=function(){function e(){this._list=[]}return e.prototype.Contains=function(e){for(var t=0;t<this._list.length;t++)if(this._list[t].ID===e)return!0;return!1},e.prototype.Add=function(e){this._list.push(e)},e.prototype.Remove=function(e){for(var t=0;t<this._list.length;t++)if(this._list[t].ID===e){this._list.splice(t,1);break}},e.prototype.Count=function(){return this._list.length},e.prototype.ItemAt=function(e){return this._list[e]},e.prototype.Find=function(e){for(var t,o=0;o<this._list.length;o++)if((t=this._list[o]).ID===e)return t;return x},e.prototype.Clear=function(){this._list.splice(0,this._list.length)},e}(),re=function(){return function(e,t,o){this.Cumulative=e,this.Delta=t,this.Velocities=o}}(),ie=function(){return function(e){this.OriginalSource=e}}(),ae=function(e){function t(t,o,n,r,i){e.call(this,t);this.Cumulative=o,this.IsInertia=n,this.Position=r,this.Velocities=i}return __extends(t,e),t}(ie),se=function(e){function t(t,o,n,r,i,a){e.call(this,t);this.Cumulative=o,this.Delta=n,this.IsInertia=r,this.Position=i,this.Velocities=a}return __extends(t,e),t}(ie),le=function(e){function t(t,o,n,r,i,a,s){e.call(this,t);this.Cumulative=o,this.Delta=n,this.Velocities=r,this.ExpansionBehavior=i,this.RotationBehavior=a,this.TranslationBehavior=s}return __extends(t,e),t}(ie),ue=function(e){function t(t,o,n,r){e.call(this,t),this.PointerCount=o,this.Cumulative=n,this.Position=r}return __extends(t,e),t}(ie),ce=function(e){function t(t,o,n,r){e.call(this,t),this.Mode=o,this.Pivot=n,this.Position=r}return __extends(t,e),t}(ie),he=function(){return function(e){this.Position=e}}(),pe=function(){return function(e){this.Position=e}}(),de=function(){return function(e){this.Position=e}}();(Y=G||(G={}))[Y.All=511]="All",Y[Y.None=0]="None",Y[Y.TranslateX=1]="TranslateX",Y[Y.TranslateY=2]="TranslateY",Y[Y.TranslateRailsX=4]="TranslateRailsX",Y[Y.TranslateRailsY=8]="TranslateRailsY",Y[Y.Rotate=16]="Rotate",Y[Y.Scale=32]="Scale",Y[Y.TranslateInertia=64]="TranslateInertia",Y[Y.RotateInertia=128]="RotateInertia",Y[Y.ScaleInertia=256]="ScaleInertia",(U=o||(o={}))[U.NotStart=0]="NotStart",U[U.Starting=1]="Starting",U[U.Started=2]="Started",U[U.InertiaStarted=3]="InertiaStarted",(j=n||(n={}))[j.TranslateX=0]="TranslateX",j[j.TranslateY=1]="TranslateY",j[j.Expansion=2]="Expansion",j[j.Rotation=3]="Rotation",(W=r||(r={}))[W.column=1]="column",W[W.row=2]="row",W[W.range=3]="range",i=function(){function t(e){this._sheet=e}return t.prototype._getTouchCanvas=function(t,o){var n=this._canvas;return n?(t!==e.DPIHelper.getLogicWidth(n)||o!==e.DPIHelper.getLogicHeight(n))&&e.DPIHelper.setSize(n,t,o):(n=document.createElement("canvas"),e.DPIHelper.adjustDevicePixel(n,null,this._sheet),e.DPIHelper.setSize(n,t,o)),n},t.prototype._getNewZoomFactor=function(e,t){var o=e*t;return o>4?o=4:o<.5&&(o=.5),o},t.prototype._saveCanvas=function(t,o,n,r){var i=e.DPIHelper.getLogicWidth(t),a=e.DPIHelper.getLogicHeight(t),s=this._getTouchCanvas(i,a),l=s.getContext("2d"),u=e.DPIHelper.getScaleX(s),c=e.DPIHelper.getScaleY(s);l.scale(1/u,1/c),l.drawImage(t,0,0,s.width,s.height,0,0,s.width,s.height),l.scale(u,c),this._canvas=s,this._oldSheetLayout=o,this._oldGroupLayout=n,this._oldZoomFactor=r},t.prototype._restoreCanvas=function(t,o,n){var r,i,a,s,l,u,c,h,p=this._sheet,d=e.DPIHelper.getLogicWidth(t),f=e.DPIHelper.getLogicHeight(t),g=p.getFrozenTrailingColumnCount(),m=p.getFrozenTrailingRowCount(),_=g>0?1:0,y=m>0?1:0,C=this._oldGroupLayout,w=p._getGroupLayout(),v=this._oldSheetLayout,S=p._getSheetLayout(),x=o/this._oldZoomFactor,R=t.getContext("2d"),b=e.DPIHelper.getScaleX(t),T=e.DPIHelper.getScaleY(t),A=this._canvas;R.save(),R.fillStyle=n,R.fillRect(0,0,d,f),p._render.paintGroup(R,null),r=C.x+C.width,i=C.y+C.height,a=v.frozenTrailingX-r-_,s=v.frozenTrailingY-i-y,l=w.x+w.width,u=w.y+w.height,c=a*x,h=s*x,r*=b,i*=T,a*=b,s*=T,l*=b,u*=T,c*=b,h*=T,R.scale(1/b,1/T),R.drawImage(A,r,i,a,s,l,u,c,h),g>0&&(r=v.frozenTrailingX-_,i=C.y+C.height,a=v.frozenTrailingWidth+_,s=v.frozenTrailingY-i-y,l=S.frozenTrailingX-_,u=w.y+w.height,c=S.frozenTrailingWidth+_,h=s*x,r*=b,i*=T,a*=b,s*=T,l*=b,u*=T,c*=b,h*=T,R.drawImage(A,r,i,a,s,l,u,c,h)),m>0&&(r=C.x+C.width,i=v.frozenTrailingY-y,a=v.frozenTrailingX-r-_,s=v.frozenTrailingHeight+y,l=w.x+w.width,u=S.frozenTrailingY-y,c=a*x,h=S.frozenTrailingHeight+y,r*=b,i*=T,a*=b,s*=T,l*=b,u*=T,c*=b,h*=T,R.drawImage(A,r,i,a,s,l,u,c,h)),g>0&&m>0&&(r=v.frozenTrailingX-_,i=v.frozenTrailingY-y,a=v.frozenTrailingWidth+_,s=v.frozenTrailingHeight+y,l=S.frozenTrailingX-_,u=S.frozenTrailingY-y,c=S.frozenTrailingWidth+_,h=S.frozenTrailingHeight+y,r*=b,i*=T,a*=b,s*=T,l*=b,u*=T,c*=b,h*=T,R.drawImage(A,r,i,a,s,l,u,c,h)),R.scale(b,T),R.restore()},t.prototype.startZoom=function(){var e=this._sheet,t=e._zoomFactor,o=e._render._getBufferCtx();o&&this._saveCanvas(o.canvas,e._getSheetLayout(),e._getGroupLayout(),t)},t.prototype.continueZoom=function(e){var t,o,n,r=this._sheet;r.endEdit()&&(t=this._getNewZoomFactor(e,this._oldZoomFactor),r._zoomFactor!==t&&(r.triggerUserZooming({sheet:r,sheetName:r._name,oldZoomFactor:r._zoomFactor,newZoomFactor:t}),r._zoomFactor=t,r.invalidateLayout(),(n=(o=r._render)._getCtx())&&this._restoreCanvas(n.canvas,t,o._getGrayAreaBackColor(!1)),o._paintFloatingObject(x,t),o._paintComment(x)))},t.prototype.endZoom=function(e){var t=this._sheet;t._zoomFactor=this._getNewZoomFactor(e,this._oldZoomFactor),t._needSyncHScrollbarSize=!0,t._needSyncVScrollbarSize=!0,t.invalidateLayout(),t.repaint()},t}(),(X=a||(a={}))[X.NotStarted=0]="NotStarted",X[X.HorizontalOnly=1]="HorizontalOnly",X[X.VecticalOnly=2]="VecticalOnly",X[X.Free=3]="Free";var fe,ge,me=function(){function t(e){this.BOUNDARY_SCOPE=200,this.INERTIA_BOUNDARY_SCOPE=20,this.sheet=e}return t.prototype._getNewTopRowInfo=function(e,t){var o,n,r=t,i=0,a=0,s=this.sheet,l=s._cachePool,u=s._getSheetLayout().viewportY,c=s._getViewportRowLayout(1).findRow(r);if(c)if(e>0){for(o=s._getScrollableRow(-1),i=u-c.y;r>o&&i<e;)r--,i+=l.getZoomRowHeight(r);a=e-i}else if(e<0){for(n=s._getLastVisualScrollRow(),i=-(c.y+c.height-u);r<n&&i>e;)r++,i-=l.getZoomRowHeight(r);a=e-i}return{row:r,offset:a}},t.prototype._getNewLeftColumnInfo=function(e,t){var o,n,r=t,i=0,a=0,s=this.sheet,l=s._cachePool,u=s._getSheetLayout().viewportX,c=s._getViewportColumnLayout(1).findCol(r);if(c)if(e>0){for(o=s._getScrollableColumn(-1),i=u-c.x;r>o&&i<e;)r--,i+=l.getZoomColWidth(r);a=e-i}else if(e<0){for(n=s._getLastVisualScrollColumn(),i=-(c.x+c.width-u);r<n&&i>e;)r++,i-=l.getZoomColWidth(r);a=e-i}return{col:r,offset:a}},t.prototype._createTouchViewportColumnLayout=function(t){for(var o,n=new e._LayoutModel,r=this.sheet,i=r._cachePool,a=r._getSheetLayout(),s=A(r.frozenColCount,r._scrollLeftCol),l=r.getColumnCount()-r._frozenTrailingColCount,u=a.viewportX+t,c=a.viewportWidth-t;c>0&&s<l;s++)o=i.getZoomColWidth(s),n.push(new e._Layout(-1,s,u,-1,o,-1)),u+=o,c-=o;return n},t.prototype._updateTouchViewportColumnLayout=function(e){var t=this.sheet._colLayoutCache;t.viewport||(t.viewport={}),t.viewport[1]=this._createTouchViewportColumnLayout(e)},t.prototype._createTouchViewportRowLayout=function(t){for(var o,n=new e._LayoutModel,r=this.sheet,i=r._cachePool,a=r._getSheetLayout(),s=A(r.frozenRowCount,r._scrollTopRow),l=r.getRowCount()-r._frozenTrailingRowCount,u=a.viewportY+t,c=a.viewportHeight-t;c>0&&s<l;s++)o=i.getZoomRowHeight(s),n.push(new e._Layout(s,-1,-1,u,-1,o)),u+=o,c-=o;return n},t.prototype._updateTouchViewportRowLayout=function(e){var t=this.sheet._rowLayoutCache;t.viewport||(t.viewport={}),t.viewport[1]=this._createTouchViewportRowLayout(e)},t.prototype._invalidateLayout=function(){var e=this.sheet,t=e._colLayoutCache.viewport,o=e._rowLayoutCache.viewport;e.invalidateLayout(),e._colLayoutCache.viewport=t,e._rowLayoutCache.viewport=o},t.prototype._paintAdornment=function(e,t){var o,n,r,i,a=this.sheet,s=a._render;if(e&&!a._paintSuspended&&!(a._layoutSuspended>0)&&(o=a._getSheetLayout(),!a._hoverCell))for(r=0;r<=2;r++)for(i=0;i<=2;i++)(n=o.viewportRect(r,i))&&0!==n.width&&0!==n.height&&(!t||n.intersectRect(t))&&s.paintSelection(e,r,i,t)},t.prototype._getBoundaryFactor=function(e,t){return parseInt(-t/(e/t+1)+t)},t.prototype._getDistance=function(e,t){return parseInt(t*(-t/(e-t)-1))},t.prototype._triggerTopRowChanged=function(e,t,o){e.triggerTopRowChanged({sheet:e,sheetName:e._name,oldTopRow:t,newTopRow:o})},t.prototype._triggerLeftColChanged=function(e,t,o){e.triggerLeftColumnChanged({sheet:e,sheetName:e._name,oldLeftCol:t,newLeftCol:o})},t.prototype._vScrollTo=function(t,o,n,r){var i,a,s,l,u,c=this,h=c.sheet,p=h._scrollTopRow,d=c._getNewTopRowInfo(t,p),f=d.row,g=d.offset;if(h._scrollTopRow=f,h._paintSuspended||h._layoutSuspended>0)return!1;if(e.util._useDoubleBuffer()){var m=h.getBounds(),_=h._getSheetLayout(),y=_.viewportY,C=_.viewportHeight,w=m?m.x:_.x,v=_.width;h._render._getCtx();if(t<0){if(c.cachedOffsetY=0,c.cachedAvailableOffsetY=0,(s=h._getViewportRowLayout(1))&&s.length>0&&(i=s.findRow(f)),i&&(a=s[s.length-1]).row>=f){var S=2,x=y+b(t);(R=T(y+C,a.y+a.height)-x)>=0&&(R-=S,c._updateTouchViewportRowLayout(g-i.height),n.x=w,n.y=x,n.width=v,n.height=R,n.tx=w,n.ty=y,r.x=w,r.y=y+R,r.width=v,r.height=C-R)}}else if(t>0){if(f===h._getScrollableRow(-1)&&g>0)if(c.cachedOffsetY>0&&c.cachedAvailableOffsetY>0){if(l=c.cachedOffsetY+t,g=u=c._getBoundaryFactor(l,c.BOUNDARY_SCOPE),(t=u-c.cachedAvailableOffsetY)<=0)return o;if(o&&u>=c.INERTIA_BOUNDARY_SCOPE)return!0;c.cachedOffsetY=l,c.cachedAvailableOffsetY=u}else{if(g>=c.BOUNDARY_SCOPE&&(t-=g-(c.BOUNDARY_SCOPE-1),g=c.BOUNDARY_SCOPE-1,t<=0))return o;if(l=c._getDistance(g,c.BOUNDARY_SCOPE),u=g,o&&u>=c.INERTIA_BOUNDARY_SCOPE)return!0;c.cachedOffsetY=l,c.cachedAvailableOffsetY=u}else c.cachedOffsetY=0,c.cachedAvailableOffsetY=0;if(t<C){S=2,x=y;var R=C-t;h.getFrozenTrailingRowCount()>0&&(R-=1),c._updateTouchViewportRowLayout(g),n.x=w,n.y=x,n.width=v,n.height=R,n.tx=w,n.ty=x+t,r.x=w,r.y=x,r.width=v,r.height=t+S}}}return!1},t.prototype._hScrollTo=function(t,o,n,r){var i,a,s,l,u,c=this,h=c.sheet,p=h._scrollLeftCol,d=c._getNewLeftColumnInfo(t,p),f=d.col,g=d.offset;if(h._scrollLeftCol=f,h._paintSuspended||h._layoutSuspended>0)return!1;if(e.util._useDoubleBuffer()){var m=h.getBounds(),_=h._getSheetLayout(),y=_.viewportX,C=_.viewportWidth,w=m?m.y:_.y,v=_.height;h._render._getCtx();if(t<0){if(c.cachedOffsetX=0,c.cachedAvailableOffsetX=0,(s=h._getViewportColumnLayout(1))&&s.length>0&&(i=s.findCol(f)),i&&(a=s[s.length-1]).col>=f){var S=2,x=y+b(t);(R=T(y+C,a.x+a.width)-x)>=0&&(R-=S,c._updateTouchViewportColumnLayout(g-i.width),n.x=x,n.y=w,n.width=R,n.height=v,n.tx=y,n.ty=w,r.x=y+R,r.y=w,r.width=C-R,r.height=v)}}else if(t>0){if(f===h._getScrollableColumn(-1)&&g>0)if(c.cachedOffsetX>0&&c.cachedAvailableOffsetX>0){if(l=c.cachedOffsetX+t,g=u=c._getBoundaryFactor(l,c.BOUNDARY_SCOPE),(t=u-c.cachedAvailableOffsetX)<=0)return o;if(o&&u>=c.INERTIA_BOUNDARY_SCOPE)return!0;c.cachedOffsetX=l,c.cachedAvailableOffsetX=u}else{if(g>=c.BOUNDARY_SCOPE&&(t-=g-(c.BOUNDARY_SCOPE-1),g=c.BOUNDARY_SCOPE-1,t<=0))return o;if(l=c._getDistance(g,c.BOUNDARY_SCOPE),u=g,o&&u>=c.INERTIA_BOUNDARY_SCOPE)return!0;c.cachedOffsetX=l,c.cachedAvailableOffsetX=u}else c.cachedOffsetX=0,c.cachedAvailableOffsetX=0;if(t<C){S=2,x=y;var R=C-t;h.getFrozenTrailingColumnCount()>0&&(R-=1),c._updateTouchViewportColumnLayout(g),n.x=x,n.y=w,n.width=R,n.height=v,n.tx=x+t,n.ty=w,r.x=x,r.y=w,r.width=t+S,r.height=v}}}return!1},t.prototype._fillRect=function(e,t,o,n,r,i){e.fillStyle=t,e.fillRect(o,n,r,i)},t.prototype._getColHeaderFillStyle=function(t,o,n,r,i){var a,s,l,u,c,h=e.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-columnHeader-normal"),p=h&&h.backgroundImage,d=h&&h.backgroundColor;if(p&&-1!==p.indexOf("linear-gradient"))for(s=e.util.getLinearGradientColors(p),a=t.createLinearGradient(o+r/2,n,o+r/2,n+i),l=0,u=s.length;l<u;l++)c=s[l],a.addColorStop(c.point,c.color);else d&&(a=d);return a},t.prototype._getRowHeaderFillStyle=function(t,o,n,r,i){var a=e.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-rowHeader-normal");return a&&a.backgroundColor},t.prototype._fillGrayArea=function(e){var t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y=this,C=y.sheet,w=(C.getBounds(),C._getSheetLayout()),v=C._render,S=v._getGrayAreaBackColor(!1),x=v._getCtx(),R=v._getBufferCtx(),b=C._getViewportRowLayout(1);t=w.headerX,n=w.width,i=C._getScrollableRow(-1),(a=b.findRow(i))&&(o=w.viewportY,(r=a.y-o-1)>0&&(e?(s=w.rowHeaderWidth,l=y._getRowHeaderFillStyle(x,t,o,s-1,r+1),y._fillRect(x,l,t,o,s-1,r+1),y._fillRect(R,l,t,o,s-1,r+1),y._fillRect(x,S,t+s,o,n-s,r),y._fillRect(R,S,t+s,o,n-s,r)):(y._fillRect(x,S,t,o,n,r),y._fillRect(R,S,t,o,n,r)))),u=C._getScrollableRow(C.getRowCount(),!0),(c=b.findRow(u))&&(o=c.y+c.height,(r=w.frozenTrailingY-o-1)>0&&(y._fillRect(x,S,t,o,n,r),y._fillRect(R,S,t,o,n,r))),h=C._getViewportColumnLayout(1),o=w.headerY,r=w.height,p=C._getScrollableColumn(-1),(d=h.findCol(p))&&(t=w.viewportX,(n=d.x-t-1)>0&&(e?(f=w.colHeaderHeight,g=y._getColHeaderFillStyle(x,t,o,n+1,f-1),y._fillRect(x,g,t,o,n+1,f-1),y._fillRect(R,g,t,o,n+1,f-1),y._fillRect(x,S,t,o+f,n,r-f),y._fillRect(R,S,t,o+f,n,r-f)):(y._fillRect(x,S,t,o,n,r),y._fillRect(R,S,t,o,n,r)))),m=C._getScrollableColumn(C.getColumnCount(),!0),(_=h.findCol(m))&&(t=_.x+_.width,(n=w.frozenTrailingX-t-1)>0&&(y._fillRect(x,S,t,o,n,r),y._fillRect(R,S,t,o,n,r)))},t.prototype._strokeLine=function(e,t,o,n,r,i){e.beginPath(),e.strokeStyle=t,e.moveTo(o,n),e.lineTo(r,i),e.stroke()},t.prototype._makeUpGridline=function(t){var o,n,r,i,a,s,l,u,c,h=this.sheet,p=(h.getBounds(),h._getSheetLayout()),d=h._render,f=h.gridline.color,g=e.ThemeStyleHelper.getVisualStateThemeStyle(0,"gc-columnHeader-normal"),m=g&&g.borderBottomColor,_=d._getCtx(),y=h._getViewportRowLayout(1);o=p.headerX,r=p.width,a=h._getScrollableRow(-1),(s=y.findRow(a))&&(n=p.viewportY,(i=s.y-n)>0&&(this._strokeLine(_,f,o,s.y-.5,o+r,s.y-.5),t&&this._strokeLine(_,m,p.frozenX-.5,n,p.frozenX-.5,s.y))),l=h._getViewportColumnLayout(1),n=p.headerY,i=p.height,u=h._getScrollableColumn(-1),(c=l.findCol(u))&&(o=p.viewportX,(r=c.x-o)>0&&(this._strokeLine(_,f,c.x-.5,n,c.x-.5,n+i),t&&this._strokeLine(_,m,o,p.frozenY-.5,c.x,p.frozenY-.5)))},t.prototype._getScrollDirection=function(e,t){var o=0;return this.sheet.parent&&this.sheet.parent.touchScrollOnRails()?(o|=0!==e?1:0,o|=0!==t?2:0):o=3,o},t.prototype._continueScrollCore=function(t,o,n,r){var i,a,s,l,u,c=this.sheet,h=!0,p=!0,d=c._render,f=d._getCtx(),g=0!=(2&n),m=0!=(1&n);if(m||g){var _=c.getBounds(),y=c._getSheetLayout(),C=_?_.y:y.y,w=y.height,v=_?_.x:y.x,S=y.width;return g&&(a={},i={},h=this._vScrollTo(o,r,i,a),d.copyScreen(i.x,i.y,i.width,i.height,i.tx,i.ty)),m&&(s={},l={},p=this._hScrollTo(t,r,s,l),d.copyScreen(s.x,s.y,s.width,s.height,s.tx,s.ty),g||(i=s,a=l)),(u=c.parent)&&!u._scrollbarShowMax&&(m&&(c._needSyncHScrollbarSize=!0),g&&(c._needSyncVScrollbarSize=!0)),this._invalidateLayout(),m&&g?d.paintBody(f,new e.Rect(a.x,a.y,a.width,a.height),new e.Rect(l.x,l.y,l.width,l.height)):d.paintBody(f,new e.Rect(a.x,a.y,a.width,a.height)),this._paintAdornment(f,new e.Rect(v,C,S,w)),this._makeUpGridline(!0),this._fillGrayArea(!0),this.onSheetScroll(m,g),h&&p}},t.prototype.onSheetScroll=function(e,t){var o,n=this.sheet;t&&n._syncVScrollbarPosition(),e&&n._syncHScollbarPosition(),n._eventHandler.updateEditingEditor(),(o=n._commentManager)&&o.updateCommentsLayoutWhenSheetScroll()},t.prototype._getCurrentPositionByTime=function(e,t,o,n){return I(.75,e/=o)*n*(t?1:-1)},t.prototype._getCurrentTimeByPosition=function(e,t,o){return e=b(e),O(e/=o)/O(.75)*t},t.prototype._buildScrollDirection=function(e,t){var o=0;return e||(o|=1),t||(o|=2),o},t.prototype._endScrollWithAnimation=function(e,t,o){var n=this,r=n.sheet,i=n.BOUNDARY_SCOPE,a=n._getCurrentTimeByPosition(e,10,i),s=n._getCurrentTimeByPosition(t,10,i),l=e,u=t,c=0,h=0,p=!1,d=!1;n.interval=setInterval(function(){var f;if(p&&d)return r._cachePool.endCache(),(f=r.parent)&&!f._scrollbarShowMax&&(r._needSyncHScrollbarSize=!0,r._needSyncVScrollbarSize=!0),r._cachePool.clearCacheEndPan(),r.invalidateLayout(),r.repaint(),r._syncHScollbarPosition(),r._syncVScrollbarPosition(),clearInterval(n.interval),void(n.interval=x);if(s+=20,(a+=20)>100&&s>100)n._continueScrollCore(e-c,t-h,n._buildScrollDirection(p,d),o),p=!0,d=!0;else{a>100&&!p&&(n._continueScrollCore(e-c,0,1,o),p=!0),s>100&&!d&&(n._continueScrollCore(0,t-h,2,o),d=!0);var g=n._getCurrentPositionByTime(a,e>0,10,i),m=n._getCurrentPositionByTime(s,t>0,10,i),_=P(l-g),y=P(u-m);n._continueScrollCore(_,y,n._buildScrollDirection(p,d),o),l=g,u=m,c+=_,h+=y}},20)},t.prototype.startScroll=function(e){var t=this;t.interval&&(t.sheet._cachePool.clearCacheEndPan(),clearInterval(this.interval),t.interval=x),t.cachedOffsetX=0,t.cachedAvailableOffsetX=0,t.cachedOffsetY=0,t.cachedAvailableOffsetY=0,t.oldScrollTopRow=t.sheet._scrollTopRow,t.oldScrollLeftCol=t.sheet._scrollLeftCol,e&&t.sheet._cachePool.startCacheBeforPan()},t.prototype.continueScroll=function(e,t){var o=parseInt(e.X),n=parseInt(e.Y),r=this._getScrollDirection(o,n);return this._continueScrollCore(o,n,r,t)},t.prototype.endScroll=function(e){var t,o,n,r,i,a,s,l,u,c,h,p,d=this.sheet,f=d._getSheetLayout(),g=f.viewportX,m=f.viewportY,_=d._getViewportColumnLayout(1),y=d._getLastVisualScrollColumn();_&&_.length>0&&(o=d._scrollLeftCol,t=_.findCol(o),o<y&&t&&t.x+t.width-g<t.width/2&&d._scrollLeftCol++),n=d._getViewportRowLayout(1),i=d._getLastVisualScrollRow(),n&&n.length>0&&(a=d._scrollTopRow,r=n.findRow(a),a<i&&r&&r.y+r.height-m<r.height/2&&d._scrollTopRow++),s=0,l=0,_&&_.length>0&&(s=g-(t=_.findCol(d._scrollLeftCol)).x),n&&n.length>0&&(l=m-(r=n.findRow(d._scrollTopRow)).y),(u=d._scrollTopRow)!==(c=this.oldScrollTopRow)&&this._triggerTopRowChanged(d,c,u),(h=d._scrollLeftCol)!==(p=this.oldScrollLeftCol)&&this._triggerLeftColChanged(d,p,h),this._endScrollWithAnimation(s,l,e)},t}(),_e=function(){function t(e){this._isScroll=!1,this._touchZoomManager=new i(e),this._touchScrollManager=new me(e),this.sheet=e}return t.prototype.doManipulationStarting=function(e){var t,o=this.sheet._getSheetLayout();e.Mode=0,(t=this._touchHitTest(e.Position.X,e.Position.Y))&&(t.resizeInfo||t.dragInfo&&"corner"===t.dragInfo.side||t.selectionHitInfo)?(o.viewportY<=t.y&&t.y<o.frozenTrailingY&&(e.Mode|=2),o.viewportX<=t.x&&t.x<o.frozenTrailingX&&(e.Mode|=1)):(o.viewportY<=t.y&&t.y<o.frozenTrailingY&&(e.Mode|=2),o.viewportX<=t.x&&t.x<o.frozenTrailingX&&(e.Mode|=1),e.Mode|=96,this.sheet.parent&&this.sheet.parent.touchScrollOnRails()&&(e.Mode|=12))},t.prototype.doManipulationStarted=function(e){var t,o,n=this.sheet,r=n._eventHandler,i=n._render,a=this._touchHitTest(e.Position.X,e.Position.Y);if(n._currentTarget=a,a.resizeInfo){if(!n.endEdit())return;r.startResizing(a)}else if(a.dragInfo&&"corner"===a.dragInfo.side)r.startDragFill(a);else if(a.selectionHitInfo){if(!n.endEdit())return;var s=a.selectionHitInfo,l=s.isHeader,u=s.isFirstIndicator,c=s.type;l&&r._startSelectingCore(a,!0),t=a.hitTestType,a.hitTestType=a.selectionHitInfo.type,r._startSelectingScroll(a),a.hitTestType=t,this._changeActiveCellBeforeSelect(l,u,c),i._showTouchSelectionIndicator=!1,i.refreshTouchSelectionIndicator()}else(o=n._commentRender)&&(o.showWhenTouchMoveOrScroll=!1),i._showTouchSelectionIndicator=!1,i.refreshTouchSelectionIndicator(),e.PointerCount>1&&n.parent&&n.parent._allowUserZoom?(this._isScroll=!1,this._touchZoomManager.startZoom()):(this._isScroll=!0,this._touchScrollManager.startScroll(1===e.PointerCount))},t.prototype.doManipulationDelta=function(e){var t,o,n,r,i=this.sheet,a=i._eventHandler,s=e.Position.X,l=e.Position.Y;if(i._currentTarget)if((t=i._currentTarget).resizeInfo)a.mousePosition={e:e,x:s,y:l},a.continueResizing();else if(t.dragInfo&&"corner"===t.dragInfo.side)a.mousePosition={e:e,x:s,y:l},a.continueDragFill();else if(t.selectionHitInfo||a.isSelecting){if(o=t.selectionHitInfo){if(!a.startHitInfo||!a.isWorking)return;if(!0===a._forceCancelSelectiong)return;n=o.type,a.mousePosition={e:e,x:s,y:l},3===n?a.continueCellSelecting():2===n?a.continueRowSelecting():1===n&&a.continueColumnSelecting()}}else this._isScroll?e.IsComplete=this._touchScrollManager.continueScroll(e.Delta.Translation,e.IsInertia):(r=e.Cumulative.Scale,this._touchZoomManager.continueZoom(r))},t.prototype.doManipulationInertiaStarting=function(e){},t.prototype.doManipulationCompleted=function(e){var t,o,n,r,i=this.sheet,a=i._eventHandler,s=i._render;if(s._showTouchSelectionIndicator=!0,(t=i._currentTarget).resizeInfo)a.stopResizing();else if(t.dragInfo&&a.isDraggingFill)a.endDragFill(),i.parent.touchToolStrip._closeAutoFillIndicator();else if(t.selectionHitInfo||a.isSelecting){if(a.stopSelecting(),o=t.selectionHitInfo){var l=o.isHeader,u=o.isFirstIndicator,c=o.type;this._changeActiveCellAfterSelect(l,u,c)}s.repaintSelection()}else(n=i._commentRender)&&(n.showWhenTouchMoveOrScroll=!0),this._isScroll?this._touchScrollManager.endScroll(e.IsInertia):(r=e.Cumulative.Scale,this._touchZoomManager.endZoom(r))},t.prototype.doTapped=function(t){var o,n,r,i,a,s,l,u,c,h,p=this,d=p.sheet,f=!1;p._clearTouchToolStripTimeout(),"function"==typeof d.unSelectAllFloatingObjects&&d.unSelectAllFloatingObjects(),(o=d._commentManager)&&o.deactivateComment();var g=d._eventHandler,m=p._touchHitTest(t.Position.X,t.Position.Y,!0),_=m.row,y=m.col,C=m.groupHitInfo;if(C)d.isEditing()||g._doClickRangeGroup(C);else if(d._currentTarget=m,m.filterButtonHitInfo){if(!d.endEdit())return;(n=m.filterButtonHitInfo).rowFilter&&n.rowFilter.openFilterDialog(n)}else if(!m.resizeInfo&&d.canSelect(m.rowViewportIndex<0?-1:_,m.colViewportIndex<0?-1:y)){(r=d._render)._existTouchDragFillIndicator&&!g.isDraggingFill&&d.parent.touchToolStrip._closeAutoFillIndicator();var w=d.getActiveRowIndex(),v=d.getActiveColumnIndex(),S=m.cellTypeHitInfo;if(S){if((i=S.sheetArea)!==x&&i!==R&&3!==i||_===w&&y===v)r.refreshTouchSelectionIndicator();else{if(a=d.isPaintSuspended(),d.isPaintSuspended(!0),!d.endEdit())return;if(s={sheet:d,sheetName:d._name,row:w,col:v,cancel:!1},d.triggerLeaveCell(s),s&&!0===s.cancel)return;var b,T=d._selectionModel.toArray(),A=d._getSpanModel().find(_,y);b=A?[new e.Range(A.row,A.col,A.rowCount,A.colCount)]:[new e.Range(_,y,1,1)],d.triggerSelectionChanging({sheet:d,sheetName:d._name,oldSelections:T,newSelections:b}),l=S.isReservedLocation&&S.isFocusAware,d._setActiveCellAndSelection(_,y,R,R,l?0:1),d.triggerEnterCell({sheet:d,sheetName:d._name,row:_,col:y}),d.triggerSelectionChanged({sheet:d,sheetName:d._name}),g._updateValidationUI(_,y),d.isPaintSuspended(a),f=!0}u=d.getCellType(_,y,m.hitTestType),S.sheet||(S.sheet=d),u.processMouseDown(S),u.processMouseUp(S)}if(S&&S.isReservedLocation)return!0;d.triggerCellClick({sheet:d,sheetName:d._name,sheetArea:m.hitTestType,row:m.row,col:m.col});try{if(g._hitTestResult=m,d.isEditing()&&w===d.getActiveRowIndex()&&v===d.getActiveColumnIndex()&&!d.endEdit())return}finally{g._hitTestResult=x}if(_===R||_===x||y===R||y===x)return;3===m.hitTestType&&g._updateValidationUI(_,y),p._isTouchSelected(_,y,m.hitTestType)&&!f?p._touchToolStripTimeout=setTimeout(function(){var e={x:m.x,y:m.y,handled:!1},t=d.parent.touchToolStrip;d.triggerTouchToolStripOpening(e),e.handled||t.open(m.x,m.y-100),p._clearTouchToolStripTimeout()},z.DoubleTappedTimeOffset+20):(c=d._selectionModel.toArray(),g._startSelectingCore(m),h=d._selectionModel.toArray(),g._notEqualSelecions(c,h)&&d.triggerSelectionChanging({sheet:d,sheetName:d._name,oldSelections:c,newSelections:h}),g.stopSelecting())}},t.prototype.doDoubleTapped=function(t){var o,n,r,i,a,s,l,u,c,h,p,d=this.sheet;if(this._clearTouchToolStripTimeout(),(i=d._currentTarget)&&(d.triggerCellDoubleClick({sheet:d,sheetName:d._name,sheetArea:i.hitTestType,row:i.row,col:i.col}),a=i.resizeInfo))if("sizeRow"===a.action||"sizeHiddenRow"===a.action){if(s=[],d._isRowSelected(a.index)){for(o=0;o<d._selectionModel.length;o++)if(-1===(n=d._selectionModel[o]).col)for(n=d._getActualRange(n),l=0;l<n.rowCount;l++)s.push({row:n.row+l})}else s.push({row:a.index});r=new e.UndoRedo.RowAutoFitUndoAction(d,s,1===a.sheetArea),d._doCommand(r)}else{if(u=[],d._isColumnSelected(a.index)){for(o=0;o<d._selectionModel.length;o++)if(-1===(n=d._selectionModel[o]).row)for(n=d._getActualRange(n),c=0;c<n.colCount;c++)u.push({col:n.col+c})}else u.push({col:a.index});r=new e.UndoRedo.ColumnAutoFitUndoAction(d,u,2===a.sheetArea),d._doCommand(r)}else if((h=this._touchHitTest(t.Position.X,t.Position.Y,!0))&&h.row>=0&&h.col>=0&&h.rowViewportIndex>=0&&h.colViewportIndex>=0&&!h.resizeInfo&&(!d.isProtected||!d.getStyleProperty(h.row,h.col,"locked"))){d._clearSelectionImp();var f=d.getRowCount(),g=d.getColumnCount(),m=1;h.row<d.frozenRowCount?m=0:h.row>=f-d._frozenTrailingRowCount&&(m=2),p=1,h.col<d.frozenColCount?p=0:h.col>=g-d._frozenTrailingColCount&&(p=2),d._setActiveCellImp(h.row,h.col,m,p,!0),d.addSelection(h.row,h.col,1,1),d._eventHandler.resumeFocus(!1),d._startEditImp(d._getCanvas(),h.row,h.col)}},t.prototype.doRightTapped=function(e){},t.prototype.doTouchOperatorStart=function(e){var t,o=this.sheet,n=this._touchHitTest(e.Position.X,e.Position.Y);o.isEditing()?(n.row!==o._activeRowIndex||n.col!==o._activeColIndex)&&o._eventHandler.releaseFocus(n):(this._target=n,(t=this._touchHitTest(e.Position.X,e.Position.Y,!0))&&t.cellTypeHitInfo&&t.cellTypeHitInfo.isEditting||o._eventHandler.releaseFocus(t))},t.prototype.doTouchOperatorEnd=function(e){var t,o,n,r=this.sheet;r.isEditing()||(o=!0,(t=this._target)&&(t.cellTypeHitInfo&&t.cellTypeHitInfo.isReservedLocation?o=!1:(n=r.getCellType(t.row,t.col))&&n.isEditting()&&(o=!1)),o&&r._eventHandler.resumeFocus())},t.prototype._touchHitTest=function(e,t,o){var n,r,i,a,s,l,u,c,h,p=this.sheet,d=p._render;return p._getSheetLayout(),n={x:e,y:t,rowViewportIndex:x,colViewportIndex:x,row:-1,col:-1,resizeInfo:x,hitTestType:x,groupHitInfo:x,filterButtonHitInfo:x,dragInfo:x,cellTypeHitInfo:x,selectionHitInfo:x,formulaRangeHitInfo:x},(r=d.groupHitTest(e,t))?n.groupHitInfo=r:(i=p._getRowViewportIndexFromY(t),a=p._getColumnViewportIndexFromX(e),n.rowViewportIndex=i,n.colViewportIndex=a,n.row=p._getRowIndexFromY(t,i),n.col=p._getColumnIndexFromX(e,a),i>=0&&i<=2&&a>=0&&((s=p._getCellLayoutByCell(i,a,R,n.row,n.col))&&(n.row=s.row,n.col=s.col)),n.hitTestType=p._getSheetArea(i,a),d._existTouchDragFillIndicator&&(u=this._getDragFillInfo(n,e,t))?n.dragInfo=u:(l=this._getTouchResizeInfo(n,e,t,10))?n.resizeInfo=l:(c=p._getFilterButtonHitInfo(n,e,t))?n.filterButtonHitInfo=c:!o&&(h=this._getSelectionHitInfo(n,e,t))?n.selectionHitInfo=h:n.cellTypeHitInfo=p._getCellTypeHitInfo(n,e,t)),n},t.prototype._getTouchResizeInfo=function(e,t,o,n){var r=this.sheet,i=r._eventHandler,a=r.getSelections(),s=x;if(r._isTouchMode&&a.length>0){var l=a[a.length-1],u=l.row,c=l.row+l.rowCount-1,h=l.col,p=l.col+l.colCount-1;(!r.parent||r.parent._allowUserResize)&&(-1!==u&&-1===h&&e.rowViewportIndex>=0&&e.colViewportIndex<0&&r.rowHeaderVisible?(s=i._getResizeRowInfo(r,e,n,2,o))&&("sizeRow"===s.action||"sizeHiddenRow"===s.action)&&2===s.sheetArea&&s.index!==c&&(s=x):-1===u&&-1!==h&&e.rowViewportIndex<0&&e.colViewportIndex>=0&&r.colHeaderVisible&&((s=i._getResizeColInfo(r,e,n,1,t))&&("sizeCol"===s.action||"sizeHiddenCol"===s.action)&&1===s.sheetArea&&s.index!==p&&(s=x)))}return s},t.prototype._getSelectionHitInfo=function(e,t,o){var n,r,i,a=this.sheet,s=a._render.getSelectionIndicatorRects(),l=a.getSelections(),u=3;for(a._isTouchMode&&l.length>0&&(-1!==(n=l[l.length-1]).row&&-1!==n.col?u=3:-1!==n.row?u=2:-1!==n.col&&(u=1)),r=0;r<s.length;r++)if((i=s[r]).x-=i.width,i.y-=i.height,i.width*=3,i.height*=3,i.contains(t,o))return{x:t,y:o,type:u,isHeader:!1,isFirstIndicator:0===r};return 1===e.hitTestType?{x:t,y:o,type:1,isHeader:!0}:2===e.hitTestType?{x:t,y:o,type:2,isHeader:!0}:x},t.prototype._getDragFillInfo=function(e,t,o){var n,r,i,a,s,l,u,c=x,h=e.rowViewportIndex,p=e.colViewportIndex;if(typeof h===L||h===x||typeof p===L||p===x)return c;if(r=(n=this.sheet)._getActiveSelectedRange(),h>=0&&p>=0&&1===n._selectionModel.length){var d=n._getActualRange(r),f=n._frozenTrailingColCount,g=n._frozenTrailingRowCount,m=n.getColumnCount()-f,_=n.getRowCount()-g;if(1===p&&f>0&&d.col<m&&d.col+d.colCount>m&&((i=n._getColumnLayout(p))&&i.length>0&&t>(a=i[i.length-1]).x+a.width)||1===h&&g>0&&d.row<_&&d.row+d.rowCount>_&&((s=n._getRowLayout(h))&&s.length>0&&o>(l=s[s.length-1]).y+l.height))return c}return(u=n._render.getTouchDragFillIndicatorRect())&&(c||(u.x-=u.width,u.y-=u.height,u.width*=3,u.height*=3,u.contains(t,o)&&(c={action:"drag",side:"corner"})),n.canUserDragFill()||c&&"corner"===c.side&&(c.side=x)),c},t.prototype._clearTouchToolStripTimeout=function(){this._touchToolStripTimeout&&(clearTimeout(this._touchToolStripTimeout),this._touchToolStripTimeout=x)},t.prototype._isTouchSelected=function(e,t,o){for(var n,r=!1,i=this.sheet,a=i._selectionModel,s=0,l=a.length;s<l;s++){if(n=a[s],3===o||typeof o===R||o===x)r=(n=i._getActualRange(n)).row<=e&&e<n.row+n.rowCount&&n.col<=t&&t<n.col+n.colCount;else if(2===o)r=-1===n.col&&n.row<=e&&e<n.row+n.rowCount;else if(1===o)r=-1===n.row&&n.col<=t&&t<n.col+n.colCount;else if(0===o)return r;if(r)return r}return r},t.prototype._changeActiveCellBeforeSelect=function(e,t,o){if(!e){var n=this.sheet,r=n.getSelections(),i=r[r.length-1];t?3===o?(n._activeRowIndex=i.row+i.rowCount-1,n._activeColIndex=i.col+i.colCount-1):2===o?(n._activeRowIndex=i.row+i.rowCount-1,n._activeColIndex=0):1===o&&(n._activeRowIndex=0,n._activeColIndex=i.col+i.colCount-1):3===o?(n._activeRowIndex=i.row,n._activeColIndex=i.col):2===o?(n._activeRowIndex=i.row,n._activeColIndex=0):1===o&&(n._activeRowIndex=0,n._activeColIndex=i.col)}},t.prototype._changeActiveCellAfterSelect=function(e,t,o){var n=this.sheet,r=n.getSelections(),i=r[r.length-1];(e||t)&&(3===o?(n._activeRowIndex=i.row,n._activeColIndex=i.col):2===o?(n._activeRowIndex=i.row,n._activeColIndex=0):1===o&&(n._activeRowIndex=0,n._activeColIndex=i.col))},t}(),ye=function(){function e(e,t,o){this._touchEventProvider=o,this._touchMouseMessageFilter=new h(t),this._touchEventHandler=new _e(t),this._touchTarget=new _(e,"sheet",this._touchMouseMessageFilter,100,100),this._touchTarget.level=10,this._touchEventProvider.attachDettach(this._touchTarget,!0)}return e.prototype.attach=function(){this._touchEventProvider;var e=this._touchEventHandler,t=this._touchTarget;t.manipulationStarting=function(t){return e.doManipulationStarting(t)},t.manipulationStarted=function(t){return e.doManipulationStarted(t)},t.manipulationDelta=function(t){return e.doManipulationDelta(t)},t.manipulationInertiaStarting=function(t){return e.doManipulationInertiaStarting(t)},t.manipulationCompleted=function(t){return e.doManipulationCompleted(t)},t.tapped=function(t){return e.doTapped(t)},t.doubleTapped=function(t){return e.doDoubleTapped(t)},t.rightTapped=function(t){return e.doRightTapped(t)},t.touchOperatorStart=function(t){return e.doTouchOperatorStart(t)},t.touchOperatorEnd=function(t){return e.doTouchOperatorEnd(t)}},e.prototype.detach=function(){var e=this._touchTarget;e&&(this._touchEventProvider.attachDettach(e,!1),e.manipulationStarting=x,e.manipulationStarted=x,e.manipulationDelta=x,e.manipulationInertiaStarting=x,e.manipulationCompleted=x,e.tapped=x,e.doubleTapped=x,e.rightTapped=x,e.touchOperatorStart=x,e.touchOperatorEnd=x,this._touchTarget=x)},e.prototype.preProcessMouseDown=function(e){return this._touchMouseMessageFilter.preProcessMouseDown(e)},e.prototype.preProcessMouseUp=function(e){return this._touchMouseMessageFilter.preProcessMouseUp(e)},e.prototype.preProcessMouseMove=function(e){return this._touchMouseMessageFilter.preProcessMouseMove(e)},e}();e.TouchManager=ye,(fe=s||(s={}))[fe.paste=0]="paste",fe[fe.cut=1]="cut",fe[fe.copy=2]="copy",fe[fe.autoFill=3]="autoFill",l=function(t){function o(o,n){t.call(this,n,e.util.getPreferredZIndex(o._host));var r=this;r._touchEventNamespace=".touchToolStrip",r._buttonClass="toolstrip-button",r._textClass="toolstrip-text",r._imageClass="wijspread-toolstrip-image",r._itemClass="toolstrip-item",r._seprateLineClass="touch-sperate-line",r._imageAreaHeight=32,r._separatorHeight=45,r.menuItems={},r.pasteName="wijspread_toolstrip_paste",r.copyName="wijspread_toolstrip_copy",r.cutName="wijspread_toolstrip_cut",r.autoFillName="wijspread_toolstrip_autofill",r._isOpen=!1,r.spreadHost=o,r._initDialog()}return __extends(o,t),o.prototype.open=function(t,o){var n,r,i;if(this.spreadHost.getActiveSheet()&&(e.FocusHelper.setActiveElement(x,!0),this._toolStripDialog.css({left:t,top:o}),this.show(),this._isOpen=!0,this.resetDialogPosition(),!e.GC$.isEmptyObject(this.menuItems)))for(r in n=this.menuItems)!(i=n[r]).canExecute||i.canExecute.call(this)?e.GC$("#"+r).show():e.GC$("#"+r).hide()},o.prototype.add=function(e){var t,o,n,r;e&&(o=(t=this).menuItems,e instanceof c?(n=e.name())&&(o[n]=e,t._addDom(e.getDOM(t._seprateLineClass,t._separatorHeight+"px"))):e instanceof u&&(r=e.name(),t.getItem(r)||(o[r]=e,t._addDom(e.getDOM(t._imageClass,t._imageAreaHeight+"px",t._textClass,t._buttonClass)))))},o.prototype.getItem=function(e){return this.menuItems[e]},o.prototype.getItems=function(){var t,o=[];if(!e.GC$.isEmptyObject(this.menuItems)){for(t in this.menuItems)o.push(this.menuItems[t]);return o}return x},o.prototype.remove=function(t){if(this.getItem(t)){e.GC$("#"+t).parent().remove();var o=this.menuItems[t];return delete this.menuItems[t],o}return x},o.prototype.clear=function(){this._toolStripDialog&&(this._toolStripDialog.find("td."+this._itemClass).remove(),this.menuItems={})},o.prototype.close=function(){var e,t,o;window.gcGlobal.resumeEvent(),this._toolStripDialog&&this._toolStripDialog.hide(),this._isOpen=!1,this.closeOverlay(),(e=this.spreadHost.getActiveSheet())&&(t=e._render,e.setFocus(),o=e.getSelections(),t&&!t._existTouchDragFillIndicator&&-1===o[0].row&&-1===o[0].col&&e._clearSelectionImp())},o.prototype.imageAreaHeight=function(e){return 0===arguments.length?this._imageAreaHeight:e<=0?void 0:(this._imageAreaHeight=e,this._toolStripDialog.find("span."+this._imageClass).css("height",e+"px"),this)},o.prototype.itemHeight=function(e){var t=this._toolStripDialog.find("button."+this._buttonClass);return 0===arguments.length?parseFloat(t.css("height")):e<=0?void 0:(t.css("height",e+"px"),this)},o.prototype.itemWidth=function(e){var t=this._toolStripDialog.find("button."+this._buttonClass);return 0===arguments.length?parseFloat(t.css("width")):e<0?void 0:(parseFloat(t.css("min-width"))>e&&t.css("min-width",e+"px"),t.css("width",e+"px"),this)},o.prototype.separatorHeight=function(e){return 0===arguments.length?this._separatorHeight:e<=0?void 0:(this._separatorHeight=e,this._toolStripDialog.find("div."+this._seprateLineClass).css("height",e+"px"),this)},o.prototype._createLayoutTable=function(){var t=e.GC$(document.createElement("table")).css({padding:0,display:"table"}).attr({cellspacing:0,cellpadding:0});this._tableRow=e.GC$(document.createElement("tr")).appendTo(t),t.appendTo(this._toolStripDialog)},o.prototype._dispose=function(){var e=this._toolStripDialog;e&&(this._isOpen&&window.gcGlobal.resumeEvent(),e.remove(),this.closeOverlay(),e=x)},o.prototype._initDialog=function(){var e;this._toolStripDialog||(e=this.getContainer(),this._toolStripDialog=e,e.addClass("toolstrip-default ui-state-default well"),e.appendTo(this.getHost()),e.hide(),this._createLayoutTable(),this._setDefaultCellDomString(),this._attachEvent())},o.prototype._attachEvent=function(){var e=this;this._toolStripDialog.bind("click",function(t){var o,n,r,i=t.target;"button"===i.tagName.toLowerCase()?o=i.id:(n=i.parentElement)&&"button"===n.tagName.toLowerCase()&&(o=n.id),r=e.menuItems[o],o&&r&&r.command.call(e)})},o.prototype._addDom=function(t){this._toolStripDialog&&t&&e.GC$(document.createElement("td")).append(t).appendTo(this._tableRow).addClass(this._itemClass)},o.prototype._setDefaultCellDomString=function(){var t=this,n=o._getImageSrc(0),r=o._getImageSrc(1),i=o._getImageSrc(2),a=o._getImageSrc(3);t._pasteItem=new u(t._getItemName(t.pasteName),e.SR.ToolStrip_PasteText,n,t._doTapPaste),t._cutItem=new u(t._getItemName(t.cutName),e.SR.ToolStrip_CutText,r,t._doTapCut),t._copyItem=new u(t._getItemName(t.copyName),e.SR.ToolStrip_CopyText,i,t._doTapCopy),t._autoFillItem=new u(t._getItemName(t.autoFillName),e.SR.ToolStrip_AutoFillText,a,t._showAutoFillIndicator,t._hideAutoFill),t.add(t._pasteItem),t.add(t._cutItem),t.add(t._copyItem),t.add(new c(t._hideAutoFill)),t.add(t._autoFillItem)},o.prototype._hideAutoFill=function(){var e,t,o,n=this.spreadHost.getActiveSheet();if(!n)return!1;for(e=n.getSelections(),t=0;t<e.length;t++)if(-1===(o=e[t]).row&&-1===o.col)return!1;return!0},o.prototype._showAutoFillIndicator=function(){var e,t;this.close(),(e=this.spreadHost.getActiveSheet())&&(e.getSelections().length>1||((t=e._render)._existTouchDragFillIndicator=!0,t.repaintSelection()))},o.prototype._closeAutoFillIndicator=function(){var e,t=this.spreadHost.getActiveSheet();t&&((e=t._render)._existTouchDragFillIndicator=!1,e.repaintSelection())},o.prototype._doTapCopy=function(){var e=this.spreadHost.getActiveSheet();e&&(this._clipboardTouchData=e._doCopy(!0)),this.close()},o.prototype._doTapCut=function(){var e=this.spreadHost.getActiveSheet();e&&(this._clipboardTouchData=e._doCut(!0)),this.close()},o.prototype._doTapPaste=function(){var e=this.spreadHost.getActiveSheet();e&&typeof this._clipboardTouchData!==L&&e._doPaste(this._clipboardTouchData),this.close()},o.prototype._getItemName=function(e){for(var t=0,o=e+t;document.getElementById(o);)o=e+ ++t;return o},o.prototype._updateResource=function(){var t=this._textClass;e.GC$("#"+this._pasteItem._name).find("span."+t).text(e.SR.ToolStrip_PasteText),e.GC$("#"+this._cutItem._name).find("span."+t).text(e.SR.ToolStrip_CutText),e.GC$("#"+this._copyItem._name).find("span."+t).text(e.SR.ToolStrip_CopyText),e.GC$("#"+this._autoFillItem._name).find("span."+t).text(e.SR.ToolStrip_AutoFillText)},o._getImageSrc=function(e){switch(e){case 0:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAA8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86AAAAAElFTkSuQmCC";case 1:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAABkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7AAAAAElFTkSuQmCC";case 2:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAA3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=";case 3:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="}},o}(e.BaseDialog),e.TouchToolStrip=l,u=function(){function t(e,t,o,n,r){this._font="normal 12px Arial";this._name=e,this._text=t,this._image=o,n&&(this.command=n),r&&(this.canExecute=r)}return t.prototype.name=function(t){return 0===arguments.length?this._name:(e.GC$("#"+this._name).attr("id",t),e.GC$("#"+this._name+"Text").attr("id",t+"Text"),e.GC$("#"+this._name+"Image").attr("id",t+"Image"),this._name=t,this)},t.prototype.text=function(t){return 0===arguments.length?this._text:(this._text=t,e.GC$("#"+this.name()+"Text").text(t),this)},t.prototype.font=function(t){var o=e.GC$("#"+this.name()+"Text");return 0===arguments.length?this._font:(this._font=t,o.css("font",t),this)},t.prototype.foreColor=function(t){var o=e.GC$("#"+this.name()+"Text");return 0===arguments.length?this._foreColor?this._foreColor:o.css("color"):(o.css("color",t),this)},t.prototype.image=function(t){return 0===arguments.length?this._image:(this._image=t,e.GC$("#"+this.name()+"Image").css("background-image","url("+t+")"),this)},t.prototype.getDOM=function(t,o,n,r){var i,a,s,l,u=this.name(),c=e.GC$(document.createElement("span"));return c.attr("id",u+"Image"),c.addClass(t),c.css({"background-image":"url("+this.image()+")","background-repeat":"no-repeat",display:"block",height:o,"background-position-x":"50%"}),(i=e.GC$(document.createElement("span"))).attr("id",u+"Text"),i.addClass(n),i.css("font",this.font()),i.text(this.text()),(a=this.getTextSpanWidth(n))>(s=60)&&(s=a),(l=e.GC$(document.createElement("button"))).attr("type","button"),l.attr("id",u),l.addClass(r+" toolstrip-button-style ui-state-default ui-widget btn btn-default"),l.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:s+"px"}),l.append(c),l.append(i),l.getElement(0)},t.prototype.getTextSpanWidth=function(t){var o,n=document.createElement("span");return n.className=t,n.style.font=this.font(),n.style.cssFloat="left",n.textContent=this.text(),document.body.insertBefore(n,x),o=e.GC$(n).width(),document.body.removeChild(n),o},t}(),e.TouchToolStripItem=u,c=function(){function t(e){this._name=this._getSeparatorName(),e&&(this.canExecute=e)}return t.prototype.name=function(){return this._name},t.prototype._getSeparatorName=function(){for(var e=0,t="separator"+e;document.getElementById(t);)t="separator"+ ++e;return t},t.prototype.getDOM=function(t,o){var n=e.GC$(document.createElement("div"));return n.attr("id",this.name()),n.addClass(t),n.css({width:"1px",height:o,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),n.getElement(0)},t}(),e.TouchToolStripSeparator=c,h=function(){function e(e){this.owner=e}return e.prototype.preProcessManipulationStarting=function(){this.eventMode=2,this.owner._isTouchMode=!0},e.prototype.postProcessManipulationComplete=function(){this.eventMode=0,this.touchCompleteTimestamp=(new Date).valueOf()},e.prototype.preProcessPointerDown=function(){return 1===this.eventMode},e.prototype.preProcessPointerUp=function(){return 1===this.eventMode},e.prototype.preProcessPointerMove=function(){return 1===this.eventMode},e.prototype.preProcessMouseDown=function(e){if(2===this.eventMode)return!0;if(this.touchCompleteTimestamp){if((new Date).valueOf()-this.touchCompleteTimestamp<=200)return this.mouseDownHandled++,!0;this.touchCompleteTimestamp=0,this.mouseDownHandled=0,this.eventMode=1}else this.eventMode=1;return this.owner._isTouchMode=!1,!1},e.prototype.preProcessMouseUp=function(e){return this.mouseDownHandled?(this.mouseDownHandled--,!0):2===this.eventMode||(this.eventMode=0,!1)},e.prototype.preProcessMouseMove=function(e){return 2===this.eventMode},e}(),e.TouchMouseMessageFilter=h,(ge=p||(p={}))[ge.None=0]="None",ge[ge.MouseMode=1]="MouseMode",ge[ge.TouchMode=2]="TouchMode",d=function(){function t(e){this._tab=e}return t.prototype.doManipulationStarting=function(e){},t.prototype.doManipulationStarted=function(t){var o=this._tab,n=o._spread.getActiveSheet();o._tabNameEditor&&o.endSheetTabEditing(n,!1);var r=o.hitTest(t.Position.X,t.Position.Y);if("resizeBar"===r.element)o.resizeTab=!0,o.activeX=t.Position.X;else if("tab"===r.element||"newTab"===r.element||""===r.element){var i=o.canvas,a=e.DPIHelper.getLogicWidth(i),s=e.DPIHelper.getLogicHeight(i),l=this._getTouchCanvas(a,s),u=l.getContext("2d"),c=e.DPIHelper.getScaleX(l),h=e.DPIHelper.getScaleY(l);u.scale(1/c,1/h),u.drawImage(i,0,0,l.width,l.height,0,0,l.width,l.height),u.scale(c,h),this._canvas=l,this._oldFirstTab=o._firstTab,this._tabStartPosition=o.getTabStartPosition(),this._tabEndPosition=o.getTabEndPosition(),this._newTabSize=o.getNewTabSize(),o._hideNewTabSecondMoreTab=!0}this._minFirstTabIndex=o._getNextVisibleIndex(-1),this._maxFirstTabIndex=o._reCalculateFirstTabIndex(o._getVisibleTabs())},t.prototype.doManipulationDelta=function(t){var o,n,r,i,a,s,l,u,c,h,p,d=this._tab;if(d.resizeTab){var f=t.Position.X-d.activeX,g=d._spread,m=g._vp.clientWidth;g.setTabStripRatio(g._getActualTabStripRatio()+f/m,!0),o=d._resizeBarWidth/m,1,g._getActualTabStripRatio()<o?(g.setTabStripRatio(o,!0),d.activeX=d._resizeBarWidth):g._getActualTabStripRatio()>=1?(g.setTabStripRatio(1,!0),d.activeX=m):d.activeX=t.Position.X}else{if(n=this._canvas,r=this._oldFirstTab,!n||typeof r===L||r===x)return;var _=this._minFirstTabIndex,y=this._maxFirstTabIndex,C=this._newTabSize,w=this._tabStartPosition,v=this._tabEndPosition,S=t.Cumulative.Translation.X,R=this._getNewFirstTabInfo(S,r);if(d._firstTab=R.firstTab,i=R.width,S>0&&r===_&&d._firstTab===_?i=0:S<0&&r===y&&d._firstTab===y&&(i=0),S>0&&S>i+C?S=i+C:S<0&&S<i-C&&(S=i-C),0!==S){var T=d.canvas,A=T.getContext("2d"),I=e.DPIHelper.getScaleX(T),D=e.DPIHelper.getScaleY(T);A.save(),A.clearRect(0,0,e.DPIHelper.getLogicWidth(T),e.DPIHelper.getLogicHeight(T)),a=d.getBounds(),d.paintBackground(A,a),0,u=a.height,S>0?((l=v-(c=(s=w)+S))>0&&(A.scale(1/I,1/D),A.drawImage(n,s*I,0,l*I,u*D,c*I,0,l*I,u*D),A.scale(I,D)),h=S-i,v-w<=S&&(h=0),s=w,(l=i)>0&&(A.translate(h,0),d.paintTabs(A,new e.Rect(s,0,l,u)),A.translate(-h,0))):S<0&&((l=v-(s=(c=w)+b(S)))>0&&(A.scale(1/I,1/D),A.drawImage(n,s*I,0,l*I,u*D,c*I,0,l*I,u*D),A.scale(I,D)),h=S-i,v-w<=b(S)&&(h=0),s=v-(l=b(i)),l>0&&(A.translate(h,0),d.paintTabs(A,new e.Rect(s,0,l,u)),A.translate(-h,0))),A.scale(1/I,1/D),s=0,l=w,A.drawImage(n,s*I,0,l*I,u*D,s*I,0,l*I,u*D),p=e.ThemeStyleHelper.getCssClassThemeStyle(""),parseInt(p.zIndex)>2007&&(s=v,l=a.x+a.width-d._resizeBarWidth-s,A.drawImage(n,s*I,0,l*I,u*D,s*I,0,l*I,u*D)),s=a.width-d._resizeBarWidth,l=d._resizeBarWidth,A.drawImage(n,s*I,0,l*I,u*D,s*I,0,l*I,u*D),A.scale(I,D),A.restore()}}},t.prototype.doManipulationInertiaStarting=function(e){},t.prototype.doManipulationCompleted=function(e){var t=this._tab;t.resizeTab?(t.resizeTab=!1,t._spread._doTabHSResize()):(t._hideNewTabSecondMoreTab=R,t.repaint())},t.prototype.doTapped=function(e){var t,o=this._tab,n=o._spread,r=n.getActiveSheet();o._tabNameEditor&&o.endSheetTabEditing(r,!1);var i=o.hitTest(e.Position.X,e.Position.Y);n._suspendSetFocus=!0;try{"navButton"===i.element?o.doNavButtonClick(i.index,!0):"tab"===i.element?o.doSheetTabClick(i.index,i.position):"newTab"===i.element&&o.doNewTabClick(i.position)}finally{n._suspendSetFocus=!1,(t=n.getActiveSheet())!==r&&(t._isTouchMode=!0,t.setFocus())}},t.prototype.doDoubleTapped=function(e){return this._tab._doMouseDbClickImp(e.Position.X,e.Position.Y)},t.prototype.doRightTapped=function(e){},t.prototype._getTouchCanvas=function(t,o){var n=this._canvas;return n?(t!==e.DPIHelper.getLogicWidth(n)||o!==e.DPIHelper.getLogicHeight(n))&&e.DPIHelper.setSize(n,t,o):(n=document.createElement("canvas"),e.DPIHelper.adjustDevicePixel(n,this._tab._spread),e.DPIHelper.setSize(n,t,o)),n},t.prototype._getNewFirstTabInfo=function(e,t){var o=this._tab._tabSizes,n=this._minFirstTabIndex,r=this._maxFirstTabIndex,i=t,a=0;if(e>0){for(;i>=n&&!(a>e);)a+=o[i],i--;i<n&&(i=n)}else if(e<0&&-1!==r){for(;i<=r&&!(a<e);)a-=o[i],i++;i>r&&(i=r)}return{firstTab:i,width:a}},t}(),f=function(){function e(e,t,o){var n,r;this._touchMouseMessageFilter=new h(this),this._touchTarget=new _(e,"tabStrip",this._touchMouseMessageFilter,1,-1),this._touchEventProvider=o,this._touchEventHandler=new d(t),n=this._touchEventHandler,(r=this._touchTarget).manipulationStarting=function(e){return n.doManipulationStarting(e)},r.manipulationStarted=function(e){return n.doManipulationStarted(e)},r.manipulationDelta=function(e){return n.doManipulationDelta(e)},r.manipulationInertiaStarting=function(e){return n.doManipulationInertiaStarting(e)},r.manipulationCompleted=function(e){return n.doManipulationCompleted(e)},r.tapped=function(e){return n.doTapped(e)},r.doubleTapped=function(e){return n.doDoubleTapped(e)},r.rightTapped=function(e){return n.doRightTapped(e)}}return e.prototype.bindTouchEvents=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!0)},e.prototype.unbindTouchEvents=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!1)},e.prototype.preProcessMouseDown=function(e){return this._touchMouseMessageFilter.preProcessMouseDown(e)},e.prototype.preProcessMouseUp=function(e){return this._touchMouseMessageFilter.preProcessMouseUp(e)},e.prototype.preProcessMouseMove=function(e){return this._touchMouseMessageFilter.preProcessMouseMove(e)},e}(),e.TabStripTouchManager=f,g=function(){function e(e,t,o){var n,r;this._touchMouseMessageFilter=new h(this),this._touchTarget=new _(e,"FL_"+t.name,this._touchMouseMessageFilter,2,200),this._touchEventProvider=o,this._touchEventHandler=new m(e,t),n=this._touchEventHandler,(r=this._touchTarget).canDoManipulation=function(){return t.floatingObject().isSelected()},r.canDoTap=function(){return!0},r.manipulationStarting=function(e){return n.doManipulationStarting(e)},r.manipulationStarted=function(e){return n.doManipulationStarted(e)},r.manipulationDelta=function(e){return n.doManipulationDelta(e)},r.manipulationInertiaStarting=function(e){return n.doManipulationInertiaStarting(e)},r.manipulationCompleted=function(e){return n.doManipulationCompleted(e)},r.tapped=function(e){return n.doTapped(e)},r.doubleTapped=function(e){return n.doDoubleTapped(e)},r.rightTapped=function(e){return n.doRightTapped(e)}}return e.prototype.attach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!0)},e.prototype.detach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!1)},e.prototype.preProcessMouseDown=function(e){return this._touchMouseMessageFilter.preProcessMouseDown(e)},e.prototype.preProcessMouseUp=function(e){return this._touchMouseMessageFilter.preProcessMouseUp(e)},e.prototype.preProcessMouseMove=function(e){return this._touchMouseMessageFilter.preProcessMouseMove(e)},e}(),e.FloatingObjectTouchManager=g,m=function(){function o(e,t){this._floatingObjectRender=t,this._floatingObject=t.floatingObject(),this._containerElement=e,this._touchZoomManager=new i(t._sheet)}return o.prototype._positionToPage=function(o,n){var r=new t(n.X,n.Y),i=e.GC$(this._containerElement).offset();return i&&(isNaN(document.body.clientTop)||(i.top+=document.body.clientTop),isNaN(document.body.clientLeft)||(i.left+=document.body.clientLeft),r.X+=i.left,r.Y+=i.top),r},o.prototype.doManipulationStarting=function(e){e.Mode=35},o.prototype.doManipulationStarted=function(e){var t=this._positionToPage(e.OriginalSource,e.Position);this._floatingObjectRender._doMouseDown({isTouch:!0,button:0,pageX:t.X,pageY:t.Y,stopPropagation:function(){}}),this._touchZoomManager.startZoom()},o.prototype.doManipulationDelta=function(e){var t,o=e.Cumulative.Scale,n=this._floatingObjectRender._sheet;1!==o&&n.parent&&n.parent._allowUserZoom?(n._eventHandler.isFloatingObjectWorking=!1,this._floatingObjectRender._resetStatusOnMouseUp(),this._touchZoomManager.continueZoom(o)):(t=this._positionToPage(e.OriginalSource,e.Position),this._floatingObjectRender._doMouseMove({isTouch:!0,button:0,pageX:t.X,pageY:t.Y,stopPropagation:function(){}}))},o.prototype.doManipulationInertiaStarting=function(e){},o.prototype.doManipulationCompleted=function(e){var t,o=e.Cumulative.Scale,n=this._floatingObjectRender._sheet;1!==o&&n.parent&&n.parent._allowUserZoom?this._touchZoomManager.endZoom(o):(t=this._positionToPage(e.OriginalSource,e.Position),this._floatingObjectRender._doMouseUp({isTouch:!0,button:0,pageX:t.X,pageY:t.Y,stopPropagation:function(){}}))},o.prototype.doTapped=function(t){try{var o=this._floatingObjectRender._sheet,n=o.isPaintSuspended();o.isPaintSuspended(!0),this._floatingObject.isSelected()||(o.unSelectAllFloatingObjects(),this._floatingObject.isSelected(!0),e.FocusHelper.setActiveElement(o)),o.clearSelection()}finally{o.isPaintSuspended(n)}},o.prototype.doDoubleTapped=function(e){},o.prototype.doRightTapped=function(e){},o}(),_=function(){return function(e,t,o,n,r){this.element=e,this.messageFilter=o,this.eventFlag=t,this.maxPointer=n,this.level=r}}(),e.TouchTargetElement=_,y=function(){function t(){}return t.prototype.simulateMouseEvent=function(t,o){var n,r,i=t;!1!==i.isPrimary&&(i.touches&&i.touches.length>=1&&i.targetTouches&&i.targetTouches.length>=1&&(i.touches[0].clientX!==i.targetTouches[0].clientX||i.touches[0].clientY!==i.targetTouches[0].clientY)||(e.util.cancelDefault(t),n=typeof i.changedTouches!==L?i.changedTouches[0]:i,(r=document.createEvent("MouseEvents")).initMouseEvent(o,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,x),t.target.dispatchEvent(r)))},t.prototype.down=function(e){if(!e.pointerType||e.pointerType===e.MSPOINTER_TYPE_TOUCH||"touch"===e.pointerType){var t=e.data;if(t.touchHandled)return;t.touchHandled=!0,t._touchMoved=!1,t.simulateMouseEvent(e,"mouseover"),t.simulateMouseEvent(e,"mousemove"),t.simulateMouseEvent(e,"mousedown")}},t.prototype.move=function(e){if(!e.pointerType||e.pointerType===e.MSPOINTER_TYPE_TOUCH||"touch"===e.pointerType){var t=e.data;if(!t.touchHandled)return;t._touchMoved=!0,t.simulateMouseEvent(e,"mousemove")}},t.prototype.up=function(e){if(!e.pointerType||e.pointerType===e.MSPOINTER_TYPE_TOUCH||"touch"===e.pointerType){var t=e.data;if(!t.touchHandled)return;t.simulateMouseEvent(e,"mouseup"),t.simulateMouseEvent(e,"mouseout"),t._touchMoved||t.simulateMouseEvent(e,"click"),t.touchHandled=!1}},t.prototype.bindUnBindTouchEvents=function(t,o,n){var r=this;"."!==n.charAt(0)&&(n="."+n);var i="MSPointerDown"+n,a="MSPointerMove"+n,s="MSPointerUp"+n,l="pointerdown"+n,u="pointermove"+n,c="pointerup"+n,h="touchstart"+n,p="touchmove"+n,d="touchend"+n,f=window.navigator.msPointerEnabled||window.navigator.pointerEnabled;o?f?(t.style.msTouchAction!==x&&typeof t.style.msTouchAction!==L&&(t.style.msTouchAction="none"),t.style.touchAction!==x&&typeof t.style.touchAction!==L&&(t.style.touchAction="none"),e.GC$(t).bind(i,r,r.down).bind(l,r,r.down),e.GC$(document).bind(a,r,r.move).bind(u,r,r.move).bind(s,r,r.up).bind(c,r,r.up)):e.GC$(t).bind(h,r,r.down).bind(p,r,r.move).bind(d,r,r.up):f?(e.GC$(t).unbind(i).unbind(l),e.GC$(document).unbind(a).unbind(u).unbind(s).unbind(c)):e.GC$(t).unbind(h).unbind(p).unbind(d)},t}(),e._SimulateMouseEvents=y,C=function(){function e(e,t,o){var n,r,i=this,a=i._comment=t._comment;i._touchMouseMessageFilter=new h(i),i._touchTarget=new _(e,"Comment"+a._rowIndex+a._colIndex,i._touchMouseMessageFilter,2,200),i._touchEventProvider=o,i._touchEventHandler=new w(e,t),n=i._touchEventHandler,(r=i._touchTarget).canDoManipulation=function(){return 3!==i._comment.commentState()},r.canDoTap=function(){return!0},r.manipulationStarting=function(e){return n.doManipulationStarting(e)},r.manipulationStarted=function(e){return n.doManipulationStarted(e)},r.manipulationDelta=function(e){return n.doManipulationDelta(e)},r.manipulationInertiaStarting=function(e){return n.doManipulationInertiaStarting(e)},r.manipulationCompleted=function(e){return n.doManipulationCompleted(e)},r.tapped=function(e){return n.doTapped(e)},r.doubleTapped=function(e){return n.doDoubleTapped(e)},r.rightTapped=function(e){return n.doRightTapped(e)}}return e.prototype.attach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!0)},e.prototype.detach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!1)},e.prototype.preProcessMouseDown=function(e){return this._touchMouseMessageFilter.preProcessMouseDown(e)},e.prototype.preProcessMouseUp=function(e){return this._touchMouseMessageFilter.preProcessMouseUp(e)},e.prototype.preProcessMouseMove=function(e){return this._touchMouseMessageFilter.preProcessMouseMove(e)},e}(),e.CommentTouchManager=C,w=function(){function o(e,t){this._containerElement=e,this._commentView=t,this._comment=t._comment,this._sheet=this._comment._sheet,this._touchZoomManager=new i(this._sheet)}return o.prototype._positionToPage=function(o){var n=new t(o.X,o.Y),r=e.GC$(this._containerElement).offset();return r&&(isNaN(document.body.clientTop)||(r.top+=document.body.clientTop),isNaN(document.body.clientLeft)||(r.left+=document.body.clientLeft),n.X+=r.left,n.Y+=r.top),n},o.prototype.doManipulationStarting=function(e){e.Mode=35},o.prototype.doManipulationStarted=function(e){var t=this._positionToPage(e.Position);this._commentView._doMouseDownToDragOrResize({target:e.OriginalSource,isTouch:!0,button:0,pageX:t.X,pageY:t.Y,stopPropagation:function(){}}),this._touchZoomManager.startZoom()},o.prototype.doManipulationDelta=function(t){var o,n,r=t.Cumulative.Scale,i=this._sheet;1!=r&&i.parent&&i.parent._allowUserZoom?(i._eventHandler.isCommentWorking=!1,o=this._commentView,e.GC$(o._moveResizeContainerDom).remove(),this._touchZoomManager.continueZoom(r)):(n=this._positionToPage(t.Position),this._commentView._doMouseMove({target:t.OriginalSource,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}))},o.prototype.doManipulationInertiaStarting=function(e){},o.prototype.doManipulationCompleted=function(e){var t,o=e.Cumulative.Scale,n=this._sheet;1!==o&&n.parent&&n.parent._allowuserZoom?this._touchZoomManager.endZoom(o):(t=this._positionToPage(e.Position),this._commentView._doMouseUp({target:e.OriginalSource,isTouch:!0,button:0,pageX:t.X,pageY:t.Y,stopPropagation:function(){}}))},o.prototype.doTapped=function(e){var t,o=this._comment,n=this._sheet;try{t=n.isPaintSuspended(),n.isPaintSuspended(!0),3===o.commentState()?o.commentState(1):1===o.commentState()&&o.commentState(2)}finally{n.isPaintSuspended(t)}},o.prototype.doDoubleTapped=function(e){},o.prototype.doRightTapped=function(e){},o}(),v=function(){function e(e,t,o){var n,r,i=this,a=i._comment=t._comment;i._touchMouseMessageFilter=new h(i),i._touchTarget=new _(e,"Comment"+a._rowIndex+a._colIndex,i._touchMouseMessageFilter,2,200),i._touchEventProvider=o,i._touchEventHandler=new S(e,t),n=i._touchEventHandler,(r=i._touchTarget).canDoManipulation=function(){return 3!==i._comment.commentState()},r.canDoTap=function(){return!0},r.manipulationStarting=function(e){return n.doManipulationStarting(e)},r.manipulationStarted=function(e){return n.doManipulationStarted(e)},r.manipulationDelta=function(e){return n.doManipulationDelta(e)},r.manipulationInertiaStarting=function(e){return n.doManipulationInertiaStarting(e)},r.manipulationCompleted=function(e){return n.doManipulationCompleted(e)},r.tapped=function(e){return n.doTapped(e)},r.doubleTapped=function(e){return n.doDoubleTapped(e)},r.rightTapped=function(e){return n.doRightTapped(e)}}return e.prototype.attach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!0)},e.prototype.detach=function(){this._touchEventProvider&&this._touchEventProvider.attachDettach(this._touchTarget,!1)},e.prototype.preProcessMouseDown=function(e){return this._touchMouseMessageFilter.preProcessMouseDown(e)},e.prototype.preProcessMouseUp=function(e){return this._touchMouseMessageFilter.preProcessMouseUp(e)},e.prototype.preProcessMouseMove=function(e){return this._touchMouseMessageFilter.preProcessMouseMove(e)},e}(),e.CommentContentTouchManager=v,S=function(e){function t(t,o){e.call(this,t,o)}return __extends(t,e),t.prototype.doManipulationStarted=function(e){var t=this._positionToPage(e.Position);this._commentView._doMouseDownToEdit({target:e.OriginalSource,isTouch:!0,button:0,pageX:t.X,pageY:t.Y,stopPropagation:function(){}}),this._touchZoomManager.startZoom()},t}(w)}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n,r,i,a,s,l;e.feature("floatingObject",["core.common","core.stringResource","core.sheet_action","core.imageLoader"]);var u,c=null,h=void 0,p=Math.ceil,d=Math.floor,f=Math.max,g=Math.min,m=Math.abs,_="#044062",y=9007199254740992,C="position",w="absolute",v="100%",S="background",x="floatingobject-selected",R="floatingobject-unselected",b="floatingobject-resize-indicator-select",T="floatingobject-resize-indicator-unSelect",A="no-user-select",I="floatingobject-content-container",D="floatingobject-background-cover",F=".floatingobject-resize-indicator",M="div.floatingobject-resize-indicator.floatingobject-top.floatingobject-left",E="div.floatingobject-resize-indicator.floatingobject-middle.floatingobject-left",N="div.floatingobject-resize-indicator.floatingobject-bottom.floatingobject-left",O="div.floatingobject-resize-indicator.floatingobject-top.floatingobject-center",P="div.floatingobject-resize-indicator.floatingobject-bottom.floatingobject-center",L="div.floatingobject-resize-indicator.floatingobject-top.floatingobject-right",H="div.floatingobject-resize-indicator.floatingobject-middle.floatingobject-right",k="div.floatingobject-resize-indicator.floatingobject-bottom.floatingobject-right",V=".gcFloatingObject";(u=e.FloatingObjectType||(e.FloatingObjectType={}))[u.CustomFloatingObject=0]="CustomFloatingObject",u[u.Picture=1]="Picture",e.FloatingObjectType,t=function(t){function o(e){t.call(this),this._floatingObjectType=c;this._sheet=e,this._bindEventsOnSheet()}return __extends(o,t),o.prototype.ownerSheet=function(e){return 0===arguments.length?this._sheet:(this._sheet=e,this)},o.prototype.find=function(e){var t=this._findItemIndex(e);return t>=0?this[t]:c},o.prototype.replace=function(t,o){if(o===c||o===h)throw new Error(e.SR.Exp_ValueIsNull);var n=this._findItemIndex(t);n>=0&&this.splice(n,1,o)},o.prototype.add=function(t){var o=t.name();if(o===c||o===h)throw new Error(e.SR.Exp_FloatingObjectNameEmptyError);this._checkObjectExists(o),t.owner(this._sheet),this.push(t)},o.prototype.remove=function(e){if(e!==c&&e!==h){var t=this._findItemIndex(e.name());return t>=0&&e.owner(c),this.splice(t,1),!0}return!1},o.prototype.addRows=function(e,t){for(var o=0,n=this.length;o<n;o++)this[o].addRows(e,t)},o.prototype.removeRows=function(e,t){for(var o,n=[],r=0,i=this.length;r<i;r++)o=this[r],this._isCoverRange(e,-1,e+t-1,this._sheet.getColumnCount(),o)&&(o.dynamicMove()||o.dynamicSize())?n.push(o):o.removeRows(e,t);for(r=0,i=n.length;r<i;r++)this.remove(n[r])},o.prototype.addColumns=function(e,t){for(var o=0,n=this.length;o<n;o++)this[o].addColumns(e,t)},o.prototype.removeColumns=function(e,t){for(var o,n=[],r=0,i=this.length;r<i;r++)o=this[r],this._isCoverRange(-1,e,this._sheet.getRowCount(),e+t-1,o)&&(o.dynamicMove()||o.dynamicSize())?n.push(o):o.removeColumns(e,t);for(r=0,i=n.length;r<i;r++)this.remove(n[r])},o.prototype._isCoverRange=function(e,t,o,n,r){var i=r.startRow(),a=r.startColumn(),s=r.endRow(),l=r.endColumn();return e<=i&&t<=a&&o>=s&&n>=l},o.prototype._checkObjectExists=function(t){if(this._sheet._findFloatingObjectInternal(t))throw new Error(e.SR.Exp_FloatingObjectHasSameNameError)},o.prototype._findItemIndex=function(e){for(var t=this.length,o=0;o<t;o++)if(this[o].name()===e)return o;return-1},o.prototype._updateFloatingsObjectlayoutOnColumnRowChanged=function(){for(var e,t=0,o=this.length;t<o;t++)(e=this[t]).dynamicMove()?e._updateFloatingObjectLocation():e._updateStartPosition(),e.dynamicSize()?e._updateFloatingObjectSize():e._updateEndPosition()},o.prototype._bindEventsOnSheet=function(){var t=this,o=t._sheet;o&&(e.GC$(window.document.body).bind("scroll"+V,function(){var e=o.parent.getActiveSheet(),t=e._render,n=e._floatingObjectArray;n&&n.length>0&&t&&t._paintFloatingObject(e.getBounds())}),o._bind(e.Events.ColumnChanged+V,function(e,o){var n=o.propertyName;("width"===n||"isVisible"===n)&&t._updateFloatingObjectsLayout()}),o._bind(e.Events.RowChanged+V,function(e,o){var n=o.propertyName;("height"===n||"isVisible"===n)&&t._updateFloatingObjectsLayout()}),o._bind(e.Events.ColumnWidthChanged+V,function(e,o){t._updateFloatingObjectsLayout()}),o._bind(e.Events.RowHeightChanged+V,function(e,o){t._updateFloatingObjectsLayout()}))},o.prototype.dispose=function(){e.GC$(window.document.body).unbind("scroll"+V);var t=this._sheet;t&&(t._unbind(e.Events.ColumnChanged+V),t._unbind(e.Events.RowChanged+V),t._unbind(e.Events.ColumnWidthChanged+V),t._unbind(e.Events.RowHeightChanged+V))},o.prototype._updateFloatingObjectsLayout=function(){var e=this._sheet,t=e._render;this.length>0&&(this.isNeedToUpdateLayout=!0,t&&t._paintFloatingObject(e.getBounds()))},o.prototype.toJSON=function(){var e,t;if(!this||0===this.length)return h;for(e=[],t=0;t<this.length;t++)"FloatingObject"===this[t].typeName&&e.push(this[t].toJSON());return 0===e.length?h:e},o.prototype.fromJSON=function(e,t){var o,n,r,i;if(e&&0!==e.length)for(o=0;o<e.length;o++)n=e[o],r=c,n&&((i=this._getFloatingObjectTypes()[n.floatingObjectType])&&((r=new i).owner(this._sheet),r.fromJSON(n,t),this.push(r)))},o.prototype._getFloatingObjectTypes=function(){if(!this._floatingObjectType){var e={};e[0]=n,e[1]=r,this._floatingObjectType=e}return this._floatingObjectType},o}(e._XArray),e._FloatingObjectArray=t,o=function(){function t(t,o,n,r,i){this._cacheOffset={startRowOffset:h,startColumnOffset:h,endRowOffset:h,endColumnOffset:h},this._isFOColumnsOrRowsVisible=!0;var a=this;a.typeName="FloatingObject",a._name=t,a._location=new e.Rect("number"==typeof o?o:0,"number"==typeof n?n:0,"number"==typeof r?r:0,"number"==typeof i?i:0),a._canPrint=!0,a._isLocked=!0,a._isVisible=!0,a._isSelected=!1,a._dynamicMove=!0,a._dynamicSize=!0,a._fixedPosition=!1,a._allowMove=!0,a._allowResize=!0}return t.prototype.name=function(t){if(0===arguments.length)return this._name;if("string"!=typeof t||""===t)throw new Error(e.SR.Exp_FloatingObjectNameEmptyError);return this._name!==t&&(this._name=t,this.onPropertyChanged("name",t)),this},t.prototype.owner=function(e){return 0===arguments.length?this._sheet:(this._sheet=e,this._updateFloatingObjectCoorinates(),this)},t.prototype.isSelected=function(e){var t=this,o=t._sheet;return 0===arguments.length?t._isSelected:("boolean"==typeof e&&t._isSelected!==e&&(o?o._bindToAutoRefresh(function(e){t._isSelected=e})(e):t._isSelected=e,t.onPropertyChanged("isSelected",e)),t)},t.prototype.isLocked=function(e){return 0===arguments.length?this._isLocked:("boolean"==typeof e&&this._isLocked!==e&&(this._isLocked=e,this.onPropertyChanged("isLocked",e)),this)},t.prototype.canPrint=function(e){return 0===arguments.length?this._canPrint:("boolean"==typeof e&&this._canPrint!==e&&(this._canPrint=e,this.onPropertyChanged("canPrint",e)),this)},t.prototype.isVisible=function(e){var t=this,o=t._sheet;return 0===arguments.length?t._isVisible:("boolean"==typeof e&&t._isVisible!==e&&(o?o._bindToAutoRefresh(function(e){t._isVisible=e})(e):t._isVisible=e,t.onPropertyChanged("visible",e)),t)},t.prototype.position=function(t){var o=this,n=o._sheet;return 0===arguments.length?new e.Point(o._location.x,o._location.y):(t instanceof e.Point&&(o._location.x!==t.x||o._location.y!==t.y)&&(n?n._bindToAutoRefresh(function(e){o._location.x=e.x,o._location.y=e.y,o._adjustPosition(),o._updateCoverRange()})(t):(o._location.x=t.x,o._location.y=t.y),o.onPropertyChanged("position",t)),o)},t.prototype.height=function(e){var t=this,o=t._sheet;return 0===arguments.length?t._location.height:("number"==typeof e&&t._location.height!==e&&(o?o._bindToAutoRefresh(function(e){t._location.height=e,t._adjustSize(),t._adjustPosition(),t._updateCoverRange()})(e):t._location.height=e,t.onPropertyChanged("height",e)),t)},t.prototype.width=function(e){var t=this,o=t._sheet;return 0===arguments.length?t._location.width:("number"==typeof e&&t._location.width!==e&&(o?o._bindToAutoRefresh(function(e){t._location.width=e,t._adjustSize(),t._adjustPosition(),t._updateCoverRange()})(e):t._location.width=e,t.onPropertyChanged("width",e)),t)},t.prototype.startRow=function(e){var t=this;return 0===arguments.length?t._startRow:("number"==typeof e&&t._startRow!==e&&(e=p(e),t._sheet?t._sheet._bindToAutoRefresh(function(e){t._startRow=e,t._updateFloatingObjectLocation()})(e):t._startRow=e),t)},t.prototype.startRowOffset=function(e){var t=this;return 0===arguments.length?t._startRowOffset:("number"==typeof e&&t._startRowOffset!==e&&(t._sheet?t._sheet._bindToAutoRefresh(function(e){t._startRowOffset=e,t._updateFloatingObjectLocation()})(e):t._startRowOffset=e),t)},t.prototype.startColumn=function(e){var t=this;return 0===arguments.length?t._startColumn:("number"==typeof e&&t._startColumn!==e&&(e=p(e),t._sheet?t._sheet._bindToAutoRefresh(function(e){t._startColumn=e,t._updateFloatingObjectLocation()})(e):t._startColumn=e),t)},t.prototype.startColumnOffset=function(e){var t=this;return 0===arguments.length?t._startColumnOffset:("number"==typeof e&&t._startColumnOffset!==e&&(t._sheet?t._sheet._bindToAutoRefresh(function(e){t._startColumnOffset=e,t._updateFloatingObjectLocation()})(e):t._startColumnOffset=e),t)},t.prototype.endRow=function(e){var t=this;return 0===arguments.length?t._endRow:("number"==typeof e&&t._endRow!==e&&(t._sheet?t._sheet._bindToAutoRefresh(function(e){t._endRow=e,t._updateFloatingObjectSize()})(e):t._endRow=e),t)},t.prototype.endRowOffset=function(e){var t=this;return 0===arguments.length?t._endRowOffset:("number"==typeof e&&t._endRowOffset!==e&&(t._sheet?t._sheet._bindToAutoRefresh(function(e){t._endRowOffset=e,t._updateFloatingObjectSize()})(e):t._endRowOffset=e),t)},t.prototype.endColumn=function(e){var t=this;return 0===arguments.length?t._endColumn:("number"==typeof e&&t._endColumn!==e&&(e=p(e),t._sheet?t._sheet._bindToAutoRefresh(function(e){t._endColumn=e,t._updateFloatingObjectSize()})(e):t._endColumn=e),t)},t.prototype.endColumnOffset=function(e){var t=this;return 0===arguments.length?t._endColumnOffset:("number"==typeof e&&t._endColumnOffset!==e&&(t._sheet?t._sheet._bindToAutoRefresh(function(e){t._endColumnOffset=e,t._updateFloatingObjectSize()})(e):t._endColumnOffset=e),t)},t.prototype.dynamicMove=function(e){return 0===arguments.length?this._dynamicMove:("boolean"!=typeof e||this._dynamicMove===e||this._fixedPosition||(this._dynamicMove=e,e||(this._dynamicSize=!1),this.onPropertyChanged("dynamicMove",e)),this)},t.prototype.dynamicSize=function(e){return 0===arguments.length?this._dynamicSize:("boolean"!=typeof e||this._dynamicSize===e||this._fixedPosition||(e&&!this._dynamicMove&&(e=!1),this._dynamicSize=e,this.onPropertyChanged("dynamicSize",e)),this)},t.prototype.fixedPosition=function(e){return 0===arguments.length?this._fixedPosition:("boolean"==typeof e&&this._fixedPosition!==e&&(this._fixedPosition=e,e&&(this._dynamicMove=!1,this._dynamicSize=!1),this.onPropertyChanged("fixedPosition",e)),this)},t.prototype.allowResize=function(e){var t=this,o=t._sheet;if(0===arguments.length)return t._allowResize;e!==t._allowResize&&(o?o._bindToAutoRefresh(function(e){t._allowResize=e})(e):t._allowResize=e)},t.prototype.allowMove=function(e){var t=this,o=t._sheet;if(0===arguments.length)return t._allowMove;e!==t._allowMove&&(o?o._bindToAutoRefresh(function(e){t._allowMove=e})(e):t._allowMove=e)},t.prototype.onPropertyChanged=function(e,t){var o=this._sheet;this._trigger({sheet:o,sheetName:o?o._name:"",floatingObject:this,propertyName:e})},t.prototype.addRows=function(e,t){var o=this;e=p(e),t=p(t),e<=o.startRow()?o.dynamicMove()&&(o.startRow(o.startRow()+t),o.endRow(o.endRow()+t)):e>o.startRow()&&e<o.endRow()&&o.dynamicSize()&&o.endRow(o.endRow()+t)},t.prototype.removeRows=function(e,t){var o,n,r=this,i=e+t-1;e<=r.startRow()?i<r.startRow()?r.dynamicMove()&&(r.startRow(r.startRow()-t),r.endRow(r.endRow()-t)):i<r.endRow()&&(o=i-r.startRow()+1,n=r.endRow()-r.startRow()+1-o,r.dynamicMove()&&(r.startRow(e),r.startRowOffset(0)),r.dynamicSize()&&r.endRow(e+n-1)):e<=r.endRow()&&(i<r.endRow()?r.dynamicSize()&&r.endRow(r.endRow()-t):r.dynamicSize()&&(r.endRow(e),r.endRowOffset(0)))},t.prototype.addColumns=function(e,t){var o=this;e=p(e),t=p(t),e<=o.startColumn()?o.dynamicMove()&&(o.startColumn(o.startColumn()+t),o.endColumn(o.endColumn()+t)):e>o.startColumn()&&e<o.endColumn()&&o.dynamicSize()&&o.endColumn(o.endColumn()+t)},t.prototype.removeColumns=function(e,t){var o,n,r,i=this;o=(e=p(e))+(t=p(t))-1,e<=i.startColumn()?o<i.startColumn()?i.dynamicMove()&&(i.startColumn(i.startColumn()-t),i.endColumn(i.endColumn()-t)):o<i.endColumn()&&(n=o-i.startColumn()+1,r=i.endColumn()-i.startColumn()+1-n,i.dynamicMove()&&(i.startColumn(e),i.startColumnOffset(0)),i.dynamicSize()&&i.endColumn(e+r-1)):e<=i.endColumn()&&(o<i.endColumn()?i.dynamicSize()&&i.endColumn(i.endColumn()-t):i.dynamicSize()&&(i.endColumn(e),i.endColumnOffset(0)))},t.prototype._isDefaultValue=function(e,t){switch(e){case"x":case"y":case"width":case"height":return 0===t;case"canPrint":return!0===t;case"isSelected":return!1===t;case"isLocked":return 1==t;case"isVisible":case"dynamicMove":case"dynamicSize":return!0===t;case"fixedPosition":return!1===t;case"allowMove":case"allowResize":return!0===t;default:return!1}},t.prototype.toJSON=function(){var e,t,o=this,n={name:o._name,x:o._location.x,y:o._location.y,width:o._location.width,height:o._location.height,canPrint:o._canPrint,isSelected:o._isSelected,isLocked:o._isLocked,isVisible:o._isVisible,dynamicMove:o._dynamicMove,dynamicSize:o._dynamicSize,fixedPosition:o._fixedPosition,allowMove:o._allowMove,allowResize:o._allowResize},r={};for(e in n)t=n[e],o._isDefaultValue(e,t)||(r[e]=t);return r},t.prototype.fromJSON=function(t,o){var n;if(t){(n=this)._name=t.name;var r=t.x!==h?t.x:0,i=t.y!==h?t.y:0,a=t.width!==h?t.width:0,s=t.height!==h?t.height:0;n._location=new e.Rect(r,i,a,s),t.canPrint!==h&&(n._canPrint=t.canPrint),t.isSelected!==h&&(n._isSelected=t.isSelected),t.isLocked!==h&&(n._isLocked=t.isLocked),t.isVisible!==h&&(n._isVisible=t.isVisible),t.dynamicMove!==h&&(n._dynamicMove=t.dynamicMove),t.dynamicSize!==h&&(n._dynamicSize=t.dynamicSize),t.fixedPosition!==h&&(n._fixedPosition=t.fixedPosition),t.allowMove!==h&&(n._allowMove=t.allowMove),t.allowResize!==h&&(n._allowResize=t.allowResize),n._updateCoverRange()}},t.prototype.clone=function(){var e=new t,o=JSON.stringify(this.toJSON());return e.fromJSON(JSON.parse(o)),e},t.prototype._adjustSize=function(){var e=this._getSheetHeight(this._location.height),t=this._getSheetWidth(this._location.width);this._location.width>t&&(this._location.width=t),this._location.height>e&&(this._location.height=e)},t.prototype._adjustPosition=function(){var e,t,o=this,n=o._location.x+o._location.width,r=o._getSheetWidth(n);n>r&&(o._location.x=r-o._location.width),o._location.x<0&&(o._location.x=0),(e=o._location.y+o._location.height)>(t=o._getSheetHeight(e))&&(o._location.y=t-o._location.height),o._location.y<0&&(o._location.y=0)},t.prototype._updateFloatingObjectCoorinates=function(){var e=this;e._adjustSize(),e._adjustPosition(),e._startRow!==c&&e._startRow!==h&&e._startColumn!==c&&e._startColumn!==h?(e._startRowOffset||(e._startRowOffset=0),e._startColumnOffset||(e._startColumnOffset=0),e._updateFloatingObjectLocation()):e._updateStartPosition(),e._endColumn!==c&&e._endColumn!==h&&e._endRow!==c&&e._endRow!==h?(e._endRowOffset||(e._endRowOffset=0),e._endColumnOffset||(e._endColumnOffset=0),e._updateFloatingObjectSize()):e._updateEndPosition()},t.prototype._getSheetHeight=function(e){var t,o,n,r=this._sheet;if(r===c||r===h)return y;for(t=0,o=r.getRowCount(),n=0;n<o&&!((t+=r.getRowHeight(n,3))>e);n++);return t},t.prototype._getSheetWidth=function(e){var t,o,n,r=this._sheet;if(r===c||r===h)return y;for(t=0,o=r.getColumnCount(),n=0;n<o&&!((t+=r.getColumnWidth(n,3))>e);n++);return t},t.prototype._updateStartRowOffset=function(){var e=this._startRowOffset,t=this._sheet.getRowHeight(this.startRow(),3),o=this._cacheOffset;t>0&&t--,e>t?(o.startRowOffset||(o.startRowOffset=e),this._startRowOffset=t):o.startRowOffset&&(o.startRowOffset<t?(this._startRowOffset=o.startRowOffset,o.startRowOffset=h):t<o.startRowOffset&&(this._startRowOffset=t))},t.prototype._updateStartColumnOffset=function(){var e=this._startColumnOffset,t=this._sheet.getColumnWidth(this.startColumn(),3),o=this._cacheOffset;t>0&&t--,e>t?(o.startColumnOffset||(o.startColumnOffset=e),this._startColumnOffset=t):o.startColumnOffset&&(o.startColumnOffset<t?(this._startColumnOffset=o.startColumnOffset,o.startColumnOffset=h):e<o.startColumnOffset&&(this._startColumnOffset=t))},t.prototype._updateEndRowOffset=function(){var e=this._endRowOffset,t=this._sheet.getRowHeight(this.endRow(),3),o=this._cacheOffset;t>0&&t--,e>t?(o.endRowOffset||(o.endRowOffset=e),this._endRowOffset=t):o.endRowOffset&&(o.endRowOffset<t?(this._endRowOffset=o.endRowOffset,o.endRowOffset=h):e<o.endRowOffset&&(this._endRowOffset=t))},t.prototype._updateEndColumnOffset=function(){var e=this._endColumnOffset,t=this._sheet.getColumnWidth(this.endColumn(),3),o=this._cacheOffset;t>0&&t--,e>t?(o.endColumnOffset||(o.endColumnOffset=e),this._endColumnOffset=t):o.endColumnOffset&&(o.endColumnOffset<t?(this._endColumnOffset=o.endColumnOffset,o.endColumnOffset=h):e<o.endColumnOffset&&(this._endColumnOffset=t))},t.prototype._updateFloatingObjectLocation=function(){var t,o,n,r,i,a,s=this,l=s._sheet;if(l!==c&&l!==h){for(t=0,o=s.startRow(),n=0;n<o;n++)t+=l.getRowHeight(n,3);for(s._updateStartRowOffset(),t+=s._startRowOffset,r=0,i=s.startColumn(),a=0;a<i;a++)r+=l.getColumnWidth(a,3);s._updateStartColumnOffset(),r+=s._startColumnOffset,(s._location.x!==r||s._location.y!==t)&&(s._location.x=r,s._location.y=t,s.onPropertyChanged("location",new e.Rect(r,t,s._location.width,s._location.height)))}},t.prototype._updateFloatingObjectSize=function(){var e,t,o=this,n=o._sheet;if(n!==c&&n!==h){!1===o._isFOColumnsOrRowsVisible&&(o._isVisible=!0,o._isFOColumnsOrRowsVisible=!0);var r=0,i=o.startRow(),a=o.endRow();for(e=i;e<a;e++)r+=n.getRowHeight(e,3);0===r+n.getRowHeight(a,3)&&!0===o._isVisible&&(o._isVisible=!1,o._isFOColumnsOrRowsVisible=!1),i===a?(o._updateEndRowOffset(),r=o.endRowOffset()-o.startRowOffset()):(n.getRowHeight(i,3)>0&&(r-=o._startRowOffset),o._updateEndRowOffset(),r+=o._endRowOffset);var s=0,l=o.startColumn(),u=o.endColumn();for(t=l;t<u;t++)s+=n.getColumnWidth(t,3);0===s+n.getColumnWidth(u,3)&&!0===o._isVisible&&(o._isVisible=!1,o._isFOColumnsOrRowsVisible=!1),l===u?(o._updateEndColumnOffset(),s=o.endColumnOffset()-o.startColumnOffset()):(n.getColumnWidth(l,3)>0&&(s-=o._startColumnOffset),o._updateEndColumnOffset(),s+=o._endColumnOffset),s<0&&(s=0),r<0&&(r=0),o._location.width!==s&&(o._location.width=s,o.onPropertyChanged("width",s)),o._location.height!==r&&(o._location.height=r,o.onPropertyChanged("height",r))}},t.prototype._updateStartPosition=function(){var e,t,o,n,r=this,i=r._sheet;i!==c&&i!==h&&(e=r._calcAnchorRow(r._location.y),r._startRow=e.row,r._startRowOffset=e.offsetY,-1===r._startRowOffset&&(r._startRow+=1,r._startRowOffset=0,t=i.getRowCount(),r._startRow===t&&(r._startRow=t-1)),o=r._calcAnchorColumn(r._location.x),r._startColumn=o.column,r._startColumnOffset=o.offsetX,-1===r._startColumnOffset&&(r._startColumn+=1,r._startColumnOffset=0,n=i.getColumnCount(),r._startColumn===n&&(r._startColumn=n-1)))},t.prototype._updateEndPosition=function(){var e,t,o=this;o._sheet!==c&&o._sheet!==h&&(e=o._calcAnchorRow(o._location.y+o._location.height),o._endRow=e.row,o._endRowOffset=e.offsetY,t=o._calcAnchorColumn(o._location.x+o._location.width),o._endColumn=t.column,o._endColumnOffset=t.offsetX)},t.prototype._updateCoverRange=function(){this._updateStartPosition(),this._updateEndPosition()},t.prototype._calcAnchorRow=function(e){for(var t,o,n=0,r=this._sheet.getRowCount(),i=0;i<r;i++){if((o=(n+=t=this._sheet.getRowHeight(i,3))-e)>0)return{row:i,offsetY:o>0?t-o:-1};if(0===o)return 0,{row:i+1,offsetY:0}}return{row:r-1,offsetY:0}},t.prototype._calcAnchorColumn=function(e){for(var t,o,n=0,r=this._sheet.getColumnCount(),i=0;i<r;i++){if((o=(n+=t=this._sheet.getColumnWidth(i,3))-e)>0)return{column:i,offsetX:o>0?t-o:-1};if(0===o)return 0,{column:i+1,offsetX:0}}return{column:r-1,offsetX:0}},t.prototype._trigger=function(e){if(this._sheet&&(this._sheet.triggerFloatingObjectChanged(e),"isSelected"===e.propertyName)){var t={sheet:e.sheet,sheetName:e.sheetName,floatingObject:e.floatingObject};this._sheet.triggerFloatingObjectSelectionChanged(t)}},t.prototype._createContentContainer=function(){var t=document.createElement("div");return e.GC$(t).addClass(I).addClass(A).attr("unselectable","on").css(C,w).css(S,_),t},t}(),e.FloatingObject=o,n=function(t){function o(e,o,n,r,i){t.call(this,e,o,n,r,i),this._content=c,this._needRefresh=!1}return __extends(o,t),o.prototype.Content=function(e){var t=this;if(0===arguments.length)return t._content;t.owner()?t.owner()._bindToAutoRefresh(function(e){t._content=e,t._needRefresh=!0})(e):t._content=e,t.onPropertyChanged("content",e)},o.prototype.onPropertyChanged=function(e,t){var o=this.owner();this._trigger({sheet:o,sheetName:o?o._name:"",floatingObject:this,customFloatingObject:this,propertyName:e})},o.prototype.toJSON=function(){var o,n=t.prototype.toJSON.call(this);return n.floatingObjectType=0,o=e.GC$(document.createElement("div")).append(this.cloneContent()).html(),n.content=o,n},o.prototype.fromJSON=function(o,n){if(o&&(t.prototype.fromJSON.call(this,o,n),o.content)){var r=document.createElement("div");r.innerHTML=o.content,this._content=e.GC$(r.firstChild).getElement(0)}},o.prototype.clone=function(e){var t=new o,n=JSON.stringify(this.toJSON());return t.fromJSON(JSON.parse(n)),t._content=this.cloneContent(),t},o.prototype.cloneContent=function(){var t,o,n=this._content;return n?(n.cloneNode?t=n.cloneNode(!0):((o=document.createElement("div")).innerHTML=n.outerHTML,t=o.firstChild),e.GC$(t).removeAttr("id").getElement(0)):c},o.prototype._createContentContainer=function(){var t=document.createElement("div"),o=e.GC$(t).addClass(I).addClass(A).attr("unselectable","on").css(C,w),n=this.cloneContent(),r=v,i=v,a="",s="";return n&&n.style&&(a=n.style.width,s=n.style.height),""!==a&&(r=a),""!==s&&(i=s),n!==c?e.GC$(n).css({width:r,height:i}).addClass(D).addClass(A).attr("unselectable","on").appendTo(t):o.css(S,_),t},o.prototype.refreshContent=function(t){var o;if(this._needRefresh&&t){(o=e.GC$(t)).empty();var n=this.cloneContent(),r=v,i=v,a="",s="";n&&n.style&&(a=n.style.width,s=n.style.height),""!==a&&(r=a),""!==s&&(i=s),n!==c?(e.GC$(n).css({width:r,height:i}).addClass(D).addClass(A).attr("unselectable","on").appendTo(t),o.css(S,"")):o.css(S,_),this._needRefresh=!1}},o}(o),e.CustomFloatingObject=n,r=function(t){function o(e,o,n,r,i,a){t.call(this,e,n,r,i,a);var s=this;s._pictureStretch=0,s._borderWidth=1,s._borderStyle="none",s._borderColor=c,s._borderRadius=-1,s._backColor=c,s._imageLoader=c,s._isImageLoaded=!1,s._isTakeOriginalSize=!1,"string"==typeof o&&s.src(o)}return __extends(o,t),o.prototype._trigger=function(e){if(this.owner()&&(e&&e.floatingObject&&(e.picture=e.floatingObject,delete e.floatingObject),this.owner().triggerPictureChanged(e),"isSelected"===e.propertyName)){var t={sheet:e.sheet,sheetName:e.sheetName,picture:e.picture};this.owner().triggerPictureSelectionChanged(t)}},o.prototype.backColor=function(e){var t,o=this;return 0===arguments.length?o._backColor:("string"==typeof e&&o._backColor!==e&&((t=o.owner())?t._bindToAutoRefresh(function(e){o._backColor=e})(e):o._backColor=e,o.onPropertyChanged("backColor",e)),o)},o.prototype.borderRadius=function(e){var t,o=this;return 0===arguments.length?o._borderRadius:("number"!=typeof e||isNaN(e)||o._borderRadius===e||((t=o.owner())?t._bindToAutoRefresh(function(e){o._borderRadius=e})(e):o._borderRadius=e,o.onPropertyChanged("borderRadius",e)),o)},o.prototype.borderWidth=function(e){var t,o=this;return 0===arguments.length?o._borderWidth:("number"!=typeof e||isNaN(e)||o._borderWidth===e||((t=o.owner())?t._bindToAutoRefresh(function(e){o._borderWidth=e})(e):o._borderWidth=e,o.onPropertyChanged("borderWidth",e)),o)},o.prototype.borderStyle=function(e){var t,o=this;return 0===arguments.length?o._borderStyle:("string"==typeof e&&o._borderStyle!==e&&((t=o.owner())?t._bindToAutoRefresh(function(e){o._borderStyle=e})(e):o._borderStyle=e,o._isBorderStyleWork(e)||(o._borderWidth=0),o.onPropertyChanged("borderStyle",e)),o)},o.prototype.borderColor=function(e){var t,o=this;return 0===arguments.length?o._borderColor:("string"==typeof e&&o._borderColor!==e&&((t=o.owner())?t._bindToAutoRefresh(function(e){o._borderColor=e})(e):o._borderColor=e,o.onPropertyChanged("borderColor",e)),o)},o.prototype.pictureStretch=function(t){var o,n=this;return 0===arguments.length?n._pictureStretch:(n._pictureStretch!==t&&e.ImageLayout[t]!==h&&((o=n.owner())?o._bindToAutoRefresh(function(e){n._pictureStretch=e})(t):n._pictureStretch=t,n.onPropertyChanged("pictureStretch",t)),n)},o.prototype.getOriginalWidth=function(){return this._originalWidth},o.prototype.getOriginalHeight=function(){return this._originalHeight},o.prototype.src=function(e){var t,o=this;return 0===arguments.length?o._src:("string"==typeof e&&o._src!==e&&((t=o.owner())?t._bindToAutoRefresh(function(e){o._src=e})(e):o._src=e,o.onPropertyChanged("src",e),o._isImageLoaded=!1,o._loadImage()),o)},o.prototype.onPropertyChanged=function(e,t){var o=this.owner();this._trigger({sheet:o,sheetName:o?o._name:"",floatingObject:this,picture:this,propertyName:e})},o.prototype._isDefaultValue=function(e,o){switch(e){case"backColor":return o===c;case"borderRadius":return-1===o;case"borderWidth":return 1===o;case"borderStyle":return"none"===o;case"borderColor":return o===c;case"pictureStretch":return 0===o}return t.prototype._isDefaultValue.call(this,e,o)},o.prototype.toJSON=function(){var o,n,r,i=t.prototype.toJSON.call(this);for(n in i.src=this._src,i.floatingObjectType=1,i.backColor=this._backColor,i.borderRadius=this._borderRadius,i.borderWidth=this._borderWidth,i.borderStyle=this._borderStyle,i.borderColor=this._borderColor,i.pictureStretch=this._pictureStretch,o={},i)r=i[n],this._isDefaultValue(n,r)||(o[n]=r);return e.GC$.isEmptyObject(o)?h:o},o.prototype.fromJSON=function(e,o){if(e){t.prototype.fromJSON.call(this,e,o),e.src&&(this._src=e.src,this._isImageLoaded=!1,this._loadImage(),e.backColor!==h&&(this._backColor=e.backColor),e.borderRadius!==h&&(this._borderRadius=e.borderRadius),e.borderWidth!==h&&(this._borderWidth=e.borderWidth),e.borderStyle!==h&&(this._borderStyle=e.borderStyle),e.borderColor!==h&&(this._borderColor=e.borderColor),e.pictureStretch!==h&&(this._pictureStretch=e.pictureStretch))}},o.prototype.clone=function(){var e=new o,t=JSON.stringify(this.toJSON());return e.fromJSON(JSON.parse(t)),e},o.prototype._isBorderStyleWork=function(e){switch(e){case"dotted":case"dashed":case"solid":case"double":case"groove":case"ridge":case"inset":case"outset":return!0;default:return!1}},o.prototype._loadImage=function(){var t,o,n=this,r=n._src;n._imageLoader||(n._imageLoader=new e._GcImageLoader(function(){n._loadImage()}));try{n._imageLoader.getState(r)?(n._isImageLoaded=!0,t=n._imageLoader.getImage(r),n._originalWidth=t.width,n._originalHeight=t.height,n._isTakeOriginalSize&&(n.width(n._originalWidth),n.height(n._originalHeight),n._isTakeOriginalSize=!1),(o=n.owner())&&o.repaint()):n._imageLoader.addImage(r)}catch(e){}},o.prototype._createContentContainer=function(){var t=document.createElement("div");e.GC$(t).addClass(I).addClass(A).attr("unselectable","on").css(C,w);return t},o}(o),e.Picture=r,i=function(){function t(e,t){this._srcCache="";this._floatingObject=e,this.name=this._floatingObject.name(),this._sheet=t,this._isMouseCapture=!1,this._isResizeIndicatorDisplayed=!1}return t.prototype.floatingObject=function(){return this._floatingObject},t.prototype.render=function(t,o){var r,i,a,s,l,u,c=this,h=!1;c._rect=t,c._floatingObjectContainerDiv||(c._floatingObjectContainerDiv=c._createFloatingObjectContainer(c._floatingObject.name()),(r=c._sheet.parent)&&(c._containerDiv=r._getContainerDiv(),c._containerDiv&&e.GC$(c._containerDiv).append(c._floatingObjectContainerDiv))),c._floatingObjectContentDiv||(c._floatingObjectContentDiv=c._floatingObject._createContentContainer(),"function"==typeof c._floatingObject.borderWidth?(c._borderDiv=document.createElement("div"),e.GC$(c._borderDiv).addClass(A+" "+I).attr("unselectable","on"),c._floatingObjectContainerDiv.appendChild(c._borderDiv),c._borderDiv.appendChild(c._floatingObjectContentDiv)):(c._floatingObjectContainerDiv.appendChild(c._floatingObjectContentDiv),h=!0)),c._borderDiv&&(c._applyBorderStyle(o,t),o.x=0,o.y=0),i=e.GC$(c._floatingObjectContainerDiv),a=e.GC$(c._floatingObjectContentDiv),i.css({top:t.y,left:t.x,width:t.width,height:t.height}),a.css({top:o.y,left:o.x,width:o.width,height:o.height}),c._floatingObject instanceof n&&c._floatingObject.refreshContent(c._floatingObjectContentDiv),c._borderDiv&&c._paintImage(),s=i.getElement(0),c._floatingObject.isSelected()?(a.removeClass(R).addClass(x),c._floatingObject.allowResize()?c._showResizeIndicator(s):c._isResizeIndicatorDisplayed&&c._hideResizeIndicator(s)):(a.removeClass(x).addClass(R),c._hideResizeIndicator(s)),h&&(l=c._sheet,u=c._floatingObjectContentDiv.firstChild,l.triggerCustomFloatingObjectLoaded({sheet:l,sheetName:l._name,customFloatingObject:c._floatingObject,element:u}))},t.prototype.setFloatingObjectZIndex=function(t){e.GC$(this._floatingObjectContainerDiv).css("z-index",t)},t.prototype.getFloatingObjectZIndex=function(){var t,o=this._floatingObjectContainerDiv;return o&&(t=parseInt(e.GC$(o).css("z-index")),!isNaN(t))?t:-1},t.prototype._paintImage=function(){var t,o=this._floatingObject,n=o.src(),r=o.pictureStretch(),i=e._ThemeContext.getColor(o.owner(),o.backColor());if(n&&this._floatingObjectContentDiv&&(t=e.GC$(this._floatingObjectContentDiv),this._srcCache!==n&&(this._srcCache=n,t.css("background-image","url('"+n+"')").css("background-repeat","no-repeat")),t.css("background-color",i),r!==c&&r!==h)&&o._isImageLoaded){var a=o.getOriginalWidth(),s=o.getOriginalHeight(),l=t.width(),u=t.height();e.util._applyBackgroundImageLayout(this._floatingObjectContentDiv,l,u,a,s,r)}},t.prototype._applyBorderStyle=function(o,n){var r=this._borderDiv,i=this._floatingObject,a=i.borderWidth(),s=i.borderStyle(),l=e._ThemeContext.getColor(i.owner(),i.borderColor()),u=i.borderRadius(),c=0,h=d(t._resizeIndicatorSize/2+1);i._isBorderStyleWork(s)||(a=0),a<h&&(c=h-a);var p=c,g=c,m=c,_=c;h=f(a,h),o.x<0?p+=o.x-h:(p+=o.x<h?o.x-h:0,_=n.width-p-o.width-2-2*a),o.y<0?g+=o.y-h:(g+=o.y<h?o.y-h:0,m=n.height-g-o.height-2-2*a),e.GC$(r).css({position:"absolute",left:p,top:g,bottom:m,right:_,"border-width":a,"border-style":s,"border-color":l,"border-radius":u})},t.prototype._dispose=function(){this._touchManager&&this._touchManager.detach(),this._floatingObjectContainerDiv&&(e.GC$(this._floatingObjectContainerDiv).remove(),this._floatingObjectContainerDiv=c),this._moveResizeContainerDiv&&(e.GC$(this._moveResizeContainerDiv).remove(),this._moveResizeContainerDiv=c)},t.prototype._showResizeIndicator=function(o){var n,r;e.GC$(F,o).removeClass(T);var i=this,a=i._getHTMLElementBounds(i._floatingObjectContainerDiv),s=i._floatingObjectContentDiv,l=i._floatingObject;i._borderDiv&&(s=i._borderDiv);var u=i._getHTMLElementBounds(s),c=u.x,h=u.y,p=a.height-u.y-u.height,f=a.width-u.x-u.width,g=0,m=t._resizeIndicatorSize,_=m+2,y=d(m/2+1);"function"==typeof l.borderWidth&&(n=l.borderWidth(),r=l.borderStyle(),l._isBorderStyleWork(r)||(n=0),n>=y&&(g=n-y),p=a.height-h-u.height-n,f=a.width-c-u.width-n,c+=n,h+=n),c>0?(h>0?e.GC$(M,i._floatingObjectContainerDiv).css({top:g,left:g,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(M),a.height>0?e.GC$(E,i._floatingObjectContainerDiv).css({left:g,top:(u.height-_)/2+h,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(E),p>0?e.GC$(N,i._floatingObjectContainerDiv).css({left:g,bottom:g,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(N)):(i._resizeIndicatorUnselect(M),i._resizeIndicatorUnselect(E),i._resizeIndicatorUnselect(N)),h>0?e.GC$(O,i._floatingObjectContainerDiv).css({top:g,left:(u.width-_)/2+c,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(O),p>0?e.GC$(P,i._floatingObjectContainerDiv).css({left:(u.width-_)/2+c,bottom:g,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(P),f>0?(h>0?e.GC$(L,i._floatingObjectContainerDiv).css({right:g,top:g,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(L),a.height>0?e.GC$(H,i._floatingObjectContainerDiv).css({top:(u.height-_)/2+h,right:g,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(H),p>0?e.GC$(k,i._floatingObjectContainerDiv).css({right:g,bottom:g,width:m,height:m}).addClass(b):i._resizeIndicatorUnselect(k)):(i._resizeIndicatorUnselect(L),i._resizeIndicatorUnselect(H),i._resizeIndicatorUnselect(k)),i._isResizeIndicatorDisplayed=!0},t.prototype._resizeIndicatorUnselect=function(t){e.GC$(t,this._floatingObjectContainerDiv).removeClass(b).addClass(T)},t.prototype._hideResizeIndicator=function(t){e.GC$(F,t).removeClass(b).addClass(T),this._isResizeIndicatorDisplayed=!1},t.prototype._createFloatingObjectContainer=function(t){var o=document.createElement("div"),n=e.GC$(o),r=this;r._renderManager.reduceZIndex(),n.addClass("floatingobject-container").addClass(A).attr("unselectable","on").css("z-index",700).bind("mousedown",function(e){r._doMouseDown(e)}).bind("mousemove",function(e){r._doMouseMove(e)}).bind("mouseup",function(e){r._doMouseUp(e)}),o.addEventListener("mousewheel",function(e){r._doMouseWheel(e)},!1),o.addEventListener("DOMMouseScroll",function(e){r._doMouseWheel(e)},!1);var i=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-top floatingobject-left floatingobject-absolute"),a=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-top floatingobject-center floatingobject-absolute"),s=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-top floatingobject-right floatingobject-absolute"),l=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-middle floatingobject-left floatingobject-absolute"),u=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-middle floatingobject-right floatingobject-absolute"),c=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-bottom floatingobject-left floatingobject-absolute"),h=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-bottom floatingobject-center floatingobject-absolute"),p=e.GC$(document.createElement("div")).addClass("floatingobject-resize-indicator floatingobject-bottom floatingobject-right floatingobject-absolute");return n.append(i).append(a).append(s).append(l).append(u).append(c).append(h).append(p),e.features.touch&&(r._touchManager=new e.FloatingObjectTouchManager(o,r,r._sheet.parent._touchEventProvider),r._touchManager.attach()),o},t.prototype._createMoveResizeContainer=function(){var t,o,n,r,i,a,s,l,u,c=this;if(c._floatingObjectContainerDiv&&c._layout&&!c._moveResizeDiv){for(c._moveResizeContainerDiv=document.createElement("div"),c._moveResizeDiv=document.createElement("div"),c._attachedMoveResizeDivDict={},t=c._renderManager._containerArray.length,o=0;o<t;o++)(r=(n=c._renderManager._containerArray[o])._floatingObject)&&r.name()!==c._floatingObject.name()&&r.isSelected()&&!c._attachedMoveResizeDivDict[r.name()]&&(c._attachedMoveResizeDivDict[r.name()]={offsetX:n._layout.x-c._layout.x,offsetY:n._layout.y-c._layout.y,height:n._layout.height,width:n._layout.width,moveResizeDiv:document.createElement("div")});for(l in i=c._getViewportRect(c._rowViewportIndex,c._columnViewportIndex),e.GC$(c._moveResizeContainerDiv).addClass("floatingobject-moving-container").css("z-index",701).css({top:i.y,left:i.x,width:i.width,height:i.height,background:"rgba(255,255,255,0.01)"}).bind("mousemove",function(e){c._doMouseMove(e)}).bind("mouseup",function(e){c._doMouseUp(e)}),a=c._layout.y-i.y,s=c._layout.x-i.x,c._attachMoveResizeDivToContainer(c._moveResizeDiv,c._moveResizeContainerDiv,s,a,c._layout.width,c._layout.height),c._attachedMoveResizeDivDict)u=c._attachedMoveResizeDivDict[l],c._attachMoveResizeDivToContainer(u.moveResizeDiv,c._moveResizeContainerDiv,s+u.offsetX,a+u.offsetY,u.width,u.height);c._containerDiv&&e.GC$(c._containerDiv).append(c._moveResizeContainerDiv)}},t.prototype._handleDocumentMouseMove=function(){var t=this;t._isMouseCapture||(e.GC$(document).bind("mousemove"+V,function(e){t._doMouseMove(e)}).bind("mouseup"+V,function(e){t._doMouseUp(e)}),t._isMouseCapture=!0)},t.prototype._unhandleDocumentMouseMove=function(){this._isMouseCapture&&(this._isMouseCapture=!1,e.GC$(document).unbind("mousemove"+V).unbind("mouseup"+V))},t.prototype._doMouseDown=function(t){var o,n,r=this,i=r._sheet;if(i.canEditFloatingObject(r._floatingObject)&&i.endEdit()){if(r._touchManager&&!t.isTouch&&r._touchManager.preProcessMouseDown(t))return void e.util.cancelDefault(t);if(0===t.button||2===t.button){if(t.ctrlKey||t.shiftKey?r._floatingObject.isSelected()?r._floatingObject.isSelected(!1):(r._floatingObject.isSelected(!0),e.FocusHelper.setActiveElement(i)):r._floatingObject.isSelected()||(i.unSelectAllFloatingObjects(),r._floatingObject.isSelected(!0),e.FocusHelper.setActiveElement(i)),i._commentManager&&i._commentManager.deactivateComment(),i._saveAndClearSheetSelections(),2===t.button)return;var a=i._eventHandler,s=a._getCanvasOffset(),l=new e.Point(t.pageX-s.left,t.pageY-s.top),u=r._hitTest(l.x,l.y);if(!r._floatingObject.allowMove()&&(!r._floatingObject.allowResize()||u.inMoving))return;r._mousePosition=l,r._isMouseLeftButtonDown=!0,r._mouseDownHittestInfo=u,r._mouseDownHittestInfo.inMoving?(r._moveInfo={},r._moveInfo.startTopRow=i.getViewportTopRow(r._rowViewportIndex),r._moveInfo.startLeftColumn=i.getViewportLeftColumn(r._columnViewportIndex),r._moveInfo.startX=r._mousePosition.x,r._moveInfo.startY=r._mousePosition.y):(r._createMoveResizeContainer(),e.GC$(r._moveResizeDiv),r._resizeInfo={},o=r._getHTMLElementBounds(r._moveResizeDiv),r._resizeInfo.startX=o.x,r._resizeInfo.startY=o.y,r._resizeInfo.startWidth=o.width,r._resizeInfo.startHeight=o.height,r._resizeInfo.startTopRow=i.getViewportTopRow(r._rowViewportIndex),r._resizeInfo.startLeftColumn=i.getViewportLeftColumn(r._columnViewportIndex)),r._handleDocumentMouseMove(),n=i.hitTest(r._mousePosition.x,r._mousePosition.y),a.startHitInfo={scrollRowViewportIndex:n.rowViewportIndex,scrollColViewportIndex:n.colViewportIndex,hitTestType:n.hitTestType},a.mousePosition=r._mousePosition,a.startScroll(),a.isFloatingObjectWorking=!0}return!1}},t.prototype._doMouseMove=function(t){var o=this,n=o._sheet;if(n.canEditFloatingObject(o._floatingObject)){if(o._touchManager&&!t.isTouch&&o._touchManager.preProcessMouseMove(t))return void e.util.cancelDefault(t);if(n._isMouseDownInSheet)return o._floatingObjectContainerDiv&&e.GC$(o._floatingObjectContainerDiv).css("cursor","default"),!0;var r=n._eventHandler,i=r._getCanvasOffset(),a=new e.Point(t.pageX-i.left,t.pageY-i.top);return o._isMouseLeftButtonDown?(e.GC$(o._moveResizeContainerDiv).css("cursor",e.GC$(o._floatingObjectContainerDiv).css("cursor")),o._mouseDownHittestInfo.inMoving?(o._isMoving=!0,o._createMoveResizeContainer(),o._doMoveContainer(o._mousePosition,a)):o._floatingObject.allowResize()&&(o._isResizing=!0,o._doResizeContainer(o._mousePosition,o._mouseDownHittestInfo)),(o._isMoving||o._isResizing)&&(o._mousePosition=a,r.mousePosition=a,r.continueScroll(),e.GC$(document.body).addClass(A).attr("unselectable","on"))):o._updateCursor(a),!1}},t.prototype._doMouseUp=function(t){var o,n,r,i=this,a=i._sheet,s=a._eventHandler;if(a.canEditFloatingObject(i._floatingObject))return i._touchManager&&!t.isTouch&&i._touchManager.preProcessMouseUp(t)?void e.util.cancelDefault(t):a._isMouseDownInSheet?(i._floatingObjectContainerDiv&&e.GC$(i._floatingObjectContainerDiv).css("cursor","move"),!0):(s.isFloatingObjectWorking=!1,s.stopScroll(),o=s._getCanvasOffset(),n=new e.Point(t.pageX-o.left,t.pageY-o.top),i._moveInfo&&(i._moveInfo.endX=n.x,i._moveInfo.endY=n.y),i._mouseDownHittestInfo&&(r=i._floatingObject.fixedPosition(),i._mouseDownHittestInfo.inMoving&&i._isMoving?(r&&i._adjustMoveInfo(),t.ctrlKey?i._doCopyFloatingObject():i._doMoveFloatingObject()):i._isResizing&&(r&&i._adjustResizeInfo(),i._doResizeFloatingObject()),e.GC$(document.body).removeClass(A)),i._resetStatusOnMouseUp(),!1)},t.prototype._adjustMoveInfo=function(){var e=this;if(e._moveInfo){var t=e._floatingObject,o=e._sheet,n=o._getSheetLayout(),r=n.width-n.rowHeaderWidth-n.headerX,i=n.height-n.colHeaderHeight-n.headerY,a=e._moveInfo.startX,s=e._moveInfo.startY,l=t.position().x,u=t.position().y,c=t.width(),h=t.height();l+e._moveInfo.endX-a<0&&(e._moveInfo.endX=a-l),u+e._moveInfo.endY-s<0&&(e._moveInfo.endY=s-u),l+c+e._moveInfo.endX-a>r&&(e._moveInfo.endX=r+a-l-c),u+h+e._moveInfo.endY-s>i&&(e._moveInfo.endY=i+s-u-h),e._moveInfo.startTopRow=o.getViewportTopRow(e._rowViewportIndex),e._moveInfo.startLeftColumn=o.getViewportLeftColumn(e._columnViewportIndex)}},t.prototype._adjustResizeInfo=function(){var t=this;if(t._resizeInfo){var o=t._sheet,n=o._getSheetLayout(),r=n.width-n.rowHeaderWidth-n.headerX,i=n.height-n.colHeaderHeight-n.headerY,a=new e.Rect(t._resizeInfo.endX,t._resizeInfo.endY,t._resizeInfo.endWidth,t._resizeInfo.endHeight);a=a.getIntersect(0,0,r,i),t._resizeInfo.endX=a.x,t._resizeInfo.endY=a.y,t._resizeInfo.endWidth=a.width,t._resizeInfo.endHeight=a.height,t._resizeInfo.startTopRow=o.getViewportTopRow(t._rowViewportIndex),t._resizeInfo.startLeftColumn=o.getViewportLeftColumn(t._columnViewportIndex)}},t.prototype._resetStatusOnMouseUp=function(){this._resizeInfo=c,this._moveInfo=c,this._attachedMoveResizeDivDict=c,e.GC$(this._moveResizeContainerDiv).remove(),this._moveResizeDiv=c,this._isMouseLeftButtonDown=!1,this._unhandleDocumentMouseMove(),this._isMoving=!1,this._isResizing=!1},t.prototype._doMouseWheel=function(t){var o,n=this._sheet;if(n)return o=(t=t||window.event).detail?t.detail:t.wheelDelta/-40,n._eventHandler.doMouseWheel(t,parseInt(o,10),0),e.util.cancelDefault(t),!1},t.prototype._doCopyFloatingObject=function(){var t,o,n,r=this,i=r._sheet;if(r._moveInfo){var a=r._getTwoRowDistance(r._moveInfo.startTopRow,i.getViewportTopRow(r._rowViewportIndex)),s=r._getTwoColumnDistance(r._moveInfo.startLeftColumn,i.getViewportLeftColumn(r._columnViewportIndex)),l=r._moveInfo.endX-r._moveInfo.startX+(r._moveInfo.endX>r._moveInfo.startX?s:-1*s),u=r._moveInfo.endY-r._moveInfo.startY+(r._moveInfo.endY>r._moveInfo.startY?a:-1*a);if(0===l&&0===u)return;for(o in(t=[]).push(r._floatingObject.name()),r._attachedMoveResizeDivDict)t.push(o);n=new e.UndoRedo.DragCopyFloatingObjectUndoAction(i,{names:t},{offsetX:l,offsetY:u}),i._doCommand(n)}},t.prototype._doMoveFloatingObject=function(){var t,o,n,r=this,i=r._sheet;if(r._moveInfo){var a=r._getTwoRowDistance(r._moveInfo.startTopRow,i.getViewportTopRow(r._rowViewportIndex)),s=r._getTwoColumnDistance(r._moveInfo.startLeftColumn,i.getViewportLeftColumn(r._columnViewportIndex)),l=r._moveInfo.endX-r._moveInfo.startX+(r._moveInfo.endX>r._moveInfo.startX?s:-1*s),u=r._moveInfo.endY-r._moveInfo.startY+(r._moveInfo.endY>r._moveInfo.startY?a:-1*a);for(o in l/=i._zoomFactor,u/=i._zoomFactor,(t=[]).push(r._floatingObject.name()),r._attachedMoveResizeDivDict)t.push(o);n=new e.UndoRedo.MovingFloatingObjectUndoAction(i,{names:t},{offsetX:l,offsetY:u}),i._doCommand(n)}},t.prototype._doResizeFloatingObject=function(){var t,o,n,r=this,i=r._sheet,a=i._zoomFactor;if(r._resizeInfo){var s=r._getTwoRowDistance(r._resizeInfo.startTopRow,i.getViewportTopRow(r._rowViewportIndex)),l=r._getTwoColumnDistance(r._resizeInfo.startLeftColumn,i.getViewportLeftColumn(r._columnViewportIndex)),u=r._resizeInfo.endX-r._resizeInfo.startX+(r._resizeInfo.endX>r._resizeInfo.startX?l:-1*l);u/=a,t=r._resizeInfo.endY-r._resizeInfo.startY+(r._resizeInfo.endY>r._resizeInfo.startY?s:-1*s),t/=a;var c=(r._resizeInfo.endWidth+l)/a-r._floatingObject.width(),h=(r._resizeInfo.endHeight+s)/a-r._floatingObject.height(),p=[];for(o in p.push(r._floatingObject.name()),r._attachedMoveResizeDivDict)p.push(o);n=new e.UndoRedo.ResizingFloatingObjectUndoAction(i,{names:p},{offsetX:u,offsetY:t,offsetWidth:c,offsetHeight:h}),i._doCommand(n)}},t.prototype._doMoveContainer=function(t,o){var n,r;if(this._moveResizeDiv){e.GC$(this._moveResizeDiv);var i=o.x-t.x,a=o.y-t.y;for(n in this._doMoveContainerImp(this._moveResizeDiv,i,a),this._attachedMoveResizeDivDict)r=this._attachedMoveResizeDivDict[n],this._doMoveContainerImp(r.moveResizeDiv,i,a)}},t.prototype._doMoveContainerImp=function(t,o,n){var r=e.GC$(t),i=r.position();r.css({top:i.top+n,left:i.left+o})},t.prototype._doResizeContainer=function(t,o){var n,r,i,a,s;if(o){i=(n=this)._getViewportRect(n._rowViewportIndex,n._columnViewportIndex),t=new e.Point(t.x-i.x,t.y-i.y),o.inTopNWSEResizing?r=n._getFloatingObjectTopLeftResizingRect(t):o.inTopNSResizing?r=n._getFloatingObjectTopCenterResizingRect(t):o.inTopNESWResizing?r=n._getFloatingObjectTopRightResizingRect(t):o.inLeftWEResizing?r=n._getFloatingObjectMiddleLeftResizingRect(t):o.inRightWEResizing?r=n._getFloatingObjectMiddleRightResizingRect(t):o.inBottomNESWResizing?r=n._getFloatingObjectBottomLeftResizingRect(t):o.inBottomNSReszing?r=n._getFloatingObjectBottomCenterResizingRect(t):o.inBottomNWSEReszing&&(r=n._getFloatingObjectBottomRightResizingRect(t)),n._resizeInfo.endX=r.x,n._resizeInfo.endY=r.y,n._resizeInfo.endWidth=r.width,n._resizeInfo.endHeight=r.height;e.GC$(n._moveResizeDiv);var l=n._getHTMLElementBounds(n._moveResizeDiv),u=r.y-l.y,c=r.x-l.x,h=r.width-l.width,p=r.height-l.height;for(a in n._doResizeContainerImp(n._moveResizeDiv,c,u,h,p),n._attachedMoveResizeDivDict)s=n._attachedMoveResizeDivDict[a],n._doResizeContainerImp(s.moveResizeDiv,c,u,h,p)}},t.prototype._doResizeContainerImp=function(t,o,n,r,i){var a=e.GC$(t),s=this._getHTMLElementBounds(t);a.css({top:s.y+n,left:s.x+o,width:s.width+r,height:s.height+i})},t.prototype._attachMoveResizeDivToContainer=function(t,o,n,r,i,a){e.GC$(t).addClass("floatingobject-moving-div").css({top:r-1,left:n-1,width:i,height:a}).appendTo(o)},t.prototype._getHTMLElementBounds=function(t){var o=e.GC$(t),n=o.position();return new e.Rect(n.left,n.top,o.width(),o.height())},t.prototype._updateCursor=function(t){if(this._floatingObjectContainerDiv){var o,n=e.GC$(this._floatingObjectContainerDiv),r=this._hitTest(t.x,t.y),i=this._floatingObject.allowResize(),a=this._floatingObject.allowMove();r!==c&&(o=r.inTopNWSEResizing?i?"nw-resize":"default":r.inTopNSResizing?i?"n-resize":"default":r.inTopNESWResizing?i?"ne-resize":"default":r.inLeftWEResizing?i?"w-resize":"default":r.inRightWEResizing?i?"w-resize":"default":r.inBottomNESWResizing?i?"sw-resize":"default":r.inBottomNSReszing?i?"n-resize":"default":r.inBottomNWSEReszing?i?"se-resize":"default":a?"move":"default",n.css("cursor",o))}},t.prototype._getFloatingObjectTopLeftResizingRect=function(t){var o=g(this._resizeInfo.startX+this._resizeInfo.startWidth,t.x),n=g(this._resizeInfo.startY+this._resizeInfo.startHeight,t.y),r=m(t.x-this._resizeInfo.startX-this._resizeInfo.startWidth),i=m(t.y-this._resizeInfo.startY-this._resizeInfo.startHeight);return new e.Rect(o,n,r,i)},t.prototype._getFloatingObjectTopCenterResizingRect=function(t){var o=this._resizeInfo.startX,n=g(this._resizeInfo.startY+this._resizeInfo.startHeight,t.y),r=m(t.y-this._resizeInfo.startY-this._resizeInfo.startHeight),i=this._resizeInfo.startWidth;return new e.Rect(o,n,i,r)},t.prototype._getFloatingObjectTopRightResizingRect=function(t){var o=g(this._resizeInfo.startX,t.x),n=g(this._resizeInfo.startY+this._resizeInfo.startHeight,t.y),r=m(t.x-this._resizeInfo.startX),i=m(t.y-this._resizeInfo.startY-this._resizeInfo.startHeight);return new e.Rect(o,n,r,i)},t.prototype._getFloatingObjectMiddleLeftResizingRect=function(t){var o=g(this._resizeInfo.startX+this._resizeInfo.startWidth,t.x),n=this._resizeInfo.startY,r=m(t.x-this._resizeInfo.startX-this._resizeInfo.startWidth),i=this._resizeInfo.startHeight;return new e.Rect(o,n,r,i)},t.prototype._getFloatingObjectMiddleRightResizingRect=function(t){var o=g(this._resizeInfo.startX,t.x),n=this._resizeInfo.startY,r=m(t.x-this._resizeInfo.startX),i=this._resizeInfo.startHeight;return new e.Rect(o,n,r,i)},t.prototype._getFloatingObjectBottomLeftResizingRect=function(t){var o=g(this._resizeInfo.startX+this._resizeInfo.startWidth,t.x),n=g(this._resizeInfo.startY,t.y),r=m(t.x-this._resizeInfo.startX-this._resizeInfo.startWidth),i=m(t.y-this._resizeInfo.startY);return new e.Rect(o,n,r,i)},t.prototype._getFloatingObjectBottomCenterResizingRect=function(t){var o=this._resizeInfo.startX,n=g(this._resizeInfo.startY,t.y),r=m(t.y-this._resizeInfo.startY),i=this._resizeInfo.startWidth;return new e.Rect(o,n,i,r)},t.prototype._getFloatingObjectBottomRightResizingRect=function(t){var o=g(this._resizeInfo.startX,t.x),n=g(this._resizeInfo.startY,t.y),r=m(t.x-this._resizeInfo.startX),i=m(t.y-this._resizeInfo.startY);return new e.Rect(o,n,r,i)},t.prototype._getViewportRect=function(e,t){var o,n,r,i,a,s=this._sheet,l=s._getSheetLayout(),u=l.viewportRect(e,t),c=this._floatingObject,h=c.startRow(),p=c.startColumn(),d=c.endRow(),f=c.endColumn(),g=s.frozenRowCount,m=s.frozenColCount,_=s.getRowCount(3)-s.getFrozenTrailingRowCount()-1,y=s.getColumnCount(3)-s.getFrozenTrailingColumnCount()-1;return 1===e?(g>0&&(o=s.getViewportTopRow(e),(h<g||o===g)&&(u.y-=l.frozenHeight,u.height+=l.frozenHeight)),s._frozenTrailingRowCount>0&&(n=s.getViewportBottomRow(e),d>_&&n===_&&(u.height+=l.frozenTrailingHeight))):0===e?(d>=(o=s.getViewportTopRow(e+1))||o===g)&&(a=l.viewportRect(e+1,t),u.height+=a.height):2===e&&((h<=(n=s.getViewportBottomRow(e-1))||n===_)&&(a=l.viewportRect(e-1,t),u.y=a.y,u.height+=a.height)),1===t?(m>0&&(r=s.getViewportLeftColumn(t),(p<m||r===m)&&(u.x-=l.frozenWidth,u.width+=l.frozenWidth)),s._frozenTrailingColCount>0&&(i=s.getViewportRightColumn(t),(f>y||i===y)&&(u.width+=l.frozenTrailingWidth))):0===t?(f>=(r=s.getViewportLeftColumn(t+1))||r===m)&&(a=l.viewportRect(e,t+1),u.width+=a.width):2===t&&((p<=(i=s.getViewportRightColumn(t-1))||i===y)&&(a=l.viewportRect(e,t-1),u.x=a.x,u.width+=a.width)),u},t.prototype._getTwoColumnDistance=function(e,t){for(var o=g(e,t),n=f(e,t),r=0,i=o;i<n;i++)r+=this._sheet.getColumnWidth(i,3);return r},t.prototype._getTwoRowDistance=function(e,t){for(var o=g(e,t),n=f(e,t),r=0,i=o;i<n;i++)r+=this._sheet.getRowHeight(i,3);return r},t.prototype._hitTest=function(o,n){var r,i=this;if(!i._layout)return c;if(r={inMoving:!1,inTopNWSEResizing:!1,inTopNSResizing:!1,inTopNESWResizing:!1,inLeftWEResizing:!1,inRightWEResizing:!1,inBottomNESWResizing:!1,inBottomNSReszing:!1,inBottomNWSEReszing:!1},!i._floatingObject.isSelected())return r.inMoving=!0,r;var a=d(t._resizeIndicatorSize/2+1),s=i._layout.x,l=i._layout.y,u=i._layout.width,h=i._layout.height;return i._floatingObject&&i._floatingObject.isSelected()&&(s-=a,l-=a,u+=2*a,h+=2*a),i._inflateRect(new e.Rect(s,l,a,a),10).contains(o,n)?(r.inTopNWSEResizing=!0,r):i._inflateRect(new e.Rect(s+u/2-a,l,2*a,a),10).contains(o,n)?(r.inTopNSResizing=!0,r):i._inflateRect(new e.Rect(s+u-a,l,a,a),10).contains(o,n)?(r.inTopNESWResizing=!0,r):i._inflateRect(new e.Rect(s,l+h/2-a,a,2*a),10).contains(o,n)?(r.inLeftWEResizing=!0,r):i._inflateRect(new e.Rect(s+u-a,l+h/2-a,a,2*a),10).contains(o,n)?(r.inRightWEResizing=!0,r):i._inflateRect(new e.Rect(s,l+h-a,a,a),10).contains(o,n)?(r.inBottomNESWResizing=!0,r):i._inflateRect(new e.Rect(s+u/2-a,l+h-a,2*a,a),10).contains(o,n)?(r.inBottomNSReszing=!0,r):i._inflateRect(new e.Rect(s+u-a,l+h-a,a,a),10).contains(o,n)?(r.inBottomNWSEReszing=!0,r):(r.inMoving=!0,r)},t.prototype._inflateRect=function(t,o){var n=t.x-o,r=t.y-o,i=t.width+2*o,a=t.height+2*o;return new e.Rect(n,r,i>=0?i:0,a>=0?a:0)},t._resizeIndicatorSize=7,t}(),e._FloatingObjectRender=i,a=function(){function t(e){this._sheet=e,this._containerArray=new l}return t.prototype.getFloatingObjectRenderCount=function(){return this._containerArray.length},t.prototype._dispose=function(){for(var e=this._containerArray.length,t=0;t<e;t++)this._containerArray[t]._dispose();this._containerArray.length=0},t.prototype._render=function(t,o,n){var r,a,s,l,u,h,p;if(!(t<0||o<0)){for(var g=this,m=g._sheet,_=g._createViewportFloatingObjectLayoutModel(t,o,n),y=[],C=0,w=g._containerArray.length;C<w;C++)_.find(g._containerArray[C].name)||y.push(g._containerArray[C]);for(C=0,w=y.length;C<w;C++)(r=y[C])._renderManager=c,g._containerArray.remove(r.name),r._dispose();if(!((a=_.length)<=0))for(s=m.parent&&m.parent.useTouchLayout(),i._resizeIndicatorSize=s?11:7,C=0;C<a;C++){var v=_[C],S=m._findFloatingObjectInternal(v.name),x=d(i._resizeIndicatorSize/2+1);S&&"function"==typeof S.borderWidth&&(l=S.borderWidth(),u=S.borderStyle(),S._isBorderStyleWork(u)||(l=0),l>x&&(x=l));var R=g._getViewportRect(t,o),b=v.x-x-1,T=v.y-x-1,A=v.width+2*x+2,I=v.height+2*x+2,D=f(R.y,T),F=f(R.x,b),M=I,E=A,N=x,O=x,P=-1*x-1;(N=T-D+N)<=0?(M+=N,M+=P):N<x&&N>0&&(M-=x-N),(O=b-F+O)<=0?(E+=O,E+=P):O<x&&O>0&&(E-=x-O),(h=g._containerArray.find(v.name))||((h=new i(m._findFloatingObjectInternal(v.name),m))._renderManager=g,g._containerArray.push(h)),h._layout=v,h._rowViewportIndex=t,h._columnViewportIndex=o,p=new e.Rect(R.x,R.y,R.width,R.height),h.render(new e.Rect(F,D,E,M).getIntersectRect(p)||new e.Rect(F,D,0,0),new e.Rect(O,N,v.width,v.height))}}},t.prototype.setFloatingObjectZIndex=function(e,t){var o=this._containerArray.find(e);o&&o.setFloatingObjectZIndex(t)},t.prototype.getFloatingObjectZIndex=function(e){var t=this._containerArray.find(e);return t?t.getFloatingObjectZIndex():-1},t.prototype.reduceZIndex=function(){for(var e,t,o=this._containerArray,n=0,r=o.length;n<r;n++)-1!==(t=(e=o[n]).getFloatingObjectZIndex())&&e.setFloatingObjectZIndex(t-1)},t.prototype._getViewportRect=function(t,o){var n,r,i,a,s,l=this._sheet,u=l._getViewportColumnLayout(o),c=0,h=0,p=0,d=0;return u&&u.length>0&&(n=u[0],r=u[u.length-1],c=n.x,p=r.x+r.width-c),(i=l._getViewportRowLayout(t))&&i.length>0&&(a=i[0],s=i[i.length-1],h=a.y,d=s.y+s.height-h),l._getSheetLayout().viewportRect(t,o).getIntersect(c,h,p,d)||new e.Rect(0,0,0,0)},t.prototype._createViewportFloatingObjectLayoutModel=function(e,t,o){var n,r,i,a,u,c,h,p,f,g,m,_,y,C,w,v=this._sheet,S=new l,x=v._floatingObjectArray,R=x.length;if(0===x.length)return S;x.isNeedToUpdateLayout&&(x._updateFloatingsObjectlayoutOnColumnRowChanged(),x.isNeedToUpdateLayout=!1);var b=v._getSheetLayout(),T=v._cachePool,A=v._getViewportColumnLayout(t),I=v._getViewportRowLayout(e);if(A.length<=0||I.length<=0)return S;var D=A[0],F=A[A.length-1],M=I[0],E=I[I.length-1];for(n=0;n<R;n++)if((r=x[n]).isVisible()){if(r.fixedPosition())i=(u=r.position()).x*o+b.frozenX,a=u.y*o+b.frozenY;else{if(i=0,c=r.startColumn(),h=A.findCol(c))i=h.x;else if(c<D.col)for(i=D.x,p=D.col-1;p>=c;p--)i-=T.getZoomColWidth(p);else for(i=F.x+F.width,f=F.col+1;f<=c;f++)i+=T.getZoomColWidth(f);if(i+=r.startColumnOffset()*o,a=0,g=r.startRow(),m=I.findRow(g))a=m.y;else if(g<M.row)for(a=M.y,_=M.row-1;_>=g;_--)a-=T.getZoomRowHeight(_);else for(a=E.y+E.height,y=E.row+1;y<=g;y++)a+=T.getZoomRowHeight(y);a+=r.startRowOffset()*o}C=d(r.width()*o),w=d(r.height()*o),S.push(new s(r.name(),i,a,C,w))}return S},t}(),e._FloatingObjectRenderManager=a,s=function(){return function(e,t,o,n,r){this.name=e,this.x=t,this.y=o,this.height=r,this.width=n}}(),e._FloatingObjectLayout=s,l=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.remove=function(e){for(var t=0;t<this.length;t++)if(this[t].name===e)return void this.splice(t,1)},t.prototype.find=function(e){for(var t=0;t<this.length;t++)if(this[t].name===e)return this[t];return c},t.prototype.findByPropertyName=function(e){for(var t=0;t<this.length;t++)if(this[t]._name===e)return this[t];return c},t}(e._XArray),e.NamedObjectArray=l}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(e){var t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O;e.feature("sparklineEx",["core.theme"]);var P,L,H,k,V,B=null,z=void 0,G=e.Calc.Convert,W=Math.floor,j=Math.PI,U=Math.sin,Y=Math.cos,X=Math.min,K=Math.max,J=Math.round,Z=Math.pow,q=Math.sqrt,$=Math.random,Q=Math.abs,ee=Math.ceil,te="undefined",oe="string",ne=function(){return function(e,t){this.name=e,this.value=t}}();e.SparklineExValue=ne,t=function(){function t(){var t,o,n=this.createFunction();n&&(t=n.name,o=n.evaluate,n.evaluate=function(e){var n=o.call(this,e);return n?new ne(t,n):B},this._name=t,t&&!e.Calc.Functions.findGlobalFunction(t)&&(e.Calc.Functions._customFunctions[t]=n)),this.typeName=""}return t.prototype.name=function(){return this._name},t.prototype.createFunction=function(){return B},t.prototype.getAllValuesFromReference=function(e){var t,o,n,r,i,a,s=[];if(G.ref(e))for(t=e.getRangeCount(),o=0;o<t;o++)for(n=e.getRowCount(o),r=e.getColumnCount(o),i=0;i<n;i++)for(a=0;a<r;a++)s.push(e.getValue(o,i,a));return s},t.prototype.getRangeValuesFromReference=function(e,t){var o,n,r,i,a=[];if(G.ref(e)&&e.getRangeCount()>t)for(o=e.getRowCount(t),n=e.getColumnCount(t),r=0;r<o;r++)for(a[r]=[],i=0;i<n;i++)a[r].push(e.getValue(t,r,i));return a},t.prototype.getFirstValueFromReference=function(e){var t;return G.ref(e)?t=e.getValue(0,0,0):e!==B&&typeof e!==te&&(t=e),t},t.prototype._paintSparkline=function(e,t,o,n,r,i,a){this.paint(e,t,o,n,r,i)},t.prototype.paint=function(e,t,o,n,r,i){},t.prototype.toJSON=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==z&&(this[t]=e[t])},t}(),e.SparklineEx=t,o=function(){return function(e,t){this.values=e,this.colors=t}}(),e.PieSparklineValue=o,n=function(t){function n(){t.call(this)}return __extends(n,t),n.prototype._getValues=function(e){var t=this.getAllValuesFromReference(e);return t.length<=0&&e!==B&&typeof e!==te&&t.push(e),t},n.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("PIESPARKLINE",1,255),n=this;return t.evaluate=function(e){var t=n._getValues(e[0]),r=Array.prototype.slice.call(e,1);return new o(t,r)},t.acceptsReference=function(e){return 0===e},t},n.prototype._fixValues=function(e){for(var t,o=[],n=0,r=0,i=e.length;n<i;n++)(t=e[n])!==B&&typeof t!==te&&!isNaN(t)&&isFinite(t)?(t<0&&(t=-t),o[r++]=t):o[r++]=0;return 1===e.length&&1===o.length&&(o[1]=1-o[0]),o},n.prototype._fixColors=function(t,o){var n,r,i,a,s,l,u,c=[],h=o.length;if(t<=h)c=o.slice(0,t);else{for(0===h?(c.push("darkgray"),h=1):c=o.slice(0),n=[],l=t-h+1,u=0;u<h;u++)n[u]=e._Color.parse(c[u]);for(u=h;u<t;u++)i=(r=n[u%h]).r,a=r.g,s=r.b,i-=i/l*(u/h),a-=a/l*(u/h),s-=s/l*(u/h),c[u]=new e._Color(255,W(i),W(a),W(s)).toString()}return c},n.prototype.paint=function(e,t,o,n,r,i){var a,s,l=o+r/2,u=n+i/2,c=X(r,i)/2-5,h=-.5*j,p=l+c*Y(h),d=u+c*U(h),f=[],g=[];if(!(c<=0)){var m=this._fixValues(t.values),_=m.length,y=this._fixColors(_,t.colors),C=0;for(s=0;s<_;s++)C+=m[s];for(e.save(),s=0;s<_;s++)a=h+m[s]/C*2*j,e.beginPath(),e.moveTo(l,u),e.lineTo(p,d),e.arc(l,u,c,h,a,!1),e.lineTo(l,u),e.fillStyle=y[s],e.fill(),f.push(p),g.push(d),p=l+c*Y(h=a),d=u+c*U(h);for(e.strokeStyle="white",s=0;s<_;s++)e.beginPath(),e.moveTo(l,u),e.lineTo(f[s],g[s]),e.stroke();e.restore()}},n}(t),e.PieSparkline=n,r=function(){return function(e,t,o){this.x=e,this.y=t,this.value=o}}(),i=function(){return function(e,t,o,n,r,i,a){this.points=e,this.mini=t,this.maxi=o,this.line1=n,this.line2=r,this.colorPositive=i,this.colorNegative=a}}(),e.AreaSparklineValue=i,a=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("AREASPARKLINE",1,7),o=this;return t.evaluate=function(e){var t=o.getAllValuesFromReference(e[0]),n=e[1],r=e[2],a=e[3],s=e[4],l=e[5],u=e[6];return new i(t,n,r,a,s,l,u)},t.acceptsReference=function(e){return 0===e},t},o.prototype._fixValues=function(e){for(var t,o=[],n=0,r=0,i=e.length;n<i;n++)t=e[n],o[r++]=t!==B&&typeof t!==te&&!isNaN(t)&&isFinite(t)?t:0;return o},o.prototype._rangeMin=function(e){for(var t,o=e[0],n=1,r=e.length;n<r;n++)o>(t=e[n])&&(o=t);return o},o.prototype._rangeMax=function(e){for(var t,o=e[0],n=1,r=e.length;n<r;n++)o<(t=e[n])&&(o=t);return o},o.prototype._getXInStraightLine=function(e,t,o,n,r){return((t-r)*o+(r-n)*e)/(t-n)},o.prototype.paint=function(e,t,o,n,i,a){var s,l,u,c,h,p,d,f,g,m,_;e.save();var y,C,w,v,S,x,R,b,T,A,I,D,F,M,E,N,O=t.points,P=t.mini,L=t.maxi,H=t.line1,k=t.line2,V=t.colorPositive,z=t.colorNegative;for(O=this._fixValues(O),(V===B||typeof V===te)&&(V="#787878"),(z===B||typeof z==te)&&(z="#CB0000"),w=this._rangeMin(O),(P===B||typeof P===te)&&(P=w),S=X(P,w),v=this._rangeMax(O),(L===B||typeof L===te)&&(L=v),S>0&&(S=0),(x=K(L,v))<0&&(x=0),(T=0)>x&&(T=x),T<S&&(T=S-1),I=o+5,E=(F=i-10)/((A=O.length)-1),s=[],p=(D=n+5)+(x-T)/(N=(x-S)/(M=a-10)),g=0;g<A;g++)d=I+E*g,f=D+(x-(l=O[g]))/N,0===g&&s.push(new r(d,p,T)),g>0&&l*O[g-1]<0&&((c=s[s.length-1])&&(h=this._getXInStraightLine(c.x,c.y,d,f,p),s.push(new r(h,p,T)))),s.push(new r(d,f,l)),g===A-1&&s.push(new r(d,p,T));for(e.beginPath(),m=0,_=s.length;m<_;m++)(u=s[m])&&(e.lineTo(u.x,u.y),c=s[m-1],u.value===T&&c&&(e.fillStyle=c.value>T?V:z,e.fill(),m!==_-1&&(e.beginPath(),e.lineTo(u.x,u.y))));(H!==B||typeof H===te)&&((R=H)>x&&(R=x),R<S&&(R=S),y=J(D+(0!==N?(x-R)/N:M/2))-.5,e.beginPath(),e.moveTo(I,y),e.lineTo(I+F,y),e.strokeStyle="blue",e.stroke()),(k!==B||typeof k===te)&&((b=k)>x&&(b=x),b<S&&(b=S),C=J(D+(0!==N?(x-b)/N:M/2))-.5,e.beginPath(),e.moveTo(I,C),e.lineTo(I+F,C),e.strokeStyle="blue",e.stroke()),e.restore()},o}(t),e.AreaSparkline=a,s=function(){return function(e,t){this.x=e,this.y=t}}(),l=function(){return function(e,t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_){var y=this;y.points1=e,y.points2=t,y.minX=o,y.maxX=n,y.minY=r,y.maxY=i,y.hLine=a,y.vLine=s,y.xMinZone=l,y.xMaxZone=u,y.yMinZone=c,y.yMaxZone=h,y.tags=p,y.drawSymbol=d,y.drawLines=f,y.color1=g,y.color2=m,y.dash=_}}(),e.ScatterSparklineValue=l,u=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("SCATTERSPARKLINE",1,18),o=this;return t.evaluate=function(e){var t=o.getRangeValuesFromReference(e[0],0),n=o.getRangeValuesFromReference(e[1],0),r=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],g=e[12],m=e[13],_=e[14],y=e[15],C=e[16],w=e[17];return new l(t,n,r,i,a,s,u,c,h,p,d,f,g,m,_,y,C,w)},t.acceptsReference=function(e){return 0===e||1===e},t},o.prototype._getScatterPoints=function(e){var t,o,n,r,i=[];if((t=e.length)>0)if(t<(o=e[0].length)){if(t>=2)for(n=0;n<o;n++)i.push(new s(e[0][n],e[1][n]))}else if(o>=2)for(r=0;r<t;r++)i.push(new s(e[r][0],e[r][1]));return i},o.prototype._getMinScatterPoint=function(e){for(var t,o=new s(Number.MAX_VALUE,Number.MAX_VALUE),n=e.length,r=0;r<n;r++)t=e[r],o.x>t.x&&(o.x=t.x),o.y>t.y&&(o.y=t.y);return o},o.prototype._getMaxScatterPoint=function(e){for(var t,o=new s(-Number.MAX_VALUE,-Number.MAX_VALUE),n=e.length,r=0;r<n;r++)t=e[r],o.x<t.x&&(o.x=t.x),o.y<t.y&&(o.y=t.y);return o},o.prototype._getXInStraightLine=function(e,t,o,n){return o/n*(t-e)+e},o.prototype._paintLine=function(e,t,o,n,r,i,a){var l,u,c,h,p;if(a){var d,f,g,m,_=q(Z(n-t,2)+Z(r-o,2)),y=0,C=[];for(t<=n?(d=t,f=n,g=t,m=o):(d=n,f=t,g=n,m=r),u=o-(l=(r-o)/(n-t))*t,C.push(new s(g,m));y<_;)(y+=6)<=_&&(m=l*(g=this._getXInStraightLine(d,f,y,_))+u,C.push(new s(g,m))),(y+=4)<=_&&(m=l*(g=this._getXInStraightLine(d,f,y,_))+u,C.push(new s(g,m))),(y+=2)<=_&&(m=l*(g=this._getXInStraightLine(d,f,y,_))+u,C.push(new s(g,m))),(y+=4)<=_&&(m=l*(g=this._getXInStraightLine(d,f,y,_))+u,C.push(new s(g,m)));for(e.strokeStyle=i,c=0,p=C.length;c<p-1;c+=2)e.beginPath(),h=C[c],e.moveTo(h.x,h.y),h=C[c+1],e.lineTo(h.x,h.y),e.stroke()}else e.beginPath(),e.moveTo(t,o),e.lineTo(n,r),e.strokeStyle=i,e.stroke()},o.prototype.paint=function(e,t,o,n,r,i){var a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T=this,A=t.points1,I=t.points2,D=t.minX,F=t.maxX,M=t.minY,E=t.maxY,N=t.hLine,O=t.vLine,P=t.xMinZone,L=t.xMaxZone,H=t.yMinZone,k=t.yMaxZone,V=t.tags,z=t.drawSymbol,G=t.drawLines,W=t.color1,U=t.color2,Y=t.dash,Z=o+5,q=n+5,$=r-10,Q=i-10;if(A&&!(A.length<=0)&&!((a=T._getScatterPoints(A)).length<=0)&&(!I||!(I.length>0)||!((s=T._getScatterPoints(I)).length<=0))){if(e.save(),e.rect(o,n,r,i),e.clip(),e.beginPath(),(z===B||typeof z===te)&&(z=!0),(W===B||typeof W===te)&&(W="#969696"),(U===B||typeof U===te)&&(U="#CB0000"),l=M!==B&&typeof M!==te?M:T._getMinScatterPoint(a).y,u=E!==B&&typeof E!==te?E:T._getMaxScatterPoint(a).y,(c=D!==B&&typeof D!==te?D:T._getMinScatterPoint(a).x)>=(h=F!==B&&typeof F!==te?F:T._getMaxScatterPoint(a).x)&&(h=c+1),l>=u&&(u=l+1),P!==B&&typeof P!==te&&L!==B&&typeof L!==te&&H!==B&&typeof H!==te&&k!==B&&typeof k!==te&&c<=P&&P<=h&&c<=L&&L<=h&&l<=H&&H<=u&&l<=k&&k<=u){var ee=K(c,P),oe=X(h,L),ne=K(l,H),re=X(u,k);ee>=oe&&(oe=ee+1),ne>=re&&(re=ne+1),e.beginPath(),e.fillStyle="#DCDCDC",e.fillRect(Z+(ee-c)*$/(h-c),q+(u-re)*Q/(u-l),(oe-ee)*$/(h-c),(re-ne)*Q/(u-l))}for(v=-Number.MAX_VALUE,S=-Number.MAX_VALUE,x=Number.MAX_VALUE,R=Number.MAX_VALUE,p=0,f=a.length;p<f-1;p++)g=(d=a[p]).x,m=d.y,_=Z+(g-c)*$/(h-c),C=Z+((d=a[p+1]).x-c)*$/(h-c),y=q+(u-m)*Q/(u-l),w=q+(u-d.y)*Q/(u-l),G&&T._paintLine(e,_,y,C,w,W,Y),z&&(0===p&&(e.beginPath(),e.strokeStyle=W,e.arc(_-2,y-2,2,0,2*j,!1),e.stroke()),e.beginPath(),e.strokeStyle=W,e.arc(C-2,w-2,2,0,2*j,!1),e.stroke()),V&&(0===p&&(y>S&&(v=_,S=y),y<R&&(x=_,R=y)),w>S&&(v=C,S=w),w<R&&(x=C,R=w));if(I&&I.length>0)for((M===B||typeof M===te)&&(l=T._getMinScatterPoint(s).y),(E===B||typeof E===te)&&(u=T._getMaxScatterPoint(s).y),(D===B||typeof D===te)&&(c=T._getMinScatterPoint(s).x),(F===B||typeof F===te)&&(h=T._getMaxScatterPoint(s).x),c>=h&&(h=c+1),l>=u&&(u=l+1),p=0,f=s.length;p<f-1;p++)g=(d=s[p]).x,m=d.y,_=Z+(g-c)*$/(h-c),C=Z+((d=s[p+1]).x-c)*$/(h-c),y=q+(u-m)*Q/(u-l),w=q+(u-d.y)*Q/(u-l),G&&T._paintLine(e,_,y,C,w,U,Y),z&&(0===p&&(e.beginPath(),e.strokeStyle=U,e.strokeRect(_-2,y-2,4,4)),e.beginPath(),e.strokeStyle=U,e.strokeRect(C-2,w-2,4,4));V&&(e.beginPath(),e.arc(v-2,S-2,2,0,2*j,!1),e.fillStyle="#CB0000",e.fill(),e.beginPath(),e.arc(x-2,R-2,2,0,2*j,!1),e.fillStyle="#0000FF",e.fill()),N!==B&&typeof N!==te&&l<=N&&N<=u&&(b=J(q+(u-N)*Q/(u-l))-.5,T._paintLine(e,Z,b,Z+$,b,"#CB0000")),O!==B&&typeof O!==te&&c<=O&&O<=h&&(b=J(Z+(O-c)*$/(h-c))-.5,T._paintLine(e,b,q,b,q+Q,"#CB0000")),e.restore()}},o}(t),e.ScatterSparkline=u,c=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype._parseSetting=function(e){var t,o,n,r,i,a={},s=!1,l=!0,u="",c="";if(e){for(t=0,o=(e=e.substr(1,e.length-2)).length;t<o;t++)":"===(n=e.charAt(t))?l=!1:","!==n||s?"'"===n||'"'===n||("("===n?s=!0:")"===n&&(s=!1),l?u+=n:c+=n):(a[u]=c,u="",c="",l=!0);for(r in u&&(a[u]=c),a)(i=a[r])!==B&&typeof i!==te&&("TRUE"===i.toUpperCase()?a[r]=!0:"FALSE"===i.toUpperCase()?a[r]=!1:!isNaN(i)&&isFinite(i)&&(a[r]=parseFloat(i)))}return a},o.prototype._createCustomFunction=function(t,o){var n=new e.Calc.Functions.Function(t,2,5),r=this;return n.evaluate=function(t){var n,i,a,s,l,u,c,h,p=t[0];if(G.ref(p)&&p.getRangeCount()>0){var d,f,g=new e.Range(p.getRow(0),p.getColumn(0),p.getRowCount(0),p.getColumnCount(0)),m=t[1],_=t[2];if(G.ref(_)&&(_.getRangeCount()>0&&(d=new e.Range(_.getRow(0),_.getColumn(0),_.getRowCount(0),_.getColumnCount(0)),f=t[3])),n=new e.SparklineSetting,i=t[4]){for(c in l={AXISCOLOR:"_axisColor",FIRSTMARKERCOLOR:"_firstMarkerColor",HIGHMARKERCOLOR:"_highMarkerColor",LASTMARKERCOLOR:"_lastMarkerColor",LOWMARKERCOLOR:"_lowMarkerColor",MARKERSCOLOR:"_markersColor",NEGATIVECOLOR:"_negativeColor",SERIESCOLOR:"_seriesColor",DISPLAYEMPTYCELLSAS:"displayEmptyCellsAs",RIGHTTOLEFT:"rightToLeft",DISPLAYHIDDEN:"displayHidden",DISPLAYXAXIS:"displayXAxis",SHOWFIRST:"_showFirst",SHOWHIGH:"_showHigh",SHOWLAST:"_showLast",SHOWLOW:"_showLow",SHOWNEGATIVE:"_showNegative",SHOWMARKERS:"_showMarkers",MANUALMAX:"manualMax",MANUALMIN:"manualMin",MAXAXISTYPE:"maxAxisType",MINAXISTYPE:"minAxisType",LINEWEIGHT:"lineWeight"},a=r._parseSetting(i))c&&((s=l[c.toUpperCase()])&&(n[s]=a[c]));for(c in u={AC:"_axisColor",FMC:"_firstMarkerColor",HMC:"_highMarkerColor",LASTMC:"_lastMarkerColor",LOWMC:"_lowMarkerColor",MC:"_markersColor",NC:"_negativeColor",SC:"_seriesColor",DECA:"displayEmptyCellsAs",RTL:"rightToLeft",DH:"displayHidden",DXA:"displayXAxis",SF:"_showFirst",SH:"_showHigh",SLAST:"_showLast",SLOW:"_showLow",SN:"_showNegative",SM:"_showMarkers",MMAX:"manualMax",MMIN:"manualMin",MAXAT:"maxAxisType",MINAT:"minAxisType",LW:"lineWeight"},a)c&&((s=u[c.toUpperCase()])&&(n[s]=a[c]));1===n.maxAxisType&&(n.maxAxisType=0),1===n.minAxisType&&(n.minAxisType=0),n.rightToLeft=!!n.rightToLeft,n.displayHidden=!!n.displayHidden,n.displayXAxis=!!n.displayXAxis,n._showFirst=!!n._showFirst,n._showHigh=!!n._showHigh,n._showLast=!!n._showLast,n._showLow=!!n._showLow,n._showNegative=!!n._showNegative,n._showMarkers=!!n._showMarkers}return h=new e.SparklineValue(-1,-1,g,m,o,n),d&&typeof f!==te&&f!==B&&(h.dateAxisData(d),h.dateAxisOrientation(f),h.group().displayDateAxis=!0),h.cachedValues=r.getRangeValuesFromReference(p,0),h.cachedDatetimes=r.getRangeValuesFromReference(_,0),h}},n.acceptsReference=function(e){return 0===e||2===e},n},o.prototype._fixValues=function(t,o,n,r,i,a){var s,l,u=[],c=1===i;if(r)for(s=0,l=c?r.colCount:r.rowCount;s<l;s++){var h=c?0:s,p=c?s:0,d=t[h][p];!n&&(o.getRowHeight(r.row+h)<=0||o.getColumnWidth(r.col+p)<=0)?d=NaN:d!==B&&typeof d!==te&&(a?d="number"==typeof d?e._DateTimeHelper.fromOADate(d):Date.parse(d):"number"!=typeof d&&(d=e.__invalidValuePlaceHolder)),u.push(d)}return u},o.prototype._paintSparkline=function(t,o,n,r,i,a,s){if(e.features.sparkline){var l=o,u=l.cachedValues,c=l.cachedDatetimes,h=s._zoomFactor,p=new e.SparklineRender(l),d=l.setting(),f=d.displayHidden;u=this._fixValues(u,s,f,l.data(),l.dataOrientation()),c=this._fixValues(c,s,f,l.dateAxisData(),l.dateAxisOrientation(),!0),d._setThemeContext(s),p._paintCore(t,n,r,i,a,u,c,h)}},o}(t),e.CompatibleSparkline=c,h=function(t){function o(){t.apply(this,arguments)}return __extends(o,t),o.prototype.createFunction=function(){return e.util.hasCalc()&&e.features.sparkline?t.prototype._createCustomFunction.call(this,"LINESPARKLINE",0):B},o}(c),e.LineSparkline=h,p=function(t){function o(){t.apply(this,arguments)}return __extends(o,t),o.prototype.createFunction=function(){return e.util.hasCalc()&&e.features.sparkline?t.prototype._createCustomFunction.call(this,"COLUMNSPARKLINE",1):B},o}(c),e.ColumnSparkline=p,d=function(t){function o(){t.apply(this,arguments)}return __extends(o,t),o.prototype.createFunction=function(){return e.util.hasCalc()&&e.features.sparkline?t.prototype._createCustomFunction.call(this,"WINLOSSSPARKLINE",2):B},o}(c),e.WinlossSparkline=d,f=function(){return function(e,t,o,n,r,i,a,s,l){this.measure=e,this.target=t,this.maxi=o,this.good=n,this.bad=r,this.forecast=i,this.tickUnit=a,this.colorScheme=s,this.vertical=l}}(),e.BulletSparklineValue=f,g=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("BULLETSPARKLINE",3,9),o=this;return t.evaluate=function(e){var t=o.getFirstValueFromReference(e[0]),n=o.getFirstValueFromReference(e[1]),r=o.getFirstValueFromReference(e[2]),i=o.getFirstValueFromReference(e[3]),a=o.getFirstValueFromReference(e[4]),s=o.getFirstValueFromReference(e[5]),l=o.getFirstValueFromReference(e[6]),u=e[7],c=e[8];return new f(t,n,r,i,a,s,l,u,c)},t.acceptsReference=function(e){return 0<=e&&e<=6},t},o.prototype._lightenColor=function(t,o){var n=e._Color.parse(t);return new e.HLSColor(n).getLighterColor(o).toString()},o.prototype.paint=function(e,t,o,n,r,i){var a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v=t.measure,S=t.target,x=t.maxi,R=t.good,b=t.bad,T=t.forecast,A=t.tickUnit,I=t.colorScheme,D=t.vertical;if(x!==B&&typeof x!==te&&!(x<0)){if((v===B||typeof v===te||v<0)&&(v=0),(R===B||typeof R===te||R<0)&&(R=0),(b===B||typeof b===te||b<0)&&(b=0),(S===B||typeof S===te)&&(S=0),(T===B||typeof T===te)&&(T=0),(A===B||typeof A===te)&&(A=0),(I===B||typeof I===te)&&(I="#A0A0A0"),a="#252525",v>x&&(v=x,a="#CB0000"),R>x&&(R=x,a="#CB0000"),b>x&&(b=x,a="#CB0000"),S>x&&(S=0,a="#CB0000"),T>x&&(T=x,a="#CB0000"),D?(s=n+i-5,l=i-10):(s=o+5,l=r-10),e.save(),e.fillStyle=this._lightenColor(I,1.66),D?e.fillRect(o+.2*r,s-l,.6*r,l):e.fillRect(s,n+.2*i,l,.6*i),u=s,(c=l*(R/x))>l&&(c=l),e.fillStyle=this._lightenColor(I,1.33),D?e.fillRect(o+.2*r,u-c,.6*r,c):e.fillRect(u,n+.2*i,c,.6*i),h=s,(p=l*(b/x))>l&&(p=l),e.fillStyle=I,D?e.fillRect(o+.2*r,h-p,.6*r,p):e.fillRect(h,n+.2*i,p,.6*i),d=s,(f=l*(v/x))>l&&(f=l),e.fillStyle=a,D?e.fillRect(o+.375*r,d-f,.25*r,f):e.fillRect(d,n+.375*i,f,.25*i),T>0&&(g=s,(m=l*(T/x))>l&&(m=l),e.strokeStyle="#3690BF",e.lineWidth=3,e.beginPath(),D?(e.moveTo(o+.5*r,g),e.lineTo(o+.5*r,g-m)):(e.moveTo(g,n+.5*i),e.lineTo(g+m,n+.5*i)),e.stroke()),S>0&&(e.strokeStyle="#CB0000",e.lineWidth=1,e.beginPath(),D?(_=J(s-l*(S/x))-.5,e.moveTo(o+.2*r,_),e.lineTo(o+.8*r,_)):(_=J(s+l*(S/x))-.5,e.moveTo(_,n+.2*i),e.lineTo(_,n+.8*i)),e.stroke()),A>0)for(y=W(x/A),e.strokeStyle="#646464",e.lineWidth=1,w=0;w<=y;w++)e.beginPath(),D?(C=J(s-l/x*A*w)-.5,e.moveTo(o,C),e.lineTo(o+.05*r,C)):(C=J(s+l/x*A*w)-.5,e.moveTo(C,n+i),e.lineTo(C,n+.95*i)),e.stroke();e.restore()}},o}(t),e.BulletSparkline=g,m=function(){return function(e,t){this.key=e,this.value=t}}(),e.SpreadSparklineData=m,(P=e.SpreadSparklineStyle||(e.SpreadSparklineStyle={}))[P.Stacked=1]="Stacked",P[P.Spread=2]="Spread",P[P.Jitter=3]="Jitter",P[P.Poles=4]="Poles",P[P.StackedDots=5]="StackedDots",P[P.Stripe=6]="Stripe",e.SpreadSparklineStyle,_=function(){return function(e,t,o,n,r,i,a){this.spreadData=e,this.showAverage=t,this.scaleStart=o,this.scaleEnd=n,this.style=r,this.colorScheme=i,this.vertical=a}}(),e.SpreadSparklineValue=_,y=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("SPREADSPARKLINE",1,7),o=this;return t.evaluate=function(e){var t,n,r,i=o.getAllValuesFromReference(e[0]),a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=[];if(i!==B&&typeof i!==te&&(i=o._fixValues(i),p=o._toArray(i),3===u))for(t=0,n=p.length;t<n;t++){var d=p[t],f=d.value,g=[],m=K(100,10*f);for(r=0;r<m+f-1;r++)g.push($());d.randomNumbers=g}return new _(p,a,s,l,u,c,h)},t.acceptsReference=function(e){return 0===e},t},o.prototype._fixValues=function(e){for(var t,o=[],n=0,r=0,i=e.length;n<i;n++)t=parseFloat(e[n]),!isNaN(t)&&isFinite(t)&&(o[r++]=t);return o},o.prototype._getAverage=function(e){for(var t,o=0,n=0,r=0,i=e.length;r<i;r++)n+=(t=e[r]).value,o+=t.key*t.value;return 0===n?0:o/n},o.prototype._getMaxValue=function(e){for(var t,o=-Number.MAX_VALUE,n=0,r=e.length;n<r;n++)(t=e[n].value)>o&&(o=t);return o},o.prototype._toArray=function(e){for(var t,o,n,r={},i=0,a=e.length;i<a;i++)r[n=e[i]]?r[n]++:r[n]=1;for(o in t=[],r)t.push(new m(parseFloat(o),r[o]));return t.sort(function(e,t){return e.key-t.key})},o.prototype._isValid=function(e,t){for(var o,n=0,r=t.length;n<r;n++)if((o=t[n])[0]<=e&&e<=o[1])return!1;return!0},o.prototype._getRandomOffsetArray=function(e,t,o,n){for(var r,i=[],a=K(100,10*e),s=0,l=[],u=0;i.length<e;)r=W(n[u++]*t),(s>a||this._isValid(r,l))&&(i.push(r),l.push([r-o,r+o])),s++;return i},o.prototype.paint=function(e,t,o,n,r,i){var a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x=t.spreadData,R=t.showAverage,b=t.scaleStart,T=t.scaleEnd,A=t.style,I=t.colorScheme,D=t.vertical,F=x.length;if(!(F<=0)){for(a=x[0].key,s=x[F-1].key,(b===B||typeof b===te)&&(b=a),(T===B||typeof T===te)&&(T=s),(A===B||typeof A===te)&&(A=4),(I===B||typeof I===te)&&(I="#646464"),D?(l=n+i-5,u=i-10,c=o+5,h=r-10):(l=o+5,u=r-10,c=n+5,h=i-10),e.save(),e.rect(o,n,r,i),e.clip(),e.beginPath(),e.strokeStyle=I,e.fillStyle=I,e.lineWidth=2,f=this._getMaxValue(x),g=0,m=x.length;g<m;g++){var M=x[g],E=M.key,N=M.value;if(D?((p=l-u*(E-b)/(T-b))>l&&(p=l),p<l-u&&(p=l-u)):((p=l+u*(E-b)/(T-b))<l&&(p=l),p>l+u&&(p=l+u)),p=J(p),1===A)(C=N/2*h/f)<.5&&(C=.5),_=c+h/2-C,y=c+h/2+C,e.beginPath(),D?(e.moveTo(_,p),e.lineTo(y,p)):(e.moveTo(p,_),e.lineTo(p,y)),e.stroke();else if(4===A)(C=N*h/f)<1&&(C=1),e.beginPath(),D?(e.moveTo(c,p),e.lineTo(c+C,p)):(e.moveTo(p,c+h),e.lineTo(p,c+h-C)),e.stroke();else if(6===A)e.beginPath(),D?(e.moveTo(c,p),e.lineTo(c+h,p)):(e.moveTo(p,c),e.lineTo(p,c+h)),e.stroke();else for(2,3===A&&(w=this._getRandomOffsetArray(N,h,3,M.randomNumbers)),v=1;v<=N;v++){switch(A){case 2:d=c+h/2-5-(N/2-v)*h/f;break;case 3:d=c+h-5-w[v-1];break;case 5:default:d=c+h-v*h/f}d=J(d),e.beginPath(),D?e.fillRect(d,p,2,2):e.fillRect(p,d,2,2)}}R&&(S=this._getAverage(x),e.strokeStyle="#CB0000",e.beginPath(),D?(p=J(l-u*(S-b)/(T-b)),e.moveTo(c-5,p),e.lineTo(c+h+5,p)):(p=J(l+u*(S-b)/(T-b)),e.moveTo(p,c-5),e.lineTo(p,c+h+5)),e.stroke()),e.restore()}},o}(t),e.SpreadSparkline=y,(L=e.TextOrientation||(e.TextOrientation={}))[L.Horizontal=0]="Horizontal",L[L.Vertical=1]="Vertical",e.TextOrientation,C=function(){return function(e,t,o,n,r,i,a,s,l,u,c,h,p){var d=this;d.points=e,d.colorRange=t,d.labelRange=o,d.maximum=n,d.targetRed=r,d.targetGreen=i,d.targetBlue=a,d.targetYellow=s,d.color=l,d.highlightPosition=u,d.vertical=c,d.textOrientation=h,d.textSize=p}}(),e.StackedSparklineValue=C,w=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("STACKEDSPARKLINE",1,13),o=this;return t.evaluate=function(e){var t=o.getAllValuesFromReference(e[0]),n=o.getAllValuesFromReference(e[1]),r=o.getAllValuesFromReference(e[2]),i=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],f=e[12];return new C(t,n,r,i,a,s,l,u,c,h,p,d,f)},t.acceptsReference=function(e){return 0<=e&&e<=2},t},o.prototype._hasNullOrUndefined=function(e){for(var t,o=0,n=e.length;o<n;o++)if((t=e[o])===B||typeof t===te)return!0;return!1},o.prototype._lightenColor=function(t,o){var n=e._Color.parse(t);return new e.HLSColor(n).getLighterColor(o).toString()},o.prototype._getDefaultColorRange=function(e,t){for(var o=[],n=0;n<t;n++)o.push(this._lightenColor(e,1+n/t));return o},o.prototype._sumPositive=function(e){for(var t,o=0,n=0,r=e.length;n<r;n++)(t=e[n])>0&&(o+=t);return o},o.prototype._getTextColor=function(t){var o=e._Color.parse(t);return o&&o.getBrightness()<127.5?"white":"black"},o.prototype._paintSparkline=function(e,t,o,n,r,i,a){var s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b=t.points,T=t.colorRange,A=t.labelRange,I=t.maximum,D=t.targetRed,F=t.targetGreen,M=t.targetBlue,E=t.targetYellow,N=t.color,O=t.highlightPosition,P=t.vertical,L=t.textOrientation,H=t.textSize;if(b!==B&&typeof b!==te&&!((s=b.length)<=0)){for((N===B||typeof N===te)&&(N="#646464"),(T===B||typeof T===te||T.length!==s||this._hasNullOrUndefined(T))&&(T=this._getDefaultColorRange(N,s)),l=this._sumPositive(b),(I===B||typeof I===te||I<l)&&(I=l),(L===B||typeof L===te)&&(L=0),(H===B||typeof H===te||H<=0)&&(H=10),isNaN(H)||(H*=a._zoomFactor),P?(u=n+i-5,c=i-10,h=o+5,p=r-10):(u=o+5,c=r-10,h=n+5,p=i-10),e.save(),d=u,w=0,v=s;w<v;w++)(C=b[w])<=0||(f=C/I*c,P?(g=o+.15*r,_=.7*r,m=d-f,y=f):(g=d,_=f,m=n+.15*i,y=.7*i),S=w+1===O?"#CB0000":T[w],e.fillStyle=S,e.beginPath(),e.fillRect(g,m,_,y),(x=A&&A[w])&&(e.save(),e.fillStyle=this._getTextColor(S),e.textBaseline="middle",e.textAlign="center",e.font=H+"px Arial",e.rect(g,m,_,y),e.clip(),e.beginPath(),1===L?(e.translate(g+_/2,m),e.rotate(Math.PI/2),e.fillText(x,y/2,0)):e.fillText(x,g+_/2,m+y/2),e.restore()),P?d-=f:d+=f);D!==B&&typeof D!==te&&(D>I&&(D=I),D>0&&(e.beginPath(),P?(R=J(u-D/I*c)-.5,e.moveTo(h,R),e.lineTo(h+p,R)):(R=J(u+D/I*c)-.5,e.moveTo(R,h),e.lineTo(R,h+p)),e.strokeStyle="red",e.stroke())),F!==B&&typeof F!==te&&(F>I&&(F=I),F<0&&(F=0),e.beginPath(),P?(R=J(u-F/I*c)-.5,e.moveTo(h,R),e.lineTo(h+p,R)):(R=J(u+F/I*c)-.5,e.moveTo(R,h),e.lineTo(R,h+p)),e.strokeStyle="green",e.stroke()),M!==B&&typeof M!==te&&(M>I&&(M=I),M<0&&(M=0),e.beginPath(),P?(R=J(u-M/I*c)-.5,e.moveTo(h,R),e.lineTo(h+p,R)):(R=J(u+M/I*c)-.5,e.moveTo(R,h),e.lineTo(R,h+p)),e.strokeStyle="blue",e.stroke()),E!==B&&typeof E!==te&&(E>I&&(E=I),E<0&&(E=0),e.beginPath(),P?(R=J(u-E/I*c)-.5,e.moveTo(h,R),e.lineTo(h+p,R)):(R=J(u+E/I*c)-.5,e.moveTo(R,h),e.lineTo(R,h+p)),e.strokeStyle="yellow",e.stroke()),e.restore()}},o}(t),e.StackedSparkline=w,(H=e.ArrowDirection||(e.ArrowDirection={}))[H.Top=0]="Top",H[H.Right=1]="Right",H[H.Down=2]="Down",H[H.Left=3]="Left",e.ArrowDirection,(k=e.BarSparklineType||(e.BarSparklineType={}))[k.Horizontal=0]="Horizontal",k[k.Vertical=1]="Vertical",e.BarSparklineType,v=function(){return function(e,t,o){this.value=e,this.colorScheme=t,this.type=o}}(),e.BarSparklineBaseValue=v,S=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createCustomFunction=function(t,o){if(!e.util.hasCalc())return B;var n=new e.Calc.Functions.Function(t,1,2),r=this;return n.evaluate=function(e){var t=r.getFirstValueFromReference(e[0]),n=e[1];return new v(t,n,o)},n.acceptsReference=function(e){return 0===e},n},o.prototype.getTextColor=function(t){var o=e._Color.parse(t);return o&&o.getBrightness()<127.5?"white":"black"},o.prototype._fixValue=function(e){return(e=Math.round(e))-.5},o.prototype.paintLine=function(e,t,o,n,r,i){t=this._fixValue(t),o=this._fixValue(o),n=this._fixValue(n),r=this._fixValue(r),e.beginPath(),e.moveTo(t,o),e.lineTo(n,r),e.lineWidth=1,e.strokeStyle=i===B||typeof i===te?"black":i,e.stroke()},o.prototype.paintArrow=function(e,t,o,n,r){var i=this,a=.4*n;t=i._fixValue(t);switch(o=i._fixValue(o),e.beginPath(),e.moveTo(t,o),r){case 0:e.lineTo(i._fixValue(t-a/2),i._fixValue(o+q(3)*a/2)),e.lineTo(i._fixValue(t),i._fixValue(o+a/q(3))),e.lineTo(i._fixValue(t+a/2),i._fixValue(o+q(3)*a/2));break;case 2:e.lineTo(i._fixValue(t-a/2),i._fixValue(o-q(3)*a/2)),e.lineTo(i._fixValue(t),i._fixValue(o-a/q(3))),e.lineTo(i._fixValue(t+a/2),i._fixValue(o-q(3)*a/2));break;case 3:e.lineTo(i._fixValue(t+q(3)*a/2),i._fixValue(o-a/2)),e.lineTo(i._fixValue(t+a/q(3)),i._fixValue(o)),e.lineTo(i._fixValue(t+q(3)*a/2),i._fixValue(o+a/2));break;case 1:e.lineTo(i._fixValue(t-q(3)*a/2),i._fixValue(o-a/2)),e.lineTo(i._fixValue(t-a/q(3)),i._fixValue(o)),e.lineTo(i._fixValue(t-q(3)*a/2),i._fixValue(o+a/2))}e.lineTo(t,o),e.closePath(),e.fillStyle="white",e.fill()},o.prototype.paintRect=function(e,t,o,n,r,i){e.beginPath(),e.rect(J(t),J(o),J(n),J(r)),e.fillStyle=i,e.fill()},o.prototype.paint=function(t,o,n,r,i,a){var s,l,u,c,h,p,d,f,g,m,_,y,C=o.type,w=o.value,v=o.colorScheme,S=!1;try{w=G.D(w)}catch(e){return}w>1?(w=1,S=!0):w<-1&&(w=-1,S=!0),(v===B||typeof v===te)&&(v="grey"),t.save(),0===C?(d=i-10,f=.7*a,w>=0?(S&&(s=new e.Point(n+5+d-5,r+a/2)),l=new e.Rect(n+5,r+a*(1-.7)/2,d*w,f),u=new e.Point(n+5,r+1),c=new e.Point(n+5,r+a),h=1):(g=Q(d*w),S&&(s=new e.Point(n+5+5,r+a/2)),l=new e.Rect(n+i-5-g,r+a*(1-.7)/2,g,f),u=new e.Point(n+i-5,r+1),c=new e.Point(n+i-5,r+a),h=3),p=a):1===C&&(m=a-10,_=.7*i,w>=0?(y=m*w,l=new e.Rect(n+(1-.7)/2*i,r+a-5-y,_,y),S&&(s=new e.Point(n+i/2,r+a-5-y+5),h=0),u=new e.Point(n+1,r+a-5),c=new e.Point(n+i,r+a-5)):(w=Q(w),l=new e.Rect(n+(1-.7)/2*i,r+5,_,m*w),S&&(s=new e.Point(n+i/2,r+5+m-5),h=2),u=new e.Point(n+1,r+5),c=new e.Point(n+i,r+5)),p=i),t.beginPath(),this.paintRect(t,l.x,l.y,l.width,l.height,v),t.save(),t.rect(l.x,l.y,l.width,l.height),t.clip(),s&&this.paintArrow(t,s.x,s.y,p,h),t.restore(),this.paintLine(t,u.x,u.y,c.x,c.y),t.restore()},o}(t),e.BarSparklineBase=S,x=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.createFunction=function(){return this.createCustomFunction("HBARSPARKLINE",0)},t}(S),e.HBarSparkline=x,R=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.createFunction=function(){return this.createCustomFunction("VBARSPARKLINE",1)},t}(S),e.VBarSparkline=R,(V=e.BoxPlotStyle||(e.BoxPlotStyle={}))[V.Classical=0]="Classical",V[V.Neo=1]="Neo",b=e.BoxPlotStyle,T=function(){return function(e,t,o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C){var w=this;w.points=e,w.boxPlotClass=t,w.showAverage=o,w.scaleStart=n,w.scaleEnd=r,w.acceptableStart=i,w.acceptableEnd=a,w.colorScheme=s,w.style=l,w.vertical=u,w.perc02=c,w.perc09=h,w.perc10=p,w.perc90=d,w.perc91=f,w.perc98=g,w.q1=m,w.q3=_,w.median=y,w.stDev=C}}(),e.BoxPlotSparklineValue=T,A=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("BOXPLOTSPARKLINE",1,10),o=this;return t.evaluate=function(e){var t=e[0],n=o.getAllValuesFromReference(t),r=e[1],i=e[2],a=o.getFirstValueFromReference(e[3]),s=o.getFirstValueFromReference(e[4]),l=o.getFirstValueFromReference(e[5]),u=o.getFirstValueFromReference(e[6]),c=e[7],h=e[8],p=e[9],d=o._getPercentitleValue(t,2),f=o._getPercentitleValue(t,9),g=o._getPercentitleValue(t,10),m=o._getPercentitleValue(t,90),_=o._getPercentitleValue(t,91),y=o._getPercentitleValue(t,98),C=o._getPercentitleValue(t,25),w=o._getPercentitleValue(t,75),v=o._getPercentitleValue(t,50),S=o._getStDevpValue(t);return new T(n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S)},t.acceptsReference=function(e){return 0===e},t},o.prototype._fixValues=function(e){for(var t,o=[],n=0,r=0,i=e.length;n<i;n++)t=parseFloat(e[n]),!isNaN(t)&&isFinite(t)&&(o[r++]=t);return o},o.prototype._getPercentitleValue=function(t,o){return G.ref(t)&&!isNaN(o)&&0<=o&&o<=100?e.Calc.Functions._builtInFunctions.PERCENTILE.evaluate([t,o/100]):NaN},o.prototype._getStDevpValue=function(t){return G.ref(G.ref(t))?e.Calc.Functions._builtInFunctions.STDEVP.evaluate([t]):NaN},o.prototype._getAverage=function(e){for(var t=0,o=0,n=e.length;o<n;o++)t+=e[o];return 0===n?0:t/n},o.prototype._getMaxValue=function(e){for(var t,o=-Number.MAX_VALUE,n=0,r=e.length;n<r;n++)(t=e[n])>o&&(o=t);return o},o.prototype._getMinValue=function(e){for(var t,o=Number.MAX_VALUE,n=0,r=e.length;n<r;n++)(t=e[n])<o&&(o=t);return o},o.prototype._paintLine=function(e,t,o,n,r){e.moveTo(J(t),J(o)),e.lineTo(J(n),J(r))},o.prototype._paintRect=function(e,t,o,n,r){e.fillRect(J(t),J(o),J(n),J(r))},o.prototype.paint=function(e,t,o,n,r,i){var a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R=this,T=t.points,A=t.boxPlotClass,I=t.showAverage,D=t.scaleStart,F=t.scaleEnd,M=t.acceptableStart,E=t.acceptableEnd,N=t.style,O=t.colorScheme,P=t.vertical,L=R._getMaxValue(T),H=R._getMinValue(T);if(T!==B&&typeof T!==te&&!((T=R._fixValues(T)).length<=0)){A===B||typeof A!==oe?A="5ns":"5ns"!==(A=A.toLocaleLowerCase())&&"7ns"!==A&&"tukey"!==A&&"bowley"!==A&&"sigma3"!==A&&(A="5ns"),D=parseFloat(D),isNaN(D)&&(D=H),F=parseFloat(F),isNaN(F)&&(F=L),M=parseFloat(M),E=parseFloat(E),(O===B||typeof O!==oe)&&(O="#D2D2D2"),(N===B||b[N]===z)&&(N=0),a="#CB0000",D>H&&(O=a,D=H),F<L&&(O=a,F=L),e.save(),e.rect(o,n,r,i),e.clip(),e.lineWidth=2,P?(h=-1,u=o+5,c=r-10,s=n+5+(l=i-10)):(h=1,s=o+5,u=n+5,l=r-10,c=i-10);var k=t.perc02,V=t.perc09,G=t.perc10,W=t.perc90,j=t.perc91,U=t.perc98,Y=t.q1,X=t.q3,K=(t.median,X-Y),J=H,Z=L,q=1.5*K,$=1.5*K,ee=t.stDev,ne=R._getAverage(T),re=0,ie=0,ae=u+.1*c,se=.7*c,le=Q(F-D);for(p=0,d=T.length;p<d;p++)(f=T[p])<Y&&f>=Y-1.5*K&&f-(Y-1.5*K)<q&&(q=f-(Y-1.5*K),J=f),f>X&&f<=X+1.5*K&&X+1.5*K-f<$&&($=X+1.5*K-f,Z=f),g=!1,"tukey"===A&&(f<=Y-1.5*K||f>=X+1.5*K)&&(g=!0,re=s+h*l*((f-D)/le),ie=f<=Y-3*K||f>=X+3*K?0:1),"7ns"===A&&(f<=k||f>=U)&&(g=!0,re=s+h*l*((f-D)/le),ie=1),"sigma3"===A&&(f<=ne-2*ee||f>=ne+2*ee)&&(g=!0,re=s+h*l*((f-D)/le),ie=f<=ne-3*ee||f>=ne+3*ee?0:1),"#969696",g&&(1===N?(e.beginPath(),e.strokeStyle="#969696",1===ie?P?R._paintLine(e,ae+.2*se,re,ae+.8*se,re):R._paintLine(e,re,ae+.2*se,re,ae+.8*se):P?R._paintLine(e,ae+.3*se,re,ae+.7*se,re):R._paintLine(e,re,ae+.3*se,re,ae+.7*se),e.stroke()):((m=.1*c)<2&&(m=2),e.beginPath(),e.strokeStyle="#969696",P?e.arc(u+.45*c,re,m/2,0,2*Math.PI):e.arc(re,u+.45*c,m/2,0,2*Math.PI),e.stroke()));(D>M||F<E)&&(O="#C0FF00"),D>M&&(M=D),F<E&&(E=F),M!==E&&(M>E&&(O=a),M<E&&(_=s+h*l*((M-D)/le),y=s+h*l*((E-D)/le),e.beginPath(),e.strokeStyle="#646464",C=u+.9*c,P?R._paintLine(e,C,_,C,y):R._paintLine(e,_,C,y,C),e.stroke()));var ue,ce,he=s+h*l*((Y-D)/le),pe=Q(s+h*l*((X-D)/le)-he),de=s+h*l*((t.median-D)/le);switch(A){case"7ns":ue=s+h*l*((k-D)/le),ce=s+h*l*((U-D)/le);break;case"tukey":ue=s+h*l*((J-D)/le),ce=s+h*l*((Z-D)/le);break;case"sigma3":pe=Q(s+h*l*((ne+ee-D)/le)-(he=s+h*l*((ne-ee-D)/le))),de=s+h*l*((ne-D)/le),ue=ne-2*ee>D?s+h*l*((ne-2*ee-D)/le):s+h*l*((H-D)/le),ce=ne+2*ee<F?s+h*l*((ne+2*ee-D)/le):s+h*l*((L-D)/le),I=!1;break;case"5ns":case"bowley":default:ue=s+h*l*((H-D)/le),ce=s+h*l*((L-D)/le)}w="#969696",1===N?(e.fillStyle="#F2F2F2",P?R._paintRect(e,ae,ce,se,ue-ce):R._paintRect(e,ue,ae,ce-ue,se)):(v=u+.45*c,e.beginPath(),e.strokeStyle=w,P?R._paintLine(e,v,ue,v,ce):R._paintLine(e,ue,v,ce,v),e.stroke()),e.fillStyle=O,P?R._paintRect(e,ae,he-pe,se,pe):R._paintRect(e,he,ae,pe,se),e.beginPath(),e.strokeStyle=w,P?R._paintLine(e,ae,de,ae+se,de):R._paintLine(e,de,ae,de,ae+se),e.stroke(),0===N&&(e.beginPath(),e.strokeStyle=w,P?R._paintLine(e,ae+.3*se,ce,ae+.7*se,ce):R._paintLine(e,ce,ae+.3*se,ce,ae+.7*se),e.stroke(),e.beginPath(),P?R._paintLine(e,ae+.3*se,ue,ae+.7*se,ue):R._paintLine(e,ue,ae+.3*se,ue,ae+.7*se),e.stroke()),("7ns"===A||"bowley"===A)&&("7ns"===A?(S=s+h*l*((V-D)/le),x=s+h*l*((j-D)/le)):(S=s+h*l*((G-D)/le),x=s+h*l*((W-D)/le)),e.beginPath(),e.strokeStyle=w,P?R._paintLine(e,ae+.3*se,x,ae+.7*se,x):R._paintLine(e,x,ae+.3*se,x,ae+.7*se),e.stroke(),e.beginPath(),P?R._paintLine(e,ae+.3*se,S,ae+.7*se,S):R._paintLine(e,S,ae+.3*se,S,ae+.7*se),e.stroke()),I&&(re=s+h*l*((ne-D)/le),e.beginPath(),e.strokeStyle=a,P?R._paintLine(e,ae+.2*se,re,ae+.8*se,re):R._paintLine(e,re,ae+.2*se,re,ae+.8*se),e.stroke()),e.restore()}},o}(t),e.BoxPlotSparkline=A,I=function(){return function(e,t,o,n,r,i,a,s,l,u){this.variance=e,this.reference=t,this.mini=o,this.maxi=n,this.mark=r,this.tickUnit=i,this.legend=a,this.colorPositive=s,this.colorNegative=l,this.vertical=u}}(),e.VariSparklineValue=I,D=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype._getPercentage=function(e){var t,o,n=parseFloat(e);if(!isNaN(n))return(o=(t=n.toString()).substr(t.indexOf(".")+1).length)>=2?(100*n).toFixed(o-2)+"%":(100*n).toFixed(0)+"%"},o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("VARISPARKLINE",1,10),o=this;return t.evaluate=function(e){var t=o.getFirstValueFromReference(e[0]),n=o.getFirstValueFromReference(e[1]),r=o.getFirstValueFromReference(e[2]),i=o.getFirstValueFromReference(e[3]),a=o.getFirstValueFromReference(e[4]),s=o.getFirstValueFromReference(e[5]),l=e[6],u=e[7],c=e[8],h=e[9];return new I(t,n,r,i,a,s,l,u,c,h)},t.acceptsReference=function(e){return e>=0&&e<=5},t},o.prototype._paintSparkline=function(e,t,o,n,r,i,a){var s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I,D=this,F=t.variance,M=t.reference,E=t.mini,N=t.maxi,O=t.mark,P=t.tickUnit,L=t.legend,H=t.colorPositive,k=t.colorNegative,V=t.vertical,z=!1,W=13*a._zoomFactor;try{F=G.D(F)}catch(e){return}(k===B||typeof k===te)&&(k="red"),(H===B||typeof H===te)&&(H="green"),(P===B||typeof P===te)&&(P=0),f=O!==B&&typeof O!==te,(N===B||typeof N===te)&&(N=1),(E===B||typeof E===te)&&(E=-1),M===B||typeof M===te?(M=0,d=!1):d=!0,V?(s=n+i-5,o+10,u=r-20,l=i-10,c=-1):(s=o+5,n+10,l=r-10,u=i-20,c=1),L&&(h=D._getPercentage(t.variance)),F>N&&(F=N,z=!0),F<E&&(F=E,z=!0),M>N&&(M=N),M<E&&(M=E),z&&(p=u<15?15:u>60?60:u);var j=Q(N-E),U=l/j,Y=s+c*Q(E-M)*U,X=Q(F-M)*U;if(X>Q(j)*U&&(X=Q(j+E)*U),g=s+c*l,(!V||!(Y<g))&&(V||!(Y>g))){if(e.save(),e.rect(o,n,r,i),e.clip(),F>M?(V?(m=o+.25*r,_=Y-X,y=.5*r,C=X,D.paintRect(e,m,_,y,C,H)):(m=Y,_=n+.25*i,y=X,C=.5*i,D.paintRect(e,m,_,y,C,H)),z&&(e.save(),e.rect(m,_,y,C),e.clip(),V?D.paintArrow(e,o+r/2,s-l+5,p,0):D.paintArrow(e,s+l-5,n+i/2,p,1),e.restore()),L&&(w=0,x=Q(N-F)*U,z&&(w=.4*p*q(3)/2+5+2),e.save(),e.beginPath(),e.font=W+"px Arial",e.fillStyle="black",V?(e.textAlign="center",W+X-(Y-n)>0?x>=X?e.textBaseline="bottom":(e.rect(m,_,y,C),e.clip(),e.textBaseline="top",e.fillStyle=D.getTextColor(H)):e.textBaseline="bottom",S=Y-X+w,e.fillText(h,o+r/2,S)):(e.textBaseline="middle",e.measureText(h).width+X-(o+r-Y)>0?x>=X?e.textAlign="left":(e.rect(m,_,y,C),e.clip(),e.textAlign="right",e.fillStyle=D.getTextColor(H)):e.textAlign="left",v=Y+X-w,e.fillText(h,v,n+i/2)),e.restore())):(X>Q(j)*U&&(X=Q(j+E)*U,Y=s),V?(m=o+.25*r,_=Y,y=.5*r,C=X,D.paintRect(e,m,_,y,C,k)):(m=Y-X,_=n+.25*i,y=X,C=.5*i,D.paintRect(e,m,_,y,C,k)),z&&(e.save(),e.rect(m,_,y,C),e.clip(),V?D.paintArrow(e,o+r/2,s-5,p,2):D.paintArrow(e,s+5,n+i/2,p,3),e.restore()),L&&(w=0,x=Q(E-F)*U,z&&(w=.4*p*q(3)/2+5+2),e.save(),e.beginPath(),e.font=W+"px Arial",e.fillStyle="black",V?(e.textAlign="center",W+X-(n+i-Y)>0?x>=X?e.textBaseline="top":(e.rect(m,_,y,C),e.clip(),e.textBaseline="bottom",e.fillStyle=D.getTextColor(k)):e.textBaseline="top",S=Y+X-w,e.fillText(h,o+r/2,S)):(e.textBaseline="middle",e.measureText(h).width+X-(Y-o)>0?x>=X?e.textAlign="right":(e.rect(m,_,y,C),e.clip(),e.textAlign="left",e.fillStyle=D.getTextColor(k)):e.textAlign="right",v=Y-X+w,e.fillText(h,v,n+i/2)),e.restore())),d&&(R=s+c*Math.abs(E-M)*U,V?D.paintLine(e,o,R,o+r,R):D.paintLine(e,R,n,R,n+i)),P>0)for(e.beginPath(),b=j/P,T=0;T<=b;T++)A=s+l/b*T*c,V?D.paintLine(e,o,A,o+.1*r,A,"#969696"):D.paintLine(e,A,n+.9*i,A,n+i,"#969696");f&&E<=O&&O<=N&&(e.beginPath(),I=0,V?(I=s-Q(E-O)*U,D.paintLine(e,o,I,o+.33*r,I,"#CB0000")):(I=s+Q(E-O)*U,D.paintLine(e,I,n+.66*i,I,n+i,"#CB0000")),e.fill()),e.restore()}},o}(S),e.VariSparkline=D,F=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.lightenColor=function(t,o){var n=e._Color.parse(t);return new e.HLSColor(n).getLighterColor(o).toString()},o.prototype.paintLine=function(e,t,o,n,r){t=J(t),o=J(o),t===(n=J(n))&&(t=n-=.5),o===(r=J(r))&&(o=r-=.5),e.moveTo(t,o),e.lineTo(n,r)},o.prototype.paintRect=function(e,t,o,n,r){var i=J(t+n),a=J(o+r);t=J(t),o=J(o),n=J(i-t),r=J(a-o),e.fillRect(t,o,n,r)},o.prototype._getTextColor=function(t){var o=e._Color.parse(t);return o&&o.getBrightness()<127.5?"white":"black"},o.prototype.paintLabel=function(e,t,o,n,r,i){var a,s,l,u=i.labelText,c=i.fontSize,h=i.startBox,p=i.endBox,d=i.boxColor,f=i.isInRightOrTopOfBox;e.save(),e.beginPath(),e.font=c+"px Arial",e.fillStyle="black",i.vertical?(e.textAlign="center",f?c+p-(h-o)>0&&h-p-o<p?(e.textBaseline="top",e.fillStyle=this._getTextColor(d),s=h-p+1,e.rect(t,h-p,n,p),e.clip()):(e.textBaseline="bottom",s=h-p-1):c-(o+r-h)>0&&o+r-h<p?(e.textBaseline="bottom",e.fillStyle=this._getTextColor(d),s=h-1,e.rect(t,h-p,n,p),e.clip()):(e.textBaseline="top",s=h+1),e.fillText(u,t+n/2,s)):(e.textBaseline="middle",l=e.measureText(u),f?l.width+p-(t+n-h)>0&&t+n-(h+p)<p?(e.textAlign="right",e.fillStyle=this._getTextColor(d),a=h+p-1,e.rect(h,o,p,r),e.clip()):(e.textAlign="left",a=h+p+1):l.width-(h-t)>0&&h-t<p?(e.textAlign="left",e.fillStyle=this._getTextColor(d),a=h+1,e.rect(h,o,p,r),e.clip()):(e.textAlign="right",a=h-1),e.fillText(u,a,o+r/2)),e.restore()},o}(t),e.AccumulateSparklineBase=F,M=function(){return function(e,t,o,n,r,i,a,s){this.points=e,this.labels=o,this.pointIndex=t,this.minimum=n,this.maximum=r,this.colorPositive=i,this.colorNegative=a,this.vertical=s}}(),e.CascadeSparklineValue=M,E=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("CASCADESPARKLINE",1,8),o=this;return t.evaluate=function(e){var t=o.getAllValuesFromReference(e[0]),n=o.getFirstValueFromReference(e[1]),r=o.getAllValuesFromReference(e[2]),i=o.getFirstValueFromReference(e[3]),a=o.getFirstValueFromReference(e[4]),s=e[5],l=e[6],u=e[7];return new M(t,n,r,i,a,s,l,u)},t.acceptsReference=function(e){return 0===e||2===e},t.acceptsArray=function(e){return 0===e||2===e},t},o.prototype._paintSparkline=function(e,t,o,n,r,i,a){var s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R=this,b=t.points,T=t.labels,A=t.pointIndex,I=t.minimum,D=t.maximum,F=t.colorPositive,M=t.colorNegative,E=t.vertical,N=13*a._zoomFactor;if(!(b===B||b===z||(s=b.length,s<=0)||((T===B||T===z)&&(T=[]),A=parseInt(A),isNaN(A)||A<=0||A>s))){(F===B||typeof F!==oe)&&(F="#8CBF64"),(M===B||typeof M!==oe)&&(M="#D6604D");var O=F,P=R.lightenColor(F,1.3),L=M,H=R.lightenColor(M,1.3),k=1,V=0,G=0,W=0,j=0,U=[],Y=0;for(l=0,u=b.length;l<u;l++)c=b[l],U[k]=[],h=U[k],isNaN(c)?(h[0]=0,h[1]=V,h[2]=0,h[3]=k):(h[0]=Q(c),V=c+V,c>0?(h[1]=G,h[2]=c,h[3]=k):(h[1]=V,h[2]=c,h[3]=k)),G<W&&(W=G),G>j&&(j=G),k===s&&(Y=W<0?-W:0,h[1]=c>0?0:c),G=c+G,k++;V-=c,I=parseFloat(I),isNaN(I)||I>0||I>W?(p=W,I=W):(p=I,Y=-I),D=parseFloat(D),isNaN(D)||D<0||D<j?(d=j,D=j):(d=D,Y=-I),E?(y=-1,m=o+5,_=r-10,f=n+5+(g=i-10)):(y=1,f=o+5,m=n+5,g=r-10,_=i-10),C=g/(d-p),e.save(),e.rect(o,n,r,i),e.clip(),e.beginPath(),e.lineWidth=1;var X,K=U[A],J=K[2],Z=f+y*(K[1]+Y)*C,q=K[0]*C;X=J>=0?1===A||A===s?O:P:1===A||A===s?L:H,e.beginPath(),e.fillStyle=X,E?R.paintRect(e,m,Z-q,_,q):R.paintRect(e,Z,m,q,_),e.beginPath(),e.strokeStyle="#DCDCDC",E?(1!==A&&(A!==s?J>0?R.paintLine(e,o,Z,m+_,Z):R.paintLine(e,o,Z-q,m+_,Z-q):(w=f-(V+Y)*C,R.paintLine(e,o,w,m+_,w)),e.stroke()),A!==s&&(J>0?R.paintLine(e,m,Z-q,o+r,Z-q):R.paintLine(e,m,Z,o+r,Z),e.stroke())):(1!==A&&(A!==s?J>0?R.paintLine(e,Z,n,Z,m+_):R.paintLine(e,Z+q,n,Z+q,m+_):(v=f+(V+Y)*C,R.paintLine(e,v,n,v,m+_)),e.stroke()),A!==s&&(J>0?R.paintLine(e,Z+q,m,Z+q,n+i):R.paintLine(e,Z,m,Z,n+i),e.stroke())),S=T[A-1],T.length>0&&S!==B&&S!==z&&""!==S&&(x={labelText:S,vertical:E,isInRightOrTopOfBox:J>0,fontSize:N,startBox:Z,endBox:q,boxColor:X},R.paintLabel(e,o,n,r,i,x)),e.beginPath(),e.strokeStyle="black",E?R.paintLine(e,o,f-Y*C,o+r,f-Y*C):R.paintLine(e,f+Y*C,n,f+Y*C,n+i),e.stroke(),e.restore()}},o}(F),e.CascadeSparkline=E,N=function(){return function(e,t,o,n,r,i,a,s){this.points=e,this.pointIndex=t,this.colorRange=o,this.target=n,this.target2=r,this.highlightPosition=i,this.label=a,this.vertical=s}}(),e.ParetoSparklineValue=N,O=function(t){function o(){t.call(this)}return __extends(o,t),o.prototype.createFunction=function(){if(!e.util.hasCalc())return B;var t=new e.Calc.Functions.Function("PARETOSPARKLINE",1,8),o=this;return t.evaluate=function(e){var t=o.getAllValuesFromReference(e[0]),n=o.getFirstValueFromReference(e[1]),r=o.getAllValuesFromReference(e[2]),i=o.getFirstValueFromReference(e[3]),a=o.getFirstValueFromReference(e[4]),s=o.getFirstValueFromReference(e[5]),l=e[6],u=e[7];return new N(t,n,r,i,a,s,l,u)},t.acceptsReference=function(e){return 0===e||2===e},t.acceptsArray=function(e){return 0===e||2===e},t},o.prototype._paintSparkline=function(e,t,o,n,r,i,a){var s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R=t.points,b=t.pointIndex,T=t.colorRange,A=t.target,I=t.target2,D=t.highlightPosition,F=t.label,M=t.vertical,E=13*a._zoomFactor;if(!(R===B||R===z||(s=R.length,s<=0)||((T===B||T===z)&&(T=[]),b=parseInt(b),isNaN(b)||b<=0||b>s))){A=parseFloat(A),isNaN(A)&&(A=0),A<0&&(A=0),A>1&&(A=1),I=parseFloat(I),isNaN(I)&&(I=0),I<0&&(I=0),I>1&&(I=1),F=parseInt(F),isNaN(F)&&(F=0);var N=1,O=0,P=[];for(l=0,u=R.length;l<u;l++)c=R[l],P[N]=[],h=P[N],c<0||isNaN(c)||c===B||c===z?1===N?(h[0]=0,h[1]=0):(h[0]=O,h[1]=0):(O+=c,1===N?(h[0]=0,h[1]=c):(h[0]=O-c,h[1]=c)),N++;M?(m=-1,f=o+5,g=r-10,p=n+5+(d=i-10)):(m=1,p=o+5,f=n+5,d=r-10,g=i-10),_=d/O,e.save(),e.rect(o,n,r,i),e.clip(),e.beginPath(),e.lineWidth=1;var L,H=P[b],k=H[1],V=p+m*H[0]*_,G=H[1]*_;L=b===D?"#CB0000":0===T.length||typeof T[b-1]!==oe?"#969696":T[b-1],e.beginPath(),e.fillStyle=L,M?this.paintRect(e,f,V-G,g,G):this.paintRect(e,V,f,G,g),1===F?y=(H[0]+k)/O*1e3:2===F&&(y=k/O*1e3),C=J(y)/10+"%",w=(H[0]+H[1])*_<d/2,(1===F||2===F)&&""!==C&&(v={labelText:C,vertical:M,isInRightOrTopOfBox:w,fontSize:E,startBox:V,endBox:G,boxColor:L},this.paintLabel(e,o,n,r,i,v)),0!==A&&(e.beginPath(),e.strokeStyle="#8CBF64",S=ee(p+m*d*A),M?this.paintLine(e,o,S,o+r,S):this.paintLine(e,S,n,S,n+i),e.stroke()),0!==I&&(e.beginPath(),e.strokeStyle="#EE5D5D",x=ee(p+m*d*I),M?this.paintLine(e,o,x,o+r,x):this.paintLine(e,x,n,x,n+i),e.stroke()),e.restore()}},o}(F),e.ParetoSparkline=O}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){var t,o,n,r,i,a;e.feature("comment",["core.common","core.sheet_action"]);var s,l,u=null,c=void 0,h="mousewheel",p="DOMMouseScroll",d=Math.max,f=Math.min,g=Math.floor,m=Math.atan2,_=Math.abs;(s=e.DisplayMode||(e.DisplayMode={}))[s.AlwaysShown=1]="AlwaysShown",s[s.HoverShown=2]="HoverShown",t=e.DisplayMode,o=function(){function e(e,t,o,n){this.left=0,this.top=0,this.right=0,this.bottom=0;1===arguments.length?this.top=this.right=this.bottom=this.left=e:4===arguments.length&&(this.top=e,this.right=t,this.bottom=o,this.left=n)}return e.prototype.toString=function(){return this.top+"px "+this.right+"px "+this.bottom+"px "+this.left+"px"},e}(),e.Padding=o,(l=e.ResizeDirection||(e.ResizeDirection={}))[l.TopLeft=0]="TopLeft",l[l.TopRight=1]="TopRight",l[l.BottomLeft=2]="BottomLeft",l[l.BottomRight=3]="BottomRight",l[l.MiddleLeft=4]="MiddleLeft",l[l.MiddleRight=5]="MiddleRight",l[l.TopCenter=6]="TopCenter",l[l.BottomCenter=7]="BottomCenter",e.ResizeDirection,n=function(){function n(){var t=this;t._defaultLocation=new e.Point(9,-18),t._text="",t._location=t._defaultLocation.clone(),t._displayMode=2,t._commentState=3,t._width=160,t._height=100,t._fontFamily="Arial",t._fontStyle="normal",t._fontSize="9pt",t._fontWeight="normal",t._textDecoration=0,t._foreColor="black",t._backColor="#FFFFE1",t._opacity=1,t._locked=!0,t._lockText=!0,t._dynamicMove=!0,t._dynamicSize=!0,t._horizontalAlign=0,t._autoSize=!1,t._borderWidth=1,t._borderStyle="solid",t._borderColor="black",t._padding=u,t._zIndex=-1,t._showShadow=!1,t._timeout=u,t._rowIndex=-1,t._colIndex=-1,t._sheet=u,t._ignoreDefaultLocation=!1}return n.prototype.text=function(e){return 0===arguments.length?this._text:("string"==typeof e&&this._text!==e&&this._changeProperty("text",e),this)},n.prototype.location=function(t){return 0===arguments.length?this._location:(t instanceof e.Point&&this._location!==t&&this._changeProperty("location",t),this)},n.prototype.width=function(e){return 0===arguments.length?this._width:("number"==typeof e&&e>0&&this._width!==e&&(this._autoSize=!1,this._changeProperty("width",e)),this)},n.prototype.height=function(e){return 0===arguments.length?this._height:("number"==typeof e&&e>0&&this._height!==e&&(this._autoSize=!1,this._changeProperty("height",e)),this)},n.prototype.fontFamily=function(e){return 0===arguments.length?this._fontFamily:("string"==typeof e&&this._fontFamily!==e&&this._changeProperty("fontFamily",e),this)},n.prototype.fontStyle=function(e){return 0===arguments.length?this._fontStyle:("string"==typeof e&&this._fontStyle!==e&&this._changeProperty("fontStyle",e),this)},n.prototype.fontSize=function(e){return 0===arguments.length?this._fontSize:("string"==typeof e&&this._fontSize!==e&&this._changeProperty("fontSize",e),this)},n.prototype.fontWeight=function(e){return 0===arguments.length?this._fontWeight:("string"==typeof e&&this._fontWeight!==e&&this._changeProperty("fontWeight",e),this)},n.prototype.textDecoration=function(e){return 0===arguments.length?this._textDecoration:(this._textDecoration!==e&&this._changeProperty("textDecoration",e),this)},n.prototype.foreColor=function(e){return 0===arguments.length?this._foreColor:("string"==typeof e&&this._foreColor!==e&&this._changeProperty("foreColor",e),this)},n.prototype.locked=function(e){return 0===arguments.length?this._locked:("boolean"==typeof e&&this._locked!==e&&this._changeProperty("locked",e),this)},n.prototype.lockText=function(e){return 0===arguments.length?this._lockText:("boolean"==typeof e&&this._lockText!==e&&this._changeProperty("lockText",e),this)},n.prototype.horizontalAlign=function(t){return 0===arguments.length?this._horizontalAlign:(e.HorizontalAlign[t]!==c&&this._horizontalAlign!==t&&this._changeProperty("horizontalAlign",t),this)},n.prototype.autoSize=function(e){return 0===arguments.length?this._autoSize:("boolean"==typeof e&&this._autoSize!==e&&this._changeProperty("autoSize",e),this)},n.prototype.dynamicSize=function(e){if(0===arguments.length)return this._dynamicSize;if("boolean"==typeof e&&this._dynamicSize!==e){if(!0===e&&!1===this._dynamicMove)return this;this._changeProperty("dynamicSize",e)}return this},n.prototype.dynamicMove=function(e){return 0===arguments.length?this._dynamicMove:("boolean"==typeof e&&this._dynamicMove!==e&&(!1===e&&!0===this._dynamicSize&&(this._dynamicSize=!1),this._changeProperty("dynamicMove",e)),this)},n.prototype.backColor=function(e){return 0===arguments.length?this._backColor:("string"==typeof e&&this._backColor!==e&&this._changeProperty("backColor",e),this)},n.prototype.opacity=function(e){return 0===arguments.length?this._opacity:("number"==typeof e&&e>=0&&e<=1&&this._opacity!==e&&this._changeProperty("opacity",e),this)},n.prototype.borderWidth=function(e){return 0===arguments.length?this._borderWidth:("number"==typeof e&&e>0&&this._borderWidth!==e&&this._changeProperty("borderWidth",e),this)},n.prototype.borderStyle=function(e){return 0===arguments.length?this._borderStyle:("string"==typeof e&&this._borderStyle!==e&&this._changeProperty("borderStyle",e),this)},n.prototype.borderColor=function(e){return 0===arguments.length?this._borderColor:("string"==typeof e&&this._borderColor!==e&&this._changeProperty("borderColor",e),this)},n.prototype.padding=function(e){return 0===arguments.length?this._padding:((e===u||e instanceof o)&&this._padding!==e&&this._changeProperty("padding",e),this)},n.prototype.showShadow=function(e){return 0===arguments.length?this._showShadow:("boolean"==typeof e&&this._showShadow!==e&&this._changeProperty("showShadow",e),this)},n.prototype.displayMode=function(e){return 0===arguments.length?this._displayMode:(t[e]!==c&&this._displayMode!==e&&this._changeProperty("displayMode",e),this)},n.prototype.commentState=function(t){return 0===arguments.length?this._commentState:(e.CommentState[t]!==c&&this._commentState!==t&&this._changeProperty("commentState",t),this)},n.prototype.zIndex=function(e){return 0===arguments.length?this._zIndex:("number"==typeof e&&this._zIndex!==e&&this._changeProperty("zIndex",e),this)},n.prototype.ignoreDefaultLocation=function(e){return 0===arguments.length?this._ignoreDefaultLocation:("boolean"==typeof e&&this._ignoreDefaultLocation!==e&&(this._ignoreDefaultLocation=e),this)},n.prototype._changeProperty=function(e,t){var o=this,n=o._sheet,r="_"+e;n?n._bindToAutoRefresh(function(e){o.hasOwnProperty(r)&&(o[r]=e)})(t):o.hasOwnProperty(r)&&(o[r]=t),this._sheet&&this._sheet.triggerCommentChanged({sheet:n,sheetName:n?n._name:"",comment:o,propertyName:e})},n.prototype.clone=function(){var t=this,r=new n;return r._text=t._text,r._location=new e.Point(t._location.x,t._location.y),t._defaultLocation&&(r._defaultLocation=new e.Point(t._defaultLocation.x,t._defaultLocation.y)),r._width=t._width,r._height=t._height,r._fontFamily=t._fontFamily,r._fontStyle=t._fontStyle,r._fontSize=t._fontSize,r._fontWeight=t._fontWeight,r._textDecoration=t._textDecoration,r._foreColor=t._foreColor,r._locked=t._locked,r._lockText=t._lockText,r._horizontalAlign=t._horizontalAlign,r._autoSize=t._autoSize,r._dynamicMove=t._dynamicMove,r._dynamicSize=t._dynamicSize,r._backColor=t._backColor,r._opacity=t._opacity,r._borderWidth=t._borderWidth,r._borderStyle=t._borderStyle,r._borderColor=t._borderColor,t._padding&&(r._padding=new o(t._padding.top,t._padding.right,t._padding.bottom,t._padding.left)),r._showShadow=t._showShadow,r._displayMode=t._displayMode,r._commentState=t._commentState,r._sheet=t._sheet,r._rowIndex=t._rowIndex,r._colIndex=t._colIndex,r._zIndex=t._zIndex,r._ignoreDefaultLocation=t._ignoreDefaultLocation,r},n.prototype.toJSON=function(){var e,t,o=this,n={text:o._text,location:o._location,displayMode:o._displayMode,commentState:o._commentState,width:o._width,height:o._height,fontFamily:o._fontFamily,fontStyle:o._fontStyle,fontSize:o._fontSize,fontWeight:o._fontWeight,textDecoration:o._textDecoration,foreColor:o._foreColor,backColor:o._backColor,opacity:o._opacity,locked:o._locked,lockText:o._lockText,dynamicMove:o._dynamicMove,dynamicSize:o._dynamicSize,horizontalAlign:o._horizontalAlign,autoSize:o._autoSize,borderWidth:o._borderWidth,borderStyle:o._borderStyle,borderColor:o._borderColor,padding:o._padding,zIndex:o._zIndex,showShadow:o._showShadow,rowIndex:o._rowIndex,colIndex:o._colIndex,ignoreDefaultLocation:o._ignoreDefaultLocation},r={};for(e in n)t=n[e],o._isDefaultValue(e,t)||(r[e]=t);return r},n.prototype._isDefaultValue=function(e,t){switch(e){case"text":return""===t;case"location":return 9===t.x&&-18===t.y;case"displayMode":return 2===t;case"commentState":return 3===t;case"width":return 160===t;case"height":return 100===t;case"fontFamily":return"Arial"===t;case"fontStyle":return"normal"===t;case"fontSize":return"9pt"===t;case"fontWeight":return"normal"===t;case"textDecoration":return 0===t;case"foreColor":return"black"===t;case"backColor":return"#FFFFE1"===t;case"opacity":return 1===t;case"locked":case"lockText":case"dynamicMove":case"dynamicSize":return!0===t;case"horizontalAlign":return 0===t;case"autoSize":return!1===t;case"borderWidth":return 1===t;case"borderStyle":return"solid"===t;case"borderColor":return"black"===t;case"padding":return null===t;case"zIndex":return-1===t;case"showShadow":return!1===t;case"rowIndex":case"colIndex":return-1===t;case"ignoreDefaultLocation":return!1===t;default:return!1}},n.prototype.fromJSON=function(t,n){var r,i,a;t&&(r=this,t.text!==c&&(r._text=t.text),(i=t.location)!==c&&(r._location=new e.Point(i.x,i.y)),t.displayMode!==c&&(r._displayMode=t.displayMode),t.commentState!==c&&(r._commentState=t.commentState),t.width!==c&&(r._width=t.width),t.height!==c&&(r._height=t.height),t.fontFamily!==c&&(r._fontFamily=t.fontFamily),t.fontStyle!==c&&(r._fontStyle=t.fontStyle),t.fontSize!==c&&(r._fontSize=t.fontSize),t.fontWeight!==c&&(r._fontWeight=t.fontWeight),t.textDecoration!==c&&(r._textDecoration=t.textDecoration),t.foreColor!==c&&(r._foreColor=t.foreColor),t.backColor!==c&&(r._backColor=t.backColor),t.opacity!==c&&(r._opacity=t.opacity),t.locked!==c&&(r._locked=t.locked),t.lockText!==c&&(r._lockText=t.lockText),t.dynamicMove!==c&&(r._dynamicMove=t.dynamicMove),t.dynamicSize!==c&&(r._dynamicSize=t.dynamicSize),t.horizontalAlign!==c&&(r._horizontalAlign=t.horizontalAlign),t.autoSize!==c&&(r._autoSize=t.autoSize),t.borderWidth!==c&&(r._borderWidth=t.borderWidth),t.borderStyle!==c&&(r._borderStyle=t.borderStyle),t.borderColor!==c&&(r._borderColor=t.borderColor),(a=t.padding)!==c&&(r._padding=new o(a.top,a.right,a.bottom,a.left)),t.zIndex!==c&&(r._zIndex=t.zIndex),t.showShadow!==c&&(r._showShadow=t.showShadow),t.rowIndex!==c&&(r._rowIndex=t.rowIndex),t.colIndex!==c&&(r._colIndex=t.colIndex),t.ignoreDefaultLocation!==c&&(r._ignoreDefaultLocation=t.ignoreDefaultLocation))},n}(),e.Comment=n,r=function(){function t(t,o){var n,r,i;this._rowViewportIndex=1,this._columnViewportIndex=1,n=this,r=t&&t._sheet,n._comment=t,n._updateCommentViewportIndex(),n._zoomFactor=r._zoomFactor,n._commentManager=o,n._editor=o._editorDom,n._init(),i=n._getAdjustedCommentRect(n._getAbsLocation(),t.width(),t.height()),n._absLocation=new e.Point(i.x,i.y),n._updateStartCoordinate(),n._updateEndCoordinate()}return t.prototype._init=function(){var t,o=this;o._commentLayoutPanel=u,o._floatBlockCanvasContainer=u,o._floatBlockCanvas=u,o._hostContainer=u,o._host=u,o._lineCanvasContainer=u,o._lineCanvas=u,o._floatBlockCanvasContainerClassName="gc-spread-floatBlockCanvas-container",o._floatBlockCanvasClassName="gc-spread-floatBlockCanvas",o._hostContainerClassName="gc-spread-host-container",o._hostClassName="gc-spread-host",o._lineCanvasContainerClassName="gc-spread-lineCanvas-container",o._lineCanvasClassName="gc-spread-lineCanvas",o._floatBlockCanvasContainer=document.createElement("div"),e.GC$(o._floatBlockCanvasContainer).addClass(o._floatBlockCanvasContainerClassName).css("position","absolute").css("overflow","hidden").css("box-sizing","content-box"),o._floatBlockCanvas=document.createElement("canvas"),e.DPIHelper.adjustDevicePixel(o._floatBlockCanvas,null,o._commentManager._sheet),e.GC$(o._floatBlockCanvas).addClass(o._floatBlockCanvasClassName).css("left",0).css("top",0).css("position","absolute"),o._hostContainer=document.createElement("div"),e.GC$(o._hostContainer).addClass(o._hostContainerClassName).css("position","absolute").css("overflow","hidden").css("box-sizing","content-box"),o._host=document.createElement("div"),e.GC$(o._host).addClass(o._hostClassName+" no-user-select").css("left",0).css("top",0).css("width","100%").css("height","100%").css("position","absolute").css("word-wrap","break-word").css("word-break","normal").css("white-space","pre-wrap").css("overflow","hidden").css("box-sizing","content-box").attr("unselectable","on"),e.GC$(o._hostContainer).append(o._host),e.GC$(o._floatBlockCanvasContainer).append(o._floatBlockCanvas).append(o._hostContainer),o._lineCanvasContainer=document.createElement("div"),e.GC$(o._lineCanvasContainer).addClass(o._lineCanvasContainerClassName).css("position","absolute").css("overflow","hidden"),o._lineCanvas=document.createElement("canvas"),e.DPIHelper.adjustDevicePixel(o._lineCanvas,null,o._commentManager._sheet),e.GC$(o._lineCanvas).addClass(o._lineCanvasClassName).css("left",0).css("right",0).css("position","absolute"),e.GC$(o._lineCanvasContainer).append(o._lineCanvas),o._adornerDrawState=u,o._resizeHitRects=[],o._hostMargin=7,o._isMoving=!1,o._isResizing=!1,t=o._comment._sheet,e.features.touch&&(o._touchManager=new e.CommentTouchManager(o._floatBlockCanvas,o,t.parent._touchEventProvider),o._touchManager.attach(),o._touchContentManager=new e.CommentContentTouchManager(o._host,o,t.parent._touchEventProvider),o._touchContentManager.attach())},t.prototype.open=function(){var e=this,t=e._comment._sheet;(e._commentLayoutPanel||(t&&(e._commentLayoutPanel=t._commentRender._commentLayoutPanel),e._commentLayoutPanel))&&(e._commentLayoutPanel.appendChild(e._lineCanvasContainer),e._attachLineCanvasEventHandler(),e._commentLayoutPanel.appendChild(e._floatBlockCanvasContainer),e._attachFloatBlockCanvasEventHandler(),e._attachHostContainerEventHandler(),e.isEditing()?e._attachEditorEventHandler():e._attachHostEventHandler(),e._absLocation=e._getAbsLocation(),e.updateLayout())},t.prototype.close=function(){var t=this;t._floatBlockCanvasContainer&&t._lineCanvasContainer&&t._commentLayoutPanel&&(t._detachFloatBlockCanvasEventHandler(),t._detachHostContainerEventHandler(),t._detachHostEventHandler(),t._detachLineCanvasEventHandler(),t._detachEditorEventHandler(),e.GC$(t._floatBlockCanvasContainer).remove(),e.GC$(t._lineCanvasContainer).remove())},t.prototype.getComment=function(){return this._comment},t.prototype._getActualWidth=function(){return this._comment.width()*this._zoomFactor},t.prototype._getActualHeight=function(){return this._comment.height()*this._zoomFactor},t.prototype._getAbsLocation=function(){var e=this._comment;return e!==this._commentManager.getHoverShownComment()||3!==e.commentState()||e.ignoreDefaultLocation()?this._convertRelLocationToAbsLocation(e.location()):this._convertRelLocationToAbsLocation(e._defaultLocation)},t.prototype._convertRelLocationToAbsLocation=function(t){var o,n,r=this._comment,i=r&&r._sheet,a=this._zoomFactor,s=new e.Point(0,0);return i&&(null!==(o=this._getCellRect(i,r._rowIndex,r._colIndex,this._rowViewportIndex,this._columnViewportIndex)).x&&void 0!==o.x&&null!==o.y&&void 0!==o.y&&o.width&&o.height&&(n=i._getSheetLayout(),s.x=o.x+o.width+t.x*a-n.rowHeaderWidth,s.y=o.y+t.y*a-n.colHeaderHeight)),s},t.prototype._getCellRect=function(t,o,n,r,i){for(var a,s,l=new e.Rect(0,0,0,0),h=t._getSheetLayout(),p=t.getViewportTopRow(r),g=t.getViewportLeftColumn(i),m=f(p,o),_=d(p,o),y=f(g,n),C=d(g,n),w=0,v=0,S=this._zoomFactor,x=m;x<_;x++)v+=t.getRowHeight(x,3)*S;for(s=y;s<C;s++)w+=t.getColumnWidth(s,3)*S;if(l.y=o>=p?v:-v,l.x=n>=g?w:-w,(a=t.getSpan(o,n))!=c&&a!=u){for(x=0;x<a.rowCount;x++)l.height+=t.getRowHeight(o+x)*S;for(s=0;s<a.colCount;s++)l.width+=t.getColumnWidth(n+s)*S}else l.height=t.getRowHeight(o)*S,l.width=t.getColumnWidth(n)*S;return l.x+=h.rowHeaderWidth,l.y+=h.colHeaderHeight,1===r?l.y+=h.frozenHeight:2===r&&(l.y+=h.frozenHeight+h.viewportHeight),1===i?l.x+=h.frozenWidth:2===i&&(l.x+=h.frozenWidth+h.viewportWidth),l},t.prototype._convertAbsLocationToRelLocation=function(t){var o,n,r=this._comment,i=r&&r._sheet,a=this._zoomFactor,s=new e.Point(0,0);return i&&(null!==(o=this._getCellRect(i,r._rowIndex,r._colIndex,this._rowViewportIndex,this._columnViewportIndex)).x&&void 0!==o.x&&null!==o.y&&void 0!==o.y&&o.width&&o.height&&(n=i._getSheetLayout(),s.x=(t.x-(o.x+o.width-n.rowHeaderWidth))/a,s.y=(t.y-(o.y-n.colHeaderHeight))/a)),s},t.prototype.updateLayoutWhenLocationChanged=function(){this._absLocation=this._getAbsLocation(),this._updateStartCoordinate(),this._updateEndCoordinate(),this.updateLayout()},t.prototype.updateLayoutWhenWidthHeightChanged=function(){this._absLocation=this._getAbsLocation(),this._updateEndCoordinate()},t.prototype.updateLayoutWhenRowColumnChanged=function(){var e,t=this._comment;t.dynamicMove()?t.dynamicSize()?(this._updateSizeByCoordinate(),this._updateLocationByCoordinate()):(this._updateLocationByCoordinate(),this._updateEndCoordinate()):(this._updateStartCoordinate(),this._updateEndCoordinate(),e=this._convertAbsLocationToRelLocation(this._absLocation),t.location(e))},t.prototype.updateLayoutWhenCellSpanChanged=function(){this._absLocation=this._getAbsLocation(),this.updateLayout()},t.prototype.updateLayoutWhenSheetScroll=function(){this._absLocation=this._getAbsLocation(),this.updateLayout()},t.prototype._updateLocationByCoordinate=function(){var e=this._comment,t=(e&&e._sheet,this._getLocationByCoordinate());this._absLocation=t,e._location=this._convertAbsLocationToRelLocation(t),this.updateLayout()},t.prototype._getLocationByCoordinate=function(){var t,o,n,r,i,a,s=this,l=s._comment,u=l&&l._sheet,c=s._zoomFactor,h=u.getViewportLeftColumn(s._columnViewportIndex),p=u.getViewportTopRow(s._rowViewportIndex);s._getViewportRect(s._rowViewportIndex,s._columnViewportIndex);if(0===s._columnViewportIndex?t=0:1===s._columnViewportIndex?t=u.getViewportWidth(0):2===s._columnViewportIndex&&(t=u.getViewportWidth(0)+u.getViewportWidth(1)),h<s._startColumn)for(o=h;o<s._startColumn;o++)t+=u.getColumnWidth(o,3)*c;else for(o=s._startColumn;o<h;o++)t-=u.getColumnWidth(o,3)*c;if((n=u.getColumnWidth(s._startColumn,3))<s._startColumnOffset&&(s._startColumnOffset=n),t+=s._startColumnOffset*c,0===s._rowViewportIndex?r=0:1===s._rowViewportIndex?r=u.getViewportHeight(0):2===s._rowViewportIndex&&(r=u.getViewportHeight(0)+u.getViewportHeight(1)),p<s._startRow)for(i=p;i<s._startRow;i++)r+=u.getRowHeight(i,3)*c;else for(i=s._startRow;i<p;i++)r-=u.getRowHeight(i,3)*c;return(a=u.getRowHeight(s._startRow,3))<s._startRowOffset&&(s._startRowOffset=a),r+=s._startRowOffset*c,new e.Point(t,r)},t.prototype._updateSizeByCoordinate=function(){for(var e,t,o,n,r,i,a=this,s=a._comment,l=s&&s._sheet,u=(a._zoomFactor,0),c=a._startColumn;c<a._endColumn;c++)u+=l.getColumnWidth(c,3);for((e=l.getColumnWidth(a._startColumn,3))<a._startColumnOffset&&(a._startColumnOffset=e),(t=l.getColumnWidth(a._endColumn,3))<a._endColumnOffset&&(a._endColumnOffset=t),u=u-a._startColumnOffset+a._endColumnOffset,o=0,n=a._startRow;n<a._endRow;n++)o+=l.getRowHeight(n,3);(r=l.getRowHeight(a._startRow,3))<a._startRowOffset&&(a._startRowOffset=r),(i=l.getRowHeight(a._endRow,3))<a._endRowOffset&&(a._endRowOffset=i),o=o-a._startRowOffset+a._endRowOffset,s.width(u),s.height(o)},t.prototype._updateStartCoordinate=function(){var t,o,n,r,i,a=this,s=a._comment,l=s&&s._sheet,u=a._zoomFactor;if(a._absLocation){a._getViewportRect(a._rowViewportIndex,a._columnViewportIndex);var c,h=l.getViewportLeftColumn(a._columnViewportIndex),p=l.getViewportTopRow(a._rowViewportIndex);0===a._columnViewportIndex?c=a._absLocation.x:1===a._columnViewportIndex?c=a._absLocation.x-l.getViewportWidth(0):2===a._columnViewportIndex&&(c=a._absLocation.x-(l.getViewportWidth(0)+l.getViewportWidth(1))),0===a._rowViewportIndex?t=a._absLocation.y:1===a._rowViewportIndex?t=a._absLocation.y-l.getViewportHeight(0):2===a._rowViewportIndex&&(t=a._absLocation.y-(l.getViewportHeight(0)+l.getViewportHeight(1)));var d=new e.Point(c,t),f=0,g=0;for(o=h;o<l.getColumnCount();o++){if(!(f+(n=l.getColumnWidth(o,3)*u)<d.x)){a._startColumn=o,a._startColumnOffset=(d.x-f)/u;break}f+=n}for(r=p;r<l.getRowCount();r++){if(!(g+(i=l.getRowHeight(r,3)*u)<d.y)){a._startRow=r,a._startRowOffset=(d.y-g)/u;break}g+=i}}},t.prototype._updateEndCoordinate=function(){var t,o,n,r,i,a=this,s=a._comment,l=s&&s._sheet,u=a._zoomFactor;if(a._absLocation){a._getViewportRect(a._rowViewportIndex,a._columnViewportIndex);var c,h=l.getViewportLeftColumn(a._columnViewportIndex),p=l.getViewportTopRow(a._rowViewportIndex);0===a._columnViewportIndex?c=a._absLocation.x+a._getActualWidth():1===a._columnViewportIndex?c=a._absLocation.x+a._getActualWidth()-l.getViewportWidth(0):2===a._columnViewportIndex&&(c=a._absLocation.x+a._getActualWidth()-(l.getViewportWidth(0)+l.getViewportWidth(1))),0===a._rowViewportIndex?t=a._absLocation.y+a._getActualHeight():1===a._rowViewportIndex?t=a._absLocation.y+a._getActualHeight()-l.getViewportHeight(0):2===a._rowViewportIndex&&(t=a._absLocation.y+a._getActualHeight()-(l.getViewportHeight(0)+l.getViewportHeight(1)));var d=new e.Point(c,t),f=0,g=0;for(o=h;o<l.getColumnCount();o++){if(!(f+(n=l.getColumnWidth(o,3)*u)<d.x)){a._endColumn=o,a._endColumnOffset=(d.x-f)/u;break}f+=n}for(r=p;r<l.getRowCount();r++){if(!(g+(i=l.getRowHeight(r,3)*u)<d.y)){a._endRow=r,a._endRowOffset=(d.y-g)/u;break}g+=i}}},t.prototype.addRows=function(e,t){var o=this._comment;e<=this._startRow?o.dynamicMove()&&(this._startRow+=t,this._endRow+=t):e>this._startRow&&e<=this._endRow&&o.dynamicSize()&&(this._endRow+=t),this._updateSizeByCoordinate(),this._updateLocationByCoordinate()},t.prototype.addColumns=function(e,t){var o=this._comment;e<=this._startColumn?o.dynamicMove()&&(this._startColumn+=t,this._endColumn+=t):e>this._startColumn&&e<=this._endColumn&&o.dynamicSize()&&(this._endColumn+=t),this._updateSizeByCoordinate(),this._updateLocationByCoordinate()},t.prototype.removeRows=function(e,t){var o=this,n=o._comment,r=e+t-1;e<o._startRow?r<o._startRow?n.dynamicMove()&&(o._startRow-=t,o._endRow-=t):r<o._endRow&&n.dynamicMove()&&(o._endRow-=n.dynamicSize()?t:o._startRow-e+1,o._startRow=e,o._startRowOffset=0):e<=o._endRow&&(r<o._endRow?n.dynamicSize()&&(o._endRow-=t):n.dynamicSize()&&(o._endRow=e,o._endRowOffset=0)),o._updateSizeByCoordinate(),o._updateLocationByCoordinate()},t.prototype.removeColumns=function(e,t){var o=this,n=o._comment,r=e+t-1;e<o._startColumn?r<o._startColumn?n.dynamicMove()&&(o._startColumn-=t,o._endColumn-=t):r<o._endColumn&&n.dynamicMove()&&(o._endColumn-=n.dynamicSize()?t:o._startColumn-e+1,o._startColumn=e,o._startColumnOffset=0):e<=o._endColumn&&(r<o._endColumn?n.dynamicSize()&&(o._endColumn-=t):n.dynamicSize()&&(o._endColumn=e,o._endColumnOffset=0)),o._updateSizeByCoordinate(),o._updateLocationByCoordinate()},t.prototype.updateLayout=function(){var t=this,o=t._comment._sheet;t.isOpen()&&(t._zoomFactor!==o._zoomFactor?(t._zoomFactor=o._zoomFactor,t._absLocation=t._getLocationByCoordinate()):t._zoomFactor=o._zoomFactor,t._updateCommentViewportIndex(),t._updateIndicatorSize(),t._formatComment(),t._updateLineContainerLayout(),t._updateAdornerLayout(),e.util.browser.chrome&&t._offsetCommentLayoutInChrome())},t.prototype._updateIndicatorSize=function(){var e=this._comment._sheet,t=e.parent&&e.parent.useTouchLayout();this._hostMargin=t?11:7},t.prototype._updateCommentViewportIndex=function(){var e=this._comment,t=e&&e._sheet,o=e._rowIndex,n=e._colIndex,r=1,i=1,a=t.frozenRowCount,s=t.frozenColCount,l=t._frozenTrailingRowCount,u=t._frozenTrailingColCount,c=t.getRowCount(),h=t.getColumnCount();o<a?r=0:o>=a&&o<=c-l-1?r=1:o>c-l-1&&(r=2),n<s?i=0:n>=s&&n<=h-u-1?i=1:n>h-u-1&&(i=2),this._rowViewportIndex=r,this._columnViewportIndex=i},t.prototype._formatComment=function(){var e=2===this._comment.commentState()?this._editor:this._host;this._formatCommentState(),this._formatCommentStyle(e),this._formatCommentText(e),this._formatCommentRect(e),this._formatCommentProtection()},t.prototype._formatCommentText=function(t){var o=this._comment;t===this._host&&(t.innerHTML=e.StringUtil.escapeHtml(o.text()))},t.prototype._formatCommentRect=function(t){var o,n,r,i,a,s,l,u=this,c=u._comment,h=(c&&c._sheet,2===c.commentState()||1===c.displayMode()?u._getAbsLocation():u._absLocation),p=u._zoomFactor;if(h){o=u._isResizing?u._getAdjustedCommentRect(h,c.width(),c.height()):u._getAdjustedCommentRect(h),u._adjustCommentRect(o);var g=o.width*p,m=o.height*p,_=o.x,y=o.y,C=_+g,w=y+m,v=u._hostMargin,S=u._getViewportRect(u._rowViewportIndex,u._columnViewportIndex);_<S.x?(e.GC$(u._floatBlockCanvas).css("left",_-S.x),e.GC$(u._hostContainer).css("left",_+v-S.x),g+=_-S.x,_=S.x):(e.GC$(u._floatBlockCanvas).css("left",0),e.GC$(u._hostContainer).css("left",v),C>S.x+S.width&&(g+=S.x+S.width-1-C)),g=f(S.width-1,g),y<S.y?(e.GC$(u._floatBlockCanvas).css("top",y-S.y),e.GC$(u._hostContainer).css("top",y+v-S.y),m+=y-S.y,y=S.y):(e.GC$(u._floatBlockCanvas).css("top",0),e.GC$(u._hostContainer).css("top",v),w>S.y+S.height&&(m+=S.y+S.height-1-w)),m=f(S.height-1,m),e.GC$(u._floatBlockCanvasContainer).css({left:_,top:y,width:g,height:m}),n=g,r=m,e.DPIHelper.setSize(u._floatBlockCanvas,n,r),i=d(0,n-2*(v+c.borderWidth())),a=d(0,r-2*(v+c.borderWidth())),e.GC$(u._hostContainer).css({width:i,height:a}),s=i,l=a,c.padding()&&(s-=Math.ceil(parseFloat(c.padding().left)+parseFloat(c.padding().right)),l-=Math.ceil(parseFloat(c.padding().top)+parseFloat(c.padding().bottom))),e.GC$(t).css({width:d(0,s),height:d(0,l)})}},t.prototype._adjustCommentRect=function(t){var o=this._comment,n=this._absLocation;if(t.x!==n.x||t.y!==n.y||t.width!==o.width()||t.height!==o.height()){var r=this._convertAbsLocationToRelLocation(new e.Point(t.x,t.y)),i=t.width,a=t.height;(r.x!==o.location().x||r.y!==o.location().y)&&(o._location=r),i!==o.width()&&(o._width=i),a!==o.height()&&(o._height=a),this._absLocation=new e.Point(t.x,t.y)}},t.prototype._formatCommentProtection=function(){var e=this,t=e._comment;(t&&t._sheet).canEditComment()?(e._attachFloatBlockCanvasEventHandler(),e._attachHostContainerEventHandler(),e._attachLineCanvasEventHandler(),e._attachHostEventHandler(),e._attachEditorEventHandler()):(t.locked()?(e._detachFloatBlockCanvasEventHandler(),e._attachMouseWheelEvent(e._floatBlockCanvas),e._detachHostContainerEventHandler(),e._attachMouseWheelEvent(e._hostContainer),e._floatBlockCanvas.style.cursor="default",e._hostContainer.style.cursor="default"):(e._attachFloatBlockCanvasEventHandler(),e._attachHostContainerEventHandler()),t.lockText()?(e._detachHostEventHandler(),e._attachMouseWheelEvent(e._host),e._detachEditorEventHandler(),e._attachMouseWheelEvent(e._editor),(t.locked()||1!==t.commentState())&&t.commentState(3),e._host.style.cursor=t.locked()?"default":"move"):(e._attachHostEventHandler(),e._attachEditorEventHandler()),e._attachLineCanvasEventHandler())},t.prototype._formatCommentState=function(){var t=this._comment,o=this._commentManager,n=t&&t._sheet;switch(t.commentState()){case 1:o.activateComment(t),this.isEditing()&&this.detachEditor(),n.getSelections().length>0&&n._saveAndClearSheetSelections(),e.FocusHelper.setActiveElement(n);break;case 2:o.activateComment(t),this.isEditing()||this._attachEditor(),n.getSelections().length>0&&n._saveAndClearSheetSelections(),e.FocusHelper.setActiveElement(u);break;case 3:t===o.getActiveComment()&&(o.deactivateComment(),0===n.getSelections().length&&n._loadAndSetSheetSelections())}},t.prototype._formatCommentStyle=function(t){var o,n=this._comment,r=e.GC$(t);r.css("font-family",n.fontFamily()).css("font-style",n.fontStyle()).css("font-size",parseInt(n.fontSize())*this._zoomFactor+"pt").css("font-weight",n.fontWeight()),r.css("text-decoration",e.StyleHelper.composeTextDecoration(n.textDecoration())),r.css("text-align",e.HorizontalAlign[n.horizontalAlign()]),n.padding()?r.css("padding",n.padding().toString()):r.css("padding","0px"),r.css("background-color",n.backColor()).css("color",n.foreColor()).css("opacity",n.opacity()),e.GC$(this._hostContainer).css("border-width",n.borderWidth()).css("border-style",n.borderStyle()).css("border-color",n.borderColor()),o=this._commentManager.getCommentActualZIndex(n),e.GC$(this._lineCanvasContainer).css("z-index",o),e.GC$(this._floatBlockCanvasContainer).css("z-index",o)},t.prototype._offsetCommentLayoutInChrome=function(){var t=this._comment._sheet,o=e.GC$(this._hostContainer);if(t&&o){var n=t._eventHandler._getCanvasOffset(),r=n.left-Math.floor(n.left)>=.5?.5:0,i=n.top-Math.floor(n.top)>=.5?.5:0;o.css("left",parseFloat(o.css("left"))+r),o.css("top",parseFloat(o.css("top"))+i)}},t.prototype._updateLineContainerLayout=function(){var t=this,o=t._comment,n=o._sheet,r=t._getCellRect(n,o._rowIndex,o._colIndex,t._rowViewportIndex,t._columnViewportIndex),i=n._getSheetLayout(),a=u,s=r.x+r.width-i.rowHeaderWidth,l=r.y-i.colHeaderHeight;a=new e.Point(s,l);var c=u,h=e.GC$(t._floatBlockCanvasContainer).position(),p=e.GC$(t._hostContainer).position(),d=e.GC$(t._hostContainer);c=h.left+p.left>a.x?new e.Point(h.left+p.left,h.top+p.top):h.top+p.top+d.height()<a.y?new e.Point(h.left+p.left+d.width(),h.top+p.top+d.height()):new e.Point(h.left+p.left+d.width(),h.top+p.top);var g=t._hostMargin,m=_(a.x-c.x)+2*g,y=_(a.y-c.y)+2*g,C=f(a.x,c.x)-g,w=f(a.y,c.y)-g,v=C+m,S=w+y,x=t._getViewportRect(t._rowViewportIndex,t._columnViewportIndex);C<x.x&&(m-=x.x-C,C=x.x),v>x.x+x.width&&(m-=v-(x.x+x.width)),m=f(x.width,m),w<x.y&&(y-=x.y-w,w=x.y),S>x.y+x.height&&(y-=S-(x.y+x.height)),y=f(x.height,y),e.GC$(t._lineCanvasContainer).css("left",C).css("top",w).css("width",m).css("height",y),e.DPIHelper.setSize(t._lineCanvas,m,y),a.x=a.x-C,a.y=a.y-w,c.x=c.x-C,c.y=c.y-w,t._drawLine(a,c)},t.prototype._drawLine=function(t,o){var n,r,i;this._lineCtx||(this._lineCtx=this._lineCanvas.getContext("2d")),n=this._lineCtx,r=this._comment.borderColor(),n.strokeStyle=r,n.clearRect(0,0,e.DPIHelper.getLogicWidth(this._lineCanvas),e.DPIHelper.getLogicHeight(this._lineCanvas)),n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(o.x,o.y),n.stroke(),n.save(),n.translate(t.x,t.y),n.fillStyle=r,n.beginPath(),i=m(o.y-t.y,o.x-t.x),n.rotate(i),n.moveTo(0,0),n.lineTo(7,-4),n.lineTo(7,4),n.lineTo(0,0),n.fill(),n.closePath(),n.restore()},t.prototype._updateAdornerLayout=function(){var t=this,o=t._comment,n=o._sheet;t._adornerDrawState=t._comment.commentState(),t._adornerCtx||(t._adornerCtx=t._floatBlockCanvas.getContext("2d"));var r=t._adornerCtx,i=e.DPIHelper.getLogicWidth(t._floatBlockCanvas),a=e.DPIHelper.getLogicHeight(t._floatBlockCanvas),s=e.GC$(t._hostContainer).outerWidth(),l=e.GC$(t._hostContainer).outerHeight(),u=t._hostMargin;r.clearRect(0,0,i,a),t._comment.showShadow()&&(t._drawShadowAdorner(r,u,s,l),t._drawStateAdorner(r,i,a)),n.canEditComment(o)&&t._drawResizeAdorner(r,u,i,a,s,l),r.restore()},t.prototype._drawShadowAdorner=function(e,t,o,n){e.fillRect(t+2,t+2,o,n)},t.prototype._drawStateAdorner=function(e,t,o){switch(this._adornerDrawState){case 1:for(e.beginPath(),r=0;r<o;r++)for(n=r%2==0?1:3;n<t;)e.moveTo(n,r),e.lineTo(n+1,r+1),n+=4;e.stroke(),e.closePath();break;case 2:e.beginPath();for(var n=0,r=0;n<t+o;)e.moveTo(n+4,0),e.lineTo(0,r+4),n+=4,r+=4;e.stroke(),e.closePath()}},t.prototype._drawResizeAdorner=function(t,o,n,r,i,a){var s,l,c,h,p,d,f,m,_=this;(1===_._adornerDrawState||2===_._adornerDrawState)&&(_._resizeHitRects.splice(0,_._resizeHitRects.length),s=new e.Rect(0,0,o,o),_._resizeHitRects.push(s),l=new e.Rect(n-o,0,o,o),_._resizeHitRects.push(l),c=new e.Rect(0,r-o,o,o),_._resizeHitRects.push(c),h=new e.Rect(n-o,r-o,o,o),_._resizeHitRects.push(h),a>=3*o?(p=new e.Rect(0,g(r/2-o/2),o,o),_._resizeHitRects.push(p),d=new e.Rect(n-o,g(r/2-o/2),o,o),_._resizeHitRects.push(d)):(_._resizeHitRects.push(u),_._resizeHitRects.push(u)),i>=3*o?(f=new e.Rect(g(n/2-o/2),0,o,o),_._resizeHitRects.push(f),m=new e.Rect(g(n/2-o/2),r-o,o,o),_._resizeHitRects.push(m)):(_._resizeHitRects.push(u),_._resizeHitRects.push(u)),t.save(),t.fillStyle="white",t.strokeStyle="#939393",t.linewidth=1,t.translate(.5,.5),e.GC$.each(_._resizeHitRects,function(){if(_){var e=this.x,o=this.y,n=this.width,r=this.height;t.beginPath(),t.fillRect(e,o,n-1,r-1),t.strokeRect(e,o,n-1,r-1),t.stroke(),t.closePath()}}))},t.prototype._drawMoveResizeContainer=function(){var t=this,o=t._commentManager;t._moveResizeContainerDom?e.GC$(t._moveResizeContainerDom).remove():t._moveResizeContainerDom=document.createElement("div"),t._moveResizePanelDom?e.GC$(t._moveResizePanelDom).remove():t._moveResizePanelDom=document.createElement("div");var n=e.GC$(t._moveResizePanelDom),r=e.GC$(t._moveResizeContainerDom),i=(o._mouseCapture,e.GC$(t._hostContainer)),a=t._getViewportRect(t._rowViewportIndex,t._columnViewportIndex);n.css({position:"absolute",overflow:"hidden",top:a.y,left:a.x,width:a.width,height:a.height,background:"rgba(255,255,255,0.01)"}).css("z-index",901).bind("mousemove",function(e){t._doMouseMove(e)}).bind("mouseup",function(e){t._doMouseUp(e)}),r.addClass("gc-spread-moveResizeContainer").css("position","absolute").css("left",t._absLocation.x+t._hostMargin-a.x).css("top",t._absLocation.y+t._hostMargin-a.y).css("width",i.outerWidth()-2).css("height",i.outerHeight()-2).css("border","gray solid thin"),n.append(t._moveResizeContainerDom),t._commentLayoutPanel&&t._commentLayoutPanel.appendChild(t._moveResizePanelDom)},t.prototype._doMoveResizeContainer=function(t){var o,n,r,i=this,a=i._comment,s=a&&a._sheet,l=(i._absLocation,i._hostMargin),u=i._zoomFactor,c=s._commentManager._mouseCapture;if(c.capture){var h=i._getViewportScrollOffset(),p=t.pageX/u-c.x+h.x,d=t.pageY/u-c.y+h.y;if(0===p&&0===d)return;if(o=i._getViewportRect(i._rowViewportIndex,i._columnViewportIndex),n=e.GC$(i._moveResizeContainerDom),-100==c.resizeDirct){var f=c.cachedRect.x+p,g=c.cachedRect.y+d,m=i._convertRelLocationToAbsLocation(new e.Point(f,g));n.css("left",m.x+l-o.x).css("top",m.y+l-o.y)}else{switch(c.resizeDirct){case 0:r=i._getCommentTopLeftResizeRect(p,d);break;case 1:r=i._getCommentTopRightResizeRect(p,d);break;case 2:r=i._getCommentBottomLeftResizeRect(p,d);break;case 3:r=i._getCommentBottomRightResizeRect(p,d);break;case 4:r=i._getCommentMiddleLeftResizeRect(p);break;case 5:r=i._getCommentMiddleRightResizeRect(p);break;case 6:r=i._getCommentTopCenterResizeRect(d);break;case 7:r=i._getCommentBottomCenterResizeRect(d)}m=i._convertRelLocationToAbsLocation(new e.Point(r.x,r.y)),n.css("left",m.x+l-o.x).css("top",m.y+l-o.y).css("width",r.width*u-2*l-2).css("height",r.height*u-2*l-2)}}},t.prototype._attachEditor=function(){var t,o=this._comment;this.isEditing()||(t=this._commentManager._editorDom,e.GC$(this._host).remove(),this._detachHostEventHandler(),e.GC$(t).remove(),e.GC$(this._hostContainer).append(t),this._setDomStyle(t),this._formatCommentRect(t),e.GC$(t).focus(),t.selectionStart=t.value.length,this._attachEditorEventHandler(),2!==o.commentState()&&o.commentState(2))},t.prototype.detachEditor=function(){var t,o,n=this,r=n._comment,i=r._sheet;n.isEditing()&&(t=n._commentManager._editorDom,e.GC$(t).remove(),n._detachEditorEventHandler(),e.GC$(n._hostContainer).append(n._host),n._setDomStyle(n._host),n._attachHostEventHandler(),e.features.touch&&(n._touchContentManager=new e.CommentContentTouchManager(n._host,n,i.parent._touchEventProvider),n._touchContentManager.attach()),2===r.commentState()&&r.commentState(3),e.GC$(t).val()!==r.text()&&(o=new e.UndoRedo.CommentPropertyUndoAction(i,r,r.text(),e.GC$(t).val(),"text"),i._doCommand(o)))},t.prototype._getSheetHeight=function(e,t){var o,n,r;if(e===u||e===c)return-1;for(o=0,n=e.getRowCount(),r=0;r<n&&!((o+=e.getRowHeight(r,3))>t);r++);return o},t.prototype._getSheetWidth=function(e,t){var o,n,r;if(e===u||e===c)return-1;for(o=0,n=e.getColumnCount(),r=0;r<n&&!((o+=e.getColumnWidth(r,3))>t);r++);return o},t.prototype._getViewportHeight=function(e){var t,o=this._comment,n=o&&o._sheet;if(0===e||2===e)return n.getViewportHeight(e);if(1===e){var r=n.getViewportBottomRow(0)+1,i=n.getViewportTopRow(2),a=0;for(t=r;t<=i;t++)a+=n.getRowHeight(t,3)*this._zoomFactor;return a}return-1},t.prototype._getViewportWidth=function(e){var t,o=this._comment,n=o&&o._sheet;if(0===e||2===e)return n.getViewportWidth(e);if(1===e){var r=n.getViewportRightColumn(0)+1,i=n.getViewportLeftColumn(2),a=0;for(t=r;t<=i;t++)a+=n.getColumnWidth(t,3)*this._zoomFactor;return a}return-1},t.prototype._getTwoColumnDistance=function(e,t,o){for(var n=f(t,o),r=d(t,o),i=0,a=n;a<r;a++)i+=e.getColumnWidth(a,3)*this._zoomFactor;return i},t.prototype._getTwoRowDistance=function(e,t,o){for(var n=f(t,o),r=d(t,o),i=0,a=n;a<r;a++)i+=e.getRowHeight(a,3)*this._zoomFactor;return i},t.prototype._getViewportRect=function(t,o){var n=this._comment,r=n._sheet,i=(this._commentManager.getCommentView(n),r._getSheetLayout()),a=new e.Rect(0,0,0,0);return a=i.viewportRect(t,o),0===t&&0===o||0===t&&2===o||2===t&&0===o||2===t&&2===o?(a.x=0,a.y=0,a.width=i.frozenWidth+i.viewportWidth+i.frozenTrailingWidth,a.height=i.frozenHeight+i.viewportHeight+i.frozenTrailingHeight):0===t&&1===o||2===t&&1===o?(a.x=i.frozenWidth,a.y=0,a.width=i.viewportWidth,a.height=i.frozenHeight+i.viewportHeight+i.frozenTrailingHeight):1===t&&0===o||1===t&&2===o?(a.x=0,a.y=i.frozenHeight,a.width=i.frozenWidth+i.viewportWidth+i.frozenTrailingWidth,a.height=i.viewportHeight):1===t&&1===o&&(a.x=i.frozenWidth,a.y=i.frozenHeight,a.width=i.viewportWidth,a.height=i.viewportHeight),a},t.prototype._setDomStyle=function(t){var o=this._comment,n=e.GC$(t);(t===this._editor||t===this._host)&&(t===this._editor?t.value=o.text():t.innerHTML=e.StringUtil.escapeHtml(o.text()),n.css("font-family",o.fontFamily()).css("font-style",o.fontStyle()).css("font-size",o.fontSize()).css("font-weight",o.fontWeight()).css("color",o.foreColor()).css("background-color",o.backColor()).css("text-align",o.horizontalAlign()).css("text-decoration",o.textDecoration()),o.padding()?n.css("padding",o.padding().toString()):n.css("padding","0px"))},t.prototype.isOpen=function(){return!(!this._floatBlockCanvasContainer||!this._floatBlockCanvasContainer.parentNode)},t.prototype.isActive=function(){return!(!this.isOpen()||this._comment!==this._commentManager.getActiveComment())},t.prototype.isEditing=function(){return!!this.isActive()&&e.GC$(this._hostContainer).find("textarea").length()>0},t.prototype.getCommentRect=function(){var t,o=this._comment,n=(o&&o._sheet,this._zoomFactor,u);return this.isOpen()&&(t=this._comment._sheet._getSheetLayout(),n=new e.Rect(this._absLocation.x+t.headerX+t.rowHeaderWidth,this._absLocation.y+t.headerY+t.colHeaderHeight,this._getActualWidth(),this._getActualHeight())),n},t.prototype.getCommentEditAreaRect=function(){var t,o,n,r,i,a,s,l=this._comment,c=(l&&l._sheet,this._zoomFactor);return this.isOpen()&&(t=this.getCommentRect())?(a=(this._hostMargin+l.borderWidth())*c,s=(this._hostMargin+l.borderWidth())*c,o=t.x+a,n=t.y+s,r=t.width-2*a,i=t.height-2*s,new e.Rect(o,n,r,i)):u},t.prototype._setCursorState=function(e){var t=this._comment,o=t._sheet,n=e.target,r=this._commentManager._mouseCapture;if(r.capture)(n.className===this._hostClassName||n.className===this._floatBlockCanvasClassName||n.className===this._lineCanvasClassName||"gc-spread-floatPanel"===n.className)&&(n.style.cursor=r.resizeDirct>=0?"crosshair":"move");else{if(n.className===this._hostClassName)return!o.canEditComment()&&t.lockText()?void(n.style.cursor=t.locked()?"default":"move"):void(n.style.cursor="text");if(n.className===this._floatBlockCanvasClassName||n.className===this._hostContainerClassName){if(!o.canEditComment(t))return void(n.style.cursor="default");switch(this._getResizeDirection(e)){case 0:return void(n.style.cursor="nw-resize");case 1:return void(n.style.cursor="ne-resize");case 2:return void(n.style.cursor="sw-resize");case 3:return void(n.style.cursor="se-resize");case 4:return void(n.style.cursor="w-resize");case 5:return void(n.style.cursor="e-resize");case 6:return void(n.style.cursor="n-resize");case 7:return void(n.style.cursor="s-resize");default:return void(n.style.cursor="move")}}n.style.cursor="default"}},t.prototype._doMouseDownToEdit=function(t){var o=this._comment,n=o&&o._sheet;if(n.endEdit())return n.unSelectAllFloatingObjects(),this._touchContentManager&&!t.isTouch&&this._touchContentManager.preProcessMouseDown(t)?void e.util.cancelDefault(t):(this._commentManager.activateComment(o),o.commentState(2),this._doMouseUp(t),e.util.cancelDefault(t))},t.prototype._doMouseDownToDragOrResize=function(t){var o=this,n=o._comment,r=n&&n._sheet,i=o._zoomFactor,a=o._commentManager,s=a._mouseCapture;if(r.endEdit()){if(r.unSelectAllFloatingObjects(),o._touchManager&&!t.isTouch&&o._touchManager.preProcessMouseDown(t))return void e.util.cancelDefault(t);s.x=t.pageX/i,s.y=t.pageY/i,s.cachedRect=new e.Rect(n.location().x,n.location().y,n.width(),n.height()),s.resizeDirct=o._getResizeDirection(t),o._handleDocumentMouseMove(),s.capture=!0,o._setCursorState(t),a.activateComment(n),n.commentState(1),r.canEditComment(n)&&(o._moveInfo={},o._moveInfo.startTopRow=r.getViewportTopRow(o._rowViewportIndex),o._moveInfo.startLeftColumn=r.getViewportLeftColumn(o._columnViewportIndex),o._drawMoveResizeContainer(),-100===s.resizeDirct?o._isMoving=!0:o._isResizing=!0);var l=r._eventHandler,u=l._getCanvasOffset(),c=new e.Point(t.pageX-u.left,t.pageY-u.top),h=r.hitTest(c.x,c.y);l.startHitInfo={scrollRowViewportIndex:h.rowViewportIndex,scrollColViewportIndex:h.colViewportIndex,hitTestType:h.hitTestType},l.mousePosition=c,l.startScroll(),l.isCommentWorking=!0,t.stopPropagation()}},t.prototype._getAdjustedCommentRect=function(t,o,n){var r,i,a,s,l,u=this,c=u._comment,h=c&&c._sheet,p=u._hostMargin,d=u._commentManager,f=u._zoomFactor,g=u._columnViewportIndex,m=u._rowViewportIndex,y=u._getViewportRect(m,g);1===arguments.length?(r=u._getActualWidth(),i=u._getActualHeight()):3===arguments.length&&(r=o*f,i=n*f);var C,w,v,S,x=t.x,R=t.y,b=h._getSheetLayout(),T=u._getCellRect(h,0,0,m,g),A=t.x+(0-(T.x-b.rowHeaderWidth))+r-p,I=t.y+(0-(T.y-b.colHeaderHeight))+i-p;if(0===g?(C=0-p,v=b.width-b.rowHeaderWidth):1===g?(a=u._getTwoColumnDistance(h,h.getViewportRightColumn(0)+1,h.getViewportLeftColumn(1)),C=y.x-p-a,v=-u._getViewportWidth(2)):2===g&&(C=0-p,v=0),x<C&&(u._isResizing?r-=C-x:A+=C-x,x=C),(1===g||2===g)&&(v+=u._getSheetWidth(h,A)),A>v)if(u._isResizing)r-=A-v;else if(u._isMoving)x-=A-v;else{var D=0,F=c!==d.getHoverShownComment()||c.ignoreDefaultLocation()?c.location().x:c._defaultLocation.x,M=2*_(F)+h.getColumnWidth(c._colIndex)+c.width();(D=x-M)>C?x=D:x<v?r-=A-v:(D=x-M,A-M>C?D<C?(r-=C-D,x=C):x=D:(D=x-(A-v))<C?(r-=C-D,x=C):x=D)}return 0===m?(w=0-p,S=b.height-b.colHeaderHeight):1===m?(s=u._getTwoRowDistance(h,h.getViewportBottomRow(0)+1,h.getViewportTopRow(1)),w=y.y-p-s,S=u._getViewportHeight(2)):2===m&&(w=0-p,S=0),R<w&&(u._isResizing?i-=w-R:I+=w-R,R=w),(1===m||2===m)&&(S+=u._getSheetHeight(h,I)),I>S&&(u._isResizing?i-=I-S:u._isMoving?R-=I-S:I>S&&((l=R-(I-S))<w?(i-=w-l,R=w):R=l)),new e.Rect(x,R,r/f,i/f)},t.prototype._getViewportScrollOffset=function(){var t,o,n=this._comment._sheet,r=this._moveInfo.startTopRow,i=this._moveInfo.startLeftColumn,a=n.getViewportTopRow(this._rowViewportIndex),s=n.getViewportLeftColumn(this._columnViewportIndex),l=this._getTwoRowDistance(n,r,a),u=this._getTwoColumnDistance(n,i,s);return t=i<s?u:-u,o=r<a?l:-l,new e.Point(t,o)},t.prototype._doMoveResizeComment=function(t){var o,n=this,r=n._comment,i=r&&r._sheet,a=n._zoomFactor,s=i._commentManager._mouseCapture;if(s.capture){var l=n._getViewportScrollOffset(),u=t.pageX/a-s.x+l.x,c=t.pageY/a-s.y+l.y;if(0===u&&0===c)return;if(-100==s.resizeDirct){var h=s.cachedRect.x+u,p=s.cachedRect.y+c,d=n._convertRelLocationToAbsLocation(new e.Point(h,p)),f=n._getAdjustedCommentRect(d);((g=n._convertAbsLocationToRelLocation(new e.Point(f.x,f.y))).x!==r.location().x||g.x!==r.location().y)&&i._doCommand(new e.UndoRedo.CommentPropertyUndoAction(i,r,r.location().clone(),g,"location"))}else{switch(r._autoSize=!1,s.resizeDirct){case 0:o=n._getCommentTopLeftResizeRect(u,c);break;case 1:o=n._getCommentTopRightResizeRect(u,c);break;case 2:o=n._getCommentBottomLeftResizeRect(u,c);break;case 3:o=n._getCommentBottomRightResizeRect(u,c);break;case 4:o=n._getCommentMiddleLeftResizeRect(u);break;case 5:o=n._getCommentMiddleRightResizeRect(u);break;case 6:o=n._getCommentTopCenterResizeRect(c);break;case 7:o=n._getCommentBottomCenterResizeRect(c)}d=n._convertRelLocationToAbsLocation(new e.Point(o.x,o.y)),f=n._getAdjustedCommentRect(d,o.width,o.height);var g=n._convertAbsLocationToRelLocation(new e.Point(f.x,f.y)),m=new e.UndoRedo.CommentUndoTransaction;(g.x!==r.location().x||g.y!==r.location().y)&&m.add(new e.UndoRedo.CommentPropertyUndoAction(i,r,r.location().clone(),g,"location")),f.width!==r.width()&&m.add(new e.UndoRedo.CommentPropertyUndoAction(i,r,r.width(),f.width,"width")),f.height!==r.height()&&m.add(new e.UndoRedo.CommentPropertyUndoAction(i,r,r.height(),f.height,"height")),i._doCommand(m)}}},t.prototype._doMouseMove=function(t){var o=this,n=o._comment._sheet;if(this._setCursorState(t),!(n.getSelections()&&n.getSelections().length>0)){if(o._touchManager&&!t.isTouch&&o._touchManager.preProcessMouseMove(t))return void e.util.cancelDefault(t);if(o._touchContentManager&&!t.isTouch&&o._touchContentManager.preProcessMouseMove(t))return void e.util.cancelDefault(t);var r=o._commentManager,i=t.target,a=n._eventHandler,s=a._getCanvasOffset(),l=new e.Point(t.pageX-s.left,t.pageY-s.top);return i&&r._mouseCapture.capture&&(o._moveResizeContainerDom&&o._doMoveResizeContainer(t),1===o._rowViewportIndex&&(a.mousePosition.y=l.y),1===o._columnViewportIndex&&(a.mousePosition.x=l.x),a.continueScroll()),e.util.cancelDefault(t)}},t.prototype._doMouseUp=function(t){var o=this,n=o._comment._sheet;if(!(n.getSelections()&&n.getSelections().length>0)){if(o._touchManager&&!t.isTouch&&o._touchManager.preProcessMouseUp(t))return void e.util.cancelDefault(t);if(o._touchContentManager&&!t.isTouch&&o._touchContentManager.preProcessMouseUp(t))return void e.util.cancelDefault(t);var r=t.target,i=o._commentManager,a=n._eventHandler;return a.isCommentWorking=!1,a.stopScroll(),r&&(o._doMoveResizeComment(t),o._moveResizePanelDom&&(e.GC$(o._moveResizePanelDom).remove(),o._moveResizePanelDom=null,o._isMoving=!1,o._isResizing=!1),o._unhandleDocumentMouseMove(),i._mouseCapture.capture=!1,o._setCursorState(t)),e.util.cancelDefault(t)}},t.prototype._getResizeDirection=function(t){var o=this;if(o._resizeHitRects.length>0&&(1===o._adornerDrawState||2===o._adornerDrawState)){var n=t.target,r=t.pageX-e.GC$(n).offset().left,i=t.pageY-e.GC$(n).offset().top,a=o._resizeHitRects[0];if(a&&a.contains(r,i))return 0;if((a=o._resizeHitRects[1])&&a.contains(r,i))return 1;if((a=o._resizeHitRects[2])&&a.contains(r,i))return 2;if((a=o._resizeHitRects[3])&&a.contains(r,i))return 3;if((a=o._resizeHitRects[4])&&a.contains(r,i))return 4;if((a=o._resizeHitRects[5])&&a.contains(r,i))return 5;if((a=o._resizeHitRects[6])&&a.contains(r,i))return 6;if((a=o._resizeHitRects[7])&&a.contains(r,i))return 7}return-100},t.prototype._getCommentTopLeftResizeRect=function(t,o){var n,r,i,a,s=this._commentManager._mouseCapture,l=s.cachedRect.width-2*this._hostMargin-t,u=s.cachedRect.height-2*this._hostMargin-o;return l>=0?(n=s.cachedRect.x+t,i=l+2*this._hostMargin):(n=s.cachedRect.x+s.cachedRect.width-2*this._hostMargin,i=-l+2*this._hostMargin),u>=0?(r=s.cachedRect.y+o,a=u+2*this._hostMargin):(r=s.cachedRect.y+s.cachedRect.height-2*this._hostMargin,a=-u+2*this._hostMargin),new e.Rect(n,r,i,a)},t.prototype._getCommentTopRightResizeRect=function(t,o){var n,r,i,a,s=this._commentManager._mouseCapture,l=s.cachedRect.width-2*this._hostMargin+t,u=s.cachedRect.height-2*this._hostMargin-o;return l>=0?(n=s.cachedRect.x,i=l+2*this._hostMargin):(n=s.cachedRect.x+l,i=-l+2*this._hostMargin),u>=0?(r=s.cachedRect.y+o,a=u+2*this._hostMargin):(r=s.cachedRect.y+s.cachedRect.height-2*this._hostMargin,a=-u+2*this._hostMargin),new e.Rect(n,r,i,a)},t.prototype._getCommentBottomLeftResizeRect=function(t,o){var n,r,i,a,s=this._commentManager._mouseCapture,l=s.cachedRect.width-2*this._hostMargin-t,u=s.cachedRect.height-2*this._hostMargin+o;return l>=0?(n=s.cachedRect.x+t,i=l+2*this._hostMargin):(n=s.cachedRect.x+s.cachedRect.width-2*this._hostMargin,i=-l+2*this._hostMargin),u>=0?(r=s.cachedRect.y,a=u+2*this._hostMargin):(r=s.cachedRect.y+u,a=-u+2*this._hostMargin),new e.Rect(n,r,i,a)},t.prototype._getCommentBottomRightResizeRect=function(t,o){var n,r,i,a,s=this._commentManager._mouseCapture,l=s.cachedRect.width-2*this._hostMargin+t,u=s.cachedRect.height-2*this._hostMargin+o;return l>=0?(n=s.cachedRect.x,i=l+2*this._hostMargin):(n=s.cachedRect.x+l,i=-l+2*this._hostMargin),u>=0?(r=s.cachedRect.y,a=u+2*this._hostMargin):(r=s.cachedRect.y+u,a=-u+2*this._hostMargin),new e.Rect(n,r,i,a)},t.prototype._getCommentMiddleLeftResizeRect=function(t){var o,n,r,i,a=this._commentManager._mouseCapture,s=a.cachedRect.width-2*this._hostMargin-t;return s>=0?(o=a.cachedRect.x+t,r=s+2*this._hostMargin):(o=a.cachedRect.x+a.cachedRect.width-2*this._hostMargin,r=-s+2*this._hostMargin),n=a.cachedRect.y,i=a.cachedRect.height,new e.Rect(o,n,r,i)},t.prototype._getCommentMiddleRightResizeRect=function(t){var o,n,r,i,a=this._commentManager._mouseCapture,s=a.cachedRect.width-2*this._hostMargin+t;return s>=0?(o=a.cachedRect.x,r=s+2*this._hostMargin):(o=a.cachedRect.x+s,r=-s+2*this._hostMargin),n=a.cachedRect.y,i=a.cachedRect.height,new e.Rect(o,n,r,i)},t.prototype._getCommentTopCenterResizeRect=function(t){var o,n,r,i,a=this._commentManager._mouseCapture,s=a.cachedRect.height-2*this._hostMargin-t;return o=a.cachedRect.x,r=a.cachedRect.width,s>=0?(n=a.cachedRect.y+t,i=s+2*this._hostMargin):(n=a.cachedRect.y+a.cachedRect.height-2*this._hostMargin,i=-s+2*this._hostMargin),new e.Rect(o,n,r,i)},t.prototype._getCommentBottomCenterResizeRect=function(t){var o,n,r,i,a=this._commentManager._mouseCapture,s=a.cachedRect.height-2*this._hostMargin+t;return o=a.cachedRect.x,r=a.cachedRect.width,s>=0?(n=a.cachedRect.y,i=s+2*this._hostMargin):(n=a.cachedRect.y+s,i=-s+2*this._hostMargin),new e.Rect(o,n,r,i)},t.prototype._attachMouseWheelEvent=function(t){var o,n,r=this._comment._sheet;if(t){switch(o="",t){case this._floatBlockCanvas:o=".floatBlockCanvas";case this._hostContainer:o=".hostContainer";case this._lineCanvasContainer:o=".lineCanvasContainer";case this._host:o=".host";case this._editor:o=".editor"}o&&(e.GC$(t).unbind(h+o).unbind(p+o),n=function(t){r._mouseWheelDelegate(t),e.util.cancelDefault(t)},e.GC$(t).bind(h+o,n).bind(p+o,n))}},t.prototype._attachFloatBlockCanvasEventHandler=function(){var t,o,n=this,r=n._comment,i=r&&r&&r._sheet;n._detachFloatBlockCanvasEventHandler(),t=".floatBlockCanvas",o=function(e){i&&i._mouseWheelDelegate(e)},e.GC$(n._floatBlockCanvas).bind("mousedown"+t,function(e){n._doMouseDownToDragOrResize(e)}).bind("mousemove"+t,function(e){n._doMouseMove(e)}).bind("mouseup"+t,function(e){n._doMouseUp(e)}).bind(h+t,o).bind(p+t,o)},t.prototype._detachFloatBlockCanvasEventHandler=function(){e.GC$(this._floatBlockCanvas).unbind(".floatBlockCanvas")},t.prototype._attachHostContainerEventHandler=function(){var t,o,n=this,r=n._comment,i=r&&r._sheet;n._detachHostContainerEventHandler(),t=".hostContainer",o=function(e){i&&i._mouseWheelDelegate(e)},e.GC$(n._hostContainer).bind("mousedown"+t,function(e){n._doMouseDownToDragOrResize(e)}).bind("mousemove"+t,function(e){n._doMouseMove(e)}).bind("mouseup"+t,function(e){n._doMouseUp(e)}).bind(h+t,o).bind(p+t,o)},t.prototype._detachHostContainerEventHandler=function(){e.GC$(this._hostContainer).unbind(".hostContainer")},t.prototype._attachLineCanvasEventHandler=function(){var t=this,o=t._comment,n=o&&o._sheet,r=n._commentManager;if(t._detachLineCanvasEventHandler(),n){var i=n._eventHandler._getCanvasOffset(),a=".lineCanvas",s=function(e){n._mouseWheelDelegate(e)};e.GC$(t._lineCanvas).bind("mousedown"+a,function(o){var a,s,l=n.hitTest(o.pageX-i.left,o.pageY-i.top).commentHitInfo;l?(a=l.comment,s=r.getCommentView(a),"editArea"===l.area?s._doMouseDownToEdit(o):"moveResizeArea"===l.area&&s._doMouseDownToDragOrResize(o),e.GC$(s._floatBlockCanvasContainer).css("z-index",parseInt(e.GC$(t._lineCanvasContainer).css("z-index")+1))):n._mouseDownDelegate(o)}).bind("mousemove"+a,function(e){var o,a,s=n.hitTest(e.pageX-i.left,e.pageY-i.top).commentHitInfo;s?(o=s.comment,r.getCommentView(o)._doMouseMove(e),"editArea"===s.area?t._lineCanvas.style.cursor="text":"moveResizeArea"===s.area&&(t._lineCanvas.style.cursor="move")):(n._mouseMoveDelegate(e),(a=n._getCanvas())&&(t._lineCanvas.style.cursor=a.style.cursor))}).bind("mouseup"+a,function(e){var t,o=n.hitTest(e.pageX-i.left,e.pageY-i.top).commentHitInfo;o?(t=o.comment,r.getCommentView(t)._doMouseUp(e)):n._mouseUpDelegate(e)}).bind("dblclick"+a,function(e){n._dblClickDelegate(e)}).bind(h+a,s).bind(p+a,s)}},t.prototype._detachLineCanvasEventHandler=function(){e.GC$(this._lineCanvas).unbind(".lineCanvas")},t.prototype._attachHostEventHandler=function(){var t,o,n=this,r=n._comment,i=r&&r._sheet;2!==r.commentState()&&n._host&&(n._detachHostEventHandler(),t=".host",o=function(e){i&&i._mouseWheelDelegate(e)},e.GC$(n._host).bind("mousedown"+t,function(e){n._doMouseDownToEdit(e)}).bind("mousemove"+t,function(e){n._doMouseMove(e)}).bind("mouseup"+t,function(e){n._doMouseUp(e)}).bind(h+t,o).bind(p+t,o))},t.prototype._detachHostEventHandler=function(){2!==this._comment.commentState()&&this._host&&e.GC$(this._host).unbind(".host")},t.prototype._attachEditorEventHandler=function(){var t,o,n=this,r=n._comment,i=r&&r._sheet,a=n._editor;2===r.commentState()&&a&&(this._detachEditorEventHandler(),t=".editor",o=function(e){i&&i._mouseWheelDelegate(e)},e.GC$(a).bind("mousedown"+t,function(e){e.stopPropagation()}).bind("mousemove"+t,function(e){e.stopPropagation()}).bind("mouseup"+t,function(e){e.stopPropagation()}).bind(h+t,o).bind(p+t,o).bind("input"+t,function(e){r.autoSize()&&n._doAutosize()}).bind("keydown"+t,function(t){(27===t.keyCode||9===t.keyCode)&&(r.commentState(1),e.util.cancelDefault(t),e.FocusHelper.setActiveElement(i))}))},t.prototype._doAutosize=function(){var t,o,n,r,i,a,s,l,u=this._comment,c=u&&u._sheet;2===u.commentState()?o=(t=this._editor).value.split("\n"):(t=this._host,o=e.StringUtil.unescapeHtml(t.innerHTML).split("\n"));var h,p,f=e.GC$(t).height(),g=e.GC$(t).width(),m=0,_=t.style,y="";if(_.font?(m=c._getFontHeight(_.font),y+=_.font):(u.fontStyle()&&(y+=" "+u.fontStyle()),u.fontWeight()&&(y+=" "+u.fontWeight()),u.fontSize()&&(y+=" "+u.fontSize()),u.fontFamily()&&(y+=" "+u.fontFamily()),m=c._getFontHeight(y)),n=m,5,o&&o.length>0){for(h=d(o.length*m,n),r=0,i=0;i<o.length;i++)r<(a=c._getStringWidth(o[i],y))&&(r=a);p=d(r,5)}else h=n,p=5;e.GC$(t).css("height",h).css("width",p),2===u.commentState()&&(u._text=t.value),this._isAutosizing=!0,0!==(s=h-f)&&u._changeProperty("height",u.height()+s),0!==(l=p-g)&&u._changeProperty("width",u.width()+l),this._isAutosizing=!1},t.prototype._detachEditorEventHandler=function(){var t=this._comment,o=this._editor;2===t.commentState()&&o&&e.GC$(o).unbind(".editor")},t.prototype._handleDocumentMouseMove=function(){var t,o=this,n=this._commentManager._mouseCapture;n.capture||(t=".gcComment",e.GC$(document).bind("mousemove"+t,function(e){o._doMouseMove(e)}).bind("mouseup"+t,function(e){o._doMouseUp(e)}),n.capture=!0)},t.prototype._unhandleDocumentMouseMove=function(){var t=this._commentManager._mouseCapture;t.capture&&(t.capture=!1,e.GC$(document).unbind(".gcComment"))},t}(),e.CommentView=r,i=function(){function t(e){this._sheet=e,this._mouseCapture={capture:!1,x:0,y:0,cachedRect:u,resizeDirct:-100},this._editorDom=u,this._hoverShowComment=u,this._activeComment=u,this._commentList=[],this._commentViewList=[],this.createEditDom(),this._bindEventsOnSheet()}return t.prototype.createEditDom=function(){var t=document.createElement("textarea");e.GC$(t).addClass("gc-comment-editor").css("left",0).css("top",0).css("position","absolute").css("margin",0).css("padding",0).css("word-wrap","break-word").css("word-break","normal").css("overflow","hidden").css("resize","none").css("outline","none").css("border","0px").css("box-sizing","content-box").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this._editorDom=t},t.prototype.getCommentList=function(){for(var e=[],t=0;t<this._commentList.length;t++)e.push(this._commentList[t]);return e},t.prototype.getHoverShownComment=function(){return this._hoverShowComment},t.prototype._bindEventsOnSheet=function(){var t=this,o=t._sheet;o&&(o._bind(e.Events.ColumnChanged,function(e,o){var n=o.propertyName;("width"===n||"isVisible"===n)&&t._updateCommentsLayoutWhenRowColumnChanged()}),o._bind(e.Events.RowChanged,function(e,o){var n=o.propertyName;("height"===n||"isVisible"===n)&&t._updateCommentsLayoutWhenRowColumnChanged()}),o._bind(e.Events.ColumnWidthChanged,function(e,o){t._updateCommentsLayoutWhenRowColumnChanged()}),o._bind(e.Events.RowHeightChanged,function(e,o){t._updateCommentsLayoutWhenRowColumnChanged()}),o._bind(e.Events.CommentChanged,function(e,o){var n;if(o){var r=o.propertyName,i=o.comment,a=t.getCommentView(i);a&&(n=["autoSize","text","fontFamily","fontStyle","fontSize","fontWeight","padding"],"location"===r?a.updateLayoutWhenLocationChanged():"width"===r||"height"===r?a.updateLayoutWhenWidthHeightChanged():n.indexOf(r)>=0&&i.autoSize()&&!a._isAutosizing&&a._doAutosize())}}))},t.prototype._addCommentView=function(t){t&&-1===e.ArrayHelper.indexOf(this._commentViewList,t)&&this._commentViewList.push(t)},t.prototype._removeCommentView=function(t){this._commentViewList.splice(e.ArrayHelper.indexOf(this._commentViewList,t),1)},t.prototype.getCommentView=function(e){var t,o;if(!e)return u;for(t=0;t<this._commentViewList.length;t++)if((o=this._commentViewList[t]).getComment()===e)return o;return u},t.prototype.hasComment=function(){return this._commentList.length>0},t.prototype.addComment=function(e,t,o){o&&!this.containsComment(o)&&(o._sheet=this._sheet,o._rowIndex=e,o._colIndex=t,o._zIndex=898,this._updateCommentZIndex(),this._commentList.push(o),this._sheet.invalidate())},t.prototype._updateCommentZIndex=function(){for(var e=this._commentList,t=0;t<e.length;t++)e[t]._zIndex--},t.prototype._getTopCommentZIndex=function(){var e,t,o;if(this._commentList.length>0){for(e=this._commentList[0].zIndex(),t=1;t<this._commentList.length;t++)e<(o=this._commentList[t]).zIndex()&&(e=o.zIndex());return e}return 0},t.prototype.removeComment=function(t){var o,n=this._commentList;t&&(this.hideComment(t),n.splice(e.ArrayHelper.indexOf(n,t),1),(o=this.getCommentView(t))&&this._removeCommentView(o))},t.prototype.containsComment=function(t){return-1!==e.ArrayHelper.indexOf(this._commentList,t)},t.prototype.clear=function(e,t,o,n){var r,i,a,s=this._sheet,l=s.isPaintSuspended();for(s.isPaintSuspended(!0),r=0;r<o;r++)for(i=0;i<n;i++)(a=s.getComment(r+e,i+t))&&(this.removeComment(a),s.setComment(r+e,i+t,u));s.isPaintSuspended(l)},t.prototype.addRows=function(e,t){for(var o,n,r=this._commentList,i=this._commentViewList,a=0;a<r.length;a++)e<=(o=r[a])._rowIndex&&(o._rowIndex+=t);for(a=0;a<i.length;a++)(n=i[a]).isOpen()&&n.addRows(e,t)},t.prototype.addColumns=function(e,t){for(var o,n,r=this._commentList,i=this._commentViewList,a=0;a<r.length;a++)e<=(o=r[a])._colIndex&&(o._colIndex+=t);for(a=0;a<i.length;a++)(n=i[a]).isOpen()&&n.addColumns(e,t)},t.prototype.removeRows=function(e,t){for(var o,n,r=this._commentList,i=this._commentViewList,a=0;a<r.length;a++)(o=r[a])._rowIndex>=e&&o._rowIndex<e+t&&(this.removeComment(o),a--);for(a=0;a<r.length;a++)e<(o=r[a])._rowIndex&&(o._rowIndex-=t);for(a=0;a<i.length;a++)(n=i[a]).isOpen()&&n.removeRows(e,t)},t.prototype.removeColumns=function(e,t){for(var o,n,r=this._commentList,i=this._commentViewList,a=0;a<r.length;a++)(o=r[a])._colIndex>=e&&o._colIndex<e+t&&(this.removeComment(o),a--);for(a=0;a<r.length;a++)e<(o=r[a])._colIndex&&(o._colIndex-=t);for(a=0;a<i.length;a++)(n=i[a]).isOpen()&&n.removeColumns(e,t)},t.prototype.getActiveComment=function(){return this._activeComment},t.prototype.activateComment=function(e){e&&e!==this._activeComment&&(this.deactivateComment(),this._activeComment=e)},t.prototype.deactivateComment=function(){var e,t=this._activeComment;t&&(!(e=this.getCommentView(t))||e._isMoving||e._isResizing||(e.isEditing()&&e.detachEditor(),t.commentState(3),this._activeComment=u))},t.prototype.showComment=function(e){var t,o;e&&(o=!1,(t=this.getCommentView(e))||(o=!0,t=new r(e,this),this._addCommentView(t)),t.open(),o&&e.autoSize()&&!t._isAutosizing&&t._doAutosize())},t.prototype.showAllComments=function(){for(var e=0;e<this._commentList.length;e++)this.showComment(this._commentList[e])},t.prototype.showCommentLayoutPanel=function(){var t=this._sheet;e.GC$(t._commentRender._commentLayoutPanel).show()},t.prototype.hideComment=function(e){var t=this.getCommentView(e);t&&t.isOpen()&&(t.close(),e===this._activeComment&&this._sheet._loadAndSetSheetSelections()),clearTimeout(e._timeout),e._timeout=u},t.prototype.hideAllComments=function(){for(var e=0;e<this._commentList.length;e++)this.hideComment(this._commentList[e])},t.prototype.hideCommentLayoutPanel=function(){var t=this._sheet;e.GC$(t._commentRender._commentLayoutPanel).hide()},t.prototype.hoverShowComment=function(e){var t=this,o=t._activeComment;if(o)if(1===o.displayMode()){if(2===o.commentState())return}else if(2===o.commentState()||1===o.commentState())return;e!==t._hoverShowComment&&(t._hoverShowComment&&t.hideComment(t._hoverShowComment),e&&2==e.displayMode()?t._mouseCapture.capture||e._timeout||(t._hoverShowComment=e,e._timeout=setTimeout(function(){t.showComment(e)},200)):t._hoverShowComment=u)},t.prototype._isHitTestComment=function(e,t,o){var n,r=this.getCommentView(e);return!(!r||(n=r.getCommentRect(),!n))&&n.contains(t,o)},t.prototype._isHitTestCommentEditArea=function(e,t,o){var n,r=this.getCommentView(e);return!(!r||(n=r.getCommentEditAreaRect(),!n))&&n.contains(t,o)},t.prototype.getCommentHitInfo=function(e,t){for(var o,n=u,r=0;r<this._commentList.length;r++)o=this._commentList[r],this._sheet.canEditComment(o)&&this._isHitTestComment(o,e,t)&&(n?o.zIndex()>n.zIndex()&&(n=o):n=o);return n?this._isHitTestCommentEditArea(n,e,t)?{x:e,y:t,comment:n,area:"editArea"}:{x:e,y:t,comment:n,area:"moveResizeArea"}:u},t.prototype.getCommentActualZIndex=function(e){this._sheet;var t=this._getTopCommentZIndex();return e===this._hoverShowComment?t+2:e===this._activeComment?t+1:e.zIndex()},t.prototype._updateCommentsLayoutWhenRowColumnChanged=function(){for(var e=this._commentViewList,t=0;t<e.length;t++)e[t].updateLayoutWhenRowColumnChanged()},t.prototype.updateCommentsLayoutWhenSheetScroll=function(){for(var e=this._commentViewList,t=0;t<e.length;t++)e[t].updateLayoutWhenSheetScroll()},t.prototype.fromJSON=function(e,t){var o,r,i;if(e&&0!==e.length)for(o=0;o<e.length;o++)r=e[o],(i=new n).fromJSON(r,t),3!==i.commentState()&&(this._activeComment=i),this._sheet.setComment(i._rowIndex,i._colIndex,i)},t.prototype.toJSON=function(){var e,t,o=this._commentList;if(!o||0===o.length)return c;for(e=[],t=0;t<o.length;t++)e.push(o[t].toJSON());return 0===e.length?c:e},t}(),e.CommentManager=i,a=function(){function t(e){this._sheet=u,this.showWhenTouchMoveOrScroll=!0;this._commentLayoutPanel=this._createCommentLayoutPanel(),e.appendChild(this._commentLayoutPanel)}return t.prototype._createCommentLayoutPanel=function(){var t=document.createElement("div");return e.GC$(t).addClass("comment-layoutPanel no-user-select").css("position","absolute").css("left",0).css("top",0).css("height",0).css("width",0).css("overflow","visible").css("z-index",701).attr("unselectable","on"),t},t.prototype.renderCommentFloatPanel=function(t){var o,n,r;t._commentManager.hasComment()&&(o=t._getSheetLayout(),e.GC$(this._commentLayoutPanel).css("left",o.x+o.rowHeaderWidth).css("top",o.y+o.colHeaderHeight),this._sheet!==t&&(this._sheet&&((n=this._sheet._commentManager)&&((r=n.getActiveComment())&&2===r.commentState()&&r._changeProperty("commentState",1))),this._sheet=t))},t.prototype.renderCommentCellAdorner=function(e,t,o){var n=o.row,r=o.col,i=o.x,a=o.y,s=o.width,l=o.height;3===t&&this._sheet&&(this._sheet.getComment(n,r)&&(6,e&&s>0&&l>0&&(e.save(),e.rect(i,a,s,l),e.clip(),e.fillStyle="red",e.beginPath(),e.moveTo(i+s-6,a),e.lineTo(i+s,a),e.lineTo(i+s,a+6),e.lineTo(i+s-6,a),e.fill(),e.restore())))},t.prototype.renderComment=function(e){var t,o,n,r,i,a,s;if(this.showWhenTouchMoveOrScroll){for(e.showCommentLayoutPanel(),t=this._sheet,o=e.getCommentList(),n=0;n<o.length;n++)r=o[n],i=e.getCommentView(r),this._canShowComment(e,r)?(1===r.displayMode()&&r===e.getHoverShownComment()&&(e._hoverShowComment=u),i&&i.isOpen()?i.updateLayout():e.showComment(r)):i&&i.isOpen()&&e.hideComment(r);(a=e.getActiveComment())&&((s=e.getCommentView(a))&&s.isOpen()&&t.getSelections().length>0&&t._selectionModel.clear())}else e.hideCommentLayoutPanel()},t.prototype._canShowComment=function(e,t){var o=this._sheet;if(o.getColumnWidth(t._colIndex)&&o.getRowHeight(t._rowIndex))switch(t.displayMode()){case 1:return!0;case 2:if(3!==t.commentState())return e&&t!==e.getHoverShownComment()&&(e._hoverShowComment=t),!0;if(t===e.getHoverShownComment())return!0}return!1},t}(),e.CommentRender=a}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){!function(t){!function(o){e.feature("calc.functions_db",["calc.functions"]);var n=null,r=Math.max,i=Math.sqrt,a=t.Convert,s=t.Errors,l=(s.Null,s.DivideByZero),u=s.Value,c=(s.Reference,s.Name,s.NotAvailable,s.Number),h=function(){function e(e,t){this.criteriaOperator=e,this.criteriaValue=t}return e.prototype.evaluate=function(e){var t=this.criteriaOperator.evaluate(e,this.criteriaValue,n);return"boolean"==typeof t&&a.B(t)},e}(),p=function(){function o(t,o,n){this.row=0;if(this.database=t,this.field=o,this.criteria=n,3===arguments.length){if(this.column=this.columnIndex(t,o),t.rowCount<2||t.colCount<1)throw e.SR.Exp_InvalidCast;if(n.rowCount<2||n.colCount<1)throw e.SR.Exp_InvalidCast;if(this.column<0||this.database.colCount<=this.column)throw e.SR.Exp_InvalidCast}else{if(2!==arguments.length)throw e.SR.Exp_InvalidNull;if(this.column=-1,t.rowCount<2||t.colCount<1)throw e.SR.Exp_InvalidCast;if(n.rowCount<2||n.colCount<1)throw e.SR.Exp_InvalidCast}}return o.prototype.columnIndex=function(e,t){var o,n;if("string"==typeof t){for(o=0;o<e.colCount;o++)if((n=a.S(e[0][o]))&&this.ignoreCaseEqual(n,t))return o;return-1}return a.I(t)-1},o.prototype.current=function(){if(this.row<=0||this.database.rowCount<=this.row)throw e.SR.Exp_InvalidOperation;return this.database[this.row][this.column]},o.prototype.moveNext=function(){for(var e=!1;!e&&this.row<this.database.rowCount;)this.row++,this.row<this.database.rowCount&&(e=this.rowMeetsCriteria());return e},o.prototype.createEvaluator=function(r){var i;if("string"==typeof r){var s=a.S(r),l=new e._StringHelper(s),u=0;for(i=0;i<o.operators.length;i++)if(l.startsWith(o.operators[i].getName()))return s=s.substring(o.operators[i].getName().length),r=isNaN(u=e._NumberHelper.parseInvariant(s))?!!this.ignoreCaseEqual("true",s)||!this.ignoreCaseEqual("false",s)&&s:u,new h(o.operators[i],r);return new h(t.Operators.equal,r)}return r?new h(t.Operators.equal,r):n},o.prototype.rowMeetsCriteria=function(){for(var t,o,n,r,i,a=!1,s=1;!a&&s<this.criteria.rowCount;s++)for(a=!0,t=0;a&&t<this.criteria.colCount;t++)(o=this.createEvaluator(this.criteria[s][t]))&&(n=this.columnIndex(this.database,this.criteria[0][t]),r=this.database[this.row][n],a="="===o.criteriaOperator.name&&"string"==typeof o.criteriaValue&&"string"==typeof r&&(i=e.RegUtil.getWildcardCriteriaFullMatch(o.criteriaValue))?e.RegUtil.getRegIgnoreCase(i).test(r):o.evaluate(r));return a},o.prototype.reset=function(){this.row=0},o.prototype.ignoreCaseEqual=function(e,t){return(e=e.toLowerCase())===(t=t.toLowerCase())},o.operators=[t.Operators.equal,t.Operators.notEqual,t.Operators.lessThanOrEqual,t.Operators.greaterThanOrEqual,t.Operators.lessThan,t.Operators.greaterThan],o}();o.def("DAVERAGE",function(o){var n,r,i,s,c;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(r=o[1],(i=a.toArr(o[2],0,!1,!1,!1)).isError)return i[0];for(var h=0,d=0,f=new p(n,r,i);f.moveNext();)if(s=f.current(),a.num(s)){if(c={value:0},!a.rD(s,c))return u;h+=c.value,d++}else if(a.err(s))return s;return 0===d?l:a.toResult(h/d)},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DCOUNT",function(o){var r,i,s,l,u,c;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if((r=a.toArr(o[0],0,!1,!1,!1)).isError)return r[0];if(i=o[1],(s=a.toArr(o[2],0,!1,!1,!1)).isError)return s[0];if(l=0,u=n,t._Helper._argumentExists(o,1))for(u=new p(r,i,s);u.moveNext();)c=u.current(),a.num(c)&&l++;else for(u=new p(r,s);u.moveNext();)l++;return a.toResult(l)},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DCOUNTA",function(o){var r,i,s,l,u;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if((r=a.toArr(o[0],0,!1,!1,!1)).isError)return r[0];if(i=o[1],(s=a.toArr(o[2],0,!1,!1,!1)).isError)return s[0];if(l=0,u=n,t._Helper._argumentExists(o,1))for(u=new p(r,i,s);u.moveNext();)u.current()&&l++;else for(u=new p(r,s);u.moveNext();)l++;return a.toResult(l)},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DGET",function(t){var o,r,i,s,l;if(!t[0]||!t[1]||!t[2])throw e.SR.Exp_ArgumentNull;return(o=a.toArr(t[0],0,!1,!1,!1)).isError?o[0]:(r=t[1],(i=a.toArr(t[2],0,!1,!1,!1)).isError?i[0]:(s=n,(l=new p(o,r,i)).moveNext()?(s=l.current(),l.moveNext()?c:s):u))},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DMAX",function(o){var n,r,i,s,l;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(r=o[1],(i=a.toArr(o[2],0,!1,!1,!1)).isError)return i[0];for(var c=!1,h=-1.79769e308,d=new p(n,r,i);d.moveNext();)if(s=d.current(),a.num(s)){if(isNaN(l=a.D(s)))return u;(!c||l>h)&&(h=l),c=!0}else if(a.err(s))return s;return c?a.toResult(h):u},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DMIN",function(o){var n,r,i,s,l;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(n=t.Convert.CalcConvertedError,(r=a.toArr(o[0],0,!1,!0,!0)).isError)return r[0];if(i=o[1],(s=a.toArr(o[2],0,!1,!0,!0)).isError)return s[0];for(var c=!1,h=1.79769e308,d=new p(r,i,s);d.moveNext();)(l=d.current())!==n&&((!c||l<h)&&(h=l),c=!0);return c?a.toResult(h):u},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DPRODUCT",function(o){var n,r,i,s,l,c,h;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(r=o[1],(i=a.toArr(o[2],0,!1,!1,!1)).isError)return i[0];for(s=1,l=new p(n,r,i);l.moveNext();)if(c=l.current(),a.num(c)){if(isNaN(h=a.D(c)))return u;s*=h}else if(a.err(c))return c;return a.toResult(s)},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DSTDEV",function(o){var n,s,c,h,d;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(s=o[1],(c=a.toArr(o[2],0,!1,!1,!1)).isError)return c[0];for(var f=0,g=0,m=0,_=new p(n,s,c);_.moveNext();)if(h=_.current(),a.num(h)){if(isNaN(d=a.D(h)))return u;f+=d,g+=d*d,m++}else if(a.err(h))return h;return m<=1?l:a.toResult(i(r(0,(m*g-f*f)/(m*(m-1)))))},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DSTDEVP",function(o){var n,s,c,h,d;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(s=o[1],(c=a.toArr(o[2],0,!1,!1,!1)).isError)return c[0];for(var f=0,g=0,m=0,_=new p(n,s,c);_.moveNext();)if(h=_.current(),a.num(h)){if(isNaN(d=a.D(h)))return u;f+=d,g+=d*d,m++}else if(a.err(h))return h;return m<=0?l:a.toResult(i(r(0,(m*g-f*f)/(m*m))))},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DSUM",function(o){var n,r,i,s,l,c,h;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(r=o[1],(i=a.toArr(o[2],0,!1,!1,!1)).isError)return i[0];for(s=0,l=new p(n,r,i);l.moveNext();)if(c=l.current(),a.num(c)){if(isNaN(h=a.D(c)))return u;s+=h}else if(a.err(c))return c;return a.toResult(s)},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DVAR",function(o){var n,i,s,c,h;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(i=o[1],(s=a.toArr(o[2],0,!1,!1,!1)).isError)return s[0];for(var d=0,f=0,g=0,m=new p(n,i,s);m.moveNext();)if(c=m.current(),a.num(c)){if(isNaN(h=a.D(c)))return u;d+=h,f+=h*h,g++}else if(a.err(c))return c;return g<=1?l:a.toResult(r(0,(g*f-d*d)/(g*(g-1))))},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond}),o.def("DVARP",function(o){var n,i,s,c,h;if(!o[0]||!o[1]||!o[2])throw e.SR.Exp_ArgumentNull;if(t.Convert.CalcConvertedError,(n=a.toArr(o[0],0,!1,!1,!1)).isError)return n[0];if(i=o[1],(s=a.toArr(o[2],0,!1,!1,!1)).isError)return s[0];for(var d=0,f=0,g=0,m=new p(n,i,s);m.moveNext();)if(c=m.current(),a.num(c)){if(isNaN(h=a.D(c)))return u;d+=h,f+=h*h,g++}else if(a.err(c))return c;return g<=1?l:a.toResult(r(0,(g*f-d*d)/(g*g)))},{minArgs:3,maxArgs:3,acceptsReference:o.acceptsNotSecond,acceptsArray:o.acceptsNotSecond})}(t.Functions||(t.Functions={}));t.Functions}(e.Calc||(e.Calc={}));e.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){!function(t){!function(o){function n(){var e=[];return e[0]=.0007969367292973471,e[1]=.08283523921074408,e[2]=1.239533716464143,e[3]=5.447250030587687,e[4]=8.74716500199817,e[5]=5.303240382353949,e[6]=1,e}function r(){var e=[];return e[0]=.0007621256162081731,e[1]=.07313970569409176,e[2]=1.1271960812968493,e[3]=5.112079511468076,e[4]=8.424045901417724,e[5]=5.214515986823615,e[6]=1,e}function i(){var e=[];return e[0]=.0009244088105588637,e[1]=.08562884743544745,e[2]=1.2535274390105895,e[3]=5.470977403304171,e[4]=8.761908832370695,e[5]=5.306052882353947,e[6]=1,e}function a(){var e=[];return e[0]=.0005713231280725487,e[1]=.06884559087544954,e[2]=1.105142326340617,e[3]=5.073863861286015,e[4]=8.399855543276042,e[5]=5.209828486823619,e[6]=1,e}function s(){var e=[];return e[0]=-.011366383889846916,e[1]=-1.2825271867050931,e[2]=-19.553954425773597,e[3]=-93.20601521237683,e[4]=-177.68116798048806,e[5]=-147.07750515495118,e[6]=-51.41053267665993,e[7]=-6.050143506007285,e}function l(){var e=[];return e[0]=.05108625947501766,e[1]=4.982138729512334,e[2]=75.82382841325453,e[3]=366.7796093601508,e[4]=710.8563049989261,e[5]=597.4896124006136,e[6]=211.68875710057213,e[7]=25.207020585802372,e}function u(){var e=[];return e[0]=64.3178256118178,e[1]=856.4300259769806,e[2]=3882.4018360540163,e[3]=7240.467741956525,e[4]=5930.727011873169,e[5]=2062.0933166032783,e[6]=242.0057402402914,e}function c(){var e=[];return e[0]=74.23732770356752,e[1]=1056.4488603826283,e[2]=4986.410583376536,e[3]=9562.318924047562,e[4]=7997.041604473507,e[5]=2826.1927851763908,e[6]=336.0936078106983,e}function h(){var e=[];return e[0]=15592.436785523574,e[1]=-14663929.59039716,e[2]=5435264770.518765,e[3]=-982136065717.9115,e[4]=87590639439536.7,e[5]=-0xc5090e8ec6601,e[6]=0x9d4a5b305a0010,e[7]=-0x41b52d6418d9ec,e}function p(){var e=[];return e[0]=1041.2835366425984,e[1]=626107.330137135,e[2]=268919633.39381415,e[3]=86400248710.3935,e[4]=20297961275010.555,e[5]=3171577528429750.5,e[6]=0x37a4bf79f36ba00,e}function d(e,t,o){var n,r,i=0;n=parseFloat(t[i++]),r=o;do{n=n*e+parseFloat(t[i++])}while(0!=--r);return n}function f(e,t,o){var n,r,i=0;n=e+parseFloat(t[i++]),r=o-1;do{n=n*e+parseFloat(t[i++])}while(0!=--r);return n}function g(e){var t,o,r,a,l,c,g,m=n(),_=i(),y=s(),C=u(),w=(h(),p(),(g=[])[0]=-4794432209.782018,g[1]=1956174919465.5657,g[2]=-249248344360967.72,g[3]=9708622510473064,g),v=((c=[])[0]=499.563147152651,c[1]=173785.4016763747,c[2]=48440965.83399621,c[3]=11185553704.535683,c[4]=2112775201154.892,c[5]=310518229857422.56,c[6]=0x710505f9ecba70,c[7]=0x17be34c7b662cc00,c);return e<0&&(e=-e),e<=5?(o=e*e,e<1e-5?1-o/4:(r=(o-5.783185962946784)*(o-30.471262343662087))*d(o,w,3)/f(o,v,8)):(t=5/e,r=d(a=25/(e*e),m,6)/d(a,_,6),a=d(a,y,7)/f(a,C,7),.7978845608028654*(r=r*E(l=e-.7853981633974483)-t*a*M(l))/N(e))}function m(e){var t,o,n,i,s,u,h,p=((h=[])[0]=-899971225.7055594,h[1]=452228297998.19403,h[2]=-72749424522181.83,h[3]=0xd15a1534be241,h),g=((u=[])[0]=620.8364781180543,u[1]=256987.25675774884,u[2]=83514679.14319493,u[3]=22151159547.979248,u[4]=4749141220799.914,u[5]=784369607876235.9,u[6]=89522233618462740,u[7]=0x49de55d9c0a4e400,u),m=l(),_=c(),y=r(),C=a();return t=e,e<0&&(t=-e),t<=5?(t=d(o=e*e,p,3)/f(o,g,8))*e*(o-14.681970642123893)*(o-49.2184563216946):(n=d(o=(t=5/e)*t,y,6)/d(o,C,6),i=d(o,m,7)/f(o,_,7),.7978845608028654*(n=n*E(s=e-2.356194490192345)-t*i*M(s))/N(e))}function _(e,t){var o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y;if((y=e<0?-e:e)>31||t<=0)return U;if(t>9.55&&function(e,t,o,n,r,i,a,s,l,u,c,h,p,d){if(e>O(U))return 0;n=4*(o=t)*o,r=1,i=8*e,a=1,l=s=1,u=U,c=0;do{d=F(s=s*(n-r*r)/(a*i)),c>=t&&d>u&&(L(-(f=e)),N(H/(2*f))),u=d,l+=s,a+=1,r+=2,c+=1}while(F(s/l)>Z);var f}(t,y,o,p,d,l,h,a,s,void 0,_,0,0,r),c=0,l=.25*t*t,h=1,p=0,f=1,m=2/t,y>0){for(p=-q,o=1,_=1;_<y;_++)p+=1/o,h*=o+=1;if(f=m,1===y)c=1/t;else{for(n=1,s=r=h/y,u=-l,i=1,_=1;_<y;_++){if(s+=a=(r/=y-_)*(i*=u)/(n*=_),U-F(a)<F(s)||m>1&&U/m<f)return U;f*=m}if(a=F(s*=.5),f>1&&U/f<a||a>1&&U/a<f)return U;c=s*f}}g=2*O(.5*t),d=-q,0===y?(p=d,a=1):(p+=1/y,a=1/h),s=(d+p-g)*a,o=1;do{s+=((d+=1/o)+(p+=1/(o+y))-g)*(a*=l/(o*(o+y))),o+=1}while(F(a/s)>Z);return s=.5*s/f,0!=(1&y)&&(s=-s),c+s}function y(e){var t,o,n,i,s,u,h,p=l(),g=c(),_=r(),y=a(),C=((h=[])[0]=1263204747.9017804,h[1]=-647355876379.1603,h[2]=114509511541823.73,h[3]=-8127702555013251,h[4]=0x2cf35a16e6cd620,h[5]=-0xacf20aeef158b80,h),w=((u=[])[0]=594.3015923461282,u[1]=235564.09294306856,u[2]=73481194.44597217,u[3]=18760131610.870617,u[4]=3882312774962.3857,u[5]=620557727146953.8,u[6]=0xf41f1e2a3d2440,u[7]=0x3721e321ece8fe00,u);return e<=5?e<=0?-U:(t=e*(d(o=e*e,C,5)/f(o,w,8)))+K*(m(e)*O(e)-1/e):(n=d(o=(t=5/e)*t,_,6)/d(o,y,6),i=d(o,p,7)/f(o,g,7),(n=n*M(s=e-X)+t*i*E(s))*Y/N(e))}function C(e){var t,o,r,a,l,c=n(),m=i(),_=s(),y=u(),C=h(),w=p();return e<=5?e<=0?-U:(t=d(o=e*e,C,7)/f(o,w,7))+K*O(e)*g(e):(t=5/e,r=d(o=25/(e*e),c,6)/d(o,m,6),a=d(o,_,7)/f(o,y,7),(r=r*M(l=e-J)+t*a*E(l))*Y/N(e))}function w(e,t,o){var n,r,i,a,s,l,u,c,h,p;if(t<0)return NaN;if(h=100,r=(n=.5*e)*n,n=P(n,parseFloat(t)),i=function(e){for(var t=1,o=e;o>1;o--)t*=o;return t}(t),s=0,a=1,l=parseFloat(t),c=.9*(u=n/i),o)for(;u!==c&&0!==h;)c=u,u+=(n*=r)/(i*=++s)/(a*=++l),h--;else for(p=!1;u!==c&&0!==h;)n*=r,i*=++s,a*=++l,c=u,p?u+=n/i/a:u-=n/i/a,h--,p=!p;return u}function v(e,t){var o=P(t,10),n=parseInt(e,t);return isNaN(n)?j:(o/2<=n&&(n-=o),n)}function S(e,t,o){var n,r,i;if(e<0&&(e+=P(t,10)),(n=e.toString(t)).length<o)for(r=o-n.length,i=0;i<r;i++)n="0"+n;return n.toUpperCase()}function x(e){for(var t=0;me[t].str;t++)if(0===e.localeCompare(me[t].str))return!1;return!0}function R(e,t,o){var n;for(de=0,fe=1,n=0;e[n].str;n++)if(0===o.localeCompare(e[n].str))return de=e[n].c,!0;if(0,t)for(n=0;t[n].str;n++)o.substr(0,1).toLowerCase()===t[n].str.substr(0,1).toLowerCase()&&x(o)&&(fe=t[n].c,0);for(n=0;e[n].str;n++)if(o.substr(1,e[n].str.Length)===e[n].str.substr(0,e[n].str.Length)&&x(o))return de=e[n].c,!0;return!1}function b(e,t,o,n,r){var i,a,s,l,u,c;return 0,0,0,0,u=R(e,t,o),i=de,a=fe,c=R(e,t,n),l=fe,s=de,!!u&&(!!c&&(0!==i&&0!==l&&(ge=r*a/i*s/l,!0)))}function T(e){var n,r,i,a=D.D(e[0]);if(isNaN(a)||(n=0,t._Helper._argumentExists(e,1)&&(n=D.D(e[1]),isNaN(n))))return G;if(typeof(i=o._StatHelper.st_normsdist([a*N(2)]))==typeof t.Errors)return NaN;if(r=2*parseFloat(i)-1,t._Helper._argumentExists(e,1)){if(typeof(i=o._StatHelper.st_normsdist([n*N(2)]))==typeof t.Errors)return NaN;r=2*parseFloat(i)-1-r}return r}function A(e){var o,n=D.D(e[0]);return isNaN(n)?G:typeof(o=T([n]))==typeof t.Errors?NaN:1-parseFloat(o)}e.feature("calc.functions_eng",["calc.functions"]);var I=null,D=t.Convert,F=Math.abs,M=Math.sin,E=Math.cos,N=Math.sqrt,O=Math.log,P=Math.pow,L=Math.exp,H=Math.PI,k=Math.E,V=Math.atan2,B=(Math.floor,t.Errors),z=(B.Null,B.DivideByZero),G=B.Value,W=(B.Reference,B.Name,B.NotAvailable),j=B.Number,U=1.7976931348623157e308,Y=.7978845608028654,X=2.356194490192345,K=.6366197723675814,J=.7853981633974483,Z=1.1102230246251565e-16,q=.5772156649015329,$=function(){function t(e,t){this._real=e,this._imag=t}return t.prototype.real=function(){return this._real},t.prototype.imag=function(){return this._imag},t.prototype.toString=function(e){e||(e="i");var t=this,o="";return(0!==t._real||0===t._imag)&&(o+=t._real.toString()),-1===t._imag?o+="-":0!==t._real&&t._imag>0&&(o+="+"),-1!==t._imag&&0!==t._imag&&1!==t._imag&&(o+=t._imag.toString()),0!==t._imag&&(o+=e),o},t._parse=function(o){var n=0,r=0,i=!1,a=!1,s=!1,l=0,u=0,c=0;if(!o)throw e.SR.Exp_ArgumentNull;if(0===o.length)throw e.SR.Exp_Format;for(c<o.length&&("+"===o.charAt(c)||"-"===o.charAt(c))&&c++;c<o.length&&!isNaN(Number(o.charAt(c)));)c++,i=!0;for(c<o.length&&"."===o.charAt(c)&&c++;c<o.length&&!isNaN(Number(o.charAt(c)));)c++,i=!0;if(c<o.length&&("E"===o.charAt(c)||"e"===o.charAt(c)))for(i=!1,++c<o.length&&("+"===o.charAt(c)||"-"===o.charAt(c))&&c++;c<o.length&&!isNaN(Number(o.charAt(c)));)c++,i=!0;if(c<o.length&&("+"===o.charAt(c)||"-"===o.charAt(c))){for(l=c,c++;c<o.length&&!isNaN(Number(o.charAt(c)));)c++,a=!0;for(c<o.length&&"."===o.charAt(c)&&c++;c<o.length&&!isNaN(Number(o.charAt(c)));)c++,a=!0;if(c<o.length&&("E"===o.charAt(c)||"e"===o.charAt(c)))for(a=!1,++c<o.length&&("+"===o.charAt(c)||"-"===o.charAt(c))&&c++;c<o.length&&!isNaN(Number(o.charAt(c)));)c++,a=!0;c<o.length&&("i"===o.charAt(c)||"j"===o.charAt(c))&&(c++,s=!0),u=c-l}else c<o.length&&("i"===o.charAt(c)||"j"===o.charAt(c))?(u=++c,a=i,s=!0,i=!1):l=c;if(c<o.length)throw e.SR.Exp_Format;if(l>0){if(!i)throw e.SR.Exp_Format;n=parseInt(o.substr(0,l),10)}if(u>0){if(!s)throw e.SR.Exp_Format;if(1===u)r=1;else if(2===u&&"+"===o.charAt(l))r=1;else if(2===u&&"-"===o.charAt(l))r=-1;else{if(!a)throw e.SR.Exp_Format;r=parseInt(o.substr(l,u-1),10)}}return new t(n,r)},t}(),Q=function(){function e(){}return e._toComplex=function(e){try{return e?e.constructor===Number?new $(parseFloat(e),0):e.constructor===String?$._parse(e):null:new $(0,0)}catch(e){return null}},e._toResult=function(e,t){return isNaN(e.real())||e.real()===Number.POSITIVE_INFINITY||isNaN(e.imag())||e.imag()===Number.POSITIVE_INFINITY?j:e.toString(t)},e}(),ee=1e4/254/12/3,te=273.15,oe=function(){return function(e,t){this.str=e,this.c=t}}(),ne=[new oe("g",1),new oe("sg",6852205001e-14),new oe("lbm",.002204622915),new oe("u",6.02217e23),new oe("ozm",.035273972),new oe(I,0)],re=[new oe("m",1),new oe("mi",.000621371192237334),new oe("Nmi",1/1852),new oe("in",1e4/254),new oe("ft",1e4/254/12),new oe("yd",ee),new oe("ang",1e10),new oe("Pica",2834.645669),new oe("km",.001),new oe(I,0)],ie=[new oe("yr",1),new oe("day",365.25),new oe("hr",8766),new oe("mn",525960),new oe("sec",31557600),new oe(I,0)],ae=[new oe("Pa",1),new oe("atm",9869233e-12),new oe("mmHg",.00750061708),new oe("p",1),new oe("at",9869233e-12),new oe(I,0)],se=[new oe("N",1),new oe("dyn",1e5),new oe("lbf",.224808924),new oe("dy",1e5),new oe(I,0)],le=[new oe("J",1),new oe("e",9999995.193),new oe("c",.239006249),new oe("cal",.238846191),new oe("eV",62146e14),new oe("HPh",1/2684523.6),new oe("Wh",1/3600),new oe("flb",23.73042222),new oe("BTU",947815e-9),new oe("ev",62146e14),new oe("hh",1/2684523.6),new oe("wh",1/3600),new oe("btu",947815e-9),new oe(I,0)],ue=[new oe("HP",1),new oe("W",745.701),new oe("h",1),new oe("w",745.701),new oe(I,0)],ce=[new oe("T",1),new oe("ga",1e4),new oe(I,0)],he=[new oe("tsp",1),new oe("tbs",1/3),new oe("oz",1/6),new oe("cup",1/48),new oe("pt",1/96),new oe("qt",1/192),new oe("gal",1/768),new oe("l",.0049289216),new oe("uk_pt",.008675585),new oe("us_pt",1/96),new oe("lt",.0049289216),new oe(I,0)],pe=[new oe("Y",1e24),new oe("Z",1e21),new oe("E",1e18),new oe("P",1e15),new oe("T",1e12),new oe("G",1e9),new oe("M",1e6),new oe("k",1e3),new oe("h",100),new oe("e",10),new oe("d",.1),new oe("c",.01),new oe("m",.001),new oe("u",1e-6),new oe("n",1e-9),new oe("p",1e-12),new oe("f",1e-15),new oe("a",1e-18),new oe("z",1e-21),new oe("y",1e-24),new oe(I,0)],de=0,fe=0,ge=0,me=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];o.def("BESSELI",function(e){var t,o=D.D(e[0]);return isNaN(o)?G:(t=D.I(e[1]),isNaN(t)?G:t<0?j:D.toResult(w(o,t,!0)))},{minArgs:2,maxArgs:2}),o.def("BESSELJ",function(e){var t,o=D.D(e[0]);return isNaN(o)?G:(t=D.I(e[1]),isNaN(t)?G:t<0?j:D.toResult(w(o,t,!1)))},{minArgs:2,maxArgs:2}),o.def("BESSELK",function(e){var t,o=D.D(e[0]);return isNaN(o)?G:(t=D.I(e[1]),isNaN(t)?G:o<=0?j:t<0?j:D.toResult(_(t,o)))},{minArgs:2,maxArgs:2}),o.def("BESSELY",function(e){var t,o=D.D(e[0]);return isNaN(o)?G:(t=D.I(e[1]),isNaN(t)?G:o<=0?j:t<0?j:D.toResult(function(e,t){var o,n,r,i,a,s;if(s=e<0?0==(1&(e=-e))?1:-1:1,0===e)return s*C(t);if(1===e)return s*y(t);if(t<=0)return-U;r=C(t),n=y(t),i=2*(a=1);do{o=i*n/t-r,r=n,n=o,i+=2,++a}while(a<e);return s*o}(t,o)))},{minArgs:2,maxArgs:2}),o.def("BIN2DEC",function(e){var t,o=D.S(e[0]);return o.length>10?j:(t=v(o,2)).length<o.length?j:t},{minArgs:1,maxArgs:1}),o.def("BIN2HEX",function(e){var o,n,r=D.S(e[0]),i=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return r.length>10?j:i<1||10<i?j:(o=v(r,2)).length<r.length?j:i<(n=S(o,16,i)).length&&0<=o&&t._Helper._argumentExists(e,1)?j:n},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("BIN2OCT",function(e){var o,n,r=D.S(e[0]),i=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return 10<r.length?j:i<1||10<i?j:(o=v(r,2)).length<r.length?j:(n=S(o,8,i),0<=o&&i<n.length&&t._Helper._argumentExists(e,1)?j:n)},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("DEC2BIN",function(e){var o,n=D.D(e[0]),r=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return n<-512||511<n?j:r<1||10<r?j:0<=(o=S(n,2,r))&&r<o.length&&t._Helper._argumentExists(e,1)?j:o},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("DEC2HEX",function(e){var o,n=D.D(e[0]),r=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return n<-549755813888||549755813887<n?j:r<1||10<r?j:0<=(o=S(n,16,r))&&r<o.length&&t._Helper._argumentExists(e,1)?j:o},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("DEC2OCT",function(e){var o,n=D.D(e[0]),r=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return n<-536870912||536870911<n?j:r<1||10<r?j:0<=(o=S(n,8,r))&&r<o.length&&t._Helper._argumentExists(e,1)?j:o},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("HEX2BIN",function(e){var o,n,r=D.S(e[0]),i=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return 10<r.length?j:i<1||10<i?j:(o=v(r.toLowerCase(),16)).length<r.length?j:o<-512||511<o?j:(n=S(o,2,i),0<=o&&i<n.length&&t._Helper._argumentExists(e,1)?j:n)},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("HEX2DEC",function(e){var t,o=D.S(e[0]);return 10<o.length?j:(t=v(o.toLowerCase(),16)).length<o.length?j:D.toResult(t)},{minArgs:1,maxArgs:1}),o.def("HEX2OCT",function(e){var o,n,r=D.S(e[0]),i=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return 10<r.length?j:i<1||10<i?j:(o=v(r,16)).length<r.length?j:o<-536870912||536870911<o?j:(n=S(o,8,i),0<=o&&i<n.length&&t._Helper._argumentExists(e,1)?j:n)},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("OCT2BIN",function(e){var o,n,r=D.S(e[0]),i=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return 10<r.length?j:i<1||10<i?j:(o=v(r,8)).length<r.length?j:o<-512||511<o?j:(n=S(o,2,i),0<=o&&i<n.length&&t._Helper._argumentExists(e,1)?j:n)},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("OCT2DEC",function(e){var t,o=D.S(e[0]);return 10<o.length?j:(t=v(o,8)).length<o.length?j:D.toResult(t)},{minArgs:1,maxArgs:1}),o.def("OCT2HEX",function(e){var o,n,r=D.S(e[0]),i=t._Helper._argumentExists(e,1)?D.I(e[1]):1;return 10<r.length?j:i<1||10<i?j:(o=v(r,8)).length<r.length?j:o<-549755813888||549755813887<o?j:(n=S(o,16,i),0<=o&&i<n.length&&t._Helper._argumentExists(e,1)?j:n)},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("ERF",T,{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("ERF.PRECISE",function(e){var t=D.D(e[0]);return isNaN(t)?G:T([t])},{minArgs:1,maxArgs:1}),o.def("ERFC",A,{minArgs:1,maxArgs:1}),o.def("ERFC.PRECISE",A,{minArgs:1,maxArgs:1}),o.def("DELTA",function(e){var n,r=D.D(e[0]);return isNaN(r)?G:(n=0,t._Helper._argumentExists(e,1)&&(n=D.D(e[1]),isNaN(n))?G:o._MathHelper.approxEqual(r,n)?1:0)},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("GESTEP",function(e){var o,n=D.D(e[0]);return isNaN(n)?G:(o=0,t._Helper._argumentExists(e,1)&&(o=D.D(e[1]),isNaN(o))?G:n>=o?1:0)},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne}),o.def("COMPLEX",function(e){var o,n=D.D(e[0]),r=D.D(e[1]);return isNaN(n)||isNaN(r)?G:"i"!==(o=t._Helper._argumentExists(e,2)?D.S(e[2]):"i")&&"j"!==o?G:Q._toResult(new $(n,r),o)},{minArgs:2,maxArgs:3,acceptsMissingArgument:o.acceptsTwo}),o.def("IMABS",function(e){var t,o,n=Q._toComplex(e[0]);return n?(t=n.real(),o=n.imag(),D.toResult(N(t*t+o*o))):j},{minArgs:1,maxArgs:1}),o.def("IMAGINARY",function(e){var t=Q._toComplex(e[0]);return t?D.toResult(t.imag()):j},{minArgs:1,maxArgs:1}),o.def("IMARGUMENT",function(e){var t,o,n=Q._toComplex(e[0]);return n?(t=n.real(),o=n.imag(),0===t&&0===o?z:D.toResult(V(o,t))):j},{minArgs:1,maxArgs:1}),o.def("IMCONJUGATE",function(e){var t,o,n=Q._toComplex(e[0]);return n?(t=n.real(),o=n.imag(),Q._toResult(new $(t,-o))):j},{minArgs:1,maxArgs:1}),o.def("IMCOS",function(e){var t,n,r=Q._toComplex(e[0]);return r?(t=r.real(),n=r.imag(),Q._toResult(new $(E(t)*o._MathHelper.cosh(n),-M(t)*o._MathHelper.sinh(n)))):j},{minArgs:1,maxArgs:1}),o.def("IMDIV",function(e){var t=Q._toComplex(e[0]),o=Q._toComplex(e[1]);if(!t||!o)return j;var n=t.real(),r=t.imag(),i=o.real(),a=o.imag();return 0===i&&0===a?j:Q._toResult(new $((n*i+r*a)/(i*i+a*a),(r*i-n*a)/(i*i+a*a)))},{minArgs:2,maxArgs:2}),o.def("IMEXP",function(e){var t,o,n=Q._toComplex(e[0]);return n?(t=n.real(),o=n.imag(),Q._toResult(new $(L(t)*E(o),L(t)*M(o)))):j},{minArgs:1,maxArgs:1}),o.def("IMLN",function(e){var t,o,n,r,i=Q._toComplex(e[0]);return i?(t=i.real(),o=i.imag(),0===t&&0===o?j:(n=N(t*t+o*o),r=V(o,t),Q._toResult(new $(O(n),r)))):j},{minArgs:1,maxArgs:1}),o.def("IMLOG10",function(e){var t,n,r=Q._toComplex(e[0]);if(!r||(t=r.real(),n=r.imag(),0===t&&0===n))return j;var i=N(t*t+n*n),a=V(n,t),s=o._MathHelper.log10(k);return Q._toResult(new $(s*O(i),s*a))},{minArgs:1,maxArgs:1}),o.def("IMLOG2",function(e){var t,n,r=Q._toComplex(e[0]);if(!r||(t=r.real(),n=r.imag(),0===t&&0===n))return j;var i=N(t*t+n*n),a=V(n,t),s=o._MathHelper.log(k,2);return Q._toResult(new $(s*O(i),s*a))},{minArgs:1,maxArgs:1}),o.def("IMPOWER",function(e){var t,o,n,r,i,a=Q._toComplex(e[0]);return a?(t=parseFloat(e[1]),isNaN(t)?G:(o=a.real(),n=a.imag(),0===o&&0===n?t>0?Q._toResult(new $(0,0)):j:(r=N(o*o+n*n),i=V(n,o),Q._toResult(new $(P(r,t)*E(t*i),P(r,t)*M(t*i)))))):j},{minArgs:2,maxArgs:2}),o.def("IMPRODUCT",function(e){for(var o,n,r,i,a,s,l,u,c,h,p=1,d=0,f=0;f<e.length;f++)if(e[f].constructor===t.CalcArray)for(o=e[f],i=0;i<o.rowCount;i++)for(a=0;a<o.columnCount;a++){if(!(s=Q._toComplex(o.getValue(i,a))))return j;u=d,p=(l=p)*(c=s.real())-u*(h=s.imag()),d=l*h+u*c}else if(D.ref(e[f]))for(n=e[f],r=0;r<n.getRangeCount();r++)for(i=0;i<n.getRowCount(r);i++)for(a=0;a<n.getColumnCount(r);a++){if(!(s=Q._toComplex(n.getValue(r,i,a))))return j;u=d,p=(l=p)*(c=s.real())-u*(h=s.imag()),d=l*h+u*c}else{if(!(s=Q._toComplex(e[f])))return j;u=d,p=(l=p)*(c=s.real())-u*(h=s.imag()),d=l*h+u*c}return Q._toResult(new $(p,d))},{minArgs:1,maxArgs:255,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("IMREAL",function(e){var t=Q._toComplex(e[0]);return t?D.toResult(t.real()):j},{minArgs:1,maxArgs:1}),o.def("IMSIN",function(e){var t,n,r=Q._toComplex(e[0]);return r?(t=r.real(),n=r.imag(),Q._toResult(new $(M(t)*o._MathHelper.cosh(n),E(t)*o._MathHelper.sinh(n)))):j},{minArgs:1,maxArgs:1}),o.def("IMSQRT",function(e){var t,o,n,r,i=Q._toComplex(e[0]);return i?(t=i.real(),o=i.imag(),0===t&&0===o?Q._toResult(new $(0,0)):(n=N(t*t+o*o),r=V(o,t),Q._toResult(new $(N(n)*E(r/2),N(n)*M(r/2))))):j},{minArgs:1,maxArgs:1}),o.def("IMSUB",function(e){var t=Q._toComplex(e[0]),o=Q._toComplex(e[1]);if(!t||!o)return j;var n=t.real(),r=t.imag(),i=o.real(),a=o.imag();return Q._toResult(new $(n-i,r-a))},{minArgs:2,maxArgs:2}),o.def("IMSUM",function(e){for(var t,o,n,r,i,a,s,l=0,u=0,c=0;c<e.length;c++)if(D.arr(e[c]))for(t=e[c],r=0;r<t.rowCount;r++)for(i=0;i<t.columnCount;i++){if(!(a=Q._toComplex(t.getValue(r,i))))return j;s=u,l+=a.real(),u=s+a.imag()}else if(D.ref(e[c]))for(o=e[c],n=0;n<o.getRangeCount();n++)for(r=0;r<o.getRowCount(n);r++)for(i=0;i<o.getColumnCount(n);i++){if(!(a=Q._toComplex(o.getValue(n,r,i))))return j;s=u,l+=a.real(),u=s+a.imag()}else{if(!(a=Q._toComplex(e[c])))return j;s=u,l+=a.real(),u=s+a.imag()}return Q._toResult(new $(l,u))},{minArgs:1,maxArgs:255,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("CONVERT",function(e){var t,o,n=parseFloat(e[0]);return isNaN(n)?G:(t=D.S(e[1]),o=D.S(e[2]),t&&""!==t&&o&&""!==o?(0===t.localeCompare("C")||0===t.localeCompare("cel"))&&0===o.localeCompare("C")||0===o.localeCompare("cel")?n:(0!==t.localeCompare("F")&&0!==t.localeCompare("fah")||0!==o.localeCompare("F")&&0!==o.localeCompare("fah"))&&(0!==t.localeCompare("K")&&0!==t.localeCompare("kel")||0!==o.localeCompare("K")&&0!==o.localeCompare("kel"))?0!==t.localeCompare("C")&&0!==t.localeCompare("cel")||0!==o.localeCompare("F")&&0!==o.localeCompare("fah")?0!==t.localeCompare("F")&&0!==t.localeCompare("fah")||0!==o.localeCompare("C")&&0!==o.localeCompare("cel")?0!==t.localeCompare("F")&&0!==t.localeCompare("fah")||0!==o.localeCompare("F")&&0!==o.localeCompare("fah")?0!==t.localeCompare("F")&&0!==t.localeCompare("fah")||0!==o.localeCompare("K")&&0!==o.localeCompare("kel")?0!==t.localeCompare("K")&&0!==t.localeCompare("kel")||0!==o.localeCompare("F")&&0!==o.localeCompare("fah")?0!==t.localeCompare("C")&&0!==t.localeCompare("cel")||0!==o.localeCompare("K")&&0!==o.localeCompare("kel")?0!==t.localeCompare("K")&&0!==t.localeCompare("kel")||0!==o.localeCompare("C")&&0!==o.localeCompare("cel")?b(ne,pe,t,o,n)?ge:b(re,pe,t,o,n)?ge:b(ie,I,t,o,n)?ge:b(ae,pe,t,o,n)?ge:b(se,pe,t,o,n)?ge:b(le,pe,t,o,n)?ge:b(ue,pe,t,o,n)?ge:b(ce,pe,t,o,n)?ge:b(he,pe,t,o,n)?ge:b(ce,pe,t,o,n)?ge:W:n-te:n+te:9*(n-te)/5+32:5*(n-32)/9+te:n:5*(n-32)/9:9*n/5+32:n:W)},{minArgs:3,maxArgs:3})}(t.Functions||(t.Functions={}));t.Functions}(e.Calc||(e.Calc={}));e.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){!function(t){!function(o){function n(e){return e instanceof Date?o._FinancialHelper.__toOADate(e):e}function r(e,t,r){var i,a,s,l,u,c,h,p,d;switch(s=e.getFullYear(),a=e.getMonth(),i=e.getDate(),u=t.getFullYear(),l=t.getMonth(),h=t.getDate()-i,c=12*(u-s)+(c=l-a),oe(s),r){case 0:return(d=[])[0]=e,d[1]=t,o._DateHelper.days360(d);case 1:case 2:case 3:return p=n(e),n(t)-p;case 4:return 30*c+h;default:return-1}}function i(e,t,o,n,r){var i,a;return 0===e?i=(o+n)/t:(a=j(1+e,t),i=r>0?(n*e/(a-1)+o*e/(1-1/a))/(1+e):n*e/(a-1)+o*e/(1-1/a)),-i}function a(e,t,o,n,r){var i,a;return 0===e?i=n+o*t:(a=j(1+e,t),i=r>0?n*a+o*(1+e)*(a-1)/e:n*a+o*(a-1)/e),-i}function s(e,t,o,n,r){var i,a,s;s=j(1+e,t),i=isNaN(s)||!isFinite(s)?te:s,a=function(e,t){if(0===e)return t;var o=(j(1+e,t)-1)/e;return isNaN(o)||!isFinite(o)?te:o}(e,t);var l=(-o*i-n)/((1+e*W.D(r))*a);return isNaN(l)||!isFinite(l)?te:l}function l(e,t,o,n){var r=j(1+o,n),i=-(e*r*o+t*(r-1));return isNaN(i)||!isFinite(i)?te:i}function u(e,t,o,n){var r,i,a,s,l=new Date(1,0,1);l.setFullYear(1),s=0,a=t.getDate()===ie(t.getFullYear(),t.getMonth()),r=12/o,(i=t.getFullYear()-e.getFullYear())>0&&(i=(i-1)*o);do{i++,(l=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setMonth(l.getMonth()-i*r),a&&(s=ie(l.getFullYear(),l.getMonth()),l=new Date(l.getFullYear(),l.getMonth(),s))}while(ne(e,l)<0);return n&&(i--,(l=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setMonth(l.getMonth()-i*r),a&&(s=ie(l.getFullYear(),l.getMonth()),l=new Date(l.getFullYear(),l.getMonth(),s))),l}function c(e,t,o,n){var r=u(e,t,o,!1);return ae(r,e,n)}function h(e,t,o,n){var r,i;switch(n){case 0:case 2:case 4:case 5:return 360/o;case 3:return 365/o;default:return i=u(e,t,o,!0),r=u(e,t,o,!1),ae(r,i,1)}}function p(e,t,o,n){var r=u(e,t,o,!0);return ae(e,r,n)}function d(e,t,o){var n,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(n=t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),r.setMonth(r.getMonth()-n),t.getDate()===ie(t.getFullYear(),t.getMonth()))for(;r.getDate()!==ie(r.getFullYear(),r.getMonth());)r.setDate(r.getDate()+1);return e.getDate()>=r.getDate()&&n--,parseInt((1+n/(12/o)).toString(),10)}function f(e,o,n,r,i,a,s){var l,u=0,c=0;for(n*=100/t.Convert.D(i),r/=i,r+=1,l=1;l<s;l++)u+=l*n/j(r,l);for(u+=s*(n+100)/j(r,s),l=1;l<s;l++)c+=n/j(r,l);return(u/=c+=(n+100)/j(r,s))/t.Convert.D(i)}function g(e){return e.havexpos=e.havexneg=!1,e.xmin=-1e10,e.xmax=1e10,e.precision=1e-10,e}function m(e,t,o){return t>0?(o.havexpos?o.havexneg?U(e-o.xneg)<U(o.xpos-o.xneg)&&(o.xpos=e,o.ypos=t):t<o.ypos&&(o.xpos=e,o.ypos=t):(o.xpos=e,o.ypos=t,o.havexpos=!0),[!1,o]):t<0?(o.havexneg?o.havexpos?U(e-o.xpos)<U(o.xpos-o.xneg)&&(o.xneg=e,o.yneg=t):-t<-o.yneg&&(o.xneg=e,o.yneg=t):(o.xneg=e,o.yneg=t,o.havexneg=!0),[!1,o]):(o.root=e,[!0,o])}function _(e,t,o,n,r,i,a){var s,l,u,f,g,m,_,y,C;for(s=c(e,t,i,a),l=p(e,t,i,a),u=h(e,t,i,a),C=parseInt(d(e,t,i).toString(),10),f=0,g=100*o/i,m=1+n/i,_=l/u,y=0;y<C;y++)f+=g/j(m,_+y);return r/j(m,C-1+l/u)+f-s/u*g}function y(e,t,o,n,r){var i,a,s;if(i=u(e,o,n,!0),a=u(e,o,n,!1),ne(i,t)>=0)return ae(e,t,r)/h(a,i,n,r);for(s=ae(e,i,r)/h(a,i,n,r);;){if(a=new Date(i.getFullYear(),i.getMonth(),i.getDate()),i.setMonth(i.getMonth()+12/n),ne(i,t)>=0)return s+ae(a,t,r)/h(a,i,n,r);s+=1}}function C(e,t,o,n,r,i,a,s,l){var u,c,p,f=ae(o,e,l),g=ae(e,n,l),m=ae(o,n,l),_=h(e,t,s,l),C=parseInt(d(e,t,s).toString(),10),w=100*r/s,v=1+i/s;if(g>_)switch(l){case 0:case 4:u=ae(n,t,l),C=1+parseInt(Y(u/_).toString(),10);break;default:for(c=new Date(n.getFullYear(),n.getMonth(),n.getDate()),32767,C=0;C<32767;C++)if(p=new Date(c.getFullYear(),c.getMonth(),c.getDate()),c.setMonth(c.getMonth()+12/s),ne(c,t)>=0){C+=parseInt((Y(ae(p,t,l))/h(p,c,s,l)).toString(),10)+1;break}f=_*y(o,e,n,s,l),g=_*y(e,n,n,s,l),m=_*y(o,n,n,s,l)}return a/j(v,C-1+g/_)+w*(m/_/j(v,g/_)+j(v,-g/_)*(j(v,-C)-1/v)/(1/v-1)-f/_)}function w(e,t){var n=e.substr(0,3),r=o._MathHelper.round;switch(e[0]){case"A":if("ATS"===n)return r(13.7603,t);break;case"B":if("BEF"===n)return r(40.3399,t);break;case"D":if("DEM"===n)return r(1.95583,t);break;case"E":if("ESP"===n)return r(166.386,t);if("EUR"===n)return r(1,t);break;case"F":if("FIM"===n)return r(5.94573,t);if("FRF"===n)return r(6.55957,t);break;case"G":if("GRD"===n)return r(340.75,t);break;case"I":if("IEP"===n)return r(.787564,t);if("ITL"===n)return r(1936.27,t);break;case"L":if("LUX"===n||"LUF"===n)return r(40.3399,t);break;case"N":if("NLG"===n)return r(2.20371,t);break;case"P":if("PTE"===n)return r(200.482,t)}return-1}function v(e,t,o,n,r,i,a,s,l){return[!0,_(o,n,r,e,a,s,l)-i]}function S(e,t,o,n,r,i,a,s,l,u,c){var h,p,d,f,g=0,m=0;return(h=e-o)<n.xmin&&(h=e),(p=e+o)>n.xmax&&(p=e),h===p?[!1,t,n]:(g=(f=v(h,0,r,i,a,s,l,u,c))[1],(d=f[0])?(m=(f=v(p,0,r,i,a,s,l,u,c))[1],(d=f[0])?[!0,t=(m-g)/(p-h),n]:[d,t,n]):[d,t,n])}function x(e,t,o,n,r,i,a,s,l,u,c,h,p,d){var f,g,_,y;switch(d){case 0:c=e.xpos-e.ypos*((e.xneg-e.xpos)/(e.yneg-e.ypos));break;case 1:if(h=(g=v(c=(e.xpos+e.xneg)/2,0,t,o,n,r,i,a,s))[1],!(p=g[0]))return[G,e,u,c,h,d];if(0===h)return[!0,e=m(c,h,e)[1],u,c,h,d];if(0===(f=K(h*h-e.ypos*e.yneg)))return[G,e,u,c,h,d];c+=(c-e.xpos)*h/f;break;case 3:c=(e.xpos+e.xneg)/2;break;case 2:var C=0,w=0,R=0;if(l>.1)return x(e,t,o,n,r,i,a,s,l,u,c,h,p,d=3);switch(u++%4){case 0:C=e.xpos,C=e.ypos;break;case 2:C=e.xneg,w=e.yneg;break;default:case 3:case 1:if(w=(_=v(C=(e.xpos+e.xneg)/2,0,t,o,n,r,i,a,s))[1],!(p=_[0]))return[G,e,u,c,h,d]}if(e=(y=S(C,R,U(e.xpos-e.xneg)/1e6,e,t,o,n,r,i,a,s))[2],R=y[1],!(p=y[0]))return[G,e,u,c,h,d];if(0===R)return[G,e,u,c,h,d];if((c=C-1.01*w/R)<e.xpos&&c<e.xneg||c>e.xpos&&c>e.xneg)return[G,e,u,c,h,d]}return[!1,e,u,c,h,d]}function R(e,t,o,n,r,i,a,s,l,u,c){return[!0,C(o,n,r,i,a,e,l,u,c)-s]}function b(e,t,o,n,r,i,a,s,l,u,c,h,p){var d,f,g,m,_=0,y=0;return(d=e-o)<n.xmin&&(d=e),(f=e+o)>n.xmax&&(f=e),d===f?[!1,t,n]:(_=(m=R(d,0,r,i,a,s,l,u,c,h,p))[1],(g=m[0])?(y=(m=R(f,0,r,i,a,s,l,u,c,h,p))[1],(g=m[0])?[!0,t=(y-_)/(f-d),n]:[g,t,n]):[g,t,n])}function T(e,t,o,n,r,i,a,s,l,u,c,h,p,d,f,g){var _,y,C,w;switch(g){case 0:p=e.xpos-e.ypos*((e.xneg-e.xpos)/(e.yneg-e.ypos));break;case 1:if(d=(y=R(p=(e.xpos+e.xneg)/2,0,t,o,n,r,i,a,s,l,u))[1],!(f=y[0]))return[G,e,h,p,d,g];if(0===d)return[!0,e=m(p,d,e)[1],h,p,d,g];if(0===(_=K(d*d-e.ypos*e.yneg)))return[G,e,h,p,d,g];p+=(p-e.xpos)*d/_;break;case 3:p=(e.xpos+e.xneg)/2;break;case 2:var v=0,S=0,x=0;if(c>.1)return T(e,t,o,n,r,i,a,s,l,u,c,h,p,d,f,g=3);switch(h++%4){case 0:v=e.xpos,v=e.ypos;break;case 2:v=e.xneg,S=e.yneg;break;default:case 3:case 1:if(S=(C=R(v=(e.xpos+e.xneg)/2,0,t,o,n,r,i,a,s,l,u))[1],!(f=C[0]))return[G,e,h,p,d,g]}if(e=(w=b(v,x,U(e.xpos-e.xneg)/1e6,e,t,o,n,r,i,a,s,l,u))[2],x=w[1],!(f=w[0]))return[G,e,h,p,d,g];if(0===x)return[G,e,h,p,d,g];if((p=v-1.01*S/x)<e.xpos&&p<e.xneg||p>e.xpos&&p>e.xneg)return[G,e,h,p,d,g]}return[!1,e,h,p,d,g]}function A(e,t,o){for(var n=o.length,r=0,i=1,a=1/(e+1),s=0;s<n;s++)r+=o[s]*i,i*=a;return[!0,r]}function I(e,t,o){for(var n=o.length,r=0,i=1,a=1/(e+1),s=1;s<n;s++)r+=o[s]*-s*i,i*=a;return[!0,r]}function D(e,t,o){var n,r,i=0;return o<e.xmin||o>e.xmax?[!1,e]:(i=(r=A(o,0,t))[1],(n=r[0])?(e=(r=m(o,i,e))[1],r[0]?[!0,e]:[!1,e]):[n,e])}function F(e,t,o,n,r,i,a,s){var l,u,c,h,p,d,f,g,_,y,C,w,v,S,x,R,b,T,I;switch(s){case 0:r=e.xpos-e.ypos*((e.xneg-e.xpos)/(e.yneg-e.ypos));break;case 1:if(i=(u=A(r=(e.xpos+e.xneg)/2,0,t))[1],!(a=u[0]))return[G,e,n,r,i,s];if(0===i)return[!0,e=m(r,i,e)[1],n,r,i,s];if(0===(l=K(i*i-e.ypos*e.yneg)))return[G,e,n,r,i,s];r+=(r-e.xpos)*i/l;break;case 3:r=(e.xpos+e.xneg)/2;break;case 2:if(p=0,d=0,o>.1)return F(e,t,o,n,r,i,a,s=3);switch(n++%4){case 0:c=e.xpos,c=e.ypos;break;case 2:c=e.xneg,p=e.yneg;break;default:case 3:case 1:if(p=(f=A(c=(e.xpos+e.xneg)/2,0,t))[1],!(a=f[0]))return[G,e,n,r,i,s]}if(h=U(e.xpos-e.xneg)/1e6,y=d,v=t,T=0,I=0,(S=(_=c)-(C=h))<(w=e).xmin&&(S=_),(x=_+C)>w.xmax&&(x=_),e=(g=S===x?[!1,y,w]:(T=(b=A(S,0,v))[1],(R=b[0])?(I=(b=A(x,0,v))[1],(R=b[0])?[!0,y=(I-T)/(x-S),w]:[R,y,w]):[R,y,w]))[2],!(a=g[0]))return[G,e,n,r,i,s];if(0===(d=g[1]))return[G,e,n,r,i,s];if((r=c-1.01*p/d)<e.xpos&&r<e.xneg||r>e.xpos&&r>e.xneg)return[G,e,n,r,i,s];break;default:return[!1,e,n,r,i,s]}return[!1,e,n,r,i,s]}function M(e,t,r,i){for(var a,s=0,l=i.length,u=0;u<l;u++){if((a=n(r[u])-n(r[0]))<0)return[!1,t];s+=i[u]/o._MathHelper.pow1p(e,a/365)}return isFinite(s)?t=isNaN(s)?5e-324:s:s===Number.POSITIVE_INFINITY?t=1.79769e308:s===Number.NEGATIVE_INFINITY&&(t=-1.79769e308),[!0,t]}function E(e,t,o,n,r,i){var a,s,l,u,c=0,h=0;return(a=e-o)<n.xmin&&(a=e),(s=e+o)>n.xmax&&(s=e),a===s?[!1,t,n]:(c=(u=M(a,c,r,i))[1],(l=u[0])?(h=(u=M(s,h,r,i))[1],(l=u[0])?[!0,t=(h-c)/(s-a),n]:[l,t,n]):[l,t,n])}function N(e,t,o,n,r){var i,a;return t<e.xmin||t>e.xmax?[!1,e,o]:(o=(a=M(t,o,n,r))[1],(i=a[0])?(e=(a=m(t,0,e))[1],a[0]?[!0,e,o]:[!1,e,o]):[i,e,o])}function O(e,t,o,n,r,i,a,s,l){var u,c,h,p;switch(l){case 0:i=e.xpos-e.ypos*((e.xneg-e.xpos)/(e.yneg-e.ypos));break;case 1:if(a=(c=M(i=(e.xpos+e.xneg)/2,a,t,o))[1],!(s=c[0]))return[G,e,r,i,a,l];if(0===a)return[!0,e=m(i,a,e)[1],r,i,a,l];if(0===(u=K(a*a-e.ypos*e.yneg)))return[G,e,r,i,a,l];i+=(i-e.xpos)*a/u;break;case 3:i=(e.xpos+e.xneg)/2;break;case 2:var d=0,f=0,g=0;if(n>.1)return O(e,t,o,n,r,i,a,s,l=3);switch(r++%4){case 0:d=e.xpos,d=e.ypos;break;case 2:d=e.xneg,f=e.yneg;break;default:case 3:case 1:if(f=(h=M(d=(e.xpos+e.xneg)/2,f,t,o))[1],!(s=h[0]))return[G,e,r,i,a,l]}if(e=(p=E(d,g,U(e.xpos-e.xneg)/1e6,e,t,o))[2],g=p[1],!(s=p[0]))return[G,e,r,i,a,l];if(0===g)return[G,e,r,i,a,l];if((i=d-1.01*f/g)<e.xpos&&i<e.xneg||i>e.xpos&&i>e.xneg)return[G,e,r,i,a,l]}return[!1,e,r,i,a,l]}function P(e,t,o){var n,r,i,a,s,l,u,c=0;if(!e.havexpos||!e.havexneg)return[!1,e];for(r=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)),n=0;n<108;n++)if(e=(l=O(e,t,o,r,c,i=0,a=0,s,n%4==0?1:n%4==2?2:3))[1],c=l[2],i=l[3],a=l[4],l[5],l[0]){if(l[0])return[!0,e];if(a=(u=M(i,a,t,o))[1],s=u[0]){if(e=(u=m(i,a,e))[1],u[0])return[!0,e];if((r=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)))<e.precision)return e.yneg<a&&(a=e.yneg,i=e.xneg),e.ypos<a&&(a=e.ypos,i=e.xpos),e.root=i,[!0,e]}}return[!1,e]}function L(e,t,o,n,r){var i,a,s,l;return(a=r/o)>=1?(a=1,s=1===n?e:0):s=e*j(1-a,n-1),(i=(l=e*j(1-a,n))<t?s-t:s-l)<0&&(i=0),i}function H(e,t,o,n,r,i){for(var a,s,l=0,u=Y(r),c=W.I(u),h=e-t,p=!1,d=0,f=1;f<=c;f++)p?a=d:(d=h/(n-(f-1)))>(s=L(e,t,o,f,i))?(a=d,p=!0):(a=s,h-=s),f===c&&(a*=r+1-u),l+=a;return l}function k(e,t,o){if(e>-1&&0!==e){var n=o,r=j(1+e,n.nper),i=(j(1+e,n.nper)-1)/e;return[!0,t=n.pv*r+n.pmt*(1+e*n.type)*i+n.fv,o]}return[!1,t,o]}function V(e,t,o){if(e>-1&&0!==e){var n=o,r=j(1+e,n.nper-1),i=(j(1+e,n.nper)-1)/e;return[!0,t=-n.pmt*i/e+r*n.nper*(n.pv+n.pmt*(n.type+1/e)),o]}return[!1,t,o]}function B(e,t,o){var n,r,i,a=0;return o<e.xmin||o>e.xmax?[!1,e,t]:(t=(r=k(o,a,t))[2],a=r[1],(n=r[0])?(e=(i=m(o,a,e))[1],i[0]?[!0,e,t]:[!1,e,t]):[n,e,t])}function z(e,t,o,n,r,i,a,s){var l,u,c,h,p,d,f,g,_,y,C,w,v,S,x,R,b,T;switch(s){case 0:r=e.xpos-e.ypos*((e.xneg-e.xpos)/(e.yneg-e.ypos));break;case 1:if(t=(u=k(r=(e.xpos+e.xneg)/2,i,t))[2],i=u[1],!(a=u[0]))return[G,e,t,n,r,i,s];if(0===i)return[!0,e=m(r,i,e)[1],t,n,r,i,s];if(0===(l=K(i*i-e.ypos*e.yneg)))return[G,e,t,n,r,i,s];r+=(r-e.xpos)*i/l;break;case 3:r=(e.xpos+e.xneg)/2;break;case 2:if(p=0,d=0,o>.1)return z(e,t,o,n,r,i,a,s=3);switch(n++%4){case 0:c=e.xpos,c=e.ypos;break;case 2:c=e.xneg,p=e.yneg;break;default:case 3:case 1:if(t=(u=k(c=(e.xpos+e.xneg)/2,p,t))[2],p=u[1],!(a=u[0]))return[G,e,t,n,r,i,s]}if(h=U(e.xpos-e.xneg)/1e6,_=d,w=t,b=0,T=0,(v=(g=c)-(y=h))<(C=e).xmin&&(v=g),(S=g+y)>C.xmax&&(S=g),t=(f=v===S?[!1,_,C,w]:(w=(R=k(v,b,w))[2],b=R[1],(x=R[0])?(w=(R=k(S,T,w))[2],T=R[1],(x=R[0])?[!0,_=(T-b)/(S-v),C,w]:[x,_,C,w]):[x,_,C,w]))[3],e=f[2],!(a=f[0]))return[G,e,t,n,r,i,s];if(0===(d=f[1]))return[G,e,t,n,r,i,s];if((r=c-1.01*p/d)<e.xpos&&r<e.xneg||r>e.xpos&&r>e.xneg)return[G,e,t,n,r,i,s];break;default:return[!1,e,t,n,r,i,s]}return[!1,e,t,n,r,i,s]}e.feature("calc.functions_fin",["calc.functions"]);var G=null,W=t.Convert,j=Math.pow,U=Math.abs,Y=Math.ceil,X=Math.log,K=Math.sqrt,J=Math.floor,Z=Math.max,q=Math.min,$=t.Errors,Q=($.Null,$.DivideByZero),ee=$.Value,te=($.Reference,$.Name,$.NotAvailable,$.Number),oe=o._FinancialHelper.__isLeapYear,ne=o._FinancialHelper.__compareDateTime,re=o._FinancialHelper.__annual_year_basis,ie=o._FinancialHelper.__getDaysInMonth,ae=(o._FinancialHelper.__Days_Between_BASIS_30E_360,o._FinancialHelper.__Days_Between_BASIS_30Ep_360,o._FinancialHelper.__Days_Between_BASIS_MSRB_30_360_SYM,o._FinancialHelper.__Days_Between_BASIS_MSRB_30_360,o._FinancialHelper.__days_between_basis);o.def("FV",function(e){var o=W,n=t._Helper,r=o.D(e[0]),i=o.D(e[1]),a=o.D(e[2]),s=n._argumentExists(e,3)?o.D(e[3]):0,l=n._argumentExists(e,4)?o.D(e[4]):0;return 0!==l&&(l=1),0===r?o.toResult(-(a*i+s)):o.toResult(-(s*j(1+r,i)+a*(1+r*l)*(j(1+r,i)-1)/r))},{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsThreeFour}),o.def("FVSCHEDULE",function(e){var o,n,r=t.Convert.D(e[0]),i=t.Convert.toArr(e[1],1,!0,!0,!1);if(i.isError)return i[0];for(o=0;o<i.length;o++)(n=i[o])!==t.Convert.CalcConvertedError&&(r*=1+n);return r},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsOne,acceptsReference:o.acceptsOne}),o.def("NPV",function(e){for(var o,n,r,i=t.Convert.D(e[0]),a=0,s=1,l=1;l<e.length;l++){if(t.Convert.err(e[l]))return e[l];if((o=t.Convert.toArr(e[l],1,!0,!0,!1)).isError)return o[0];for(n=0;n<o.length;n++)(r=o[n])!==t.Convert.CalcConvertedError&&(a+=r/j(1+i,s),s++)}return a},{minArgs:2,acceptsArray:o.acceptsPositive,acceptsReference:o.acceptsPositive}),o.def("PV",function(e){var o=W,n=t._Helper,r=o.D(e[0]),i=o.D(e[1]),a=o.D(e[2]),s=n._argumentExists(e,3)?o.D(e[3]):0,l=n._argumentExists(e,4)?o.D(e[4]):0;return 0!==l&&(l=1),0===r?o.toResult(-(a*i+s)):-1===r?Q:o.toResult(-(s+a*(1+r*l)*(j(1+r,i)-1)/r)/j(1+r,i))},{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsThreeFour}),o.def("RECEIVED",function(e){var o,n,i,a=W,s=t._Helper,l=a.DT(e[0]),u=a.DT(e[1]),c=a.D(e[2]),h=a.D(e[3]),p=s._argumentExists(e,4)?a.I(e[4]):0;return ne(l,u)>=0?te:c<=0||h<=0||p<0||4<p?te:(o=r(l,u,p),n=re(l,p),o<=0||n<=0?te:(i=1-h*o/n)<=0?te:c/i)},{minArgs:4,maxArgs:5,acceptsMissingArgument:o.acceptsFour}),o.def("XNPV",function(e){var o,n,r=t.Convert.D(e[0]),i=t.Convert.toArr(e[1],1,!0,!0,!0),a=t.Convert.toArr(e[2],1,!0,!0,!0),s=i.length;if(s!==a.length)return te;if(i.isError)return i[0];if(a.isError)return a[0];if(i.isConvertError||a.isConvertError)return ee;for(o=0,n=0;n<s;n++)o+=i[n]/j(1+r,(a[n]-a[0])/365);return o},{minArgs:3,maxArgs:3,acceptsArray:o.acceptsNotZero,acceptsReference:o.acceptsNotZero}),o.def("CUMIPMT",function(e){var o=t.Convert.D(e[0]),n=t.Convert.I(e[1]),r=t.Convert.D(e[2]),s=t.Convert.I(e[3]),l=t.Convert.I(e[4]),u=t.Convert.I(e[5]);return s<1||l<s||o<=0||l>n||n<=0||r<=0||0!==u&&1!==u?te:function(e,t,o,n,r,s){var l,u,c;for(l=i(e,t,o,0,s),u=0,1===n&&(s<=0&&(u=-o),n++),c=n;c<=r;c++)u+=s>0?a(e,c-2,l,o,1)-l:a(e,c-1,l,o,0);return u*e}(o,n,r,s,l,u)},{minArgs:6,maxArgs:6}),o.def("CUMPRINC",function(e){var o=t.Convert.D(e[0]),n=t.Convert.I(e[1]),r=t.Convert.D(e[2]),s=t.Convert.I(e[3]),l=t.Convert.I(e[4]),u=t.Convert.I(e[5]);return s<1||l<s||o<=0||l>n||n<=0||r<=0||0!==u&&1!==u?te:function(e,t,o,n,r,s){var l,u,c;for(l=i(e,t,o,0,s),u=0,1===n&&(u=s<=0?l+o*e:l,n++),c=n;c<=r;c++)u+=s>0?l-(a(e,c-2,l,o,1)-l)*e:l-a(e,c-1,l,o,0)*e;return u}(o,n,r,s,l,u)},{minArgs:6,maxArgs:6}),o.def("IPMT",function(e){var o=W,n=t._Helper,r=o.D(e[0]),i=o.D(e[1]),a=o.D(e[2]),u=o.D(e[3]),c=n._argumentExists(e,4)?o.D(e[4]):0,h=n._argumentExists(e,5)?o.I(e[5]):0;return i<1||i>=a+1||a<1?te:l(u,s(r,a,u,c,h),r,i-1)},{minArgs:4,maxArgs:6,acceptsMissingArgument:o.acceptsFourFive}),o.def("ISPMT",function(e){var o=t.Convert.D(e[0]),n=t.Convert.I(e[1]),r=t.Convert.I(e[2]),i=t.Convert.D(e[3]);return 0===r?Q:t.Convert.toResult(i*o*(t.Convert.D(n)/t.Convert.D(r)-1))},{minArgs:4,maxArgs:4}),o.def("PMT",function(e){var o=W,n=t._Helper,r=o.D(e[0]),i=o.D(e[1]),a=o.D(e[2]),s=n._argumentExists(e,3)?o.D(e[3]):0,l=n._argumentExists(e,4)?o.D(e[4]):0;return 0!==l&&(l=1),0===r?0===i?Q:o.toResult(-(a+s)/i):0===i?Q:o.toResult(-(a*j(1+r,i)+s)/((1+r*l)*(j(1+r,i)-1)/r))},{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsThreeFour}),o.def("PPMT",function(e){var o,n=W,r=t._Helper,i=n.D(e[0]),a=n.D(e[1]),u=n.D(e[2]),c=n.D(e[3]),h=r._argumentExists(e,4)?n.D(e[4]):0,p=!!r._argumentExists(e,5)&&n.B(e[5]);return a<1||a>=u+1?te:(o=s(i,u,c,h,p?1:0))-l(c,o,i,a-1)},{minArgs:4,maxArgs:6,acceptsMissingArgument:o.acceptsFourFive}),o.def("COUPDAYBS",function(e){var o=W,n=t._Helper,r=o.DT(e[0]),i=o.DT(e[1]),a=o.I(e[2]),s=n._argumentExists(e,3)?o.I(e[3]):0,l=te;return s<0||s>4?l:1!==a&&2!==a&&4!==a?l:ne(r,i)>=0?l:c(r,i,a,s)},{minArgs:3,maxArgs:4,acceptsMissingArgument:o.acceptsThree}),o.def("COUPDAYS",function(e){var o=W,n=t._Helper,r=o.DT(e[0]),i=o.DT(e[1]),a=o.I(e[2]),s=n._argumentExists(e,3)?o.I(e[3]):0,l=te;return s<0||s>4?l:1!==a&&2!==a&&4!==a?l:ne(r,i)>=0?l:h(r,i,a,s)},{minArgs:3,maxArgs:4,acceptsMissingArgument:o.acceptsThree}),o.def("COUPDAYSNC",function(e){var o=W,n=t._Helper,r=o.DT(e[0]),i=o.DT(e[1]),a=o.I(e[2]),s=n._argumentExists(e,3)?o.I(e[3]):0;return s<0||s>4?te:1!==a&&2!==a&&4!==a?te:ne(r,i)>=0?te:p(r,i,a,s)},{minArgs:3,maxArgs:4,acceptsMissingArgument:o.acceptsThree}),o.def("COUPNCD",function(e){var o=W,r=t._Helper,i=o.DT(e[0]),a=o.DT(e[1]),s=o.I(e[2]),l=r._argumentExists(e,3)?o.I(e[3]):0;return l<0||l>4?te:1!==s&&2!==s&&4!==s?te:ne(i,a)>=0?te:n(u(i,a,s,!0))},{minArgs:3,maxArgs:4,acceptsMissingArgument:o.acceptsThree}),o.def("COUPNUM",function(e){var o=W,n=t._Helper,r=o.DT(e[0]),i=o.DT(e[1]),a=o.I(e[2]),s=n._argumentExists(e,3)?o.I(e[3]):0;return s<0||s>4?te:1!==a&&2!==a&&4!==a?te:ne(r,i)>=0?te:d(r,i,a)},{minArgs:3,maxArgs:4,acceptsMissingArgument:o.acceptsThree}),o.def("COUPPCD",function(e){var o=W,r=(t._Helper,o.DT(e[0])),i=o.DT(e[1]),a=o.I(e[2]),s=t._Helper._argumentExists(e,3)?o.I(e[3]):0;return s<0||s>4?te:1!==a&&2!==a&&4!==a?te:ne(r,i)>=0?te:n(u(r,i,a,!1))},{minArgs:3,maxArgs:4,acceptsMissingArgument:o.acceptsThree}),o.def("DURATION",function(e){var o=W,n=t._Helper,r=o.DT(e[0]),i=o.DT(e[1]),a=o.D(e[2]),s=o.D(e[3]),l=o.I(e[4]),u=n._argumentExists(e,5)?o.I(e[5]):0;return u<0||u>4?te:1!==l&&2!==l&&4!==l?te:ne(r,i)>0?te:f(0,0,a,s,l,0,d(r,i,l))},{minArgs:5,maxArgs:6,acceptsMissingArgument:o.acceptsFive}),o.def("MDURATION",function(e){var o,n,r,i=W,a=t._Helper,s=i.DT(e[0]),l=i.DT(e[1]),u=i.D(e[2]),c=i.D(e[3]),h=i.I(e[4]),p=a._argumentExists(e,5)?i.I(e[5]):0;return p<0||p>4?te:1!==h&&2!==h&&4!==h?te:ne(s,l)>0?te:(o=d(s,l,h),f(0,0,u,n=c,r=h,0,o)/(1+n/W.D(r)))},{minArgs:5,maxArgs:6,acceptsMissingArgument:o.acceptsFive}),o.def("NPER",function(e){var o=W,n=t._Helper,r=o.D(e[0]),i=o.D(e[1]),a=o.D(e[2]),s=n._argumentExists(e,3)?o.D(e[3]):0,l=n._argumentExists(e,4)?o.D(e[4]):0;return 0!==l&&(l=1),0===r?0===i?Q:o.toResult(-(a+s)/i):r<=-1?te:o.toResult(X((i*(1+r*l)-s*r)/(a*r+i*(1+r*l)))/X(1+r))},{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsThreeFour}),o.def("YIELD",function(e){var o,n,r,i,a,s,l,u,f,_,y,C,w,R,b,T,A=W,I=t._Helper,D=A.DT(e[0]),F=A.DT(e[1]),M=A.D(e[2]),E=A.D(e[3]),N=A.D(e[4]),O=A.I(e[5]),P=I._argumentExists(e,6)?A.I(e[6]):0;if(P<0||P>4||1!==O&&2!==O&&4!==O||ne(D,F)>0||M<0||E<0||N<=0)return te;if(d(D,F,O)<=1){var L=c(D,F,O,P),H=p(D,F,O,P),k=h(D,F,O,P);return(N/100+M/O-(E/100+L/k*M/O))/(E/100+L/k*M/O)*(O*k/H)}if(r=.1,(o={}).xmin=0,o.xmax=0,o.precision=0,o.havexpos=!1,o.xpos=0,o.ypos=0,o.havexneg=!1,o.xneg=0,o.yneg=0,o.root=0,(o=g(o)).xmin=Z(o.xmin,0),o.xmax=q(o.xmax,1e3),o=(i=function(e,t,o,n,r,i,a,s,l){for(var u,c,h,p,d,f,g,_=e.precision/2,y=0;y<20;y++){if(p=0,d=0,l<e.xmin||l>e.xmax)return[!1,e];if(p=(f=v(l,0,t,o,n,r,i,a,s))[1],!(u=f[0]))return[u,e];if(e=(f=m(l,p,e))[1],f[0])return[!0,e];if(e=(g=S(l,d,U(l)<1e-10?e.havexneg&&e.havexpos?U(e.xpos-e.xneg)/1e6:(e.xmax-e.xmin)/1e6:U(l)/1e6,e,t,o,n,r,i,a,s))[2],d=g[1],!(u=g[0]))return[u,e];if(0===d)return[!1,e];if((c=l-1.000001*p/d)===l)return e.root=l,[!0,e];if(h=U(c-l)/(U(l)+U(c)),l=c,h<_)return e.root=l,[!0,e]}return[!1,e]}(o,D,F,M,E,N,O,P,r))[1],!(n=i[0])){for(r=1e-10;r<o.xmax;r*=2)o=(a=o,s=D,l=F,u=M,f=E,_=N,y=O,C=P,w=r,R=void 0,b=void 0,T=void 0,T=0,w<a.xmin||w>a.xmax?[!1,a]:(T=(b=v(w,0,s,l,u,f,_,y,C))[1],(R=b[0])?(a=(b=m(w,T,a))[1],b[0]?[!0,a]:[!1,a]):[R,a]))[1];o=(i=function(e,t,o,n,r,i,a,s){var l,u,c,h,p,d,f,g,_=0;if(!e.havexpos||!e.havexneg)return[!1,e];for(u=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)),l=0;l<108;l++)if(e=(d=x(e,t,o,n,r,i,a,s,u,_,c=0,h=0,p,l%4==0?1:l%4==2?2:3))[1],_=d[2],c=d[3],h=d[4],d[5],d[0]){if(d[0])return[!0,e];if(h=(f=v(c,0,t,o,n,r,i,a,s))[1],p=f[0]){if(e=(g=m(c,h,e))[1],g[0])return[!0,e];if((u=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)))<e.precision)return e.yneg<h&&(h=e.yneg,c=e.xneg),e.ypos<h&&(h=e.ypos,c=e.xpos),e.root=c,[!0,e]}}return[!1,e]}(o,D,F,M,E,N,O,P))[1],n=i[0]}return n?o.root:te},{minArgs:6,maxArgs:7,acceptsMissingArgument:o.acceptsSix}),o.def("YIELDDISC",function(e){var n=W,r=t._Helper,i=n.DT(e[0]),a=n.DT(e[1]),s=n.D(e[2]),l=n.D(e[3]),u=r._argumentExists(e,4)?n.I(e[4]):0;return u<0||u>4?te:l<=0||s<=0||ne(i,a)>=0?te:(l/s-1)/o._DateHelper.yearfrac([i,a,u])},{minArgs:4,maxArgs:5,acceptsMissingArgument:o.acceptsFour}),o.def("YIELDMAT",function(e){var n,r,i,a,s,l,u,c,h=W,p=t._Helper,d=h.DT(e[0]),f=h.DT(e[1]),g=h.DT(e[2]),m=h.D(e[3]),_=h.D(e[4]),y=p._argumentExists(e,5)?h.I(e[5]):0;return y<0||y>4||m<0?te:(n=d,r=f,i=g,a=m,s=_,l=y,u=o._DateHelper.yearfrac,c=1+u([i,r,l])*a,c/=s/100+u([i,n,l])*a,--c/u([n,r,l]))},{minArgs:5,maxArgs:6,acceptsMissingArgument:o.acceptsFive}),o.def("ODDFYIELD",function(e){var o,n,r,i,a,s,l,u,c,h,p,d,f,_,y,C,w=W,v=t._Helper,S=w.DT(e[0]),x=w.DT(e[1]),A=w.DT(e[2]),I=w.DT(e[3]),D=w.D(e[4]),F=w.D(e[5]),M=w.D(e[6]),E=w.I(e[7]),N=v._argumentExists(e,8)?w.I(e[8]):0,O=.1,P={};if(N<0||N>4||1!==E&&2!==E&&4!==E||ne(A,S)>0||ne(S,I)>0||ne(I,x)>0||D<0||F<=0||M<=0)return te;if(P.xmin=0,P.xmax=0,P.precision=0,P.havexpos=!1,P.xpos=0,P.ypos=0,P.havexneg=!1,P.xneg=0,P.yneg=0,P.root=0,(P=g(P)).xmin=Z(P.xmin,0),P.xmax=q(P.xmax,1e3),P=(o=function(e,t,o,n,r,i,a,s,l,u,c){for(var h,p,d,f,g,_,y,C=e.precision/2,w=0;w<20;w++){if(f=0,g=0,c<e.xmin||c>e.xmax)return[!1,e];if(f=(_=R(c,0,t,o,n,r,i,a,s,l,u))[1],!(h=_[0]))return[h,e];if(e=(_=m(c,f,e))[1],_[0])return[!0,e];if(e=(y=b(c,g,U(c)<1e-10?e.havexneg&&e.havexpos?U(e.xpos-e.xneg)/1e6:(e.xmax-e.xmin)/1e6:U(c)/1e6,e,t,o,n,r,i,a,s,l,u))[2],g=y[1],!(h=y[0]))return[h,e];if(0===g)return[!1,e];if((p=c-1.000001*f/g)===c)return e.root=c,[!0,e];if(d=U(p-c)/(U(c)+U(p)),c=p,d<C)return e.root=c,[!0,e]}return[!1,e]}(P,S,x,A,I,D,F,M,E,N,O))[1],n=o[0]){for(O=1e-10;O<P.xmax;O*=2)P=(r=P,i=S,a=x,s=A,l=I,u=D,c=F,h=M,p=E,d=N,f=O,_=void 0,y=void 0,C=void 0,C=0,f<r.xmin||f>r.xmax?[!1,r]:(C=(y=R(f,0,i,a,s,l,u,c,h,p,d))[1],(_=y[0])?(r=(y=m(f,C,r))[1],y[0]?[!0,r]:[!1,r]):[_,r]))[1];P=(o=function(e,t,o,n,r,i,a,s,l,u){var c,h,p,d,f,g,_,y,C=0;if(!e.havexpos||!e.havexneg)return[!1,e];for(h=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)),c=0;c<108;c++)if(e=(g=T(e,t,o,n,r,i,a,s,l,u,h,C,p=0,d=0,f,c%4==0?1:c%4==2?2:3))[1],C=g[2],p=g[3],d=g[4],g[5],void 0!==g[0]&&g[0]!==G){if(g[0])return[!0,e];if(d=(_=R(p,0,t,o,n,r,i,a,s,l,u))[1],f=_[0]){if(e=(y=m(p,d,e))[1],y[0])return[!0,e];if((h=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)))<e.precision)return e.yneg<d&&(d=e.yneg,p=e.xneg),e.ypos<d&&(d=e.ypos,p=e.xpos),e.root=p,[!0,e]}}return[!1,e]}(P,S,x,A,I,D,F,M,E,N))[1],n=o[0]}return n?P.root:te},{minArgs:8,maxArgs:9,acceptsMissingArgument:o.acceptsEight}),o.def("ODDLYIELD",function(e){var o=W,n=t._Helper,r=o.DT(e[0]),i=o.DT(e[1]),a=o.DT(e[2]),s=o.D(e[3]),l=o.D(e[4]),u=o.D(e[5]),c=o.I(e[6]),h=n._argumentExists(e,7)?o.I(e[7]):0;return h<0||h>4||1!==c&&2!==c&&4!==c||ne(r,i)>0||ne(a,r)>0?te:s<0||l<0||u<=0?te:function(e,t,o,n,r,i,a,s){var l,u,c=new Date(o.getFullYear(),o.getMonth(),o.getDate());do{c.setMonth(c.getMonth()+12/a)}while(ne(c,t)<0);return l=y(o,e,c,a,s),(a*(i-r)+100*n*(y(o,t,c,a,s)-l))/((u=y(e,t,c,a,s))*r+100*n*l*u/a)}(r,i,a,s,l,u,c,h)},{minArgs:7,maxArgs:8,acceptsMissingArgument:o.acceptsSeven}),o.def("TBILLEQ",function(e){var o,r,i,a=t.Convert.DT(e[0]),s=t.Convert.DT(e[1]),l=t.Convert.D(e[2]);return ne(a,s)>=0||l<=0||(o=n(s)-n(a))>365?te:(r=365*l,0==(i=360-l*o)?Q:i<0?te:t.Convert.toResult(r/i))},{minArgs:3,maxArgs:3}),o.def("TBILLYIELD",function(e){var o,r=t.Convert.DT(e[0]),i=t.Convert.DT(e[1]),a=t.Convert.D(e[2]);return ne(r,i)>=0?te:a<=0?te:(o=n(i)-n(r))>365?te:(100-a)/a*(360/o)},{minArgs:3,maxArgs:3}),o.def("IRR",function(e){var o,n,r,i,a,s,l,u,c,h,p={xmin:0,xmax:0,precision:0,havexpos:!1,xpos:0,ypos:0,havexneg:!1,xneg:0,yneg:0,root:0};p=g(p);var d=W,f=t._Helper,_=d.toArr(e[0],1,!0,!0,!1);if(_.isError)return _[0];if((o=_.length)<2)return te;for(n=f._argumentExists(e,1)?d.D(e[1]):.1,U(n)>1&&(n=.1),r=[],p.xmin=-1,p.xmax=q(p.xmax,j(1.79769e298,1/o)-1),i=!1,a=!1,s=0;s<o;s++)(l=_[s])!==d.CalcConvertedError&&(r[s]=l,l>0&&(i=!0),l<0&&(a=!0));if(!i||!a)return te;if(p=(u=function(e,t,o){for(var n,r,i,a,s,l,u=e.precision/2,c=0;c<20;c++){if(a=0,s=0,o<e.xmin||o>e.xmax)return[!1,e];if(a=(l=A(o,0,t))[1],!(i=l[0]))return[i,e];if(e=(l=m(o,a,e))[1],l[0])return[!0,e];if(s=(l=I(o,0,t))[1],!(i=l[0]))return[i,e];if(0===s)return[!1,e];if((n=o-1.000001*a/s)===o)return e.root=o,[!0,e];if(r=U(n-o)/(U(o)+U(n)),o=n,r<u)return e.root=o,[!0,e]}return[!1,e]}(p,r,n))[1],!(c=u[0])){for(h=2;(!p.havexneg||!p.havexpos)&&h<100;h*=2)p=D(p=D(p,r,n*h)[1],r,n/h)[1];p=(u=function(e,t){var o,n,r,i,a,s,l,u=0;if(!e.havexpos||!e.havexneg)return[!1,e];for(n=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)),o=0;o<160;o++)if(e=(s=F(e,t,n,u,r,i=0,a,o%4==0?1:o%4==2?2:3))[1],u=s[2],r=s[3],i=s[4],s[5],s[0]!==G){if(s[0])return[!0,e];if(i=(l=A(r,0,t))[1],a=l[0]){if(e=(l=m(r,i,e))[1],l[0])return[!0,e];if((n=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)))<e.precision)return e.yneg<i&&(i=e.yneg,r=e.xneg),e.ypos<i&&(i=e.ypos,r=e.xpos),e.root=r,[!0,e]}}return[!1,e]}(p,r))[1],c=u[0]}return c?p.root:te},{minArgs:1,maxArgs:2,acceptsMissingArgument:o.acceptsOne,acceptsArray:o.acceptsZero,acceptsReference:o.acceptsZero}),o.def("MIRR",function(e){var o,n,r,i,a,s,l=t.Convert.D(e[1]),u=t.Convert.D(e[2]),c=0,h=0,p=0,d=0,f=[],g=t.Convert.toArr(e[0],1,!0,!0,!1);if(g.isError)return g[0];if(g.length<2)return Q;for(n=g.length,r=0;r<n;r++)(i=g[r])!==t.Convert.CalcConvertedError&&(f[r]=i,i>=0?c++:h++);for(o=h+c,a=0;a<o;a++)(s=f[a])>=0?p+=s/j(1+u,a):d+=s/j(1+l,a);return 0===d||0===p||u<=-1?Q:j(-p*j(1+u,o)/(d*(1+u)),1/(o-1))-1},{minArgs:3,maxArgs:3,acceptsArray:o.acceptsZero,acceptsReference:o.acceptsZero}),o.def("XIRR",function(e){var o,n,r,i,a,s=t.Convert,l=s.toArr(e[0],1,!0,!0,!0),u=s.toArr(e[1],4,!0,!0,!0);if(l.isError)return l[0];if(u.isError)return u[0];if(l.isConvertError||u.isConvertError)return ee;if(l.length!==u.length)return te;if(o=t._Helper._argumentExists(e,2)?W.D(e[2]):.1,(n={}).xmin=0,n.xmax=0,n.precision=0,n.havexpos=!1,n.xpos=0,n.ypos=0,n.havexneg=!1,n.xneg=0,n.yneg=0,n.root=0,(n=g(n)).xmin=-1,n.xmax=q(1e3,n.xmax),n=(r=function(e,t,o,n){for(var r,i,a=e.precision/2,s=0;s<20;s++){var l,u,c=0,h=0,p=M(n,c,t,o);if(c=p[1],!(r=p[0]))return[r,e];if(e=(p=m(n,c,e))[1],p[0])return[!0,e];if(r=(i=E(n,h,U(n)<1e-10?e.havexneg&&e.havexpos?U(e.xpos-e.xneg)/1e6:(e.xmax-e.xmin)/1e6:U(n)/1e6,e,t,o))[0],h=i[1],e=i[2],!r)return[r,e];if(0===h)return[!1,e];if((l=n-1.000001*c/h)===n)return e.root=n,[!0,e];if(u=U(l-n)/(U(n)+U(l)),n=l,u<a)return e.root=n,[!0,e]}return[!1,e]}(n,u,l,o))[1],r[0])return n.root;for(i=1;i<=1024;i+=i){var c=W.D(i),h=9/(c+9),p=N(n,o,h,u,l);if(n=p[1],h=p[2],n=(p=N(n,o,h=c,u,l))[1],h=p[2],n=(a=P(n,u,l))[1],a[0])return n.root}return te},{minArgs:2,maxArgs:3,acceptsMissingArgument:o.acceptsTwo,acceptsArray:o.acceptsNotTwo,acceptsReference:o.acceptsNotTwo}),o.def("AMORDEGRC",function(e){var n=W.D(e[0]),r=W.DT(e[1]),i=W.DT(e[2]),a=W.D(e[3]),s=W.I(e[4]),l=W.D(e[5]),u=t._Helper._argumentExists(e,6)?W.I(e[6]):0,c=1/l;return c>0&&c<1||c>1&&c<2||c>2&&c<3||c>4&&c<5?te:ne(r,i)>0?te:u<0||u>4||l<=0||2===u?te:function(e,t,n,r,i,a,s){var l,u,c,h,p;if(a*=(h=1/a)<3?1:h<5?1.5:h<=6?2:2.5,p=o._DateHelper.yearfrac([t,n,s]),W.err(p))return 0;for(c=(e-=u=J(p*a*e+.5))-r,l=0;l<i;l++){if((c-=u=J(a*e+.5))<0)switch(i-l){case 0:case 1:return J(.5*e+.5);default:return 0}e-=u}return u}(n,r,i,a,s,l,u)},{minArgs:6,maxArgs:7,acceptsMissingArgument:o.acceptsSix}),o.def("AMORLINC",function(e){var n=W.D(e[0]),r=W.DT(e[1]),i=W.DT(e[2]),a=W.D(e[3]),s=W.I(e[4]),l=W.D(e[5]),u=t._Helper._argumentExists(e,6)?W.I(e[6]):0;return ne(r,i)>0?te:u<0||u>4||l<=0||2===u?te:function(e,t,n,r,i,a,s){var l=e*a,u=e-r,c=o._DateHelper.yearfrac([t,n,s]);if(W.err(c))return 0;var h=c*a*e,p=(e-r-h)/l,d=W.I((e-r-h)/l);return 0===i?h:i<=d?l*(p<1?p:1):i===d+1?u-l*d-h:0}(n,r,i,a,s,l,u)},{minArgs:6,maxArgs:7,acceptsMissingArgument:o.acceptsSix}),o.def("DB",function(e){var n,r=W.D(e[0]),i=W.D(e[1]),a=W.I(e[2]),s=W.I(e[3]),l=t._Helper._argumentExists(e,4)?W.I(e[4]):12;if(r<0||a<1||s<1||a+(l<12?1:0)<s||l<1||12<l)return te;if(0===r)return 0;var u=o._MathHelper.round(1-j(i/r,1/a),3),c=0,h=0;for(n=1;n<=s;n++)c+=h=1===n?r*u*l/12:n===a+1?(r-c)*u*(12-l)/12:(r-c)*u;return h},{minArgs:4,maxArgs:5,acceptsMissingArgument:o.acceptsFour}),o.def("DDB",function(e){var o,n=W.D(e[0]),r=W.D(e[1]),i=W.I(e[2]),a=W.I(e[3]),s=t._Helper._argumentExists(e,4)?W.D(e[4]):2,l=0,u=0;if(i<=0||n<0||i<a||s<=0||a<=0)return te;if(n<=r)return 0;for(o=1;o<=a;o++)l+=u=q(u=s/i*(n-l),n-l-r);return u},{minArgs:4,maxArgs:5,acceptsMissingArgument:o.acceptsFour}),o.def("SLN",function(e){var t=W.D(e[0]),o=W.D(e[1]),n=W.I(e[2]);return 0===n?Q:(t-o)/n},{minArgs:3,maxArgs:3}),o.def("SYD",function(e){var t=W.D(e[0]),o=W.D(e[1]),n=W.I(e[2]),r=W.I(e[3]);return o<0||n<1||r<=0||r>n?te:(t-o)*(n-r+1)*2/(n*(n+1))},{minArgs:4,maxArgs:4}),o.def("VDB",function(e){var o=W.D(e[0]),n=W.D(e[1]),r=W.I(e[2]),i=W.D(e[3]),a=W.D(e[4]),s=t._Helper._argumentExists(e,5)?W.D(e[5]):2,l=!!t._Helper._argumentExists(e,6)&&W.B(e[6]);return o<0||n<0||r<0||i<0||a<0||a<i?te:o<n&&0===i&&1===a?o-n:function(e,t,o,n,r,i,a){var s,l,u,c,h,p=J(n),d=Y(r),f=W.I(p),g=W.I(d);if(s=0,a)for(l=f+1;l<=g;l++)u=L(e,t,o,l,i),l===f+1?u*=q(r,p+1)-n:l===g&&(u*=r+1-d),s+=u;else c=o,n!==J(n)&&i>1&&n>=o/2&&(h=n-o/2,n=o/2,r-=h,c+=1),s=H(e-=H(e,t,o,c,n,i),t,o,o-n,r-n,i);return s}(o,n,r,i,a,s,l)},{minArgs:5,maxArgs:7,acceptsMissingArgument:o.acceptsFiveSix}),o.def("ACCRINT",function(e){var o,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C=W.DT(e[0]),w=W.DT(e[1]),v=W.DT(e[2]),S=W.D(e[3]),x=t._Helper._argumentExists(e,4)?W.D(e[4]):1e3,R=W.I(e[5]),b=t._Helper._argumentExists(e,6)?W.I(e[6]):0;if(!t._Helper._argumentExists(e,7)||W.B(e[7]),S<=0||x<=0||b<0||4<b||1!==R&&2!==R&&4!==R||ne(C,v)>=0)return te;if(1===R||0===b||4===b)return h=S,p=x,d=R,g=r(c=C,v,f=b),m=re(c,f),g<0||m<=0?te:(_=p*h/W.D(d),y=g/m,_*W.D(d)*y);var T=C.getFullYear(),A=C.getMonth(),I=C.getDate(),D=v.getFullYear(),F=v.getMonth(),M=v.getDate(),E=w.getMonth(),N=w.getDate(),O=[],P=[],L=[],H=[31,28,31,30,31,30,31,31,30,31,30,31];for(o=0;o<R;o++)O[o]=(E+12*o/R)%12,P[o]=N<=H[O[o]]?N:H[O[o]],2===b?L[o]=360/R:3===b&&(L[o]=365/R);for(o=0;o<R;o++)i=O[l=o===R-1?0:o+1]>O[o]?2001:2002,L[o]=n(new Date(i,O[l],P[l]))-n(new Date(2001,O[o],P[o]));for(a=0,s=n(v);T<D||T===D&&A<F||T===D&&A===F&&I<M;){for(o=0;o<R&&(A<O[o]||A===O[o]&&I<P[o])&&(0===o||O[o]>O[o-1]);)o++;for(;o<R&&(A>O[o]||A===O[o]&&I>=P[o])&&(A!==O[++o-1]||I!==P[o-1]););l=--o==R-1?0:o+1,i=A+12/R>=12?T+1:T,u=n(new Date(T,A,I)),a+=x*S/R*(Math.min(n(new Date(i,O[l],P[l])),s)-u)/L[o],T=i,A=O[l],I=P[l]}return a},{minArgs:6,maxArgs:8,acceptsMissingArgument:o.acceptsFourSixSeven}),o.def("ACCRINTM",function(e){var o,n,i=W.DT(e[0]),a=W.DT(e[1]),s=W.D(e[2]),l=t._Helper._argumentExists(e,3)?W.D(e[3]):1e3,u=t._Helper._argumentExists(e,4)?W.I(e[4]):0;return s<=0||l<=0||u<0||4<u?te:ne(i,a)>0?te:(o=r(i,a,u),n=re(i,u),o<0||n<=0?te:l*s*o/n)},{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsThreeFour}),o.def("DISC",function(e){var o,n,i=W.DT(e[0]),a=W.DT(e[1]),s=W.D(e[2]),l=W.D(e[3]),u=t._Helper._argumentExists(e,4)?W.I(e[4]):0;return ne(i,a)>=0?te:s<=0||l<=0||u<0||4<u?te:(n=re(i,u),(o=r(i,a,u))<=0||n<=0?te:(l-s)/l*(n/o))},{minArgs:4,maxArgs:5,acceptsMissingArgument:o.acceptsFour}),o.def("EFFECT",function(e){var t=W.D(e[0]),o=W.I(e[1]);return t<=0||o<1?te:j(1+t/o,o)-1},{minArgs:2,maxArgs:2}),o.def("INTRATE",function(e){var o,n,i=W.DT(e[0]),a=W.DT(e[1]),s=W.D(e[2]),l=W.D(e[3]),u=t._Helper._argumentExists(e,4)?W.I(e[4]):0;return ne(i,a)>=0?te:s<=0||l<=0||u<0||4<u?te:(o=r(i,a,u),n=re(i,u),o<=0||n<=0?te:(l-s)/s*(n/o))},{minArgs:4,maxArgs:5,acceptsMissingArgument:o.acceptsFour}),o.def("NOMINAL",function(e){var t=W.D(e[0]),o=W.I(e[1]);return t<=0||o<1?te:o*(j(1+t,1/o)-1)},{minArgs:2,maxArgs:2}),o.def("RATE",function(e){var o,n,r,i,a={},s=W.D(e[0]),l=W.D(e[1]),u=W.D(e[2]),c=t._Helper._argumentExists(e,3)?W.D(e[3]):0,h=t._Helper._argumentExists(e,4)?W.I(e[4]):0,p=t._Helper._argumentExists(e,5)?W.D(e[5]):.1;if(s<=0)return te;if(h<0)return ee;if(h>1&&(h=1),a.xmin=0,a.xmax=0,a.precision=0,a.havexpos=!1,a.xpos=0,a.ypos=0,a.havexneg=!1,a.xneg=0,a.yneg=0,a.root=0,(a=g(a)).xmin=Z(a.xmin,1-j(1.7976931348623157e298,1/s)),a.xmax=q(a.xmax,j(1.7976931348623157e298,1/s)-1),(o={}).nper=s,o.pmt=l,o.pv=u,o.fv=c,o.type=W.I(h),o=(n=function(e,t,o){for(var n,r,i,a,s,l,u,c=e.precision/2,h=0;h<100;h++){if(a=0,s=0,o<e.xmin||o>e.xmax)return[!1,e,t];if(t=(l=k(o,a,t))[2],a=l[1],!(i=l[0]))return[i,e,t];if(e=(u=m(o,a,e))[1],u[0])return[!0,e,t];if(t=(l=V(o,s,t))[2],s=l[1],!(i=l[0]))return[i,e,t];if(0===s)return[!1,e,t];if((n=o-1.000001*a/s)===o)return e.root=o,[!0,e,t];if(r=U(n-o)/(U(o)+U(n)),o=n,r<c)return e.root=o,[!0,e,t]}return[!1,e,t]}(a,o,p))[2],a=n[1],!(r=n[0])){for(i=2;(!a.havexneg||!a.havexpos)&&i<100;i*=2)o=(n=B(a,o,p*i))[2],o=(n=B(a=n[1],o,p/i))[2],a=n[1];o=(n=function(e,t){var o,n,r,i,a,s,l,u,c=0;if(!e.havexpos||!e.havexneg)return[!1,e,t];for(n=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)),o=0;o<160;o++)if(e=(s=z(e,t,n,c,r,i=0,a,o%4==0?1:o%4==2?2:3))[1],t=s[2],c=s[3],r=s[4],i=s[5],s[6],s[0]){if(s[0])return[!0,e,t];if(t=(l=k(r,i,t))[2],i=l[1],a=l[0]){if(e=(u=m(r,i,e))[1],u[0])return[!0,e,t];if((n=U(e.xpos-e.xneg)/(U(e.xpos)+U(e.xneg)))<e.precision)return e.yneg<i&&(i=e.yneg,r=e.xneg),e.ypos<i&&(i=e.ypos,r=e.xpos),e.root=r,[!0,e,t]}}return[!1,e,t]}(a,o))[2],a=n[1],r=n[0]}return r?a.root:te},{minArgs:3,maxArgs:6,acceptsMissingArgument:o.acceptsThreeFourFive}),o.def("DOLLARDE",function(e){var t=W.D(e[0]),n=W.I(e[1]);if(0===n)return Q;if(n<0)return te;var r=t<0?Y(t):J(t),i=t-r,a=j(10,Y(o._MathHelper.log10(n)));return W.toResult(r+i*a/n)},{minArgs:2,maxArgs:2}),o.def("DOLLARFR",function(e){var t=W.D(e[0]),n=W.I(e[1]);if(0===n)return Q;if(n<0)return te;var r=t<0?Y(t):J(t),i=t-r,a=j(10,Y(o._MathHelper.log10(n)));return W.toResult(r+i*n/a)},{minArgs:2,maxArgs:2}),o.def("PRICE",function(e){var o=W.DT(e[0]),n=W.DT(e[1]),r=W.D(e[2]),i=W.D(e[3]),a=W.D(e[4]),s=W.I(e[5]),l=t._Helper._argumentExists(e,6)?W.I(e[6]):0;return i<0||r<0||0===a?te:l<0||l>4?te:1!==s&&2!==s&&4!==s?te:ne(o,n)>0?te:_(o,n,r,i,a,s,l)},{minArgs:6,maxArgs:7,acceptsMissingArgument:o.acceptsSix}),o.def("PRICEDISC",function(e){var o,n,i=W.DT(e[0]),a=W.DT(e[1]),s=W.D(e[2]),l=W.D(e[3]),u=t._Helper._argumentExists(e,4)?W.I(e[4]):0;return ne(i,a)>=0?te:s<=0||l<=0||u<0||4<u?te:(o=r(i,a,u),n=re(i,u),o<=0||n<=0?te:l-s*l*o/n)},{minArgs:4,maxArgs:5,acceptsMissingArgument:o.acceptsFour}),o.def("PRICEMAT",function(e){var o,n,i,a,s,l=W.DT(e[0]),u=W.DT(e[1]),c=W.DT(e[2]),h=W.D(e[3]),p=W.D(e[4]),d=t._Helper._argumentExists(e,5)?W.I(e[5]):0;return ne(l,u)>=0?te:h<0||p<0||d<0||4<d?te:(i=r(l,u,d),a=r(c,u,d),o=r(c,l,d),n=re(l,d),o<=0||n<=0||i<=0||a<=0?te:0==(s=1+i/n*p)?te:(100+a/n*h*100)/s-o/n*h*100)},{minArgs:5,maxArgs:6,acceptsMissingArgument:o.acceptsFive}),o.def("ODDFPRICE",function(e){var o=W.DT(e[0]),n=W.DT(e[1]),r=W.DT(e[2]),i=W.DT(e[3]),a=W.D(e[4]),s=W.D(e[5]),l=W.D(e[6]),u=W.I(e[7]),c=t._Helper._argumentExists(e,8)?W.I(e[8]):0;return c<0||c>4||1!==u&&2!==u&&4!==u||ne(r,o)>0||ne(o,i)>0||ne(i,n)>0?te:a<0||s<0||l<=0?te:C(o,n,r,i,a,s,l,u,c)},{minArgs:8,maxArgs:9,acceptsMissingArgument:o.acceptsEight}),o.def("ODDLPRICE",function(e){var o=W.DT(e[0]),n=W.DT(e[1]),r=W.DT(e[2]),i=W.D(e[3]),a=W.D(e[4]),s=W.D(e[5]),l=W.I(e[6]),u=t._Helper._argumentExists(e,7)?W.I(e[7]):0;return u<0||u>4||1!==l&&2!==l&&4!==l||ne(o,n)>0||ne(r,o)>0?te:i<0||a<0||s<=0?te:function(e,t,o,n,r,i,a,s){var l,u,c=new Date(o.getFullYear(),o.getMonth(),o.getDate());do{c.setMonth(c.getMonth()+12/a)}while(ne(c,t)<0);return l=y(o,e,c,a,s),(i*a+100*n*(y(o,t,c,a,s)-l*(1+r*(u=y(e,t,c,a,s))/a)))/(r*u+a)}(o,n,r,i,a,s,l,u)},{minArgs:7,maxArgs:8,acceptsMissingArgument:o.acceptsSeven}),o.def("TBILLPRICE",function(e){var t,o=W.DT(e[0]),r=W.DT(e[1]),i=W.D(e[2]);return ne(o,r)>=0?te:i<=0?te:(t=n(r)-n(o))>365?te:100*(1-i*t/360)},{minArgs:3,maxArgs:3}),o.def("EURO",function(e){var t=w(W.S(e[0]),2);return t>=0?t:te},{minArgs:1,maxArgs:1}),o.def("EUROCONVERT",function(e){var n=W.D(e[0]),r=W.S(e[1]),i=W.S(e[2]),a=!!t._Helper._argumentExists(e,3)&&W.B(e[3]),s=t._Helper._argumentExists(e,4)?W.I(e[4]):3,l=0;if(s<3)return ee;a||(l=function(e){var t=e.substr(0,3);switch(e[0]){case"A":if("ATS"===t)return 2;break;case"B":if("BEF"===t)return 0;break;case"D":if("DEM"===t)return 2;break;case"E":if("ESP"===t)return 0;if("EUR"===t)return 2;break;case"F":if("FIM"===t)return 2;if("FRF"===t)return 2;break;case"G":if("GRD"===t)return 2;break;case"I":if("IEP"===t)return 2;if("ITL"===t)return 0;break;case"L":if("LUX"===t||"LUF"===t)return 0;break;case"N":if("NLG"===t)return 2;break;case"P":if("PTE"===t)return 2}return 2}(i)),t._Helper._argumentExists(e,4)||(s=function(e){var t=e.substr(0,3);switch(e[0]){case"A":if("ATS"===t)return 2;break;case"B":if("BEF"===t)return 0;break;case"D":if("DEM"===t)return 2;break;case"E":if("ESP"===t)return 0;if("EUR"===t)return 2;break;case"F":if("FIM"===t)return 2;if("FRF"===t)return 2;break;case"G":if("GRD"===t)return 2;break;case"I":if("IEP"===t)return 2;if("ITL"===t)return 0;break;case"L":if("LUX"===t||"LUF"===t)return 0;break;case"N":if("NLG"===t)return 2;break;case"P":if("PTE"===t)return 1}return 2}(r));var u=0,c=w(r,s),h=w(i,s);return c>=0&&h>=0?(u=n*h/c,a||(u=o._MathHelper.round(u,l)),u):ee},{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsThreeFour})}(t.Functions||(t.Functions={}));t.Functions}(e.Calc||(e.Calc={}));e.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){!function(o){!function(n){function r(e,t,o){var n;return e===I||e===A?A:e.isArray||e.isReference?(t>e.colCount&&(n=t,t=o,o=n),e[o*e.colCount+t]):e[0]}function i(e,t){return t!==I&&t!==A&&(!(!D.num(e)||!D.num(t))||("boolean"==typeof e&&"boolean"==typeof t||"string"==typeof e&&"string"==typeof t))}function a(e,t,o,n,r){if(e<0||t<0||t<e||o<e||o>t)return-1;if(r)return w=e,v=t,x=o,R=n,b=n,S=o;if(R){if(++S>v&&R===b)S=x-1,R=!1;else if(S>v&&R!==b)return-1}else if(--S<w&&R===b)S=x+1,R=!0;else if(S<w&&R!==b)return-1;return S}function s(t,o,n){var r,i,a,s;return t===o?0:(r=A,"string"==typeof t?o||0!==t.toString().length?D.num(o)?1:"boolean"==typeof o?2:"string"==typeof o?0===(i=n?t.toString().localeCompare(o.toString()):t.toLowerCase().localeCompare(o.toLowerCase()))?0:i>0?1:2:o instanceof Date?(r=e.Sheets._DateTimeHelper._parseDate(t),isNaN(r)?1:r===o?0:r>o?1:2):-1:0:"string"==typeof o?t||0!==o.toString().length?D.num(t)?2:"boolean"==typeof t?1:t instanceof Date?(r=e.Sheets._DateTimeHelper._parseDate(t),isNaN(r)?2:r===o?0:r>o?1:2):-1:0:"boolean"==typeof t&&D.num(o)?1:"boolean"==typeof o&&D.num(t)?2:(a=D.D(t))===(s=D.D(o))?0:a<s?2:1)}function l(e,t,o){var n=r(e,t,o);return n===I||n===A?0:n}function u(e,t,o,n){var u,c,h,p,d,f,g=-1,m=0,_=-1,y=-1;if(u=n?t.rowCount:t.colCount,--u<m)return-1;for(;m<=u;){for(c=A,o>=1!=(2===g)&&(_=y),h=y=a(m,u,y=D.I((m+u)/2),o>=0,!0),p=e[0];!i(p,c)&&-1!==y&&(d=!1,!i(p,c=n?r(t,0,y):r(t,y,0)));)y=a(0,0,0,!1,!1),!d&&o>=0&&y<h?(u=y,d=!0):!d&&o<0&&y>h&&(m=y,d=!0);if(-1===y&&o>=1!=(2===g))return _;if(-1===y)return-1;if(g=s(p,c,!1),o>=1&&1===g)m=y+1;else if(o>=1&&2===g)u=y-1;else if(o<=-1&&1===g)u=y-1;else if(o<=-1&&2===g)m=y+1;else if(0===g){for(;o<=-1&&y>m||o>=0&&y<u;){if(0,f=o>=0?y+1:y-1,!(c=n?l(t,0,f):l(t,f,0)))return-1;if(!i(p,c))break;if(0!==(g=s(p,c,!1)))break;y=f}return y}}return o>=1!=(2===g)?y:_}function c(e,o,n,r){var a,u,c,h,p,d,f,g,m,_,y=A,C=-1;for(u=r?o.rowCount:o.colCount,(p="string"==typeof(h=e[0]))&&((f=t.RegUtil.getWildcardCriteriaFullMatch(h))&&(d=t.RegUtil.getRegIgnoreCase(f))),c=0;c<u;c++){if((g=r?l(o,0,c):l(o,c,0))===I||g===A)return-1;if(i(h,g))if(a=p&&"string"==typeof g&&f?(_=g,(m=d).lastIndex=0,m.test(_)?0:1):s(h,g,!1),n>=1&&1===a)a=-1,C>=0&&(a=s(g,y,!1)),(C<0||C>=0&&1===a)&&(C=c,y=g);else if(n<=-1&&2===a)a=-1,C>=0&&(a=s(g,y,!1)),(C<0||C>=0&&2===a)&&(C=c,y=g);else if(0===a)return c}return C}function h(){return!0}function p(e){if(!e)throw t.SR.Exp_InvalidArgument;if(e.length<1||e.length>1)throw t.SR.Exp_InvalidArgument}function d(e){var t=o.Convert,n=t.toArr(e[0],0,!0,!1,!1),r=t.toArr(e[1],0,!0,!1,!1),i=D.I(e[2]),a=!o._Helper._argumentExists(e,3)||D.B(e[3]),s=-1;return i<=0?M:i>r.rowCount?E:(s=a?u(n,r,1,!1):c(n,r,0,!1))>=0?l(r,s,i-1):N}function f(e){var t=o.Convert,n=t.toArr(e[0],0,!0,!1,!1),r=t.toArr(e[1],0,!0,!1,!1),i=D.I(e[2]),a=!o._Helper._argumentExists(e,3)||D.B(e[3]),s=-1;return i<=0?M:i>r.colCount?E:(s=a?u(n,r,1,!0):c(n,r,0,!0))>=0?l(r,i-1,s):N}function g(e,t){for(var o=e.length,n=1;n<o;n++){if(2===s(e[n-1],e[n],!1)&&!t)return!1}return!0}function m(e,t,o,n){e.append(t),n?0!==o&&(e.append("["),e.append(o.toString()),e.append("]")):e.append(o)}var _,y,C;t.feature("calc.functions_lookup",["calc.functions"]);var w,v,S,x,R,b,T,A=null,I=void 0,D=o.Convert,F=o.Errors,M=(F.Null,F.DivideByZero,F.Value),E=F.Reference,N=(F.Name,F.NotAvailable);F.Number;(T=_||(_={}))[T.row=0]="row",T[T.column=1]="column",y=function(t){function o(o,n,r,i,a,s){t.call(this,o,[new e.Sheets.Range(n,r,i,a)]);this._row=n,this._column=r,this._rowCount=i,this._columnCount=a,this._type=s}return __extends(o,t),o.prototype.type=function(){return this._type},o.prototype.getValue=function(e,o,n){switch(this._type){case 0:return this.getRow(0)+1+o;case 1:return this.getColumn(0)+1+n;default:return t.prototype.getValue.call(this,e,o,n)}},o.prototype.toArray=function(e,o,n,r,i){for(var a,s,l,u,c,h=[],p=this._row,d=this._column,f=this.getRangeCount(),g=this._rowCount,m=this._columnCount,_=0;_<f;_++)for(o||(u=[],h.push(u)),a=0;a<g;a++)for(o||(c=[],u.push(c)),s=0;s<m;s++){switch(this._type){case 0:l=p+1+a;break;case 1:l=d+1+s;break;default:l=t.prototype.getValue.call(this,_,p+a,d+s)}o?h.push(l):c.push(l)}return o||1!==f||(h=h[0]),h.rowCount=g,h.colCount=m,h.rangeCount=f,h},o}(o.SheetReference),C=function(e){function t(t){e.call(this),this._array=t}return __extends(t,e),t.prototype.getRowCount=function(){return o.CalcArrayHelper.getColumnCount(this._array)},t.prototype.getColumnCount=function(){return o.CalcArrayHelper.getRowCount(this._array)},t.prototype.getValue=function(e,t){return o.CalcArrayHelper.getValue(this._array,t,e)},t}(o.CalcArray),n.def("ADDRESS",function(e){var n,r,i=D.I(e[0]),a=D.I(e[1]),s=o._Helper._argumentExists(e,2)?D.I(e[2]):1,l=!o._Helper._argumentExists(e,3)||D.B(e[3]),u=o._Helper._argumentExists(e,4)?D.S(e[4]):"",c=3===s||4===s||7===s||8===s,h=2===s||4===s||6===s||8===s,p=new t._StringBuilder;return i<1&&(l||!c)||i>o.Parser.maxRowCount?M:a<1&&(l||!h)||a>o.Parser.maxColumnCount?M:s<1||8<s?M:(function(e,t){var n,r;if(t&&0<t.length){for(n=!o.Parser._isLetter(t[0])&&"_"!==t[0],r=1;!n&&r<t.length;r++)n=!o.Parser._isLetterOrDigit(t[r])&&"_"!==t[r];n?(e.append("'"),e.append(t.replace("'","''")),e.append("'")):e.append(t),e.append("!")}}(p,u),l?(function(e,t,o){o||e.append("$");for(var n=e.toString().length;t>0;t=parseInt((t-1)/26,10))e.insert(String.fromCharCode("A".charCodeAt(0)+(t-1)%26),n)}(p,a,h),n=p,r=i,c||n.append("$"),n.append(r)):(m(p,"R",i,c),m(p,"C",a,h)),p.toString())},{minArgs:2,maxArgs:5,acceptsMissingArgument:n.acceptsTwoThreeFour}),n.def("INDEX",function(e,n){var r,i,a,s,l,u,c=n instanceof o.EvaluateContext?n:I,h=c!=A&&c.acceptsReference;if(e[0]instanceof o.Reference){var p={value:-1},d=e[0],f=d.getRowCount(0),g=d.getColumnCount(0),m=d.getRow(0),_=d.getColumn(0);if(2==e.length)return 1!=d.getRangeCount()||1!=f&&1!=g?E:(0!=(r=o._Helper._argumentValid(e,1)&&D.rI(e[1],p)?p.value:0)||h||c==A||(r=f>0?c.rowOffset:c.columnOffset),r<0?M:f*g<r?E:0==r?d.create([new t.Range(m,_,f,g)]):(s=Math.floor((r-1)/g)+m,l=(r-1)%g+_,d.create([new t.Range(s,l,1,1)])));var y=o._Helper._argumentValid(e,1)&&D.rI(e[1],p)?p.value-1:-1,C=o._Helper._argumentValid(e,2)&&D.rI(e[2],p)?p.value-1:-1;return(w=o._Helper._argumentValid(e,3)&&D.rI(e[3],p)?p.value-1:0)>=d.getRangeCount()?E:(f=d.getRowCount(w),g=d.getColumnCount(w),i=d.getRow(w),a=d.getColumn(w),-1==y&&!h&&f>1&&c!=A&&(y=c.rowOffset),-1==C&&!h&&g>1&&c!=A&&(C=c.columnOffset),s=y+i,l=C+a,y<-1||C<-1||w<0?M:f<=y||g<=C||d.getRangeCount()<=w?E:-1==y&&-1==C?d.create([new t.Range(i,a,f,g)]):-1==y?d.create([new t.Range(i,l,f,1)]):-1==C?d.create([new t.Range(s,a,1,g)]):d.create([new t.Range(s,l,1,1)]))}if(D.arr(e[0])){var w;return f=(u=e[0]).getRowCount(),g=u.getColumnCount(),y=o._Helper._argumentExists(e,1)?D.I(e[1]):-1,C=o._Helper._argumentExists(e,2)?D.I(e[2]):-1,1!=(w=o._Helper._argumentExists(e,3)?D.I(e[3])-1:1)?E:(-1===y&&-1===C?y=C=0:-1===C&&1===f&&(C=y,y=1),y=-1===y?0:y,C=-1===C?0:C,f=u.getRowCount(),g=u.getColumnCount(),y<0||C<0||w<0?M:(y>f&&1===f&&!o._Helper._argumentExists(e,2)&&(C=y,y=0),f<y||g<C?E:0==y&&0==C?u.slice(0,0,f,g):0==y?u.slice(0,C-1,f,1):0==C?u.slice(y-1,0,1,g):u.getValue(y-1,C-1)))}},{minArgs:2,maxArgs:4,acceptsReference:n.acceptsZero,acceptsArray:n.acceptsZero,acceptsMissingArgument:n.acceptsOneTwoThree,isContextSensitive:h}),n.def("OFFSET",function(e){var t=e[0];if(!(t&&t instanceof o.Reference&&1===t.getRangeCount()))return M;var n=D.I(e[1]),r=D.I(e[2]),i=o._Helper._argumentExists(e,3)?D.I(e[3]):t.getRowCount(0),a=o._Helper._argumentExists(e,4)?D.I(e[4]):t.getColumnCount(0),s=t.getSource(),l=t.getRow(0)+n,u=t.getColumn(0)+r;return i<=0||a<=0?E:l<0||s.getRowCount()<l+i?E:u<0||s.getColumnCount()<u+a?E:t.create([{row:l,col:u,rowCount:i,colCount:a}])},{minArgs:3,maxArgs:5,acceptsMissingArgument:n.acceptsThreeFour,acceptsReference:n.acceptsZero,acceptsArray:n.acceptsZero,isVolatile:n.isVolatile,arrayArgumentEvaluateMode:2,returnReference:n.isVolatile}),n.def("ROW",function(e,t){if(p([e]),!t)return M;var n=t.arrayFormulaMode,r=o._Helper._argumentExists(e,0),i=r?e[0]:t.getReference(t.source,t.row,t.column,t.rowCount,t.columnCount);return i&&1===i.getRangeCount()?n&&r?new y(i.getSource(),i.getRow(0),i.getColumn(0),i.getRowCount(0),1,0):i.getRow(0)+1:M},{minArgs:0,maxArgs:1,acceptsReference:n.acceptsAny,isContextSensitive:h,precedentReference:n.acceptsNone,expandColumns:n.acceptsNone}),n.def("COLUMN",function(e,t){if(p([e]),!t)return M;var n=t.arrayFormulaMode,r=o._Helper._argumentExists(e,0),i=o._Helper._argumentExists(e,0)?e[0]:t.getReference(t.source,t.row,t.column,t.rowCount,t.columnCount);return i&&1===i.getRangeCount()?n&&r?new y(i.getSource(),i.getRow(0),i.getColumn(0),1,i.getColumnCount(0),1):i.getColumn(0)+1:M},{minArgs:0,maxArgs:1,acceptsMissingArgument:n.acceptsZero,acceptsReference:n.acceptsAny,isContextSensitive:h,precedentReference:n.acceptsNone,expandRows:n.acceptsNone}),n.def("ROWS",function(e){return p([e]),o.CalcArrayHelper.getRowCount(e[0])},{minArgs:1,maxArgs:1,acceptsReference:n.acceptsAny,acceptsArray:n.acceptsAny,precedentReference:n.acceptsNone,expandColumns:n.acceptsNone,isVolatile:n.isVolatile}),n.def("COLUMNS",function(e){return p([e]),o.CalcArrayHelper.getColumnCount(e[0])},{minArgs:1,maxArgs:1,acceptsReference:n.acceptsAny,acceptsArray:n.acceptsAny,precedentReference:n.acceptsNone,expandRows:n.acceptsNone,isVolatile:n.isVolatile}),n.def("TRANSPOSE",function(e){return p([e]),new C(e[0])},{minArgs:1,maxArgs:1,acceptsReference:n.acceptsAny,acceptsArray:n.acceptsAny}),n.def("LOOKUP",function(e){var t,n,r,i,a,s=o.Convert,c=s.toArr(e[0],0,!0,!1,!1),h=s.toArr(e[1],0,!0,!1,!1),p=h.colCount,g=h.rowCount;if(!(e.length>2))return r=A,p>g?(r=d([c,h,g]),D.err(r)?N:r):(r=f([c,h,p]),D.err(r)?N:r);if(n=s.toArr(e[2],0,!0,!1,!1)){if(i=n.colCount,a=n.rowCount,i>1&&a>1)return N}else n=h;return(t=u(c,h,1,!(p>g)))>=0?(p=n.colCount)>(g=n.rowCount)?l(n,t,g-1):l(n,p-1,t):N},{minArgs:2,maxArgs:3,acceptsArray:n.acceptsNotZero,acceptsReference:n.acceptsNotZero}),n.def("HLOOKUP",d,{minArgs:3,maxArgs:4,acceptsMissingArgument:n.acceptsThree,acceptsArray:n.acceptsOne,acceptsReference:n.acceptsOne}),n.def("VLOOKUP",f,{minArgs:3,maxArgs:4,acceptsMissingArgument:n.acceptsThree,acceptsArray:n.acceptsOne,acceptsReference:n.acceptsOne}),n.def("CHOOSE",function(e){var t=D.I(e[0]);return t<1||e.length<=t?M:e[t]===I||e[t]===A?0:e[t]},{minArgs:2,maxArgs:255,acceptsError:n.acceptsMoreThanOne,isBranch:n.isBranch,findTestArgument:n.findTestArgument,findBranchArgument:function(e){if(D.err(e))return-1;try{return D.I(e)}catch(e){}return-1},acceptsReference:n.acceptsMoreThanOne,acceptsArray:n.acceptsMoreThanOne}),n.def("MATCH",function(e){var t,n=o.Convert,r=n.toArr(e[0],0,!0,!1,!1),i=n.toArr(e[1],0,!0,!1,!1);if(!i.isArray&&!i.isReference)return N;var a=i.colCount,s=i.rowCount,l=o._Helper._argumentExists(e,2)?D.I(e[2]):1;return a>1&&s>1?N:1===l&&!g(i,!0)||-1===l&&!g(i,!1)?N:(t=-1,1===l?t=u(r,i,1,s>1):0===l?t=c(r,i,0,s>1):-1===l&&(t=u(r,i,-1,s>1)),-1===t?N:t+1)},{minArgs:2,maxArgs:3,acceptsMissingArgument:n.acceptsTwo,acceptsReference:n.acceptsOne,acceptsArray:n.acceptsOne}),n.def("INDIRECT",function(e,t){var n,r;if(!t)return F.NotAvailable;if(!(n=o.Convert.S(e[0])))return F.Reference;var i,a=!o._Helper._argumentExists(e,1)||D.B(e[1]),s=t.row,l=t.column,u=new o.Parser,c=t.source?t.source.getParserContext(!a,s,l):new o.ParserContext(t.source,!a,s,l),h=u.parse(n,c);return h?((8===h.t||9===h.t)&&(h=9===h.t?(i=h.source).getCustomName(h.name):t.getName(h.name)),!h||0!==h.t&&1!==h.t&&2!==h.t&&3!==h.t&&16!==h.t&&17!==h.t&&26!==h.t&&25!==h.t?F.Reference:(i=h.source||t.source,26===h.t||25===h.t?i.getValueByName(h.nameIdentity):(r=h.getRange(s,l),17===h.t&&(i=h.source()),1!==r.row||1!==r.column||t.acceptsReference?i.getReference(r.row,r.column,r.rowCount,r.columnCount):i.getValue(r.row,r.column)))):F.Reference},{minArgs:1,maxArgs:2,acceptsMissingArgument:n.acceptsTwo,isVolatile:n.isVolatile,isContextSensitive:h})}(o.Functions||(o.Functions={}));o.Functions}(t.Calc||(t.Calc={}));t.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){!function(t){!function(o){function n(e,t,n){var r,i,a,s=0,l=0,u=o._MathHelper.parseCriteria(t);if(e.rowCount!==n.rowCount||e.colCount!==n.colCount)return Oe;for(r=0;r<e.length;r++)i=e[r],u&&u(i)&&((a=n[r])!==He.CalcConvertedError&&(s+=a,l++));return 0===l?Ne:He.toResult(s/l)}function r(e){for(var o,n,r,i,a,s=me,l=0,u=(t.Convert,[]),c=0;c<e.length;c++){if((o=He.toArr(e[c],1,!0,!0,!1,!0)).isError)return o[0];if(o.isConvertError)return Oe;for(n=0;n<o.length;n++)(r=o[n])!==He.CalcConvertedError&&u.push(r)}for(n=0;n<u.length;n++){for(i=0,a=0;a<u.length;a++)a!==n&&u[a]===u[n]&&i++;i>l&&(l=i,s=u[n])}return 0===l?Pe:s}function i(e){var o,n,r,i,a,s=t.CalcArrayHelper;if(He.ref(e[0])){if(1!==s.getLength(e[0]))return Oe;o=s.getValueByIndex(e[0],0)}else o=e[0];if(isNaN(o=He.D(o)))return Oe;if((n=He.toArr(e[1],1,!0,!0,!1)).isError)return n[0];if(r=0,t._Helper._argumentExists(e,2)&&isNaN(r=He.D(e[2])))return Oe;var l=0,u=0,c=0;for(i=0;i<n.length;i++)(a=n[i])!==He.CalcConvertedError&&(a<o?l++:o<a?c++:u++);return 0===u?Pe:0===r?c+1:l+1}function a(e){return s(e,!0)}function s(e,o){t.Convert;var n,r,i,a,s,l,u,c=He.toArr(e[0],1,!0,!0,!1,!0);if(c.isError)return c[0];for(n=[],r=0;r<c.length;r++)(i=c[r])!==He.CalcConvertedError&&n.push(i);if(n.sort(function(e,t){return e-t}),isNaN(a=He.D(e[1])))return Oe;if(s=3,t._Helper._argumentExists(e,2)){if(isNaN(s=He.I(e[2])))return Oe;if(s<1)return Le}return 0==(l=n.length)?Pe:a<n[0]||a>n[l-1]?Pe:(0!=(u=1==l?1:function(e,t,o){var n,r,i,a,s,l=e.length;if(t==e[0])n=o?0:1/(l+1);else{for(r=0,i=e[0],a=1;a<l&&e[a]<t;a++)e[a]!=i&&(r=a,i=e[a]);e[a]!=i&&(r=a),t==e[a]?n=o?r/(l-1):(a+1)/(l+1):0==r?n=0:(s=(t-e[r-1])/(e[r]-e[r-1]),n=o?(r-1+s)/(l-1):(r+s)/(l+1))}return n}(n,a,o))&&(u=De(u*_e(10,s))/_e(10,s)),u)}function l(e){var t=e[0],n=0;switch(He.I(e[1])){case 0:n=0;break;case 1:n=.25;break;case 2:n=.5;break;case 3:n=.75;break;case 4:n=1;break;default:return Le}return o._StatHelper.st_percentile([t,n])}function u(e,t){for(var n,r=0,i=0===t||"*"===t,a=o._MathHelper.parseCriteria(t),s=0;s<e.length;s++)n=e[s],i&&n===me||a&&a(n)&&r++;return He.toResult(r)}function c(e,t){for(var o,n,r,i,a,s=0;s<e.length;s++){if((r=He.toArr(e[s],0,!0,!0,!1,!0)).isError)return r[0];if(r.isConvertError)return Oe;for(o=0;o<r.length;o++)if((a=r[o])===me)t.n++;else if(typeof a===Be){if(n={value:0},He.rD(a,n))i=n.value,t.sumx+=i,t.sumx2+=i*i;else if(!r.isArray&&!r.isReference)return Oe;t.n++}else{if(He.err(a))return a;He.num(a)&&(i=He.D(a),t.sumx+=i,t.sumx2+=i*i,t.n++)}}}function h(e){return Xe(e,!0,!0)}function p(e){return Ke(e,!0,!0)}function d(e){return Je(e,!0,!0)}function f(e){var t,o,n,r,i,a,s,l,u=0,c=0,h=0,p=He.toArr(e[0],1,!0,!0,!1);if(p.isError)return p[0];if((i=He.toArr(e[1],1,!0,!0,!1)).isError)return i[0];if(p.isConvertError||i.isConvertError||0===(a=p.length))return Ne;if(a!==i.length)return Pe;for(s=0,l=0;l<a;l++)t=p[l],o=i[l],t!==He.CalcConvertedError&&o!==He.CalcConvertedError&&(u+=t,c+=o,s++);for(n=u/s,r=c/s,l=0;l<a;l++)t=p[l],o=i[l],t!==He.CalcConvertedError&&o!==He.CalcConvertedError&&(h+=(t-n)*(o-r));return s<=1?Ne:He.toResult(h/s)}function g(e){var t,o,n,r,i;if(isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2])))return Oe;try{r=He.B(e[3])}catch(e){return Oe}return n<=0?Le:r?((i=[])[0]=(t-o)/n,Ge(i)):He.toResult(be(-(t-o)*(t-o)/(2*n*n))/(Ae(2*xe)*n))}function m(e){var t,o,n,r,i,a;if(isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2])))return Oe;if(t<0||1<t||n<=0)return Le;if(Te(r=t-.5)<=.42)a=r*(((-25.44106049637*(i=r*r)+41.39119773534)*i-18.61500062529)*i+2.50662823884)/((((3.13082909833*i-21.06224101826)*i+23.08336743743)*i-8.4735109309)*i+1);else{if(i=t,r>0&&(i=1-t),!(i>2.220446049250313e-16))return i>1e-300?(a=-2*Ie(t),i=Ie(6.283185307179586*a),a=Ae(a*(1-(i=i/a+(2-i)/(a*a)+(6*i-14-i*i)/(2*a*a*a)))),r<0&&(a=-a),a):r<0?-1.79769e308:1.79769e308;a=(((2.32121276858*(i=Ae(-Ie(i)))+4.85014127135)*i-2.29796479134)*i-2.78718931138)/((1.63706781897*i+3.54388924762)*i+1),r<0&&(a=-a)}var s=+a/1,l=.3989422804014327*be(-.5*s*s)/1,u=g([a,0,1,!0]);return He.err(u)?u:o+n*(a-=(u-t)/l)}function _(e){var t;return isNaN(t=He.D(e[0]))?Oe:t<0||1<t?Le:m([t,0,1])}function y(e){var t,o,n,r,i;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.I(e[2]))?Oe:t<=0||t>=1?Le:o<=0?Le:n<1?Le:((r=[])[0]=t/2,i=_(r),He.err(i)?i:-(i=He.D(i))*(o/Ae(n)))}function C(e){var t,o,n;return o=(t=e)+5.5,o-=(t+.5)*Ie(o),n=1.000000000190015+76.18009172947146/(e+1),n-=86.50532032941678/(e+2),n+=24.01409824083091/(e+3),n-=1.231739572450155/(e+4),n+=.001208650973866179/(e+5),Ie(2.506628274631001*(n-=5395239384953e-18/(e+6))/t)-o}function w(e,t,o){var n,r,i,a,s,l,u,c,h,p,d=1e-50;for(h=e-1,s=1,Te(l=1-(c=e+t)*o/(p=e+1))<d&&(l=d),i=l=1/l,n=1;n<=300&&(Te(l=1+(a=(t-n)*n*o/((h+(r=n+n))*(e+r)))*l)<d&&(l=d),Te(s=1+a/s)<d&&(s=d),i*=(l=1/l)*s,Te(l=1+(a=0-(e+n)*(c+n)*o/((e+r)*(p+r)))*l)<d&&(l=d),Te(s=1+a/s)<d&&(s=d),i*=u=(l=1/l)*s,!(Te(u-1)<1e-20));n++);return i}function v(e){for(var o,n,r,i,a,s=t._Helper,l=0;l<e.length;l++)if(He.err(e[l]))return e[l];if(isNaN(o=He.D(e[0]))||isNaN(n=He.D(e[1]))||isNaN(r=He.D(e[2]))||(i=0,s._argumentExists(e,3)&&isNaN(i=He.D(e[3])))||(a=1,s._argumentExists(e,4)&&isNaN(a=He.D(e[4]))))return Oe;if(n<=0||r<=0||o<i||a<o||i===a)return Le;var u,c,h=(o-i)/(a-i),p=C(n+r),d=C(n),f=C(r),g=Ie(h),m=Ie(1-h);return c=be(p-d-f+n*g+r*m),u=h<(n+1)/(n+r+2)?c*w(r,n,1-h)/r:1-c*w(r,n,1-h)/r,He.toResult(u)}function S(e,t,o){if(e<=0)return 0;if(e>=1)return 1;if(1==o)return _e(e,t);if(1==t)return-Fe(o*Me(-e));var n,r=.5-e+.5,i=Me(-e),a=e,s=Ie(e),l=t,u=o,c=e>t/(t+o);return c&&(l=o,u=t,a=r,r=e,s=i,i=Ie(e)),n=function(e,t,o){var n,r,i,a,s,l,u,c,h,p;n=1,r=1,0==(a=1-(t+o)/(t+1)*e)?(i=0,s=1,p=1):p=(i=1)*(s=1/a),h=1;var d=1,f=!1;do{i=(n=(i+(u=d*(o-d)*e/(((l=t+2*d)-1)*l))*n)*s)+(c=-(t+d)*(t+o+d)*e/(l*(l+1)))*i*s,0!=(a=(r=(a+u*r)*s)+c*a*s)&&(f=Te(p-(h=i*(s=1/a)))<2.22045e-16*Te(p)),p=h,d+=1}while(d<5e4&&!f);return p}(a,l,u),n/=l,n*=l>1&&u>1&&l/(l+u)<.97&&u/(l+u)<.97?x(a,l,u)*a*r:be(l*s+u*i-R(l,u)),c&&(n=.5-n+.5),n>1&&(n=1),n<0&&(n=0),n}function x(e,t,o){if(1===t)return 1===o?1:2===o?-2*e+2:e<=.01?o+o*be((o-1)*Ie(1-e))-1:o*_e(.5-e+.5,o-1);if(1===o)return 2===t?t*e:t*_e(e,t-1);if(e<=0&&(!(t<1)||0!==e)||e>=1&&(!(o<1)||1!==e))return 0;var n=Ie(M(2)),r=Ie(M(1)),i=Ie(1-e),a=(t-1)*Ie(e),s=(o-1)*i,l=R(t,o);return a<n&&a>r&&s<n&&s>r&&l<n&&l>r&&a+s<n&&a+s>r?_e(e,t-1)*_e(.5-e+.5,o-1)/b(t,o):be(a+s-l)}function R(e,t){var o,n,r;e>t?(o=e,n=t):(o=t,n=e);var i=5.52468004077673,a=F(o);a/=F(o+n),a*=F(n),r=Ie(a),r+=.5*(Ie(o+n+i)-Ie(o+i)-Ie(n+i));var s=o/(n+i);return-o*Ie(1+n/(o+i))-n*Ie(1+s)-i+r}function b(e,t){var o,n;if(e>t?(o=e,n=t):(o=t,n=e),o+n<171.624376956302)return I(o)/I(o+n)*I(n);var r=5.52468004077673,i=F(o);i/=F(o+n),i*=F(n),i*=Ae((o+n+r)/(o+r)/(n+r));var a=o/(n+r);return be(-o*Ie(1+n/(o+r))-n*Ie(1+a)-r)*i}function T(e){var t=F(e),n=e+6.02468004077673-.5,r=_e(n,e/2-.25);return t*=r,t/=be(n),t*=r,e<=20&&e==o._MathHelper.approxFloor(e)&&(t=De(t)),t}function A(e){var t=F(e),n=e+6.02468004077673-.5,r=_e(n,e/2-.25);return t*=r,t/=be(n),t*=r,e<=20&&e==o._MathHelper.approxFloor(e)&&(t=De(t)),t}function I(e){var t,o=Ie(xe),n=Ie(M(2));return e>171.624376956302?Le:e>=1?T(e):e>=.5?T(e+1)/e:e>=-.5?A(e+2)-Ie(e+1)-Ie(Te(e))>=n?Le:T(e+2)/(e+1)/e:(t=A(1-e)+Ie(Te(ve(xe*e))))-o>=n?0:t<0&&o-t>n?Le:be(o-t)*(ve(xe*e)<0?-1:1)}function D(e){return e>=171.624376956302?A(e):e>=1?Ie(T(e)):e>=.5?Ie(T(e+1)/e):A(e+2)-Ie(e+1)-Ie(e)}function F(e){var t,o,n,r,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],a=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(e<=1)for(t=i[12],o=a[12],n=11;n>=0;--n)t*=e,t+=i[n],o*=e,o+=a[n];else for(r=1/e,t=i[0],o=a[0],n=1;n<=12;++n)t*=r,t+=i[n],o*=r,o+=a[n];return t/o}function M(e){var t=[];switch(t[0]=2,e){case 1:return 2.2250738585072014e-308;case 2:return 1.7976931348623157e308;case 3:return _e(2,-53);case 4:return _e(2,-52);case 5:return o._MathHelper.log10(t);default:return 0}}function E(e,t,o){var n,r,i;if(t<1)return 0;for(i=0,n=0,r=1;r<=t;r++)if(n=t-r,(i+=Te(He.D(e[n])))>o)return n;return n}function N(e,t,o){var n,r,i,a,s;if(o<1||o>1e3||e<-1.1||e>1.1)return NaN;for(a=2*e,i=r=0,n=0,s=1;s<=o;s++)i=r,n=a*(r=n)-i+He.D(t[o-s]);return.5*(n-i)}function O(e){var t=[];t[0]=.16663894804518634,t[1]=-13849481760675638e-21,t[2]=9.81082564692473e-9,t[3]=-1.809129475572494e-11,t[4]=6.221098041892606e-14,t[5]=-3.399615005417722e-16,t[6]=2.683181998482699e-18,t[7]=-2.868042435334643e-20,t[8]=3.9628370610464347e-22,t[9]=-6.831888753985767e-24,t[10]=1.4292273559424982e-25,t[11]=-3.5475981581010704e-27,t[12]=1.025680058010471e-28,t[13]=-3.4011022543167484e-30,t[14]=1.276642195630063e-31;var o,n=0,r=0,i=0;return 0===n&&(n=E(t,15,M(3)),r=1/Ae(M(3)),i=be(Ce(Ie(M(2)/12),-Ie(12*M(1))))),e<10?NaN:e>=i?4.930380657631324e-32:e<r?N((o=10/e)*o*2-1,t,n)/e:1/(12*e)}function P(e){var t,o=[];return o[0]=1.037869356274377,o[1]=-.13364301504908918,o[2]=.019408249135520562,o[3]=-.0030107551127535777,o[4]=.0004869461479715485,o[5]=-8105488189317536e-20,o[6]=13778847799559525e-21,o[7]=-2380221089435897e-21,o[8]=4.1640416213865184e-7,o[9]=-7.359582837807599e-8,o[10]=1.3117611876241675e-8,o[11]=-2.3546709317742423e-9,o[12]=4.2522773276035e-10,o[13]=-7.71908941348408e-11,o[14]=1.407574648135907e-11,o[15]=-2.5769072058024682e-12,o[16]=4.734240666629442e-13,o[17]=-8.724901267474264e-14,o[18]=1.612461490274055e-14,o[19]=-2.9875652015665774e-15,o[20]=5.548070120908289e-16,o[21]=-1.0324619158271569e-16,o[22]=1.9250239203049852e-17,o[23]=-3.595507346526515e-18,o[24]=6.726454253787686e-19,o[25]=-1.260262416873522e-19,o[26]=2.364488440860621e-20,o[27]=-4.4419377050807936e-21,o[28]=8.354659446403425e-22,o[29]=-1.5731559416479563e-22,o[30]=2.9653128740247425e-23,o[31]=-5.594958348181595e-24,o[32]=1.056635426883568e-24,o[33]=-1.9972483680670205e-25,o[34]=3.778297781883936e-26,o[35]=-7.153158688908174e-27,o[36]=1.3552488463674214e-27,o[37]=-2.5694673048487566e-28,o[38]=4.8747756066216946e-29,o[39]=-9.254211253084972e-30,o[40]=1.7578597841760237e-30,o[41]=-3.341002667773101e-31,o[42]=6.353393618023618e-32,0,0===(t=0)&&(t=E(o,43,.1*M(3)),-1+Ae(M(4))),e<=-1?NaN:Te(e)<=.375?e*(1-e*N(e/.375,o,t)):Ie(e+1)}function L(e){var t,o,n,r,i,a,s=1,l=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,7.7823e-12,-3.6968e-12,5.1e-13,-2.06e-14,-5.4e-15,1.4e-15];if(e>171)return 1e308;if(e===He.I(e))if(e>0)for(r=1,t=2;t<e;t++)r*=t;else r=1e308;else{if(Te(e)>1){for(a=Te(e),n=He.I(a),s=1,o=1;o<=n;o++)s*=a-o;a-=n}else a=e;for(i=l[24],o=23;o>=0;o--)i=i*a+l[o];r=1/(i*a),Te(e)>1&&(r*=s,e<0&&(r=-xe/(e*r*ve(xe*e))))}return r}function H(e){var t;return isNaN(t=He.D(e[0]))?Oe:t<=0?Le:function(e){var t,o,n,r,i,a,s=0,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=e,e<=0)return 1e308;if(1===e||2===e)return 0;for(e<=7&&(t=e+(s=He.I(7-e))),o=1/(t*t),n=2*xe,i=l[9],a=8;a>=0;a--)i=i*o+l[a];if(r=i/t+.5*Ie(n)+(t-.5)*Ie(t)-t,e<=7)for(a=1;a<=s;a++)r-=Ie(t-1),t-=1;return r}(t)}function k(e,t){var o,n,r,i,a;if(t<(n=r=e)&&(n=t),t>r&&(r=t),n<0)return NaN;if(0===n)return 1.79769e308;if(n>=10)return o=O(n)+O(r)-O(n+r),-.5*Ie(r)+.9189385332046728+o+(n-.5)*Ie(n/(n+r))+r*P(-n/(n+r));if(r>=10)return o=O(r)-O(n+r),(i=[])[0]=n,a=H(i),He.err(a)?NaN:He.D(a)+o+n-n*Ie(n+r)+(r-.5)*P(-n/(n+r));var s=L(n),l=L(r),u=L(n+r);return Ie(s*(l/u))}function V(e,t,o){var n,r,i,a,s,l,u,c,h,p,d,f,g,m,_=0,y=0,C=0,w=0;if(0===_&&(_=M(3),y=Ie(_),C=M(1),w=Ie(C)),d=e,(a=t)/(a+(u=o))<e&&(d=1-d,a=o,u=t),(a+u)*d/(a+1)<_)n=0,(h=a*Ie(ye(d,C))-Ie(a)-k(a,u))>w&&0!==d&&(n=be(h)),(d!==e||a!==t)&&(n=1-n);else{if(0===(s=u-we(u))&&(s=1),n=0,(h=a*Ie(d)-k(s,a)-Ie(a))>=w&&(c=(n=be(h))*a,1!==s))for(f=He.I(ye(y/Ie(d),4)),g=1;g<=f;g++)n+=(c=c*((p=g)-s)*d/p)/(a+p);if(u>1){for(h=a*Ie(d)+u*Ie(1-d)-k(a,u)-Ie(u),m=He.I(ye(h/w,0)),c=be(h-m*w),l=u*(r=1/(1-d))/(a+u-1),i=0,u===(f=He.I(u))&&(f-=1),g=1;g<=f&&!(l<=1&&c/_<=i);g++)(c=(u-(p=g)+1)*r*c/(a+u-p))>1&&(m-=1,c*=C),0===m&&(i+=c);n+=i}(d!==e||a!==t)&&(n=1-n),n=ye(Ce(n,1),0)}return n}function B(e){for(var o,n,r,i,a,s=t._Helper,l=0;l<e.length;l++)if(He.err(e[l]))return e[l];if(isNaN(o=He.D(e[0]))||isNaN(n=He.D(e[1]))||isNaN(r=He.D(e[2]))||(i=0,s._argumentExists(e,3)&&isNaN(i=He.D(e[3])))||(a=1,s._argumentExists(e,4)&&isNaN(a=He.D(e[4]))))return Oe;if(o<=0||1<=o||n<=0||r<=0)return Le;var u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b,T,A,I;if(I=o,n<0||r<0||o<0||o>1)return NaN;if(0===o||1===o)return o;for(f=k(n,r),o<=.5?(p=o,_=n,C=r,u=0):(p=1-o,_=r,C=n,u=1),b=(w=Ae(-Ie(p*p)))-(2.30753+.27061*w)/(1+(.99229+.04481*w)*w),_>1&&C>1?(R=b*Ae((m=2/((v=1/(_+_-1))+(S=1/(C+C-1))))+(w=(b*b-3)/6))/m-(S-v)*(w+5/6-2/(3*m)),I=_/(_+C*be(R+R))):(S=(w=C+C)*_e(1-(S=1/(9*C))+b*Ae(S),3))<=0?I=1-be((Ie((1-p)*C)+f)/C):I=(S=(4*_+w-2)/S)<=1?be((Ie(p*_)+f)/_):1-2/(S+1),w=1-_,S=1-C,T=0,d=1,I<3e-308?I=3e-308:I>1-2.22e-16&&(I=1-2.22e-16),A=ye(1e-300,_e(10,-13-2.5/(_*_)-.5/(p*p))),x=y=0,c=0;c<1e3;c++){for((b=((b=V(I,_,C))-p)*be(f+w*Ie(I)+S*Ie(1-I)))*T<=0&&(y=ye(Te(d),3e-308)),g=1,h=0;h<1e3;h++){if(Te(d=g*b)<y&&((x=I-d)>=0&&x<=1)){if(y<=A||Te(b)<=A)return 0!==u&&(I=1-I),He.toResult((a-i)*I+i);if(0!==x&&1!==x)break}g/=3}if(x===I)return 0!==u&&(I=1-I),He.toResult((a-i)*I+i);I=x,T=b}return 0!==u&&(I=1-I),He.toResult((a-i)*I+i)}function z(e){var t,o,n,r,i,a,s,l;if(isNaN(t=He.I(e[0]))||isNaN(o=He.I(e[1]))||isNaN(n=He.D(e[2])))return Oe;try{r=He.B(e[3])}catch(e){return Oe}if(t<0||o<0||o<t||n<0||1<n)return Le;if(r){if(o===t)return 1;if(0===(a=_e(i=1-n,o))){if(0===(a=_e(n,o)))return Le;for(l=1-a,s=0;s<o-t&&a>0;s++)l-=a*=He.D(o-s)/He.D((s+1)*i/n);return l<0?0:l}for(l=a,s=0;s<t&&a>0;s++)l+=a*=He.D(o-s)/He.D((s+1)*n/i);return l}if(0===(a=_e(i=1-n,o))){if(0===(a=_e(n,o)))return Le;for(s=0;s<o-t&&a>0;s++)a*=He.D(o-s)/He.D((s+1)*i/n);return a}for(s=0;s<t&&a>0;s++)a*=He.D(o-s)/He.D((s+1)*n/i);return a}function G(e){var t,o,n,r,i,a,s;if(isNaN(t=He.I(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2])))return Oe;if(t<0||o<0||1<o||n<=0||1<=n)return Le;if(0===(i=_e(r=1-o,t))){if(0===(i=_e(o,t)))return Le;for(a=1-i,s=0;s<t&&a>=n;s++)a-=i*=He.D(t-s)/He.D((s+1)*r/o);return He.D(t-s)}for(a=i,s=0;s<t&&a<n;s++)a+=i*=He.D(t-s)/He.D((s+1)*o/r);return He.D(s)}function W(e){for(var t,o,n,r,i,a,s=0;s<e.length;s++)if(He.err(e[s]))return e[s];if(isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1])))return Oe;if(t<0||o<1||o>_e(10,10))return Le;var l,u,c,h,p,d=Ie(Ae(xe)),f=1/Ae(xe),g=0,m=t;if(p=.5*m,n=o%2==0,o>1&&(g=be(-p)),(r=[])[0]=-Ae(m),i=Ge(r),He.err(i))return i;if(a=He.D(i),u=n?g:2*a,o>2){if(m=.5*(o-1),c=n?1:.5,p>20){for(l=n?0:d,h=Ie(p);c<=m;)l=Ie(c)+l,u+=be(h*c-p-l),c+=1;return u}for(l=n?1:f/Ae(p),h=0;c<=m;)h+=l*=p/c,c+=1;return h*g+u}return u}function j(e,t){return e<=0?0:(r=(o=t/2)*Ie(n=e/2)-n-D(o),i=be(r),n>o+1?1-i*function(e,t){var o=M(3),n=.5*o,r=1/o,i=0,a=0,s=1-e,l=t+2-e,u=0,c=t+1,h=1,p=1,d=l*t,f=t,g=c/d,m=!1,_=0;do{u=c*(l+=2)-h*(a=(s+=1)*(i+=1)),0!=(p=d*l-f*a)&&(m=Te((g-(_=u/p))/_)<=n,g=_),h=c,c=u,f=d,d=p,Te(u)>r&&(h*=o,c*=o,f*=o,d*=o)}while(!m&&i<1e4);return m?g:Oe}(o,n):i*function(e,t){var o=.5*M(3),n=e,r=1/e,i=r,a=1;do{i+=r=r*t/(n+=1),a+=1}while(r/i>o&&a<=1e4);return a>1e4?Oe:i}(o,n));var o,n,r,i}function U(e){var t,o,n,r,i,a,s;if(isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2])))return Oe;try{r=He.B(e[3])}catch(e){return Oe}if(t<0||o<=0||n<=0)return Le;if(!1!==r){var l,u,c,h,p,d,f,m,_,y,C,w,v,S;if((t/=n)<=0)return Le;if(o>1e3)return S=g([l=3*Ae(o)*(_e(t/o,1/3)+1/(9*o)-1),0,1,!0]),He.err(S)?S:He.D(S);if(t>1e8)return 1;if(t<=1||t<o){if((a=[])[0]=o+1,S=H(a),He.err(S))return S;f=o*Ie(t)-t-He.D(S),m=1,v=1,y=o;do{v+=m=m*t/(y+=1)}while(m>2.220446049250313e-16);f+=Ie(v),v=0,f>=-88&&(v=be(f))}else{if((s=[])[0]=o,S=H(s),He.err(S))return S;for(f=o*Ie(t)-t-He.D(S),m=0,l=1,u=t,v=(c=t+1)/(h=t*(C=(y=1-o)+t+1));;){if(p=(C+=2)*c-(w=(y+=1)*(m+=1))*l,Te(d=C*h-w*u)>0){if(Te(v-(_=p/d))<=Ce(2.220446049250313e-16,2.220446049250313e-16*_))break;v=_}l=c,u=h,c=p,h=d,Te(p)>=1e37&&(l/=1e37,u/=1e37,c/=1e37,h/=1e37)}f+=Ie(v),v=1,f>=-88&&(v=1-be(f))}return v}return i=_e(n,o),isNaN(i)||!isFinite(i)?Ne:1/(i*L(o))*(_e(t,o-1)*be(-t/n))}function Y(e){var t,o,n,r,i;if(isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2])))return Oe;var a,s,l,u,c,h,p,d,f,g,_,y,C;if(t<0||1<t||o<=0||n<=0)return Le;if(t<2e-6)return 0;if(t>.999998)return 1.79769e308;if(p=2*o,l=o-1,(r=[])[0]=o,i=H(r),He.err(i))return i;if(c=He.D(i),p<-1.24*Ie(t)){if((u=_e(t*o*be(c+.6931471805599453*o),1/o))<5e-7)return NaN}else if(p>.32){if(i=m([t,0,1]),He.err(i))return i;y=He.D(i),(u=p*_e(y*Ae(h=.222222/p)+1-h,3))>2.2*p+6&&(u=-2*(Ie(1-t)-l*Ie(.5*u)+c))}else{u=.4,a=Ie(1-t)+c+.6931471805599453*l;do{f=u,_=(4.67+2*u)/(h=1+u*(4.67+u))-.5-(6.73+u*(13.32+3*u))/(d=u*(6.73+u*(6.66+u))),u-=(1-be(a+.5*u)*d/h)/_}while(Te(f/u-1)>.01)}for(C=1;C<=20;C++){if(f=u,i=U([h=.5*u,o,1,!0]),He.err(i))return i;if(_=(d=t-He.D(i))*be(.6931471805599453*o+c+h-l*Ie(u)),Te(f/(u+=_*(1+.5*_*(g=(210+(a=.5*_-(s=_/u)*l)*(140+a*(105+a*(84+a*(70+60*a)))))/420)-s*l*(g-s*((420+a*(735+a*(966+a*(1141+1278*a))))/2520-s*((210+a*(462+a*(707+932*a)))/2520-s*((252+a*(672+1182*a)+l*(294+a*(889+1740*a)))/5040-s*((84+2264*a+l*(1175+606*a))/2520-s*((120+l*(346+127*l))/5040))))))))-1)>5e-7)return.5*n*u}return.5*n*u}function X(e){for(var t,o,n,r=0;r<e.length;r++)if(He.err(e[r]))return e[r];return isNaN(t=He.D(e[0]))?Oe:isNaN(o=He.I(e[1]))?Oe:t<0||t>1?Le:o<1||o>_e(10,10)?Le:(n=Y([1-t,.5*o,2]),He.D(n))}function K(e){var t,o,n,r,i,a,s=0,l=He.toArr(e[0],1,!0,!0,!1),u=He.toArr(e[1],1,!0,!0,!1);if(l.isError)return l[0];if(u.isError)return u[0];if(o=l.rowCount,n=l.colCount,o!==u.rowCount||n!==u.colCount)return Pe;if(o>1&&n>1)t=(o-1)*(n-1);else if(o>1&&1===n)t=o-1;else{if(!(1===o&&n>1))return Pe;t=n-1}for(r=0;r<l.length;r++)if(i=l[r],a=u[r],i!==He.CalcConvertedError&&a!==He.CalcConvertedError){if(0===a)return Ne;s+=(i-a)*(i-a)/a}return W([s,t])}function J(e){for(var t,o,n,r,i=0;i<e.length;i++)if(He.err(e[i]))return e[i];return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))?Oe:isNaN(n=He.D(e[2]))?Oe:t<0?Le:o<=0?Le:(r=be(-o*t),He.toResult(n?1-r:o*r))}function Z(e){var t,o,n;if(isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2])))return Oe;if(t<0||o<1||o>=_e(10,10)||n<1||n>=_e(10,10))return Le;var r=v([o*t/(o*t+n),.5*o,.5*n]);return He.err(r)?r:1-He.D(r)}function q(e){var t,o,n,r;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2]))?Oe:t<0||1<t||o<1||o>=_e(10,10)||n<1||n>=_e(10,10)?Le:(r=B([1-(1-t),n/2,o/2]),He.err(r)?r:(1/He.D(r)-1)*(n/o))}function $(e,t){for(var o,n,r,i=t.length,a=0;a<i;a++)(o=t[a])!==He.CalcConvertedError&&(r=(n=o-e.M)/(e.N+1),e.M+=r,e.Q+=e.N*n*r,e.N++,e.sum+=o)}function Q(e){var t,o,n,r,i,a,s,l,u=He.toArr(e[0],1,!0,!0,!1,!0);return u.isError?u[0]:(t=He.toArr(e[1],1,!0,!0,!1,!0)).isError?t[0]:($(o={N:0,M:0,Q:0,afun_flag:!1,sum:0},u),a=o.N-1,1===o.N?Ne:0===(n=o.Q/(o.N-1))?Ne:(o.N=0,o.M=0,o.Q=0,o.afun_flag=!1,o.sum=0,$(o,t),s=o.N-1,1===o.N?Ne:0===(r=o.Q/(o.N-1))?Ne:(l=Z([n/r,a,s]),He.err(l)?l:((i=2*(1-He.D(l)))>1&&(i=2-i),i))))}function ee(e,t,n,r){var i,a,s,l=o._MathHelper.combin(n,e);return He.err(l)?l:(i=He.D(l),l=o._MathHelper.combin(r-n,t-e),He.err(l)?l:(a=He.D(l),l=o._MathHelper.combin(r,t),He.err(l)?l:(s=He.D(l),He.toResult(i*a/s))))}function te(e){var t,o,n,r,i,a;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2]))?Oe:n<=0||t<0||t>1?Le:((r=[])[0]=t,i=_(r),He.err(i)?i:(a=He.D(i),He.toResult(be(o+n*a))))}function oe(e){for(var t=1,o=e;o>1;o--)t*=o;return t}function ne(e){var t,o,n,r,i;if(isNaN(t=He.I(e[0]))||isNaN(o=He.D(e[1])))return Oe;try{n=He.B(e[2])}catch(e){return Oe}if(r=0,t<=0||o<=0)return Le;if(n)for(i=0;i<=t;i++)r+=be(-o)*_e(o,i)/oe(i);else r=be(-o)*_e(o,t)/oe(t);return He.toResult(r)}function re(e){var t,o,n,r,i,a;if(isNaN(t=He.D(e[0]))||isNaN(o=He.I(e[1]))||isNaN(n=He.I(e[2])))return Oe;if(o<1||1!==n&&2!==n||t<0)return Le;var s=o,l=t/Ae(s),u=s/(s+t*t),c=s-2,h=s%2,p=1,d=1;if(s=1,i=r=2+h,c>=2)for(a=He.I(r);a<=c&&(p+=d=d*u*(i-1)/i)!==s;a+=2)s=p,i+=2;return 1!==h?n*(1-(.5+.5*l*Ae(u)*p)):(1===o&&(p=0),n*(1-(.5+.3183098862*(l*u*p+Re(l)))))}function ie(e,t,o){switch(o){case 1:return.5*S(t/(t+e*e),t/2,.5);case 2:return S(t/(t+e*e),t/2,.5);case 3:return _e(1+e*e/t,-(t+1)/2)/(Ae(t)*b(.5,t/2));case 4:var n=.5*S(t/(e*e+t),.5*t,.5);return e<0?n:1-n}return Oe}function ae(e){var t,o,n,r,i;if(isNaN(t=He.D(e[0]))||isNaN(o=He.I(e[1])))return Oe;if(t<0||1<t||o<1||o>_e(10,10))return Le;var a,s,l,u,c,h,p,d,f,g=t/2,m=g;if(o>1e20)return(n=[])[0]=g,_(n);if(m<.5?(f=0,c=2*m):(f=1,c=2*(1-m)),Te(o-2)<1e-12)h=c>0?Ae(2/(c*(2-c))-2):1.79769e308;else if(He.D(o)<1+1e-12)c>0?h=-Se(1.5707963267948966*(c+1)):h=1.79769e308;else{if(u=((94.5/((s=48/((a=1/(o-.5))*a))+(l=((20700*a/s-98)*a-16)*a+96.36))-3)/s+1)*Ae(1.5707963267948966*a)*o,(d=_e(u*c,2/o))>.05+a){if((r=[])[0]=.5*c,i=_(r),He.err(i))return i;p=He.D(i),o<5&&(l+=.3*(o-4.5)*(p+.6)),d=(((((.4*(d=p*p)+6.3)*d+36)*d+94.5)/(l=(((.05*u*p-5)*p-7)*p-2)*p+s+l)-d-3)/s+1)*p,d=(d*=a*d)>.002?be(d)-1:.5*d*d+d}else d=((1/(((o+6)/(o*d)-.089*u-.822)*(o+2)*3)+.5/(o+4))*d-1)*(o+1)/(o+2)+1/d;h=Ae(o*d)}return 0!==f&&(h=-h),He.toResult(h)}function se(e,t,o){var n={bConvError:!1},r=le(function(e,t,o){return this.getValue=function(n){return e-ie(n,t,o)},{getValue:this.getValue}}(e,t,o),.5*t,t,n);return n.bConvError?Pe:r}function le(e,t,o,n){for(var r,i=e.getValue(t),a=e.getValue(o),s=0;s<1e3&&!ue(i,a);s++)Te(i)<=Te(a)?(r=t,(t+=2*(t-o))<0&&(t=0),o=r,a=i,i=e.getValue(t)):(r=o,o+=2*(o-t),t=r,i=a,a=e.getValue(o));if(0==i)return t;if(0==a)return o;if(!ue(i,a))return n.bConvError=!0,0;var l=t,u=i,c=o,h=a,p=t,d=i,f=.5*(t+o),g=!0;for(s=0;s<500&&Te(d)>1e-307&&o-t>2.22045e-16*ye(Te(t),Te(o));)g&&(u!=h&&h!=d&&d!=u?g=t<(f=l*d*h/(d-u)/(h-u)+p*h*u/(h-d)/(u-d)+c*u*d/(u-h)/(d-h))&&f<o:g=!1),g||(f=.5*(t+o),l=t,u=i,c=o,h=a,g=!0),l=c,c=p,p=f,u=h,h=d,ue(i,d=e.getValue(f))?(o=p,a=d):(t=p,i=d),g=g&&2*Te(d)<=Te(h),++s;return p}function ue(e,t){return e<0&&t>0||e>0&&t<0}function ce(e,t){for(var o,n,r,i=t.length,a=0;a<i;a++)r=(n=(o=He.D(t[a]))-e.M)/(e.N+1),e.M+=r,e.Q+=e.N*n*r,e.N++,e.sum+=o}function he(e){var t,o,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=e,i=e+5.5;for(i-=(e+.5)*Ie(i),t=1.000000000190015,o=0;o<=5;o++)t+=n[o]/++r;return-i+Ie(2.5066282746310007*t/e)}function pe(e){var t,o,n,r,i,a,s,l,u,c,h,p,d,f,g=He.toArr(e[0],1,!0,!0,!0);if(g.isError)return g[0];if((t=He.toArr(e[1],1,!0,!0,!0)).isError)return t[0];if(g.isConvertError||t.isConvertError||(o=e[2],n=e[3],!He.num(o)||!He.num(n)))return Oe;var m,_,y,C,w,v,S,x,R,b=He.I(o),T=He.I(n),A={N:0,M:0,Q:0,sum:0,afun_flag:!1};if(1!==b&&2!==b||T<1||3<T)return Le;if(1===T){if(g.length!==t.length)return Pe;for(c=g.length,h=0;h<c;h++)g[h]=g[h]-t[h];for(i=a=s=l=u=r=0,h=0;h<c;h++)s+=a=(i=(p=g[h])-s)/(u+1),l+=u*i*a,u++,r+=p;if(u-1==0||0===u)return Ne;if(C=Ae(l/(u-1)),isNaN(C)||!isFinite(C))return Le;y=(m=r/u)/(C/Ae(u)),S=u-1}else A.N=0,A.M=0,A.Q=0,A.afun_flag=!1,A.sum=0,ce(A,g),w=A.Q/(A.N-1),m=A.sum/A.N,x=A.N,A.N=0,A.M=0,A.Q=0,A.afun_flag=!1,A.sum=0,ce(A,t),v=A.Q/(A.N-1),_=A.sum/A.N,R=A.N,2!==T?S=1/((d=w/x/(w/x+v/R))*d/He.D(x-1)+(1-d)*(1-d)/He.D(R-1)):S=He.D(x+R-2),y=(m-_)/Ae(w/He.D(x)+v/He.D(R));return f=function(e,t,o){var n,r,i,a,s,l,u,c=0===o||1===o?0:be(he(e+t)-he(e)-he(t)+e*Ie(o)+t*Ie(1-o)),h=o>=(e+1)/(e+t+2);h&&(n=e,e=t,t=n,o=1-o);var p=4.450147717014403e-308,d=e+t,f=e+1,g=e-1,m=1,_=1-d*o/f;for(Te(_)<p&&(_=p),r=_=1/_,i=1,a=2;i<=100;i++,a+=2)if(Te(_=1+(s=i*(t-i)*o/((g+a)*(e+a)))*_)<p&&(_=p),Te(m=1+s/m)<p&&(m=p),r*=(_=1/_)*m,Te(_=1+(s=-(e+i)*(d+i)*o/((e+a)*(f+a)))*_)<p&&(_=p),Te(m=1+s/m)<p&&(m=p),r*=l=(_=1/_)*m,Te(He.D(l-1))<5e-324)return u=c*r/e,h?1-u:u;return Le}(.5*S,.5,S/(S+(y=Te(y))*y)),He.err(f)?f:.5*b*He.D(f)}function de(e){var o,n,r,i,a,s,l=He.toArr(e[0],1,!0,!0,!1,!0);if(l.isError)return l[0];if(isNaN(o=He.D(e[1]))||(n=0,t._Helper._argumentExists(e,2)&&isNaN(n=He.D(e[2]))))return Oe;var u,c,h,p=0,d=0,f=0;for(r=0;r<l.length;r++)(i=l[r])!==He.CalcConvertedError&&(p+=h=He.D(i),d+=h*h,f++);return 0===f?Pe:1===f?Ne:(u=p/f,0===(c=t._Helper._argumentExists(e,2)?n:Ae((f*d-p*p)/(f*(f-1))))?Ne:((a=[])[0]=(u-o)/(c/Ae(f)),s=Ge(a),He.err(s)?s:He.toResult(1-He.D(s))))}function fe(e){var t,o,n,r;if(isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2])))return Oe;try{r=He.B(e[3])}catch(e){return Oe}return t<0||o<=0||n<=0?Le:r?He.toResult(1-be(-_e(t/n,o))):He.toResult(o/_e(n,o)*_e(t,o-1)*be(-_e(t/n,o)))}function ge(e){var t,o,n,r=He.D(e[1]),i=He.toArr(e[0],1,!0,!0,!1,!0);return i.isError?i[0]:(i.sort(function(e,t){return e-t}),0==i.length?Le:r<=0||1<=r?Le:(o=(t=r*(i.length+1)-1)%1,t<0||i.length-1<t?Le:(n=we(t),0===o?i[n]:i[n]+o*(i[n+1]-i[n]))))}e.feature("calc.functions_stat",["calc.functions"]);var me=null,_e=Math.pow,ye=Math.max,Ce=Math.min,we=Math.floor,ve=Math.sin,Se=Math.tan,xe=Math.PI,Re=Math.atan,be=Math.exp,Te=Math.abs,Ae=Math.sqrt,Ie=Math.log,De=Math.round,Fe=(xe=Math.PI,Math.expm1||function(e){return be(e)-1}),Me=Math.log1p||function(e){return Ie(1+e)},Ee=t.Errors,Ne=(Ee.Null,Ee.DivideByZero),Oe=Ee.Value,Pe=(Ee.Reference,Ee.Name,Ee.NotAvailable),Le=Ee.Number,He=t.Convert,ke="undefined",Ve="boolean",Be="string",ze="number",Ge=(o._StatHelper.__dev1,o._StatHelper.st_normsdist),We=o._StatHelper.__countIncludeSubtotals,je=o._StatHelper.__countaIncludeSubtotals,Ue=o._StatHelper.__maxIncludeSubtotals,Ye=o._StatHelper.__minIncludeSubtotals,Xe=o._StatHelper.__stdevpIncludeSubtotals,Ke=o._StatHelper.__varrIncludeSubtotals,Je=o._StatHelper.__varpIncludeSubtotals;o.def("MAX",function(e){return Ue(e,!0,!0)},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("MAXA",function(e){for(var t,o,n,r,i=!1,a=0,s=0;s<e.length;s++){if((r=He.toArr(e[s],0,!0,!0,!1)).isError)return r[0];if(r.isConvertError)return Oe;for(t=0;t<r.length;t++)if(o=r[t],He.num(o)||typeof o===Ve)n=He.D(o),(!i||n>a)&&(a=n),i=!0;else if(typeof o===Be)n=0,(!i||n>a)&&(a=n),i=!0;else if(He.err(o))return o}return a},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("MIN",function(e){return Ye(e,!0,!0)},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("MINA",function(e){for(var t,o,n,r,i=!1,a=0,s=0;s<e.length;s++){if((r=He.toArr(e[s],0,!0,!0,!1)).isError)return r[0];if(r.isConvertError)return Oe;for(t=0;t<r.length;t++)if(o=r[t],He.num(o)||typeof o===Ve)n=He.D(o),(!i||n<a)&&(a=n),i=!0;else{if(!r.isArray&&!r.isReference)return Oe;typeof o===Be&&(n=0,(!i||n<a)&&(a=n),i=!0)}}return a},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("LARGE",function(e){var t,o,n,r,i;if(He.err(e[0]))return e[0];if(He.err(e[1]))return e[1];if(isNaN(t=He.I(e[1])))return Oe;if((o=He.toArr(e[0],1,!0,!0,!1)).isError)return o[0];if(o.isConvertError)return Oe;for(n=[],r=0;r<o.length;r++)(i=o[r])!==He.CalcConvertedError&&n.push(i);return n.sort(function(e,t){return e-t}),t<=0||n.length<t?Le:n[n.length-t]},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("SMALL",function(e){var t,o,n,r,i;if(He.err(e[0]))return e[0];if(He.err(e[1]))return e[1];if(isNaN(t=He.I(e[1])))return Oe;if((o=He.toArr(e[0],1,!0,!0,!1)).isError)return o[0];if(o.isConvertError)return Oe;for(n=[],r=0;r<o.length;r++)(i=o[r])!==He.CalcConvertedError&&n.push(i);return n.sort(function(e,t){return e-t}),t<=0||n.length<t?Le:n[t-1]},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("AVERAGEA",function(e){for(var t,o,n,r=0,i=0,a=0;a<e.length;a++){if((t=He.toArr(e[a],0,!0,!0,!1,!0)).isError)return t[0];for(o=0;o<t.length;o++)if(n=t[o],He.num(n)||typeof n===Ve)r+=He.D(n),i++;else if(n===me)i++;else{if(!t.isArray&&!t.isReference)return Oe;typeof n===Be&&i++}}return 0===i?Ne:He.toResult(r/i)},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("AVERAGEIF",function(e){var o,r,i,a,s,l,u,c,h,p;if(t._Helper._argumentExists(e,2)){if(o=He.toArr(e[0],0,!0,!1,!1),(r=He.toArr(e[2],1,!0,!0,!1)).isError)return r[0]}else{if((o=He.toArr(e[0],1,!0,!0,!1)).isError)return o[0];r=o}if(i=e[1],a=e[1],He.ref(a)){for(s=a.getRowCount(0),l=a.getColumnCount(0),u=[],c=0;c<s;c++)for(u[c]=[],h=0;h<l;h++)u[c][h]=n(o,a.getValue(0,c,h),r);return new t._ConcreteArray(u)}if(p=e[1],He.arr(p)){for(s=p.rowCount,l=p.colCount,u=[],c=0;c<s;c++)for(u[c]=[],h=0;h<l;h++)u[c][h]=n(o,p.getValue(c,h),r);return new t._ConcreteArray(u)}return n(o,i,r)},{minArgs:2,maxArgs:3,acceptsMissingArgument:o.acceptsThird,acceptsArray:o.acceptsFirstOrThird,acceptsReference:o.acceptsFirstOrThird}),o.def("AVERAGEIFS",function(e){for(var t,n,r,i,a,s=0,l=0,u=He.toArr(e[0],1,!0,!0,!1),c=u.length,h=[],p=0;p<c;p++)if((a=u[p])!==He.CalcConvertedError){for(t=!0,n=1;n<e.length&&(h[n]?r=h[n]:h[n]=r=He.toArr(e[n],0,!0,!1,!1),i=e[n+1],t=o._MathHelper.parseCriteria(i)(r[p]));n+=2);t&&(s+=a,l++)}return 0===l?Ne:He.toResult(s/l)},{minArgs:3,acceptsArray:o.acceptsFirstOrOdd,acceptsReference:o.acceptsFirstOrOdd}),o.def("MEDIAN",function(e){for(var o,n,r,i=[],a=(t.Convert,0);a<e.length;a++){if((o=He.toArr(e[a],1,!0,!0,!1,!0)).isError)return o[0];if(o.isConvertError)return Oe;for(n=0;n<o.length;n++)(r=o[n])!==He.CalcConvertedError&&i.push(r)}return i.sort(function(e,t){return e-t}),0===i.length?Le:i.length%2==0?(He.D(i[i.length/2-1])+He.D(i[i.length/2]))/2:i[parseInt((i.length/2).toString(),10)]},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("MODE",r,{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("MODE.SNGL",r,{minArgs:1,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("GEOMEAN",function(e){for(var t,o,n,r=1,i=0,a=0;a<e.length;a++){if((n=He.toArr(e[a],1,!0,!0,!1)).isError)return n[0];if(n.isConvertError)return Oe;for(t=0;t<n.length;t++)if((o=n[t])!==He.CalcConvertedError){if(o<=0)return Le;r*=o,i++}}return i<=0?Ne:He.toResult(_e(r,1/i))},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("HARMEAN",function(e){for(var t,o,n,r=0,i=0,a=0;a<e.length;a++){if((n=He.toArr(e[a],1,!0,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return Oe;for(t=0;t<n.length;t++)if((o=n[t])!==He.CalcConvertedError){if(o<=0)return Le;r+=1/o,i++}}return 0===r?Ne:He.toResult(i/r)},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("TRIMMEAN",function(e){var o,n,r,i,a,s,l;if(t.Convert,isNaN(o=He.D(e[1])))return Oe;if(n=0,o<0||1<=o)return Le;if((r=He.toArr(e[0],1,!0,!0,!1,!0)).isError)return r[0];if(r.isConvertError)return Oe;for(i=[],a=0;a<r.length;a++)(s=r[a])!==He.CalcConvertedError&&i.push(s);for(i.sort(function(e,t){return e-t}),a=l=parseInt((i.length*o/2).toString(),10);a<i.length-l;a++)n+=He.D(i[a]);return n/(i.length-2*l)},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("FREQUENCY",function(e){for(var o,n,r,i,a,s,l=He.CalcConvertedError,u=He.toArr(e[0],1,!1,!0,!1,!0),c=He.toArr(e[1],1,!1,!0,!1,!0),h=0,p=c.rowCount,d=c.colCount,f=0;f<p;f++)for(o=0;o<d;o++)(n=c[f][o])!==l&&h++;var g=u.rowCount,m=u.colCount,_=[],y=[],C=h+1;for(h=0,f=0;f<p;f++)for(o=0;o<d;o++)(n=c[f][o])!==l&&(_[h++]=He.D(n));for(r=_.slice(0),_.sort(function(e,t){return e-t}),f=0;f<C;f++)y[f]=[0];for(f=0;f<g;f++)for(o=0;o<m;o++)if(n=u[f][o],He.num(n)){for(i=He.D(n),a=!1,s=0;!a&&s<h;s++)i<=_[s]&&(y[r.indexOf(_[s])][0]++,a=!0);a||y[h][0]++}return new t._ConcreteArray(y)},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("RANK",i,{minArgs:2,maxArgs:3,acceptsMissingArgument:o.acceptsThird,acceptsArray:o.acceptsFirstOrOne,acceptsReference:o.acceptsFirstOrOne}),o.def("RANK.EQ",i,{minArgs:2,maxArgs:3,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsSecond,acceptsMissingArgument:o.acceptsThird}),o.def("KURT",function(e){for(var t,o,n,r,i,a=0,s=0,l=0,u=0,c=[],h=0;h<e.length;h++){if((r=He.toArr(e[h],1,!0,!0,!1,!0)).isError)return r[0];if(r.isConvertError)return Oe;for(c.push(r),i=0;i<r.length;i++)(t=r[i])!==He.CalcConvertedError&&(a+=t,s+=t*t,u++);if(u<=3||(o=a/u,0===(n=Ae((u*s-a*a)/(u*(u-1))))))return Ne;for(h=0;h<e.length;h++)for(r=c[h],i=0;i<r.length;i++)(t=r[i])!==He.CalcConvertedError&&(l+=_e((t-o)/n,4));return He.toResult(u*(u+1)*l/((u-1)*(u-2)*(u-3))-3*(u-1)*(u-1)/((u-2)*(u-3)))}},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("PERCENTRANK",a,{minArgs:2,maxArgs:3,acceptsMissingArgument:o.acceptsThird,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("PERCENTRANK.INC",a,{minArgs:2,maxArgs:3,acceptsMissingArgument:o.acceptsThird,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("PERCENTRANK.EXC",function(e){return s(e,!1)},{minArgs:2,maxArgs:3,acceptsMissingArgument:o.acceptsThird,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("QUARTILE",l,{minArgs:2,maxArgs:2,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("QUARTILE.INC",l,{minArgs:2,maxArgs:2,acceptsReference:o.acceptsFirst,acceptsArray:o.acceptsFirst}),o.def("COUNT",function(e){return We(e,!0,!0)},{minArgs:1,acceptsError:o.acceptsAny,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("COUNTA",function(e){return je(e,!0,!0)},{minArgs:1,acceptsError:o.acceptsAny,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("COUNTBLANK",function(e){for(var t=0,o=He.toArr(e[0],0,!0,!1,!1),n=0;n<o.length;n++)o[n]===me&&t++;return t},{minArgs:1,maxArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("COUNTIF",function(e){var t,o,n,r=He.toArr(e[0],0,!0,!1,!1),i=He.toArr(e[1],0,!0,!1,!1),a=0;if(i.isArray||i.isReference){for(t=0;t<i.length;t++){if(o=u(r,i[t]),He.err(o))return o;if(isNaN(n=He.D(o)))return Oe;a+=n}return a}return u(r,i[0])},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsFirst,acceptsReference:o.acceptsFirst}),o.def("COUNTIFS",function(e){var t,n,r,i,a,s=0,l=He.toArr(e[0],0,!0,!0,!1);if(l.isError)return l[0];for(n=l.length,r=0;r<n;r++){for(i=!0,a=0;a<e.length;a+=2){t=He.toArr(e[a],0,!0,!1,!1);var u=e[a+1],c=o._MathHelper.parseCriteria(u),h=t[r];if(!(i=c&&c(h)))break}i&&s++}return He.toResult(s)},{minArgs:2,acceptsArray:o.acceptsEven,acceptsReference:o.acceptsEven}),o.def("AVEDEV",function(e){for(var t,o,n,r,i=0,a=0,s=0,l=[],u=0;u<e.length;u++){if((r=He.toArr(e[u],1,!0,!0,!1,!0)).isError)return r[0];if(r.isConvertError)return Oe;for(l.push(r),n=0;n<r.length;n++)(t=r[n])!==He.CalcConvertedError&&(i+=t,s++)}for(o=i/s,u=0;u<e.length;u++)for(r=l[u],n=0;n<r.length;n++)(t=r[n])!==He.CalcConvertedError&&(a+=Te(t-o));return 0===s?Ne:He.toResult(a/s)},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("STDEVA",function(e){var t={sumx:0,sumx2:0,n:0},o=c(e,t);return He.err(o)?o:t.n<=1?Ne:He.toResult(Ae(ye(0,(t.n*t.sumx2-t.sumx*t.sumx)/(t.n*(t.n-1)))))},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("STDEVP",h,{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("STDEVPA",function(e){var t={sumx:0,sumx2:0,n:0},o=c(e,t);return He.err(o)?o:t.n<=0?Ne:He.toResult(Ae(ye(0,(t.n*t.sumx2-t.sumx*t.sumx)/(t.n*t.n))))},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("VAR",p,{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("VAR.S",p,{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("VARA",function(e){var t={sumx:0,sumx2:0,n:0},o=c(e,t);return He.err(o)?o:t.n<=1?Ne:He.toResult(ye(0,(t.n*t.sumx2-t.sumx*t.sumx)/(t.n*(t.n-1))))},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("VARP",d,{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("VARPA",function(e){var t={sumx:0,sumx2:0,n:0},o=c(e,t);return He.err(o)?o:t.n<=0?Ne:He.toResult(ye(0,(t.n*t.sumx2-t.sumx*t.sumx)/(t.n*t.n)))},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("COVAR",f,{minArgs:2,maxArgs:2,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("COVARIANCE.P",f,{minArgs:2,maxArgs:2,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("DEVSQ",function(e){for(var t,o,n,r,i=0,a=0,s=0,l=[],u=0;u<e.length;u++){if((r=He.toArr(e[u],1,!0,!0,!1,!0)).isError)return r[0];for(l.push(r),n=0;n<r.length;n++)(t=r[n])!==He.CalcConvertedError&&(i+=t,s++)}for(o=i/s,u=0;u<e.length;u++)for(r=l[u],n=0;n<r.length;n++)(t=r[n])!==He.CalcConvertedError&&(a+=(t-o)*(t-o));return He.toResult(a)},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("CONFIDENCE",y,{minArgs:3,maxArgs:3}),o.def("CONFIDENCE.NORM",y,{minArgs:3,maxArgs:3}),o.def("CONFIDENCE.T",function(e){var t,o,n;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.I(e[2]))?Oe:t<=0||t>=1?Le:o<=0?Le:n<1?Le:1===n?Ne:o*se(t,n-1,2)/Ae(n)},{minArgs:3,maxArgs:3}),o.def("INTERCEPT",function(e){var t,o,n,r,i,a=0,s=0,l=0,u=0,c=He.toArr(e[0],1,!0,!0,!1),h=He.toArr(e[1],1,!0,!0,!1),p=c.length;if(p!==h.length)return Pe;if(c.isError)return c[0];if(h.isError)return h[0];for(o=0,n=0;n<p;n++)r=c[n],(i=h[n])!==He.CalcConvertedError&&r!==He.CalcConvertedError&&(a+=r,s+=i,l+=i*i,u+=i*r,o++);return 0===o?Ne:o*l-s*s==0?Ne:(t=(o*u-s*a)/(o*l-s*s),He.toResult(a/o-t*(s/o)))},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("LINEST",function(e){var o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S,x,R,b=t._Helper,T=He.toArr(e[0],1,!1,!0,!0),A=b._argumentExists(e,1)?e[1]:function(e,o){for(var n,r=[],i=0;i<e;i++)for(r[i]=[],n=0;n<o;n++)r[i][n]=i*o+n+1;return new t._ConcreteArray(r)}(T.rowCount,T.colCount);if(o=He.toArr(A,1,!1,!0,!0),n=!b._argumentExists(e,2)||He.B(e[2]),r=!!b._argumentExists(e,3)&&He.B(e[3]),T.rowCount===o.rowCount&&T.colCount===o.colCount&&(n||!r)){u=He.D(o.rowCount*o.colCount);var I,D=0,F=0,M=0,E=0,N=0;for(i=0;i<o.rowCount;i++)for(a=0;a<o.colCount;a++)D+=c=o[i][a],F+=c*c,M+=h=T[i][a],E+=h*h,N+=c*h;if(n?(l=(u*N-D*M)/(u*F-D*D),I=(M*F-D*N)/(u*F-D*D)):(l=N/F,I=0),(f=[])[0]=[],f[0][0]=l,f[0][1]=I,r){f[1]=[],f[2]=[],f[3]=[],f[4]=[];var O=u*F-D*D,P=u*E-M*M,L=u*N-D*M,H=E-I*M-l*N,k=L*L/(O*P);u<3?(f[1][0]=Le,f[1][1]=Le,f[2][1]=Le,f[3][0]=Le):(f[1][0]=Ae(H*u/(O*(u-2))),f[1][1]=Ae(H*F/(O*(u-2))),f[2][1]=Ae((P-L*L/O)/(u*(u-2))),f[3][0]=1===k?Le:k*(u-2)/(1-k)),f[2][0]=k,f[3][1]=u-2,f[4][0]=P/u-H,f[4][1]=H}return new t._ConcreteArray(f)}if(1===T.colCount&&T.rowCount===o.rowCount||1===T.rowCount&&T.colCount===o.colCount){if(h=[],c=[],1===T.colCount){for(u=o.rowCount,l=o.colCount,i=0;i<u;i++)h[i]=T[i][0];for(i=0;i<u;i++)for(c[i]=[],a=0;a<l;a++)c[i][a]=o[i][a]}else{for(u=o.colCount,l=o.rowCount,c=[],h=[],i=0;i<u;i++)h[i]=T[0][i];for(i=0;i<u;i++)for(c[i]=[],a=0;a<l;a++)c[i][a]=o[a][i]}for(C=[],s=0;s<l+1;s++)C[s]=[];for(p=0;p<l+1;p++)for(d=0;d<l+2;d++)C[p][d]=0;for(w=[],p=0;p<l+2;p++)w[p]=0;for(v=r?[]:me,s=0;s<u;s++)for(w[l+1]=w[l+1]+h[s]*h[s],C[0][l+1]=C[0][l+1]+h[s],w[0]=C[0][l+1],i=0;i<l;i++)for(C[0][i+1]=C[0][i+1]+c[s][i],C[i+1][0]=C[0][i+1],C[i+1][l+1]=C[i+1][l+1]+c[s][i]*h[s],w[i+1]=C[i+1][l+1],a=i;a<l;a++)C[a+1][i+1]=C[a+1][i+1]+c[s][i]*c[s][a],C[i+1][a+1]=C[a+1][i+1];if(C[0][0]=u,r){for(p=0;p<l+1;p++)for(v[p]=[],d=0;d<l+1;d++)v[p][d]=0;for(i=0;i<l+1;i++)v[i][i]=1}if(n)for(i=0;i<l+1;i++){if(0===C[i][i]&&i<l){for(g=!1,a=i+1;!g&&a<l+1;a++)if(0!==C[a][i]){for(s=0;s<l+2;s++)m=C[i][s],C[i][s]=C[a][s],C[a][s]=m;if(r)for(s=0;s<l+1;s++)m=v[i][s],v[i][s]=v[a][s],v[a][s]=m;g=!0}if(!g)return Le}for(_=1/C[i][i],s=0;s<l+2;s++)C[i][s]=C[i][s]*_;if(r)for(s=0;s<l+1;s++)v[i][s]=v[i][s]*_;for(a=0;a<l+1;a++)if(a!==i){for(_=-C[a][i],s=0;s<l+2;s++)C[a][s]=C[a][s]+_*C[i][s];if(r)for(s=0;s<l+1;s++)v[a][s]=v[a][s]+_*v[i][s]}}else for(i=1;i<l+1;i++){if(0===C[i][i]){for(g=!1,a=i+1;!g&&a<l+1;a++)if(0!==C[a][i]){for(s=0;s<l+2;s++)m=C[i][s],C[i][s]=C[a][s],C[a][s]=m;if(r)for(s=0;s<l+1;s++)m=v[i][s],v[i][s]=v[a][s],v[a][s]=m;g=!0}if(!g)return Le}for(_=1/C[i][i],s=1;s<l+2;s++)C[i][s]=C[i][s]*_;if(r)for(s=1;s<l+1;s++)v[i][s]=v[i][s]*_;for(a=1;a<l+1;a++)if(a!==i){for(_=-C[a][i],s=1;s<l+2;s++)C[a][s]=C[a][s]+_*C[i][s];if(r)for(s=1;s<l+1;s++)v[a][s]=v[a][s]+_*v[i][s]}C[0][l+1]=0}for((f=[r?5:1,l+1])[0]=[],i=0;i<l+1;i++)f[0][i]=C[l-i][l+1];if(r){for(p=1;p<5;p++)for(f[p]=[],d=0;d<l+1;d++)f[p][d]=0;for(x=w[l+1]-w[0]*w[0]/u,S=w[l+1],i=0;i<l+1;i++)S-=C[i][l+1]*w[i];if(R=x-S,f[2][0]=0===x?Le:R/x,f[4][0]=R,f[4][1]=S,n){if(u-l-1==0)for(f[2][1]=Le,i=0;i<l+1;i++)f[1][i]=Le;else{for(y=S/(u-l-1),i=0;i<l+1;i++)f[1][l-i]=Ae(y*v[i][i]);f[2][1]=Ae(y)}f[3][0]=0===S?Le:He.D(u-l-1)*R/(S*He.D(l)),f[3][1]=He.D(u-l-1)}else{if(u-l==0){for(i=0;i<l+1;i++)f[1][i]=Le;f[2][1]=Le}else{for(y=S/He.D(u-l),f[1][l]=Pe,i=1;i<l+1;i++)f[1][l-i]=Ae(y*v[i][i]);f[2][1]=Ae(y)}f[3][0]=0===S?Le:He.D(u-l)*R/(S*He.D(l)),f[3][1]=He.D(u-l)}for(i=2;i<5;i++)for(a=2;a<l+1;a++)f[i][a]=Pe}return f=[f[0]],new t._ConcreteArray(f)}return Le},{minArgs:1,maxArgs:4,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsFirstOrOne,acceptsMissingArgument:o.acceptsSecondOrThirdOrFourth,arrayArgumentEvaluateMode:1}),o.def("SLOPE",function(e){var t,o,n,r,i,a=He.toArr(e[0],1,!0,!1,!1),s=He.toArr(e[1],1,!0,!1,!1),l=0,u=0,c=0,h=0,p=0,d=s.length;if(d!==a.length)return Pe;for(t=0;t<d;t++)o=a[t],(n=s[t])===He.CalcConvertedError||o===He.CalcConvertedError||He.err(n)||He.err(o)||(l+=r=He.D(o),u+=i=He.D(n),c+=i*i,h+=i*r,p++);return p*c-u*u==0?Ne:He.toResult((p*h-u*l)/(p*c-u*u))},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny,arrayArgumentEvaluateMode:1}),o.def("LOGEST",function(e){var o,n,r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w,v,S=t._Helper,x=He.toArr(e[0],1,!1,!0,!0),R=S._argumentExists(e,1)?He.toArr(e[1],1,!1,!0,!0):x,b=!S._argumentExists(e,2)||He.B(e[2]),T=!!S._argumentExists(e,3)&&He.B(e[3]);if(x.rowCount===R.rowCount&&x.colCount===R.colCount&&(b||!T)){a=R.rowCount*R.colCount;var A,I=0,D=0,F=0,M=0,E=0;for(o=0;o<R.rowCount;o++)for(n=0;n<R.colCount;n++)s=R[o][n],l=x[o][n],I+=s,D+=s*s,F+=l=Ie(l),M+=l*l,E+=s*l;if(b?(i=(a*E-I*F)/(a*D-I*I),A=(F*D-I*E)/(a*D-I*I)):(i=E/D,A=0),(h=[])[0]=[],h[0][0]=be(i),h[0][1]=be(A),T){h[1]=[],h[2]=[],h[3]=[],h[4]=[];var N=a*D-I*I,O=a*M-F*F,P=a*E-I*F,L=M-A*F-i*E,H=P*P/(N*O);a<3?(h[1][0]=Le,h[1][1]=Le,h[2][1]=Le,h[3][0]=Le):(h[1][0]=Ae(L*a/(N*(a-2))),h[1][1]=Ae(L*D/(N*(a-2))),h[2][1]=Ae((O-P*P/N)/(a*(a-2))),h[3][0]=1===H?Le:H*(a-2)/(1-H)),h[2][0]=H,h[3][1]=a-2,h[4][0]=O/a-L,h[4][1]=L}return new t._ConcreteArray(h)}if(1===x.colCount&&x.rowCount===R.rowCount||1===x.rowCount&&x.colCount===R.colCount){if(l=[],s=[],1===x.colCount){for(a=R.rowCount,i=R.colCount,o=0;o<a;o++)l[o]=Ie(x[o][0]);for(o=0;o<a;o++)for(s[o]=[],n=0;n<i;n++)s[o][n]=R[o][n]}else{for(a=R.colCount,i=R.rowCount,s=[],l=[],o=0;o<a;o++)l[o]=Ie(x[0][o]);for(o=0;o<a;o++)for(s[o]=[],n=0;n<i;n++)s[o][n]=R[n][o]}for(m=[],u=0;u<i+1;u++)for(m[u]=[],c=0;c<i+2;c++)m[u][c]=0;for(_=[],u=0;u<i+2;u++)_[u]=0;for(y=T?[]:me,r=0;r<a;r++)for(_[i+1]=_[i+1]+l[r]*l[r],m[0][i+1]=m[0][i+1]+l[r],_[0]=m[0][i+1],o=0;o<i;o++)for(m[0][o+1]=m[0][o+1]+s[r][o],m[o+1][0]=m[0][o+1],m[o+1][i+1]=m[o+1][i+1]+s[r][o]*l[r],_[o+1]=m[o+1][i+1],n=o;n<i;n++)m[n+1][o+1]=m[n+1][o+1]+s[r][o]*s[r][n],m[o+1][n+1]=m[n+1][o+1];if(m[0][0]=a,T){for(u=0;u<i+1;u++)for(y[u]=[],c=0;c<i+1;c++)y[u][c]=0;for(o=0;o<i+1;o++)y[o][o]=1}if(b)for(o=0;o<i+1;o++){if(0===m[o][o]){for(f=!1,n=o+1;!f&&n<i+1;n++)if(0!==m[n][o]){for(r=0;r<i+2;r++)d=m[o][r],m[o][r]=m[n][r],m[n][r]=d;if(T)for(r=0;r<i+1;r++)d=y[o][r],y[o][r]=y[n][r],y[n][r]=d;f=!0}if(!f)return Le}for(p=1/m[o][o],r=0;r<i+2;r++)m[o][r]=m[o][r]*p;if(T)for(r=0;r<i+1;r++)y[o][r]=y[o][r]*p;for(n=0;n<i+1;n++)if(n!==o){for(p=-m[n][o],r=0;r<i+2;r++)m[n][r]=m[n][r]+p*m[o][r];if(T)for(r=0;r<i+1;r++)y[n][r]=y[n][r]+p*y[o][r]}}else for(o=1;o<i+1;o++){if(0===m[o][o]){for(f=!1,n=o+1;!f&&n<i+1;n++)if(0!==m[n][o]){for(r=0;r<i+2;r++)d=m[o][r],m[o][r]=m[n][r],m[n][r]=d;if(T)for(r=0;r<i+1;r++)d=y[o][r],y[o][r]=y[n][r],y[n][r]=d;f=!0}if(!f)return Le}for(p=1/m[o][o],r=1;r<i+2;r++)m[o][r]=m[o][r]*p;if(T)for(r=1;r<i+1;r++)y[o][r]=y[o][r]*p;for(n=1;n<i+1;n++)if(n!==o){for(p=-m[n][o],r=1;r<i+2;r++)m[n][r]=m[n][r]+p*m[o][r];if(T)for(r=1;r<i+1;r++)y[n][r]=y[n][r]+p*y[o][r]}m[0][i+1]=0}for((h=[])[0]=[],o=0;o<i+1;o++)h[0][o]=be(m[i-o][i+1]);if(T){for(h[1]=[],h[2]=[],h[3]=[],h[4]=[],w=_[i+1]-_[0]*_[0]/a,C=_[i+1],o=0;o<i+1;o++)C-=m[o][i+1]*_[o];if(v=w-C,h[2][0]=0===w?Le:v/w,h[4][0]=v,h[4][1]=C,b){if(a-i-1==0)for(h[2][1]=Le,o=0;o<i+1;o++)h[1][o]=Le;else{for(g=C/(a-i-1),o=0;o<i+1;o++)h[1][i-o]=Ae(g*y[o][o]);h[2][1]=Ae(g)}h[3][0]=0===C?Le:He.D(a-i-1)*v/(C*He.D(i)),h[3][1]=He.D(a-i-1)}else{if(a-i==0){for(o=0;o<i+1;o++)h[1][o]=Le;h[2][1]=Le}else{for(g=C/He.D(a-i),h[1][i]=Pe,o=1;o<i+1;o++)h[1][i-o]=Ae(g*y[o][o]);h[2][1]=Ae(g)}h[3][0]=0===C?Le:He.D(a-i)*v/(C*He.D(i)),h[3][1]=He.D(a-i)}for(o=2;o<5;o++)for(n=2;n<i+1;n++)h[o][n]=Pe}return new t._ConcreteArray(h)}return Le},{minArgs:1,maxArgs:4,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsFirstOrOne,acceptsMissingArgument:o.acceptsSecondOrThirdOrFourth}),o.def("STEYX",function(e){var t,o,n,r,i,a=0,s=0,l=0,u=0,c=0,h=0,p=He.CalcConvertedError,d=He.toArr(e[0],1,!0,!0,!1),f=He.toArr(e[1],1,!0,!0,!1),g=d.length;if(g!==f.length)return Pe;for(n=0;n<g;n++)r=d[n],i=f[n],r!==p&&i!==p&&(a+=o=r,s+=o*o,l+=t=i,u+=t*t,c+=t*o,h++);return h*(h-2)==0?Ne:h*u-l*l==0?Ne:Ae((h*s-a*a-(h*c-l*a)*(h*c-l*a)/(h*u-l*l))/(h*(h-2)))},{minArgs:2,maxArgs:2,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("BETADIST",v,{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsFourthOrFifth}),o.def("BETA.DIST",function(e){for(var o,n,r,i,a,s,l,u=t._Helper,c=0;c<e.length;c++)if(He.err(e[c]))return e[c];return isNaN(o=He.D(e[0]))||isNaN(n=He.D(e[1]))||isNaN(r=He.D(e[2]))?Oe:(i=He.B(e[3]),a=0,u._argumentExists(e,4)&&isNaN(a=He.D(e[4]))?Oe:(s=1,u._argumentExists(e,5)&&isNaN(s=He.D(e[5]))?Oe:n<=0||r<=0?Le:o<a||s<o||a===s?Le:(l=(o-a)/(s-a),i?S(l,n,r):x(l,n,r)/(s-a))))},{minArgs:4,maxArgs:6,acceptsMissingArgument:o.acceptsFiveSix}),o.def("BETAINV",B,{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsFourthOrFifth}),o.def("BETA.INV",B,{minArgs:3,maxArgs:5,acceptsMissingArgument:o.acceptsFourthOrFifth}),o.def("BINOMDIST",z,{minArgs:4,maxArgs:4}),o.def("BINOM.DIST",z,{minArgs:4,maxArgs:4}),o.def("NEGBINOMDIST",function(e){var t,n,r,i;if(isNaN(t=He.I(e[0]))||isNaN(n=He.I(e[1]))||isNaN(r=He.D(e[2])))return Oe;if(r<0||r>=1||t+n-1<=0)return Le;if(i=o._MathHelper.combin(t+n-1,n-1),He.err(i))return i;var a=He.D(i),s=_e(r,n),l=_e(1-r,t);return He.toResult(a*s*l)},{minArgs:3,maxArgs:3}),o.def("NEGBINOM.DIST",function(e){var t,o,n,r,i;if(isNaN(t=He.I(e[0]))||isNaN(o=He.I(e[1])))return Oe;if(t<0||o<1)return Le;if(isNaN(n=He.D(e[2])))return Oe;if(n<0||n>=1||t+o-1<=0)return Le;if(He.B(e[3]))return 1-S(1-n,t+1,o);for(r=_e(n,o),i=0;i<t;i++)r*=(i+o)/(i+1)*(1-n);return r},{minArgs:4,maxArgs:4}),o.def("CRITBINOM",G,{minArgs:3,maxArgs:3}),o.def("BINOM.INV",G,{minArgs:3,maxArgs:3}),o.def("CHIDIST",W,{minArgs:2,maxArgs:2}),o.def("CHISQ.DIST.RT",W,{minArgs:2,maxArgs:2}),o.def("CHISQ.DIST",function(e){for(var t,o,n=0;n<e.length;n++)if(He.err(e[n]))return e[n];return isNaN(t=He.D(e[0]))||isNaN(o=He.I(e[1]))?Oe:t<0?Le:o<1||o>_e(10,10)?Le:He.B(e[2])?j(t,o):function(e,t){var o,n;if(e<=0)return 0;if(t*e>1391e3)o=be((.5*t-1)*Ie(.5*e)-.5*e-Ie(2)-D(.5*t));else{for(t%2<.5?(o=.5,n=2):(o=1/Ae(2*e*xe),n=1);n<t;)o*=e/n,n+=2;e>=1425?o=be(Ie(o)-e/2):o*=be(-e/2)}return o}(t,o)},{minArgs:3,maxArgs:3}),o.def("CHIINV",X,{minArgs:2,maxArgs:2}),o.def("CHISQ.INV.RT",X,{minArgs:2,maxArgs:2}),o.def("CHISQ.INV",function(e){for(var t,o,n=0;n<e.length;n++)if(He.err(e[n]))return e[n];if(isNaN(t=He.D(e[0]))||isNaN(o=He.I(e[1])))return Oe;if(t<0||t>1||o<1||o>_e(10,10))return Le;var r={bConvError:!1},i=le(function(e,t){return this.getValue=function(o){return e-j(o,t)},{getValue:this.getValue}}(t,o),.5*o,o,r);return r.bConvError?Pe:i},{minArgs:2,maxArgs:2}),o.def("CHITEST",K,{minArgs:2,maxArgs:2,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("CHISQ.TEST",K,{minArgs:2,maxArgs:2,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("CORREL",function(e){var t,o,n,r,i,a,s,l,u,c=0,h=0,p=0,d=0,f=0,g=He.toArr(e[0],1,!0,!0,!1),m=He.toArr(e[1],1,!0,!0,!1);if(g.isError)return g[0];if(m.isError)return m[0];if((i=m.length)!==g.length)return Pe;for(a=0,s=0;s<i;s++)l=g[s],u=m[s],l!==He.CalcConvertedError&&u!==He.CalcConvertedError&&(c+=l,h+=u,p+=l*l,d+=u*u,a++);if(a<=1||(t=c/a,o=h/a,n=Ae((a*p-c*c)/(a*(a-1))),r=Ae((a*d-h*h)/(a*(a-1))),0===n||0===r))return Ne;for(s=0;s<i;s++)l=g[s],u=m[s],l!==He.CalcConvertedError&&u!==He.CalcConvertedError&&(f+=(l-t)*(u-o));return He.toResult(f/He.D((a-1)*n*r))},{minArgs:2,maxArgs:2,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("EXPONDIST",J,{minArgs:3,maxArgs:3}),o.def("EXPON.DIST",J,{minArgs:3,maxArgs:3}),o.def("FDIST",Z,{minArgs:3,maxArgs:3}),o.def("F.DIST",function(e){var t,o,n,r,i;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2]))?Oe:t<0||o<1||o>=_e(10,10)||n<1||n>=_e(10,10)?Le:He.B(e[3])?1-S((i=n)/(i+(r=o)*t),i/2,r/2):_e(o/n,o/2)*_e(t,o/2-1)/(_e(1+t*o/n,(o+n)/2)*b(o/2,n/2))},{minArgs:4,maxArgs:4}),o.def("F.DIST.RT",Z,{minArgs:3,maxArgs:3}),o.def("FINV",q,{minArgs:3,maxArgs:3}),o.def("F.INV.RT",q,{minArgs:3,maxArgs:3}),o.def("F.INV",function(e){var t,o,n,r;return isNaN(t=He.D(e[0]))||isNaN(o=He.I(e[1]))||isNaN(n=He.I(e[2]))?Oe:t<0||1<t||o<1||o>=_e(10,10)||n<1||n>=_e(10,10)?Le:(r=B([1-t,n/2,o/2]),He.err(r)?r:(1/He.D(r)-1)*(n/o))},{minArgs:3,maxArgs:3}),o.def("FISHER",function(e){var t;return isNaN(t=He.D(e[0]))?Oe:t<=-1||1<=t?Le:Ie((1+t)/(1-t))/2},{minArgs:1,maxArgs:1}),o.def("FISHERINV",function(e){var t,o,n;return isNaN(t=He.D(e[0]))?Oe:(o=be(2*t)-1,n=be(2*t)+1,!isFinite(o)&&o>0&&!isFinite(n)&&n>0?1:o/n)},{minArgs:1,maxArgs:1}),o.def("FTEST",Q,{minArgs:2,maxArgs:2,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("F.TEST",Q,{minArgs:2,maxArgs:2,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("GAMMADIST",U,{minArgs:4,maxArgs:4}),o.def("GAMMA.DIST",U,{minArgs:4,maxArgs:4}),o.def("GAMMAINV",Y,{minArgs:3,maxArgs:3}),o.def("GAMMA.INV",Y,{minArgs:3,maxArgs:3}),o.def("GAMMALN",H,{minArgs:1,maxArgs:1}),o.def("GAMMALN.PRECISE",H,{minArgs:1,maxArgs:1}),o.def("HYPGEOMDIST",function(e){var t=He.I(e[0]),o=He.I(e[1]),n=He.I(e[2]),r=He.I(e[3]);return t<0||t>Ce(o,n)?Le:t<ye(0,o-r+n)?Le:o<0||o>r?Le:n<0||n>r?Le:r<0?Le:ee(t,o,n,r)},{minArgs:4,maxArgs:4}),o.def("HYPGEOM.DIST",function(e){var t,o,n=He.I(e[0]),r=He.I(e[1]),i=He.I(e[2]),a=He.I(e[3]);if(n<0||n>Ce(r,i)||n<ye(0,r-a+i)||r<0||r>a||i<0||i>a||a<0)return Le;if(He.B(e[4])){for(t=0,o=0;o<=n;o++)t+=ee(o,r,i,a);return t}return ee(n,r,i,a)},{minArgs:5,maxArgs:5}),o.def("LOGNORMDIST",function(e){var t,o,n,r;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2]))?Oe:t<=0||n<=0?Le:((r=[])[0]=(Ie(t)-o)/n,Ge(r))},{minArgs:3,maxArgs:3}),o.def("LOGNORM.DIST",function(e){var t,o,n,r,i,a;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2]))?Oe:(r=He.B(e[3]),t<=0||n<=0?Le:r?((i=[])[0]=(Ie(t)-o)/n,Ge(i)):(a=(Ie(t)-o)/n,.3989422804014327*be(-a*a/2)/n/t))},{minArgs:4,maxArgs:4}),o.def("LOGINV",te,{minArgs:3,maxArgs:3}),o.def("LOGNORM.INV",te,{minArgs:3,maxArgs:3}),o.def("NORMDIST",g,{minArgs:4,maxArgs:4}),o.def("NORM.DIST",g,{minArgs:4,maxArgs:4}),o.def("NORMINV",m,{minArgs:3,maxArgs:3}),o.def("NORM.INV",m,{minArgs:3,maxArgs:3}),o.def("NORMSDIST",Ge,{minArgs:1,maxArgs:1}),o.def("NORMSINV",_,{minArgs:1,maxArgs:1}),o.def("NORM.S.INV",_,{minArgs:1,maxArgs:1}),o.def("NORM.S.DIST",function(e){var o,n,r,i;return isNaN(o=He.D(e[0]))?Oe:He.B(e[1])?(n=.7071067811865475*-(n=o),r=He.D(n),isNaN(r)?Oe:typeof(i=Ge([r*Ae(2)]))==typeof t.Errors?NaN:.5*(1-(2*parseFloat(i)-1))):be(-_e(o,2)/2)/Ae(2*xe)},{minArgs:2,maxArgs:2}),o.def("PEARSON",function(e){var t,o,n,r,i=0,a=0,s=0,l=0,u=0,c=He.toArr(e[0],1,!0,!1,!1),h=He.toArr(e[1],1,!0,!1,!1),p=c.length;if(p!==h.length)return Pe;for(t=0,o=0;o<p;o++)n=c[o],r=h[o],typeof n===ze&&typeof r===ze&&(i+=n,a+=r,s+=n*n,l+=r*r,u+=n*r,t++);return t*s-i*i==0||t*l-a*a==0?Ne:(t*u-i*a)/Ae((t*s-i*i)*(t*l-a*a))},{minArgs:2,maxArgs:2,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("RSQ",function(e){var t,o,n,r,i,a=He.toArr(e[0],1,!0,!1,!1),s=He.toArr(e[1],1,!0,!1,!1),l=0,u=0,c=0,h=0,p=0,d=0,f=s.length;if(f!==a.length)return Pe;for(t=0;t<f;t++)o=s[t],n=a[t],typeof o===ze&&typeof n===ze&&(l+=o,u+=n,c+=o*o,h+=n*n,p+=o*n,d++);return 0===(r=Ae((d*c-l*l)*(d*h-u*u)))?Ne:(i=(d*p-l*u)/r,He.toResult(i*i))},{minArgs:2,maxArgs:2,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsFirstOrOne}),o.def("POISSON",ne,{minArgs:3,maxArgs:3}),o.def("POISSON.DIST",ne,{minArgs:3,maxArgs:3}),o.def("PROB",function(e){var o,n,r,i,a,s,l;if(isNaN(o=He.D(e[2]))||(n=o,t._Helper._argumentExists(e,3)&&isNaN(n=He.D(e[3]))))return Oe;var u=0,c=0,h=He.toArr(e[0],1,!0,!0,!0);if(h.isError)return h[0];if(h.isConvertError)return Oe;if((r=He.toArr(e[1],1,!0,!0,!1)).isError)return r[0];if((i=h.length)!==r.length)return Pe;for(a=0;a<i;a++)if(s=h[a],l=r[a],s!==He.CalcConvertedError&&l!==He.CalcConvertedError){if(l<=0||1<l)return Le;o<=s&&s<=n&&(u+=l),c+=l}return 1!==c?Le:u},{minArgs:3,maxArgs:4,acceptsMissingArgument:o.acceptsFourth,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsFirstOrOne}),o.def("SKEW",function(t){if(typeof t[0]===ke||t[0]===me)throw e.SR.Exp_InvalidArgument;for(var o,n,r,i,a,s=0,l=0,u=0,c=0,h=[],p=0;p<t.length;p++){if((a=He.toArr(t[p],1,!0,!0,!1,!0)).isError)return a[0];for(h.push(a),r=0;r<a.length;r++)(i=a[r])!==He.CalcConvertedError&&(s+=i,l+=i*i,c++)}if(c<=2||(o=s/c,0===(n=Ae((c*l-s*s)/(c*(c-1))))))return Ne;for(p=0;p<h.length;p++)for(a=h[p],r=0;r<a.length;r++)(i=a[r])!==He.CalcConvertedError&&(u+=_e((i-o)/n,3));return He.toResult(c*u/((c-1)*(c-2)))},{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny}),o.def("STANDARDIZE",function(e){var t,o,n;return isNaN(t=He.D(e[0]))||isNaN(o=He.D(e[1]))||isNaN(n=He.D(e[2]))?Oe:n<=0?Le:(t-o)/n},{minArgs:3,maxArgs:3}),o.def("TDIST",re,{minArgs:3,maxArgs:3}),o.def("T.DIST",function(e){var t,o,n;return isNaN(t=He.D(e[0]))?Oe:isNaN(o=He.I(e[1]))?Oe:(n=He.B(e[2]),o<1||t<0?Le:ie(t,o,n?4:3))},{minArgs:3,maxArgs:3}),o.def("T.DIST.RT",function(e){return re([e[0],e[1],1])},{minArgs:2,maxArgs:2}),o.def("T.DIST.2T",function(e){return re([e[0],e[1],2])},{minArgs:2,maxArgs:2}),o.def("TINV",ae,{minArgs:2,maxArgs:2}),o.def("T.INV.2T",ae,{minArgs:2,maxArgs:2}),o.def("T.INV",function(e){var t,o;return isNaN(t=He.D(e[0]))?Oe:isNaN(o=He.I(e[1]))?Oe:t<=0||1<t||o<1||o>_e(10,10)?Le:t<.5?-se(1-t,o,4):se(t,o,4)},{minArgs:2,maxArgs:2}),o.def("TTEST",pe,{minArgs:4,maxArgs:4,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsFirstOrOne}),o.def("T.TEST",pe,{minArgs:4,maxArgs:4,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsFirstOrOne}),o.def("WEIBULL",fe,{minArgs:4,maxArgs:4}),o.def("WEIBULL.DIST",fe,{minArgs:4,maxArgs:4}),o.def("ZTEST",de,{minArgs:2,maxArgs:3,acceptsReference:o.acceptsFirst,acceptsArray:o.acceptsFirst,acceptsMissingArgument:o.acceptsThird}),o.def("Z.TEST",de,{minArgs:2,maxArgs:3,acceptsReference:o.acceptsFirst,acceptsArray:o.acceptsFirst,acceptsMissingArgument:o.acceptsThird}),o.def("PERMUT",function(e){var t,o=He.D(He.I(e[0])),n=He.D(He.I(e[1])),r=1;if(o<0||n<0||o<n)return Le;for(t=o-n+1;t<=o;t++)r*=t;return He.toResult(r)},{minArgs:2,maxArgs:2}),o.def("COVARIANCE.S",function(e){var o,n,r,i,a,s=0,l=0,u=0,c=0,h=(t.Convert,He.CalcConvertedError),p=He.toArr(e[0],1,!0,!0,!1),d=He.toArr(e[1],1,!0,!0,!1),f=p.length;if(f!==d.length)return Pe;for(a=0;a<f;a++)o=p[a],n=d[a],o!==h&&n!==h&&(s+=o,l+=n,c++);if(c<=1)return Ne;for(r=s/c,i=l/c,a=0;a<f;a++)o=p[a],n=d[a],o!==h&&n!==h&&(u+=(o-r)*(n-i));return He.toResult(u/(c-1))},{minArgs:2,maxArgs:2,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("MODE.MULT",function(e){for(var o,n,r,i=0,a=[],s=[],l=0;l<e.length;l++){if((n=He.toArr(e[l],1,!0,!0,!1)).isError)return n[0];for(o=0;o<n.length;o++)s.push(n[o])}for(l=0;l<s.length;l++){for(r=0,o=l+1;o<s.length;o++)s[l]==s[o]&&r++;r>i?(i=r,(a=[]).push([s[l]])):r==i&&a.push([s[l]])}return 0==i?Pe:new t._ConcreteArray(a)},{minArgs:1,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("PERCENTILE.EXC",ge,{minArgs:2,maxArgs:2,acceptsReference:o.acceptsFirst,acceptsArray:o.acceptsFirst}),o.def("QUARTILE.EXC",function(e){var t=e[0],o=0;switch(He.I(e[1])){case 1:o=.25;break;case 2:o=.5;break;case 3:o=.75;break;default:return Le}return ge([t,o])},{minArgs:2,maxArgs:2,acceptsReference:o.acceptsFirst,acceptsArray:o.acceptsFirst}),o.def("RANK.AVG",function(e){var o,n,r,i,a=He.toArr(e[1],1,!0,!1,!1),s=He.toArr(e[0],1,!0,!0,!0);if(s.isError)return s[0];if(s.isConvertError||s.rowCount>1||s.colCount>1)return Oe;if(o=s[0],n=0,t._Helper._argumentExists(e,2)&&isNaN(n=He.D(e[2])))return Oe;var l=0,u=0,c=0;for(r=0;r<a.length;r++)(i=a[r])!==He.CalcConvertedError&&(i<o?l++:o<i?c++:u++);return 0==u?Pe:1+(0===n?c:l)+(u-1)/2},{minArgs:2,maxArgs:3,acceptsReference:o.acceptsFirstOrOne,acceptsArray:o.acceptsSecond,acceptsMissingArgument:o.acceptsThird}),o.def("STDEV.P",h,{minArgs:1,acceptsReference:o.acceptsAny,acceptsArray:o.acceptsAny}),o.def("VAR.P",d,{minArgs:1,acceptsArray:o.acceptsAny,acceptsReference:o.acceptsAny})}(t.Functions||(t.Functions={}));t.Functions}(e.Calc||(e.Calc={}));e.Calc}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){var o,n,r,i;t.feature("formulatextbox",["core.common"]);var a,s=null,l=void 0,u=Math.max,c=Math.min,h=".gcFormulaTextBoxInternal",p=".gcFormulaTextBox",d="TextChanged",f="CaretChanged",g=37,m=39,_=38,y=40,C=9,w=13,v=33,S=34,x=35,R=36,b=27,T=function(){function o(e,o){var n=this;n._init(o&&o.getHost()||document.body),e&&n._attachHost(e),o&&(n._isInSpread=!0,n.setSpread(o),n._spread._unbind(t.Events.ActiveSheetChanging,i.handleFormulatextboxAcrossSheetBeforeTabChange),n._spread._bind(t.Events.ActiveSheetChanging,i.handleFormulatextboxAcrossSheetBeforeTabChange),n._spread._unbind(t.Events.ActiveSheetChanged,i.handleFormulatextboxAcrossSheetAfterTabChange),n._spread._bind(t.Events.ActiveSheetChanged,i.handleFormulatextboxAcrossSheetAfterTabChange)),n._tokens=n._parse(n.text()),n._isEditableElement(e)&&n._colorText(n._tokens)}return o.prototype.destroy=function(){this._isAppending=!1,this._appendingStart=-1,this._detachHost(),this._detachSpread(),t.GC$(this._funcsPopup).remove(),t.GC$(this._funcHelpPopup).remove(),t.GC$(this._helpDiv).remove()},o.prototype.bind=function(e,o,n){var r=this._host;r&&e&&(e=e.split(/\s+/).join(p+" "),t.GC$(r).bind(e+p,o,n))},o.prototype.unbind=function(e,o){var n=this._host;n&&e&&(e=e.split(/\s+/).join(p+" "),t.GC$(n).unbind(e+p,o))},o.prototype.unbindAll=function(){var e=this._host;e&&t.GC$(e).unbind(p)},o.prototype.caret=function(e){var o=this._host;if(o){document.activeElement;var n=document.activeElement===o,r=t.GC$(o);if(0===arguments.length)return n?this._getCaret(o).end:r.data("caret-before");e!==this.caret()&&(n?(this._setCaret(o,e),r.data("caret-before",this._getCaret(o).end)):r.data("caret-before",e),this._trigger(f,{}))}},o.prototype._getCaret=function(e){var t,o,n,r=-1,i=-1,a=this._isInputElement(e),s=this._isEditableElement(e);return a?(r=e.selectionStart,i=e.selectionEnd):s&&((t=window.getSelection()).rangeCount>0&&((n=(o=t.getRangeAt(0)).cloneRange()).selectNodeContents(e),n.setEnd(o.endContainer,o.endOffset),i=n.toString().length,(n=o.cloneRange()).selectNodeContents(e),n.setEnd(o.startContainer,o.startOffset),r=n.toString().length,n.detach())),{start:r,end:i}},o.prototype._setCaret=function(e,t){var o,n,r,i=this._isInputElement(e),a=this._isEditableElement(e);i?e.setSelectionRange(t,t):a&&((o=this._getColorNode(e,t))&&(n=window.getSelection(),(r=document.createRange()).setStart(o.node.firstChild,o.offset),r.collapse(!0),n.removeAllRanges(),n.addRange(r)))},o.prototype.text=function(e){var o,n,r,i,a,s=this,l=s._host;if(l&&(!s._activeSheet()||!s._activeSheet().disposed)){if(o=s._isInputElement(l),n=s._isEditableElement(l),0===arguments.length)return r="",o?r=l.value:n&&(r=l.textContent),r;null==e&&(e=""),e!==s.text()&&(s._tokens=s._parse(e),o?l.value=e:n&&s._colorText(s._tokens),i={},(a=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance)&&a.text&&(i={sheet:a.sheet,editor:a.dom,canvasOffset:a.canvasOffset}),s._trigger(d,i))}},o.prototype.autoComplete=function(e){if(0===arguments.length)return this._autoComplete;this._autoComplete=e},o.prototype.showHelp=function(e){if(0===arguments.length)return this._showHelp;this._showHelp=e},o.prototype.add=function(e){var o,n;if(e)if(t.GC$.isArray(e))for(o=e.length,n=0;n<o;n++)this._add(e[n]);else this._add(e)},o.prototype._add=function(e){var t,o,n,r,i=e&&e.name&&e.name.toUpperCase();if(i){for(o=(t=this._funcs).length,n=0;n<o;n++){if((r=t[n].name.toUpperCase())===i)return;if(r>i)break}t.splice(n,0,e)}},o.prototype.remove=function(e){var t,o,n;if(e)for(e=e.toUpperCase(),o=(t=this._funcs).length,n=0;n<o;n++)if(t[n].name.toUpperCase()===e){t.splice(n,1);break}},o.prototype.spread=function(e){if(0===arguments.length)return this._spread;this.setSpread(e),this._attachSpread()},o.prototype.setSpread=function(e){var t;e&&(this,this._spread&&this._detachSpread(),t=this._host,e&&t&&(this._spread=e),this._parse=this.parseByCalc)},o.prototype.getRanges=function(){var e,t,o,n=[],r=this._tokens,i=r&&r.length,a=0,s=0;if(i>0)for(o=0;o<i;o++)t=(e=r[o]).text,11===e.type&&n.push({textOffset:a,text:t,ranges:e.ranges,index:s++,allowDrag:e.allowDrag}),a+=t.length;return n},o.prototype.getActiveRange=function(){var e,t,o,n,r,i=this._host,a=this.getRanges();if(i&&a&&a.length>0)for(e=this.caret(),t=a.length,r=0;r<t;r++){if((n=(o=a[r]).textOffset)<e&&e<=n+o.text.length)return o;if(n>=e)break}return s},o.prototype.isActiveRange=function(e){if(!e)return!1;var t=this.caret(),o=e.text,n=e.textOffset;return n<t&&t<=n+o.length},o.prototype.getRangeColor=function(e){var t,n,r,i,a,s,l,u=this.getRanges(),c=u.length;if(e<0||c<=e)return"";for(t=[],r=0,i=0;i<c;i++){for(n=u[i],a=!1,s=0;s<t.length;s++)if(t[s].text.replace(/\s+/g,"").toUpperCase()===n.text.replace(/\s+/g,"").toUpperCase()){a=!0;break}if(a){if(e===i){r=s;break}}else if(t.push(n),e===i){r=t.length-1;break}}return(l=o.DEFAULT_RANGE_COLORS)[r%l.length]},o.prototype.canAppendRange=function(){var e,t,o;return!!this._isAppending||!!(e=this._getToken(this.caret()))&&(t=e.type,o=e.text,1===t||8===t||7===t&&"%"!==o||5===t||9===t||15===t)},o.prototype.isAppending=function(){return this._isAppending},o.prototype.isAppendingRange=function(e){if(!e||!this._isAppending)return!1;var t=this._appendingStart,o=this.caret(),n=e.textOffset;return t<=n&&n<o},o.prototype.getAppendingRanges=function(){var e,t,o=[],n=this.getRanges(),r=n.length;if(r>0)for(t=0;t<r;t++)e=n[t],this.isAppendingRange(e)&&o.push(e);return o},o.prototype.appendRange=function(e,o,n){var r,i,a,s,l,u,c=this,h=c._host;if(e&&h){if(!c._isAppending){if(!c.canAppendRange())return;o=!1,c._isAppending=!0,c._appendingStart=c.caret(),c._trigger("AppendStarted",{})}var p=c._appendingStart,f=c.text(),g=c.caret(),m=g;n&&(o=!1,f=f.substr(0,p)+f.substr(g),c._tokens=c._parse(f),m=g=p),r=c._getToken(g),o?(i=(i=f.substr(0,g)).substr(0,i.length-r.text.length)).length>=p&&(r.text=e,m=i.length+e.length):(a=c._tokens,s=t.ArrayHelper.indexOf(a,r),g>p?(a.splice(s+1,0,{text:this.listSeparator(),type:8}),a.splice(s+2,0,{text:e,type:11}),e=","+e):a.splice(s+1,0,{text:e,type:11}),m=g+e.length),c._updateHostValue(),l={},(u=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance)&&u.text&&(l={sheet:u.sheet,editor:u.dom,canvasOffset:u.canvasOffset}),c._trigger(d,l),c.caret(m)}},o.prototype.stopAppending=function(){this._isAppending&&(this._isAppending=!1,this._appendingStart=-1,this._trigger("AppendEnded",{}))},o.prototype.startAppending=function(){this._isAppending=!0,this._appendingStart=this.caret()},o.prototype.appendingStartIndex=function(e){return 0==arguments.length?this._appendingStart:this._appendingStart=e},o.prototype.repalceRange=function(e,t){var o;if(this._host&&!(e<0)&&t){var n,r=!1,i=this._tokens,a=i&&i.length,s=0;for(o=0;o<a;o++){if(11===(n=i[o]).type&&s++===e){i[o]={text:t,type:11},r=!0;break}n.text}r&&(this._updateHostValue(),this._trigger(d,{}),this.caret(this.text().length))}},o.prototype._attachSpread=function(){var t,o,n,r=this;r._spread&&(t=r._host,r._spread&&t&&(o=e.Sheets.Events,t.setAttribute("gcUIElement","gcAttachedFormulaTextBox"),r._spread._attachedFormulaTextBox=r,r._spread._bind(o.EditStarted,r,r._onSpreadEditStarted),r._spread._bind(o.EnterCell,r,r._onSpreadEnterCell),r._spread._bind(o.EditEnded,r,r._onSpreadEditEnded),r._spread._bind(o.ActiveSheetChanged,r,r._onSpreadActiveSheetChanged),r._spread._bind(o.RangeChanged,r,r._onSpreadRangeChanged),r._spread._bind("FormulaTextBoxTextChanged",r,r._onSpreadFormulaTextBoxTextChanged),r._spread._bind("FormulaTextBoxCaretChanged",r,r._onSpreadFormulaTextBoxCaretChanged),(n=r._spread.getActiveSheet())&&r.text(r._getEditText(n,n._activeRowIndex,n._activeColIndex)),r._bind(d,r,r._onFormulaTextBoxTextChanged),r._bind(f,r,r._onFormulaTextBoxCaretChanged)))},o.prototype._detachSpread=function(){var t,o=this,n=o._spread;!o._isInSpread&&n&&(t=e.Sheets.Events,n._attachedFormulaTextBox=null,n._unbind(t.EditStarted,o._onSpreadEditStarted),n._unbind(t.EnterCell,o._onSpreadEnterCell),n._unbind(t.EditEnded,o._onSpreadEditEnded),n._unbind(t.ActiveSheetChanged,o._onSpreadActiveSheetChanged),n._unbind(t.RangeChanged,o._onSpreadRangeChanged),n._unbind("FormulaTextBoxTextChanged",o._onSpreadFormulaTextBoxTextChanged),n._unbind("FormulaTextBoxCaretChanged",o._onSpreadFormulaTextBoxCaretChanged),o._unbind(d,o._onFormulaTextBoxTextChanged),o._unbind(f,o._onFormulaTextBoxCaretChanged),o.text("")),o._spread=null},o.prototype._startingSpreadEdit=function(){var e,t;this._isWorking||(this._isWorking=!0,(t=(e=this._spread)&&e.getActiveSheet())&&!t.isEditing()?(t._startEditImp(null,t._activeRowIndex,t._activeColIndex,null,null,!1,null),this._spreadEditStarting=!0):this._spreadEditStarting=!1,this._isWorking=!1,this._isFuncsShown||this._openFuncHelp())},o.prototype._startSpreadEdit=function(){var t,o,n,r=this._spread,i=r&&r.getActiveSheet();if(i){if(this._spreadEditStarting&&i._formulaTextBox){var a=i._formulaTextBox.text(),s=this.text();s!==a&&(t=this.caret(),o=i.getFormulaInformation(i.getActiveRowIndex(),i.getActiveColumnIndex()),this.text(a),o.isArrayFormula&&(t>=s.length&&(t-=1),t=u(0,t-1)),this.caret(t))}e.Sheets.EditorStatus,2!==(n=i._editorStatus)&&(i._editorStatus=2,i.triggerEditorStatusChanged({sheet:i,sheetName:i._name,oldStatus:n,newStatus:2}))}},o.prototype._getEditText=function(e,o,n){var r,i,a,s,l="";return e&&((r=e.getFormulaInformation(o,n))&&r.hasFormula?(l="="+r.formula,r.isArrayFormula&&(l="{"+l+"}")):(i=e.getActualStyle(o,n),a=e.getValue(o,n),l=t.util.formatValue2Text(i,a,e)||"",s=!e.parent||e.parent.canUserEditFormula(),"="===l[0]&&s&&(l="'"+l))),l},o.prototype._onSpreadActiveSheetChanged=function(e,t){var o,n=e.data;n._isWorking||(n._isWorking=!0,n.close(),t&&(o=t.newSheet,n.text(n._getEditText(o,o._activeRowIndex,o._activeColIndex))),n._isWorking=!1)},o.prototype._onSpreadEditStarted=function(e,t){var o=e.data;if(!o._isWorking){var n=o._spread,r=n&&n.getActiveSheet(),i=r&&r._formulaTextBox;i&&(o._isWorking=!0,o.text(i.text()),o._isWorking=!1)}},o.prototype._onSpreadEnterCell=function(e,t){var o=e.data;o._isWorking||(o._isWorking=!0,t&&o.text(o._getEditText(t.sheet,t.row,t.col)),o._isWorking=!1)},o.prototype._onSpreadRangeChanged=function(t,o){var n=t.data;if(!n._isWorking){if(n._isWorking=!0,o){var r=o.sheet,i=o.row,a=o.column,s=o.rowCount,l=o.columnCount;new e.Sheets.Range(i,a,s,l).contains(r._activeRowIndex,r._activeColIndex)&&n.text(n._getEditText(r,r._activeRowIndex,r._activeColIndex))}n._isWorking=!1}},o.prototype._onSpreadEditEnded=function(e,t){var o=e.data;o._isWorking||(o._isWorking=!0,o.close(),t&&o.text(o._getEditText(t.sheet,t.row,t.col)),o._isWorking=!1)},o.prototype._onSpreadFormulaTextBoxTextChanged=function(e,t){var o,n=e.data;n._isWorking||(n._isWorking=!0,t&&(o=n.caret(),n.text(t.text),n.caret(o)),n._isWorking=!1)},o.prototype._onSpreadFormulaTextBoxCaretChanged=function(e,t){var o=e.data;o._isWorking||(o._isWorking=!0,t&&o.caret(t.caret),o._isWorking=!1)},o.prototype._onFormulaTextBoxTextChanged=function(e){var t,o,n,r,i,a,s=e.data;s._isWorking||(o=(t=s._spread)&&t.getActiveSheet())&&(s._isWorking=!0,n=o._formulaTextBox,r=o.getCellType(s.rowIndex,s.columnIndex),n?(i=n.caret(),n.text(s.text()),n.caret(i)):(a={sheet:o,row:s.rowIndex,col:s.columnIndex,sheetArea:3},r.setEditorValue(o._editor,s.text(),a)),s._isWorking=!1)},o.prototype._onFormulaTextBoxCaretChanged=function(e){var t,o,n,r=e.data;r._isWorking||(o=(t=r._spread)&&t.getActiveSheet())&&o.isEditing()&&(r._isWorking=!0,(n=o._formulaTextBox)&&(n.caret(r.caret()),r._openFuncHelp()),r._isWorking=!1)},o.prototype._init=function(e){var o,n,r,i=this;i._isImeInputting=!1,i._isInputKey=!1,i._isAppending=!1,i._appendingStart=-1,i._funcs=[],i._autoComplete=!0,i._showHelp=!0,i._autoClose=!0,(o=document.createElement("div")).style.display="none",e.insertBefore(o,s),i._funcsPopup=o,i._isFuncsShown=!1,(n=document.createElement("div")).style.display="none",e.insertBefore(n,s),i._funcHelpPopup=n,i._isFuncHelpShown=!1,t.GC$(o).bind("mouseover",function(){i._autoClose=!1}).bind("mouseout",function(){i._autoClose=!0}),t.GC$(n).bind("mouseover",function(){i._autoClose=!1}).bind("mouseout",function(){i._autoClose=!0}),t.GC$(o).bind("scroll",function(){i._funcsScrollingTimer&&window.clearTimeout(i._funcsScrollingTimer),i._funcsScrollingTimer=window.setTimeout(function(){i._host&&i._host.focus()},100)}),(r=document.createElement("div")).style.display="none",e.insertBefore(r,s),i._helpDiv=r,i._spread=null,i._isWorking=!1,i._spreadEditStarting=!1,i._isInSpread=!1,i._parse=i.parseDefault},o.prototype._attachHost=function(e){var o,n,r;e&&((o=this)._isInputElement(e)||o._isEditableElement(e))&&(n=t.GC$(e),o._host&&o._detachHost(),o._host=e,t.util.browser&&t.util.browser.msie?(r=parseInt(t.util.browser.version,10)<10,o._isEditableElement(e)||r?(o._bind("focus",function(){n.data("text-before",o.text())}),o._bind("click",function(){n.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(e,t){o._bind(e,function(){o._checkInput()})})):o._bind("input",function(){o._onInput()})):o._bind("input",function(){o._onInput()}),o._bind("keydown",function(e){var t=e.ctrlKey,n=e.shiftKey,r=e.altKey,i=e.metaKey,a=t||n||r||i,s=e.keyCode;o._isInputKey=!1,!a&&o._isFuncsShown&&(s===y?(o._selectFunc(1),e.preventDefault(),e.stopPropagation()):s===_?(o._selectFunc(-1),e.preventDefault(),e.stopPropagation()):s===C&&(o._completeFunc(),e.preventDefault(),e.stopPropagation())),s===b&&o.close(),o._checkCaret(e)}),o._bind("keyup",function(e){if(o._isInputKey&&t.util.browser&&t.util.browser.qtMode){var r=o.caret();n.data("caret-before")!==r&&(n.data("caret-before",r),o._trigger(f,{}),o._openFuncs(),o._isFuncsShown||o._openFuncHelp())}o._checkCaret(e)}),o._bind("focus",function(e){o._checkCaret(e)}),o._bind("blur",function(e){o._autoClose&&o.close()}),o._bind("mousedown",function(e){o._startingSpreadEdit()}),o._bind("mouseup",function(e){o._startSpreadEdit()}),o._bind("click",function(e){o._isAppending&&o.stopAppending();var t=o._spread,n=t&&t.getActiveSheet(),r=n&&n._formulaTextBox;r&&r.isAppending()&&r.stopAppending(),o._checkCaret(e)}),o._bind("compositionstart",function(e){o._isImeInputting=!0}),o._bind("compositionend",function(e){o._isImeInputting=!1}))},o.prototype._detachHost=function(){var e,o=this._host;o&&((e=t.GC$(o)).removeData("text-before"),e.removeData("caret-before"),this._unbindAll(),this.unbindAll(),this._host=s)},o.prototype._checkInput=function(){var e=t.GC$(this._host),o=this.text();e.data("text-before")!==o&&(this._isImeInputting||e.data("text-before",o),this._onInput())},o.prototype._checkCaret=function(e){if(t.util.browser&&t.util.browser.msie){setTimeout((o=this,n=e,function(){o._checkCaretCore(o,n)}),10)}else this._checkCaretCore(this,e);var o,n},o.prototype._checkCaretCore=function(e,o){var n,r,i=o.keyCode,a=i===g||i===m||i===R||i===x||i===S||i===v||i===C||i===w;if(e._autoComplete||(a=a||i===_||i===y),n=void 0!==o.button,a||n){var s=e._host,l=t.GC$(s),u=e._getCaret(s);if(u.start!==u.end)return;r=u.end,l.data("caret-before")!==r&&(l.data("caret-before",r),e._trigger(f,{}),e._openFuncHelp())}},o.prototype._activeRow=function(){return this._spread?this._spread.getActiveSheet()._activeRowIndex:l},o.prototype._activeCol=function(){return this._spread?this._spread.getActiveSheet()._activeColIndex:l},o.prototype._activeSheet=function(){if(this._spread)return this._spread.getActiveSheet()},o.prototype.parseDefault=function(e){return n.parse(e)},o.prototype.parseByCalc=function(o){var n,r,i,a;return t.Calc?(this,n=[],o&&"="===o[0]?(r=e.Sheets.Calc.Parser.getParserOption(),i={numberDecimalSeparator:this.numberDecimalSeparator(),arrayGroupSeparator:this.arrayGroupSeperator(),listSeparator:this.listSeparator()},t.Calc.Parser.setParserOption(i),a=(new t.Calc.Parser).parseReferenceExpressionInfos(o,this._activeSheet(),this._activeRow(),this._activeCol()),e.Sheets.Calc.Parser.setParserOption(r),this._convertToTextboxToken(a)):(n.push({text:o,type:17}),n)):(this.parseDefault(o),l)},o.prototype._onInput=function(){var e,o=this,n=o._host,r=t.GC$(n);o._isInputKey=!0,o._tokens=o._parse(o.text()),o._isEditableElement(n)?o._isImeInputting||(e=o.caret(),o._colorText(o._tokens),o._trigger(d,{type:"input"}),o.caret(e)):o._trigger(d,{type:"input"}),e=o.caret(),r.data("caret-before")!==e&&(r.data("caret-before",e),o._trigger(f,{})),o._openFuncs(),o._isFuncsShown||o._openFuncHelp()},o.prototype.trigerTextChanged=function(){this._trigger(d,{type:"input"})},o.prototype.arrayGroupSeperator=function(){return t.CR&&t.CR.arrayGroupSeperator||";"},o.prototype.arrayListSeparator=function(){return t.CR&&t.CR.arrayListSeparator||","},o.prototype.listSeparator=function(){return t.CR&&t.CR.listSeparator||","},o.prototype.numberDecimalSeparator=function(){return t.CR&&t.CR.numberDecimalSeparator||"."},o.prototype._convertToTextboxToken=function(e){for(var o=[],n=[],r=this.arrayGroupSeperator(),i=this.listSeparator(),a=this.arrayListSeparator(),s=!1,l=!1,u=0;u<e.length;u++)if(!(u>0&&u<e.length-1&&";"===e[u-1].text&&","===e[u].text&&"ARRAYROW"===e[u+1].text)){var c=e[u],h=this._getCalcType(c,n),p=c.text;if(2===h)o.push({text:p,type:h});else if(8===h)o.push({text:i,type:h});else if(3===h){if("ARRAYROW"===p){0,l=!0;continue}"ARRAY"===p&&(s=!0),o.push({text:"{",type:3})}else if(4===h){if("ARRAYROW"===p){l=!1,o.push({text:"}",type:4});continue}"ARRAY"===p?(s=!1,0,o.push({text:"}",type:4})):o.push({text:p,type:4})}else 6===h?o.push({text:")",type:h}):s&&!l&&","==p?o.push({text:r,type:10}):s&&";"==p?o.push({text:a,type:9}):13===h?o.push({text:t._NumberHelper.replaceNormalToCultureSymble(p),type:h,ranges:c.ranges,allowDrag:c.canDrag}):null!==h&&o.push({text:p,type:h,ranges:c.ranges,allowDrag:c.canDrag})}return o},o.prototype._getCalcType=function(e,o){t.Calc.ExcelFormulaTokenType,t.Calc.ExcelFormulaTokenSubtype;var n,r=e.type,i=e.subType,a=e.text,s=e.value;if(1===r){if(1===i)return"ARRAY"===a||"ARRAYROW"===a?(o.push(3),3):(o.push(5),"("===s.trim()?5:2);if(2===i){if(")"===s.trim())return 6;if(o.length>0){if(3===(n=o[o.length-1]))return o.pop(),4;if(5===n)return o.pop(),6}}if("="===s.trim())return 1}else if(3===r){if(0===i)return 8}else{if(5===r||6===r||4===r)return 7;if(0===r)return 7===i?11:5===i?12:4===i?13:3===i?14:6===i?16:14;if(7===r)return 15;if(8===r)return 17}return 17},o.prototype._updateHostValue=function(){var e,t,o,n=this._host,r=this._tokens;if(this._isInputElement(n)){for(e="",t=r&&r.length,o=0;o<t;o++)e+=r[o].text;n.value=e}else this._isEditableElement(n)&&this._colorText(r)},o.prototype._isInputElement=function(e){var t=e&&e.tagName;return"TEXTAREA"===t||"INPUT"===t},o.prototype._isEditableElement=function(e){return e&&"DIV"===e.tagName&&"true"===e.contentEditable},o.prototype._isFormula=function(e){return!(!e||"="!==e[0])},o.prototype._bind=function(e,o,n){var r=this._host;r&&e&&(e=e.split(/\s+/).join(h+" "),t.GC$(r).bind(e+h,o,n))},o.prototype._unbind=function(e,o){var n=this._host;n&&e&&(e=e.split(/\s+/).join(h+" "),t.GC$(n).unbind(e+h,o))},o.prototype._unbindAll=function(){var e=this._host;e&&t.GC$(e).unbind(h)},o.prototype._trigger=function(e,o){var n=this._host;n&&t.GC$(n).trigger(e,o)},o.prototype._getToken=function(e){var t,o,n,r,i;if(e<=0)return s;if((o=(t=this._tokens)&&t.length)>0)for(n=0,i=0;i<o;i++)if((n+=(r=t[i]).text.length)>=e)return r;return s},o.prototype._getFuncs=function(){var e,t,o=this._spread,n=o&&o.getActiveSheet(),r=n&&n._formulaTextBox;if(r){for(e=r._funcs,t=0;t<e.length;t++)e[t].isFunc=!0;return e.concat(this._getCustomNames(o,n)).concat(this._getTableNames(n))}return this._funcs},o.prototype._getCustomNames=function(e,o){for(var n=[],r=o.getCustomNames().concat(e.getCustomNames()),i=0;i<r.length;i++)n.push({name:r[i].getName(),description:t.SR.Fbx_CustomName_Description+r[i].getName()});return n},o.prototype._getTableNames=function(e){var o,n=[],r=e.getTables();if(r)for(o=0;o<r.length;o++)n.push({name:r[o].name(),description:t.SR.Fbx_TableName_Description+r[o].name()});return n},o.prototype._getFuncsStartWith=function(e,o){var n;e=e.toUpperCase(),t.StringUtil.contains(e,"[")&&(e=e.substr(e.lastIndexOf("[")+1),e=t.StringUtil.replace(e,"@",""));var r,i=[],a=o&&o.length;for(n=0;n<a;n++)0===(r=o[n]).name.toUpperCase().indexOf(e)&&(i.push(r),!0);return i},o.prototype._getTextInTokenBeforeCaret=function(){var e,t,o,n,r,i=this.caret();if(i<=0)return"";if((t=(e=this._tokens)&&e.length)>0)for(o=0,r=0;r<t;r++){if(o+(n=e[r]).text.length>=i)return n.text.substring(0,i-o);o+=n.text.length}return""},o.prototype._getActiveFuncInfo=function(){for(var e,t,o,n,r=this.caret(),i=this._tokens,a=i&&i.length,l=[],u=0,c=0;c<a;c++){if(n=i[c],l.push(n),6===n.type)for(e=0;l.length>0;)if(6===(t=l.pop()).type&&e++,5===t.type&&e--,0===e){l.length>0&&(t=l[l.length-1])&&2===t.type&&l.pop();break}if((u+=n.text.length)>=r)break}if(l.length>0){for(o=0;l.length>0;)if(8===(n=l.pop()).type)o++;else if(2===n.type)break;if(2===n.type){var h,p=n.text.toUpperCase(),d=this._getFuncs(),f=d&&d.length;for(c=0;c<f;c++)if((h=d[c]).name.toUpperCase()===p)return{func:h,activeParamterIndex:o,isFunc:h.isFunc}}}return s},o.prototype._openFuncs=function(){var e,o,n,r,i,a,s,l,u=this,c=u._getFuncsForInput();if(u._autoComplete&&u._isFormula(u.text())&&c&&c.length>0&&!u._isAppending&&!u._isImeInputting){for(u._closeFuncHelp(),e=u._funcsPopup,c.length>8?(e.style.height="204px",e.style.overflowY="scroll"):(e.style.height="auto",e.style.overflowY=""),o="",n=c.length,i=0;i<n;i++)o+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(r=c[i]).isFunc+">"+r.name+"</div><div class='gcsj-func-ac-row-description'>"+(r.shortDescription||r.description)+"</div></div>";(a=t.GC$(u._funcsPopup)).html(o).show(),u._isFuncsShown=!0,(s=a.find(".gcsj-func-ac-row")).length()>0&&(l="gcsj-ac-row-active",t.GC$(s.getElement(0)).addClass(l),s.bind("mouseover",function(){s.removeClass(l),t.GC$(this).addClass(l)}),s.bind("click",function(){u._completeFunc()})),u.position()}else u._closeFuncs()},o.prototype._getFuncsForInput=function(){var e,o,n=this._getToken(this.caret()),r=n&&n.text,i=[],a=this._tokens.indexOf(n);if(n&&14===n.type)return i;if((e=this._getTableColumnNames(a)).length>0){if(i=i.concat(e).concat(t.SR.getHelpTableFuncs()),t.StringUtil.endsWith(r,"[")||t.StringUtil.endsWith(r,"[@"))return i}else i=this._getFuncs();return o=[],(r=this._getTextInTokenBeforeCaret())&&(o=this._getFuncsStartWith(r,i)),o},o.prototype._getTableColumnNames=function(e){var o,n,r,i,a=[],l=this._tokens,u=l&&l.length;if(e<0||e>=l.length)return a;var c=this._spread,h=c&&c.getActiveSheet(),p={};if((void 0===e||e===s)&&(e=u),h&&(o=l[e],(n=h.findTableByName(t.StringUtil.leftBefore(o.text,"[")))!==s&&!p[n])){for(p[n]=!0,r=0,i="";i!==s;)(i=n.getColumnName(r++))!==s&&a.push({name:i,description:""});if(a.length>0)return a}return a},o.prototype._closeFuncs=function(){t.GC$(this._funcsPopup).hide(),this._isFuncsShown=!1},o.prototype._selectFunc=function(e){var o,n,r,i,a,s,l=t.GC$(this._funcsPopup).find(".gcsj-func-ac-row"),h=l.length();if(0!==h){if(o="gcsj-ac-row-active",n=0,e)for(r=0;r<h;r++)if(t.GC$(l.getElement(r)).hasClass(o)){n=r+e;break}i=t.GC$(this._funcsPopup).scrollTop(),l.removeClass(o),a=0,h>0&&(a=l.getElement(0).offsetHeight),n=u(n,0),n=c(n,h-1),s=l.getElement(n),t.GC$(s).addClass(o),s.offsetTop+s.offsetHeight>t.GC$(this._funcsPopup).scrollTop()+t.GC$(this._funcsPopup).height()?t.GC$(this._funcsPopup).scrollTop(t.GC$(this._funcsPopup).scrollTop()+a):s.offsetTop<t.GC$(this._funcsPopup).scrollTop()?t.GC$(this._funcsPopup).scrollTop(s.offsetTop):t.GC$(this._funcsPopup).scrollTop(i)}},o.prototype._completeFunc=function(){var e=this,o=t.GC$(e._funcsPopup).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),n=o.text(),r="true"===o.attr("isFunc");if(n){for(var i=e.caret(),a=e._tokens,l=a&&a.length,u=0,c=0,h=0,p=s;h<l&&!(u+(c=(p=a[h]).text.length)>=i);)h++,u+=c;var f=i-u,g=p.text,m=0,_=0;t.StringUtil.contains(g,"[")?-1===(m=g.lastIndexOf("[",f-1))?(m=g.indexOf("["),p.text=-1===m?n:n+g.substr(m),m=0):(m++,"@"===g.charAt(m)&&(m+=1),-1===(_=g.indexOf("]",f))&&(_=g.length),p.text=g.substring(0,m)+n+g.substr(_)):p.text=n,p.type=r?2:11;var y=h+1,C=a[y];a[h];r&&(!C||5!==C.type)&&a.splice(y,0,{text:"(",type:5}),e._closeFuncs(),e._host.focus(),e._updateHostValue(),e.caret(u+n.length+m+(r?1:0)),e._openFuncHelp(),e._tokens=e._parse(e.text()),e._trigger(d,{})}},o.prototype._openFuncHelp=function(){var e,o,n,r,i,a=this;if(a._isFuncsShown&&a._closeFuncs(),(e=a._getActiveFuncInfo())!==s&&!0===e.isFunc)if(o=a.listSeparator(),a._showHelp&&a._isFormula(a.text())&&e&&!a._isAppending&&!a._isImeInputting){var l,u=e.func,h=u.parameters,p=h&&h.length,d=c(p-1,e.activeParamterIndex),f="";for(n=0;n<p;n++)r=(l=h[n]).name,l.repeatable&&(r+=o+"..."),l.optional&&(r="["+r+"]"),i=n===p-1?"":o+" ",f+=r=n===d?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+r+"</span>"+i:"<span class='gcsj-func-help-paramter'>"+r+"</span>"+i;var g="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+u.name+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+f+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>"+("<div class='gcsj-func-help-body'>"+("<div class='gcsj-func-help-section-content'>"+("<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+t.SR.Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+u.description+"</div></div>")+"</div>")+"</div>");t.GC$(a._funcHelpPopup).html(g).show(),a._isFuncHelpShown=!0,a.position()}else a._closeFuncHelp();else a._closeFuncHelp()},o.prototype._closeFuncHelp=function(){t.GC$(this._funcHelpPopup).hide(),this._isFuncHelpShown=!1},o.prototype.close=function(){this._closeFuncs(),this._closeFuncHelp()},o.prototype.isReservedKey=function(e){if(this._isAppending)return!1;var t=e.ctrlKey||e.shiftKey||e.altKey||e.metaKey,o=e.keyCode;return!(!this._isFuncsShown||t||o!==y&&o!==_&&o!==C)},o.prototype.position=function(){var e,o,n,r,i=s;if(this._isFuncsShown?i=this._funcsPopup:this._isFuncHelpShown&&(i=this._funcHelpPopup),i){var a=t.GC$(this._host),l=t.GC$(i),u=t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance;if(u&&u.sheet){var c=u.sheet.getCellRect(u.rowIndex,u.columnIndex),h=(u.sheet._eventHandler,u.canvasOffset);return void l.css("top",c.y+c.height+h.top).css("left",c.x+h.left)}e=a.parent().css("top"),o=parseFloat(e),isNaN(o)||(e=o),n=a.parent().css("left"),"auto"===e&&(e=a.offset().top,n=a.offset().left);var p=e+a.outerHeight(),d=t.GC$(document.body).outerHeight(),f=l.outerHeight();p+f>d&&((r=e-f)>=0&&(p=r)),l.css("top",p).css("left",n)}},o.prototype.focus=function(){t.GC$(this._host).focus()},o.prototype._colorText=function(e){for(var o,n,r,i="",a="",s=e&&e.length,l=0,u=0;u<s;u++)o="",11===(r=e[u]).type&&(o=" style='color: "+this.getRangeColor(l++)+"'"),i+="<span"+o+" class='gcsj-func-color-text'>"+t.GC$(this._helpDiv).text(r.text).html()+"</span>",a+=r.text;if(a||this.text())if(n=this._host,i)n.innerHTML="<span class='gcsj-func-color-content'>"+i+"</span>";else for(;n.firstChild;)n.removeChild(n.firstChild)},o.prototype._getColorNode=function(e,o){var n,r,i,a=t.GC$(e).find(".gcsj-func-color-content .gcsj-func-color-text"),l=a.length();if(l>0){for(o=u(0,o),i=0;i<l;i++)if((o-=(r=(n=a.getElement(i)).textContent).length)<=0)return{node:n,offset:r.length+o};return{node:n,offset:r.length}}return s},o.DEFAULT_RANGE_COLORS=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],o}();t.FormulaTextBox=T,(a=o||(o={}))[a.FormulaStart=1]="FormulaStart",a[a.FunctionName=2]="FunctionName",a[a.BraceOpen=3]="BraceOpen",a[a.BraceClose=4]="BraceClose",a[a.ParenOpen=5]="ParenOpen",a[a.ParenClose=6]="ParenClose",a[a.Operator=7]="Operator",a[a.ArgumentSeparator=8]="ArgumentSeparator",a[a.ArrayListSeparator=9]="ArrayListSeparator",a[a.ArrayGroupSeparator=10]="ArrayGroupSeparator",a[a.Range=11]="Range",a[a.Boolean=12]="Boolean",a[a.Number=13]="Number",a[a.String=14]="String",a[a.Whitespace=15]="Whitespace",a[a.Error=16]="Error",a[a.Literal=17]="Literal",n=function(){function t(){}return t.parse=function(t){var o,n,r,i,a=[],s=this;if(t&&"="!==t[0])return s.addToken(a,t,17),a;var c,h=t&&t.length,p=0,d="",f=e.Sheets.CR.listSeparator===e.Sheets.CR.arrayGroupSeparator?"\\":e.Sheets.CR.listSeparator,g=e.Sheets.CR.listSeparator,m=e.Sheets.CR.arrayGroupSeparator,_=e.Sheets.CR.arrayListSeparator;for(o=0;o<h;o++)switch(c=t[o]){case"'":d=s.addToken(a,d),n=!0;do{d+=c,"'"===(c=t[++o])&&"'"===t[o+1]?(d+=c,c=t[++o]):n="'"!==c}while(n&&o<h-1);c!==l&&(d+=c);break;case'"':d=s.addToken(a,d),n=!0;do{d+=c,'"'===(c=t[++o])&&'"'===t[o+1]?(d+=c,c=t[++o]):n='"'!==c}while(n&&o<h-1);c!==l&&(d+=c),d=s.addToken(a,d,14);break;case"\\":s.addToken(a,d),d=s.addToken(a,c,9);break;case f:s.addToken(a,d),d=s.addToken(a,c,p>0?9:8);break;case g:case _:s.addToken(a,d),d=s.addToken(a,c,p>0?9:8);break;case m:s.addToken(a,d),d=s.addToken(a,c,10);break;case"{":s.addToken(a,d),d=s.addToken(a,c,3),p++;break;case"}":s.addToken(a,d),d=s.addToken(a,c,4),p--;break;case"(":s.addToken(a,d,2),d=s.addToken(a,c,5);break;case")":s.addToken(a,d),d=s.addToken(a,c,6);break;case"=":s.addToken(a,d),d=0===o?s.addToken(a,c,1):s.addToken(a,c,7);break;case"/":var y=d.toUpperCase(),C=o+1<h?t[o+1]:"",w=o+2<h?t[o+2]:"";"#DIV"===y&&"0"===C&&"!"===w||"#N"===y&&"A"===C.toUpperCase()?(o++,"#DIV"===(d+=c+C)&&(d+=w,o++),d=s.addToken(a,d)):(s.addToken(a,d),d=s.addToken(a,c,7));break;case"+":case"-":r=d.replace(/\s/g,"").toUpperCase(),i=u(0,r.length-2),r.lastIndexOf("R[")>=i||r.lastIndexOf("C[")>=i?d+=c:(s.addToken(a,d),d=s.addToken(a,c,7));break;case"&":case"^":case"*":case"%":s.addToken(a,d),d=s.addToken(a,c,7);break;case"<":case">":d=s.addToken(a,d),d+=c,("="===(C=o+1<h?t[o+1]:"")||"<"===c&&">"===C)&&(d+=C,o++),d=s.addToken(a,d,7);break;case" ":case" ":case"\r":case"\n":case"\t":for(d=s.addToken(a,d),d+=c;o<h-1&&/^[\s]*$/.test(t[o+1]);)d+=t[++o];d=s.addToken(a,d,15);break;default:d+=c}return s.addToken(a,d),a},t.addToken=function(e,t,o){var n,r,i,a,s,l,u;if(t){if(void 0===o&&(o=this.calcErrors.indexOf(t.toUpperCase())>-1?16:this.rNumber.test(t)?13:this.rBoolean.test(t)?12:this.rRangeA1.test(t)||this.rRangeR1C1.test(t)?11:17),(n=function(e){return 11===e||17===e||13===e})(o)){for(l="",s=e.length-1;s>=0&&(i=(r=e[s]).type,l=(a=r.text)+l,15===i||":"===a);s--);n(i)?(u=(u=":"===(l+=t)[l.length-1]?l.substr(0,l.length-1):l).trim(),(this.rRangeA1.test(u)||this.rRangeR1C1.test(u))&&(e.splice(s),t=l,o=11)):":"===t[t.length-1]&&(u=t.substr(0,t.length-1),(this.rRangeA1.test(u)||this.rRangeR1C1.test(u))&&(o=11))}e.push({text:t,type:o})}return""},t.rNumber=/^(\+|-)?((\d\d*\,?\d*)|(\d*\,?\d\d*))$/,t.rBoolean=/^(TRUE|FALSE)$/i,t.rRangeA1=/^(.*!)?((\$?[a-z]+\$?\d+(\s*:\s*\$?[a-z]+\$?\d+)?)|(\$?[a-z]+\s*:\s*\$?[a-z]+)|(\$?\d+\s*:\s*\$?\d+)|(\$?[a-z]+\$?\d+\s*:\s*\$?\d+)|(\$?\d+\s*:\s*\$?[a-z]+\$?\d+)|(\$?[a-z]+\$?\d+\s*:\s*\$?[a-z]+)|(\$?[a-z]+\s*:\s*\$?[a-z]+\$?\d+))$/i,t.rRangeR1C1=/^(.*!)?((R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?)?)|(R\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?)?)|(C\[?[-+]?\d*\]?\s*(:\s*C\[?[-+]?\d*\]?)?)|(R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?\s*(:\s*C\[?[-+]?\d*\]?)?)|(C\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?))?|(R\[?[-+]?\d*\]?C\[?\[-+]?d*\]?\s*(:\s*R\[?[-+]?\d*\]?))?|(R\[?[-+]?\d*\]?\s*(:\s*R\[?[-+]?\d*\]?C\[?[-+]?\d*\]?))?)$/i,t.calcErrors="#DIV/0! #N/A #NAME? #NULL! #NUM! #REF! #VALUE!".split(" "),t}(),r=function(){function e(){var e=this;e.rowIndex=-1,e.columnIndex=-1,e.text="",e.caret=-1,e.sheet=null,e.isAppending=!1,e.appendingIndex=-1,e.dom=null,e.spread=null,e.canvasOffset=null}return e.prototype.clear=function(){var e=this;e.removeDom(),e.rowIndex=-1,e.columnIndex=-1,e.text="",e.caret=-1,e.isAppending=!1,e.appendingIndex=-1,e.sheet=null,e.spread=null,e.canvasOffset=null},e.prototype.removeDom=function(){var e,o,n=this;n.sheet.disposed||(e=n.sheet.getCellType(n.rowIndex,n.columnIndex),o={sheet:n.sheet,row:n.rowIndex,col:n.columnIndex,sheetArea:3},e.deactivateEditor(n.dom,o)),t.GC$(n.dom).remove(),n.dom=null},e.prototype.save=function(e){e._formulaTextBox&&(this.text=e._formulaTextBox.text(),this.rowIndex=e.getActiveRowIndex(),this.columnIndex=e.getActiveColumnIndex(),this.caret=e._formulaTextBox.caret(),this.isAppending=e._formulaTextBox.isAppending(),this.appendingIndex=e._formulaTextBox.appendingStartIndex(),this.sheet=e,this.spread=e.parent,this.canvasOffset=e._eventHandler._getCanvasPosition())},e.prototype.update=function(e){e._formulaTextBox&&(this.text=e._formulaTextBox.text(),this.caret=e._formulaTextBox.caret(),this.isAppending=e._formulaTextBox.isAppending(),this.appendingIndex=e._formulaTextBox.appendingStartIndex())},e.prototype.exportInfo=function(e){e._formulaTextBox&&(e._formulaTextBox.text(this.text),e._formulaTextBox.caret(this.caret),this.isAppending&&(e._formulaTextBox.startAppending(),e._formulaTextBox.appendingStartIndex(this.appendingIndex)))},e.prototype.handleFormulatextboxBeforeChange=function(e,t){var o;if(e._formulaTextBox&&e._formulaTextBox.close(),(!this.sheet||this.sheet.disposed)&&e._formulaTextBox&&e._formulaTextBox.canAppendRange()){this.save(e),o=e.getValue(e._activeRowIndex,e._activeColIndex,3),e.suspendEvent();try{if(!e.endEdit(!0))return}finally{e.resumeEvent()}return e.setValue(e._activeRowIndex,e._activeColIndex,o,3,!0),void(e._editorStatus=1)}if(this.text&&this.sheet===t&&e._formulaTextBox)return this.update(e),e._formulaTextBox.destroy(),void(e._formulaTextBox=s);this.text&&this.sheet!==t&&e._formulaTextBox&&(this.update(e),e._formulaTextBox.destroy(),e._formulaTextBox=s)},e.prototype.handleFormulatextboxAfterChange=function(e,t,o){void 0===o&&(o=!0);var n=this;if(!t.disposed){if(n.dom&&""===n.text&&(e._loadAndSetSheetSelections(),n.clear()),n.text&&n.sheet===t)return t._editorStatus=0,t._setActiveCellAndSelection(n.rowIndex,n.columnIndex,l,l,1),o&&(t.suspendEvent(),t.startEdit(!1),n.exportInfo(t),n.updateEditor(t,n.rowIndex,n.columnIndex),t.resumeEvent(),e._loadAndSetSheetSelections()),void n.clear();if(n.text&&!n.dom)return t._editorStatus=1,e._editorStatus=1,n.createHiddenDomForFormulaAcrossSheet(t),void t._saveAndClearSheetSelections();if(n.text&&n.sheet!==t)return t._editorStatus=1,e._editorStatus=1,n.createHiddenDomForFormulaAcrossSheet(t),e._loadAndSetSheetSelections(),void t._saveAndClearSheetSelections()}},e.prototype.createHiddenDomForFormulaAcrossSheet=function(e){var o,n,r,i=this.sheet;if(!i.disposed){var a,l=this.rowIndex,u=this.columnIndex,c=i.getCellType(l,u),h={sheet:i,row:l,col:u,sheetArea:3,canvasOffset:this.canvasOffset};c.isImeAware(h)&&(e._editorStatus=1,a=c.createEditorElement(h),this.dom&&this.removeDom(),this.dom=a,t.GC$(a).css("position","absolute"),o=i.getCellRect(l,u),t.GC$(a).attr("id","across"),n=i.getActualStyle(l,u),c.activateEditor(a,n,o,h),(this.spread&&this.spread.getHost()||document.body).insertBefore(a,s),r=c.getEditingElement(),e._attachFormulaTextBox(r),c.focus(a),this.exportInfo(e),c.updateEditor(a,n,o,h))}},e.prototype.updateEditor=function(e,t,o){var n,r=e.getCellType(t,o),i=e._editor,a=e._getSheetLayout(),s=e.getActualStyle(t,o),l=e.getCellRect(t,o);l&&l.width>0&&l.height>0&&l.x>=a.frozenX&&l.y>=a.frozenY&&l.x+l.width<=a.frozenTrailingX+a.frozenTrailingWidth&&l.y+l.height<=a.frozenTrailingY+a.frozenTrailingHeight&&(n={sheet:e,row:t,col:o,sheetArea:3},r.updateEditor(i,s,l,n))},e}(),t.FormulatextboxAcrossSheet=r,i=function(e){function o(){e.apply(this,arguments)}return __extends(o,e),o.handleFormulatextboxAcrossSheetBeforeTabChange=function(e,o){var n=o.oldSheet,i=o.newSheet;n!==i&&(t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance||(t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance=new r),t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance.handleFormulatextboxBeforeChange(n,i))},o.handleFormulatextboxAcrossSheetAfterTabChange=function(e,o){var n=o.oldSheet,r=o.newSheet;n!==r&&t.IFormulatextboxAcrossSheetSingleton.formulatextboxAcrossSheetInstance.handleFormulatextboxAfterChange(n,r)},o}(t.IFormulatextboxAcrossSheetSingleton),t.FormulatextboxAcrossSheetSingleton=i}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){!function(e){e.feature("formulatextbox_resource");var t=function(){return function(e,t){this.name=e,this.description=t}}(),o=function(){return function(e,t){this.name=e,this.repeatable=t}}(),n=function(){return function(e,t,o){this.name=e,this.description=t,this.parameters=o}}(),r=function(){function e(){}return e.Table_Functions=[new t("#All","Returns the entire contents of the table, or specified table columns including column headers, data and total rows."),new t("#Data","Returns the data cells of the table or specified table columns."),new t("#Headers","Returns the columns headers for the table, or specified table columns."),new t("#Totals","Returns the total rows for the table or specified table columns."),new t("@","This row.")],e.Functions=[new n("ABS","This function calculates the absolute value of the specified value.",[new o("value")]),new n("ACCRINT","This function calculates the accrued interest for a security that pays periodic interest.",[new o("issue"),new o("first"),new o("settle"),new o("rate"),new o("par"),new o("frequency"),new o("basis")]),new n("ACCRINTM","This function calculates the accrued interest at maturity for a security that pays periodic interest.",[new o("issue"),new o("maturity"),new o("rate"),new o("par"),new o("basis")]),new n("ACOS","This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[new o("value")]),new n("ACOSH","This function calculates the inverse hyperbolic cosine of the specified value.",[new o("value")]),new n("ADDRESS","This function uses the row and column numbers to create a cell address in text.",[new o("row"),new o("column"),new o("absnum"),new o("a1style"),new o("sheettext")]),new n("AMORDEGRC","This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[new o("cost"),new o("datepurchased"),new o("firstperiod"),new o("salvage"),new o("period"),new o("drate"),new o("basis")]),new n("AMORLINC","This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[new o("cost"),new o("datepurchased"),new o("firstperiod"),new o("salvage"),new o("period"),new o("drate"),new o("basis")]),new n("AND","Check whether all arguments are True, and returns True if all arguments are True.",[new o("logical1"),new o("logical2")]),new n("ASIN","This function calculates the arcsine, that is, the angle whose sine is the specified value.",[new o("value")]),new n("ASINH","This function calculates the inverse hyperbolic sine of a number.",[new o("value")]),new n("ATAN","This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[new o("value")]),new n("ATAN2","This function calculates the arctangent of the specified x- and y-coordinates.",[new o("x"),new o("y")]),new n("ATANH","This function calculates the inverse hyperbolic tangent of a number.",[new o("value")]),new n("AVEDEV","This function calculates the average of the absolute deviations of the specified values from their mean.",[new o("value1"),new o("value2",!0)]),new n("AVERAGE","This function calculates the average of the specified numeric values.",[new o("value1"),new o("value2",!0)]),new n("AVERAGEA","This function calculates the average of the specified values, including text or logical values as well as numeric values.",[new o("value1"),new o("value2",!0)]),new n("AVERAGEIF","This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[new o("value1"),new o("value2",!0),new o("condition")]),new n("AVERAGEIFS","This function calculates the average of all cells that meet multiple specified criteria.",[new o("value1"),new o("condition1"),new o("value2",!0),new o("condition2...")]),new n("BESSELI","This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[new o("value"),new o("order")]),new n("BESSELJ","This function calculates the Bessel function of the first kind.",[new o("value"),new o("order")]),new n("BESSELK","This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[new o("value"),new o("order")]),new n("BESSELY","This function calculates the Bessel function of the second kind.",[new o("value"),new o("order")]),new n("BETADIST","This function calculates the cumulative beta distribution function.",[new o("x"),new o("alpha"),new o("beta"),new o("lower"),new o("upper")]),new n("BETAINV","This function calculates the inverse of the cumulative beta distribution function.",[new o("prob"),new o("alpha"),new o("beta"),new o("lower"),new o("upper")]),new n("BIN2DEC","This function converts a binary number to a decimal number",[new o("number")]),new n("BIN2HEX","This function converts a binary number to a hexadecimal number.",[new o("number"),new o("places")]),new n("BIN2OCT","This function converts a binary number to an octal number.",[new o("number"),new o("places")]),new n("BINOMDIST","This function calculates the individual term binomial distribution probability.",[new o("x"),new o("n"),new o("p"),new o("cumulative")]),new n("CEILING","This function rounds a number up to the nearest multiple of a specified value.",[new o("value"),new o("signif")]),new n("CHAR","This function returns the character specified by a number.",[new o("value")]),new n("CHIDIST","This function calculates the one-tailed probability of the chi-squared distribution.",[new o("value"),new o("deg")]),new n("CHIINV","This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[new o("prob"),new o("deg")]),new n("CHITEST","This function calculates the test for independence from the chi-squared distribution.",[new o("obs_array"),new o("exp_array")]),new n("CHOOSE","This function returns a value from a list of values.",[new o("index"),new o("value1"),new o("value2",!0)]),new n("CLEAN","This function removes all non-printable characters from text.",[new o("text")]),new n("CODE","This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[new o("text")]),new n("COLUMN","This function returns the column number of a reference.",[new o("reference")]),new n("COLUMNS","This function returns the number of columns in an array.",[new o("array")]),new n("COMBIN","This function calculates the number of possible combinations for a specified number of items.",[new o("k"),new o("n")]),new n("COMPLEX","This function converts real and imaginary coefficients into a complex number.",[new o("realcoeff"),new o("imagcoeff"),new o("suffix")]),new n("CONCATENATE","This function combines multiple text strings or numbers into one text string.",[new o("text1"),new o("text2"),new o("....")]),new n("CONFIDENCE","This function returns confidence interval for a population mean.",[new o("alpha"),new o("stdev"),new o("size")]),new n("CONVERT","This function converts a number from one measurement system to its equivalent in another measurement system.",[new o("number"),new o("from-unit"),new o("to-unit")]),new n("CORREL","This function returns the correlation coefficient of the two sets of data.",[new o("array1"),new o("array2")]),new n("COS","This function returns the cosine of the specified angle.",[new o("angle")]),new n("COSH","This function returns the hyperbolic cosine of the specified value.",[new o("value")]),new n("COUNT","This function returns the number of cells that contain numbers.",[new o("value1"),new o("value2",!0)]),new n("COUNTA","This function returns the number of number of cells that contain numbers, text, or logical values.",[new o("value1"),new o("value2",!0)]),new n("COUNTBLANK","This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[new o("cellrange")]),new n("COUNTIF","This function returns the number of cells that meet a certain condition",[new o("cellrange"),new o("condition")]),new n("COUNTIFS","This function returns the number of cells that meet multiple conditions.",[new o("cellrange"),new o("condition")]),new n("COUPDAYBS","This function calculates the number of days from the beginning of the coupon period to the settlement date.",[new o("settlement"),new o("maturity"),new o("frequency"),new o("basis")]),new n("COUPDAYS","This function returns the number of days in the coupon period that contains the settlement date.",[new o("settlement"),new o("maturity"),new o("frequency"),new o("basis")]),new n("COUPDAYSNC","This function calculates the number of days from the settlement date to the next coupon date.",[new o("settlement"),new o("maturity"),new o("frequency"),new o("basis")]),new n("COUPNCD","This function returns a date number of the next coupon date after the settlement date.",[new o("settlement"),new o("maturity"),new o("frequency"),new o("basi")]),new n("COUPNUM","This function returns the number of coupons due between the settlement date and maturity date.",[new o("settlement"),new o("maturity"),new o("frequency"),new o("basis")]),new n("COUPPCD","This function returns a date number of the previous coupon date before the settlement date.",[new o("settlement"),new o("maturity"),new o("frequency"),new o("basis")]),new n("COVAR","This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[new o("array1"),new o("array2")]),new n("CRITBINOM","This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[new o("n"),new o("p"),new o("alpha")]),new n("CUMIPMT","This function returns the cumulative interest paid on a loan between the starting and ending periods.",[new o("rate"),new o("nper"),new o("pval"),new o("startperiod"),new o("endperiod"),new o("paytype")]),new n("CUMPRINC","This function returns the cumulative principal paid on a loan between the start and end periods.",[new o("rate"),new o("nper"),new o("pval"),new o("startperiod"),new o("endperiod"),new o("paytype")]),new n("DATE","This function returns the DateTime object for a particular date, specified by the year, month, and day.",[new o("year"),new o("month"),new o("day")]),new n("DATEDIF","This function returns the number of days, months, or years between two dates.",[new o("date1"),new o("date2"),new o("outputcode")]),new n("DATEVALUE","This function returns a DateTime object of the specified date.",[new o("date_string")]),new n("DAVERAGE","This function calculates the average of values in a column of a list or database that match the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DAY","This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[new o("date")]),new n("DAYS360","This function returns the number of days between two dates based on a 360-day year.",[new o("startdate"),new o("enddate"),new o("method")]),new n("DB","This function calculates the depreciation of an asset for a specified period using the fixed‑declining balance method",[new o("cost"),new o("salvage"),new o("life"),new o("period"),new o("month")]),new n("DCOUNT","This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[new o("database"),new o(" field"),new o(" criteria")]),new n("DCOUNTA","This function counts the non-blank cells in a column of a list or database that match the specified conditions",[new o("database"),new o(" field"),new o(" criteria")]),new n("DDB","This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[new o("cost"),new o("salvage"),new o("life"),new o("period"),new o("factor")]),new n("DEC2BIN","This function converts a decimal number to a binary number.",[new o("number"),new o("places")]),new n("DEC2HEX","This function converts a decimal number to a hexadecimal number",[new o("number"),new o("places")]),new n("DEC2OCT","This function converts a decimal number to an octal number",[new o("number"),new o("places")]),new n("DEGREES","This function converts the specified value from radians to degrees",[new o("angle")]),new n("DELTA","This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[new o("value1"),new o("value2")]),new n("DEVSQ","This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[new o("value1"),new o("value2",!0)]),new n("DGET","This function extracts a single value from a column of a list or database that matches the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DISC","This function calculates the discount rate for a security.",[new o("settle"),new o("mature"),new o("pricep"),new o("redeem"),new o("basis")]),new n("DMAX","This function returns the largest number in a column of a list or database that matches the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DMIN","This function returns the smallest number in a column of a list or database that matches the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DOLLAR","This function converts a number to text using currency format, with the decimals rounded to the specified place.",[new o("value"),new o("digits")]),new n("DOLLARDE","This function converts a fraction dollar price to a decimal dollar price.",[new o("fractionaldollar"),new o("fraction")]),new n("DOLLARFR","This function converts a decimal number dollar price to a fraction dollar price.",[new o("decimaldollar"),new o("fraction")]),new n("DPRODUCT","This function multiplies the values in a column of a list or database that match the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DSTDEV","This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DSTDEVP","This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DSUM","This function adds the numbers in a column of a list or database that match the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DURATION","This function returns the Macaulay duration for an assumed par value of $100.",[new o("settlement"),new o("maturity"),new o("coupon"),new o("yield"),new o("frequency"),new o("basis")]),new n("DVAR","This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("DVARP","This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[new o("database"),new o(" field"),new o(" criteria")]),new n("EDATE","This function calculates the date that is the indicated number of months before or after a specified date.",[new o("startdate"),new o("months")]),new n("EFFECT","This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[new o("nomrate"),new o("comper")]),new n("EOMONTH","This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[new o("startdate"),new o("months")]),new n("ERF","This function calculates the error function integrated between a lower and an upper limit.",[new o("limit"),new o("upperlimit")]),new n("ERFC","This function calculates the complementary error function integrated between a lower limit and infinity.",[new o("lowerlimit")]),new n("ERROR.TYPE","This function returns a number corresponding to one of the error values.",[new o("errorvalue")]),new n("EURO","This function returns the equivalent of one Euro based on the ISO currency code.",[new o("code")]),new n("EUROCONVERT","This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[new o("currency"),new o("source"),new o("target"),new o("fullprecision"),new o("triangulation")]),new n("EVEN","This function rounds the specified value up to the nearest even integer.",[new o("value")]),new n("EXACT","This function returns true if two strings are the same; otherwise, false.",[new o("text1"),new o("text2")]),new n("EXP","This function returns e raised to the power of the specified value.",[new o("value")]),new n("EXPONDIST","This function returns the exponential distribution or the probability density.",[new o("value"),new o("lambda"),new o("cumulative")]),new n("FACT","This function calculates the factorial of the specified number.",[new o("number")]),new n("FACTDOUBLE","This function calculates the double factorial of the specified number.",[new o("number")]),new n("FALSE","This function returns the value for logical FALSE.",[]),new n("FDIST","This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[new o("value"),new o("degnum"),new o("degden")]),new n("FIND","This function finds one text value within another and returns the text value’s position in the text you searched.",[new o("findtext"),new o("intext"),new o("start")]),new n("FINV","This function returns the inverse of the F probability distribution.",[new o("p"),new o("degnum"),new o("degden")]),new n("FISHER","This function returns the Fisher transformation for a specified value.",[new o("value")]),new n("FISHERINV","This function returns the inverse of the Fisher transformation for a specified value.",[new o("value")]),new n("FIXED","This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[new o("num"),new o("digits"),new o("notcomma")]),new n("FLOOR","This function rounds a number down to the nearest multiple of a specified value.",[new o("value"),new o("signif")]),new n("FORECAST","This function calculates a future value using existing values.",[new o("value"),new o("Yarray"),new o("Xarray")]),new n("FREQUENCY","This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[new o("dataarray"),new o("binarray")]),new n("FTEST","This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[new o("array1"),new o("array2")]),new n("FV","This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[new o("rate"),new o("numper"),new o("paymt"),new o("pval"),new o("type")]),new n("FVSCHEDULE","This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[new o("principal"),new o("schedule")]),new n("GAMMADIST","This function returns the gamma distribution.",[new o("x"),new o("alpha"),new o("beta"),new o("cumulative")]),new n("GAMMAINV","This function returns the inverse of the gamma cumulative distribution.",[new o("p"),new o("alpha"),new o("beta")]),new n("GAMMALN","This function returns the natural logarithm of the Gamma function, G(x).",[new o("value")]),new n("GCD","This function returns the greatest common divisor of two numbers.",[new o("number1"),new o("number2")]),new n("GEOMEAN","This function returns the geometric mean of a set of positive data.",[new o("value1"),new o("value2",!0)]),new n("GESTEP","This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[new o("number"),new o("step")]),new n("GROWTH","This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[new o("y"),new o("x"),new o("newx"),new o("constant")]),new n("HARMEAN","This function returns the harmonic mean of a data set.",[new o("value1"),new o("value2",!0)]),new n("HEX2BIN","This function converts a hexadecimal number to a binary number.",[new o("number"),new o(" places")]),new n("HEX2DEC","This function converts a hexadecimal number to a decimal number.",[new o("number")]),new n("HEX2OCT","This function converts a hexadecimal number to an octal number.",[new o("number"),new o(" places")]),new n("HLOOKUP","This function searches for a value in the top row and then returns a value in the same column from a specified row.",[new o("value"),new o("array"),new o("row"),new o("approx")]),new n("HOUR","This function returns the hour that corresponds to a specified time.",[new o("time")]),new n("HYPGEOMDIST","This function returns the hypergeometric distribution.",[new o("x"),new o("n"),new o("M"),new o("N")]),new n("IF","This function performs a comparison and returns one of two provided values based on that comparison.",[new o("valueTest"),new o("valueTrue"),new o("valueFalse")]),new n("IFERROR","This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[new o("value"),new o("error")]),new n("IMABS","This function returns the absolute value or modulus of a complex number.",[new o("complexnum")]),new n("IMAGINARY","This function returns the imaginary coefficient of a complex number.",[new o("complexnum")]),new n("IMARGUMENT","This function returns the argument theta, which is an angle expressed in radians.",[new o("complexnum")]),new n("IMCONJUGATE","This function returns the complex conjugate of a complex number.",[new o("complexnum")]),new n("IMCOS","This function returns the cosine of a complex number.",[new o("complexnum")]),new n("IMDIV","This function returns the quotient of two complex numbers.",[new o("complexnum"),new o("complexdenom")]),new n("IMEXP","This function returns the exponential of a complex number.",[new o("complexnum")]),new n("IMLN","This function returns the natural logarithm of a complex number.",[new o("complexnum")]),new n("IMLOG2","This function returns the base-2 logarithm of a complex number.",[new o("complexnum")]),new n("IMLOG10","This function returns the common logarithm of a complex number.",[new o("complexnum")]),new n("IMPOWER","This function returns a complex number raised to a power.",[new o("complexnum"),new o("powernum")]),new n("IMPRODUCT","This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[new o("complexnum1"),new o("complexnum2",!0)]),new n("IMREAL","This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[new o("complexnum")]),new n("IMSIN","This function returns the sine of a complex number in the x+yi or x+yj text format.",[new o("complexnum")]),new n("IMSQRT","This function returns the square root of a complex number in the x+yi or x+yj text format.",[new o("complexnum")]),new n("IMSUB","This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[new o("complexnum1"),new o("complexnum2")]),new n("IMSUM","This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[new o("complexnum1"),new o("complexnum2",!0)]),new n("INDEX","This function returns a value or the reference to a value from within an array or range.",[new o("return"),new o("row"),new o("col"),new o("area")]),new n("INDIRECT","This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[new o("ref_text"),new o("a1_style")]),new n("INT","This function rounds a specified number down to the nearest integer.",[new o("value")]),new n("INTERCEPT","This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[new o("dependent"),new o("independent")]),new n("INTRATE","This function calculates the interest rate for a fully invested security.",[new o("settle"),new o("mature"),new o("invest"),new o("redeem"),new o("basis")]),new n("IPMT","This function calculates the payment of interest on a loan.",[new o("rate"),new o("per"),new o("nper"),new o("pval"),new o("fval"),new o("type")]),new n("IRR","This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[new o("arrayvals"),new o("estimate")]),new n("ISBLANK","This function tests whether a value, an expression, or contents of a referenced cell is empty.",[new o("cellreference")]),new n("ISERR","This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[new o("cellreference")]),new n("ISERROR","This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[new o("cellreference")]),new n("ISEVEN","This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[new o("cellreference")]),new n("ISLOGICAL","This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[new o("cellreference")]),new n("ISNA","This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[new o("cellreference")]),new n("ISNONTEXT","This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[new o("cellreference")]),new n("ISNUMBER","This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[new o("cellreference")]),new n("ISODD","This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[new o("cellreference")]),new n("ISPMT","This function calculates the interest paid during a specific period of an investment.",[new o("rate"),new o("per"),new o("nper"),new o("pv")]),new n("ISREF","This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[new o("cellreference")]),new n("ISTEXT","This function tests whether a value, an expression, or contents of a referenced cell has text data.",[new o("cellreference")]),new n("KURT","This function returns the kurtosis of a data set.",[new o("value1"),new o("value2"),new o("value3"),new o("value4",!0)]),new n("LARGE","This function returns the nth largest value in a data set, where n is specified.",[new o("array"),new o("n")]),new n("LCM","This function returns the least common multiple of two numbers.",[new o("number1"),new o("number2")]),new n("LEFT","This function returns the specified leftmost characters from a text value.",[new o("mytext"),new o("num_chars")]),new n("LEN","This function returns the length of, the number of characters in, a text string.",[new o("value")]),new n("LINEST","This function calculates the statistics for a line.",[new o("y"),new o("x"),new o("constant"),new o("stats")]),new n("LN","This function returns the natural logarithm of the specified number.",[new o("value")]),new n("LOG","This function returns the logarithm base Y of a number X.",[new o("number"),new o("base")]),new n("LOG10","This function returns the logarithm base 10 of the number given.",[new o("value")]),new n("LOGEST","This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[new o("y"),new o("x"),new o("constant"),new o("stats")]),new n("LOGINV","This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[new o("prob"),new o("mean"),new o("stdev")]),new n("LOGNORMDIST","This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[new o("x"),new o("mean"),new o("stdev")]),new n("LOOKUP","This function searches for a value and returns a value from the same location in a second area.",[new o("lookupvalue"),new o("lookupvector"),new o("resultvector")]),new n("LOWER","This function converts text to lower case letters.",[new o("string")]),new n("MATCH","This function returns the relative position of a specified item in a range.",[new o("value1"),new o("array"),new o("type")]),new n("MAX","This function returns the maximum value, the greatest value, of all the values in the arguments.",[new o("value1"),new o("value2",!0)]),new n("MAXA","This function returns the largest value in a list of arguments, including text and logical values.",[new o("value1"),new o("value2",!0)]),new n("MDETERM","This function returns the matrix determinant of an array.",[new o("array")]),new n("MDURATION","This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[new o("settlement"),new o("maturity"),new o("coupon"),new o("yield"),new o("frequency"),new o("basis")]),new n("MEDIAN","This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[new o("value1"),new o("value2",!0)]),new n("MID","This function returns the requested number of characters from a text string starting at the position you specify.",[new o("text"),new o("start_num"),new o("num_chars")]),new n("MIN","This function returns the minimum value, the least value, of all the values in the arguments.",[new o("value1"),new o("value2",!0)]),new n("MINA","This function returns the minimum value in a list of arguments, including text and logical values.",[new o("value1"),new o("value2",!0)]),new n("MINUTE","This function returns the minute corresponding to a specified time.",[new o("time")]),new n("MINVERSE","This function returns the inverse matrix for the matrix stored in an array.",[new o("array")]),new n("MIRR","This function returns the modified internal rate of return for a series of periodic cash flows.",[new o("arrayvals"),new o("payment_int"),new o("income_int")]),new n("MMULT","This function returns the matrix product for two arrays.",[new o("array1"),new o("array2")]),new n("MOD","This function returns the remainder of a division operation.",[new o("dividend"),new o("divisor")]),new n("MODE","This function returns the most frequently occurring value in a set of data.",[new o("value1"),new o("value2",!0)]),new n("MONTH","This function returns the month corresponding to the specified date value.",[new o("date")]),new n("MROUND","This function returns a number rounded to the desired multiple.",[new o("number"),new o("multiple")]),new n("MULTINOMIAL","This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[new o("value1"),new o("value2",!0)]),new n("N","This function returns a value converted to a number.",[new o("value")]),new n("NA","This function returns the error value #N/A that means not available.",[]),new n("NEGBINOMDIST","This function returns the negative binomial distribution.",[new o("x"),new o("r"),new o("p")]),new n("NETWORKDAYS","This function returns the total number of complete working days between the start and end dates.",[new o("startdate"),new o("enddate"),new o("holidays")]),new n("NOMINAL","This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[new o("effrate"),new o("comper")]),new n("NORMDIST","This function returns the normal cumulative distribution for the specified mean and standard deviation.",[new o("x"),new o("mean"),new o("stdev"),new o("cumulative")]),new n("NORMINV","This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[new o("prob"),new o("mean"),new o("stdev")]),new n("NORMSDIST","This function returns the standard normal cumulative distribution function.",[new o("value")]),new n("NORMSINV","This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[new o("prob")]),new n("NOT","This function reverses the logical value of its argument.",[new o("value")]),new n("NOW","This function returns the current date and time.",[]),new n("NPER","This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[new o("rate"),new o("paymt"),new o("pval"),new o("fval"),new o("type")]),new n("NPV","This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[new o("discount"),new o("value1"),new o("value2",!0)]),new n("OCT2BIN","This function converts an octal number to a binary number.",[new o("number"),new o("places")]),new n("OCT2DEC","This function converts an octal number to a decimal number.",[new o("number")]),new n("OCT2HEX","This function converts an octal number to a hexadecimal number.",[new o("number"),new o("places")]),new n("ODD","This function rounds the specified value up to the nearest odd integer.",[new o("value")]),new n("ODDFPRICE","This function calculates the price per $100 face value of a security with an odd first period.",[new o("settle"),new o("maturity"),new o("issue"),new o("first"),new o("rate"),new o("yield"),new o("redeem"),new o("freq"),new o("basis")]),new n("ODDFYIELD","This function calculates the yield of a security with an odd first period.",[new o("settle"),new o("maturity"),new o("issue"),new o("first"),new o("rate"),new o("price"),new o("redeem"),new o("freq"),new o("basis")]),new n("ODDLPRICE","This function calculates the price per $100 face value of a security with an odd last coupon period.",[new o("settle"),new o("maturity"),new o("last"),new o("rate"),new o("yield"),new o("redeem"),new o("freq"),new o("basis")]),new n("ODDLYIELD","This function calculates the yield of a security with an odd last period.",[new o("settle"),new o("maturity"),new o("last"),new o("rate"),new o("price"),new o("redeem"),new o("freq"),new o("basis")]),new n("OFFSET","This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[new o("reference"),new o("rows"),new o("cols"),new o("height"),new o("width")]),new n("OR","This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[new o("argument1"),new o("argument2...")]),new n("PEARSON","This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[new o("array_ind"),new o("array_dep")]),new n("PERCENTILE","This function returns the nth percentile of values in a range.",[new o("array"),new o("n")]),new n("PERCENTRANK","This function returns the rank of a value in a data set as a percentage of the data set.",[new o("array"),new o("n"),new o("sigdig")]),new n("PERMUT","This function returns the number of possible permutations for a specified number of items.",[new o("k"),new o("n")]),new n("PI","This function returns PI as 3.1415926536.",[]),new n("PMT","This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[new o("rate"),new o("nper"),new o("pval"),new o("fval"),new o("type")]),new n("POISSON","This function returns the Poisson distribution.",[new o("nevents"),new o("mean"),new o("cumulative")]),new n("POWER","This function raises the specified number to the specified power.",[new o("number"),new o("power")]),new n("PPMT","This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[new o("rate"),new o("per"),new o("nper"),new o("pval"),new o("fval"),new o("type")]),new n("PRICE","This function calculates the price per $100 face value of a periodic interest security",[new o("settlement"),new o("maturity"),new o("rate"),new o("yield"),new o("redeem"),new o("frequency"),new o("basis")]),new n("PRICEDISC","This function returns the price per $100 face value of a discounted security.",[new o("settle"),new o("mature"),new o("discount"),new o("redeem"),new o("basis")]),new n("PRICEMAT","This function returns the price at maturity per $100 face value of a security that pays interest.",[new o("settle"),new o("mature"),new o("issue"),new o("rate"),new o("yield"),new o("basis")]),new n("PROB","This function returns the probability that values in a range are between two limits.",[new o("array"),new o("probs"),new o("lower"),new o("upper")]),new n("PRODUCT","This function multiplies all the arguments and returns the product.",[new o("value1"),new o("value2",!0)]),new n("PROPER","This function capitalizes the first letter in each word of a text string.",[new o("text")]),new n("PV","This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[new o("rate"),new o("numper"),new o("paymt"),new o("fval"),new o("type")]),new n("QUARTILE","This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[new o("array"),new o("quart")]),new n("QUOTIENT","This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[new o("numerator"),new o("denominator")]),new n("RADIANS","This function converts the specified number from degrees to radians.",[new o("value")]),new n("RADIANS","This function converts the specified number from degrees to radians.",[new o("value")]),new n("RAND","This function returns an evenly distributed random number between 0 and 1.",[]),new n("RANDBETWEEN","This function returns a random number between the numbers you specify.",[new o("lower"),new o("upper")]),new n("RANK","This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[new o("number"),new o("array"),new o("order")]),new n("RATE","This function returns the interest rate per period of an annuity.",[new o("nper"),new o("pmt"),new o("pval"),new o("fval"),new o("type"),new o("guess")]),new n("RECEIVED","This function returns the amount received at maturity for a fully invested security.",[new o("settle"),new o("mature"),new o("invest"),new o("discount"),new o("basis")]),new n("REPLACE","This function replaces part of a text string with a different text string.",[new o("old_text"),new o("start_char"),new o("num_chars"),new o("new_text")]),new n("REPT","This function repeats text a specified number of times.",[new o("text"),new o("number")]),new n("RIGHT","This function returns the specified rightmost characters from a text value.",[new o("text"),new o("num_chars")]),new n("ROMAN","This function converts an Arabic numeral to a Roman numeral text equivalent.",[new o("number"),new o("style")]),new n("ROUND","This function rounds the specified value to the nearest number, using the specified number of decimal places.",[new o("value"),new o("places")]),new n("ROUNDDOWN","This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[new o("value"),new o("places")]),new n("ROUNDUP","This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[new o("value"),new o("places")]),new n("ROW","This function returns the number of a row from a reference.",[new o("reference")]),new n("ROWS","This function returns the number of rows in an array.",[new o("array")]),new n("RSQ","This function returns the square of the Pearson product moment correlation coefficient (R‑squared) through data points in known y’s and known x’s.",[new o("array_dep"),new o("array_ind")]),new n("SEARCH","This function finds one text string in another text string and returns the index of the starting position of the found text.",[new o("string1"),new o("string2")]),new n("SECOND","This function returns the seconds (0 to 59) value for a specified time.",[new o("time")]),new n("SERIESSUM","This function returns the sum of a power series.",[new o("x"),new o("n"),new o("m"),new o("coeff")]),new n("SIGN","This function returns the sign of a number or expression.",[new o("cellreference")]),new n("SIN","This function returns the sine of the specified angle.",[new o("angle")]),new n("SINH","This function returns the hyperbolic sine of the specified number.",[new o("value")]),new n("SKEW","This function returns the skewness of a distribution.",[new o("number1"),new o("number2",!0)]),new n("SLN","This function returns the straight-line depreciation of an asset for one period.",[new o("cost"),new o("salvage"),new o("life")]),new n("SLOPE","This function calculates the slope of a linear regression.",[new o("array_dep"),new o("array_ind")]),new n("SMALL","This function returns the nth smallest value in a data set, where n is specified.",[new o("array"),new o("n")]),new n("SQRT","This function returns the positive square root of the specified number.",[new o("value")]),new n("SQRTPI","This function returns the positive square root of a multiple of pi (p).",[new o("multiple")]),new n("STANDARDIZE","This function returns a normalized value from a distribution characterized by mean and standard deviation.",[new o("x"),new o("mean"),new o("stdev")]),new n("STDEVA","This function returns the standard deviation for a set of numbers, text, or logical values.",[new o("value1"),new o("value2",!0)]),new n("STDEVP","This function returns the standard deviation for an entire specified population (of numeric values).",[new o("value1"),new o("value2",!0)]),new n("STDEVPA","This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[new o("value1"),new o("value2",!0)]),new n("STEYX","This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[new o("array_dep"),new o("array_ind")]),new n("SUBSTITUTE","This function substitutes a new string for specified characters in an existing string.",[new o("text"),new o("old_piece"),new o("new_piece"),new o("instance")]),new n("SUBTOTAL","This function calculates a subtotal of a list of numbers using a specified built-in function.",[new o("functioncode"),new o("value1"),new o("value2",!0)]),new n("SUM","This function returns the sum of cells or range of cells.",[new o("value1"),new o("value2",!0)]),new n("SUMIF","This function adds the cells using a given criteria.",[new o("array"),new o("condition"),new o("sumrange")]),new n("SUMIFS","This function adds the cells in a range using multiple criteria.",[new o("array"),new o("conditionarray"),new o("condition",!0)]),new n("SUMPRODUCT","This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[new o("array1"),new o("array2",!0)]),new n("SUMSQ","This function returns the sum of the squares of the arguments.",[new o("value1"),new o("value2",!0)]),new n("SUMX2MY2","This function returns the sum of the difference of the squares of corresponding values in two arrays.",[new o("array_x"),new o("array_y")]),new n("SUMX2PY2","This function returns the sum of the sum of squares of corresponding values in two arrays.",[new o("array_x"),new o("array_y")]),new n("SUMXMY2","This function returns the sum of the square of the differences of corresponding values in two arrays.",[new o("array_x"),new o("array_y")]),new n("SYD","This function returns the sum-of-years’ digits depreciation of an asset for a specified period.",[new o("cost"),new o("salvage"),new o("life"),new o("period")]),new n("T","This function returns the text in a specified cell.",[new o("value")]),new n("TAN","This function returns the tangent of the specified angle.",[new o("angle")]),new n("TANH","This function returns the hyperbolic tangent of the specified number.",[new o("value")]),new n("TBILLEQ","This function returns the equivalent yield for a Treasury bill (or T-bill)",[new o("settle"),new o("mature"),new o("discount")]),new n("TBILLPRICE","This function returns the price per $100 face value for a Treasury bill (or T-bill).",[new o("settle"),new o("mature"),new o("discount")]),new n("TBILLYIELD","This function returns the yield for a Treasury bill (or T-bill).",[new o("settle"),new o("mature"),new o("priceper")]),new n("TDIST","This function returns the probability for the t-distribution.",[new o("x"),new o("deg"),new o("tails")]),new n("TEXT","This function formats a number and converts it to text.",[new o("value"),new o("text")]),new n("TIME","This function returns the TimeSpan object for a specified time.",[new o("hour"),new o("minutes"),new o("seconds")]),new n("TIMEVALUE","This function returns the TimeSpan object of the time represented by a text string.",[new o("time_string")]),new n("TINV","This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[new o("prog"),new o("deg")]),new n("TODAY","This function returns the date and time of the current date.",[]),new n("TRANSPOSE","This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[new o("array")]),new n("TREND","This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[new o("y"),new o("x"),new o("newx"),new o("constant")]),new n("TRIM","This function removes extra spaces from a string and leaves single spaces between words.",[new o("text")]),new n("TRIMMEAN","This function returns the mean of a subset of data excluding the top and bottom data.",[new o("array"),new o("percent")]),new n("TRUE","This function returns the value for logical TRUE.",[]),new n("TRUNC","This function removes the specified fractional part of the specified number.",[new o("value"),new o("precision")]),new n("TTEST","This function returns the probability associated with a t-test.",[new o("array1"),new o("array2"),new o("tails"),new o("type")]),new n("TYPE","This function returns the type of value.",[new o("value")]),new n("UPPER","This function converts text to uppercase letters.",[new o("string")]),new n("VALUE","This function converts a text string that is a number to a numeric value.",[new o("text")]),new n("VAR","This function returns the variance based on a sample of a population, which uses only numeric values.",[new o("value1"),new o("value2",!0)]),new n("VARA","This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[new o("value1"),new o("value2",!0)]),new n("VARP","This function returns variance based on the entire population, which uses only numeric values.",[new o("value1"),new o("value2",!0)]),new n("VARPA","This function returns variance based on the entire population, which includes numeric, logical, or text values.",[new o("value1"),new o("value2",!0)]),new n("VDB","This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[new o("cost"),new o("salvage"),new o("life"),new o("start"),new o("end"),new o("factor"),new o("switchnot")]),new n("VLOOKUP","This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[new o("value"),new o("array"),new o("colindex"),new o("approx")]),new n("WEEKDAY","This function returns the number corresponding to the day of the week for a specified date.",[new o("date"),new o("type")]),new n("WEEKNUM","This function returns a number that indicates the week of the year numerically.",[new o("date"),new o("weektype")]),new n("WEIBULL","This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[new o("x"),new o("alpha"),new o("beta"),new o("cumulative")]),new n("WORKDAY","This function returns the number of working days before or after the starting date.",[new o("startdate"),new o("numdays"),new o("holidays")]),new n("XIRR","This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[new o("values"),new o("dates"),new o("guess")]),new n("XNPV","This function calculates the net present value for a schedule of cash flows that may not be periodic.",[new o("rate"),new o("values"),new o("dates")]),new n("YEAR","This function returns the year as an integer for a specified date.",[new o("date")]),new n("YEARFRAC","This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[new o("startdate"),new o("enddate"),new o("basis")]),new n("YIELD","This function calculates the yield on a security that pays periodic interest.",[new o("settle"),new o("maturity"),new o("rate"),new o("price"),new o("redeem"),new o("frequency"),new o("basis")]),new n("YIELDDISC","This function calculates the annual yield for a discounted security.",[new o("settle"),new o("maturity"),new o("price"),new o("redeem"),new o("basis")]),new n("YIELDMAT","This function calculates the annual yield of a security that pays interest at maturity.",[new o("settle"),new o("maturity"),new o("issue"),new o("issrate"),new o("price"),new o("basis")]),new n("ZTEST","This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[new o("array"),new o("x"),new o("sigma")]),new n("HBARSPARKLINE","This function returns a data set used for representing a Hbar sparkline",[new o("value"),new o("colorScheme")]),new n("VBARSPARKLINE","This function returns a data set used for representing a Vbar sparkline",[new o("value"),new o("colorScheme")]),new n("VARISPARKLINE","This function returns a data set used for representing a variance sparkline",[new o("variance"),new o("reference"),new o("mini"),new o("maxi"),new o("mark"),new o("tickunit"),new o("legend"),new o("colorPositive"),new o("colorNegative"),new o("vertical")]),new n("PIESPARKLINE","This function returns a data set used for representing a pie sparkline",[new o("range|percentage"),new o("color",!0)]),new n("AREASPARKLINE","This function returns a data set used for representing a area sparkline",[new o("points"),new o("mini"),new o("maxi"),new o("line1"),new o("line2"),new o("colorPositive"),new o("colorNegative")]),new n("SCATTERSPARKLINE","This function returns a data set used for representing a scatter sparkline",[new o("points1"),new o("points2"),new o("minX"),new o("maxX"),new o("minY"),new o("maxY"),new o("hLine"),new o("vLine"),new o("xMinZone"),new o("xMaxZone"),new o("yMinZone"),new o("yMaxZone"),new o("tags"),new o("drawSymbol"),new o("drawLines"),new o("color1"),new o("color2"),new o("dash")]),new n("LINESPARKLINE","This function returns a data set used for representing a line sparkline",[new o("data"),new o("dataOrientation"),new o("dateAxisData"),new o("dateAxisOrientation"),new o("setting")]),new n("COLUMNSPARKLINE","This function returns a data set used for representing a column sparkline",[new o("data"),new o("dataOrientation"),new o("dateAxisData"),new o("dateAxisOrientation"),new o("setting")]),new n("WINLOSSSPARKLINE","This function returns a data set used for representing a win/loss sparkline",[new o("data"),new o("dataOrientation"),new o("dateAxisData"),new o("dateAxisOrientation"),new o("setting")]),new n("BULLETSPARKLINE","This function returns a data set used for representing a bullet sparkline",[new o("measure"),new o("target"),new o("maxi"),new o("good"),new o("bad"),new o("forecast"),new o("tickunit"),new o("colorScheme"),new o("vertical")]),new n("SPREADSPARKLINE","This function returns a data set used for representing a spread sparkline",[new o("points"),new o("showAverage"),new o("scaleStart"),new o("scaleEnd"),new o("style"),new o("colorScheme"),new o("vertical")]),new n("STACKEDSPARKLINE","This function returns a data set used for representing a stacked sparkline",[new o("points"),new o("colorRange"),new o("labelRange"),new o("maximum"),new o("targetRed"),new o("targetGreen"),new o("targetBlue"),new o("tragetYellow"),new o("color"),new o("highlightPosition"),new o("vertical"),new o("textOrientation"),new o("textSize")]),new n("BOXPLOTSPARKLINE","This function returns a data set used for representing a boxplot sparkline",[new o("points"),new o("boxPlotClass"),new o("showAverage"),new o("scaleStart"),new o("scaleEnd"),new o("acceptableStart"),new o("acceptableEnd"),new o("colorScheme"),new o("style"),new o("vertical")]),new n("CASCADESPARKLINE","This function returns a data set used for representing a cascade sparkline",[new o("pointsRange"),new o("pointIndex"),new o("labelsRange"),new o("minimum"),new o("maximum"),new o("colorPositive"),new o("colorNegative"),new o("vertical")]),new n("PARETOSPARKLINE","This function returns a data set used for representing a pareto sparkline",[new o("points"),new o("pointIndex"),new o("colorRange"),new o("target"),new o("target2"),new o("highlightPosition"),new o("label"),new o("vertical")]),new n("CEILING.PRECISE","This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[new o("number"),new o("signif")]),new n("COVARIANCE.S","This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[new o("array1"),new o("array2")]),new n("FLOOR.PRECISE","This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[new o("number"),new o("signif")]),new n("PERCENTILE.EXC","This function returns the nth percentile of values in a range.",[new o("array"),new o("n")]),new n("QUARTILE.EXC","This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[new o("array"),new o("quart")]),new n("RANK.AVG","This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[new o("number"),new o("array"),new o("order")]),new n("MODE.MULT","This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[new o("number1"),new o("number2",!0)]),new n("STDEV.P","This function returns the standard deviation for an entire specified population (of numeric values).",[new o("value1"),new o("value2",!0)]),new n("VAR.P","This function returns variance based on the entire population, which uses only numeric values.",[new o("value1"),new o("value2",!0)]),new n("COVARIANCE.P","This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[new o("array1"),new o("array2")]),new n("MODE.SNGL","This function returns the most frequently occurring value in a set of data.",[new o("value1"),new o("value2",!0)]),new n("PERCENTILE.INC","This function returns the nth percentile of values in a range.",[new o("array"),new o("n")]),new n("QUARTILE.INC","This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[new o("array"),new o("quart")]),new n("RANK.EQ","This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[new o("number"),new o("array"),new o("order")]),new n("STDEV","This function returns standard deviation is estimated based on a sample.",[new o("number1"),new o("number2",!0)]),new n("STDEV.S","This function returns standard deviation is estimated based on a sample.",[new o("number1"),new o("number2",!0)]),new n("VAR.S","This function returns the variance based on a sample of a population, which uses only numeric values.",[new o("value1"),new o("value2",!0)]),new n("BETA.INV","This function calculates the inverse of the cumulative beta distribution function.",[new o("prob"),new o("alpha"),new o("beta"),new o("lower"),new o("upper")]),new n("BINOM.DIST","This function calculates the individual term binomial distribution probability.",[new o("x"),new o("n"),new o("p"),new o("cumulative")]),new n("BINOM.INV","This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[new o("n"),new o("p"),new o("alpha")]),new n("CHISQ.DIST.RT","This function calculates the one-tailed probability of the chi-squared distribution.",[new o("value"),new o("deg")]),new n("CHISQ.INV.RT","This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[new o("prob"),new o("deg")]),new n("CHISQ.TEST","This function calculates the test for independence from the chi-squared distribution.",[new o("obs_array"),new o("exp_array")]),new n("CONFIDENCE.NORM","This function returns confidence interval for a population mean.",[new o("alpha"),new o("stdev"),new o("size")]),new n("EXPON.DIST","This function returns the exponential distribution or the probability density.",[new o("value"),new o("lambda"),new o("cumulative")]),new n("F.DIST.RT","This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[new o("value"),new o("degnum"),new o("degden")]),new n("F.INV.RT","This function returns the inverse of the F probability distribution.",[new o("p"),new o("degnum"),new o("degden")]),new n("F.TEST","This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[new o("array1"),new o("array2")]),new n("GAMMA.DIST","This function returns the gamma distribution.",[new o("x"),new o("alpha"),new o("beta"),new o("cumulative")]),new n("GAMMA.INV","This function returns the inverse of the gamma cumulative distribution.",[new o("p"),new o("alpha"),new o("beta")]),new n("LOGNORM.INV","This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[new o("prob"),new o("mean"),new o("stdev")]),new n("NORM.DIST","This function returns the normal cumulative distribution for the specified mean and standard deviation.",[new o("x"),new o("mean"),new o("stdev"),new o("cumulative")]),new n("NORM.INV","This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[new o("prob"),new o("mean"),new o("stdev")]),new n("NORM.S.INV","This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[new o("prob")]),new n("PERCENTRANK.INC","This function returns the rank of a value in a data set as a percentage of the data set.",[new o("array"),new o("n"),new o("signif")]),new n("POISSON.DIST","This function returns the Poisson distribution.",[new o("nevents"),new o("mean"),new o("cumulative")]),new n("T.INV.2T","This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[new o("prog"),new o("deg")]),new n("T.TEST","This function returns the probability associated with a t-test.",[new o("array1"),new o("array2"),new o("tails"),new o("type")]),new n("WEIBULL.DIST","This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[new o("x"),new o("alpha"),new o("beta"),new o("cumulative")]),new n("Z.TEST","This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[new o("array"),new o("x"),new o("sigma")]),new n("T.DIST.RT","This function returns the right-tailed t-distribution.",[new o("x"),new o("deg")]),new n("T.DIST.2T","This function returns the two-tailed t-distribution.",[new o("x"),new o("deg")]),new n("ISO.CEILING","This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[new o("number"),new o("signif")]),new n("BETA.DIST","This function returns the beta distribution.",[new o("x"),new o("alpha"),new o("beta"),new o("cumulative"),new o("lower"),new o("upper")]),new n("GAMMALN.PRECISE","This function returns the natural logarithm of the gamma function.",[new o("value")]),new n("ERF.PRECISE","This function returns the error function.",[new o("lowerlimit")]),new n("ERFC.PRECISE","This function returns the complementary ERF function.",[new o("lowerlimit")]),new n("PERCENTRANK.EXC","This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[new o("array"),new o("n"),new o("signif")]),new n("HYPGEOM.DIST","This function returns the hypergeometric distribution.",[new o("x"),new o("n"),new o("M"),new o("N"),new o("cumulative")]),new n("LOGNORM.DIST","This function returns the log normal distribution of x.",[new o("x"),new o("mean"),new o("stdev"),new o("cumulative")]),new n("NEGBINOM.DIST","This function returns the negative binomial distribution.",[new o("x"),new o("r"),new o("p"),new o("cumulative")]),new n("NORM.S.DIST","This function returns the standard normal distribution.",[new o("z"),new o("cumulative")]),new n("T.DIST","This function returns the t-distribution.",[new o("x"),new o("deg"),new o("cumulative")]),new n("F.DIST","This function returns the F probability distribution.",[new o("x"),new o("degnum"),new o("degden"),new o("cumulative")]),new n("CHISQ.DIST","This function returns the chi-squared distribution.",[new o("x"),new o("deg"),new o("cumulative")]),new n("F.INV","This function returns the inverse of the F probability distribution.",[new o("probability"),new o("degnum"),new o("degden")]),new n("T.INV","This function returns the left-tailed inverse of the t-distribution.",[new o("probability"),new o("deg")]),new n("CHISQ.INV","This function returns the inverse of left-tailed probability of the chi-squared distribution.",[new o("probability"),new o("deg")]),new n("CONFIDENCE.T","This function returns the confidence interval for a Student's t distribution.",[new o("alpha"),new o("stdev"),new o("size")]),new n("NETWORKDAYS.INTL","This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[new o("startdate"),new o("enddate"),new o("weekend"),new o("holidays")]),new n("WORKDAY.INTL","This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[new o("startdate"),new o("numdays"),new o("weekend"),new o("holidays")])],e}();e.FormulaTextBoxResource_EN=r}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={})),function(e){var t,o,n,r,i,a,s,l;t=e.Slicer||(e.Slicer={}),a=void 0,s=null,l=function(){return function(e,t,o){this.columnName=e,this.rowIndex=t,this.data=o}}(),t.SlicerDataItem=l,o=function(){function e(){}return e.prototype.setData=function(e,t){this.slicerData=e,this.columnName=t,this.data=e.getData(t),this.exclusiveDatas=e.getExclusiveData(t),this.slicerData.attachListener(this),this.onDataLoaded()},e.prototype.getDOMElement=function(){return s},e.prototype.onDataLoaded=function(){},e.prototype.onFiltered=function(e){},e.prototype.onDataChanged=function(e){},e.prototype.onRowsChanged=function(e,t,o){},e.prototype.onColumnNameChanged=function(e,t){},e.prototype.onColumnRemoved=function(e){},e}(),t.SlicerBase=o,(i=t.SlicerAggregateType||(t.SlicerAggregateType={}))[i.average=1]="average",i[i.count=2]="count",i[i.counta=3]="counta",i[i.max=4]="max",i[i.min=5]="min",i[i.product=6]="product",i[i.stdev=7]="stdev",i[i.stdevp=8]="stdevp",i[i.sum=9]="sum",i[i.vars=10]="vars",i[i.varp=11]="varp",t.SlicerAggregateType,n=function(){function e(e,t){this._columnsSet={},this._columnDataCache=[],this._exclusiveDataCache=[],this._exclusiveDataIndex=[],this._exclusiveToFullMap=[],this._fullToExclusivelMap=[],this._filteredInfoSet=[],this._filteredInfoIndexes=[],this._filteredInfoByRangeSet=[],this._filteredInfoByRange=[],this._filteredRowMap=[],this._filteredRowIndexes=[],this._filteredColumns=[],this._filteredPreviewRowIndexes=[],this._filteredPreviewRowMap=[],this._inPreview=!1,this._listeners=[],this._suspendCount=0,this._sortedColumnDataCache=[],this._sorted2DataMapping=[],this._data2SortedMapping=[],this.setDataSource(e,t);for(var o=0;o<this.data.length;o++)this._filteredRowMap[o]=!0,this._filteredRowIndexes.push(o)}return e.prototype.inPreview=function(){return this._inPreview},e.prototype.setDataSource=function(e,t){this.data=e,this.columnNames=t,this.updateDataCaches()},e.prototype.changeData=function(e){for(var t,o,n,r,i,a=this,s=new Array(a.columnNames.length),l=a._filteredInfoIndexes,u=a._exclusiveDataCache,c=a._filteredInfoSet,h=0;h<e.length;h++){var p=e[h],d=p.rowIndex,f=a.getColumnIndex(p.columnName);a.data[d][f]=p.data,t=a.isDataItemObject(p.data)?p.data.text:p.data,a._columnDataCache[f]&&(a._columnDataCache[f][d]=t),s[f]=!0}for(o=0;o<s.length;o++)if(s[o]){for(n=l[o],l[o]=n?[]:void 0,c[o]=n?{}:void 0,r=[],h=0;n&&h<n.length;h++)r.push(u[o][n[h]]);if(a.updateDataCache(o),r.length>0)for(h=0;h<r.length;h++)i=a._exclusiveDataIndex[o][r[h]],l[o].push(i),c[o][i]=!0}for(a.updateFilteredRows(),h=0;h<a._listeners.length;h++)a._listeners[h].onDataChanged&&a._listeners[h].onDataChanged(e)},e.prototype.isDataItemObject=function(e){return e&&e.text!==a},e.prototype.changeColumnName=function(e,t){var o,n=this.getColumnIndex(e);if(!(n<0))for(this.columnNames[n]=t,delete this._columnsSet[e.toUpperCase()],this._columnsSet[t.toUpperCase()]=n,o=0;o<this._listeners.length;o++)this._listeners[o].onColumnNameChanged&&this._listeners[o].onColumnNameChanged(e,t)},e.prototype.addRows=function(e,t){for(var o,n,i,l,u,c,h,p,d,f,g,m,_=this,y=(new Array(_.columnNames.length),_.columnNames.length),C=_.data,w=_._columnDataCache,v=_._exclusiveDataCache,S=_._exclusiveToFullMap,x=_._fullToExclusivelMap,R=_._filteredInfoSet,b=_._filteredInfoIndexes,T=_._filteredRowMap,A=_._filteredRowIndexes,I=_._filteredColumns,D=(new Array(t),0);D<t;D++)C.splice(e,0,new Array(y));for(d=0;d<y;d++){for(D=0;D<t;D++)w[d]&&w[d].splice(e,0,a);if(o=v[d]){for(i=s,l=0;l<o.length;l++){for(u=S[d][l],c=0;c<u.length;c++)u[c]>=e&&(u[c]+=t);r.isEquals(o[l],s)&&(i=u,n=l)}for(i||(i=[],o.push(s),n=o.length-1,_._exclusiveDataIndex[d].null=n,S[d].push(i),R[d]&&-1===_._filteredColumns.indexOf(d)&&(R[d][n]=!0,b[d].push(n))),h=e;h<e+t;h++)i.push(h);for(m=e;m<e+t;m++)x[d].splice(m,0,n)}}for(p=!0,D=0;D<I.length;D++)f=x[d=I[D]][e],!0!==R[d][f]&&(p=!1);for(D=0;D<A.length;D++)A[D]>=e&&(A[D]+=t);for(m=C.length-1;m>=e+t;m--)T[m]=T[m-t];for(g=_._filteredColumns.length>0,m=e;m<e+t;m++)p&&A.push(m),T[m]=!g;for(D=0;D<_._listeners.length;D++)_._listeners[D].onRowsChanged&&_._listeners[D].onRowsChanged(e,t,!0)},e.prototype.removeRows=function(e,t){this.removeRowsCore(e,t,!0)},e.prototype.removeRowsCore=function(e,t,o){var n,r,i,a,s,l,u,c,h=this,p=(new Array(h.columnNames.length),h._filteredInfoIndexes),d=h._exclusiveDataCache,f=h._filteredInfoSet,g=h.data,m=h.columnNames.length,_=h._columnDataCache;for(g.splice(e,t),n=0;n<m;n++){if(_[n]&&_[n].splice(e,t),i=[],(r=p[n])&&o){for(c=0;c<r.length;c++){for(a=h.getRowIndexes(h.columnNames[n],r[c]),s=!0,l=0;l<a.length;l++)if(a[l]<e||a[l]>=e+t){s=!1;break}s||i.push(d[n][r[c]])}p[n]=[],f[n]={}}if(h.updateDataCache(n),r&&o)for(c=0;c<i.length;c++)u=h._exclusiveDataIndex[n][i[c]],p[n].push(u),f[n][u]=!0}for(c=0;c<h._listeners.length;c++)h._listeners[c].onRowsChanged&&h._listeners[c].onRowsChanged(e,t,!1)},e.prototype.updateFilteredRows=function(){for(var e,t,o,n,r=this,i=r._inPreview?r._filteredPreviewRowMap:r._filteredRowMap=[],a=r._filteredInfoByRangeSet,s=r._filteredInfoSet,l=r._inPreview?r._filteredPreviewRowIndexes:r._filteredRowIndexes=[],u=r.data.length,c=0;c<u;c++){for(e=!1,n=0;n<r._filteredColumns.length&&(t=r._filteredColumns[n],r._inPreview&&t===r._previewCol||(s[t]?(o=r.getExclusiveRowIndex(r.columnNames[t],c),e=!s[t][o]):a[t]&&(e=!a[t][c]),!e));n++);!e&&r._inPreview&&(r._filteredPreviewColumnSet?(o=r.getExclusiveRowIndex(r.columnNames[t],c),e=!r._filteredPreviewColumnSet[o]):r._filteredPreviewByRangColumnSet&&(e=!r._filteredPreviewByRangColumnSet[c])),e||(i[c]=!0)}for(n=0;n<i.length;n++)i[n]&&l.push(n)},e.prototype.removeColumns=function(e,t){for(var o,n,r,i,a,s,l,u=this,c=[],h=e;h<e+t;h++)c.push(u.columnNames[h]);for(o=u._filteredColumns,h=0;h<c.length;h++)a=c[h],n=u.getColumnIndex(a),-1!==o.indexOf(n)&&u.doUnfilter(a);var p=u._filteredInfoSet||u._filteredInfoByRangeSet,d=u._filteredInfoIndexes||u._filteredInfoByRange,f=u._columnsSet;for(h=0;h<u.data.length;h++)u.data[h].splice(e,t);for(r in u.columnNames.splice(e,t),u._columnDataCache.splice(e,t),u._exclusiveDataCache.splice(e,t),u._exclusiveDataIndex.splice(e,t),u._exclusiveToFullMap.splice(e,t),u._fullToExclusivelMap.splice(e,t),p.splice(e,t),d.splice(e,t),f)f[r]>=e+t&&(f[r]-=t);for(i=u._listeners||[],h=0;h<c.length;h++)for(delete f[(a=c[h]).toUpperCase()],e=u.getColumnIndex(a),-1!==(s=o.indexOf(e))&&o.splice(s,1),l=0;l<i.length;l++)i[l].onColumnRemoved&&i[l].onColumnRemoved(c[h])},e.prototype.updateDataCaches=function(){var e,t,o=this._columnsSet={};for(this._columnDataCache=[],this._exclusiveDataCache=[],this._exclusiveToFullMap=[],this._fullToExclusivelMap=[],e=this.columnNames,t=0;t<e.length;t++)o[(e[t]+"").toUpperCase()]=t},e.prototype.getSortedColumnDataCache=function(){return this._sortedColumnDataCache},e.prototype.getSorted2DataMapping=function(){return this._sorted2DataMapping},e.prototype.sortOneCol=function(e){var t,o,n,i,a,s,l;for(this._columnDataCache[e]||this.updateDataCache(e),t=this.data[0]&&this.data[0].length,o=[],n=0;n<t;n++)i=this.data[n][e],a=this.isDataItemObject(i)?i.value:i,o.push(a);var u=r.quickSort(o),c=this._sortedColumnDataCache[e]=[],h=this._sorted2DataMapping[e]=[],p=this._data2SortedMapping[e]=[];for(s=0;s<u.length;s++)l=u[s],c.push(l.value),h.push(l.index),p[l.index]=s},e.prototype.updateDataCache=function(e){var t,o,n,i,a,s,l,u,c,h=this._columnDataCache,p=this._exclusiveDataCache,d=this._exclusiveDataIndex,f=this._exclusiveToFullMap,g=this._fullToExclusivelMap,m=this.data;for(h[e]=[],p[e]=[],d[e]={},t=g[e]=[],f[e]=[],o=0;o<m.length;o++)if(n=m[o][e],i=this.isDataItemObject(n)?n.text:n,h[e].push(i),void 0===t[o])for(a=[o],p[e].push(i),f[e].push(a),s=f[e].length-1,d[e][i]=s,t[o]=s,l=o+1;l<m.length;l++)u=m[l][e],c=this.isDataItemObject(u)?u.text:u,void 0===t[l]&&r.isEquals(c,i)&&(a.push(l),t[l]=s)},e.prototype.getColumnIndex=function(e){var t=this._columnsSet[e.toUpperCase()];return void 0===t?-1:t},e.prototype.getFilteredRowIndexes=function(){return this._inPreview?this._filteredPreviewRowIndexes:this._filteredRowIndexes},e.prototype.getFilteredOutRowIndexes=function(){for(var e=this.data.length,t=this._inPreview?this._filteredPreviewRowMap:this._filteredRowMap,o=[],n=0;n<e;n++)t[n]||o.push(n);return o},e.prototype.getData=function(e,t){var o,n=this.getColumnIndex(e);if(n>=0){if(t){this._sortedColumnDataCache[n]||this.sortOneCol(n);var r=this._columnDataCache[n],i=this._sortedColumnDataCache[n],a=this._getStartEndIndex(i,t),s=a.start,l=a.end,u=[];for(o=s;o<=l;o++)u.push(r[this._sorted2DataMapping[n][o]]);return u}return this._columnDataCache[n]||this.updateDataCache(n),this._columnDataCache[n]}return[]},e.prototype.aggregateData=function(e,t,o){var n,r,i,l,u,c=this._sortedColumnDataCache,h=this.getColumnIndex(e);if(h<0)return a;c[h]||this.sortOneCol(h);var p=c[h],d=p.length,f=this._getStartEndIndex(p,o);if(n=f.start,r=f.end,5===t)return n>=d?a:p[n];if(4===t)return r<0?a:p[r];if(3===t)return r<n?0:r-n+1;var g=6===t?1:0,m=0,_=0;for(i=n;i<=r;i++)((l=p[i])!==s||l!==a)&&(u={value:s},3===t?g++:this.tryToNumber(l,u)&&(l=u.value,1===t?(g+=l,m++):2===t?g++:9===t?g+=l:6===t?g*=l:(7===t||8===t||10===t||11===t)&&(g+=l,m+=l*l,_++)));return 1===t?g/=m:7===t||10===t?(g=(_*m-g*g)/(_*(_-1)),g=7===t?Math.sqrt(g):g):(8===t||11===t)&&(g=(_*m-g*g)/(_*_),g=8===t?Math.sqrt(g):g),g},e.prototype.tryToNumber=function(e,t){var o,n;if(e===s||e===a)return!1;if("number"==typeof e)t.value=e;else if("boolean"==typeof e)t.value=e?1:0;else if(e instanceof Date)t.value=r.toOADate(e);else{if("string"!=typeof e)return!1;if(0===(e=e.trim()).length||(o=!1,"%"===e.charAt(e.length-1)&&(o=!0,e=e.substr(0,e.length-1)),e.length>=2&&"0"===e[0]&&"x"===e[1]))return!1;if(n=new Number(e).valueOf(),isNaN(n)||!isFinite(n)){if(n=new Date(e),isNaN(n))return!1;n=r.toOADate(n)}o&&(n/=100),t.value=n}return!0},e.prototype._getStartEndIndex=function(e,t){var o,n,i,s,l=e.length;if(t){if(t.min===-1/0)o=0;else for(i=0;i<l;i++)if(s=e[i],r.isEquals(t.min,s)||r.isGreaterThan(s,t.min)){o=i;break}if(o===a&&(o=l),n===1/0)n=l-1;else{for(i=l-1;i>=0;i--)if(s=e[i],r.isEquals(s,t.max)||r.isGreaterThan(t.max,s)){n=i;break}n===a&&(n=-1)}}else o=0,n=l-1;return{start:o,end:n}},e.prototype.getExclusiveData=function(e){var t=this.getColumnIndex(e);return t>=0?(this._exclusiveDataCache[t]||this.updateDataCache(t),this._exclusiveDataCache[t]):[]},e.prototype.getRowIndexes=function(e,t){var o=this.getColumnIndex(e);return o>=0?(this._fullToExclusivelMap[o]||this.updateDataCache(o),this._exclusiveToFullMap[o][t]):[]},e.prototype.getExclusiveRowIndex=function(e,t){var o=this.getColumnIndex(e);return o>=0?(this._fullToExclusivelMap[o]||this.updateDataCache(o),this._fullToExclusivelMap[o][t]):-1},e.prototype.getFilteredIndexes=function(e){var t=[];return this.getFilteredExclusiveIndexes(e,t,{}),t},e.prototype.getFilteredExclusiveIndexes=function(e,t,o){for(var n,r,i=this._inPreview?this._filteredPreviewRowIndexes:this._filteredRowIndexes,a=0;a<i.length;a++)n=i[a],o[r=this.getExclusiveRowIndex(e,n)]?o[r]++:(o[r]=1,t.push(r))},e.prototype.getFilteredExclusiveIndexesCore=function(e,t){var o,n,r,i=[],a={},s=[];for(this.getFilteredExclusiveIndexes(e,i,a),o=0;o<i.length;o++)n=i[o],r=this.getRowIndexes(e,n).length,t&&r===a[n]?s.push(n):r!==a[n]&&s.push(n);return s},e.prototype.getFilteredRanges=function(e){return this._getFilteredInfos(e,!1)},e.prototype.getFilteredOutRanges=function(e){return this._getFilteredInfos(e,!0)},e.prototype._getFilteredInfos=function(e,t){var o,n,r,i,a,s,l,u,c=this,h=c.getColumnIndex(e),p=[];if(!h||(o=c._inPreview?c._filteredPreviewByRangColumn:c._filteredInfoByRange[h],n=c._filteredRowMap,!o))return p;for(c._data2SortedMapping[h]||c.sortOneCol(h),r=[],i=c._data2SortedMapping[h],l=0;l<i.length;l++)a=c.data[l][h],s=c.isDataItemObject(a)?a.value:a,r[i[l]]=s;for(l=0;l<o.length;l++){var d=o[l],f=!1,g=c._getStartEndIndex(r,d);for(u=g.start;u<=g.end;u++)if(n[i[u]]){f=!0;break}f!==t&&p.push(d)}return p},e.prototype.getFilteredOutIndexes=function(e,t){return 0===t?this.getAllFilteredOutExclusiveRowIndexes(e):1===t?this.getFilteredOutExclusiveRowIndexesBySelf(e):this.getFilteredOutExclusiveRowIndexesByOther(e)},e.prototype.getAllFilteredOutExclusiveRowIndexes=function(e){var t,o,n,r,i=[];if(this.getColumnIndex(e)>=0)for(t=this.getData(e).length,o=this._inPreview?this._filteredPreviewRowMap:this._filteredRowMap,n=0;n<t;n++)o[n]||(r=this.getExclusiveRowIndex(e,n),-1===i.indexOf(r)&&i.push(r));return i},e.prototype.getFilteredOutExclusiveRowIndexesBySelf=function(e){var t,o,n=this,r=[],i=n.getColumnIndex(e);if(i>=0){var a=n._inPreview&&i===n._previewCol?n._filteredPreviewColumnSet||n._filteredPreviewByRangColumnSet:n._filteredInfoSet[i]||n._filteredInfoByRangeSet[i],s=!!n._filteredInfoByRangeSet[i],l=s?n.getData(e).length:n.getExclusiveData(e).length;for(t=0;t<l;t++)a&&!a[t]&&(o=s?n.getExclusiveRowIndex(e,t):t,-1===r.indexOf(o)&&r.push(o))}return r},e.prototype.getFilteredOutExclusiveRowIndexesByOther=function(e){for(var t,o,n,r,i,a,s,l=[],u=0,c=this.columnNames.length;u<c;u++)if(this.columnNames[u]!==e)for(t=this.getFilteredOutExclusiveRowIndexesBySelf(this.columnNames[u]),o=0;o<t.length;o++)for(n=this.getRowIndexes(this.columnNames[u],t[o]),r=0;r<n.length;r++)-1===l.indexOf(n[r])&&l.push(n[r]);for(u=0,c=this.data.length;u<c;u++)-1!==l.indexOf(u)?l.splice(l.indexOf(u),1):l.push(u);for(i=this.getExclusiveData(e).length,a=[],u=0;u<i;u++)a.push(u);for(u=0,c=l.length;u<c;u++)s=this.getExclusiveRowIndex(e,l[u]),-1!==a.indexOf(s)&&a.splice(a.indexOf(s),1);return a},e.prototype.attachListener=function(e){this._listeners.push(e)},e.prototype.detachListener=function(e){for(var t=0;t<this._listeners.length;t++)if(this._listeners[t]===e){this._listeners.splice(t,1);break}},e.prototype.suspendFilteredEvents=function(){this._suspendCount++},e.prototype.resumeFilteredEvents=function(){this._suspendCount--,0===this._suspendCount&&this.onFiltered()},e.prototype.doFilter=function(e,t,o){var n=this.getColumnIndex(e);n<0||(o?(this._inPreview=!0,this._previewCol=n):this._inPreview&&this.clearPreviewCore(!1),this._filteredColumns.indexOf(n)<0&&this._filteredColumns.push(n),t.ranges?this.doFilterByRange(e,t.ranges,o):this.doFilterByIndexes(e,t.exclusiveRowIndexes,o),this.onFiltered())},e.prototype.doFilterByRange=function(e,t,o){var n,r,i,a,s,l,u,c,h=this,p=h.getColumnIndex(e);for(h._filteredRowMap,h._data2SortedMapping[p]||h.sortOneCol(p),n=[],r=h._data2SortedMapping[p],l=0;l<r.length;l++)i=h.data[l][p],a=h.isDataItemObject(i)?i.value:i,n[r[l]]=a;for(s={},l=0;l<t.length;l++)for(u=h._getStartEndIndex(n,t[l]),c=0;c<r.length;c++)r[c]>=u.start&&r[c]<=u.end&&(s[c]=!0);o?(h._filteredPreviewByRangColumnSet=s,h._filteredPreviewByRangColumn=t):(h._filteredInfoByRange[p]=t,h._filteredInfoByRangeSet[p]=s,delete h._filteredInfoSet[p],delete h._filteredInfoIndexes[p]),h.updateFilteredRows()},e.prototype.doFilterByIndexes=function(e,t,o){for(var n=this.getColumnIndex(e),r={},i=0;i<t.length;i++)r[t[i]]=!0;o?this._filteredPreviewColumnSet=r:(this._filteredInfoSet[n]=r,this._filteredInfoIndexes[n]=t,delete this._filteredInfoByRange[n],delete this._filteredInfoByRangeSet[n]),this.updateFilteredRows()},e.prototype.clearPreview=function(){this.clearPreviewCore(!0)},e.prototype.clearPreviewCore=function(e){this._inPreview=!1,this._filteredPreviewColumnSet={},this._filteredPreviewRowIndexes=[],this._filteredPreviewRowMap=[],this._filteredPreviewByRangColumnSet=[],e&&this.onFiltered()},e.prototype.doUnfilter=function(e){var t,o,n=this;n._inPreview&&n.clearPreviewCore(!1),(t=n.getColumnIndex(e))<0||(delete n._filteredInfoByRange[t],delete n._filteredInfoByRangeSet[t],delete n._filteredInfoSet[t],delete n._filteredInfoIndexes[t],n.updateFilteredRows(),(o=n._filteredColumns.indexOf(t))>=0&&n._filteredColumns.splice(o,1),n.onFiltered())},e.prototype.onFiltered=function(){var e;if(0===this._suspendCount)for(e=0;e<this._listeners.length;e++)this._listeners[e].onFiltered&&this._listeners[e].onFiltered({rowIndexes:this.getFilteredRowIndexes(),isPreview:this._inPreview})},e}(),t.GeneralSlicerData=n,r=function(){function e(){}return e.quickSort=function(e){for(var t=e.length,o=[],n=0;n<t;n++)o[n]={index:n,value:e[n]};return this.quickSortImp(o)},e.quickSortImp=function(e){var t,o;if(e.length<=1)return e;var n=e[Math.floor(e.length/2)],r=[],i=[],a=[];for(t=0;t<e.length;t++)(o=this.sortCompare(e[t].value,n.value))<0?r.push(e[t]):o>0?i.push(e[t]):a.push(e[t]);return this.quickSortImp(r).concat(a,this.quickSortImp(i))},e.isEquals=function(e,t){return!(e!==s&&e!==a&&""!==e||t!==s&&t!==a&&""!==t)||(e instanceof Date&&t instanceof Date?e.valueOf()===t.valueOf():"string"==typeof e&&"string"==typeof t?e.toLowerCase()===t.toLowerCase():e===t)},e.toOADate=function(e){return e===a||e===s?0:("number"==typeof e&&(e=new Date(e)),(1440*e.getTime()+3181192704e6-864e5*e.getTimezoneOffset())/124416e6)},e.isGreaterThan=function(e,t){return"boolean"==typeof e?e=e?1:0:e instanceof Date&&(e=this.toOADate(e)),"boolean"==typeof t?t=t?1:0:t instanceof Date&&(t=this.toOADate(t)),typeof e==typeof t||"number"!=typeof e&&"number"!=typeof t?"string"==typeof e&&"string"==typeof t?e.toLowerCase()>t.toLowerCase():e>t:"number"==typeof t},e.sortCompare=function(e,t){var o,n;return o=e===a||e===s||""===e||"number"==typeof e&&isNaN(e),n=t===a||t===s||""===t||"number"==typeof t&&isNaN(t),o&&n?0:o?1:n?-1:this.isEquals(e,t)?0:this.isGreaterThan(e,t)?1:-1},e}(),t.SortHelper=r;e.Slicer}(GcSpread||(GcSpread={})),function(e){!function(e){var t;(t=e.FilteredOutDataType||(e.FilteredOutDataType={}))[t.all=0]="all",t[t.byCurrentColumn=1]="byCurrentColumn",t[t.byOtherColumns=2]="byOtherColumns";e.FilteredOutDataType}(e.Slicer||(e.Slicer={}));e.Slicer}(GcSpread||(GcSpread={})),__extends=this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},function(e){!function(t){var o,n,r,i,a,s,l,u,c;t.feature("tableSlicer",["core.common","core.sheet_action","floatingObject"]);var h,p,d,f=void 0,g=null,m="normal 11pt calibri",_=function(n){function r(e){n.call(this),this.CONTAINER_NAME="slicer-container",this.HEADER_NAME="slicer-header",this.HEADER_BORDERDIV_NAME="slicer-header-borderDiv",this.CAPTION_NAME="slicer-caption",this.CLEARFILTER_NAME="slicer-clearfilter",this.SPLITLINE_NAME="slicer-splitline",this.BODY_NAME="slicer-body",this.TABLE_NAME="slicer-table",this.TR_NAME="slicer-tr",this.TD1_NAME="slicer-td1",this.TD2_NAME="slicer-td2",this.ITEMSCONTAINER_NAME="slicer-itemscontainer",this.ITEM_NAME="slicer-item",this.SCROLLBAR_NAME="slicer-scrollbar",this.NO_USER_SELECT="no-user-select";var t=this;t._name=e,t._captionName="",t._width=180,t._height=210,t._showHeader=!0,t._sortState=1,t._disableResizingAndMoving=!1,t._showNoDataItems=!0,t._showNoDataItemsInLast=!0,t._visuallyNoDataItems=!0,t._isLocked=!0,t._container=null,t._containerPadding=6,t._containerBorderWidth=1,t._fontSize=14,t._zoomFactor=1,t._header=null,t._headerHeight=27,t._headerMarginBottom=5,t._caption=null,t._clearFilter=null,t._clearFilterWidth=28,t._clearFilterHeight=25,t._clearFilterTop=3,t._clearFilterRight=0,t._isFiltered=!1,t._captionTop=3,t._body=null,t._tb=null,t._tr=null,t._td1=null,t._td2=null,t._itemsContainer=null,t._itemsContainerWidth=0,t._itemsContainerHeight=0,t._scrollbar=null,t._tableBorderSpacing=2,t._items=[],t._itemsSet={},t._itemHeight=21,t._itemBorderWidth=1,t._itemVerticalPadding=1,t._itemHorizontalPadding=6,t._columnCount=1,t._itemMargin=2,t._scrollbarWidth=17,t._scrollbarValue=0,t._clearFilterNormalBackColor="white",t._clearFilterHoveredBackColor="#F9E578",t._clearFilterActivedForeColor="red",t._clearFilterNonActivedForeColor="#B0ADB0",t._isMouseDownOnItem=!1,t._isMouseDownOnScrollbar=!1,t._selectingItemIndexes=[],t._filteringItemIndexes=[],t._activeItemIndex=0,t._sortedItems=[],t._unSelectedItemIndexes=[],t._noDataItemIndexes=[],t._style=t.defaultStyle(),t._exclusiveDataTexts=[],t._dataTexts=[]}return __extends(r,n),r.prototype.name=function(e){return 0===arguments.length?this._name:(this._name!==e&&(this._name=e),this)},r.prototype.width=function(e){return 0===arguments.length?this._width:(e!==this._width&&(this._width=e,this.refresh()),this)},r.prototype.height=function(e){return 0===arguments.length?this._height:(e!==this._height&&(this._height=e,this.refresh()),this)},r.prototype.captionName=function(e){return 0===arguments.length?this._captionName:(e!==this._captionName&&(this._captionName=e,this.refresh()),this)},r.prototype.columnCount=function(e){return 0===arguments.length?this._columnCount:(e>0&&e!==this._columnCount&&(this._columnCount=e,this.refresh()),this)},r.prototype.itemHeight=function(e){return 0===arguments.length?this._itemHeight:(e>0&&e!==this._itemHeight&&(this._itemHeight=e,this.refresh()),this)},r.prototype.showHeader=function(e){return 0===arguments.length?this._showHeader:(e!==this._showHeader&&(this._showHeader=e,this.refresh()),this)},r.prototype.sortState=function(e){return 0===arguments.length?this._sortState:(e!==this._sortState&&(this._sortState=e,this._sortedItems=this.getSortedItems(),this.refresh()),this)},r.prototype.showNoDataItems=function(e){return 0===arguments.length?this._showNoDataItems:(e!==this._showNoDataItems&&(this._showNoDataItems=e,this._sortedItems=this.getSortedItems(),this.refresh()),this)},r.prototype.showNoDataItemsInLast=function(e){return 0===arguments.length?this._showNoDataItemsInLast:(e!==this._showNoDataItemsInLast&&(this._showNoDataItemsInLast=e,this._sortedItems=this.getSortedItems(),this.refresh()),this)},r.prototype.visuallyNoDataItems=function(e){return 0===arguments.length?this._visuallyNoDataItems:(e!==this._visuallyNoDataItems&&(this._visuallyNoDataItems=e,this._sortedItems=this.getSortedItems(),this.refresh()),this)},r.prototype.style=function(e){return 0===arguments.length?this._style:(e&&this._style!==e&&(this._style=e,this.applyStyle(this._style),this.refresh()),this)},r.prototype.zoomFactor=function(e){return 0===arguments.length?this._zoomFactor:(e>0&&e!==this._zoomFactor&&(this._zoomFactor=e,this.refresh()),this)},r.prototype.isLocked=function(e){return 0===arguments.length?this._isLocked:(e!==this._isLocked&&(this._isLocked=e,this.refresh()),this)},r.prototype.disableResizingAndMoving=function(e){return 0===arguments.length?this._disableResizingAndMoving:(e!==this._disableResizingAndMoving&&(this._disableResizingAndMoving=e,this.refresh()),this)},r.prototype.setData=function(e,t){n.prototype.setData.call(this,e,t)},r.prototype.onDataLoaded=function(){var e=this;e._dataTexts=e.getDataTexts(e.data),e._exclusiveDataTexts=e.getDataTexts(e.exclusiveDatas),e._container=e.createContainer(),e._captionName=e.columnName,e.attachEvents(),e.onFiltered(null),e.applyStyle(e._style),e.refresh()},r.prototype.getDOMElement=function(){return this._container},r.prototype.getDataTexts=function(e){var o,n,r;if(!e||0===e.length)return[];for(o=[],n=0,r=e.length;n<r;n++)e[n]===f||e[n]===g||""===e[n]?o.push(t.SR.Blank):o.push(String(e[n]));return o},r.prototype.createContainer=function(){var e,o,n=document.createElement("div");return t.GC$(n).css({position:"absolute",padding:6*this._zoomFactor,"box-sizing":"content-box",overflow:"hidden"}).addClass(this.CONTAINER_NAME),this.adjustContainerSize(),e=this.createHeader(),o=this.createBody(),t.GC$(n).append(e).append(o),n},r.prototype.createHeader=function(){var e,o,n=this,r=document.createElement("div"),i=document.createElement("div");return t.GC$(r).css({width:"auto",position:"absolute",top:0,left:0,right:0,"box-sizing":"content-box",overflow:"hidden"}).addClass(n.HEADER_NAME),t.GC$(i).css({width:"auto",position:"absolute",left:n._containerPadding*n._zoomFactor,right:n._containerPadding*n._zoomFactor,"box-sizing":"content-box",overflow:"hidden"}).addClass(n.HEADER_BORDERDIV_NAME),n._header=r,n._headerBorderDiv=i,t.GC$(r).append(i),e=document.createElement("span"),t.GC$(e).css({"box-sizing":"content-box",position:"absolute",top:n._captionTop*n.getHeaderFontFactor()*n._zoomFactor,overflow:"hidden",width:n.getCaptionWidth()*n._zoomFactor,"text-overflow":"ellipsis","white-space":"nowrap"}).text(n._captionName).attr("unselectable","on").addClass(n.CAPTION_NAME+" "+n.NO_USER_SELECT),n._caption=e,o=document.createElement("div"),t.GC$(o).css({width:n._clearFilterWidth*n._zoomFactor,height:n._clearFilterHeight*n._zoomFactor,cursor:"default",position:"absolute",top:n._clearFilterTop*n.getHeaderFontFactor()*n._zoomFactor,right:n._clearFilterRight*n._zoomFactor,"text-align":"center","box-sizing":"content-box","font-weight":"normal","border-radius":2,overflow:"hidden","font-size":n._fontSize*n._zoomFactor+"px"}).attr("title","Clear Filter (Alt+C)").attr("unselectable","on").text("✗").addClass(n.CLEARFILTER_NAME+" "+n.NO_USER_SELECT),n._clearFilter=o,n.adjustHeaderSize(),t.GC$(i).append(e).append(o),r},r.prototype.createBody=function(){var e,o,n,r,i,a,s=this,l=document.createElement("div");return t.GC$(l).css({width:"auto",height:"auto",overflow:"hidden","margin-top":(s._headerHeight-s._containerPadding+s._headerMarginBottom)*s.getHeaderFontFactor()*s._zoomFactor,"box-sizing":"content-box"}).attr("unselectable","on").addClass(s.BODY_NAME+" "+s.NO_USER_SELECT),s._body=l,e=document.createElement("table"),t.GC$(e).css("box-sizing","content-box").css("border-spacing","0px").attr("unselectable","on").addClass(s.TABLE_NAME+" "+s.NO_USER_SELECT),s._tb=e,o=document.createElement("tr"),t.GC$(o).css("box-sizing","content-box").addClass(s.TR_NAME),s._tr=o,n=document.createElement("td"),t.GC$(n).css({padding:0,"box-sizing":"content-box"}).addClass(s.TD1_NAME),s._td1=n,r=document.createElement("td"),t.GC$(r).css({padding:0,"box-sizing":"content-box",cursor:"default"}).addClass(s.TD2_NAME),s._td2=r,i=s.createItemsContainer(),t.GC$(n).append(i),a=s.createScrollbar(),t.GC$(r).append(a),s._scrollbar=a,t.GC$(o).append(n).append(r),t.GC$(e).append(o),t.GC$(l).append(e),l},r.prototype.createItemsContainer=function(){var e,o,n,r,i,a,s,l=this,u=document.createElement("div");if(l._itemsContainer=u,e=l.getItemsContainerHeight(),l._itemsContainerHeight=e,o=l.getItemsContainerWidth(),l._itemsContainerWidth=o,t.GC$(u).css({width:o*l._zoomFactor,height:e*l._zoomFactor,"font-size":l._fontSize*l._zoomFactor+"px"}).attr("unselectable","on").addClass(l.ITEMSCONTAINER_NAME+" "+l.NO_USER_SELECT),n=l.getSortedItems(),l._sortedItems=n,n&&0!==n.length){for(r=Math.min(l.getMaxVisibleItemsCount(),n.length),i=0;i<r;i++)a=n[i],s=l.createItem(a,i),t.GC$(u).append(s),l._items.push(s),l._itemsSet[l._exclusiveDataTexts.indexOf(a)]=s;return u}},r.prototype.createItem=function(e,o){var n=e,r=document.createElement("button");return t.GC$(r).css({"text-align":"left","white-space":"nowrap","margin-bottom":this._itemMargin*this._zoomFactor+"px",cursor:"default","box-sizing":"content-box","border-radius":5,padding:"1px 6px",overflow:"hidden","text-overflow":"ellipsis","background-color":"white"}).attr("type","button").attr("unselectable","on").text(n).addClass(this.ITEM_NAME+" "+this.NO_USER_SELECT),(o+1)%this._columnCount!=0&&t.GC$(r).css("margin-right",this._itemMargin*this._zoomFactor+"px"),this.adjustItemSize(r),r},r.prototype.getHeaderFontFactor=function(){var e,o,n,r=this._style;if(!r||(!(e=this.getMergedStyleInfo(r.wholeSlicerStyle,r.headerStyle))||!e.font))return 1;var i=e.font,a=1,s=t.StyleHelper.splitFont(t.StyleHelper.normalizeFont(m)).fontSize,l=t.StyleHelper.splitFont(t.StyleHelper.normalizeFont(i)).fontSize;return s&&l&&(o=parseFloat(s),n=parseFloat(l),isNaN(n)||(a=n/o)),a},r.prototype.getCaptionWidth=function(){var e=this,t=e._container,o=e._header,n=1,r=1,i=0,a=0;return e._container&&(n=e.stringStyle2Number(t.style.borderLeftWidth),r=e.stringStyle2Number(t.style.borderRightWidth)),e._header&&(i=e.stringStyle2Number(o.style.borderLeftWidth),a=e.stringStyle2Number(o.style.borderRightWidth)),e._width-(n+r)-2*e._containerPadding-(i+a)-e._clearFilterWidth},r.prototype.stringStyle2Number=function(e){return e?parseFloat(e):0},r.prototype.getItemsContainerHeight=function(){var e=this.getSizeOffset(this._container),t=this.height()-2*this._containerPadding-e.heightOffset;return this._showHeader?t-this._headerHeight*this.getHeaderFontFactor()-this._headerMarginBottom:t},r.prototype.getItemsContainerWidth=function(){var e=this.getSizeOffset(this._container),t=this.width()-2*this._containerPadding-e.widthOffset-1;return this.needShowScrollbar()?t-this._scrollbarWidth:t},r.prototype.getItemWidth=function(e){return(e-(this._columnCount-1)*this._itemMargin)/this._columnCount},r.prototype.getMaxVisibleItemsCount=function(){return Math.ceil(this._itemsContainerHeight/(this._itemHeight+2*(this._itemVerticalPadding+this._itemBorderWidth)+this._itemMargin))*this._columnCount},r.prototype.getSortedItems=function(){var e,o,n,r,i,a,s=this;if(!s._exclusiveDataTexts||0===s._exclusiveDataTexts.length)return[];if(e=s.orderBySortState(s._exclusiveDataTexts.slice(0),s._sortState),o=s.slicerData.getFilteredOutIndexes(this.columnName,2),s._showNoDataItems){if(s._visuallyNoDataItems&&s._showNoDataItemsInLast){for(n=[],i=0;i<e.length;i++)a=e[i],t.ArrayHelper.contains(o,s._exclusiveDataTexts.indexOf(a))||n.push(a);for(i=0;i<e.length;i++)a=e[i],t.ArrayHelper.contains(o,s._exclusiveDataTexts.indexOf(a))&&n.push(a);e=n}}else for(i=0,r=(n=e.concat()).length;i<r;i++)t.ArrayHelper.contains(o,s._exclusiveDataTexts.indexOf(n[i]))&&t.ArrayHelper.remove(e,n[i]);return t.ArrayHelper.contains(e,t.SR.Blank)&&(t.ArrayHelper.remove(e,t.SR.Blank),e.push(t.SR.Blank)),e},r.prototype.orderBySortState=function(t,o){var n,r,i=[];if(0!==o){for(n=e.Slicer.SortHelper.quickSort(t),r=0;r<n.length;r++)i[r]=n[r].value;return 2===o&&i.reverse(),i}},r.prototype.createScrollbar=function(){var e,o=this,n=new t.Scrollbar(!1);return o._scrollbarObj=n,e=n.getScrollbar(),t.GC$(e).bind("scroll.gcScrollbar",function(e,t){var n=t.scrollEventType,r=t.scrollOrientation;if(e.data=o,1===r)switch(n){case 0:case 1:case 2:case 3:case 5:o.doScroll(e,t)}}),e},r.prototype.needShowScrollbar=function(){var e=this,t=e._noDataItemIndexes,o=e._showNoDataItems?e._exclusiveDataTexts.length:e._exclusiveDataTexts.length-t.length;return Math.ceil(o/e._columnCount)*(e._itemHeight+2*(e._itemBorderWidth+e._itemVerticalPadding)+e._itemMargin)>e._itemsContainerHeight},r.prototype.doScroll=function(e,t){this.scrollTo(e,t)},r.prototype.scrollTo=function(e,t){var o=t.newValue;o===this._scrollbarValue||o>this._scrollbarObj.maximum()||(this._scrollbarValue=o,this.refreshScrollbar(),this.refreshItems())},r.prototype.getScrollbarObj=function(){return this._scrollbarObj},r.prototype.applyStyle=function(e){var t,o,n,r,i,a,s=this;if(e)for(i in e.wholeSlicerStyle&&(s.setStyleInfo(s._container,e.wholeSlicerStyle),s.adjustContainerSize()),t=s._headerBorderDiv,o=s.getMergedStyleInfo(e.wholeSlicerStyle,e.headerStyle),s.isDarwingInnerBorder(e)?(r=(n=o.borderBottom)&&n.borderWidth?n.borderWidth:0,t.style.height=(s._headerHeight-r)*s.getHeaderFontFactor()*s._zoomFactor+"px",s.setBorder(t,n,"borderBottom"),o.borderLeft=o.borderTop=o.borderRight=o.borderBottom=g):(t.style.borderBottomWidth="0px",t.style.height=s._header.style.height),s.setStyleInfo(s._header,o),s.adjustHeaderSize(),s._itemsSet)a=parseInt(i),s.refreshItemStyle(a)},r.prototype.isDarwingInnerBorder=function(e){var t,o=e.headerStyle;return!o||!(o.borderLeft||o.borderTop||o.borderRight||o.borderBottom)||!(!((t=this.getMergedStyleInfo(e.wholeSlicerStyle,o)).borderBottom&&t.borderBottom.borderWidth>0)||t.borderLeft&&0!==t.borderLeft.borderWidth||t.borderTop&&0!==t.borderTop.borderWidth||t.borderRight&&0!==t.borderRight.borderWidth)},r.prototype.setStyleInfo=function(e,o){var n;if(e&&o){var r=this,i=this.getTheme(),a=o.foreColor||"black",s=o.backColor||"white",l=o.font||m;o.textDecoration;e.style.backgroundColor=r.getNormalizeColor(s,i),e.style.color=r.getNormalizeColor(a,i),e.style.font=t.StyleHelper._scaleFont(l,r._zoomFactor).font,r.setBorder(e,o.borderLeft,"borderLeft"),r.setBorder(e,o.borderTop,"borderTop"),r.setBorder(e,o.borderRight,"borderRight"),r.setBorder(e,o.borderBottom,"borderBottom"),n=t.StyleHelper.composeTextDecoration(o.textDecoration),t.StringHelper.Contains(e.className,r.HEADER_NAME)?r._caption.style.textDecoration=n:t.StringHelper.Contains(e.className,r.ITEM_NAME)&&(e.style.textDecoration=n)}},r.prototype.getMergedStyleInfo=function(e,t){var o,n={};if(t)for(o in t)n[o]=t[o];if(e)for(o in e)n[o]===f&&e[o]!==f&&(n[o]=e[o]);return n},r.prototype.setBorder=function(e,t,o){if(e){var n=t&&t.borderWidth?t.borderWidth:0,r=t&&t.borderStyle?t.borderStyle:"",i=t&&t.borderColor?t.borderColor:"";e.style[o+"Width"]=n+"px",e.style[o+"Style"]=r,e.style[o+"Color"]=this.getNormalizeColor(i,this.getTheme())}},r.prototype.getTheme=function(){var e=this.slicerData,t=e.getSheet&&e.getSheet();return t&&t.currentTheme()},r.prototype.getNormalizeColor=function(e,t){if(!t)return e;var o;return e&&t&&t.getColor&&(o=t.getColor(e)),o},r.prototype.defaultStyle=function(){var e={borderWidth:1,borderStyle:"solid",borderColor:"#808080"},t={borderWidth:0,borderStyle:"",borderColor:""},o={borderWidth:1,borderStyle:"solid",borderColor:"#999999"},n={borderWidth:1,borderStyle:"solid",borderColor:"#CCCCCC"},r={borderWidth:1,borderStyle:"solid",borderColor:"#E0E0E0"},i={backColor:"#F9E36F",foreColor:"black",font:m,borderLeft:o,borderTop:o,borderRight:o,borderBottom:o};return{wholeSlicerStyle:{backColor:"white",foreColor:"black",font:m,borderLeft:e,borderTop:e,borderRight:e,borderBottom:e},headerStyle:{backColor:"white",foreColor:"black",font:"bold 11pt calibri",borderLeft:t,borderTop:t,borderRight:t,borderBottom:{borderWidth:1,borderStyle:"solid",borderColor:"#A6A6A6"}},selectedItemWithDataStyle:{backColor:"#BFBFBF",foreColor:"black",font:m,borderLeft:o,borderTop:o,borderRight:o,borderBottom:o},selectedItemWithNoDataStyle:{backColor:"#D9D9D9",foreColor:"black",font:m,borderLeft:n,borderTop:n,borderRight:n,borderBottom:n},unSelectedItemWithDataStyle:{backColor:"white",foreColor:"black",font:m,borderLeft:n,borderTop:n,borderRight:n,borderBottom:n},unSelectedItemWithNoDataStyle:{backColor:"white",foreColor:"#959595",font:m,borderLeft:r,borderTop:r,borderRight:r,borderBottom:r},hoveredSelectedItemWithDataStyle:i,hoveredSelectedItemWithNoDataStyle:i,hoveredUnSelectedItemWithDataStyle:i,hoveredUnSelectedItemWithNoDataStyle:i}},r.prototype.onFiltered=function(e){this._sortedItems=this.getSortedItems(),this._noDataItemIndexes=this.slicerData.getFilteredOutIndexes(this.columnName,2),this._unSelectedItemIndexes=this.slicerData.getFilteredOutIndexes(this.columnName,1),this.refresh()},r.prototype.onDataChanged=function(e){this.reset()},r.prototype.onRowsChanged=function(e,t,o){this.reset()},r.prototype.reset=function(){var e=this;e.data=e.slicerData.getData(e.columnName),e.exclusiveDatas=e.slicerData.getExclusiveData(e.columnName),e._dataTexts=e.getDataTexts(e.data),e._exclusiveDataTexts=e.getDataTexts(e.exclusiveDatas),e._sortedItems=e.getSortedItems(),e.refreshScrollbar(),e.refreshItems()},r.prototype.onColumnNameChanged=function(e,o){this.columnName===e&&this._caption&&(this.columnName=o,this._captionName=o,t.GC$(this._caption).text(o))},r.prototype.onColumnRemoved=function(e){e===this.columnName&&(this.slicerData.doUnfilter(e),this.detachEvents(),t.GC$(this._container).remove(),this._container=null)},r.prototype.refresh=function(e){var o,n=this;n._style;n._container&&(e!==f&&e!==n._zoomFactor&&(n._zoomFactor=e,n.applyStyle(n._style)),t.GC$(n._container).css({padding:6*n._zoomFactor}),n.adjustContainerSize(),n.refreshHeader(),o=n._showHeader?(n._headerHeight+n._headerMarginBottom-n._containerPadding)*n.getHeaderFontFactor()*n._zoomFactor:0,t.GC$(n._body).css("margin-top",o),n.refreshItemsContainer(),n.refreshScrollbar())},r.prototype.refreshHeader=function(){var e,o,n=this,r=(n._style,n._zoomFactor);n._showHeader?(n._container.firstChild!==n._header&&(t.GC$(n._header).insertBefore(n._body),t.GC$(n._body).css("margin-top",(n._headerHeight+n._headerMarginBottom)*n.getHeaderFontFactor()*r)),t.GC$(n._header).css("height",n._headerHeight*n.getHeaderFontFactor()*r),t.GC$(n._headerBorderDiv).css({left:n._containerPadding*r,right:n._containerPadding*r}),n._caption.innerHTML!==n._captionName&&t.GC$(n._caption).text(n._captionName),t.GC$(n._caption).css({top:n._captionTop*n.getHeaderFontFactor()*r,width:n.getCaptionWidth()*r,"font-weight":"bold"}),o=(e=n._unSelectedItemIndexes)&&e.length>0?1:0,n.changeClearFilterColor(o),t.GC$(n._clearFilter).css({width:n._clearFilterWidth*r,height:n._clearFilterHeight*r,top:n._clearFilterTop*n.getHeaderFontFactor()*r,right:n._clearFilterRight*r}),n.adjustHeaderSize()):t.GC$(n._header).remove()},r.prototype.refreshItemsContainer=function(){var e,o=this,n=o.getItemsContainerHeight();o._itemsContainerHeight=n,e=o.getItemsContainerWidth(),o._itemsContainerWidth=e,t.GC$(o._itemsContainer).css({width:e*o._zoomFactor,height:n*o._zoomFactor,"font-size":o._fontSize*o._zoomFactor}),o.refreshItems()},r.prototype.refreshItems=function(){var e,o,n,r,i=this,a=i._sortedItems;if(a){i._items&&i._items.length>0&&t.GC$(i._items).remove(),i._items=[],i._itemsSet={};var s=Math.min(i.getMaxVisibleItemsCount(),a.length),l=i.needShowScrollbar()?i._scrollbarObj.value()*i._columnCount:0,u=Math.min(l+s,a.length);for(e=l;e<u;e++)o=a[e],n=i.createItem(o,e),t.GC$(i._itemsContainer).append(n),i._items.push(n),i._itemsSet[i._exclusiveDataTexts.indexOf(o)]=n;if(0!==i._items.length)for(r in i._itemsSet)i.refreshItemStyle(parseInt(r))}},r.prototype.refreshItemStyle=function(e){var o=this._hitInfo?this._exclusiveDataTexts.indexOf(this._hitInfo.itemValue):-1,n=this._unSelectedItemIndexes,r=this._noDataItemIndexes,i=this._itemsSet[e],a=0;e===o&&(a|=1),a|=t.ArrayHelper.contains(n,e)?4:2,a|=t.ArrayHelper.contains(r,e)&&this._visuallyNoDataItems?16:8,this.changeItemStyle(i,a)},r.prototype.changeItemStyle=function(e,t){if(e&&this._style){var o=this,n=o._style;o.getTheme();switch(t){case 10:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.selectedItemWithDataStyle));break;case 18:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.selectedItemWithNoDataStyle));break;case 12:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.unSelectedItemWithDataStyle));break;case 20:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.unSelectedItemWithNoDataStyle));break;case 11:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.hoveredSelectedItemWithDataStyle));break;case 19:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.hoveredSelectedItemWithNoDataStyle));break;case 13:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.hoveredUnSelectedItemWithDataStyle));break;case 21:o.setStyleInfo(e,o.getMergedStyleInfo(n.wholeSlicerStyle,n.hoveredUnSelectedItemWithNoDataStyle))}o.adjustItemSize(e)}},r.prototype.adjustContainerSize=function(){var e=this.getSizeOffset(this._container);t.GC$(this._container).css({width:(this.width()-2*this._containerPadding)*this._zoomFactor-e.widthOffset,height:(this.height()-2*this._containerPadding)*this._zoomFactor-e.heightOffset})},r.prototype.adjustHeaderSize=function(){var e=this._zoomFactor,o=this.getSizeOffset(this._header),n=this._headerHeight*this.getHeaderFontFactor()*e-o.heightOffset;t.GC$(this._header).css("height",n),t.GC$(this._clearFilter).css({width:this._clearFilterWidth*e,height:this._clearFilterHeight*e})},r.prototype.adjustItemSize=function(e){var o=this.getSizeOffset(e);t.GC$(e).css({width:this.getItemWidth(this._itemsContainerWidth)*this._zoomFactor-2*this._itemHorizontalPadding-o.widthOffset,height:this._itemHeight*this._zoomFactor-o.heightOffset})},r.prototype.getSizeOffset=function(e){var t=0,o=0;if(e){var n=e.style,r=n.borderLeftWidth,i=n.borderTopWidth,a=n.borderRightWidth,s=n.borderBottomWidth;r&&(t+=parseFloat(r)),i&&(o+=parseFloat(i)),a&&(t+=parseFloat(a)),s&&(o+=parseFloat(s))}return{widthOffset:t,heightOffset:o}},r.prototype.refreshScrollbar=function(){var e,o,n=this;n.needShowScrollbar()?(n._scrollbar||(n._scrollbar=n.createScrollbar()),n._td2.firstChild!==n._scrollbar&&(t.GC$(n._td2).append(n._scrollbar),n.refreshItemsContainer()),e=Math.floor(n._itemsContainerHeight/(n._itemHeight+2*n._itemVerticalPadding+n._itemMargin)),(o=n._scrollbarObj).value(n._scrollbarValue),o.width(n._scrollbarWidth*n._zoomFactor),o.height(n._itemsContainerHeight*n._zoomFactor),o.minimum(0),o.maximum(Math.ceil(n._exclusiveDataTexts.length/n._columnCount)-e),o.pageValue(e),o.smallChange(1),o.largeChange(e-1),o.refreshLayout()):(n._td2.firstChild===n._scrollbar&&(n._scrollbar.parentElement&&n._scrollbar.parentElement.removeChild(n._scrollbar),n.refreshItemsContainer()),n._scrollbarValue=0)},r.prototype.attachEvents=function(){var e=this,o=t.GC$(e._container),n=".slicer";o&&(o.bind("mousedown"+n,function(t){e.doMouseDown(t)}).bind("mouseup"+n,function(t){e.doMouseUp(t)}).bind("mousemove"+n,function(t){e.doMouseMove(t)}).bind("mouseleave"+n,function(t){e.doMouseLeave(t)}),e._container.addEventListener("mousewheel",function(t){e.doMouseWheel(t)},!1),e._container.addEventListener("DOMMouseScroll",function(t){e.doMouseWheel(t)},!1),t.GC$(document).bind("mouseup"+n,function(t){e.doDocumentMouseUp(t)}).bind("keydown"+n,function(t){e.doKeyDown(t)}).bind("keyup"+n,function(t){e.doKeyUp(t)}),document.addEventListener("mousewheel",function(t){e.doMouseWheel(t)},!1),document.addEventListener("DOMMouseScroll",function(t){e.doMouseWheel(t)},!1))},r.prototype.detachEvents=function(){var e=this._container;e&&t.GC$(e).unbind(".slicer")},r.prototype.doMouseDown=function(e){var t=this,o=t.hitTest(e);o&&(8===o.mark&&(t._isMouseDownOnScrollbar=!0),5===o.mark&&(t._filteringItemIndexes=[],t._isMouseDownOnItem=!0,e.ctrlKey?t.mouseDownOnItemWithCtrl(o):e.shiftKey?t.mouseDownOnItemWithShift(o):t.mouseDownOnItemWithoutKeyDown(o)),t.preRefreshItemsStyle(t._selectingItemIndexes),(5===o.mark||6===o.mark||8===o.mark||4===o.mark&&t._isFiltered)&&e.stopPropagation())},r.prototype.mouseDownOnItemWithCtrl=function(e){var o,n,r,i=this,a=(i.slicerData,i.exclusiveDatas),s=i._unSelectedItemIndexes,l=i.getExclusiveRowIndex(e.itemValue),u=i._selectingItemIndexes;for(t.ArrayHelper.contains(u,l)?t.ArrayHelper.remove(u,l):u.push(l),n=0,r=a.length;n<r;n++)t.ArrayHelper.contains(s,n)||i._filteringItemIndexes.push(n);for(o=0;o<i._selectingItemIndexes.length;o++)t.ArrayHelper.contains(i._filteringItemIndexes,u[o])?t.ArrayHelper.remove(i._filteringItemIndexes,u[o]):i._filteringItemIndexes.push(u[o]);if(0===i._filteringItemIndexes.length)for(n=0,r=i._exclusiveDataTexts.length;n<r;n++)i._filteringItemIndexes.push(n);i._activeItemIndex=l},r.prototype.mouseDownOnItemWithShift=function(e){var t,o,n,r,i=this._sortedItems,a=this._exclusiveDataTexts[this._activeItemIndex];for(this.clearItemsStyle(),t=Math.min(i.indexOf(a),i.indexOf(e.itemValue)),o=Math.max(i.indexOf(a),i.indexOf(e.itemValue)),n=t;n<=o;n++)r=this._exclusiveDataTexts.indexOf(i[n]),-1===this._selectingItemIndexes.indexOf(r)&&this._selectingItemIndexes.push(r),-1===this._filteringItemIndexes.indexOf(r)&&this._filteringItemIndexes.push(r)},r.prototype.mouseDownOnItemWithoutKeyDown=function(e){var t;this.clearItemsStyle(),t=this.getExclusiveRowIndex(e.itemValue),this.refreshItemStyle(t),this._selectingItemIndexes.push(t),this._filteringItemIndexes.push(t),this._activeItemIndex=t},r.prototype.clearItemsStyle=function(){var e,o,n,r,i,a=this._items;if(a&&0!==a.length)for(e=this._noDataItemIndexes,o=0,n=a.length;o<n;o++)r=a[o],i=this._exclusiveDataTexts.indexOf(a[o].innerHTML),t.ArrayHelper.contains(e,i)?this.changeItemStyle(r,20):this.changeItemStyle(r,12)},r.prototype.getExclusiveRowIndex=function(e){var t,o,n=this._exclusiveDataTexts;if(!n||0===n.length)return-1;for(t=0,o=n.length;t<o;t++)if(n[t]===e)return t;return-1},r.prototype.doMouseUp=function(e){var t=this,o=t.hitTest(e);if(o){var n=t.slicerData,r=t._selectingItemIndexes,i=!1;4===o.mark?t._isFiltered&&(n.doUnfilter(t.columnName),t.changeClearFilterColor(0),i=!0):r&&r.length>0&&(t._isCtrlKeyDown||t._isShiftKeyDown||(n.doFilter(t.columnName,{exclusiveRowIndexes:t._filteringItemIndexes}),i=!0)),t._isMouseDownOnItem=!1,t._isMouseDownOnScrollbar=!1,i&&(t._selectingItemIndexes=[],t._filteringItemIndexes=[])}},r.prototype.preRefreshItemsStyle=function(e){this.slicerData;for(var o,n=this._unSelectedItemIndexes,r=this._noDataItemIndexes,i=0;i<e.length;i++)o=0,o|=this._isCtrlKeyDown?t.ArrayHelper.contains(n,e[i])?2:4:2,o|=t.ArrayHelper.contains(r,e[i])&&this._visuallyNoDataItems?16:8,this.changeItemStyle(this._itemsSet[e[i]],o)},r.prototype.doDocumentMouseUp=function(e){var t;this.doMouseUp(e),t=this._hitInfo?new o(this._hitInfo.mark,this._hitInfo.itemValue):g,this._hitInfo=null,this.clearOldHover(t)},r.prototype.changeClearFilterColor=function(e){var o=this;if(o._clearFilter){var n=o._style,r=o.getMergedStyleInfo(n.wholeSlicerStyle,n.headerStyle),i=r&&r.backColor;switch(i||(i="white"),o._clearFilterNormalBackColor=i,e){case 0:o._isFiltered=!1,t.GC$(o._clearFilter).css({color:o._clearFilterNonActivedForeColor,"background-color":i});break;case 1:o._isFiltered=!0,t.GC$(o._clearFilter).css({color:o._clearFilterActivedForeColor,"background-color":i});break;case 2:t.GC$(o._clearFilter).css({"background-color":o._clearFilterHoveredBackColor})}}},r.prototype.doMouseMove=function(e){var n,r,i,a,s,l,u,c=this,h=c._hitInfo?new o(c._hitInfo.mark,c._hitInfo.itemValue):null,p=c.hitTest(e);if(p&&(!h||h.mark!==p.mark||5===h.mark&&h.itemValue!==p.itemValue)){if(!c._isMouseDownOnItem)return c._hitInfo=p,c.clearOldHover(h),void c.setNewHover(p);if(5===p.mark)if(n=c._exclusiveDataTexts.indexOf(p.itemValue),r=c._noDataItemIndexes,t.ArrayHelper.contains(c._filteringItemIndexes,n)){var d=c._sortedItems,f=Math.min(d.indexOf(c._exclusiveDataTexts[c._activeItemIndex]),d.indexOf(p.itemValue)),g=Math.max(d.indexOf(c._exclusiveDataTexts[c._activeItemIndex]),d.indexOf(p.itemValue)),m=[];for(a=0,s=c._filteringItemIndexes.length;a<s;a++)i=c._filteringItemIndexes[a],(d.indexOf(c._exclusiveDataTexts[i])>g||d.indexOf(c._exclusiveDataTexts[i])<f)&&m.push(i);for(a=0,s=m.length;a<s;a++)l=m[a],u=c.getItemElement(c._exclusiveDataTexts[l]),t.ArrayHelper.contains(r,l)?c.changeItemStyle(u,20):c.changeItemStyle(u,12),t.ArrayHelper.remove(c._filteringItemIndexes,l)}else u=c.getItemElement(c._exclusiveDataTexts[n]),t.ArrayHelper.contains(r,n)?c.changeItemStyle(u,18):c.changeItemStyle(u,10),t.ArrayHelper.add(c._filteringItemIndexes,n);c._hitInfo=p}},r.prototype.doMouseLeave=function(e){var t=this._hitInfo?new o(this._hitInfo.mark,this._hitInfo.itemValue):g;this._hitInfo=g,this.clearOldHover(t)},r.prototype.doMouseWheel=function(e){return 8===this.hitTest(e).mark&&(e.stopPropagation(),!0)},r.prototype.clearOldHover=function(e){var o,n;if(e)switch(o=this,e.mark){case 4:if(!o._clearFilter)return;o._isFiltered?o.changeClearFilterColor(1):o.changeClearFilterColor(0);break;case 5:n=o._exclusiveDataTexts.indexOf(e.itemValue),o._selectingItemIndexes&&t.ArrayHelper.contains(o._selectingItemIndexes,n)?o.preRefreshItemsStyle(o._selectingItemIndexes):o.refreshItemStyle(n)}},r.prototype.setNewHover=function(e){var t;if(e)switch(this,e.mark){case 4:if(!this._clearFilter||!this._isFiltered)return;this.changeClearFilterColor(2);break;case 5:t=this._exclusiveDataTexts.indexOf(e.itemValue),this.refreshItemStyle(t);break;case 6:this._itemsContainer.style.cursor="default"}},r.prototype.getItemElement=function(e){var t,o,n,r=this._items;if(!r||0===r.length||null===e)return null;for(t=0,o=r.length;t<o;t++)if((n=r[t]).innerHTML.toLowerCase()===e.toLowerCase())return n;return null},r.prototype.doKeyDown=function(e){17!==e.keyCode||this._isCtrlKeyDown||(this._isCtrlKeyDown=!0),16!==e.keyCode||this._isShiftKeyDown||(this._isShiftKeyDown=!0)},r.prototype.doKeyUp=function(e){var t=this,o=t.slicerData;17===e.keyCode&&t._isCtrlKeyDown&&(t._isCtrlKeyDown=!1),16===e.keyCode&&t._isShiftKeyDown&&(t._isShiftKeyDown=!1),!t._isCtrlKeyDown&&!t._isShiftKeyDown&&t._selectingItemIndexes.length>0&&(o.doFilter(t.columnName,{exclusiveRowIndexes:t._filteringItemIndexes}),t._selectingItemIndexes=[],t._filteringItemIndexes=[])},r.prototype.hitTest=function(e){var t,n,r,i,a,s=this,l=s.getContainerRect(s._container),u=null,c=null;if(!l)return null;var h=e.pageX,p=e.pageY,d=s.getHeaderRect(l),f=s.getClearfilterRect(l),g=s.getBodyRect(l),m=s.getItemsContainerRect(l);if(d&&d.contains(h,p))u=f&&f.contains(h,p)?4:1;else if(g&&g.contains(h,p))if(t=s._items,m&&m.contains(h,p)&&t){for(n=0,r=t.length;n<r;n++)if((i=s.getItemRect(l,n))&&i.contains(h,p)){for(a in u=5,s._itemsSet)if(s._itemsSet[a]===t[n]){c=s._exclusiveDataTexts[a];break}break}n>=t.length&&(u=p<s.getItemRect(l,t.length-1).y+s._itemHeight*s._zoomFactor?6:7)}else u=8;else u=0;return new o(u,c)},r.prototype.getContainerRect=function(e){if(!e)return null;var o=e,n=0,r=0,i=o.offsetWidth,a=o.offsetHeight;do{n+=o.offsetLeft,r+=o.offsetTop}while(o=o.offsetParent);return new t.Rect(n,r,i,a)},r.prototype.getHeaderRect=function(e){var o,n,r,i,a;return e&&this._showHeader?(a=this._zoomFactor,o=e.x+this._containerBorderWidth*a,n=e.y+this._containerBorderWidth*a,r=this.width()*a,i=this._headerHeight*this.getHeaderFontFactor()*a,new t.Rect(o,n,r,i)):null},r.prototype.getClearfilterRect=function(e){var o,n,r,i,a,s=this;return e&&s._showHeader?(o=(s=this)._zoomFactor,n=e.x+e.width-(s._containerBorderWidth+s._containerPadding+s._clearFilterWidth)*o,r=e.y+s._containerBorderWidth+s._captionTop*s.getHeaderFontFactor()*o,i=s._clearFilterWidth,a=s._clearFilterHeight,new t.Rect(n,r,i*o,a*o)):null},r.prototype.getBodyRect=function(e){if(!e)return null;var o,n,r,i,a=this._zoomFactor,s=this._containerBorderWidth+this._containerPadding,l=this._headerHeight*this.getHeaderFontFactor()+this._headerMarginBottom;return o=e.x+s*a,n=e.y+0*a+(this.showHeader()?l*a:0),r=(this.width()-2*s)*a,i=e.height-0*a-(this.showHeader()?l*a:0),new t.Rect(o,n,r,i)},r.prototype.getItemsContainerRect=function(e){var o=this.getBodyRect(e);return o?this.needShowScrollbar()?new t.Rect(o.x,o.y,o.width-this._scrollbarWidth*this._zoomFactor,o.height):o:null},r.prototype.getItemRect=function(e,o){var n,r,i,a,s,l=this,u=l._exclusiveDataTexts;return!e||0===u.length||o>=u.length?null:(n=l.getItemsContainerRect(e))?(a=(n.width-(l._columnCount-2)*l._itemMargin*l._zoomFactor)/l._columnCount,s=l._itemHeight*l._zoomFactor+2*l._itemBorderWidth,r=n.x+o%l._columnCount*(a+l._itemMargin*l._zoomFactor),i=n.y+Math.floor(o/l._columnCount)*(s+l._itemMargin*l._zoomFactor),new t.Rect(r,i,a,s)):null},r}(e.Slicer.SlicerBase);t.ItemSlicer=_,o=function(){return function(e,t){this.mark=void 0===e?null:e,this.itemValue=void 0===t?null:t}}(),t.SlicerHitInfo=o,(h=t.SlicerItemState||(t.SlicerItemState={}))[h.HOVERED=1]="HOVERED",h[h.SELECTED=2]="SELECTED",h[h.UNSELECTED=4]="UNSELECTED",h[h.HASDATA=8]="HASDATA",h[h.NODATA=16]="NODATA",t.SlicerItemState,(p=t.SlicerClearFilterState||(t.SlicerClearFilterState={}))[p.NORMAL=0]="NORMAL",p[p.ACTIVE=1]="ACTIVE",p[p.HOVERED=2]="HOVERED",t.SlicerClearFilterState,(d=t.SlicerHitMark||(t.SlicerHitMark={}))[d.CONTAINER=0]="CONTAINER",d[d.H_SPACE=1]="H_SPACE",d[d.H_CAPTION=2]="H_CAPTION",d[d.H_SPLITLINE=3]="H_SPLITLINE",d[d.H_CLEARFILTER=4]="H_CLEARFILTER",d[d.B_ITEM=5]="B_ITEM",d[d.B_ITEMSPACER=6]="B_ITEMSPACER",d[d.B_TAIL=7]="B_TAIL",d[d.B_SCROLLBAR=8]="B_SCROLLBAR",t.SlicerHitMark,n=function(){function e(e,t,o,n,r,i,a,s){this._backColor=e,this._foreColor=t,this._font=o,this._borderLeft=n,this._borderTop=r,this._borderRight=i,this._borderBottom=a,this._textDecoration=s}return e.prototype.setBorders=function(e){this._borderLeft=this._borderTop=this._borderRight=this._borderBottom=e},e.prototype.backColor=function(e){return 0===arguments.length?this._backColor:(this._backColor=e,this)},e.prototype.foreColor=function(e){return 0===arguments.length?this._foreColor:(this._foreColor=e,this)},e.prototype.font=function(e){return 0===arguments.length?this._font:(this._font=e,this)},e.prototype.borderLeft=function(e){return 0===arguments.length?this._borderLeft:(this._borderLeft=e,this)},e.prototype.borderTop=function(e){return 0===arguments.length?this._borderTop:(this._borderTop=e,this)},e.prototype.borderRight=function(e){return 0===arguments.length?this._borderRight:(this._borderRight=e,this)},e.prototype.borderBottom=function(e){return 0===arguments.length?this._borderBottom:(this._borderBottom=e,this)},e.prototype.textDecoration=function(e){return 0===arguments.length?this._textDecoration:(this._textDecoration=e,this)},e.prototype.fromJSON=function(e){var o,n,i,a;e&&!t.GC$.isEmptyObject(e)&&(this,e.backColor!==f&&(this._backColor=e.backColor),e.foreColor!==f&&(this._foreColor=e.foreColor),e.font!==f&&(this._font=e.font),e.borderLeft!==f&&((o=new r).fromJSON(e.borderLeft),this._borderLeft=o),e.borderTop!==f&&((n=new r).fromJSON(e.borderTop),this._borderTop=n),e.borderRight!==f&&((i=new r).fromJSON(e.borderRight),this._borderRight=i),e.borderBottom!==f&&((a=new r).fromJSON(e.borderBottom),this._borderBottom=a),e.textDecoration!==f&&(this._textDecoration=e.textDecoration))},e.prototype.toJSON=function(){var e,o,n=this,r={backColor:n._backColor,foreColor:n._foreColor,font:t.StyleHelper.normalizeFont(n._font),borderLeft:n._borderLeft&&n._borderLeft.toJSON(),borderTop:n._borderTop&&n._borderTop.toJSON(),borderRight:n._borderRight&&n._borderRight.toJSON(),borderBottom:n._borderBottom&&n._borderBottom.toJSON(),textDecoration:n._textDecoration},i={};for(e in r)(o=r[e])===f||o===g||"object"==typeof o&&t.GC$.isEmptyObject(o)||(i[e]=o);return i},e}(),t.SlicerStyleInfo=n,r=function(){function e(e,t,o){this._borderWidth=e,this._borderStyle=t,this._borderColor=o}return e.prototype.borderWidth=function(e){return 0===arguments.length?this._borderWidth:("number"==typeof e&&e>0&&e!==this._borderWidth&&(this._borderWidth=e),this)},e.prototype.borderStyle=function(e){return 0===arguments.length?this._borderStyle:("string"==typeof e&&e!==this._borderStyle&&(this._borderStyle=e),this)},e.prototype.borderColor=function(e){return 0===arguments.length?this._borderColor:("string"==typeof e&&e!==this._borderColor&&(this._borderColor=e),this)},e.prototype.fromJSON=function(e,o){if(e&&!t.GC$.isEmptyObject(e)){e.borderWidth!==f&&(this._borderWidth=e.borderWidth),e.borderStyle!==f&&(this._borderStyle=e.borderStyle),e.borderColor!==f&&(this._borderColor=e.borderColor)}},e.prototype.toJSON=function(){var e={borderWidth:this._borderWidth,borderStyle:this._borderStyle,borderColor:this._borderColor},t={};for(var o in e)e[o]!==f&&e[o]!==g&&(t[o]=e[o]);return t},e}(),t.SlicerBorder=r,i=function(){function e(){this.name(""),this._wholeSlicerStyle=this.createDefaultStyleInfo()}return e.prototype.createDefaultStyleInfo=function(){var e=new r(0,"",""),t=new n("white","black",m);return t.setBorders(e),t},e.prototype.name=function(e){return 0===arguments.length?this._name:(e!==f&&e!==g&&this._name!==e&&(this._name=e),this)},e.prototype.wholeSlicerStyle=function(e){return 0===arguments.length?this._wholeSlicerStyle:(e&&this._wholeSlicerStyle!==e&&(this._wholeSlicerStyle=e),this)},e.prototype.headerStyle=function(e){return 0===arguments.length?this._headerStyle:(e&&this._headerStyle!==e&&(this._headerStyle=e),this)},e.prototype.selectedItemWithDataStyle=function(e){return 0===arguments.length?this._selectedItemWithDataStyle:(e&&this._selectedItemWithDataStyle!==e&&(this._selectedItemWithDataStyle=e),this)},e.prototype.selectedItemWithNoDataStyle=function(e){return 0===arguments.length?this._selectedItemWithNoDataStyle:(e&&this._selectedItemWithNoDataStyle!==e&&(this._selectedItemWithNoDataStyle=e),this)},e.prototype.unSelectedItemWithDataStyle=function(e){return 0===arguments.length?this._unSelectedItemWithDataStyle:(e&&this._unSelectedItemWithDataStyle!==e&&(this._unSelectedItemWithDataStyle=e),this)},e.prototype.unSelectedItemWithNoDataStyle=function(e){return 0===arguments.length?this._unSelectedItemWithNoDataStyle:(e&&this._unSelectedItemWithNoDataStyle!==e&&(this._unSelectedItemWithNoDataStyle=e),this)},e.prototype.hoveredSelectedItemWithDataStyle=function(e){return 0===arguments.length?this._hoveredSelectedItemWithDataStyle:(e&&this._hoveredSelectedItemWithDataStyle!==e&&(this._hoveredSelectedItemWithDataStyle=e),this)},e.prototype.hoveredSelectedItemWithNoDataStyle=function(e){return 0===arguments.length?this._hoveredSelectedItemWithNoDataStyle:(e&&this._hoveredSelectedItemWithNoDataStyle!==e&&(this._hoveredSelectedItemWithNoDataStyle=e),this)},e.prototype.hoveredUnSelectedItemWithDataStyle=function(e){return 0===arguments.length?this._hoveredUnSelectedItemWithDataStyle:(e&&this._hoveredUnSelectedItemWithDataStyle!==e&&(this._hoveredUnSelectedItemWithDataStyle=e),this)},e.prototype.hoveredUnSelectedItemWithNoDataStyle=function(e){return 0===arguments.length?this._hoveredUnSelectedItemWithNoDataStyle:(e&&this._hoveredUnSelectedItemWithNoDataStyle!==e&&(this._hoveredUnSelectedItemWithNoDataStyle=e),this)},e.prototype.fromJSON=function(e){var o,r,i,s;if(e&&!t.GC$.isEmptyObject(e)){if(o=this,e.name!==f&&(o._name=e.name,o.isBuildinStyle(o._name)))return r=o._name.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),i=a[r](),o.wholeSlicerStyle(i.wholeSlicerStyle()),o.headerStyle(i.headerStyle()),o.selectedItemWithDataStyle(i.selectedItemWithDataStyle()),o.selectedItemWithNoDataStyle(i.selectedItemWithNoDataStyle()),o.unSelectedItemWithDataStyle(i.unSelectedItemWithDataStyle()),o.unSelectedItemWithNoDataStyle(i.unSelectedItemWithNoDataStyle()),o.hoveredSelectedItemWithDataStyle(i.hoveredSelectedItemWithDataStyle()),o.hoveredSelectedItemWithNoDataStyle(i.hoveredSelectedItemWithNoDataStyle()),o.hoveredUnSelectedItemWithDataStyle(i.hoveredUnSelectedItemWithDataStyle()),void o.hoveredSelectedItemWithNoDataStyle(i.hoveredSelectedItemWithNoDataStyle());e.wholeSlicerStyle!==f&&((s=new n).fromJSON(e.wholeSlicerStyle),o._wholeSlicerStyle=s),e.headerStyle!==f&&((s=new n).fromJSON(e.headerStyle),o._headerStyle=s),e.selectedItemWithDataStyle!==f&&((s=new n).fromJSON(e.selectedItemWithDataStyle),o._selectedItemWithDataStyle=s),e.selectedItemWithNoDataStyle!==f&&((s=new n).fromJSON(e.selectedItemWithNoDataStyle),o._selectedItemWithNoDataStyle=s),e.unSelectedItemWithDataStyle!==f&&((s=new n).fromJSON(e.unSelectedItemWithDataStyle),o._unSelectedItemWithDataStyle=s),e.unSelectedItemWithNoDataStyle!==f&&((s=new n).fromJSON(e.unSelectedItemWithNoDataStyle),o._unSelectedItemWithNoDataStyle=s),e.hoveredSelectedItemWithDataStyle!==f&&((s=new n).fromJSON(e.hoveredSelectedItemWithDataStyle),o._hoveredSelectedItemWithDataStyle=s),e.hoveredSelectedItemWithNoDataStyle!==f&&((s=new n).fromJSON(e.hoveredSelectedItemWithNoDataStyle),o._hoveredSelectedItemWithNoDataStyle=s),e.hoveredUnSelectedItemWithDataStyle!==f&&((s=new n).fromJSON(e.hoveredUnSelectedItemWithDataStyle),o._hoveredUnSelectedItemWithDataStyle=s),e.hoveredUnSelectedItemWithNoDataStyle!==f&&((s=new n).fromJSON(e.hoveredUnSelectedItemWithNoDataStyle),o._hoveredUnSelectedItemWithNoDataStyle=s)}},e.prototype.toJSON=function(){var e,o,n;for(n in o={},e=this.isBuildinStyle(this._name)?{name:this._name}:this.toJSONInternal())e[n]===g||e[n]===f||t.GC$.isEmptyObject(e[n])||(o[n]=e[n]);return o},e.prototype.toJSONInternal=function(){var e=this;return{name:e._name,wholeSlicerStyle:e._wholeSlicerStyle?e._wholeSlicerStyle.toJSON():g,headerStyle:e._headerStyle?e._headerStyle.toJSON():g,selectedItemWithDataStyle:e._selectedItemWithDataStyle?e._selectedItemWithDataStyle.toJSON():g,selectedItemWithNoDataStyle:e._selectedItemWithNoDataStyle?e._selectedItemWithNoDataStyle.toJSON():g,unSelectedItemWithDataStyle:e._unSelectedItemWithDataStyle?e._unSelectedItemWithDataStyle.toJSON():g,unSelectedItemWithNoDataStyle:e._unSelectedItemWithNoDataStyle?e._unSelectedItemWithNoDataStyle.toJSON():g,hoveredSelectedItemWithDataStyle:e._hoveredSelectedItemWithDataStyle?e._hoveredSelectedItemWithDataStyle.toJSON():g,hoveredSelectedItemWithNoDataStyle:e._hoveredSelectedItemWithNoDataStyle?e._hoveredSelectedItemWithNoDataStyle.toJSON():g,hoveredUnSelectedItemWithDataStyle:e._hoveredUnSelectedItemWithDataStyle?e._hoveredUnSelectedItemWithDataStyle.toJSON():g,hoveredUnSelectedItemWithNoDataStyle:e._hoveredUnSelectedItemWithNoDataStyle?e._hoveredUnSelectedItemWithNoDataStyle.toJSON():g}},e.prototype.isBuildinStyle=function(e){return t.ArrayHelper.contains(["SlicerStyleLight1","SlicerStyleLight2","SlicerStyleLight3","SlicerStyleLight4","SlicerStyleLight5","SlicerStyleLight6","SlicerStyleDark1","SlicerStyleDark2","SlicerStyleDark3","SlicerStyleDark4","SlicerStyleDark5","SlicerStyleDark6","SlicerStyleOther1","SlicerStyleOther2"],e)},e}(),t.SlicerStyle=i,a=function(){function e(){}return e.light1=function(){return e.createLightStyle(1)},e.light2=function(){return e.createLightStyle(2)},e.light3=function(){return e.createLightStyle(3)},e.light4=function(){return e.createLightStyle(4)},e.light5=function(){return e.createLightStyle(5)},e.light6=function(){return e.createLightStyle(6)},e.createLightStyle=function(e){var t,o,a,s,l,u,c=new i,h="Accent "+e,p="SlicerStyleLight"+e;c.name(p),(t=new n).backColor("white"),t.font(m),t.setBorders(new r(1,"solid",h)),c.wholeSlicerStyle(t);var d=new n,f=new r(0,"",""),g=new r(1,"solid",h);return d.borderLeft(f).borderTop(f).borderRight(f).borderBottom(g),c.headerStyle(d),(o=new n).foreColor("black"),o.backColor(h+",Lighter 60%"),o.setBorders(new r(1,"solid","#999999")),c.selectedItemWithDataStyle(o),(a=new n).foreColor("#828282"),a.backColor(h+",Lighter 80%"),a.setBorders(new r(1,"solid","#CCCCCC")),c.selectedItemWithNoDataStyle(a),(s=new n).foreColor("black"),s.backColor("white"),s.setBorders(new r(1,"solid","#CCCCCC")),c.unSelectedItemWithDataStyle(s),(l=new n).foreColor("#828282"),l.backColor("white"),l.setBorders(new r(1,"solid","#E0E0E0")),c.unSelectedItemWithNoDataStyle(l),(u=new n).foreColor("black"),u.backColor("#F9E36F"),u.setBorders(new r(1,"solid","#999999")),c.hoveredSelectedItemWithDataStyle(u),c.hoveredSelectedItemWithNoDataStyle(u),c.hoveredUnSelectedItemWithDataStyle(u),c.hoveredUnSelectedItemWithNoDataStyle(u),c},e.dark1=function(){return e.createDarkStyle(1)},e.dark2=function(){return e.createDarkStyle(2)},e.dark3=function(){return e.createDarkStyle(3)},e.dark4=function(){return e.createDarkStyle(4)},e.dark5=function(){return e.createDarkStyle(5)},e.dark6=function(){return e.createDarkStyle(6)},e.createDarkStyle=function(e){var t,o,a,s,l,u,c=new i,h="Accent "+e,p="SlicerStyleDark"+e;c.name(p),(t=new n).backColor("white"),t.font(m),t.setBorders(new r(1,"solid",h)),c.wholeSlicerStyle(t);var d=new n,f=new r(0,"",""),g=new r(1,"solid",h);return d.borderLeft(f).borderTop(f).borderRight(f).borderBottom(g),c.headerStyle(d),(o=new n).foreColor("white"),o.backColor(h),o.setBorders(new r(1,"solid",h)),c.selectedItemWithDataStyle(o),(a=new n).foreColor(h+",Darker 25%"),a.backColor(h+",Lighter 60%"),a.setBorders(new r(1,"solid",h+",Lighter 60%")),c.selectedItemWithNoDataStyle(a),(s=new n).foreColor("black"),s.backColor("#C0C0C0"),s.setBorders(new r(1,"solid","#C0C0C0")),c.unSelectedItemWithDataStyle(s),(l=new n).foreColor("#959595"),l.backColor("#DFDFDF"),l.setBorders(new r(1,"solid","#DFDFDF")),c.unSelectedItemWithNoDataStyle(l),(u=new n).foreColor("black"),u.backColor("#F9E36F"),u.setBorders(new r(1,"solid","#999999")),c.hoveredSelectedItemWithDataStyle(u),c.hoveredSelectedItemWithNoDataStyle(u),c.hoveredUnSelectedItemWithDataStyle(u),c.hoveredUnSelectedItemWithNoDataStyle(u),c},e.other1=function(){var e,t,o,a,s,l,u=new i;u.name("SlicerStyleOther1"),(e=new n).backColor("white"),e.font(m),e.setBorders(new r(1,"solid","#808080")),u.wholeSlicerStyle(e);var c=new n,h=new r(0,"",""),p=new r(1,"solid","#A6A6A6");return c.borderLeft(h).borderTop(h).borderRight(h).borderBottom(p),u.headerStyle(c),(t=new n).foreColor("black"),t.backColor("#BFBFBF"),t.setBorders(new r(1,"solid","#999999")),u.selectedItemWithDataStyle(t),(o=new n).foreColor("black"),o.backColor("#D9D9D9"),o.setBorders(new r(1,"solid","#CCCCCC")),u.selectedItemWithNoDataStyle(o),(a=new n).foreColor("black"),a.backColor("white"),a.setBorders(new r(1,"solid","#CCCCCC")),u.unSelectedItemWithDataStyle(a),(s=new n).foreColor("#959595"),s.backColor("white"),s.setBorders(new r(1,"solid","#E0E0E0")),u.unSelectedItemWithNoDataStyle(s),(l=new n).foreColor("black"),l.backColor("#F9E36F"),l.setBorders(new r(1,"solid","#999999")),u.hoveredSelectedItemWithDataStyle(l),u.hoveredSelectedItemWithNoDataStyle(l),u.hoveredUnSelectedItemWithDataStyle(l),u.hoveredUnSelectedItemWithNoDataStyle(l),u},e.other2=function(){var e,t,o,a,s,l,u=new i;u.name("SlicerStyleOther2"),(e=new n).backColor("white"),e.font(m),e.setBorders(new r(1,"solid","#4F81BD")),u.wholeSlicerStyle(e);var c=new n,h=new r(0,"",""),p=new r(1,"solid","#4F81BD");return c.borderLeft(h).borderTop(h).borderRight(h).borderBottom(p),u.headerStyle(c),(t=new n).foreColor("black"),t.backColor("#A9C1E3"),t.setBorders(new r(1,"solid","#999999")),u.selectedItemWithDataStyle(t),(o=new n).foreColor("#828282"),o.backColor("#D5E2F6"),o.setBorders(new r(1,"solid","#CCCCCC")),u.selectedItemWithNoDataStyle(o),(a=new n).foreColor("black"),a.backColor("white"),a.setBorders(new r(1,"solid","#CCCCCC")),u.unSelectedItemWithDataStyle(a),(s=new n).foreColor("#828282"),s.backColor("white"),s.setBorders(new r(1,"solid","#E0E0E0")),u.unSelectedItemWithNoDataStyle(s),(l=new n).foreColor("black"),l.backColor("#F9E36F"),l.setBorders(new r(1,"solid","#999999")),u.hoveredSelectedItemWithDataStyle(l),u.hoveredSelectedItemWithNoDataStyle(l),u.hoveredUnSelectedItemWithDataStyle(l),u.hoveredUnSelectedItemWithNoDataStyle(l),u},e}(),t.SlicerStyles=a,s=function(){function o(t){this._listeners=[];var o=this,n=[],r=[],i=t._getSheet(),a=t.rowFilter();o._sheet=i,o._table=t,o._rowFilter=a,o.setDataSource(n,r),o._generalSlicerData=new e.Slicer.GeneralSlicerData(n,r),o.initFilterInfo(),a.filterHandler=function(e){o.onFilteredByTable(e)}}return o.prototype.setDataSource=function(e,t){for(var o,n,r,i=this._table,a=i._getSheet(),s=i.dataRange(),l=s.row+s.rowCount-1,u=s.col+s.colCount-1,c=s.row;c<=l;c++)for(o=[],e.push(o),n=s.col;n<=u;n++)o.push({value:a.getValue(c,n),text:a.getText(c,n)});for(n=0;n<s.colCount;n++)r=i.getColumnName(n)||"",t.push(r)},o.prototype.initFilterInfo=function(){var e,t,o=this._sheet,n=this._table,r=(n.dataRange(),n.rowFilter());for(o.isPaintSuspended(!0),e=r&&r.filteredColumns||[],t=0;t<e.length;t++)this.onFilteredByTable({column:e[t]});o.isPaintSuspended(!1)},o.prototype.onFilteredByTable=function(e){var o,n,r,i,a,s,l,u=e.column-this._table.range().col,c=this._table.dataRange(),h=u+c.col,p=this._generalSlicerData.columnNames[u],d=[],f={};if(t.ArrayHelper.contains(this._rowFilter.filteredColumns,h)){for(o=[],n=c.row;n<c.row+c.rowCount;n++)if(r=this._rowFilter.filteredInRowsWithColIndexs[n])for(l=0;l<r.length;l++)if(r[l]===h){o.push(n);break}for(l=0;l<o.length;l++)i=o[l]-c.row,f[a=this.getExclusiveRowIndex(p,i)]||(f[a]=!0,d.push(a))}else for(s=this.getExclusiveData(p).length,l=0;l<s;l++)d.push(l);t.ArrayHelper.isEquals(this.getFilteredExclusiveRowIndexesBySelf(p),d)||(this._generalSlicerData.doFilter(p,{exclusiveRowIndexes:d}),this.onFiltered(this._generalSlicerData.getFilteredRowIndexes(),!1),this._sheet.invalidate())},o.prototype.getFilteredExclusiveRowIndexesBySelf=function(e){for(var o=this.getExclusiveData(e),n=this.getFilteredOutIndexes(e,1),r=[],i=0,a=o.length;i<a;i++)t.ArrayHelper.contains(n,i)&&r.push(i);return r},o.prototype.getTable=function(){return this._table},o.prototype.getSheet=function(){return this._sheet},o.prototype.getColumnIndex=function(e){return this._generalSlicerData.getColumnIndex(e)},o.prototype.getGeneralSlicerData=function(){return this._generalSlicerData},o.prototype.getData=function(e,t){return this._generalSlicerData.getData(e,t)},o.prototype.getExclusiveData=function(e){return this._generalSlicerData.getExclusiveData(e)},o.prototype.getRowIndexes=function(e,t){return this._generalSlicerData.getRowIndexes(e,t)},o.prototype.getExclusiveRowIndex=function(e,t){return this._generalSlicerData.getExclusiveRowIndex(e,t)},o.prototype.getFilteredIndexes=function(e){return this._generalSlicerData.getFilteredIndexes(e)},o.prototype.getFilteredRanges=function(e){return this._generalSlicerData.getFilteredRanges(e)},o.prototype.getFilteredOutRanges=function(e){return this._generalSlicerData.getFilteredOutRanges(e)},o.prototype.getFilteredOutIndexes=function(e,t){return this._generalSlicerData.getFilteredOutIndexes(e,t)},o.prototype.attachListener=function(e){this._listeners.push(e)},o.prototype.detachListener=function(e){for(var t=0;t<this._listeners.length;t++)if(this._listeners[t]===e){this._listeners.splice(t,1);break}},o.prototype.getListeners=function(){return this._listeners},o.prototype.doFilter=function(e,o,n){var r,i,a,s,l,u,c,h,p,d,f,g,m,_,y,C,w=this,v=w._generalSlicerData,S=v.getColumnIndex(e);if(!(S<0)&&(o.exclusiveRowIndexes||o.ranges))if(n)v.doFilter(e,o,n),w.onFiltered(v.getFilteredRowIndexes(),!0);else{if(r=o.exclusiveRowIndexes?w.getExclusiveData(e):w.getData(e),o.exclusiveRowIndexes)i=o.exclusiveRowIndexes;else{i=[];v.data;var x=v.getSortedColumnDataCache(),R=v.getSorted2DataMapping();for(x[S]||v.sortOneCol(S),a=x[S],s=0;s<o.ranges.length;s++)for(l=o.ranges[s],_=(u=v._getStartEndIndex(a,l)).start;_<=u.end;_++)i.push(R[S][_])}for((c=w._sheet.isPaintSuspended())||w._sheet.isPaintSuspended(!0),h=w._table.startColumn()+S,p=w._table.dataRange().row,w._rowFilter.removeFilterItemsInternal(h),w._rowFilter._unfilterColumn(h),w._sheet.refreshObjectsAboveSheet(),d=[],_=0;_<i.length;_++)f=new t.TextCondition(0,r[i[_]]),w._rowFilter.addFilterItem(h,f),d.push(f);for(w._generalSlicerData.doFilter(e,o),g=[],m={},w._generalSlicerData.getFilteredExclusiveIndexes(e,g,m),_=0;_<i.length;_++)if(m[o.exclusiveRowIndexes?i[_]:w.getExclusiveRowIndex(e,i[_])])if(w._rowFilter._addFilteredItem(d[_]),o.exclusiveRowIndexes)for(y=w.getRowIndexes(e,i[_]),C=0;C<y.length;C++)w._rowFilter._addFilteredInRowsWithColumnIndex(y[C]+p,h);else w._rowFilter._addFilteredInRowsWithColumnIndex(i[_]+p,h);w._rowFilter._setColumnFilteredState(h,!0),w._rowFilter.onFilter(w._rowFilter.getFilterArgs(0,h)),w.onFiltered(w._generalSlicerData.getFilteredRowIndexes(),!1),w._sheet.invalidateLayout(),c||w._sheet.isPaintSuspended(!1)}},o.prototype.clearPreview=function(){var e=this._generalSlicerData;this._generalSlicerData.clearPreview(),this.onFiltered(e.getFilteredRowIndexes(),e.inPreview())},o.prototype.onFiltered=function(e,t){for(var o=0;o<this._listeners.length;o++)this._listeners[o].onFiltered&&this._listeners[o].onFiltered({rowIndexes:e,isPreview:t})},o.prototype.doUnfilter=function(e){var t,o,n,r=this;r._generalSlicerData.inPreview()&&r.clearPreview(),t=r._generalSlicerData.getColumnIndex(e),o=r._rowFilter,-1!==t&&(n=r._table.startColumn()+t,r._table.dataRange().row,o.removeFilterItems(n),r._generalSlicerData.doUnfilter(e),o._unfilterColumn(n),o._setColumnFilteredState(n,!1),o.onFilter(o.getFilterArgs(0,n)),r.onFiltered(r._generalSlicerData.getFilteredRowIndexes(),!1),r._sheet.invalidateLayout(),r._sheet.repaint())},o.prototype.refresh=function(){var e,t,o,n=[],r=[];for(this.setDataSource(n,r),this._generalSlicerData.setDataSource(n,r),e=0,t=this._listeners.length;e<t;e++)(o=this._listeners[e]).reset&&o.reset()},o.prototype.onDataChanged=function(t,o,n){var r,i,a,s,l=this._generalSlicerData;if(l)for(r=[new e.Slicer.SlicerDataItem(l.columnNames[o],t,n.text)],l.changeData(r),this,a=0,s=(i=this._listeners||[]).length;a<s;a++)i[a].onDataChanged&&i[a].onDataChanged(r)},o.prototype.onColumnNameChanged=function(e,t){var o,n,r,i,a;if(this._generalSlicerData){if(this._generalSlicerData.changeColumnName(e,t),(o=this._sheet._slicerCollection.getSlicers(this._table.tableName(),e))&&o.length>0)for(n=0;n<o.length;n++)o[n].columnName(t);for(i=0,a=(r=this._listeners||[]).length;i<a;i++)r[i].onColumnNameChanged&&r[i].onColumnNameChanged(e,t)}},o.prototype.onRowsAdded=function(e,t){var o,n,r,i,a,s,l=this._sheet,u=this._table.dataRange(),c=this._generalSlicerData;for(c&&c.addRows(e,t),o=c.columnNames,n=c.data,a=e;a<e+t;a++)for(r=0;r<o.length;r++)n[a][r]={value:l.getValue(u.row+a,u.col+r),text:l.getText(u.row+a,u.col+r)};for(this._generalSlicerData.setDataSource(n,o),a=0,s=(i=this._listeners||[]).length;a<s;a++)i[a].onRowsChanged&&i[a].onRowsChanged(e,t,!0)},o.prototype.onRowsDeleted=function(e,t){var o,n,r,i=this._generalSlicerData;if(i)for(i.removeRowsCore(e,t,!1),this,n=0,r=(o=this._listeners||[]).length;n<r;n++)o[n].onRowsChanged&&o[n].onRowsChanged(e,t,!1)},o.prototype.onColumnsAdded=function(e,t){var o,n,r,i,a,s=this._sheet,l=this._table.dataRange();if(this._generalSlicerData){for(o=this._generalSlicerData.data,n=this._generalSlicerData.columnNames,i=0;i<o.length;i++)for(r=e;r<e+t;r++)o[i].splice(r,0,{value:s.getValue(l.row+i,l.col+r),text:s.getText(l.row+i,l.col+r)});for(i=e;i<e+t;i++)a=this._table.getColumnName(i)||"",n.splice(i,0,a);this._generalSlicerData.setDataSource(o,n)}},o.prototype.onColumnsDeleted=function(e,t){var o,n,r,i,a=this._generalSlicerData;if(a){var s=a.data,l=a.columnNames,u=(s.concat(),l.concat()),c=[];for(n=e;n<e+t;n++)c.push(l[n]);for(this._generalSlicerData.removeColumns(e,t),o=this._listeners||[],n=0;n<c.length;n++)for(i=0;i<o.length;i++)o[i].onColumnRemoved&&o[i].onColumnRemoved(c[n]);var h=this._sheet,p=this._table,d=h&&h._slicerCollection;for(n=e;n<e+t;n++)for(r=d.getSlicers(p.name(),u[n]),i=0;i<r.length;i++)d.removeSlicer(r[i])}},o.prototype.onTableRemoved=function(e){var t,o,n;if(e&&e===this._table){this._savedSlicers=[];var r=this._sheet,i=r._slicerCollection,a=(this._listeners,this._generalSlicerData.columnNames),s=e.name();for(t=0;t<a.length;t++)for(o=i.getSlicers(s,a[t]),n=0;n<o.length;n++)this._savedSlicers.push(o[n]),r.removeSlicer(o[n].name());i&&i.removeSlicerData(this),this._listeners=[]}},o.prototype.onTableAdded=function(e){var t,o,n=this._sheet,r=n._slicerCollection;for(r&&e&&e.hasSlicerData()&&r.addSlicerData(e.getSlicerData()),t=this._savedSlicers||[],o=0;o<t.length;o++)n.addSlicerInternal(t[o])},o}(),t.TableSlicerData=s,l=function(o){function n(e){o.call(this,e),this._isSelected=!1}return __extends(n,o),n.prototype.isSelected=function(e){return 0===arguments.length?this._isSelected:(e!==this._isSelected&&(this._isSelected=e),this)},n.prototype.sheet=function(e){return 0===arguments.length?this._sheet:(e!==this._sheet&&(this._sheet=e),this)},n.prototype.slicer=function(e){return 0===arguments.length?this._slicer:(e!==this._slicer&&(this._slicer=e),this)},n.prototype.onDataLoaded=function(){var e;this.slicerData&&this.slicerData instanceof s&&(e=this.slicerData,this._sheet=e.getSheet(),this._table=e.getTable()),o.prototype.onDataLoaded.call(this)},n.prototype.onColumnRemoved=function(e){var t,o;e===this.columnName&&(0!==this.slicerData.getFilteredOutIndexes(e,1).length&&this.slicerData.doUnfilter(e),t=this._sheet,o=this._table,t&&o&&t._removeFloatingObjectInternal(this.name()))},n.prototype.orderBySortState=function(t,o){var n,r,i,a,s,l=this._sheet,u=this.slicerData.getColumnIndex(this.columnName),c=this._table.dataRange(),h=[];if(0===o)return t;for(n=[],r=0;r<t.length;r++)i=this.slicerData.getRowIndexes(this.columnName,r),n.push(l.getValue(c.row+i[0],c.col+u));for(a=e.Slicer.SortHelper.quickSort(n),s=0;s<a.length;s++)h[s]=t[a[s].index];return 2===o&&h.reverse(),h},n.prototype.doMouseDown=function(e){var t,n,r,i,a=this._sheet,s=this._slicer;if(s&&a.canEditFloatingObject(s)){if(t=this.hitTest(e),!this.canDoFilter()&&(5===t.mark||6===t.mark||8===t.mark))return void e.stopPropagation();for(r=0,i=(n=s.getTableItemSlicers()).length;r<i;r++)o.prototype.doMouseDown.call(n[r],e)}},n.prototype.canDoFilter=function(){var e=this._table,t=this._sheet,o=e&&e.rowFilter();return!t.isProtected||o&&o.canDoFilter()},n.prototype.doMouseUp=function(e){var o,n,r,i,a,s,l,u=this,c=u._sheet,h=u._slicer;if(h&&c.canEditFloatingObject(h)&&u.canDoFilter()&&(o=u.hitTest(e))){var p=u.slicerData,d=u._selectingItemIndexes,f=u._filteringItemIndexes,g=p.getExclusiveData(u.columnName),m=!1;for(4!==o.mark&&(5!==o.mark||f.length!==g.length||u._isCtrlKeyDown||u._isShiftKeyDown)?d&&d.length>0&&(u._isCtrlKeyDown||u._isShiftKeyDown||(r=p.getFilteredIndexes(u.columnName),i=f.concat(),c._doCommand(new t.UndoRedo.SlicerDataFilterUndoAction(c,p,u.columnName,r,i)),m=!0)):(n=p.getFilteredIndexes(u.columnName),c._doCommand(new t.UndoRedo.SlicerDataUnFilterUndoAction(c,p,u.columnName,n)),m=!0),s=0,l=(a=h.getTableItemSlicers()).length;s<l;s++)a[s]._isMouseDownOnItem=!1,a[s]._isMouseDownOnScrollbar=!1,m&&(a[s]._selectingItemIndexes=[],a[s]._filteringItemIndexes=[])}},n.prototype.doMouseMove=function(e){var t,n,r,i=this._sheet,a=this._slicer;if(a&&!this._isMouseDownOnScrollbar&&i.canEditFloatingObject(a))for(n=0,r=(t=a.getTableItemSlicers()).length;n<r;n++)o.prototype.doMouseMove.call(t[n],e)},n.prototype.doMouseLeave=function(e){var t,n,r,i=this._sheet,a=this._slicer;if(a&&i.canEditFloatingObject(a))for(n=0,r=(t=a.getTableItemSlicers()).length;n<r;n++)o.prototype.doMouseLeave.call(t[n],e)},n.prototype.doScroll=function(e,t){var n,r,i,a=this._sheet,s=this._slicer;for(s&&a.canEditFloatingObject(s)||(t.newValue=t.oldValue),r=0,i=(n=s.getTableItemSlicers()).length;r<i;r++)o.prototype.scrollTo.call(n[r],e,t)},n.prototype.doMouseWheel=function(e){if(o.prototype.doMouseWheel.call(this,e))return!0;var t=this._sheet._slicerCollection,n=t&&t.getSelectedSlicers(),r=this.getScrollbarObj();return!!(n&&1===n.length&&this._isSelected&&this.needShowScrollbar()&&r)&&(r._scrollContainerMousewheel(e),e.stopPropagation(),!0)},n.prototype.doKeyUp=function(e){var o,n,r,i,a=this,s=a.slicerData,l=a._sheet;17===e.keyCode&&a._isCtrlKeyDown&&(a._isCtrlKeyDown=!1),16===e.keyCode&&a._isShiftKeyDown&&(a._isShiftKeyDown=!1),!a._isCtrlKeyDown&&!a._isShiftKeyDown&&a._selectingItemIndexes.length>0&&(o=a.slicerData.getExclusiveData(a.columnName).length,a._filteringItemIndexes.length===o?(n=s.getFilteredIndexes(a.columnName),l._doCommand(new t.UndoRedo.SlicerDataUnFilterUndoAction(l,s,a.columnName,n))):(r=s.getFilteredIndexes(a.columnName),i=a._filteringItemIndexes.concat(),l._doCommand(new t.UndoRedo.SlicerDataFilterUndoAction(l,s,a.columnName,r,i))),a._selectingItemIndexes=[],a._filteringItemIndexes=[])},n}(_),t.TableItemSlicer=l,u=function(){function e(e){this._sheet=e,this._slicerDatas=[],this._slicerSet={}}return e.prototype.addSlicerData=function(e){var t,o,n;if(e){for(t=e.getTable(),o=0,n=this._slicerDatas.length;o<n;o++)if(this._slicerDatas[o].getTable()===t)return;this._slicerDatas.push(e)}},e.prototype.removeSlicerData=function(e){t.ArrayHelper.remove(this._slicerDatas,e)},e.prototype.getSlicerData=function(e){var t,o,n;if(!this._slicerDatas||0===this._slicerDatas.length)return null;for(t=0,o=this._slicerDatas.length;t<o;t++)if((n=this._slicerDatas[t])&&n.getTable()&&n.getTable().tableName()===e)return n;return g},e.prototype.addSlicer=function(e){if(e){if(!this.isSlicerNameValid(e.name()))throw new Error(t.SR.Exp_SlicerNameInvalid);if(this.isSlicerNameExist(e.name()))throw new Error(t.SR.Exp_SlicerNameExist);this._slicerSet[e.name()]=e,this.addSlicerData(e.getSlicerData())}},e.prototype.removeSlicer=function(e){var t,o,n,r=this._slicerSet;if(e&&r.hasOwnProperty(e.name())){for(t=e.getSlicerData(),o=e.getTableItemSlicers(),n=0;n<o.length;n++)t.detachListener(o[n]);delete this._slicerSet[e.name()]}},e.prototype.getSlicer=function(e){return e===g||void 0===e?null:this._slicerSet[e]},e.prototype.getSlicers=function(e,o){var n,r,i;if(t.GC$.isEmptyObject(this._slicerSet))return[];if(n=[],r=this._slicerSet,0===arguments.length)for(i in r)n.push(r[i]);else if(1===arguments.length)for(i in r)r[i].getTable().name()===e&&n.push(r[i]);else for(i in r)r[i].getTable().name()===e&&r[i].columnName()===o&&n.push(r[i]);return n},e.prototype.getSlicerSet=function(){return this._slicerSet},e.prototype.updateSlicerSet=function(e,t){var o=this._slicerSet,n=o[e];delete o[e],o[t]=n},e.prototype.isSlicerNameValid=function(e){return!!e},e.prototype.isSlicerNameExist=function(e){return this.getSlicerSetInSpread().hasOwnProperty(e)},e.prototype.getAutoSlicerName=function(e){var t=this.getSlicerSetInSpread();if(!t.hasOwnProperty(e))return e;for(var o=1,n=e.split(" ")[0];t.hasOwnProperty(n+" "+o);)o++;return n+" "+o},e.prototype.getSlicerSetInSpread=function(){var e,t,o,n={},r=this._sheet&&this._sheet.parent&&this._sheet.parent.sheets;if(r)for(e=0;e<r.length;e++)for(o in t=r[e]._slicerCollection.getSlicerSet())n[o]=t[o];return n},e.prototype.getSelectedSlicers=function(){var e,o,n;if(!this._slicerSet||t.GC$.isEmptyObject(this._slicerSet))return[];for(o in e=[],this._slicerSet)(n=this._slicerSet[o])&&n.isSelected()&&e.push(n);return e},e.prototype.mouseWheelSelectedSlicer=function(e){var t,o,n=this.getSelectedSlicers();if(1!==n.length)return!1;if((t=n[0].getTableItemSlicers())&&t.length>0){for(o=0;o<t.length;o++)t[o].doMouseWheel(e);return!0}return!1},e.prototype.toJSON=function(){var e,o;if(!this._slicerSet||t.GC$.isEmptyObject(this._slicerSet))return g;for(o in e=[],this._slicerSet)e.push(this._slicerSet[o].toJSON());return 0===e.length?g:e},e.prototype.fromJSON=function(e,t){var o,n,r,i;if(e&&0!==e.length)for(this._slicerSet={},o=0;o<e.length;o++)if(n=e[o].tableName,r=e[o].columnName,n&&r){var a=this._sheet,s=a.findTableByName(n);s&&-1!==s.getColumnIndexInTable(r)&&((i=new c(e[o].name,s,r)).fromJSON(e[o]),a._slicerCollection.addSlicer(i),a.addFloatingObject(i))}},e}(),t.SlicerCollection=u,c=function(e){function o(t,n,r){e.call(this,t,o.DEFAULT_X,o.DEFAULT_Y,o.DEFAULT_WIDTH,o.DEFAULT_HEIGHT);var i,s,l=this;l.typeName="Slicer",n&&(i=n._getSheet(),l.owner(i),s=i._slicerCollection.getSlicerData(n.tableName())),s||(s=n.getSlicerData()),l._slicerData=s,l._columnName=r,l._tableItemSlicers=[],l._sourceName=l._columnName,l._nameInFormula="Slicer_"+l._columnName,l._captionName=l._columnName,l._columnCount=o.DEFAULT_COLUMN_COUNT,l._itemHeight=o.DEFAULT_ITEM_HEIGHT,l._showHeader=!0,l._sortState=1,l._disableResizingAndMoving=!1,l._showNoDataItems=!0,l._showNoDataItemsInLast=!0,l._visuallyNoDataItems=!0,l._style=a.light1(),l.dynamicSize(!1),l.dynamicMove(!1)}return __extends(o,e),o.prototype.name=function(t){var o;return 0===arguments.length?e.prototype.name.call(this):(t&&t!==e.prototype.name.call(this)&&(o=this.name(),e.prototype.name.call(this,t),this.onNameChanged(o,t)),this)},o.prototype.sourceName=function(){return this._sourceName},o.prototype.nameInFormula=function(e){return 0===arguments.length?this._nameInFormula:(this._nameInFormula!==e&&(this._nameInFormula=e,this.onPropertyChanged("nameInFormula",e)),this)},o.prototype.captionName=function(e){return 0===arguments.length?this._captionName:(e!==this._captionName&&(this._captionName=e,this.onPropertyChanged("captionName",e)),this)},o.prototype.columnCount=function(e){return 0===arguments.length?this._columnCount:(e>0&&e!==this._columnCount&&(this._columnCount=e,this.onPropertyChanged("columnCount",e)),this)},o.prototype.itemHeight=function(e){return 0===arguments.length?this._itemHeight:(e!==this._itemHeight&&(this._itemHeight=e,this.onPropertyChanged("itemHeight",e)),this)},o.prototype.showHeader=function(e){return 0===arguments.length?this._showHeader:(e!==this._showHeader&&(this._showHeader=e,this.onPropertyChanged("showHeader",e)),this)},o.prototype.sortState=function(e){return 0===arguments.length?this._sortState:(e!==this._sortState&&(this._sortState=e,this.onPropertyChanged("sortState",e)),this)},o.prototype.disableResizingAndMoving=function(e){return 0===arguments.length?this._disableResizingAndMoving:(e!==this._disableResizingAndMoving&&(this._disableResizingAndMoving=e,this.allowMove(!e),this.allowResize(!e),this.onPropertyChanged("disableResizingAndMoving",e)),this)},o.prototype.showNoDataItems=function(e){return 0===arguments.length?this._showNoDataItems:(e!==this._showNoDataItems&&(this._showNoDataItems=e,this.onPropertyChanged("showNoDataItems",e)),this)},o.prototype.showNoDataItemsInLast=function(e){return 0===arguments.length?this._showNoDataItemsInLast:(e!==this._showNoDataItemsInLast&&(this._showNoDataItemsInLast=e,this.onPropertyChanged("showNoDataItemsInLast",e)),this)},o.prototype.visuallyNoDataItems=function(e){return 0===arguments.length?this._visuallyNoDataItems:(e!==this._visuallyNoDataItems&&(this._visuallyNoDataItems=e,this.onPropertyChanged("visuallyNoDataItems",e)),this)},o.prototype.style=function(e){return 0===arguments.length?this._style:(this._style!==e&&null!==e&&(this._style=e,this.onPropertyChanged("style",e)),this)},o.prototype.isSelected=function(t){return 0===arguments.length?e.prototype.isSelected.call(this):(t!==e.prototype.isSelected.call(this)&&(e.prototype.isSelected.call(this,t),this.onPropertyChanged("isSelected",t)),this)},o.prototype.isVisible=function(){return this.callBaseClassProperty("isVisible",arguments)},o.prototype.Content=function(){return this.callBaseClassProperty("Content",arguments)},o.prototype.startRow=function(){return this.callBaseClassProperty("startRow",arguments)},o.prototype.startRowOffset=function(){return this.callBaseClassProperty("startRowOffset",arguments)},o.prototype.startColumn=function(){return this.callBaseClassProperty("startColumn",arguments)},o.prototype.startColumnOffset=function(){return this.callBaseClassProperty("startColumnOffset",arguments)},o.prototype.endRow=function(){return this.callBaseClassProperty("endRow",arguments)},o.prototype.endRowOffset=function(){return this.callBaseClassProperty("endRowOffset",arguments)},o.prototype.endColumn=function(){return this.callBaseClassProperty("endColumn",arguments)},o.prototype.endColumnOffset=function(){return this.callBaseClassProperty("endColumnOffset",arguments)},o.prototype.callBaseClassProperty=function(e,o){return t.CustomFloatingObject.prototype[e].apply(this,o)},o.prototype.onPropertyChanged=function(e,t){for(var o,n=this._tableItemSlicers||[],r=0,i=n.length;r<i;r++)n[r][e]&&("style"===e?n[r][e](t.toJSONInternal()):n[r][e](t));(o=this.owner())&&o.triggerSlicerChanged({sheet:o,sheetName:o?o._name:"",slicer:this,propertyName:e})},o.prototype.onNameChanged=function(e,o){var n=this._slicerData.getSheet()._slicerCollection;t.ArrayHelper.contains(n.getSlicers(),this)&&n.updateSlicerSet(e,o)},o.prototype.cloneContent=function(){var e=this,t=e.owner(),o=new l(e.name());return o.setData(e._slicerData,e._columnName),o.width(e.width()).height(e.height()).captionName(e._captionName).columnCount(e._columnCount).itemHeight(e._itemHeight).showHeader(e._showHeader).sortState(e._sortState).isLocked(e.isLocked()).disableResizingAndMoving(e._disableResizingAndMoving).showNoDataItems(e._showNoDataItems).showNoDataItemsInLast(e._showNoDataItemsInLast).visuallyNoDataItems(e._visuallyNoDataItems).style(e._style.toJSONInternal()).zoomFactor(t._zoomFactor).isSelected(e.isSelected()).slicer(e),o.sheet()!==t&&o.sheet(t),e._tableItemSlicers.push(o),o.getDOMElement()},o.prototype.refresh=function(e){for(var t=this._tableItemSlicers||[],o=0,n=t.length;o<n;o++)t[o].refresh(e)},o.prototype.refreshContent=function(e){this.refresh(this.owner()._zoomFactor)},o.prototype.clone=function(e){var t;return!this.owner()&&e&&this.owner(e),(t=new o(this.name(),this.getTable(),this.columnName())).owner(this.owner()),t.fromJSON(this.toJSON(),!1,this._slicerData),t.name(this.name()),t},o.prototype.getSlicerData=function(){return this._slicerData},o.prototype.columnName=function(e){return 0===arguments.length?this._columnName:(e!==this._columnName&&(this._columnName=e,this._sourceName=e,this._captionName=e),this)},o.prototype.getTable=function(){return this._slicerData.getTable()},o.prototype.getTableItemSlicers=function(){return this._tableItemSlicers||[]},o.prototype.fromJSON=function(n,r,a){var s,l,u;if(n&&!t.GC$.isEmptyObject(n||!n.tableName||!n.columnName)){e.prototype.fromJSON.call(this,n);var c=this,h=c.owner(),p=h._slicerCollection,d=a||p.getSlicerData(n.tableName);d||(d=h.findTableByName(n.tableName).getSlicerData(),p.addSlicerData(d)),c._slicerData=d,c._columnName=n.columnName,s=n.x!==f?n.x:o.DEFAULT_X,l=n.y!==f?n.y:o.DEFAULT_Y,c.position(new t.Point(s,l)),c.width(n.width!==f?n.width:o.DEFAULT_WIDTH),c.height(n.height!==f?n.height:o.DEFAULT_HEIGHT),n.sourceName!==f&&(c._sourceName=n.sourceName),n.nameInFormula!==f&&(c._nameInFormula=n.nameInFormula),n.captionName!==f&&(c._captionName=n.captionName),n.columnCount!==f&&(c._columnCount=n.columnCount),n.itemHeight!==f&&(c._itemHeight=n.itemHeight),n.showHeader!==f&&(c._showHeader=n.showHeader),n.sortState!==f&&(c._sortState=n.sortState),n.disableResizingAndMoving!==f&&(c._disableResizingAndMoving=n.disableResizingAndMoving),n.showNoDataItems!==f&&(c._showNoDataItems=n.showNoDataItems),n.visuallyNoDataItems!==f&&(c._visuallyNoDataItems=n.visuallyNoDataItems),n.showNoDataItemsInLast!==f&&(c._showNoDataItemsInLast=n.showNoDataItemsInLast),n.style!==f&&((u=new i).fromJSON(n.style),c._style=u)}},o.prototype.toJSON=function(){var e,t,o=this,n={name:o.name(),x:o.position().x,y:o.position().y,width:o.width(),height:o.height(),sourceName:o._sourceName,nameInFormula:o._nameInFormula,captionName:o._captionName,columnCount:o._columnCount,itemHeight:o._itemHeight,showHeader:o._showHeader,sortState:o._sortState,disableResizingAndMoving:o._disableResizingAndMoving,showNoDataItems:o._showNoDataItems,visuallyNoDataItems:o._visuallyNoDataItems,showNoDataItemsInLast:o._showNoDataItemsInLast,style:o._style?o._style.toJSON():g,dynamicMove:o.dynamicMove(),dynamicSize:o.dynamicSize(),isLocked:o.isLocked(),fixedPosition:o.fixedPosition(),tableName:o._slicerData.getTable().tableName(),columnName:o._columnName},r={};for(e in n)t=n[e],o.isDefaultValue(e,t)||(r[e]=t);return r},o.prototype.isDefaultValue=function(e,t){switch(e){case"x":return t===o.DEFAULT_X;case"y":return t===o.DEFAULT_Y;case"width":return t===o.DEFAULT_WIDTH;case"height":return t===o.DEFAULT_HEIGHT;case"columnCount":return t===o.DEFAULT_COLUMN_COUNT;case"itemHeight":return t===o.DEFAULT_ITEM_HEIGHT;case"sortState":return 1===t;case"disableResizingAndMoving":return!1===t;case"showHeader":case"showNoDataItems":case"visuallyNoDataItems":case"showNoDataItemsInLast":case"isLocked":return!0===t;case"style":return t&&"SlicerStyleLight1"===t.name;case"dynamicMove":case"dynamicSize":case"fixedPosition":return!1===t;default:return!1}},o.DEFAULT_X=100,o.DEFAULT_Y=100,o.DEFAULT_WIDTH=192,o.DEFAULT_HEIGHT=250,o.DEFAULT_COLUMN_COUNT=1,o.DEFAULT_ITEM_HEIGHT=21,o}(t.CustomFloatingObject),t.Slicer=c}(e.Sheets||(e.Sheets={}));e.Sheets}(GcSpread||(GcSpread={}));